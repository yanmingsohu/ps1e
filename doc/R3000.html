<html>
<head><meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<style type="text/css">
<!--
span.cls_002{font-family:Times,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_002{font-family:Times,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_004{font-family:"Book Antiqua",serif;font-size:24.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_004{font-family:"Book Antiqua",serif;font-size:24.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_005{font-family:"Book Antiqua",serif;font-size:14.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_005{font-family:"Book Antiqua",serif;font-size:14.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_003{font-family:Arial,serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_003{font-family:Arial,serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_006{font-family:"Book Antiqua",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_006{font-family:"Book Antiqua",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_007{font-family:"Book Antiqua Italic",serif;font-size:14.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_007{font-family:"Book Antiqua Italic",serif;font-size:14.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_008{font-family:"Book Antiqua Italic",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_008{font-family:"Book Antiqua Italic",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_009{font-family:"Book Antiqua Italic",serif;font-size:18.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_009{font-family:"Book Antiqua Italic",serif;font-size:18.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_010{font-family:Times,serif;font-size:12.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_010{font-family:Times,serif;font-size:12.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_011{font-family:Times,serif;font-size:12.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_011{font-family:Times,serif;font-size:12.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_012{font-family:Times,serif;font-size:12.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_012{font-family:Times,serif;font-size:12.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_014{font-family:Arial,serif;font-size:6.0px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_014{font-family:Arial,serif;font-size:6.0px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_015{font-family:"Book Antiqua",serif;font-size:12.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_015{font-family:"Book Antiqua",serif;font-size:12.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_016{font-family:Times,serif;font-size:8.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_016{font-family:Times,serif;font-size:8.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_017{font-family:Arial,serif;font-size:6.6px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_017{font-family:Arial,serif;font-size:6.6px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_018{font-family:Arial,serif;font-size:6.6px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_018{font-family:Arial,serif;font-size:6.6px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_019{font-family:Arial,serif;font-size:9.9px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_019{font-family:Arial,serif;font-size:9.9px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_020{font-family:"Book Antiqua",serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_020{font-family:"Book Antiqua",serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_021{font-family:Arial,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_021{font-family:Arial,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_022{font-family:"Book Antiqua",serif;font-size:8.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_022{font-family:"Book Antiqua",serif;font-size:8.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_023{font-family:Arial,serif;font-size:7.0px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_023{font-family:Arial,serif;font-size:7.0px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_024{font-family:Arial,serif;font-size:7.0px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_024{font-family:Arial,serif;font-size:7.0px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_025{font-family:Arial,serif;font-size:7.0px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_025{font-family:Arial,serif;font-size:7.0px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_026{font-family:Arial,serif;font-size:7.0px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_026{font-family:Arial,serif;font-size:7.0px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_027{font-family:"Book Antiqua Italic",serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_027{font-family:"Book Antiqua Italic",serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_028{font-family:Courier New,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_028{font-family:Courier New,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_029{font-family:Courier New,serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_029{font-family:Courier New,serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_030{font-family:"Book Antiqua",serif;font-size:5.0px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_030{font-family:"Book Antiqua",serif;font-size:5.0px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_031{font-family:Arial,serif;font-size:9.3px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_031{font-family:Arial,serif;font-size:9.3px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_032{font-family:Arial,serif;font-size:9.3px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_032{font-family:Arial,serif;font-size:9.3px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_033{font-family:Arial,serif;font-size:7.8px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_033{font-family:Arial,serif;font-size:7.8px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_034{font-family:"Book Antiqua Italic",serif;font-size:12.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_034{font-family:"Book Antiqua Italic",serif;font-size:12.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_035{font-family:Times,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_035{font-family:Times,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_036{font-family:Times,serif;font-size:7.0px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_036{font-family:Times,serif;font-size:7.0px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_037{font-family:Times,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_037{font-family:Times,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_038{font-family:Times,serif;font-size:7.0px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_038{font-family:Times,serif;font-size:7.0px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_039{font-family:Courier New,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_039{font-family:Courier New,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_040{font-family:Courier New,serif;font-size:8.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_040{font-family:Courier New,serif;font-size:8.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_041{font-family:Courier New,serif;font-size:10.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_041{font-family:Courier New,serif;font-size:10.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_042{font-family:Courier New,serif;font-size:7.3px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_042{font-family:Courier New,serif;font-size:7.3px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_043{font-family:Arial,serif;font-size:7.6px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_043{font-family:Arial,serif;font-size:7.6px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_044{font-family:Arial,serif;font-size:6.5px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_044{font-family:Arial,serif;font-size:6.5px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_045{font-family:Arial,serif;font-size:9.4px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_045{font-family:Arial,serif;font-size:9.4px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_046{font-family:Arial,serif;font-size:9.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_046{font-family:Arial,serif;font-size:9.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_048{font-family:"Book Antiqua Italic",serif;font-size:8.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_048{font-family:"Book Antiqua Italic",serif;font-size:8.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_049{font-family:Arial,serif;font-size:5.9px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_049{font-family:Arial,serif;font-size:5.9px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_050{font-family:Arial,serif;font-size:8.4px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_050{font-family:Arial,serif;font-size:8.4px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_051{font-family:Arial,serif;font-size:8.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_051{font-family:Arial,serif;font-size:8.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_052{font-family:"Book Antiqua Italic",serif;font-size:7.3px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_052{font-family:"Book Antiqua Italic",serif;font-size:7.3px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_053{font-family:Arial,serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_053{font-family:Arial,serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_054{font-family:Arial,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_054{font-family:Arial,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_055{font-family:"Palatino Linotype",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_055{font-family:"Palatino Linotype",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_056{font-family:Arial,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_056{font-family:Arial,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_057{font-family:Arial,serif;font-size:7.3px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_057{font-family:Arial,serif;font-size:7.3px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_058{font-family:"Palatino Linotype Italic",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_058{font-family:"Palatino Linotype Italic",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_059{font-family:"Palatino Linotype Bold",serif;font-size:12.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_059{font-family:"Palatino Linotype Bold",serif;font-size:12.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_061{font-family:Arial,serif;font-size:8.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_061{font-family:Arial,serif;font-size:8.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_060{font-family:"Palatino Linotype Bold",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_060{font-family:"Palatino Linotype Bold",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_062{font-family:Times,serif;font-size:14.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_062{font-family:Times,serif;font-size:14.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_064{font-family:Arial,serif;font-size:14.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_064{font-family:Arial,serif;font-size:14.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_063{font-family:Arial,serif;font-size:26.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_063{font-family:Arial,serif;font-size:26.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_065{font-family:Times,serif;font-size:14.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_065{font-family:Times,serif;font-size:14.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_066{font-family:"Palatino Linotype Bold",serif;font-size:11.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_066{font-family:"Palatino Linotype Bold",serif;font-size:11.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_067{font-family:Arial,serif;font-size:12.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_067{font-family:Arial,serif;font-size:12.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_069{font-family:Arial,serif;font-size:18.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_069{font-family:Arial,serif;font-size:18.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_070{font-family:Arial,serif;font-size:8.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_070{font-family:Arial,serif;font-size:8.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_072{font-family:Arial,serif;font-size:6.5px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_072{font-family:Arial,serif;font-size:6.5px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_071{font-family:"Palatino Linotype",serif;font-size:8.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_071{font-family:"Palatino Linotype",serif;font-size:8.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_073{font-family:"Palatino Linotype Italic",serif;font-size:8.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_073{font-family:"Palatino Linotype Italic",serif;font-size:8.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_074{font-family:Arial,serif;font-size:12.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_074{font-family:Arial,serif;font-size:12.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_075{font-family:Arial,serif;font-size:10.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_075{font-family:Arial,serif;font-size:10.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_076{font-family:"Book Antiqua Italic",serif;font-size:7.0px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_076{font-family:"Book Antiqua Italic",serif;font-size:7.0px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_077{font-family:"Palatino Linotype Bold Italic",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:bold;font-style:italic;text-decoration: none}
div.cls_077{font-family:"Palatino Linotype Bold Italic",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:bold;font-style:italic;text-decoration: none}
span.cls_078{font-family:Arial,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_078{font-family:Arial,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_079{font-family:Arial,serif;font-size:13.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_079{font-family:Arial,serif;font-size:13.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_080{font-family:Arial,serif;font-size:22.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_080{font-family:Arial,serif;font-size:22.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
-->
</style>
</head>
<body>
<div style="position:absolute;left:50%;margin-left:-306px;top:0px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:49.99px;top:28.00px" class="cls_002"><span class="cls_002">Table of Contents</span></div>
<div style="position:absolute;left:199.24px;top:121.00px" class="cls_004"><span class="cls_004">IDT R30xx Family</span></div>
<div style="position:absolute;left:142.15px;top:146.01px" class="cls_004"><span class="cls_004">Software Reference Manual</span></div>
<div style="position:absolute;left:267.01px;top:273.33px" class="cls_005"><span class="cls_005">Revision 1.0</span></div>
<div style="position:absolute;left:211.03px;top:355.67px" class="cls_003"><span class="cls_003"></span><span class="cls_006">1994 Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:229.52px;top:377.67px" class="cls_006"><span class="cls_006">Portions </span><span class="cls_003"></span><span class="cls_006">1994 Algorithmics, Ltd.</span></div>
<div style="position:absolute;left:156.55px;top:399.67px" class="cls_006"><span class="cls_006">Chapter 16 contains some material that is </span><span class="cls_003"></span><span class="cls_006">1988 Prentice-Hall.</span></div>
<div style="position:absolute;left:129.85px;top:421.67px" class="cls_006"><span class="cls_006">Appendices A & B contain material that is </span><span class="cls_003"></span><span class="cls_006">1994 by Mips Technology, Inc.</span></div>
<div style="position:absolute;left:306.77px;top:755.33px" class="cls_002"><span class="cls_002">i-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:802px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:492.79px;top:28.00px" class="cls_002"><span class="cls_002">Table of Contents</span></div>
<div style="position:absolute;left:48.02px;top:49.33px" class="cls_007"><span class="cls_007">About IDT</span></div>
<div style="position:absolute;left:48.02px;top:76.67px" class="cls_006"><span class="cls_006">Integrated Device Technology, Inc. has been a MIPS semiconductor</span></div>
<div style="position:absolute;left:36.00px;top:87.67px" class="cls_006"><span class="cls_006">partner since 1988, and has led efforts to bring the high-performance</span></div>
<div style="position:absolute;left:36.00px;top:98.67px" class="cls_006"><span class="cls_006">inherent in the MIPS architecture to embedded systems engineers.  These</span></div>
<div style="position:absolute;left:36.00px;top:109.67px" class="cls_006"><span class="cls_006">efforts include derivatives of MIPS R3xxx and R4xxx CPUs, development</span></div>
<div style="position:absolute;left:36.00px;top:120.67px" class="cls_006"><span class="cls_006">tools, and applications support.</span></div>
<div style="position:absolute;left:48.02px;top:131.67px" class="cls_006"><span class="cls_006">Additional information about IDT’s RISC family can be obtained from</span></div>
<div style="position:absolute;left:36.00px;top:142.67px" class="cls_006"><span class="cls_006">your local sales representative.  Alternately, IDT can be reached directly at:</span></div>
<div style="position:absolute;left:48.02px;top:164.67px" class="cls_008"><span class="cls_008">Corporate Marketing</span></div>
<div style="position:absolute;left:216.02px;top:164.67px" class="cls_008"><span class="cls_008">(800) 345-7015</span></div>
<div style="position:absolute;left:48.02px;top:186.67px" class="cls_008"><span class="cls_008">RISC Applications "Hotline"</span></div>
<div style="position:absolute;left:216.04px;top:186.67px" class="cls_008"><span class="cls_008">(408) 492-8208</span></div>
<div style="position:absolute;left:48.02px;top:208.67px" class="cls_008"><span class="cls_008">RISC Applications FAX</span></div>
<div style="position:absolute;left:216.02px;top:208.67px" class="cls_008"><span class="cls_008">(408) 492-8469</span></div>
<div style="position:absolute;left:48.02px;top:230.67px" class="cls_008"><span class="cls_008">RISC Applications Internet</span></div>
<div style="position:absolute;left:216.03px;top:230.67px" class="cls_008"><span class="cls_008">rischelp@idtinc.com</span></div>
<div style="position:absolute;left:48.02px;top:317.33px" class="cls_007"><span class="cls_007">About Algorithmics</span></div>
<div style="position:absolute;left:48.02px;top:344.67px" class="cls_006"><span class="cls_006">Much of this manual was written by Dominic Sweetman and Nigel</span></div>
<div style="position:absolute;left:36.00px;top:355.67px" class="cls_006"><span class="cls_006">Stephens of Algorithmics Ltd in London, England, under contract to IDT.</span></div>
<div style="position:absolute;left:36.00px;top:366.67px" class="cls_006"><span class="cls_006">Algorithmics were early   enthusiasts for the MIPS architecture, designing</span></div>
<div style="position:absolute;left:36.00px;top:377.67px" class="cls_006"><span class="cls_006">their  first  MIPS  systems  and  system  software  in</span></div>
<div style="position:absolute;left:302.56px;top:377.67px" class="cls_006"><span class="cls_006">1986/87.  A  small</span></div>
<div style="position:absolute;left:36.00px;top:388.67px" class="cls_006"><span class="cls_006">engineering  company,  Algorithmics  provide  enabling  technologies  for</span></div>
<div style="position:absolute;left:36.00px;top:399.67px" class="cls_006"><span class="cls_006">companies designing in both R30xx family CPUs and the 64-bit R4x00</span></div>
<div style="position:absolute;left:36.00px;top:410.67px" class="cls_006"><span class="cls_006">architecture.  This  includes  training,  toolkits,  GNU  C  support,  and</span></div>
<div style="position:absolute;left:36.00px;top:421.67px" class="cls_006"><span class="cls_006">evaluation boards.  Dominic Sweetman can be reached at the following:.</span></div>
<div style="position:absolute;left:48.02px;top:443.67px" class="cls_006"><span class="cls_006">Dominic Sweetman</span></div>
<div style="position:absolute;left:180.02px;top:443.67px" class="cls_006"><span class="cls_006">phone: +44 71 700 3301</span></div>
<div style="position:absolute;left:48.02px;top:454.67px" class="cls_006"><span class="cls_006">Algorithmics Ltd</span></div>
<div style="position:absolute;left:180.02px;top:454.67px" class="cls_006"><span class="cls_006">fax:</span></div>
<div style="position:absolute;left:207.42px;top:454.67px" class="cls_006"><span class="cls_006">+44 71 700 3400</span></div>
<div style="position:absolute;left:48.02px;top:465.67px" class="cls_006"><span class="cls_006">3 Drayton Park</span></div>
<div style="position:absolute;left:183.22px;top:465.67px" class="cls_006"><span class="cls_006">email: dom@algor.co.uk</span></div>
<div style="position:absolute;left:48.02px;top:476.67px" class="cls_006"><span class="cls_006">London N5 1NU</span></div>
<div style="position:absolute;left:48.02px;top:487.67px" class="cls_006"><span class="cls_006">ENGLAND.</span></div>
<div style="position:absolute;left:293.02px;top:755.33px" class="cls_002"><span class="cls_002">i-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:1604px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">Table of Contents</span></div>
<div style="position:absolute;left:228.02px;top:48.00px" class="cls_009"><span class="cls_009">About This Manual</span></div>
<div style="position:absolute;left:228.02px;top:113.67px" class="cls_006"><span class="cls_006">This manual is targeted to a systems programmer building an R30xx-</span></div>
<div style="position:absolute;left:216.00px;top:124.67px" class="cls_006"><span class="cls_006">based  system.  It  contains  the  architecture  specific  operations  and</span></div>
<div style="position:absolute;left:216.00px;top:135.67px" class="cls_006"><span class="cls_006">programming conventions relevant to such a programmer.</span></div>
<div style="position:absolute;left:228.02px;top:146.67px" class="cls_006"><span class="cls_006">This manual is not intended to be a tutorial on structured programming,</span></div>
<div style="position:absolute;left:216.00px;top:157.67px" class="cls_006"><span class="cls_006">real-time  operating  systems,  any  particular  high-level  programming</span></div>
<div style="position:absolute;left:216.00px;top:168.67px" class="cls_006"><span class="cls_006">language, or any particular toolchain. Other references are better suited to</span></div>
<div style="position:absolute;left:216.00px;top:179.67px" class="cls_006"><span class="cls_006">those topics.</span></div>
<div style="position:absolute;left:228.02px;top:190.67px" class="cls_006"><span class="cls_006">This  manual  does  contain  specific  code  fragments  and  the  most</span></div>
<div style="position:absolute;left:216.00px;top:201.67px" class="cls_006"><span class="cls_006">common programming conventions that are specific to the IDT R30xx</span></div>
<div style="position:absolute;left:216.00px;top:212.67px" class="cls_006"><span class="cls_006">RISController family.  The manual was consciously limited to the R30xx</span></div>
<div style="position:absolute;left:216.00px;top:223.67px" class="cls_006"><span class="cls_006">family; information relevant to the R4xxx family of processors may be</span></div>
<div style="position:absolute;left:216.00px;top:234.67px" class="cls_006"><span class="cls_006">found, but the device specific programs (such as cache management,</span></div>
<div style="position:absolute;left:216.00px;top:245.67px" class="cls_006"><span class="cls_006">exception handling, etc.) shown as examples are specific to the R30xx</span></div>
<div style="position:absolute;left:216.00px;top:256.67px" class="cls_006"><span class="cls_006">family.</span></div>
<div style="position:absolute;left:228.02px;top:267.67px" class="cls_006"><span class="cls_006">This manual contains references to the toolchains most commonly used</span></div>
<div style="position:absolute;left:216.00px;top:278.67px" class="cls_006"><span class="cls_006">by the authors (IDT, Inc., and Algorithmics, Ltd.).  Code fragments shown</span></div>
<div style="position:absolute;left:216.00px;top:289.67px" class="cls_006"><span class="cls_006">are typically from software used by and/or provided by these companies,</span></div>
<div style="position:absolute;left:216.00px;top:300.67px" class="cls_006"><span class="cls_006">includeing development tools such as IDT/c and software utilities (such as</span></div>
<div style="position:absolute;left:216.00px;top:311.67px" class="cls_006"><span class="cls_006">IDT/kit, IDT/sim, and Micromonitor).  A wide variety of other, 3rd party</span></div>
<div style="position:absolute;left:216.00px;top:322.67px" class="cls_006"><span class="cls_006">products, are also available to support R30xx development, under the</span></div>
<div style="position:absolute;left:216.00px;top:333.67px" class="cls_006"><span class="cls_006">Advantage-IDT program.  The reader of this manual is encouraged to look</span></div>
<div style="position:absolute;left:216.00px;top:344.67px" class="cls_006"><span class="cls_006">at all the available tools to determine which toolchains and utilities best fit</span></div>
<div style="position:absolute;left:216.00px;top:355.67px" class="cls_006"><span class="cls_006">the system development requirements.</span></div>
<div style="position:absolute;left:216.00px;top:366.67px" class="cls_006"><span class="cls_006">Additional information on the IDT family of RISC processors, and their</span></div>
<div style="position:absolute;left:216.00px;top:378.67px" class="cls_006"><span class="cls_006">support tools, is available from your local IDT salesman.</span></div>
<div style="position:absolute;left:306.77px;top:755.33px" class="cls_002"><span class="cls_002">i-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:2406px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:492.79px;top:28.00px" class="cls_002"><span class="cls_002">Table of Contents</span></div>
<div style="position:absolute;left:51.30px;top:414.67px" class="cls_006"><span class="cls_006">Integrated Device Technology, Inc. reserves the right to make changes to its products or specifications at</span></div>
<div style="position:absolute;left:36.00px;top:424.67px" class="cls_006"><span class="cls_006">any time, without notice, in order to improve design or performance and to supply the best possible product.</span></div>
<div style="position:absolute;left:36.00px;top:434.67px" class="cls_006"><span class="cls_006">IDT does not assume any responsibility for use of any circuitry described other than the circuitry embodied</span></div>
<div style="position:absolute;left:36.00px;top:444.67px" class="cls_006"><span class="cls_006">in an IDT product. The Company makes no representations that circuitry described herein is free from patent</span></div>
<div style="position:absolute;left:36.00px;top:454.67px" class="cls_006"><span class="cls_006">infringement or other rights of third parties which may result from its use.  No license is granted by impli-</span></div>
<div style="position:absolute;left:36.00px;top:464.67px" class="cls_006"><span class="cls_006">cation or otherwise under any patent, patent rights or other rights, of Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:48.02px;top:507.67px" class="cls_006"><span class="cls_006">LIFE SUPPORT POLICY</span></div>
<div style="position:absolute;left:48.02px;top:518.67px" class="cls_006"><span class="cls_006">Integrated Device Technology's products are not authorized for use as critical components in life</span></div>
<div style="position:absolute;left:36.00px;top:529.67px" class="cls_006"><span class="cls_006">support devices or systems unless a specific written agreement pertaining to such intended use is</span></div>
<div style="position:absolute;left:36.00px;top:540.67px" class="cls_006"><span class="cls_006">executed between the manufacturer and an officer of IDT.</span></div>
<div style="position:absolute;left:48.02px;top:551.67px" class="cls_006"><span class="cls_006">1. Life support devices or systems are devices or systems which (a) are intended for surgical implant</span></div>
<div style="position:absolute;left:36.00px;top:562.67px" class="cls_006"><span class="cls_006">into the body or (b) support or sustain life and whose failure to perform, when properly used in</span></div>
<div style="position:absolute;left:36.00px;top:573.67px" class="cls_006"><span class="cls_006">accordance with instructions for use provided in the labeling, can be reasonably expected to result in</span></div>
<div style="position:absolute;left:36.00px;top:584.67px" class="cls_006"><span class="cls_006">a significant injury to the user.</span></div>
<div style="position:absolute;left:48.02px;top:595.67px" class="cls_006"><span class="cls_006">2. A critical component is any components of a life support device or system whose failure to</span></div>
<div style="position:absolute;left:36.00px;top:606.67px" class="cls_006"><span class="cls_006">perform can be reasonably expected to cause the failure of the life support device or system, or to</span></div>
<div style="position:absolute;left:36.00px;top:617.67px" class="cls_006"><span class="cls_006">affect its safety or effectiveness.</span></div>
<div style="position:absolute;left:48.02px;top:639.67px" class="cls_006"><span class="cls_006">The IDT logo is a registered trademark and BiCameral, BurstRAM, BUSMUX, CacheRAM, DECnet,</span></div>
<div style="position:absolute;left:36.00px;top:650.67px" class="cls_006"><span class="cls_006">Double-Density, FASTX, Four-Port, FLEXI-CACHE, Flexi-PAK, Flow-thruEDC, IDT/c, IDTenvY, IDT/sae,</span></div>
<div style="position:absolute;left:36.00px;top:661.67px" class="cls_006"><span class="cls_006">IDT/sim, IDT/ux, MacStation, MICROSLICE, Orion, PalatteDAC, REAL8, R3041, R3051, R3052, R3081,</span></div>
<div style="position:absolute;left:36.00px;top:672.67px" class="cls_006"><span class="cls_006">R3721, R4600, RISCompiler, RISController, RISCore, RISC Subsystem, RISC Windows, SARAM, SmartLogic,</span></div>
<div style="position:absolute;left:36.00px;top:683.67px" class="cls_006"><span class="cls_006">SyncFIFO, SyncBiFIFO, SPC, TargetSystem and WideBus are trademarks of Integrated Device Technology,</span></div>
<div style="position:absolute;left:36.00px;top:694.67px" class="cls_006"><span class="cls_006">Inc.</span></div>
<div style="position:absolute;left:48.02px;top:705.67px" class="cls_006"><span class="cls_006">MIPS is a registered trademark of MIPS Computer Systems, Inc</span></div>
<div style="position:absolute;left:48.02px;top:716.67px" class="cls_006"><span class="cls_006">All others are trademarks of their respective companies..</span></div>
<div style="position:absolute;left:293.02px;top:755.33px" class="cls_002"><span class="cls_002">i-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:3208px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">Table of Contents</span></div>
<div style="position:absolute;left:144.00px;top:46.00px" class="cls_004"><span class="cls_004">IDT R30xx Family</span></div>
<div style="position:absolute;left:144.00px;top:71.01px" class="cls_004"><span class="cls_004">Software Reference Manual</span></div>
<div style="position:absolute;left:144.00px;top:118.00px" class="cls_004"><span class="cls_004">Table of Contents</span></div>
<div style="position:absolute;left:144.00px;top:172.00px" class="cls_010"><span class="cls_010">Introduction</span></div>
<div style="position:absolute;left:570.02px;top:172.00px" class="cls_010"><span class="cls_010">1</span></div>
<div style="position:absolute;left:162.00px;top:186.00px" class="cls_011"><span class="cls_011">What is a RISC?</span></div>
<div style="position:absolute;left:560.01px;top:186.00px" class="cls_011"><span class="cls_011">1-1</span></div>
<div style="position:absolute;left:162.00px;top:200.00px" class="cls_011"><span class="cls_011">PIPELINES</span></div>
<div style="position:absolute;left:560.02px;top:200.00px" class="cls_011"><span class="cls_011">1-2</span></div>
<div style="position:absolute;left:162.00px;top:214.01px" class="cls_011"><span class="cls_011">The IDT R3xxx Family CPUs</span></div>
<div style="position:absolute;left:560.02px;top:214.01px" class="cls_011"><span class="cls_011">1-3</span></div>
<div style="position:absolute;left:162.00px;top:228.01px" class="cls_011"><span class="cls_011">MIPS Architecture Levels</span></div>
<div style="position:absolute;left:559.97px;top:228.01px" class="cls_011"><span class="cls_011">1-4</span></div>
<div style="position:absolute;left:162.00px;top:242.02px" class="cls_011"><span class="cls_011">MIPS-1 Compared with CISC Archtectures</span></div>
<div style="position:absolute;left:560.04px;top:242.02px" class="cls_011"><span class="cls_011">1-4</span></div>
<div style="position:absolute;left:180.00px;top:256.02px" class="cls_011"><span class="cls_011">Unusual Instruction Encoding Features</span></div>
<div style="position:absolute;left:560.02px;top:256.02px" class="cls_011"><span class="cls_011">1-5</span></div>
<div style="position:absolute;left:180.00px;top:270.02px" class="cls_011"><span class="cls_011">Addressing and Memory Accesses</span></div>
<div style="position:absolute;left:560.04px;top:270.02px" class="cls_011"><span class="cls_011">1-5</span></div>
<div style="position:absolute;left:180.00px;top:284.03px" class="cls_011"><span class="cls_011">Operations not Directly Supported</span></div>
<div style="position:absolute;left:560.02px;top:284.03px" class="cls_011"><span class="cls_011">1-6</span></div>
<div style="position:absolute;left:162.00px;top:298.03px" class="cls_011"><span class="cls_011">Multiply and Divide Operations</span></div>
<div style="position:absolute;left:560.02px;top:298.03px" class="cls_011"><span class="cls_011">1-7</span></div>
<div style="position:absolute;left:162.00px;top:312.04px" class="cls_011"><span class="cls_011">Programmer-visible Pipeline Effects</span></div>
<div style="position:absolute;left:560.04px;top:312.04px" class="cls_011"><span class="cls_011">1-7</span></div>
<div style="position:absolute;left:162.00px;top:326.04px" class="cls_011"><span class="cls_011">A Note on Machine and Assembler Language</span></div>
<div style="position:absolute;left:560.02px;top:326.04px" class="cls_011"><span class="cls_011">1-8</span></div>
<div style="position:absolute;left:144.00px;top:340.00px" class="cls_010"><span class="cls_010">MIPs-1 (R30xx) Architecture</span></div>
<div style="position:absolute;left:570.03px;top:340.00px" class="cls_010"><span class="cls_010">2</span></div>
<div style="position:absolute;left:161.00px;top:354.00px" class="cls_011"><span class="cls_011">Programmer’s View of the Processor Archtecture</span></div>
<div style="position:absolute;left:560.06px;top:354.00px" class="cls_011"><span class="cls_011">2-1</span></div>
<div style="position:absolute;left:162.00px;top:368.00px" class="cls_011"><span class="cls_011">Registers</span></div>
<div style="position:absolute;left:560.01px;top:368.00px" class="cls_011"><span class="cls_011">2-1</span></div>
<div style="position:absolute;left:162.00px;top:382.01px" class="cls_011"><span class="cls_011">Conventional Names and Uses of General-Purpose Registers</span></div>
<div style="position:absolute;left:560.04px;top:382.01px" class="cls_011"><span class="cls_011">2-2</span></div>
<div style="position:absolute;left:180.00px;top:396.01px" class="cls_011"><span class="cls_011">Notes on Conventional Register Names</span></div>
<div style="position:absolute;left:560.02px;top:396.01px" class="cls_011"><span class="cls_011">2-2</span></div>
<div style="position:absolute;left:162.00px;top:410.02px" class="cls_011"><span class="cls_011">Integer Multiply Unit and Registers</span></div>
<div style="position:absolute;left:560.02px;top:410.02px" class="cls_011"><span class="cls_011">2-3</span></div>
<div style="position:absolute;left:162.00px;top:424.02px" class="cls_011"><span class="cls_011">Instruction Types</span></div>
<div style="position:absolute;left:560.02px;top:424.02px" class="cls_011"><span class="cls_011">2-4</span></div>
<div style="position:absolute;left:162.00px;top:438.02px" class="cls_011"><span class="cls_011">Loading and Storing: Addressing Modes</span></div>
<div style="position:absolute;left:560.03px;top:438.02px" class="cls_011"><span class="cls_011">2-5</span></div>
<div style="position:absolute;left:162.00px;top:452.03px" class="cls_011"><span class="cls_011">Data types in Memory and Registers</span></div>
<div style="position:absolute;left:560.02px;top:452.03px" class="cls_011"><span class="cls_011">2-6</span></div>
<div style="position:absolute;left:180.00px;top:466.03px" class="cls_011"><span class="cls_011">Integer Data Types</span></div>
<div style="position:absolute;left:560.01px;top:466.03px" class="cls_011"><span class="cls_011">2-6</span></div>
<div style="position:absolute;left:180.00px;top:480.04px" class="cls_011"><span class="cls_011">Unaligned Loads and Stores</span></div>
<div style="position:absolute;left:560.01px;top:480.04px" class="cls_011"><span class="cls_011">2-6</span></div>
<div style="position:absolute;left:180.00px;top:494.04px" class="cls_011"><span class="cls_011">Floating Point Data in Memory</span></div>
<div style="position:absolute;left:560.02px;top:494.04px" class="cls_011"><span class="cls_011">2-7</span></div>
<div style="position:absolute;left:162.00px;top:508.04px" class="cls_011"><span class="cls_011">Basic Address Space</span></div>
<div style="position:absolute;left:560.02px;top:508.04px" class="cls_011"><span class="cls_011">2-8</span></div>
<div style="position:absolute;left:162.00px;top:522.05px" class="cls_011"><span class="cls_011">Summary of System Addressing</span></div>
<div style="position:absolute;left:560.03px;top:522.05px" class="cls_011"><span class="cls_011">2-9</span></div>
<div style="position:absolute;left:180.00px;top:536.05px" class="cls_011"><span class="cls_011">Kernel vs. User Mode</span></div>
<div style="position:absolute;left:560.02px;top:536.05px" class="cls_011"><span class="cls_011">2-9</span></div>
<div style="position:absolute;left:180.00px;top:550.06px" class="cls_011"><span class="cls_011">Memory map for CPUs without MMU Hardware</span></div>
<div style="position:absolute;left:554.05px;top:550.06px" class="cls_011"><span class="cls_011">2-10</span></div>
<div style="position:absolute;left:198.00px;top:564.06px" class="cls_011"><span class="cls_011">Subsegments in the R3041 - Memory Width Configuration</span></div>
<div style="position:absolute;left:554.07px;top:564.06px" class="cls_011"><span class="cls_011">2-10</span></div>
<div style="position:absolute;left:144.00px;top:578.00px" class="cls_010"><span class="cls_010">System Control Coprocessor Architecture</span></div>
<div style="position:absolute;left:570.04px;top:578.00px" class="cls_010"><span class="cls_010">3</span></div>
<div style="position:absolute;left:162.00px;top:592.00px" class="cls_011"><span class="cls_011">CPU Control Summary</span></div>
<div style="position:absolute;left:560.02px;top:592.00px" class="cls_011"><span class="cls_011">3-1</span></div>
<div style="position:absolute;left:162.00px;top:606.00px" class="cls_011"><span class="cls_011">CPU Control and ‘‘CO-PROCESSOR 0’’</span></div>
<div style="position:absolute;left:560.05px;top:606.00px" class="cls_011"><span class="cls_011">3-2</span></div>
<div style="position:absolute;left:180.00px;top:620.01px" class="cls_011"><span class="cls_011">CPU Control Instructions</span></div>
<div style="position:absolute;left:560.02px;top:620.01px" class="cls_011"><span class="cls_011">3-2</span></div>
<div style="position:absolute;left:180.00px;top:634.01px" class="cls_011"><span class="cls_011">Standard CPU control registers</span></div>
<div style="position:absolute;left:560.03px;top:634.01px" class="cls_011"><span class="cls_011">3-3</span></div>
<div style="position:absolute;left:197.00px;top:648.02px" class="cls_011"><span class="cls_011">PRId Register</span></div>
<div style="position:absolute;left:560.02px;top:648.02px" class="cls_011"><span class="cls_011">3-4</span></div>
<div style="position:absolute;left:197.00px;top:662.02px" class="cls_011"><span class="cls_011">SR Register</span></div>
<div style="position:absolute;left:560.01px;top:662.02px" class="cls_011"><span class="cls_011">3-4</span></div>
<div style="position:absolute;left:197.00px;top:676.02px" class="cls_011"><span class="cls_011">Cause Register</span></div>
<div style="position:absolute;left:560.02px;top:676.02px" class="cls_011"><span class="cls_011">3-7</span></div>
<div style="position:absolute;left:197.00px;top:690.03px" class="cls_011"><span class="cls_011">EPC Register</span></div>
<div style="position:absolute;left:560.02px;top:690.03px" class="cls_011"><span class="cls_011">3-8</span></div>
<div style="position:absolute;left:197.00px;top:704.03px" class="cls_011"><span class="cls_011">BadVaddr Register</span></div>
<div style="position:absolute;left:560.02px;top:704.03px" class="cls_011"><span class="cls_011">3-8</span></div>
<div style="position:absolute;left:180.00px;top:718.04px" class="cls_011"><span class="cls_011">R3041, R3071, and R3081 Specific Registers</span></div>
<div style="position:absolute;left:560.01px;top:718.04px" class="cls_011"><span class="cls_011">3-8</span></div>
<div style="position:absolute;left:306.77px;top:755.33px" class="cls_002"><span class="cls_002">i-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:4010px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:492.78px;top:28.00px" class="cls_002"><span class="cls_002">Table of Contents</span></div>
<div style="position:absolute;left:91.00px;top:53.00px" class="cls_011"><span class="cls_011">Count and Compare Registers (R3041 only)</span></div>
<div style="position:absolute;left:453.01px;top:53.00px" class="cls_011"><span class="cls_011">3-8</span></div>
<div style="position:absolute;left:91.00px;top:67.00px" class="cls_011"><span class="cls_011">Config Register (R3071 and R3081)</span></div>
<div style="position:absolute;left:453.02px;top:67.00px" class="cls_011"><span class="cls_011">3-8</span></div>
<div style="position:absolute;left:91.00px;top:81.01px" class="cls_011"><span class="cls_011">Config Register (R3041)</span></div>
<div style="position:absolute;left:453.02px;top:81.01px" class="cls_011"><span class="cls_011">3-9</span></div>
<div style="position:absolute;left:91.00px;top:95.01px" class="cls_011"><span class="cls_011">BusCtrl Register (R3041 only)</span></div>
<div style="position:absolute;left:447.02px;top:95.01px" class="cls_011"><span class="cls_011">3-10</span></div>
<div style="position:absolute;left:91.00px;top:109.02px" class="cls_011"><span class="cls_011">PortSize Register (R3041 only)</span></div>
<div style="position:absolute;left:447.02px;top:109.02px" class="cls_011"><span class="cls_011">3-11</span></div>
<div style="position:absolute;left:73.00px;top:123.02px" class="cls_011"><span class="cls_011">What registers are relevant when?</span></div>
<div style="position:absolute;left:447.02px;top:123.02px" class="cls_011"><span class="cls_011">3-11</span></div>
<div style="position:absolute;left:37.00px;top:137.00px" class="cls_010"><span class="cls_010">Exception Management</span></div>
<div style="position:absolute;left:463.02px;top:137.00px" class="cls_010"><span class="cls_010">4</span></div>
<div style="position:absolute;left:55.00px;top:151.00px" class="cls_011"><span class="cls_011">Exceptions</span></div>
<div style="position:absolute;left:453.01px;top:151.00px" class="cls_011"><span class="cls_011">4-1</span></div>
<div style="position:absolute;left:73.00px;top:165.00px" class="cls_011"><span class="cls_011">Precise Exceptions</span></div>
<div style="position:absolute;left:453.02px;top:165.00px" class="cls_011"><span class="cls_011">4-1</span></div>
<div style="position:absolute;left:73.00px;top:179.01px" class="cls_011"><span class="cls_011">When Exceptions Happen</span></div>
<div style="position:absolute;left:453.00px;top:179.01px" class="cls_011"><span class="cls_011">4-2</span></div>
<div style="position:absolute;left:73.00px;top:193.01px" class="cls_011"><span class="cls_011">Exception vectors</span></div>
<div style="position:absolute;left:453.00px;top:193.01px" class="cls_011"><span class="cls_011">4-2</span></div>
<div style="position:absolute;left:73.00px;top:207.02px" class="cls_011"><span class="cls_011">Exception Handling - Basics</span></div>
<div style="position:absolute;left:453.01px;top:207.02px" class="cls_011"><span class="cls_011">4-3</span></div>
<div style="position:absolute;left:73.00px;top:221.02px" class="cls_011"><span class="cls_011">Nesting Exceptions</span></div>
<div style="position:absolute;left:453.01px;top:221.02px" class="cls_011"><span class="cls_011">4-4</span></div>
<div style="position:absolute;left:73.00px;top:235.02px" class="cls_011"><span class="cls_011">An Exception Routine</span></div>
<div style="position:absolute;left:453.00px;top:235.02px" class="cls_011"><span class="cls_011">4-4</span></div>
<div style="position:absolute;left:55.00px;top:249.03px" class="cls_011"><span class="cls_011">Interrupts</span></div>
<div style="position:absolute;left:447.01px;top:249.03px" class="cls_011"><span class="cls_011">4-12</span></div>
<div style="position:absolute;left:73.00px;top:263.03px" class="cls_011"><span class="cls_011">Conventions and Examples</span></div>
<div style="position:absolute;left:447.00px;top:263.03px" class="cls_011"><span class="cls_011">4-14</span></div>
<div style="position:absolute;left:37.00px;top:277.00px" class="cls_010"><span class="cls_010">Cache Management</span></div>
<div style="position:absolute;left:463.01px;top:277.00px" class="cls_010"><span class="cls_010">5</span></div>
<div style="position:absolute;left:55.00px;top:291.00px" class="cls_011"><span class="cls_011">Caches and Cache Management</span></div>
<div style="position:absolute;left:453.01px;top:291.00px" class="cls_011"><span class="cls_011">5-1</span></div>
<div style="position:absolute;left:73.00px;top:305.00px" class="cls_011"><span class="cls_011">Cache Isolation and Swapping</span></div>
<div style="position:absolute;left:453.01px;top:305.00px" class="cls_011"><span class="cls_011">5-3</span></div>
<div style="position:absolute;left:73.00px;top:319.01px" class="cls_011"><span class="cls_011">Initializing and Sizing the Caches</span></div>
<div style="position:absolute;left:453.01px;top:319.01px" class="cls_011"><span class="cls_011">5-4</span></div>
<div style="position:absolute;left:73.00px;top:333.01px" class="cls_011"><span class="cls_011">Invalidation</span></div>
<div style="position:absolute;left:453.00px;top:333.01px" class="cls_011"><span class="cls_011">5-6</span></div>
<div style="position:absolute;left:73.00px;top:347.02px" class="cls_011"><span class="cls_011">Testing and Probing</span></div>
<div style="position:absolute;left:453.01px;top:347.02px" class="cls_011"><span class="cls_011">5-8</span></div>
<div style="position:absolute;left:73.00px;top:361.02px" class="cls_011"><span class="cls_011">Configuration (R3041/71/81 only)</span></div>
<div style="position:absolute;left:453.01px;top:361.02px" class="cls_011"><span class="cls_011">5-8</span></div>
<div style="position:absolute;left:55.00px;top:375.02px" class="cls_011"><span class="cls_011">Write Buffer</span></div>
<div style="position:absolute;left:453.01px;top:375.02px" class="cls_011"><span class="cls_011">5-9</span></div>
<div style="position:absolute;left:73.00px;top:389.00px" class="cls_011"><span class="cls_011">Implementing </span><span class="cls_012">wbflush()</span></div>
<div style="position:absolute;left:447.01px;top:389.00px" class="cls_012"><span class="cls_012">5-10</span></div>
<div style="position:absolute;left:37.00px;top:403.00px" class="cls_010"><span class="cls_010">Memory Management and the TLB</span></div>
<div style="position:absolute;left:463.02px;top:403.00px" class="cls_010"><span class="cls_010">6</span></div>
<div style="position:absolute;left:55.00px;top:417.00px" class="cls_011"><span class="cls_011">Memory Management and the TLB</span></div>
<div style="position:absolute;left:453.01px;top:417.00px" class="cls_011"><span class="cls_011">6-1</span></div>
<div style="position:absolute;left:73.00px;top:431.00px" class="cls_011"><span class="cls_011">MMU Registers Described</span></div>
<div style="position:absolute;left:453.03px;top:431.00px" class="cls_011"><span class="cls_011">6-3</span></div>
<div style="position:absolute;left:91.00px;top:445.01px" class="cls_011"><span class="cls_011">EntryHi, EntryLo</span></div>
<div style="position:absolute;left:453.01px;top:445.01px" class="cls_011"><span class="cls_011">6-3</span></div>
<div style="position:absolute;left:91.00px;top:459.01px" class="cls_011"><span class="cls_011">Index</span></div>
<div style="position:absolute;left:453.00px;top:459.01px" class="cls_011"><span class="cls_011">6-4</span></div>
<div style="position:absolute;left:91.00px;top:473.02px" class="cls_011"><span class="cls_011">Random</span></div>
<div style="position:absolute;left:453.00px;top:473.02px" class="cls_011"><span class="cls_011">6-4</span></div>
<div style="position:absolute;left:91.00px;top:487.02px" class="cls_011"><span class="cls_011">Context</span></div>
<div style="position:absolute;left:453.00px;top:487.02px" class="cls_011"><span class="cls_011">6-4</span></div>
<div style="position:absolute;left:72.00px;top:501.02px" class="cls_011"><span class="cls_011">MMU Control Instructions</span></div>
<div style="position:absolute;left:453.03px;top:501.02px" class="cls_011"><span class="cls_011">6-5</span></div>
<div style="position:absolute;left:72.00px;top:515.03px" class="cls_011"><span class="cls_011">Programming Interface to the TLB</span></div>
<div style="position:absolute;left:453.03px;top:515.03px" class="cls_011"><span class="cls_011">6-5</span></div>
<div style="position:absolute;left:91.00px;top:529.03px" class="cls_011"><span class="cls_011">How Refill Happens</span></div>
<div style="position:absolute;left:453.01px;top:529.03px" class="cls_011"><span class="cls_011">6-5</span></div>
<div style="position:absolute;left:91.00px;top:543.04px" class="cls_011"><span class="cls_011">Using ASIDs</span></div>
<div style="position:absolute;left:453.03px;top:543.04px" class="cls_011"><span class="cls_011">6-6</span></div>
<div style="position:absolute;left:91.00px;top:557.04px" class="cls_011"><span class="cls_011">The Random Register and Wired Entries</span></div>
<div style="position:absolute;left:453.01px;top:557.04px" class="cls_011"><span class="cls_011">6-6</span></div>
<div style="position:absolute;left:73.00px;top:571.04px" class="cls_011"><span class="cls_011">Memory Translation - Setup</span></div>
<div style="position:absolute;left:453.01px;top:571.04px" class="cls_011"><span class="cls_011">6-6</span></div>
<div style="position:absolute;left:73.00px;top:585.05px" class="cls_011"><span class="cls_011">TLB Exception Sample Code</span></div>
<div style="position:absolute;left:453.01px;top:585.05px" class="cls_011"><span class="cls_011">6-7</span></div>
<div style="position:absolute;left:91.00px;top:599.05px" class="cls_011"><span class="cls_011">Basic Exception Handler</span></div>
<div style="position:absolute;left:453.01px;top:599.05px" class="cls_011"><span class="cls_011">6-7</span></div>
<div style="position:absolute;left:91.00px;top:613.06px" class="cls_011"><span class="cls_011">Fast kuseg Refill from Page Table</span></div>
<div style="position:absolute;left:453.02px;top:613.06px" class="cls_011"><span class="cls_011">6-7</span></div>
<div style="position:absolute;left:73.00px;top:627.06px" class="cls_011"><span class="cls_011">Simulating Dirty Bits</span></div>
<div style="position:absolute;left:453.01px;top:627.06px" class="cls_011"><span class="cls_011">6-8</span></div>
<div style="position:absolute;left:55.00px;top:641.06px" class="cls_011"><span class="cls_011">Use of TLB in Debugging</span></div>
<div style="position:absolute;left:453.01px;top:641.06px" class="cls_011"><span class="cls_011">6-8</span></div>
<div style="position:absolute;left:55.00px;top:655.07px" class="cls_011"><span class="cls_011">TLB Management Utilities</span></div>
<div style="position:absolute;left:453.00px;top:655.07px" class="cls_011"><span class="cls_011">6-9</span></div>
<div style="position:absolute;left:37.00px;top:669.00px" class="cls_010"><span class="cls_010">Reset Initialization</span></div>
<div style="position:absolute;left:463.02px;top:669.00px" class="cls_010"><span class="cls_010">7</span></div>
<div style="position:absolute;left:55.00px;top:683.00px" class="cls_011"><span class="cls_011">Starting Up</span></div>
<div style="position:absolute;left:453.01px;top:683.00px" class="cls_011"><span class="cls_011">7-1</span></div>
<div style="position:absolute;left:72.00px;top:697.00px" class="cls_011"><span class="cls_011">Probing and Recognizing the CPU</span></div>
<div style="position:absolute;left:453.02px;top:697.00px" class="cls_011"><span class="cls_011">7-4</span></div>
<div style="position:absolute;left:72.00px;top:711.01px" class="cls_011"><span class="cls_011">Bootstrap Sequences</span></div>
<div style="position:absolute;left:453.02px;top:711.01px" class="cls_011"><span class="cls_011">7-5</span></div>
<div style="position:absolute;left:72.00px;top:725.01px" class="cls_011"><span class="cls_011">Starting Up an Application</span></div>
<div style="position:absolute;left:453.01px;top:725.01px" class="cls_011"><span class="cls_011">7-5</span></div>
<div style="position:absolute;left:293.02px;top:755.33px" class="cls_002"><span class="cls_002">i-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:4812px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">Table of Contents</span></div>
<div style="position:absolute;left:144.00px;top:50.00px" class="cls_010"><span class="cls_010">Floating Point Coprocessor</span></div>
<div style="position:absolute;left:570.02px;top:50.00px" class="cls_010"><span class="cls_010">8</span></div>
<div style="position:absolute;left:162.00px;top:64.00px" class="cls_011"><span class="cls_011">The IEEE754 Standard and its Background</span></div>
<div style="position:absolute;left:560.02px;top:64.00px" class="cls_011"><span class="cls_011">8-1</span></div>
<div style="position:absolute;left:162.00px;top:78.00px" class="cls_011"><span class="cls_011">What is Floating Point?</span></div>
<div style="position:absolute;left:560.01px;top:78.00px" class="cls_011"><span class="cls_011">8-2</span></div>
<div style="position:absolute;left:180.00px;top:92.01px" class="cls_011"><span class="cls_011">IEEE exponent field and bias</span></div>
<div style="position:absolute;left:560.02px;top:92.01px" class="cls_011"><span class="cls_011">8-3</span></div>
<div style="position:absolute;left:180.00px;top:106.01px" class="cls_011"><span class="cls_011">IEEE mantissa and normalization</span></div>
<div style="position:absolute;left:560.01px;top:106.01px" class="cls_011"><span class="cls_011">8-3</span></div>
<div style="position:absolute;left:180.00px;top:120.02px" class="cls_011"><span class="cls_011">Strange values use reserved exponent values</span></div>
<div style="position:absolute;left:560.03px;top:120.02px" class="cls_011"><span class="cls_011">8-3</span></div>
<div style="position:absolute;left:180.00px;top:134.02px" class="cls_011"><span class="cls_011">MIPS FP Data formats</span></div>
<div style="position:absolute;left:560.03px;top:134.02px" class="cls_011"><span class="cls_011">8-4</span></div>
<div style="position:absolute;left:162.00px;top:148.02px" class="cls_011"><span class="cls_011">MIPS Implementation of IEEE754</span></div>
<div style="position:absolute;left:560.02px;top:148.02px" class="cls_011"><span class="cls_011">8-5</span></div>
<div style="position:absolute;left:162.00px;top:162.03px" class="cls_011"><span class="cls_011">Floating Point Registers</span></div>
<div style="position:absolute;left:560.02px;top:162.03px" class="cls_011"><span class="cls_011">8-6</span></div>
<div style="position:absolute;left:162.00px;top:176.03px" class="cls_011"><span class="cls_011">Floating Point Eeceptions/Interrupts</span></div>
<div style="position:absolute;left:559.98px;top:176.03px" class="cls_011"><span class="cls_011">8-6</span></div>
<div style="position:absolute;left:162.00px;top:190.04px" class="cls_011"><span class="cls_011">The Floating Point Control/Status Register</span></div>
<div style="position:absolute;left:560.03px;top:190.04px" class="cls_011"><span class="cls_011">8-6</span></div>
<div style="position:absolute;left:162.00px;top:204.04px" class="cls_011"><span class="cls_011">Floating Point Implementation/Revision Register</span></div>
<div style="position:absolute;left:560.03px;top:204.04px" class="cls_011"><span class="cls_011">8-8</span></div>
<div style="position:absolute;left:162.00px;top:218.04px" class="cls_011"><span class="cls_011">Guide to FP Instructions</span></div>
<div style="position:absolute;left:560.02px;top:218.04px" class="cls_011"><span class="cls_011">8-8</span></div>
<div style="position:absolute;left:180.00px;top:232.05px" class="cls_011"><span class="cls_011">Load/Store</span></div>
<div style="position:absolute;left:560.01px;top:232.05px" class="cls_011"><span class="cls_011">8-8</span></div>
<div style="position:absolute;left:180.00px;top:246.05px" class="cls_011"><span class="cls_011">Move Between Registers</span></div>
<div style="position:absolute;left:560.02px;top:246.05px" class="cls_011"><span class="cls_011">8-9</span></div>
<div style="position:absolute;left:180.00px;top:260.06px" class="cls_011"><span class="cls_011">3-Operand Arithmetic Operations</span></div>
<div style="position:absolute;left:560.02px;top:260.06px" class="cls_011"><span class="cls_011">8-9</span></div>
<div style="position:absolute;left:180.00px;top:274.06px" class="cls_011"><span class="cls_011">Unary (sign-changing) Operations</span></div>
<div style="position:absolute;left:554.03px;top:274.06px" class="cls_011"><span class="cls_011">8-10</span></div>
<div style="position:absolute;left:180.00px;top:288.06px" class="cls_011"><span class="cls_011">Conversion Operations</span></div>
<div style="position:absolute;left:553.99px;top:288.06px" class="cls_011"><span class="cls_011">8-10</span></div>
<div style="position:absolute;left:180.00px;top:302.07px" class="cls_011"><span class="cls_011">Conditional Branch and Test Instructions</span></div>
<div style="position:absolute;left:553.97px;top:302.07px" class="cls_011"><span class="cls_011">8-10</span></div>
<div style="position:absolute;left:162.00px;top:316.07px" class="cls_011"><span class="cls_011">Instruction Timing Requirements</span></div>
<div style="position:absolute;left:554.02px;top:316.07px" class="cls_011"><span class="cls_011">8-12</span></div>
<div style="position:absolute;left:162.00px;top:330.08px" class="cls_011"><span class="cls_011">Instruction Timing for Speed</span></div>
<div style="position:absolute;left:554.02px;top:330.08px" class="cls_011"><span class="cls_011">8-12</span></div>
<div style="position:absolute;left:162.00px;top:344.08px" class="cls_011"><span class="cls_011">Initialization and Enable On Demand</span></div>
<div style="position:absolute;left:554.01px;top:344.08px" class="cls_011"><span class="cls_011">8-12</span></div>
<div style="position:absolute;left:162.00px;top:358.08px" class="cls_011"><span class="cls_011">Floating Point Emulation</span></div>
<div style="position:absolute;left:554.01px;top:358.08px" class="cls_011"><span class="cls_011">8-13</span></div>
<div style="position:absolute;left:144.00px;top:372.00px" class="cls_010"><span class="cls_010">Assembler Language Programming</span></div>
<div style="position:absolute;left:570.03px;top:372.00px" class="cls_010"><span class="cls_010">9</span></div>
<div style="position:absolute;left:162.00px;top:386.00px" class="cls_011"><span class="cls_011">Syntax Overview</span></div>
<div style="position:absolute;left:560.01px;top:386.00px" class="cls_011"><span class="cls_011">9-1</span></div>
<div style="position:absolute;left:180.00px;top:400.00px" class="cls_011"><span class="cls_011">Key Points to Note</span></div>
<div style="position:absolute;left:560.01px;top:400.00px" class="cls_011"><span class="cls_011">9-1</span></div>
<div style="position:absolute;left:162.00px;top:414.01px" class="cls_011"><span class="cls_011">Register-to-Register Instructions</span></div>
<div style="position:absolute;left:560.03px;top:414.01px" class="cls_011"><span class="cls_011">9-2</span></div>
<div style="position:absolute;left:162.00px;top:428.01px" class="cls_011"><span class="cls_011">Immediate (Constant) Operands</span></div>
<div style="position:absolute;left:560.02px;top:428.01px" class="cls_011"><span class="cls_011">9-3</span></div>
<div style="position:absolute;left:162.00px;top:442.02px" class="cls_011"><span class="cls_011">Multiply/Divide</span></div>
<div style="position:absolute;left:560.00px;top:442.02px" class="cls_011"><span class="cls_011">9-4</span></div>
<div style="position:absolute;left:162.00px;top:456.02px" class="cls_011"><span class="cls_011">Load/Store Instructions</span></div>
<div style="position:absolute;left:560.02px;top:456.02px" class="cls_011"><span class="cls_011">9-5</span></div>
<div style="position:absolute;left:180.00px;top:470.02px" class="cls_011"><span class="cls_011">Unaligned Loads and Store</span></div>
<div style="position:absolute;left:560.02px;top:470.02px" class="cls_011"><span class="cls_011">9-5</span></div>
<div style="position:absolute;left:162.00px;top:484.03px" class="cls_011"><span class="cls_011">Addressing Modes</span></div>
<div style="position:absolute;left:560.02px;top:484.03px" class="cls_011"><span class="cls_011">9-6</span></div>
<div style="position:absolute;left:180.00px;top:498.03px" class="cls_011"><span class="cls_011">Gp-Relative Addressing</span></div>
<div style="position:absolute;left:560.02px;top:498.03px" class="cls_011"><span class="cls_011">9-6</span></div>
<div style="position:absolute;left:162.00px;top:512.04px" class="cls_011"><span class="cls_011">Jumps, Subroutine Calls and Branches</span></div>
<div style="position:absolute;left:560.03px;top:512.04px" class="cls_011"><span class="cls_011">9-8</span></div>
<div style="position:absolute;left:162.00px;top:526.04px" class="cls_011"><span class="cls_011">Conditional Branches</span></div>
<div style="position:absolute;left:560.01px;top:526.04px" class="cls_011"><span class="cls_011">9-8</span></div>
<div style="position:absolute;left:180.00px;top:540.04px" class="cls_011"><span class="cls_011">Co-processor Conditional Branches</span></div>
<div style="position:absolute;left:560.03px;top:540.04px" class="cls_011"><span class="cls_011">9-9</span></div>
<div style="position:absolute;left:162.00px;top:554.05px" class="cls_011"><span class="cls_011">Compare and Set</span></div>
<div style="position:absolute;left:560.01px;top:554.05px" class="cls_011"><span class="cls_011">9-9</span></div>
<div style="position:absolute;left:162.00px;top:568.05px" class="cls_011"><span class="cls_011">Coprocessor Transfers</span></div>
<div style="position:absolute;left:560.03px;top:568.05px" class="cls_011"><span class="cls_011">9-9</span></div>
<div style="position:absolute;left:180.00px;top:582.06px" class="cls_011"><span class="cls_011">Coprocessor Hazards</span></div>
<div style="position:absolute;left:554.03px;top:582.06px" class="cls_011"><span class="cls_011">9-10</span></div>
<div style="position:absolute;left:162.00px;top:596.06px" class="cls_011"><span class="cls_011">Assembler Directives</span></div>
<div style="position:absolute;left:554.03px;top:596.06px" class="cls_011"><span class="cls_011">9-10</span></div>
<div style="position:absolute;left:180.00px;top:610.06px" class="cls_011"><span class="cls_011">Sections</span></div>
<div style="position:absolute;left:554.01px;top:610.06px" class="cls_011"><span class="cls_011">9-10</span></div>
<div style="position:absolute;left:198.00px;top:624.07px" class="cls_011"><span class="cls_011">.text, .rdata, .data</span></div>
<div style="position:absolute;left:554.01px;top:624.07px" class="cls_011"><span class="cls_011">9-10</span></div>
<div style="position:absolute;left:198.00px;top:638.07px" class="cls_011"><span class="cls_011">.lit4, .lit8</span></div>
<div style="position:absolute;left:554.00px;top:638.07px" class="cls_011"><span class="cls_011">9-10</span></div>
<div style="position:absolute;left:198.00px;top:652.08px" class="cls_011"><span class="cls_011">Program Segments in Memory</span></div>
<div style="position:absolute;left:554.03px;top:652.08px" class="cls_011"><span class="cls_011">9-11</span></div>
<div style="position:absolute;left:198.00px;top:666.08px" class="cls_011"><span class="cls_011">.bss</span></div>
<div style="position:absolute;left:554.01px;top:666.08px" class="cls_011"><span class="cls_011">9-12</span></div>
<div style="position:absolute;left:198.00px;top:680.08px" class="cls_011"><span class="cls_011">.sdata, .sbss</span></div>
<div style="position:absolute;left:554.02px;top:680.08px" class="cls_011"><span class="cls_011">9-12</span></div>
<div style="position:absolute;left:198.00px;top:694.09px" class="cls_011"><span class="cls_011">Stack and Heap</span></div>
<div style="position:absolute;left:554.01px;top:694.09px" class="cls_011"><span class="cls_011">9-12</span></div>
<div style="position:absolute;left:198.00px;top:708.09px" class="cls_011"><span class="cls_011">Special Symbols</span></div>
<div style="position:absolute;left:554.01px;top:708.09px" class="cls_011"><span class="cls_011">9-12</span></div>
<div style="position:absolute;left:180.00px;top:722.10px" class="cls_011"><span class="cls_011">Data Definition and Alignment</span></div>
<div style="position:absolute;left:554.02px;top:722.10px" class="cls_011"><span class="cls_011">9-12</span></div>
<div style="position:absolute;left:306.77px;top:755.33px" class="cls_002"><span class="cls_002">i-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:5614px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:492.78px;top:28.00px" class="cls_002"><span class="cls_002">Table of Contents</span></div>
<div style="position:absolute;left:90.00px;top:57.00px" class="cls_011"><span class="cls_011">.byte, .half, .word</span></div>
<div style="position:absolute;left:446.01px;top:57.00px" class="cls_011"><span class="cls_011">9-13</span></div>
<div style="position:absolute;left:90.00px;top:71.00px" class="cls_011"><span class="cls_011">.float, .double</span></div>
<div style="position:absolute;left:446.01px;top:71.00px" class="cls_011"><span class="cls_011">9-13</span></div>
<div style="position:absolute;left:90.00px;top:85.01px" class="cls_011"><span class="cls_011">.ascii, .asciiz</span></div>
<div style="position:absolute;left:446.01px;top:85.01px" class="cls_011"><span class="cls_011">9-13</span></div>
<div style="position:absolute;left:90.00px;top:99.01px" class="cls_011"><span class="cls_011">.align</span></div>
<div style="position:absolute;left:446.00px;top:99.01px" class="cls_011"><span class="cls_011">9-13</span></div>
<div style="position:absolute;left:90.00px;top:113.02px" class="cls_011"><span class="cls_011">.comm, .lcomm</span></div>
<div style="position:absolute;left:446.00px;top:113.02px" class="cls_011"><span class="cls_011">9-13</span></div>
<div style="position:absolute;left:90.00px;top:127.02px" class="cls_011"><span class="cls_011">.space</span></div>
<div style="position:absolute;left:446.01px;top:127.02px" class="cls_011"><span class="cls_011">9-14</span></div>
<div style="position:absolute;left:72.00px;top:141.02px" class="cls_011"><span class="cls_011">Symbol Binding Attributes</span></div>
<div style="position:absolute;left:446.02px;top:141.02px" class="cls_011"><span class="cls_011">9-14</span></div>
<div style="position:absolute;left:90.00px;top:155.03px" class="cls_011"><span class="cls_011">.globl</span></div>
<div style="position:absolute;left:446.00px;top:155.03px" class="cls_011"><span class="cls_011">9-14</span></div>
<div style="position:absolute;left:90.00px;top:169.03px" class="cls_011"><span class="cls_011">.extern</span></div>
<div style="position:absolute;left:446.01px;top:169.03px" class="cls_011"><span class="cls_011">9-15</span></div>
<div style="position:absolute;left:90.00px;top:183.04px" class="cls_011"><span class="cls_011">.weakext</span></div>
<div style="position:absolute;left:446.01px;top:183.04px" class="cls_011"><span class="cls_011">9-15</span></div>
<div style="position:absolute;left:72.00px;top:197.04px" class="cls_011"><span class="cls_011">Function Directives</span></div>
<div style="position:absolute;left:446.02px;top:197.04px" class="cls_011"><span class="cls_011">9-15</span></div>
<div style="position:absolute;left:90.00px;top:211.04px" class="cls_011"><span class="cls_011">.ent, .end</span></div>
<div style="position:absolute;left:446.01px;top:211.04px" class="cls_011"><span class="cls_011">9-15</span></div>
<div style="position:absolute;left:90.00px;top:225.05px" class="cls_011"><span class="cls_011">.aent</span></div>
<div style="position:absolute;left:446.01px;top:225.05px" class="cls_011"><span class="cls_011">9-16</span></div>
<div style="position:absolute;left:90.00px;top:239.05px" class="cls_011"><span class="cls_011">.frame, .mask, .fmask</span></div>
<div style="position:absolute;left:446.02px;top:239.05px" class="cls_011"><span class="cls_011">9-16</span></div>
<div style="position:absolute;left:72.00px;top:253.06px" class="cls_011"><span class="cls_011">Assembler Control (.set)</span></div>
<div style="position:absolute;left:446.03px;top:253.06px" class="cls_011"><span class="cls_011">9-17</span></div>
<div style="position:absolute;left:90.00px;top:267.06px" class="cls_011"><span class="cls_011">.set noreorder/reorder</span></div>
<div style="position:absolute;left:446.03px;top:267.06px" class="cls_011"><span class="cls_011">9-17</span></div>
<div style="position:absolute;left:90.00px;top:281.06px" class="cls_011"><span class="cls_011">.set volatile/novolatile</span></div>
<div style="position:absolute;left:446.01px;top:281.06px" class="cls_011"><span class="cls_011">9-17</span></div>
<div style="position:absolute;left:90.00px;top:295.07px" class="cls_011"><span class="cls_011">.set noat/at</span></div>
<div style="position:absolute;left:446.00px;top:295.07px" class="cls_011"><span class="cls_011">9-18</span></div>
<div style="position:absolute;left:90.00px;top:309.07px" class="cls_011"><span class="cls_011">.set nomacro/macro</span></div>
<div style="position:absolute;left:446.01px;top:309.07px" class="cls_011"><span class="cls_011">9-18</span></div>
<div style="position:absolute;left:90.00px;top:323.08px" class="cls_011"><span class="cls_011">.set nobopt/bopt</span></div>
<div style="position:absolute;left:446.01px;top:323.08px" class="cls_011"><span class="cls_011">9-18</span></div>
<div style="position:absolute;left:54.00px;top:337.08px" class="cls_011"><span class="cls_011">The Complete Guide to Assembler Instructions</span></div>
<div style="position:absolute;left:446.03px;top:337.08px" class="cls_011"><span class="cls_011">9-18</span></div>
<div style="position:absolute;left:54.00px;top:351.08px" class="cls_011"><span class="cls_011">Alphabetic List of Assembler Instructions</span></div>
<div style="position:absolute;left:446.03px;top:351.08px" class="cls_011"><span class="cls_011">9-30</span></div>
<div style="position:absolute;left:36.00px;top:365.00px" class="cls_010"><span class="cls_010">C Programming</span></div>
<div style="position:absolute;left:456.01px;top:365.00px" class="cls_010"><span class="cls_010">10</span></div>
<div style="position:absolute;left:54.00px;top:379.00px" class="cls_011"><span class="cls_011">The Stack, Subroutine Linkage, Parameter Passing</span></div>
<div style="position:absolute;left:446.03px;top:379.00px" class="cls_011"><span class="cls_011">10-1</span></div>
<div style="position:absolute;left:72.00px;top:393.00px" class="cls_011"><span class="cls_011">Stack Argument Structure</span></div>
<div style="position:absolute;left:446.03px;top:393.00px" class="cls_011"><span class="cls_011">10-1</span></div>
<div style="position:absolute;left:72.00px;top:407.01px" class="cls_011"><span class="cls_011">Which Arguments go in What Registers</span></div>
<div style="position:absolute;left:446.02px;top:407.01px" class="cls_011"><span class="cls_011">10-1</span></div>
<div style="position:absolute;left:72.00px;top:421.01px" class="cls_011"><span class="cls_011">Examples from the C Library</span></div>
<div style="position:absolute;left:446.02px;top:421.01px" class="cls_011"><span class="cls_011">10-2</span></div>
<div style="position:absolute;left:72.00px;top:435.02px" class="cls_011"><span class="cls_011">Exotic Example; Passing Structures</span></div>
<div style="position:absolute;left:446.03px;top:435.02px" class="cls_011"><span class="cls_011">10-2</span></div>
<div style="position:absolute;left:72.00px;top:449.02px" class="cls_011"><span class="cls_011">How Printf() and Varargs Work</span></div>
<div style="position:absolute;left:446.04px;top:449.02px" class="cls_011"><span class="cls_011">10-3</span></div>
<div style="position:absolute;left:72.00px;top:463.02px" class="cls_011"><span class="cls_011">Returning Value from a Function</span></div>
<div style="position:absolute;left:446.02px;top:463.02px" class="cls_011"><span class="cls_011">10-4</span></div>
<div style="position:absolute;left:72.00px;top:477.03px" class="cls_011"><span class="cls_011">Macros for Prologues and Epilogues</span></div>
<div style="position:absolute;left:446.03px;top:477.03px" class="cls_011"><span class="cls_011">10-4</span></div>
<div style="position:absolute;left:72.00px;top:491.03px" class="cls_011"><span class="cls_011">Stack-Frame Allocation</span></div>
<div style="position:absolute;left:446.02px;top:491.03px" class="cls_011"><span class="cls_011">10-4</span></div>
<div style="position:absolute;left:90.00px;top:505.04px" class="cls_011"><span class="cls_011">Leaf Functions</span></div>
<div style="position:absolute;left:446.01px;top:505.04px" class="cls_011"><span class="cls_011">10-4</span></div>
<div style="position:absolute;left:90.00px;top:519.04px" class="cls_011"><span class="cls_011">Non-Leaf Functions</span></div>
<div style="position:absolute;left:446.02px;top:519.04px" class="cls_011"><span class="cls_011">10-5</span></div>
<div style="position:absolute;left:90.00px;top:533.04px" class="cls_011"><span class="cls_011">Functions Needing Run-Time Computed Stack Locations</span></div>
<div style="position:absolute;left:446.02px;top:533.04px" class="cls_011"><span class="cls_011">10-7</span></div>
<div style="position:absolute;left:54.00px;top:547.05px" class="cls_011"><span class="cls_011">Shared and Non-Shared Libraries</span></div>
<div style="position:absolute;left:446.03px;top:547.05px" class="cls_011"><span class="cls_011">10-9</span></div>
<div style="position:absolute;left:72.00px;top:561.05px" class="cls_011"><span class="cls_011">Sharing Code in Single-Address Space Systems</span></div>
<div style="position:absolute;left:446.04px;top:561.05px" class="cls_011"><span class="cls_011">10-9</span></div>
<div style="position:absolute;left:72.00px;top:575.06px" class="cls_011"><span class="cls_011">Sharing Code Across Address Spaces</span></div>
<div style="position:absolute;left:440.04px;top:575.06px" class="cls_011"><span class="cls_011">10-10</span></div>
<div style="position:absolute;left:54.00px;top:589.06px" class="cls_011"><span class="cls_011">An Introduction to Optimization</span></div>
<div style="position:absolute;left:440.02px;top:589.06px" class="cls_011"><span class="cls_011">10-11</span></div>
<div style="position:absolute;left:72.00px;top:603.06px" class="cls_011"><span class="cls_011">Common Optimizations</span></div>
<div style="position:absolute;left:440.01px;top:603.06px" class="cls_011"><span class="cls_011">10-11</span></div>
<div style="position:absolute;left:72.00px;top:617.07px" class="cls_011"><span class="cls_011">How to Prevent Unwanted Effects From Optimization</span></div>
<div style="position:absolute;left:440.04px;top:617.07px" class="cls_011"><span class="cls_011">10-14</span></div>
<div style="position:absolute;left:72.00px;top:631.07px" class="cls_011"><span class="cls_011">Optimizer-Unfriendly Code and How to Avoid It</span></div>
<div style="position:absolute;left:440.04px;top:631.07px" class="cls_011"><span class="cls_011">10-15</span></div>
<div style="position:absolute;left:36.00px;top:645.00px" class="cls_010"><span class="cls_010">Portability Considerations</span></div>
<div style="position:absolute;left:456.03px;top:645.00px" class="cls_010"><span class="cls_010">11</span></div>
<div style="position:absolute;left:54.00px;top:659.00px" class="cls_011"><span class="cls_011">Writing Portable C</span></div>
<div style="position:absolute;left:446.01px;top:659.00px" class="cls_011"><span class="cls_011">11-1</span></div>
<div style="position:absolute;left:72.00px;top:673.00px" class="cls_011"><span class="cls_011">C Language Standards</span></div>
<div style="position:absolute;left:446.02px;top:673.00px" class="cls_011"><span class="cls_011">11-1</span></div>
<div style="position:absolute;left:72.00px;top:687.01px" class="cls_011"><span class="cls_011">C Library Functions and POSIX</span></div>
<div style="position:absolute;left:446.03px;top:687.01px" class="cls_011"><span class="cls_011">11-2</span></div>
<div style="position:absolute;left:53.00px;top:701.01px" class="cls_011"><span class="cls_011">Data Representations and Alignment</span></div>
<div style="position:absolute;left:446.02px;top:701.01px" class="cls_011"><span class="cls_011">11-3</span></div>
<div style="position:absolute;left:72.00px;top:715.02px" class="cls_011"><span class="cls_011">Notes on Structure Layout and Padding</span></div>
<div style="position:absolute;left:446.02px;top:715.02px" class="cls_011"><span class="cls_011">11-3</span></div>
<div style="position:absolute;left:54.00px;top:729.02px" class="cls_011"><span class="cls_011">Isolating System Dependencies</span></div>
<div style="position:absolute;left:446.02px;top:729.02px" class="cls_011"><span class="cls_011">11-5</span></div>
<div style="position:absolute;left:293.02px;top:755.33px" class="cls_002"><span class="cls_002">i-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:6416px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">Table of Contents</span></div>
<div style="position:absolute;left:180.00px;top:50.00px" class="cls_011"><span class="cls_011">Locating System Dependencies</span></div>
<div style="position:absolute;left:554.02px;top:50.00px" class="cls_011"><span class="cls_011">11-5</span></div>
<div style="position:absolute;left:180.00px;top:64.00px" class="cls_011"><span class="cls_011">Fixing Up Dependencies</span></div>
<div style="position:absolute;left:554.02px;top:64.00px" class="cls_011"><span class="cls_011">11-5</span></div>
<div style="position:absolute;left:198.00px;top:78.01px" class="cls_011"><span class="cls_011">Isolating Non-Portable Code</span></div>
<div style="position:absolute;left:554.02px;top:78.01px" class="cls_011"><span class="cls_011">11-6</span></div>
<div style="position:absolute;left:180.00px;top:92.01px" class="cls_011"><span class="cls_011">Using Assembler</span></div>
<div style="position:absolute;left:554.02px;top:92.01px" class="cls_011"><span class="cls_011">11-6</span></div>
<div style="position:absolute;left:162.00px;top:106.02px" class="cls_011"><span class="cls_011">Endianness</span></div>
<div style="position:absolute;left:554.01px;top:106.02px" class="cls_011"><span class="cls_011">11-7</span></div>
<div style="position:absolute;left:180.00px;top:120.02px" class="cls_011"><span class="cls_011">What It Means to the Programmer</span></div>
<div style="position:absolute;left:554.02px;top:120.02px" class="cls_011"><span class="cls_011">11-8</span></div>
<div style="position:absolute;left:198.00px;top:134.02px" class="cls_011"><span class="cls_011">Bitfield Layout and Endianness</span></div>
<div style="position:absolute;left:554.02px;top:134.02px" class="cls_011"><span class="cls_011">11-9</span></div>
<div style="position:absolute;left:180.00px;top:148.03px" class="cls_011"><span class="cls_011">Changing the Endianness of a MIPS CPU</span></div>
<div style="position:absolute;left:548.04px;top:148.03px" class="cls_011"><span class="cls_011">11-10</span></div>
<div style="position:absolute;left:180.00px;top:162.03px" class="cls_011"><span class="cls_011">Designing and Specifying for Configurable Endianness</span></div>
<div style="position:absolute;left:548.03px;top:162.03px" class="cls_011"><span class="cls_011">11-10</span></div>
<div style="position:absolute;left:198.00px;top:176.04px" class="cls_011"><span class="cls_011">Read-Only Instruction Memory</span></div>
<div style="position:absolute;left:548.03px;top:176.04px" class="cls_011"><span class="cls_011">11-10</span></div>
<div style="position:absolute;left:198.00px;top:190.04px" class="cls_011"><span class="cls_011">Writable (Volatile) Memory</span></div>
<div style="position:absolute;left:548.02px;top:190.04px" class="cls_011"><span class="cls_011">11-11</span></div>
<div style="position:absolute;left:198.00px;top:204.04px" class="cls_011"><span class="cls_011">Byte-Lane Swapping</span></div>
<div style="position:absolute;left:548.02px;top:204.04px" class="cls_011"><span class="cls_011">11-11</span></div>
<div style="position:absolute;left:198.00px;top:218.05px" class="cls_011"><span class="cls_011">Configurable IO Controllers</span></div>
<div style="position:absolute;left:548.03px;top:218.05px" class="cls_011"><span class="cls_011">11-12</span></div>
<div style="position:absolute;left:180.00px;top:232.05px" class="cls_011"><span class="cls_011">Portability and Endianness-Independent Code</span></div>
<div style="position:absolute;left:548.03px;top:232.05px" class="cls_011"><span class="cls_011">11-13</span></div>
<div style="position:absolute;left:198.00px;top:246.06px" class="cls_011"><span class="cls_011">Endianness-Independent Code</span></div>
<div style="position:absolute;left:548.02px;top:246.06px" class="cls_011"><span class="cls_011">11-13</span></div>
<div style="position:absolute;left:162.00px;top:260.06px" class="cls_011"><span class="cls_011">Compatibility Within the R30XX Family</span></div>
<div style="position:absolute;left:548.00px;top:260.06px" class="cls_011"><span class="cls_011">11-13</span></div>
<div style="position:absolute;left:162.00px;top:274.06px" class="cls_011"><span class="cls_011">Porting to MIPS: Frequently Encountered Issues</span></div>
<div style="position:absolute;left:548.04px;top:274.06px" class="cls_011"><span class="cls_011">11-15</span></div>
<div style="position:absolute;left:162.00px;top:288.07px" class="cls_011"><span class="cls_011">Considerations for Portability to Future Devices</span></div>
<div style="position:absolute;left:548.04px;top:288.07px" class="cls_011"><span class="cls_011">11-16</span></div>
<div style="position:absolute;left:144.00px;top:302.00px" class="cls_010"><span class="cls_010">Writing Power-On Diagnostics</span></div>
<div style="position:absolute;left:564.03px;top:302.00px" class="cls_010"><span class="cls_010">12</span></div>
<div style="position:absolute;left:162.00px;top:316.00px" class="cls_011"><span class="cls_011">Golden Rules for Diagnostics Programming</span></div>
<div style="position:absolute;left:554.04px;top:316.00px" class="cls_011"><span class="cls_011">12-1</span></div>
<div style="position:absolute;left:162.00px;top:330.00px" class="cls_011"><span class="cls_011">What Should Tests Do?</span></div>
<div style="position:absolute;left:554.02px;top:330.00px" class="cls_011"><span class="cls_011">12-2</span></div>
<div style="position:absolute;left:162.00px;top:344.01px" class="cls_011"><span class="cls_011">How to Test the Diagnostic Tests?</span></div>
<div style="position:absolute;left:554.02px;top:344.01px" class="cls_011"><span class="cls_011">12-3</span></div>
<div style="position:absolute;left:162.00px;top:358.01px" class="cls_011"><span class="cls_011">Overview of Algorithmics’ Power-On Selftest</span></div>
<div style="position:absolute;left:554.05px;top:358.01px" class="cls_011"><span class="cls_011">12-3</span></div>
<div style="position:absolute;left:180.00px;top:372.02px" class="cls_011"><span class="cls_011">Starting Points</span></div>
<div style="position:absolute;left:554.01px;top:372.02px" class="cls_011"><span class="cls_011">12-3</span></div>
<div style="position:absolute;left:180.00px;top:386.02px" class="cls_011"><span class="cls_011">Control and Environment Variables</span></div>
<div style="position:absolute;left:554.02px;top:386.02px" class="cls_011"><span class="cls_011">12-4</span></div>
<div style="position:absolute;left:180.00px;top:400.02px" class="cls_011"><span class="cls_011">Reporting</span></div>
<div style="position:absolute;left:554.00px;top:400.02px" class="cls_011"><span class="cls_011">12-4</span></div>
<div style="position:absolute;left:180.00px;top:414.03px" class="cls_011"><span class="cls_011">Unexpected Exceptions During Test Sequence</span></div>
<div style="position:absolute;left:554.02px;top:414.03px" class="cls_011"><span class="cls_011">12-5</span></div>
<div style="position:absolute;left:180.00px;top:428.03px" class="cls_011"><span class="cls_011">Driving Test Output Devices</span></div>
<div style="position:absolute;left:554.02px;top:428.03px" class="cls_011"><span class="cls_011">12-5</span></div>
<div style="position:absolute;left:180.00px;top:442.04px" class="cls_011"><span class="cls_011">Restarting the System</span></div>
<div style="position:absolute;left:554.01px;top:442.04px" class="cls_011"><span class="cls_011">12-5</span></div>
<div style="position:absolute;left:180.00px;top:456.04px" class="cls_011"><span class="cls_011">Standard Test Sequence</span></div>
<div style="position:absolute;left:554.01px;top:456.04px" class="cls_011"><span class="cls_011">12-5</span></div>
<div style="position:absolute;left:180.00px;top:470.04px" class="cls_011"><span class="cls_011">Notes on the Test Sequence</span></div>
<div style="position:absolute;left:554.01px;top:470.04px" class="cls_011"><span class="cls_011">12-6</span></div>
<div style="position:absolute;left:180.00px;top:484.05px" class="cls_011"><span class="cls_011">Annotated Examples from the Test Code</span></div>
<div style="position:absolute;left:554.02px;top:484.05px" class="cls_011"><span class="cls_011">12-9</span></div>
<div style="position:absolute;left:144.00px;top:498.00px" class="cls_010"><span class="cls_010">Instruction Timing and Optimization</span></div>
<div style="position:absolute;left:564.05px;top:498.00px" class="cls_010"><span class="cls_010">13</span></div>
<div style="position:absolute;left:180.00px;top:512.00px" class="cls_011"><span class="cls_011">Notes and Examples</span></div>
<div style="position:absolute;left:554.02px;top:512.00px" class="cls_011"><span class="cls_011">13-1</span></div>
<div style="position:absolute;left:162.00px;top:526.00px" class="cls_011"><span class="cls_011">Additional Hazards</span></div>
<div style="position:absolute;left:554.02px;top:526.00px" class="cls_011"><span class="cls_011">13-2</span></div>
<div style="position:absolute;left:180.00px;top:540.01px" class="cls_011"><span class="cls_011">Early Modification of HI and LO</span></div>
<div style="position:absolute;left:554.03px;top:540.01px" class="cls_011"><span class="cls_011">13-2</span></div>
<div style="position:absolute;left:180.00px;top:554.01px" class="cls_011"><span class="cls_011">Bitfields in CPU Control Registers</span></div>
<div style="position:absolute;left:554.03px;top:554.01px" class="cls_011"><span class="cls_011">13-3</span></div>
<div style="position:absolute;left:180.00px;top:568.02px" class="cls_011"><span class="cls_011">Non-Obvious Hazards</span></div>
<div style="position:absolute;left:554.02px;top:568.02px" class="cls_011"><span class="cls_011">13-3</span></div>
<div style="position:absolute;left:144.00px;top:582.00px" class="cls_010"><span class="cls_010">Software Tools for Board Bring-Up</span></div>
<div style="position:absolute;left:564.04px;top:582.00px" class="cls_010"><span class="cls_010">14</span></div>
<div style="position:absolute;left:162.00px;top:596.00px" class="cls_011"><span class="cls_011">Tools Used in Debug</span></div>
<div style="position:absolute;left:554.01px;top:596.00px" class="cls_011"><span class="cls_011">14-1</span></div>
<div style="position:absolute;left:162.00px;top:610.00px" class="cls_011"><span class="cls_011">Initial Debugging</span></div>
<div style="position:absolute;left:554.00px;top:610.00px" class="cls_011"><span class="cls_011">14-2</span></div>
<div style="position:absolute;left:162.00px;top:624.01px" class="cls_011"><span class="cls_011">Porting Micromonitor</span></div>
<div style="position:absolute;left:554.02px;top:624.01px" class="cls_011"><span class="cls_011">14-2</span></div>
<div style="position:absolute;left:162.00px;top:638.01px" class="cls_011"><span class="cls_011">Running Micromonitor</span></div>
<div style="position:absolute;left:554.02px;top:638.01px" class="cls_011"><span class="cls_011">14-2</span></div>
<div style="position:absolute;left:162.00px;top:652.02px" class="cls_011"><span class="cls_011">Initial IDT/SIM Activity</span></div>
<div style="position:absolute;left:554.02px;top:652.02px" class="cls_011"><span class="cls_011">14-2</span></div>
<div style="position:absolute;left:162.00px;top:666.02px" class="cls_011"><span class="cls_011">A Final Note on IDT/KIT</span></div>
<div style="position:absolute;left:554.02px;top:666.02px" class="cls_011"><span class="cls_011">14-3</span></div>
<div style="position:absolute;left:144.00px;top:680.00px" class="cls_010"><span class="cls_010">Software Design Examples</span></div>
<div style="position:absolute;left:564.03px;top:680.00px" class="cls_010"><span class="cls_010">15</span></div>
<div style="position:absolute;left:162.00px;top:694.00px" class="cls_011"><span class="cls_011">Application Software</span></div>
<div style="position:absolute;left:554.02px;top:694.00px" class="cls_011"><span class="cls_011">15-1</span></div>
<div style="position:absolute;left:180.00px;top:708.00px" class="cls_011"><span class="cls_011">Memory Map</span></div>
<div style="position:absolute;left:554.01px;top:708.00px" class="cls_011"><span class="cls_011">15-1</span></div>
<div style="position:absolute;left:180.00px;top:722.01px" class="cls_011"><span class="cls_011">Starting Up</span></div>
<div style="position:absolute;left:554.01px;top:722.01px" class="cls_011"><span class="cls_011">15-1</span></div>
<div style="position:absolute;left:306.77px;top:755.33px" class="cls_002"><span class="cls_002">i-9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:7218px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:492.78px;top:28.00px" class="cls_002"><span class="cls_002">Table of Contents</span></div>
<div style="position:absolute;left:72.00px;top:57.00px" class="cls_011"><span class="cls_011">C Library Functions</span></div>
<div style="position:absolute;left:446.02px;top:57.00px" class="cls_011"><span class="cls_011">15-2</span></div>
<div style="position:absolute;left:90.00px;top:71.00px" class="cls_011"><span class="cls_011">Input and Output</span></div>
<div style="position:absolute;left:446.01px;top:71.00px" class="cls_011"><span class="cls_011">15-3</span></div>
<div style="position:absolute;left:90.00px;top:85.01px" class="cls_011"><span class="cls_011">Character Class Tests</span></div>
<div style="position:absolute;left:446.02px;top:85.01px" class="cls_011"><span class="cls_011">15-3</span></div>
<div style="position:absolute;left:90.00px;top:99.01px" class="cls_011"><span class="cls_011">String Functions</span></div>
<div style="position:absolute;left:446.01px;top:99.01px" class="cls_011"><span class="cls_011">15-3</span></div>
<div style="position:absolute;left:90.00px;top:113.02px" class="cls_011"><span class="cls_011">Mathematical Functions</span></div>
<div style="position:absolute;left:446.01px;top:113.02px" class="cls_011"><span class="cls_011">15-3</span></div>
<div style="position:absolute;left:90.00px;top:127.02px" class="cls_011"><span class="cls_011">Utility Functions</span></div>
<div style="position:absolute;left:446.02px;top:127.02px" class="cls_011"><span class="cls_011">15-3</span></div>
<div style="position:absolute;left:90.00px;top:141.02px" class="cls_011"><span class="cls_011">Diagnostics</span></div>
<div style="position:absolute;left:446.01px;top:141.02px" class="cls_011"><span class="cls_011">15-4</span></div>
<div style="position:absolute;left:90.00px;top:155.03px" class="cls_011"><span class="cls_011">Variable Argument Lists</span></div>
<div style="position:absolute;left:446.03px;top:155.03px" class="cls_011"><span class="cls_011">15-4</span></div>
<div style="position:absolute;left:90.00px;top:169.03px" class="cls_011"><span class="cls_011">Non-Local Jumps</span></div>
<div style="position:absolute;left:446.01px;top:169.03px" class="cls_011"><span class="cls_011">15-4</span></div>
<div style="position:absolute;left:90.00px;top:183.04px" class="cls_011"><span class="cls_011">Signals</span></div>
<div style="position:absolute;left:446.01px;top:183.04px" class="cls_011"><span class="cls_011">15-4</span></div>
<div style="position:absolute;left:90.00px;top:197.04px" class="cls_011"><span class="cls_011">Date and Time</span></div>
<div style="position:absolute;left:446.00px;top:197.04px" class="cls_011"><span class="cls_011">15-4</span></div>
<div style="position:absolute;left:72.00px;top:211.04px" class="cls_011"><span class="cls_011">Running the Program</span></div>
<div style="position:absolute;left:446.01px;top:211.04px" class="cls_011"><span class="cls_011">15-4</span></div>
<div style="position:absolute;left:72.00px;top:225.05px" class="cls_011"><span class="cls_011">Debugging the Program</span></div>
<div style="position:absolute;left:446.02px;top:225.05px" class="cls_011"><span class="cls_011">15-5</span></div>
<div style="position:absolute;left:54.00px;top:239.05px" class="cls_011"><span class="cls_011">Embedded System Software</span></div>
<div style="position:absolute;left:446.02px;top:239.05px" class="cls_011"><span class="cls_011">15-5</span></div>
<div style="position:absolute;left:72.00px;top:253.06px" class="cls_011"><span class="cls_011">Memory Map</span></div>
<div style="position:absolute;left:446.01px;top:253.06px" class="cls_011"><span class="cls_011">15-6</span></div>
<div style="position:absolute;left:72.00px;top:267.06px" class="cls_011"><span class="cls_011">Starting Up</span></div>
<div style="position:absolute;left:446.01px;top:267.06px" class="cls_011"><span class="cls_011">15-6</span></div>
<div style="position:absolute;left:72.00px;top:281.06px" class="cls_011"><span class="cls_011">Embedded System Library Functions</span></div>
<div style="position:absolute;left:446.02px;top:281.06px" class="cls_011"><span class="cls_011">15-7</span></div>
<div style="position:absolute;left:90.00px;top:295.07px" class="cls_011"><span class="cls_011">Trap and Interrupt Handling</span></div>
<div style="position:absolute;left:446.03px;top:295.07px" class="cls_011"><span class="cls_011">15-8</span></div>
<div style="position:absolute;left:90.00px;top:309.07px" class="cls_011"><span class="cls_011">Simple Interrupt Routines</span></div>
<div style="position:absolute;left:446.02px;top:309.07px" class="cls_011"><span class="cls_011">15-8</span></div>
<div style="position:absolute;left:90.00px;top:323.08px" class="cls_011"><span class="cls_011">Floating-Point Traps and Interrupts</span></div>
<div style="position:absolute;left:446.02px;top:323.08px" class="cls_011"><span class="cls_011">15-9</span></div>
<div style="position:absolute;left:90.00px;top:337.08px" class="cls_011"><span class="cls_011">Emulating Floating Point Instructions</span></div>
<div style="position:absolute;left:440.02px;top:337.08px" class="cls_011"><span class="cls_011">15-10</span></div>
<div style="position:absolute;left:72.00px;top:351.08px" class="cls_011"><span class="cls_011">Debugging</span></div>
<div style="position:absolute;left:440.00px;top:351.08px" class="cls_011"><span class="cls_011">15-10</span></div>
<div style="position:absolute;left:54.00px;top:365.09px" class="cls_011"><span class="cls_011">Unix-Like System S/W</span></div>
<div style="position:absolute;left:440.02px;top:365.09px" class="cls_011"><span class="cls_011">15-11</span></div>
<div style="position:absolute;left:72.00px;top:379.09px" class="cls_011"><span class="cls_011">Terminology</span></div>
<div style="position:absolute;left:440.01px;top:379.09px" class="cls_011"><span class="cls_011">15-11</span></div>
<div style="position:absolute;left:72.00px;top:393.10px" class="cls_011"><span class="cls_011">Components of a Process</span></div>
<div style="position:absolute;left:440.02px;top:393.10px" class="cls_011"><span class="cls_011">15-12</span></div>
<div style="position:absolute;left:72.00px;top:407.10px" class="cls_011"><span class="cls_011">System Calls and Protection</span></div>
<div style="position:absolute;left:440.02px;top:407.10px" class="cls_011"><span class="cls_011">15-13</span></div>
<div style="position:absolute;left:72.00px;top:421.10px" class="cls_011"><span class="cls_011">What the Kernel Does</span></div>
<div style="position:absolute;left:440.02px;top:421.10px" class="cls_011"><span class="cls_011">15-13</span></div>
<div style="position:absolute;left:72.00px;top:435.11px" class="cls_011"><span class="cls_011">Virtual Memory Implementation for MIPS</span></div>
<div style="position:absolute;left:440.03px;top:435.11px" class="cls_011"><span class="cls_011">15-14</span></div>
<div style="position:absolute;left:72.00px;top:449.11px" class="cls_011"><span class="cls_011">Interrupt Handling for MIPS</span></div>
<div style="position:absolute;left:440.04px;top:449.11px" class="cls_011"><span class="cls_011">15-15</span></div>
<div style="position:absolute;left:90.00px;top:463.12px" class="cls_011"><span class="cls_011">How it Works</span></div>
<div style="position:absolute;left:440.02px;top:463.12px" class="cls_011"><span class="cls_011">15-16</span></div>
<div style="position:absolute;left:36.00px;top:477.00px" class="cls_010"><span class="cls_010">Assembly Language Programming Tips</span></div>
<div style="position:absolute;left:456.04px;top:477.00px" class="cls_010"><span class="cls_010">16</span></div>
<div style="position:absolute;left:72.00px;top:491.00px" class="cls_011"><span class="cls_011">32-bit Address or Constant Values</span></div>
<div style="position:absolute;left:446.03px;top:491.00px" class="cls_011"><span class="cls_011">16-1</span></div>
<div style="position:absolute;left:72.00px;top:505.00px" class="cls_011"><span class="cls_011">Use of “Set” Instructions</span></div>
<div style="position:absolute;left:446.03px;top:505.00px" class="cls_011"><span class="cls_011">16-1</span></div>
<div style="position:absolute;left:90.00px;top:519.01px" class="cls_011"><span class="cls_011">Use of “Set” with Complex Branch Operations</span></div>
<div style="position:absolute;left:446.03px;top:519.01px" class="cls_011"><span class="cls_011">16-2</span></div>
<div style="position:absolute;left:90.00px;top:533.01px" class="cls_011"><span class="cls_011">Carry, Borrow, Overflow, and Multi-Precision Math</span></div>
<div style="position:absolute;left:446.05px;top:533.01px" class="cls_011"><span class="cls_011">16-2</span></div>
<div style="position:absolute;left:36.00px;top:547.00px" class="cls_010"><span class="cls_010">Machine Instructions Reference (Appendix A)</span></div>
<div style="position:absolute;left:459.40px;top:547.00px" class="cls_010"><span class="cls_010">A</span></div>
<div style="position:absolute;left:72.00px;top:561.00px" class="cls_011"><span class="cls_011">CPU Instruction Overview</span></div>
<div style="position:absolute;left:449.36px;top:561.00px" class="cls_011"><span class="cls_011">A-1</span></div>
<div style="position:absolute;left:72.00px;top:575.00px" class="cls_011"><span class="cls_011">Instruction Classes</span></div>
<div style="position:absolute;left:449.36px;top:575.00px" class="cls_011"><span class="cls_011">A-1</span></div>
<div style="position:absolute;left:72.00px;top:589.01px" class="cls_011"><span class="cls_011">Instruction Formats</span></div>
<div style="position:absolute;left:449.36px;top:589.01px" class="cls_011"><span class="cls_011">A-2</span></div>
<div style="position:absolute;left:72.00px;top:603.01px" class="cls_011"><span class="cls_011">Instruction Notation Conventions</span></div>
<div style="position:absolute;left:449.36px;top:603.01px" class="cls_011"><span class="cls_011">A-2</span></div>
<div style="position:absolute;left:90.00px;top:617.02px" class="cls_011"><span class="cls_011">Instruction Notation Examples</span></div>
<div style="position:absolute;left:449.36px;top:617.02px" class="cls_011"><span class="cls_011">A-3</span></div>
<div style="position:absolute;left:72.00px;top:631.02px" class="cls_011"><span class="cls_011">Load and Store Instructions</span></div>
<div style="position:absolute;left:449.35px;top:631.02px" class="cls_011"><span class="cls_011">A-4</span></div>
<div style="position:absolute;left:72.00px;top:645.02px" class="cls_011"><span class="cls_011">Jump and Branch Instructions</span></div>
<div style="position:absolute;left:449.35px;top:645.02px" class="cls_011"><span class="cls_011">A-5</span></div>
<div style="position:absolute;left:72.00px;top:659.03px" class="cls_011"><span class="cls_011">Coprocessor Instructions</span></div>
<div style="position:absolute;left:449.36px;top:659.03px" class="cls_011"><span class="cls_011">A-5</span></div>
<div style="position:absolute;left:72.00px;top:673.03px" class="cls_011"><span class="cls_011">System Control Coprocessor (CP0) Instructions</span></div>
<div style="position:absolute;left:449.38px;top:673.03px" class="cls_011"><span class="cls_011">A-6</span></div>
<div style="position:absolute;left:72.00px;top:687.04px" class="cls_011"><span class="cls_011">Instruct Set Details</span></div>
<div style="position:absolute;left:449.35px;top:687.04px" class="cls_011"><span class="cls_011">A-6</span></div>
<div style="position:absolute;left:72.00px;top:701.04px" class="cls_011"><span class="cls_011">Instruction Summary</span></div>
<div style="position:absolute;left:443.35px;top:701.04px" class="cls_011"><span class="cls_011">A-79</span></div>
<div style="position:absolute;left:36.00px;top:715.00px" class="cls_010"><span class="cls_010">FPA Instruction Reference (Appendix B)</span></div>
<div style="position:absolute;left:460.04px;top:715.00px" class="cls_010"><span class="cls_010">B</span></div>
<div style="position:absolute;left:72.00px;top:729.00px" class="cls_011"><span class="cls_011">FPU Instruction Set Details</span></div>
<div style="position:absolute;left:450.03px;top:729.00px" class="cls_011"><span class="cls_011">B-1</span></div>
<div style="position:absolute;left:290.78px;top:755.33px" class="cls_002"><span class="cls_002">i-10</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:8020px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">Table of Contents</span></div>
<div style="position:absolute;left:198.00px;top:50.00px" class="cls_011"><span class="cls_011">FPU Instructions</span></div>
<div style="position:absolute;left:558.03px;top:50.00px" class="cls_011"><span class="cls_011">B-1</span></div>
<div style="position:absolute;left:198.00px;top:64.00px" class="cls_011"><span class="cls_011">Floating-Point Data Transfer</span></div>
<div style="position:absolute;left:558.02px;top:64.00px" class="cls_011"><span class="cls_011">B-1</span></div>
<div style="position:absolute;left:198.00px;top:78.01px" class="cls_011"><span class="cls_011">Floating-Point Conversions</span></div>
<div style="position:absolute;left:558.02px;top:78.01px" class="cls_011"><span class="cls_011">B-1</span></div>
<div style="position:absolute;left:198.00px;top:92.01px" class="cls_011"><span class="cls_011">Floating-Point Arithmetic</span></div>
<div style="position:absolute;left:558.02px;top:92.01px" class="cls_011"><span class="cls_011">B-2</span></div>
<div style="position:absolute;left:198.00px;top:106.02px" class="cls_011"><span class="cls_011">Floating-Point Register-to-Register Move</span></div>
<div style="position:absolute;left:558.03px;top:106.02px" class="cls_011"><span class="cls_011">B-2</span></div>
<div style="position:absolute;left:198.00px;top:120.02px" class="cls_011"><span class="cls_011">Floating-Point Branch</span></div>
<div style="position:absolute;left:558.01px;top:120.02px" class="cls_011"><span class="cls_011">B-2</span></div>
<div style="position:absolute;left:180.00px;top:134.02px" class="cls_011"><span class="cls_011">FP Computational Instructions and Valid Operands</span></div>
<div style="position:absolute;left:558.03px;top:134.02px" class="cls_011"><span class="cls_011">B-2</span></div>
<div style="position:absolute;left:180.00px;top:148.03px" class="cls_011"><span class="cls_011">FP Compare and Condition values</span></div>
<div style="position:absolute;left:558.01px;top:148.03px" class="cls_011"><span class="cls_011">B-3</span></div>
<div style="position:absolute;left:180.00px;top:162.03px" class="cls_011"><span class="cls_011">FPU Register Specifiers</span></div>
<div style="position:absolute;left:558.03px;top:162.03px" class="cls_011"><span class="cls_011">B-3</span></div>
<div style="position:absolute;left:180.00px;top:176.04px" class="cls_011"><span class="cls_011">32-bit CP1 registers</span></div>
<div style="position:absolute;left:557.99px;top:176.04px" class="cls_011"><span class="cls_011">B-4</span></div>
<div style="position:absolute;left:197.00px;top:190.04px" class="cls_011"><span class="cls_011">FPU Register Access for 32-bit CP1 Registers</span></div>
<div style="position:absolute;left:558.04px;top:190.04px" class="cls_011"><span class="cls_011">B-5</span></div>
<div style="position:absolute;left:197.00px;top:204.04px" class="cls_011"><span class="cls_011">Instruction Notation Conventions</span></div>
<div style="position:absolute;left:558.02px;top:204.04px" class="cls_011"><span class="cls_011">B-5</span></div>
<div style="position:absolute;left:180.00px;top:218.05px" class="cls_011"><span class="cls_011">Load and Store Memory</span></div>
<div style="position:absolute;left:558.01px;top:218.05px" class="cls_011"><span class="cls_011">B-6</span></div>
<div style="position:absolute;left:180.00px;top:232.05px" class="cls_011"><span class="cls_011">Instruction Descriptions</span></div>
<div style="position:absolute;left:558.03px;top:232.05px" class="cls_011"><span class="cls_011">B-6</span></div>
<div style="position:absolute;left:180.00px;top:246.06px" class="cls_011"><span class="cls_011">FPA Instruction Set Summary</span></div>
<div style="position:absolute;left:552.03px;top:246.06px" class="cls_011"><span class="cls_011">B-27</span></div>
<div style="position:absolute;left:144.00px;top:260.00px" class="cls_010"><span class="cls_010">CP0 Operation Reference (Appendix C)</span></div>
<div style="position:absolute;left:567.38px;top:260.00px" class="cls_010"><span class="cls_010">C</span></div>
<div style="position:absolute;left:180.00px;top:274.00px" class="cls_011"><span class="cls_011">CP0 Operation Details</span></div>
<div style="position:absolute;left:558.01px;top:274.00px" class="cls_011"><span class="cls_011">C-1</span></div>
<div style="position:absolute;left:180.00px;top:288.00px" class="cls_011"><span class="cls_011">MMU Operations</span></div>
<div style="position:absolute;left:558.01px;top:288.00px" class="cls_011"><span class="cls_011">C-1</span></div>
<div style="position:absolute;left:180.00px;top:302.01px" class="cls_011"><span class="cls_011">Exception Operations</span></div>
<div style="position:absolute;left:558.01px;top:302.01px" class="cls_011"><span class="cls_011">C-1</span></div>
<div style="position:absolute;left:198.00px;top:316.01px" class="cls_011"><span class="cls_011">Dand Register Movement Operations</span></div>
<div style="position:absolute;left:558.02px;top:316.01px" class="cls_011"><span class="cls_011">C-1</span></div>
<div style="position:absolute;left:180.00px;top:330.02px" class="cls_011"><span class="cls_011">Operation Descriptions</span></div>
<div style="position:absolute;left:558.01px;top:330.02px" class="cls_011"><span class="cls_011">C-1</span></div>
<div style="position:absolute;left:144.00px;top:344.00px" class="cls_010"><span class="cls_010">Assembler Language Syntax (Appendix D)</span></div>
<div style="position:absolute;left:567.39px;top:344.00px" class="cls_010"><span class="cls_010">D</span></div>
<div style="position:absolute;left:144.00px;top:358.00px" class="cls_010"><span class="cls_010">Object Code Formats (Appendix E)</span></div>
<div style="position:absolute;left:568.03px;top:358.00px" class="cls_010"><span class="cls_010">E</span></div>
<div style="position:absolute;left:162.00px;top:372.00px" class="cls_011"><span class="cls_011">Sections and Segments</span></div>
<div style="position:absolute;left:558.69px;top:372.00px" class="cls_011"><span class="cls_011">E-1</span></div>
<div style="position:absolute;left:162.00px;top:386.00px" class="cls_011"><span class="cls_011">ECOFF Object File Format (RISC/OS)</span></div>
<div style="position:absolute;left:558.71px;top:386.00px" class="cls_011"><span class="cls_011">E-1</span></div>
<div style="position:absolute;left:180.00px;top:400.01px" class="cls_011"><span class="cls_011">File Header</span></div>
<div style="position:absolute;left:558.68px;top:400.01px" class="cls_011"><span class="cls_011">E-2</span></div>
<div style="position:absolute;left:180.00px;top:414.01px" class="cls_011"><span class="cls_011">Optional a.out Header</span></div>
<div style="position:absolute;left:558.68px;top:414.01px" class="cls_011"><span class="cls_011">E-2</span></div>
<div style="position:absolute;left:180.00px;top:428.02px" class="cls_011"><span class="cls_011">Example Loader</span></div>
<div style="position:absolute;left:558.68px;top:428.02px" class="cls_011"><span class="cls_011">E-3</span></div>
<div style="position:absolute;left:180.00px;top:442.02px" class="cls_011"><span class="cls_011">Further Reading</span></div>
<div style="position:absolute;left:558.68px;top:442.02px" class="cls_011"><span class="cls_011">E-4</span></div>
<div style="position:absolute;left:162.00px;top:456.02px" class="cls_011"><span class="cls_011">ELF (MIPS ABI)</span></div>
<div style="position:absolute;left:558.68px;top:456.02px" class="cls_011"><span class="cls_011">E-4</span></div>
<div style="position:absolute;left:180.00px;top:470.03px" class="cls_011"><span class="cls_011">File Header</span></div>
<div style="position:absolute;left:558.68px;top:470.03px" class="cls_011"><span class="cls_011">E-4</span></div>
<div style="position:absolute;left:180.00px;top:484.03px" class="cls_011"><span class="cls_011">Program Header</span></div>
<div style="position:absolute;left:558.69px;top:484.03px" class="cls_011"><span class="cls_011">E-5</span></div>
<div style="position:absolute;left:180.00px;top:498.04px" class="cls_011"><span class="cls_011">Example Loader</span></div>
<div style="position:absolute;left:558.68px;top:498.04px" class="cls_011"><span class="cls_011">E-6</span></div>
<div style="position:absolute;left:180.00px;top:512.04px" class="cls_011"><span class="cls_011">Further Reading</span></div>
<div style="position:absolute;left:558.68px;top:512.04px" class="cls_011"><span class="cls_011">E-7</span></div>
<div style="position:absolute;left:162.00px;top:526.04px" class="cls_011"><span class="cls_011">Object Code Tools</span></div>
<div style="position:absolute;left:558.67px;top:526.04px" class="cls_011"><span class="cls_011">E-7</span></div>
<div style="position:absolute;left:144.00px;top:540.00px" class="cls_010"><span class="cls_010">Glossary of Common "MIPS" Terms</span></div>
<div style="position:absolute;left:568.71px;top:540.00px" class="cls_010"><span class="cls_010">F</span></div>
<div style="position:absolute;left:144.00px;top:568.00px" class="cls_010"><span class="cls_010">DRAWINGS</span></div>
<div style="position:absolute;left:144.00px;top:582.00px" class="cls_011"><span class="cls_011">1.1</span></div>
<div style="position:absolute;left:180.00px;top:582.00px" class="cls_011"><span class="cls_011">MIPS 5-Stage Pipeline</span></div>
<div style="position:absolute;left:561.02px;top:582.00px" class="cls_011"><span class="cls_011">1.2</span></div>
<div style="position:absolute;left:144.00px;top:596.00px" class="cls_011"><span class="cls_011">1.2</span></div>
<div style="position:absolute;left:180.00px;top:596.00px" class="cls_011"><span class="cls_011">The Pipeline and Branch Delays</span></div>
<div style="position:absolute;left:560.02px;top:596.00px" class="cls_011"><span class="cls_011">1-7</span></div>
<div style="position:absolute;left:144.00px;top:610.01px" class="cls_011"><span class="cls_011">1.3</span></div>
<div style="position:absolute;left:180.00px;top:610.01px" class="cls_011"><span class="cls_011">The Pipeline and Load Delays</span></div>
<div style="position:absolute;left:560.01px;top:610.01px" class="cls_011"><span class="cls_011">1-8</span></div>
<div style="position:absolute;left:144.00px;top:624.01px" class="cls_011"><span class="cls_011">3.1</span></div>
<div style="position:absolute;left:180.00px;top:624.01px" class="cls_011"><span class="cls_011">PRId Register Fields</span></div>
<div style="position:absolute;left:560.02px;top:624.01px" class="cls_011"><span class="cls_011">3-4</span></div>
<div style="position:absolute;left:144.00px;top:638.02px" class="cls_011"><span class="cls_011">3.2</span></div>
<div style="position:absolute;left:180.00px;top:638.02px" class="cls_011"><span class="cls_011">Fields in Status Register</span></div>
<div style="position:absolute;left:560.00px;top:638.02px" class="cls_011"><span class="cls_011">3-4</span></div>
<div style="position:absolute;left:144.00px;top:652.02px" class="cls_011"><span class="cls_011">3.3</span></div>
<div style="position:absolute;left:180.00px;top:652.02px" class="cls_011"><span class="cls_011">Fields in the Cause Register</span></div>
<div style="position:absolute;left:560.02px;top:652.02px" class="cls_011"><span class="cls_011">3-7</span></div>
<div style="position:absolute;left:144.00px;top:666.02px" class="cls_011"><span class="cls_011">3.4</span></div>
<div style="position:absolute;left:180.00px;top:666.02px" class="cls_011"><span class="cls_011">Fields in the R3071/81 Config Register</span></div>
<div style="position:absolute;left:560.00px;top:666.02px" class="cls_011"><span class="cls_011">3-8</span></div>
<div style="position:absolute;left:144.00px;top:680.03px" class="cls_011"><span class="cls_011">3.5</span></div>
<div style="position:absolute;left:180.00px;top:680.03px" class="cls_011"><span class="cls_011">Fields in the R3041 Config (Cache Configuration)Register</span></div>
<div style="position:absolute;left:560.03px;top:680.03px" class="cls_011"><span class="cls_011">3-9</span></div>
<div style="position:absolute;left:144.00px;top:694.03px" class="cls_011"><span class="cls_011">3.6</span></div>
<div style="position:absolute;left:180.00px;top:694.03px" class="cls_011"><span class="cls_011">Fields in the R3041 Bus Control (BusCtrl) Register</span></div>
<div style="position:absolute;left:554.03px;top:694.03px" class="cls_011"><span class="cls_011">3-10</span></div>
<div style="position:absolute;left:144.00px;top:708.04px" class="cls_011"><span class="cls_011">5.1</span></div>
<div style="position:absolute;left:180.00px;top:708.04px" class="cls_011"><span class="cls_011">Direct Mapped Cache</span></div>
<div style="position:absolute;left:560.02px;top:708.04px" class="cls_011"><span class="cls_011">5-1</span></div>
<div style="position:absolute;left:144.00px;top:722.04px" class="cls_011"><span class="cls_011">6.1</span></div>
<div style="position:absolute;left:180.00px;top:722.04px" class="cls_011"><span class="cls_011">EntryHi and EntryLo Register Fields</span></div>
<div style="position:absolute;left:560.02px;top:722.04px" class="cls_011"><span class="cls_011">6-3</span></div>
<div style="position:absolute;left:304.52px;top:755.33px" class="cls_002"><span class="cls_002">i-11</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:8822px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:492.78px;top:28.00px" class="cls_002"><span class="cls_002">Table of Contents</span></div>
<div style="position:absolute;left:36.00px;top:57.00px" class="cls_011"><span class="cls_011">6.2</span></div>
<div style="position:absolute;left:72.00px;top:57.00px" class="cls_011"><span class="cls_011">EntryHi and EntryLo Register Fields</span></div>
<div style="position:absolute;left:452.02px;top:57.00px" class="cls_011"><span class="cls_011">6-3</span></div>
<div style="position:absolute;left:36.00px;top:71.00px" class="cls_011"><span class="cls_011">6.3</span></div>
<div style="position:absolute;left:72.00px;top:71.00px" class="cls_011"><span class="cls_011">Fields in the Index Register</span></div>
<div style="position:absolute;left:452.02px;top:71.00px" class="cls_011"><span class="cls_011">6-4</span></div>
<div style="position:absolute;left:36.00px;top:85.01px" class="cls_011"><span class="cls_011">6.4</span></div>
<div style="position:absolute;left:72.00px;top:85.01px" class="cls_011"><span class="cls_011">Fields in the Random Register</span></div>
<div style="position:absolute;left:452.01px;top:85.01px" class="cls_011"><span class="cls_011">6-4</span></div>
<div style="position:absolute;left:36.00px;top:99.01px" class="cls_011"><span class="cls_011">6.5</span></div>
<div style="position:absolute;left:72.00px;top:99.01px" class="cls_011"><span class="cls_011">Fields in the Context Register</span></div>
<div style="position:absolute;left:452.02px;top:99.01px" class="cls_011"><span class="cls_011">6-4</span></div>
<div style="position:absolute;left:36.00px;top:113.02px" class="cls_011"><span class="cls_011">8.1</span></div>
<div style="position:absolute;left:72.00px;top:113.02px" class="cls_011"><span class="cls_011">FPA Control/Status Register Fields</span></div>
<div style="position:absolute;left:452.03px;top:113.02px" class="cls_011"><span class="cls_011">8-6</span></div>
<div style="position:absolute;left:36.00px;top:127.02px" class="cls_011"><span class="cls_011">8.2</span></div>
<div style="position:absolute;left:72.00px;top:127.02px" class="cls_011"><span class="cls_011">FPA Implementation/Revision Register</span></div>
<div style="position:absolute;left:452.03px;top:127.02px" class="cls_011"><span class="cls_011">8-8</span></div>
<div style="position:absolute;left:36.00px;top:141.02px" class="cls_011"><span class="cls_011">9.1</span></div>
<div style="position:absolute;left:72.00px;top:141.02px" class="cls_011"><span class="cls_011">Program Segments in Memory</span></div>
<div style="position:absolute;left:446.03px;top:141.02px" class="cls_011"><span class="cls_011">9-11</span></div>
<div style="position:absolute;left:36.00px;top:155.03px" class="cls_011"><span class="cls_011">10.1</span></div>
<div style="position:absolute;left:72.00px;top:155.03px" class="cls_011"><span class="cls_011">Stackframe for a Non-Leaf Function</span></div>
<div style="position:absolute;left:446.03px;top:155.03px" class="cls_011"><span class="cls_011">10-5</span></div>
<div style="position:absolute;left:36.00px;top:169.03px" class="cls_011"><span class="cls_011">11.1</span></div>
<div style="position:absolute;left:72.00px;top:169.03px" class="cls_011"><span class="cls_011">Structure Layout and Padding in Memory</span></div>
<div style="position:absolute;left:446.02px;top:169.03px" class="cls_011"><span class="cls_011">11-3</span></div>
<div style="position:absolute;left:36.00px;top:183.04px" class="cls_011"><span class="cls_011">11.2</span></div>
<div style="position:absolute;left:72.00px;top:183.04px" class="cls_011"><span class="cls_011">Data Representation with #pragma Pack(1)</span></div>
<div style="position:absolute;left:446.03px;top:183.04px" class="cls_011"><span class="cls_011">11-4</span></div>
<div style="position:absolute;left:36.00px;top:197.04px" class="cls_011"><span class="cls_011">11.3</span></div>
<div style="position:absolute;left:72.00px;top:197.04px" class="cls_011"><span class="cls_011">Data Representation with #pragma Pack(2)</span></div>
<div style="position:absolute;left:446.03px;top:197.04px" class="cls_011"><span class="cls_011">11-5</span></div>
<div style="position:absolute;left:36.00px;top:211.04px" class="cls_011"><span class="cls_011">11.4</span></div>
<div style="position:absolute;left:72.00px;top:211.04px" class="cls_011"><span class="cls_011">Typical Big-Endians Picture</span></div>
<div style="position:absolute;left:446.02px;top:211.04px" class="cls_011"><span class="cls_011">11-8</span></div>
<div style="position:absolute;left:36.00px;top:225.05px" class="cls_011"><span class="cls_011">11.5</span></div>
<div style="position:absolute;left:72.00px;top:225.05px" class="cls_011"><span class="cls_011">Little Endians Picture</span></div>
<div style="position:absolute;left:446.02px;top:225.05px" class="cls_011"><span class="cls_011">11-8</span></div>
<div style="position:absolute;left:36.00px;top:239.05px" class="cls_011"><span class="cls_011">11.6</span></div>
<div style="position:absolute;left:72.00px;top:239.05px" class="cls_011"><span class="cls_011">Bitfields and Big-Endian</span></div>
<div style="position:absolute;left:445.99px;top:239.05px" class="cls_011"><span class="cls_011">11-9</span></div>
<div style="position:absolute;left:36.00px;top:253.06px" class="cls_011"><span class="cls_011">11.7</span></div>
<div style="position:absolute;left:72.00px;top:253.06px" class="cls_011"><span class="cls_011">Bitfields and Little-Endian</span></div>
<div style="position:absolute;left:440.01px;top:253.06px" class="cls_011"><span class="cls_011">11-10</span></div>
<div style="position:absolute;left:36.00px;top:267.06px" class="cls_011"><span class="cls_011">11.8</span></div>
<div style="position:absolute;left:72.00px;top:267.06px" class="cls_011"><span class="cls_011">Garbled String Storage when Mixing Modes</span></div>
<div style="position:absolute;left:440.03px;top:267.06px" class="cls_011"><span class="cls_011">11-11</span></div>
<div style="position:absolute;left:36.00px;top:281.06px" class="cls_011"><span class="cls_011">11.9</span></div>
<div style="position:absolute;left:72.00px;top:281.06px" class="cls_011"><span class="cls_011">Byte-Lane Swapper</span></div>
<div style="position:absolute;left:440.02px;top:281.06px" class="cls_011"><span class="cls_011">11-12</span></div>
<div style="position:absolute;left:36.00px;top:295.07px" class="cls_011"><span class="cls_011">15.1</span></div>
<div style="position:absolute;left:72.00px;top:295.07px" class="cls_011"><span class="cls_011">Memory Layout of a BSD Process</span></div>
<div style="position:absolute;left:440.04px;top:295.07px" class="cls_011"><span class="cls_011">15-12</span></div>
<div style="position:absolute;left:36.00px;top:309.07px" class="cls_011"><span class="cls_011">A.1</span></div>
<div style="position:absolute;left:72.00px;top:309.07px" class="cls_011"><span class="cls_011">CPU Instruction Formats</span></div>
<div style="position:absolute;left:449.36px;top:309.07px" class="cls_011"><span class="cls_011">A-2</span></div>
<div style="position:absolute;left:36.00px;top:337.00px" class="cls_010"><span class="cls_010">TABLES</span></div>
<div style="position:absolute;left:36.00px;top:351.00px" class="cls_011"><span class="cls_011">1.1</span></div>
<div style="position:absolute;left:72.00px;top:351.00px" class="cls_011"><span class="cls_011">R30xx Family Members Compared</span></div>
<div style="position:absolute;left:452.01px;top:351.00px" class="cls_011"><span class="cls_011">1-4</span></div>
<div style="position:absolute;left:36.00px;top:365.00px" class="cls_011"><span class="cls_011">2.1</span></div>
<div style="position:absolute;left:72.00px;top:365.00px" class="cls_011"><span class="cls_011">Conventional Names of Registers with Usage Mnemonics</span></div>
<div style="position:absolute;left:452.03px;top:365.00px" class="cls_011"><span class="cls_011">2-2</span></div>
<div style="position:absolute;left:36.00px;top:379.01px" class="cls_011"><span class="cls_011">3.1</span></div>
<div style="position:absolute;left:72.00px;top:379.01px" class="cls_011"><span class="cls_011">Summary of CPU Control Registers (Not MMU)</span></div>
<div style="position:absolute;left:452.05px;top:379.01px" class="cls_011"><span class="cls_011">3-3</span></div>
<div style="position:absolute;left:36.00px;top:393.01px" class="cls_011"><span class="cls_011">3.2</span></div>
<div style="position:absolute;left:72.00px;top:393.01px" class="cls_011"><span class="cls_011">ExcCode Values: Different kinds of Exceptions</span></div>
<div style="position:absolute;left:452.03px;top:393.01px" class="cls_011"><span class="cls_011">3-7</span></div>
<div style="position:absolute;left:36.00px;top:407.02px" class="cls_011"><span class="cls_011">4.1</span></div>
<div style="position:absolute;left:72.00px;top:407.02px" class="cls_011"><span class="cls_011">Reset and Exception Entry Points (Vectors) for R30xx Family</span></div>
<div style="position:absolute;left:452.04px;top:407.02px" class="cls_011"><span class="cls_011">4-3</span></div>
<div style="position:absolute;left:36.00px;top:421.02px" class="cls_011"><span class="cls_011">4.2</span></div>
<div style="position:absolute;left:72.00px;top:421.02px" class="cls_011"><span class="cls_011">Interrupt Bitfields and Interrup Pins</span></div>
<div style="position:absolute;left:446.03px;top:421.02px" class="cls_011"><span class="cls_011">4-13</span></div>
<div style="position:absolute;left:36.00px;top:435.02px" class="cls_011"><span class="cls_011">6.1</span></div>
<div style="position:absolute;left:72.00px;top:435.02px" class="cls_011"><span class="cls_011">CPU Control Registers for Memory Management</span></div>
<div style="position:absolute;left:452.04px;top:435.02px" class="cls_011"><span class="cls_011">6-3</span></div>
<div style="position:absolute;left:36.00px;top:449.03px" class="cls_011"><span class="cls_011">8.1</span></div>
<div style="position:absolute;left:72.00px;top:449.03px" class="cls_011"><span class="cls_011">Floating Point Data Formats</span></div>
<div style="position:absolute;left:452.03px;top:449.03px" class="cls_011"><span class="cls_011">8-4</span></div>
<div style="position:absolute;left:36.00px;top:463.03px" class="cls_011"><span class="cls_011">8.2</span></div>
<div style="position:absolute;left:72.00px;top:463.03px" class="cls_011"><span class="cls_011">Rounding Modes Encoded in FP Control/Status Register</span></div>
<div style="position:absolute;left:452.03px;top:463.03px" class="cls_011"><span class="cls_011">8-7</span></div>
<div style="position:absolute;left:36.00px;top:477.04px" class="cls_011"><span class="cls_011">8.4</span></div>
<div style="position:absolute;left:72.00px;top:477.04px" class="cls_011"><span class="cls_011">FP Move Instructions</span></div>
<div style="position:absolute;left:452.03px;top:477.04px" class="cls_011"><span class="cls_011">8-9</span></div>
<div style="position:absolute;left:36.00px;top:491.04px" class="cls_011"><span class="cls_011">8.5</span></div>
<div style="position:absolute;left:72.00px;top:491.04px" class="cls_011"><span class="cls_011">FPA 3-Operand Arithmetic</span></div>
<div style="position:absolute;left:446.03px;top:491.04px" class="cls_011"><span class="cls_011">8-10</span></div>
<div style="position:absolute;left:36.00px;top:505.04px" class="cls_011"><span class="cls_011">8.6</span></div>
<div style="position:absolute;left:72.00px;top:505.04px" class="cls_011"><span class="cls_011">FPA Sign-Changing Operators</span></div>
<div style="position:absolute;left:446.03px;top:505.04px" class="cls_011"><span class="cls_011">8-10</span></div>
<div style="position:absolute;left:36.00px;top:519.05px" class="cls_011"><span class="cls_011">8.7</span></div>
<div style="position:absolute;left:72.00px;top:519.05px" class="cls_011"><span class="cls_011">FPA Data Conversion Operations</span></div>
<div style="position:absolute;left:446.02px;top:519.05px" class="cls_011"><span class="cls_011">8-10</span></div>
<div style="position:absolute;left:36.00px;top:533.05px" class="cls_011"><span class="cls_011">8.8</span></div>
<div style="position:absolute;left:72.00px;top:533.05px" class="cls_011"><span class="cls_011">FP Test Instructions</span></div>
<div style="position:absolute;left:446.02px;top:533.05px" class="cls_011"><span class="cls_011">8-11</span></div>
<div style="position:absolute;left:36.00px;top:547.06px" class="cls_011"><span class="cls_011">9.1</span></div>
<div style="position:absolute;left:72.00px;top:547.06px" class="cls_011"><span class="cls_011">Assembler Register and Identifier Conventions</span></div>
<div style="position:absolute;left:446.03px;top:547.06px" class="cls_011"><span class="cls_011">9-20</span></div>
<div style="position:absolute;left:36.00px;top:561.06px" class="cls_011"><span class="cls_011">9.2</span></div>
<div style="position:absolute;left:72.00px;top:561.06px" class="cls_011"><span class="cls_011">Assembler Instructions</span></div>
<div style="position:absolute;left:445.99px;top:561.06px" class="cls_011"><span class="cls_011">9-20</span></div>
<div style="position:absolute;left:36.00px;top:575.06px" class="cls_011"><span class="cls_011">12.1</span></div>
<div style="position:absolute;left:72.00px;top:575.06px" class="cls_011"><span class="cls_011">Test Sequence in Brief</span></div>
<div style="position:absolute;left:446.01px;top:575.06px" class="cls_011"><span class="cls_011">12-5</span></div>
<div style="position:absolute;left:36.00px;top:589.07px" class="cls_011"><span class="cls_011">16.1</span></div>
<div style="position:absolute;left:72.00px;top:589.07px" class="cls_011"><span class="cls_011">32-bit Immediate Values</span></div>
<div style="position:absolute;left:446.02px;top:589.07px" class="cls_011"><span class="cls_011">16-1</span></div>
<div style="position:absolute;left:36.00px;top:603.07px" class="cls_011"><span class="cls_011">16.2</span></div>
<div style="position:absolute;left:72.00px;top:603.07px" class="cls_011"><span class="cls_011">Add-With-Carry</span></div>
<div style="position:absolute;left:446.02px;top:603.07px" class="cls_011"><span class="cls_011">16-2</span></div>
<div style="position:absolute;left:36.00px;top:617.08px" class="cls_011"><span class="cls_011">16.3</span></div>
<div style="position:absolute;left:72.00px;top:617.08px" class="cls_011"><span class="cls_011">Subtract-with-Borrow Operation</span></div>
<div style="position:absolute;left:446.03px;top:617.08px" class="cls_011"><span class="cls_011">16-3</span></div>
<div style="position:absolute;left:36.00px;top:631.08px" class="cls_011"><span class="cls_011">A.1</span></div>
<div style="position:absolute;left:72.00px;top:631.08px" class="cls_011"><span class="cls_011">CPU Instruction Operation Notations</span></div>
<div style="position:absolute;left:449.37px;top:631.08px" class="cls_011"><span class="cls_011">A-3</span></div>
<div style="position:absolute;left:36.00px;top:645.08px" class="cls_011"><span class="cls_011">A.2</span></div>
<div style="position:absolute;left:72.00px;top:645.08px" class="cls_011"><span class="cls_011">Load and Store Common Function</span></div>
<div style="position:absolute;left:449.35px;top:645.08px" class="cls_011"><span class="cls_011">A-4</span></div>
<div style="position:absolute;left:36.00px;top:659.09px" class="cls_011"><span class="cls_011">A.3</span></div>
<div style="position:absolute;left:72.00px;top:659.09px" class="cls_011"><span class="cls_011">Access Type Specifications for Load/Store</span></div>
<div style="position:absolute;left:449.37px;top:659.09px" class="cls_011"><span class="cls_011">A-5</span></div>
<div style="position:absolute;left:36.00px;top:673.09px" class="cls_011"><span class="cls_011">B.1</span></div>
<div style="position:absolute;left:72.00px;top:673.09px" class="cls_011"><span class="cls_011">Format Field Decoding</span></div>
<div style="position:absolute;left:450.01px;top:673.09px" class="cls_011"><span class="cls_011">B-2</span></div>
<div style="position:absolute;left:36.00px;top:687.10px" class="cls_011"><span class="cls_011">B.2</span></div>
<div style="position:absolute;left:72.00px;top:687.10px" class="cls_011"><span class="cls_011">Logical Negation of Predicates by Condition True/False</span></div>
<div style="position:absolute;left:450.02px;top:687.10px" class="cls_011"><span class="cls_011">B-3</span></div>
<div style="position:absolute;left:36.00px;top:701.10px" class="cls_011"><span class="cls_011">B.3</span></div>
<div style="position:absolute;left:72.00px;top:701.10px" class="cls_011"><span class="cls_011">Valid FP Operand Specifiers with 32-bit Coprocessor 1 Registers</span></div>
<div style="position:absolute;left:450.06px;top:701.10px" class="cls_011"><span class="cls_011">B-4</span></div>
<div style="position:absolute;left:36.00px;top:715.10px" class="cls_011"><span class="cls_011">B.4</span></div>
<div style="position:absolute;left:72.00px;top:715.10px" class="cls_011"><span class="cls_011">Load and Store Common Functions</span></div>
<div style="position:absolute;left:450.01px;top:715.10px" class="cls_011"><span class="cls_011">B-6</span></div>
<div style="position:absolute;left:290.78px;top:755.33px" class="cls_002"><span class="cls_002">i-12</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:9624px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">INTRODUCTION</span></div>
<div style="position:absolute;left:491.33px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 1</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:228.02px;top:124.67px" class="cls_006"><span class="cls_006">IDT’s R30xx family of RISC microcontrollers family includes the R3051,</span></div>
<div style="position:absolute;left:216.00px;top:135.67px" class="cls_006"><span class="cls_006">R3052, R3071, R3081 and R3041 processors. The different members of</span></div>
<div style="position:absolute;left:216.00px;top:146.67px" class="cls_006"><span class="cls_006">the family offer different price/performance trade-offs, but are all basically</span></div>
<div style="position:absolute;left:216.00px;top:157.67px" class="cls_006"><span class="cls_006">integrated versions of the MIPS R3000A CPU. The R3000A CPU is well</span></div>
<div style="position:absolute;left:216.00px;top:168.67px" class="cls_006"><span class="cls_006">known for the high-performance Unix systems implemented around it; less</span></div>
<div style="position:absolute;left:216.00px;top:179.67px" class="cls_006"><span class="cls_006">publicized but equally impressive is the performance it has brought to a</span></div>
<div style="position:absolute;left:216.00px;top:190.67px" class="cls_006"><span class="cls_006">wide variety of embedded applications.</span></div>
<div style="position:absolute;left:228.02px;top:201.67px" class="cls_006"><span class="cls_006">IDT’s RISController family also includes devices built around MIPS</span></div>
<div style="position:absolute;left:216.00px;top:212.67px" class="cls_006"><span class="cls_006">R4000 64-bit microprocessor technology. These devices, such as the IDT</span></div>
<div style="position:absolute;left:216.00px;top:223.67px" class="cls_006"><span class="cls_006">R4600 Orion microprocessor, offer even higher levels of performance than</span></div>
<div style="position:absolute;left:216.00px;top:234.67px" class="cls_006"><span class="cls_006">the R3000A derivative family. However, these devices also feature slightly</span></div>
<div style="position:absolute;left:216.00px;top:245.67px" class="cls_006"><span class="cls_006">different OS models, and allow 64-bit kernels and applications. Thus, they</span></div>
<div style="position:absolute;left:216.00px;top:256.67px" class="cls_006"><span class="cls_006">are sufficiently different from the R30xx family that this manual is focused</span></div>
<div style="position:absolute;left:216.00px;top:267.67px" class="cls_006"><span class="cls_006">exclusively on the R30xx family.</span></div>
<div style="position:absolute;left:228.02px;top:278.67px" class="cls_006"><span class="cls_006">This manual is aimed at the programmer dealing with the IDT R30xx</span></div>
<div style="position:absolute;left:216.00px;top:289.67px" class="cls_006"><span class="cls_006">family components. Although most programming occurs using a high-level</span></div>
<div style="position:absolute;left:216.00px;top:300.67px" class="cls_006"><span class="cls_006">language (usually “C”), and with little awareness of the underlying system</span></div>
<div style="position:absolute;left:216.00px;top:311.67px" class="cls_006"><span class="cls_006">or processor architecture, certain operations require the programmer to</span></div>
<div style="position:absolute;left:216.00px;top:322.67px" class="cls_006"><span class="cls_006">use assembly programming, and/or be aware of the underlying system or</span></div>
<div style="position:absolute;left:216.00px;top:333.67px" class="cls_006"><span class="cls_006">processor structure. This manual is designed to be consulted when</span></div>
<div style="position:absolute;left:216.00px;top:344.67px" class="cls_006"><span class="cls_006">addressing these types of issues.</span></div>
<div style="position:absolute;left:216.00px;top:367.00px" class="cls_015"><span class="cls_015">WHAT IS A RISC?</span></div>
<div style="position:absolute;left:228.02px;top:380.67px" class="cls_006"><span class="cls_006">The MIPS CPU is one of the “RISC’’ CPUs, born out of a particularly</span></div>
<div style="position:absolute;left:216.00px;top:391.67px" class="cls_006"><span class="cls_006">fertile  period  of  academic  research  and  development.  RISC  CPUs</span></div>
<div style="position:absolute;left:216.00px;top:402.67px" class="cls_006"><span class="cls_006">(‘‘Reduced Instruction Set Computer’’) share a number of architectural</span></div>
<div style="position:absolute;left:216.00px;top:413.67px" class="cls_006"><span class="cls_006">attributes to facilitate the implementation of high-performance processors.</span></div>
<div style="position:absolute;left:216.00px;top:424.67px" class="cls_006"><span class="cls_006">Most new architectures (as opposed to implementations) since 1986 owe</span></div>
<div style="position:absolute;left:216.00px;top:435.67px" class="cls_006"><span class="cls_006">their remarkable performance to features developed a few years earlier by</span></div>
<div style="position:absolute;left:216.00px;top:446.67px" class="cls_006"><span class="cls_006">a couple of seminal research projects. Someone commented that ‘‘a RISC</span></div>
<div style="position:absolute;left:216.00px;top:457.67px" class="cls_006"><span class="cls_006">is any computer architecture defined after 1984’’; although meant as a jibe</span></div>
<div style="position:absolute;left:216.00px;top:468.67px" class="cls_006"><span class="cls_006">at the industry’s use of the acronym, the comment’s truth also derives</span></div>
<div style="position:absolute;left:216.00px;top:479.67px" class="cls_006"><span class="cls_006">from the widespread acceptance of the conclusions of that research.</span></div>
<div style="position:absolute;left:228.02px;top:490.67px" class="cls_006"><span class="cls_006">One of these was the ‘‘MIPS’’ project at Stanford University. The project</span></div>
<div style="position:absolute;left:216.00px;top:501.67px" class="cls_006"><span class="cls_006">name MIPS puns the familiar ‘‘millions of instructions per second’’ by</span></div>
<div style="position:absolute;left:216.00px;top:512.67px" class="cls_006"><span class="cls_006">taking its name from the key phrase ‘‘Microcomputer without Interlocked</span></div>
<div style="position:absolute;left:216.00px;top:523.67px" class="cls_006"><span class="cls_006">Pipeline Stages’’. The Stanford group’s work showed that pipelining, a well-</span></div>
<div style="position:absolute;left:216.00px;top:534.67px" class="cls_006"><span class="cls_006">known technique for speeding up computers, had been under-exploited by</span></div>
<div style="position:absolute;left:216.00px;top:545.67px" class="cls_006"><span class="cls_006">earlier architectures.</span></div>
<div style="position:absolute;left:299.28px;top:754.68px" class="cls_002"><span class="cls_002">1-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:10426px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 1</span></div>
<div style="position:absolute;left:489.49px;top:28.00px" class="cls_002"><span class="cls_002">INTRODUCTION</span></div>
<div style="position:absolute;left:36.00px;top:50.00px" class="cls_015"><span class="cls_015">PIPELINES</span></div>
<div style="position:absolute;left:148.03px;top:82.54px" class="cls_017"><span class="cls_017">register</span></div>
<div style="position:absolute;left:266.39px;top:82.54px" class="cls_017"><span class="cls_017">register</span></div>
<div style="position:absolute;left:111.78px;top:86.30px" class="cls_017"><span class="cls_017">I-cache</span></div>
<div style="position:absolute;left:188.47px;top:87.19px" class="cls_017"><span class="cls_017">ALU</span></div>
<div style="position:absolute;left:228.91px;top:86.30px" class="cls_017"><span class="cls_017">D-cache</span></div>
<div style="position:absolute;left:155.42px;top:90.07px" class="cls_017"><span class="cls_017">file</span></div>
<div style="position:absolute;left:273.79px;top:90.07px" class="cls_017"><span class="cls_017">file</span></div>
<div style="position:absolute;left:70.35px;top:108.92px" class="cls_017"><span class="cls_017">instr 1</span></div>
<div style="position:absolute;left:121.39px;top:107.59px" class="cls_018"><span class="cls_018">IF</span></div>
<div style="position:absolute;left:154.68px;top:107.59px" class="cls_018"><span class="cls_018">RD</span></div>
<div style="position:absolute;left:188.47px;top:107.59px" class="cls_018"><span class="cls_018">ALU</span></div>
<div style="position:absolute;left:234.34px;top:107.59px" class="cls_018"><span class="cls_018">MEM</span></div>
<div style="position:absolute;left:272.56px;top:107.59px" class="cls_018"><span class="cls_018">WB</span></div>
<div style="position:absolute;left:70.35px;top:146.18px" class="cls_017"><span class="cls_017">instr 2</span></div>
<div style="position:absolute;left:168.74px;top:144.85px" class="cls_018"><span class="cls_018">IF</span></div>
<div style="position:absolute;left:202.03px;top:144.85px" class="cls_018"><span class="cls_018">RD</span></div>
<div style="position:absolute;left:235.82px;top:144.85px" class="cls_018"><span class="cls_018">ALU</span></div>
<div style="position:absolute;left:281.69px;top:144.85px" class="cls_018"><span class="cls_018">MEM</span></div>
<div style="position:absolute;left:319.91px;top:144.85px" class="cls_018"><span class="cls_018">WB</span></div>
<div style="position:absolute;left:70.35px;top:183.43px" class="cls_017"><span class="cls_017">instr 3</span></div>
<div style="position:absolute;left:216.09px;top:182.10px" class="cls_018"><span class="cls_018">IF</span></div>
<div style="position:absolute;left:249.38px;top:182.10px" class="cls_018"><span class="cls_018">RD</span></div>
<div style="position:absolute;left:283.17px;top:182.10px" class="cls_018"><span class="cls_018">ALU</span></div>
<div style="position:absolute;left:329.03px;top:182.10px" class="cls_018"><span class="cls_018">MEM</span></div>
<div style="position:absolute;left:367.26px;top:182.10px" class="cls_018"><span class="cls_018">WB</span></div>
<div style="position:absolute;left:201.91px;top:230.71px" class="cls_019"><span class="cls_019">Time</span></div>
<div style="position:absolute;left:135.65px;top:246.14px" class="cls_020"><span class="cls_020">Figure 1.1.   MIPS 5-stage pipeline</span></div>
<div style="position:absolute;left:48.02px;top:256.81px" class="cls_006"><span class="cls_006">Pipelined processors operate by breaking instruction execution into</span></div>
<div style="position:absolute;left:36.00px;top:267.81px" class="cls_006"><span class="cls_006">multiple small independent “stages”; since the stages are independent,</span></div>
<div style="position:absolute;left:36.00px;top:278.81px" class="cls_006"><span class="cls_006">multiple instructions can be in varying states of completion at any one</span></div>
<div style="position:absolute;left:36.00px;top:289.81px" class="cls_006"><span class="cls_006">time. Also, this organization tends to facilitate higher frequencies of</span></div>
<div style="position:absolute;left:36.00px;top:300.81px" class="cls_006"><span class="cls_006">operation, since very complex activities can be broken down into “bite-</span></div>
<div style="position:absolute;left:36.00px;top:311.81px" class="cls_006"><span class="cls_006">sized” chunks. The result is that multiple instructions are executing at any</span></div>
<div style="position:absolute;left:36.00px;top:322.81px" class="cls_006"><span class="cls_006">one time, and that instructions are initiated (and completed) at very high</span></div>
<div style="position:absolute;left:36.00px;top:333.81px" class="cls_006"><span class="cls_006">frequency. MIPS has consistently been among the most aggressive in the</span></div>
<div style="position:absolute;left:36.00px;top:344.81px" class="cls_006"><span class="cls_006">utilization of these techniques.</span></div>
<div style="position:absolute;left:48.02px;top:355.81px" class="cls_006"><span class="cls_006">Pipelining depends for its success on another technique; using </span><span class="cls_008">caches</span></div>
<div style="position:absolute;left:36.00px;top:366.81px" class="cls_006"><span class="cls_006">to reduce the amount of time spent waiting for memory. The MIPS R3000A</span></div>
<div style="position:absolute;left:36.00px;top:377.81px" class="cls_006"><span class="cls_006">architecture uses separate instruction and data caches, so it can fetch an</span></div>
<div style="position:absolute;left:36.00px;top:388.81px" class="cls_006"><span class="cls_006">instruction and read or write a memory variable in the same clock phase.</span></div>
<div style="position:absolute;left:36.00px;top:399.81px" class="cls_006"><span class="cls_006">By mating high-frequency operation to high memory-bandwidth, very</span></div>
<div style="position:absolute;left:36.00px;top:410.81px" class="cls_006"><span class="cls_006">high-performance is achieved.</span></div>
<div style="position:absolute;left:48.02px;top:421.81px" class="cls_006"><span class="cls_006">In CISC architectures, caches are often seen as part of memory. A RISC</span></div>
<div style="position:absolute;left:36.00px;top:432.81px" class="cls_006"><span class="cls_006">architecture makes more sense if the dual caches are regarded as very</span></div>
<div style="position:absolute;left:36.00px;top:443.81px" class="cls_006"><span class="cls_006">much part of the CPU; in fact, the pipelines of virtually all RISC processors</span></div>
<div style="position:absolute;left:36.00px;top:454.81px" class="cls_006"><span class="cls_006">require caches to maintain execution. The CPU normally runs from cache</span></div>
<div style="position:absolute;left:36.00px;top:465.81px" class="cls_006"><span class="cls_006">and a cache miss (where data or instructions have to be fetched from</span></div>
<div style="position:absolute;left:36.00px;top:476.81px" class="cls_006"><span class="cls_006">memory) is seen as an exceptional event.</span></div>
<div style="position:absolute;left:48.02px;top:487.81px" class="cls_006"><span class="cls_006">For the R3000A and its derivatives, instruction execution is divided into</span></div>
<div style="position:absolute;left:36.00px;top:498.81px" class="cls_006"><span class="cls_006">five phases (called </span><span class="cls_008">pipestages</span><span class="cls_006">), with each pipestage taking a fixed amount</span></div>
<div style="position:absolute;left:36.00px;top:509.81px" class="cls_006"><span class="cls_006">of time (see “MIPS 5-stage pipeline” on page 1-2). Again, note that this</span></div>
<div style="position:absolute;left:36.00px;top:520.81px" class="cls_006"><span class="cls_006">model assumes that instruction fetches and data accesses can be satisfied</span></div>
<div style="position:absolute;left:36.00px;top:531.81px" class="cls_006"><span class="cls_006">from the processor caches at the processor operation frequency. All</span></div>
<div style="position:absolute;left:36.00px;top:542.81px" class="cls_006"><span class="cls_006">instructions are rigidly defined to follow the same sequence of pipestages,</span></div>
<div style="position:absolute;left:36.00px;top:553.81px" class="cls_006"><span class="cls_006">even where the instruction does nothing at some stage.</span></div>
<div style="position:absolute;left:48.02px;top:564.81px" class="cls_006"><span class="cls_006">The net result is that, so long as it keeps hitting the cache, the CPU</span></div>
<div style="position:absolute;left:36.00px;top:575.81px" class="cls_006"><span class="cls_006">starts an instruction every clock.</span></div>
<div style="position:absolute;left:48.02px;top:586.81px" class="cls_006"><span class="cls_006">"Figure</span></div>
<div style="position:absolute;left:93.09px;top:586.81px" class="cls_006"><span class="cls_006">1.1.   MIPS</span></div>
<div style="position:absolute;left:157.43px;top:586.81px" class="cls_006"><span class="cls_006">5-stage   pipeline”,   illustrates   this   operation.</span></div>
<div style="position:absolute;left:36.00px;top:597.81px" class="cls_006"><span class="cls_006">Instruction  execution  activity  can  be  described  as  occurring  in  the</span></div>
<div style="position:absolute;left:36.00px;top:608.81px" class="cls_006"><span class="cls_006">individual pipestages:</span></div>
<div style="position:absolute;left:48.02px;top:622.81px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> IF</span><span class="cls_006">: (‘‘instruction fetch’’) gets the next instruction from the instruction</span></div>
<div style="position:absolute;left:59.98px;top:633.81px" class="cls_006"><span class="cls_006">cache (</span><span class="cls_008">I-cache</span><span class="cls_006">).</span></div>
<div style="position:absolute;left:48.03px;top:647.81px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> RD</span><span class="cls_006">:</span></div>
<div style="position:absolute;left:86.22px;top:647.81px" class="cls_006"><span class="cls_006">(‘‘read  registers’’)  decodes  the  instruction  and  fetches  the</span></div>
<div style="position:absolute;left:59.98px;top:658.81px" class="cls_006"><span class="cls_006">contents of any CPU registers it uses.</span></div>
<div style="position:absolute;left:48.03px;top:672.81px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> ALU</span><span class="cls_006">:</span></div>
<div style="position:absolute;left:91.37px;top:672.81px" class="cls_006"><span class="cls_006">(‘‘arithmetic/logic  unit’’)  performs  an  arithmetic  or  logical</span></div>
<div style="position:absolute;left:59.98px;top:683.81px" class="cls_006"><span class="cls_006">operation in one clock (floating point math and integer multiply/</span></div>
<div style="position:absolute;left:59.98px;top:694.81px" class="cls_006"><span class="cls_006">divide can’t be done in one clock and are done differently; this is</span></div>
<div style="position:absolute;left:59.98px;top:705.81px" class="cls_006"><span class="cls_006">described later).</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">1-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:11228px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">INTRODUCTION</span></div>
<div style="position:absolute;left:524.74px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 1</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> MEM</span><span class="cls_006">:  the  stage  where  the  instruction  can  read/write  memory</span></div>
<div style="position:absolute;left:239.98px;top:61.67px" class="cls_006"><span class="cls_006">variables in the data cache (</span><span class="cls_008">D-cache</span><span class="cls_006">). Note that for typical programs,</span></div>
<div style="position:absolute;left:239.98px;top:72.67px" class="cls_006"><span class="cls_006">three out of four instructions do nothing in this stage; but allocating</span></div>
<div style="position:absolute;left:239.98px;top:83.67px" class="cls_006"><span class="cls_006">the stage to each instruction ensures that the processor never has</span></div>
<div style="position:absolute;left:239.98px;top:94.67px" class="cls_006"><span class="cls_006">two instructions wanting the data cache at the same time.</span></div>
<div style="position:absolute;left:228.03px;top:108.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> WB</span><span class="cls_006">: (‘‘write back’’) store the value obtained from an operation back to</span></div>
<div style="position:absolute;left:239.98px;top:119.67px" class="cls_006"><span class="cls_006">the register file.</span></div>
<div style="position:absolute;left:228.03px;top:130.67px" class="cls_006"><span class="cls_006">A rigid pipeline does limit the kinds of things instructions can do; in</span></div>
<div style="position:absolute;left:216.01px;top:141.67px" class="cls_006"><span class="cls_006">particular:</span></div>
<div style="position:absolute;left:228.03px;top:155.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Instruction length</span><span class="cls_006">: ALL instructions are 32 bits (exactly one machine</span></div>
<div style="position:absolute;left:239.97px;top:166.67px" class="cls_006"><span class="cls_006">‘‘word’’) long, so that they can be fetched in a constant time. This itself</span></div>
<div style="position:absolute;left:239.97px;top:177.67px" class="cls_006"><span class="cls_006">discourages complexity; there are not enough bits in the instruction</span></div>
<div style="position:absolute;left:239.97px;top:188.67px" class="cls_006"><span class="cls_006">to encode really complicated addressing modes, for example.</span></div>
<div style="position:absolute;left:228.02px;top:202.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> No arithmetic on memory variables</span><span class="cls_006">: data from cache or memory is</span></div>
<div style="position:absolute;left:239.98px;top:213.67px" class="cls_006"><span class="cls_006">obtained only in stage 4, which is much too late to be available to the</span></div>
<div style="position:absolute;left:239.98px;top:224.67px" class="cls_006"><span class="cls_006">ALU. Memory accesses occur only as simple load or store instructions</span></div>
<div style="position:absolute;left:239.98px;top:235.67px" class="cls_006"><span class="cls_006">which move the data to or from registers (this is described as a ‘‘load/</span></div>
<div style="position:absolute;left:239.98px;top:246.67px" class="cls_006"><span class="cls_006">store architecture’’).</span></div>
<div style="position:absolute;left:228.03px;top:257.67px" class="cls_006"><span class="cls_006">However, the MIPS project architects also attended to the best thinking</span></div>
<div style="position:absolute;left:216.01px;top:268.67px" class="cls_006"><span class="cls_006">of the time about what makes a CPU an easy target for efficient optimizing</span></div>
<div style="position:absolute;left:216.01px;top:279.67px" class="cls_006"><span class="cls_006">compilers. So MIPS CPUs have 32 general purpose registers, 3-operand</span></div>
<div style="position:absolute;left:216.01px;top:290.67px" class="cls_006"><span class="cls_006">arithmetical/logical instructions and eschew complex special-purpose</span></div>
<div style="position:absolute;left:216.01px;top:301.67px" class="cls_006"><span class="cls_006">instructions which compilers can’t usually generate.</span></div>
<div style="position:absolute;left:216.00px;top:324.00px" class="cls_015"><span class="cls_015">THE IDT R3xxx FAMILY CPUS</span></div>
<div style="position:absolute;left:228.02px;top:337.67px" class="cls_006"><span class="cls_006">MIPS Corporation was formed in 1984 to make a commercial version of</span></div>
<div style="position:absolute;left:216.00px;top:348.67px" class="cls_006"><span class="cls_006">the Stanford MIPS CPU. The commercial CPU was enhanced with memory</span></div>
<div style="position:absolute;left:216.00px;top:359.67px" class="cls_006"><span class="cls_006">management hardware, first appearing late in 1985 as the R2000. An</span></div>
<div style="position:absolute;left:216.00px;top:370.67px" class="cls_006"><span class="cls_006">ambitious external floating point math co-processor (the R2010 FPA) first</span></div>
<div style="position:absolute;left:216.00px;top:381.67px" class="cls_006"><span class="cls_006">shipped in mid-87. The R3000, shipped in 1988, is almost identical from</span></div>
<div style="position:absolute;left:216.00px;top:392.67px" class="cls_006"><span class="cls_006">the programmer’s viewpoint (although small hardware enhancements</span></div>
<div style="position:absolute;left:216.00px;top:403.67px" class="cls_006"><span class="cls_006">combined to give a substantial boost to performance). The R3000A was</span></div>
<div style="position:absolute;left:216.00px;top:414.67px" class="cls_006"><span class="cls_006">done in 1989, to improve the frequency of operation over the original</span></div>
<div style="position:absolute;left:216.00px;top:425.67px" class="cls_006"><span class="cls_006">R3000 (other minor enhancements were added, such as the ability for user</span></div>
<div style="position:absolute;left:216.00px;top:436.67px" class="cls_006"><span class="cls_006">tasks to operate with the opposite “endianness” from the kernel).</span></div>
<div style="position:absolute;left:228.02px;top:447.67px" class="cls_006"><span class="cls_006">The   R2000/R3000   chips   include   a   cache   controller</span></div>
<div style="position:absolute;left:543.38px;top:447.67px" class="cls_006"><span class="cls_006">-   the</span></div>
<div style="position:absolute;left:216.00px;top:458.67px" class="cls_006"><span class="cls_006">implementation  of  external  caches  merely  required  a  few  industry</span></div>
<div style="position:absolute;left:216.00px;top:469.67px" class="cls_006"><span class="cls_006">standard SRAMs and some address latches. The math co-processor shares</span></div>
<div style="position:absolute;left:216.00px;top:480.67px" class="cls_006"><span class="cls_006">the cache buses to interpret instructions (in parallel with the integer CPU)</span></div>
<div style="position:absolute;left:216.00px;top:491.67px" class="cls_006"><span class="cls_006">and transfer operands and results between the FPA and memory or the</span></div>
<div style="position:absolute;left:216.00px;top:502.67px" class="cls_006"><span class="cls_006">integer CPU.</span></div>
<div style="position:absolute;left:228.02px;top:513.67px" class="cls_006"><span class="cls_006">The division of function was ingenious, practical and workable, allowing</span></div>
<div style="position:absolute;left:216.00px;top:524.67px" class="cls_006"><span class="cls_006">the R2000/3000 generation to be built without extravagant ultra-high pin-</span></div>
<div style="position:absolute;left:216.00px;top:535.67px" class="cls_006"><span class="cls_006">count packages. However, as clock speeds increased the very high-speed</span></div>
<div style="position:absolute;left:216.00px;top:546.67px" class="cls_006"><span class="cls_006">signals in the cache interface increased design complexity and limited</span></div>
<div style="position:absolute;left:216.00px;top:557.67px" class="cls_006"><span class="cls_006">operational  frequency.  In  addition,  overall  chip  count  for  the  basic</span></div>
<div style="position:absolute;left:216.00px;top:568.67px" class="cls_006"><span class="cls_006">execution core proved to be a limitation for area and power sensitive</span></div>
<div style="position:absolute;left:216.00px;top:579.67px" class="cls_006"><span class="cls_006">embedded systems.</span></div>
<div style="position:absolute;left:228.02px;top:590.67px" class="cls_006"><span class="cls_006">The R3051, R3052, R3071, R3081 and R3041 are the members (so far)</span></div>
<div style="position:absolute;left:216.00px;top:601.67px" class="cls_006"><span class="cls_006">of a family of products defined, designed, and manufactured by IDT. The</span></div>
<div style="position:absolute;left:216.00px;top:612.67px" class="cls_006"><span class="cls_006">chips integrate the functions of the R3000A CPU, cache memory and</span></div>
<div style="position:absolute;left:216.00px;top:623.67px" class="cls_006"><span class="cls_006">(R3081 only) math co-processor. This means that all the fastest logic is on</span></div>
<div style="position:absolute;left:216.00px;top:634.67px" class="cls_006"><span class="cls_006">chip; so the integrated chips are not only cheaper and smaller than the</span></div>
<div style="position:absolute;left:216.00px;top:645.67px" class="cls_006"><span class="cls_006">original implementation, but also much easier to use.</span></div>
<div style="position:absolute;left:228.02px;top:656.67px" class="cls_006"><span class="cls_006">The parts differ in their cache sizes, whether they include onchip MMU</span></div>
<div style="position:absolute;left:216.00px;top:667.67px" class="cls_006"><span class="cls_006">and/or FPA, clock rates and packaging options. In addition, although all</span></div>
<div style="position:absolute;left:216.00px;top:678.67px" class="cls_006"><span class="cls_006">parts can be used pin-compatibly, certain products feature optional</span></div>
<div style="position:absolute;left:216.00px;top:689.67px" class="cls_006"><span class="cls_006">enhancements in their bus-interface that may serve to reduce system cost</span></div>
<div style="position:absolute;left:216.00px;top:700.67px" class="cls_006"><span class="cls_006">or complexity, and other subtle enhancements for cost or performance.</span></div>
<div style="position:absolute;left:216.00px;top:711.67px" class="cls_006"><span class="cls_006">The  major  differences  are  summarized  in  "Table</span></div>
<div style="position:absolute;left:481.93px;top:711.67px" class="cls_006"><span class="cls_006">1.1.  R30xx  family</span></div>
<div style="position:absolute;left:216.00px;top:722.67px" class="cls_006"><span class="cls_006">members compared”.</span></div>
<div style="position:absolute;left:305.77px;top:755.33px" class="cls_002"><span class="cls_002">1-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:12030px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 1</span></div>
<div style="position:absolute;left:489.49px;top:28.00px" class="cls_002"><span class="cls_002">INTRODUCTION</span></div>
<div style="position:absolute;left:87.18px;top:73.00px" class="cls_020"><span class="cls_020">Cache</span></div>
<div style="position:absolute;left:196.46px;top:72.99px" class="cls_020"><span class="cls_020">Clock</span></div>
<div style="position:absolute;left:235.25px;top:72.99px" class="cls_020"><span class="cls_020">Package</span></div>
<div style="position:absolute;left:46.14px;top:78.00px" class="cls_020"><span class="cls_020">Part</span></div>
<div style="position:absolute;left:132.60px;top:77.99px" class="cls_020"><span class="cls_020">MMU   FPA</span></div>
<div style="position:absolute;left:298.06px;top:77.98px" class="cls_020"><span class="cls_020">System Interface</span></div>
<div style="position:absolute;left:90.32px;top:83.00px" class="cls_020"><span class="cls_020">I + D</span></div>
<div style="position:absolute;left:196.37px;top:82.99px" class="cls_020"><span class="cls_020">(MHz)</span></div>
<div style="position:absolute;left:235.88px;top:82.99px" class="cls_020"><span class="cls_020">Options</span></div>
<div style="position:absolute;left:40.00px;top:102.00px" class="cls_020"><span class="cls_020">3051</span></div>
<div style="position:absolute;left:142.10px;top:102.00px" class="cls_020"><span class="cls_020">-</span></div>
<div style="position:absolute;left:83.78px;top:110.50px" class="cls_020"><span class="cls_020">4K + 1K</span></div>
<div style="position:absolute;left:173.98px;top:110.50px" class="cls_020"><span class="cls_020">-</span></div>
<div style="position:absolute;left:196.75px;top:110.50px" class="cls_020"><span class="cls_020">20-40</span></div>
<div style="position:absolute;left:242.21px;top:110.50px" class="cls_020"><span class="cls_020">PLCC</span></div>
<div style="position:absolute;left:284.13px;top:110.50px" class="cls_020"><span class="cls_020">32-bit MUX’ed A/D</span></div>
<div style="position:absolute;left:40.00px;top:118.99px" class="cls_020"><span class="cls_020">3051E</span></div>
<div style="position:absolute;left:141.87px;top:118.99px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:40.00px;top:136.00px" class="cls_020"><span class="cls_020">3052</span></div>
<div style="position:absolute;left:142.11px;top:136.00px" class="cls_020"><span class="cls_020">-</span></div>
<div style="position:absolute;left:83.78px;top:144.50px" class="cls_020"><span class="cls_020">8K + 2K</span></div>
<div style="position:absolute;left:173.99px;top:144.50px" class="cls_020"><span class="cls_020">-</span></div>
<div style="position:absolute;left:196.76px;top:144.50px" class="cls_020"><span class="cls_020">20-40</span></div>
<div style="position:absolute;left:242.20px;top:144.50px" class="cls_020"><span class="cls_020">PLCC</span></div>
<div style="position:absolute;left:284.11px;top:144.50px" class="cls_020"><span class="cls_020">32-bit MUX’ed A/D</span></div>
<div style="position:absolute;left:40.00px;top:152.99px" class="cls_020"><span class="cls_020">3052E</span></div>
<div style="position:absolute;left:141.87px;top:152.99px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:81.18px;top:169.99px" class="cls_020"><span class="cls_020">16K+4K/</span></div>
<div style="position:absolute;left:40.00px;top:175.00px" class="cls_020"><span class="cls_020">3081</span></div>
<div style="position:absolute;left:142.12px;top:174.99px" class="cls_020"><span class="cls_020">-</span></div>
<div style="position:absolute;left:86.65px;top:179.99px" class="cls_020"><span class="cls_020">8K+8K</span></div>
<div style="position:absolute;left:283.87px;top:178.50px" class="cls_020"><span class="cls_020">Optional 1/2 frequency</span></div>
<div style="position:absolute;left:173.77px;top:188.49px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:196.74px;top:188.50px" class="cls_020"><span class="cls_020">20-50</span></div>
<div style="position:absolute;left:242.20px;top:188.50px" class="cls_020"><span class="cls_020">PLCC</span></div>
<div style="position:absolute;left:283.87px;top:188.50px" class="cls_020"><span class="cls_020">bus operation</span></div>
<div style="position:absolute;left:39.99px;top:199.00px" class="cls_020"><span class="cls_020">3081E</span></div>
<div style="position:absolute;left:81.17px;top:197.01px" class="cls_020"><span class="cls_020">16K+4K/</span></div>
<div style="position:absolute;left:283.87px;top:198.50px" class="cls_020"><span class="cls_020">Optional 1x Clock Input</span></div>
<div style="position:absolute;left:141.88px;top:202.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:86.64px;top:207.00px" class="cls_020"><span class="cls_020">8K+8K</span></div>
<div style="position:absolute;left:81.18px;top:224.00px" class="cls_020"><span class="cls_020">16K+4K/</span></div>
<div style="position:absolute;left:40.00px;top:229.00px" class="cls_020"><span class="cls_020">3071</span></div>
<div style="position:absolute;left:142.12px;top:228.99px" class="cls_020"><span class="cls_020">-</span></div>
<div style="position:absolute;left:86.65px;top:233.99px" class="cls_020"><span class="cls_020">8K+8K</span></div>
<div style="position:absolute;left:283.89px;top:232.49px" class="cls_020"><span class="cls_020">1/2 frequency bus</span></div>
<div style="position:absolute;left:173.99px;top:242.49px" class="cls_020"><span class="cls_020">-</span></div>
<div style="position:absolute;left:196.76px;top:242.49px" class="cls_020"><span class="cls_020">33-50</span></div>
<div style="position:absolute;left:242.22px;top:242.49px" class="cls_020"><span class="cls_020">PLCC     operation</span></div>
<div style="position:absolute;left:40.01px;top:252.99px" class="cls_020"><span class="cls_020">3071E</span></div>
<div style="position:absolute;left:81.19px;top:251.00px" class="cls_020"><span class="cls_020">16K+4K/</span></div>
<div style="position:absolute;left:283.89px;top:252.49px" class="cls_020"><span class="cls_020">1x Clock Input</span></div>
<div style="position:absolute;left:141.90px;top:256.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:86.66px;top:260.99px" class="cls_020"><span class="cls_020">8K+8K</span></div>
<div style="position:absolute;left:242.07px;top:278.00px" class="cls_020"><span class="cls_020">PLCC</span></div>
<div style="position:absolute;left:283.88px;top:278.00px" class="cls_020"><span class="cls_020">Variable port width</span></div>
<div style="position:absolute;left:40.00px;top:283.00px" class="cls_020"><span class="cls_020">3041</span></div>
<div style="position:absolute;left:79.75px;top:283.00px" class="cls_020"><span class="cls_020">2K + 0.5K</span></div>
<div style="position:absolute;left:142.44px;top:283.00px" class="cls_020"><span class="cls_020">-</span></div>
<div style="position:absolute;left:174.35px;top:283.00px" class="cls_020"><span class="cls_020">-</span></div>
<div style="position:absolute;left:197.13px;top:283.00px" class="cls_020"><span class="cls_020">16-25</span></div>
<div style="position:absolute;left:242.07px;top:287.99px" class="cls_020"><span class="cls_020">TQFP</span></div>
<div style="position:absolute;left:283.88px;top:287.99px" class="cls_020"><span class="cls_020">interface.</span></div>
<div style="position:absolute;left:111.91px;top:307.00px" class="cls_020"><span class="cls_020">Table 1.1.  R30xx family members compared</span></div>
<div style="position:absolute;left:36.00px;top:328.00px" class="cls_015"><span class="cls_015">MIPS ARCHITECTURE LEVELS</span></div>
<div style="position:absolute;left:48.02px;top:341.67px" class="cls_006"><span class="cls_006">There are multiple generations of the MIPS architecture. The most</span></div>
<div style="position:absolute;left:36.00px;top:352.67px" class="cls_006"><span class="cls_006">commonly discussed are the MIPS-1, MIPS-2, and MIPS-3 architectures.</span></div>
<div style="position:absolute;left:48.02px;top:363.67px" class="cls_006"><span class="cls_006">MIPS-1 is the ISA found in the R2000 and R3000 generation CPUs. It is</span></div>
<div style="position:absolute;left:36.00px;top:374.67px" class="cls_006"><span class="cls_006">a 32-bit ISA, and defines the basic instruction set. Any application written</span></div>
<div style="position:absolute;left:36.00px;top:385.67px" class="cls_006"><span class="cls_006">with the MIPS-1 instruction set will operate correctly on all generations of</span></div>
<div style="position:absolute;left:36.00px;top:396.67px" class="cls_006"><span class="cls_006">the architecture.</span></div>
<div style="position:absolute;left:48.02px;top:407.67px" class="cls_006"><span class="cls_006">The MIPS-2 ISA is also 32-bit. It adds some instructions to speed up</span></div>
<div style="position:absolute;left:36.00px;top:418.67px" class="cls_006"><span class="cls_006">floating point data movement, branch-likely instructions, and other minor</span></div>
<div style="position:absolute;left:36.00px;top:429.67px" class="cls_006"><span class="cls_006">enhancements. This was first implemented in the MIPS R6000 ECL</span></div>
<div style="position:absolute;left:36.00px;top:440.67px" class="cls_006"><span class="cls_006">microprocessor.</span></div>
<div style="position:absolute;left:48.02px;top:451.67px" class="cls_006"><span class="cls_006">The MIPS-3 ISA is a 64-bit ISA. In addition to supporting all MIPS-1 and</span></div>
<div style="position:absolute;left:36.00px;top:462.67px" class="cls_006"><span class="cls_006">MIPS-2 instructions, the MIPS-3 ISA contains 64-bit equivalents of certain</span></div>
<div style="position:absolute;left:36.00px;top:473.67px" class="cls_006"><span class="cls_006">earlier instructions that are sensitive to operand size (e.g. load double and</span></div>
<div style="position:absolute;left:36.00px;top:484.67px" class="cls_006"><span class="cls_006">load  word  are  both  supported),  including  doubleword</span></div>
<div style="position:absolute;left:331.33px;top:484.67px" class="cls_006"><span class="cls_006">(64-bit)  data</span></div>
<div style="position:absolute;left:36.00px;top:495.67px" class="cls_006"><span class="cls_006">movement and arithmetic. This ISA was first implemented in the R4000 as</span></div>
<div style="position:absolute;left:36.00px;top:506.67px" class="cls_006"><span class="cls_006">a clean (“seamless”) transition from the existing 32-bit architecture.</span></div>
<div style="position:absolute;left:48.02px;top:517.67px" class="cls_006"><span class="cls_006">Note that these ISA levels do not necessarily imply a particular structure</span></div>
<div style="position:absolute;left:36.00px;top:528.67px" class="cls_006"><span class="cls_006">for the MMU, caches, exception model, or other kernel specific resources.</span></div>
<div style="position:absolute;left:36.00px;top:539.67px" class="cls_006"><span class="cls_006">Thus, different implementations of ISA compatible chips may require</span></div>
<div style="position:absolute;left:36.00px;top:550.67px" class="cls_006"><span class="cls_006">different kernels.</span></div>
<div style="position:absolute;left:48.02px;top:561.67px" class="cls_006"><span class="cls_006">In the case of the R30xx family, all devices implement the MIPS-1 ISA.</span></div>
<div style="position:absolute;left:36.00px;top:572.67px" class="cls_006"><span class="cls_006">Many devices are also kernel compatible with the R3000A, but some</span></div>
<div style="position:absolute;left:36.00px;top:583.67px" class="cls_006"><span class="cls_006">devices (most notably those without an MMU) may require small kernel</span></div>
<div style="position:absolute;left:36.00px;top:594.67px" class="cls_006"><span class="cls_006">changes or different boot modules†.</span></div>
<div style="position:absolute;left:36.00px;top:617.00px" class="cls_015"><span class="cls_015">MIPS-1 COMPARED WITH CISC ARCHITECTURES</span></div>
<div style="position:absolute;left:48.02px;top:630.67px" class="cls_006"><span class="cls_006">Although the MIPS architecture is fairly straight-forward, there are a few</span></div>
<div style="position:absolute;left:36.00px;top:641.67px" class="cls_006"><span class="cls_006">features, visible only to assembly programmers, which may at first appear</span></div>
<div style="position:absolute;left:36.00px;top:652.67px" class="cls_006"><span class="cls_006">surprising. In addition, operations familiar to CISC architectures are</span></div>
<div style="position:absolute;left:54.00px;top:686.67px" class="cls_006"><span class="cls_006">† Historically, many embedded MIPS applications have run</span></div>
<div style="position:absolute;left:54.00px;top:698.67px" class="cls_006"><span class="cls_006">exclusively out of the “kseg0 and kseg1” memory regions</span></div>
<div style="position:absolute;left:54.00px;top:710.67px" class="cls_006"><span class="cls_006">(described later in the book). For these applications, the presence</span></div>
<div style="position:absolute;left:54.00px;top:722.67px" class="cls_006"><span class="cls_006">or absence of the MMU is largely irrelevant.</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">1-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:12832px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">INTRODUCTION</span></div>
<div style="position:absolute;left:524.74px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 1</span></div>
<div style="position:absolute;left:216.00px;top:50.67px" class="cls_006"><span class="cls_006">irrelevant to the MIPS architecture. For example, the MIPS architecture</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">does not mandate a stack pointer or stack usage; thus, programmers may</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_006"><span class="cls_006">be surprised to find that push/pop instructions do not exist directly.</span></div>
<div style="position:absolute;left:228.02px;top:83.67px" class="cls_006"><span class="cls_006">The most notable of these features are summarized here.</span></div>
<div style="position:absolute;left:216.00px;top:106.00px" class="cls_015"><span class="cls_015">Unusual instruction encoding features</span></div>
<div style="position:absolute;left:228.02px;top:122.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:122.67px" class="cls_008"><span class="cls_008">All instructions are 32-bits long</span><span class="cls_006">: as mentioned above. This means, for</span></div>
<div style="position:absolute;left:239.98px;top:133.67px" class="cls_006"><span class="cls_006">example, that it is impossible to incorporate a 32-bit constant into a</span></div>
<div style="position:absolute;left:239.98px;top:144.67px" class="cls_006"><span class="cls_006">single instruction (there would be no instruction bits left to encode</span></div>
<div style="position:absolute;left:239.98px;top:155.67px" class="cls_006"><span class="cls_006">the operation and the registers!). A ‘‘load immediate’’ instruction is</span></div>
<div style="position:absolute;left:239.98px;top:166.67px" class="cls_006"><span class="cls_006">limited to a 16-bit value; a special ‘‘load upper immediate’’ must be</span></div>
<div style="position:absolute;left:239.98px;top:177.67px" class="cls_006"><span class="cls_006">followed by an ‘‘or immediate’’ to put a 32-bit constant value into a</span></div>
<div style="position:absolute;left:239.98px;top:188.67px" class="cls_006"><span class="cls_006">register.</span></div>
<div style="position:absolute;left:228.02px;top:202.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:202.67px" class="cls_008"><span class="cls_008">Instruction actions must fit the pipeline</span><span class="cls_006">: actions can only be carried out</span></div>
<div style="position:absolute;left:239.98px;top:213.67px" class="cls_006"><span class="cls_006">in the designated pipeline phase, and must be complete in one clock.</span></div>
<div style="position:absolute;left:239.98px;top:224.67px" class="cls_006"><span class="cls_006">For example, the register writeback phase provides for just one value</span></div>
<div style="position:absolute;left:239.98px;top:235.67px" class="cls_006"><span class="cls_006">to be stored in the register file, so instructions can only change one</span></div>
<div style="position:absolute;left:239.98px;top:246.67px" class="cls_006"><span class="cls_006">register.</span></div>
<div style="position:absolute;left:228.03px;top:260.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:260.67px" class="cls_008"><span class="cls_008">3-operand instructions</span><span class="cls_006">: arithmetic/logical operations don’t have to</span></div>
<div style="position:absolute;left:239.97px;top:271.67px" class="cls_006"><span class="cls_006">specify memory locations, so there are plenty of instruction bits to</span></div>
<div style="position:absolute;left:239.97px;top:282.67px" class="cls_006"><span class="cls_006">define   two   independent   source   and   one   destination   register.</span></div>
<div style="position:absolute;left:239.97px;top:293.67px" class="cls_006"><span class="cls_006">Compilers love 3-operand instructions, which give optimizers more</span></div>
<div style="position:absolute;left:239.97px;top:304.67px" class="cls_006"><span class="cls_006">scope to improve the code which handles complex expressions.</span></div>
<div style="position:absolute;left:228.02px;top:318.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:318.67px" class="cls_008"><span class="cls_008">32 registers</span><span class="cls_006">: the choice of 32 has become universal; compilers like a</span></div>
<div style="position:absolute;left:239.97px;top:329.67px" class="cls_006"><span class="cls_006">large (but not necessarily too large) number of registers, but there is</span></div>
<div style="position:absolute;left:239.97px;top:340.67px" class="cls_006"><span class="cls_006">a cost in context-saving and in encoding the registers to be used by</span></div>
<div style="position:absolute;left:239.97px;top:351.67px" class="cls_006"><span class="cls_006">an instruction. Register $0 always returns zero, to give a compact</span></div>
<div style="position:absolute;left:239.97px;top:362.67px" class="cls_006"><span class="cls_006">encoding of that useful constant.</span></div>
<div style="position:absolute;left:228.02px;top:376.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:376.67px" class="cls_008"><span class="cls_008">No condition codes</span><span class="cls_006">: the MIPS architecture does not provide condition</span></div>
<div style="position:absolute;left:239.97px;top:387.67px" class="cls_006"><span class="cls_006">code flags implicitly set by arithmetical operations. The motivation is</span></div>
<div style="position:absolute;left:239.97px;top:398.67px" class="cls_006"><span class="cls_006">to make sure that execution state is stored in one place - the register</span></div>
<div style="position:absolute;left:239.97px;top:409.67px" class="cls_006"><span class="cls_006">file. Conditional branches (in MIPS) test a single register for sign/zero,</span></div>
<div style="position:absolute;left:239.97px;top:420.67px" class="cls_006"><span class="cls_006">or a pair of registers for equality.</span></div>
<div style="position:absolute;left:216.00px;top:443.00px" class="cls_015"><span class="cls_015">Addressing and memory accesses</span></div>
<div style="position:absolute;left:228.02px;top:459.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Memory references are always register loads and stores</span><span class="cls_006">: arithmetic on</span></div>
<div style="position:absolute;left:239.97px;top:470.67px" class="cls_006"><span class="cls_006">memory  variables  upsets  the  pipeline,  so  is  not  done.  Memory</span></div>
<div style="position:absolute;left:239.97px;top:481.67px" class="cls_006"><span class="cls_006">references only occur due to explicit load or store instructions. The</span></div>
<div style="position:absolute;left:239.97px;top:492.67px" class="cls_006"><span class="cls_006">large   register   file   allows   multiple   variables   to   be</span></div>
<div style="position:absolute;left:530.89px;top:492.67px" class="cls_006"><span class="cls_006">“on-chip”</span></div>
<div style="position:absolute;left:239.97px;top:503.67px" class="cls_006"><span class="cls_006">simultaneously.</span></div>
<div style="position:absolute;left:228.02px;top:517.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Only one data addressing mode</span><span class="cls_006">: all loads and stores define the</span></div>
<div style="position:absolute;left:239.98px;top:528.67px" class="cls_006"><span class="cls_006">memory location with a single base register value modified by a 16-bit</span></div>
<div style="position:absolute;left:239.98px;top:539.67px" class="cls_006"><span class="cls_006">signed displacement. Note that the assembler/compiler tools can use</span></div>
<div style="position:absolute;left:239.98px;top:550.67px" class="cls_006"><span class="cls_006">the</span></div>
<div style="position:absolute;left:262.75px;top:550.67px" class="cls_006"><span class="cls_006">$0  register,  along  with  the  immediate  value,  to  synthesize</span></div>
<div style="position:absolute;left:239.98px;top:561.67px" class="cls_006"><span class="cls_006">additional addressing modes from this one directly supported mode.</span></div>
<div style="position:absolute;left:228.03px;top:575.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Byte-addressed</span><span class="cls_006">: the instruction set includes load/store operations</span></div>
<div style="position:absolute;left:239.98px;top:586.67px" class="cls_006"><span class="cls_006">for 8- and 16-bit variables (referred to as</span><span class="cls_008"> byte</span><span class="cls_006"> and </span><span class="cls_008">halfword</span><span class="cls_006">). Partial-</span></div>
<div style="position:absolute;left:239.98px;top:597.67px" class="cls_006"><span class="cls_006">word load instructions come in two flavors - sign-extend and zero-</span></div>
<div style="position:absolute;left:239.98px;top:608.67px" class="cls_006"><span class="cls_006">extend.</span></div>
<div style="position:absolute;left:228.03px;top:622.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Loads/stores must be address-aligned </span><span class="cls_006">: memory word operations can</span></div>
<div style="position:absolute;left:239.97px;top:633.67px" class="cls_006"><span class="cls_006">only load or store data from a single 4-byte aligned word; halfword</span></div>
<div style="position:absolute;left:239.97px;top:644.67px" class="cls_006"><span class="cls_006">operations must be aligned on half-word addresses. Many CISC</span></div>
<div style="position:absolute;left:239.97px;top:655.67px" class="cls_006"><span class="cls_006">microprocessors will load/store a multi-byte item from any byte</span></div>
<div style="position:absolute;left:239.97px;top:666.67px" class="cls_006"><span class="cls_006">address</span></div>
<div style="position:absolute;left:289.59px;top:666.67px" class="cls_006"><span class="cls_006">(although   unaligned   transfers   always   take   longer).</span></div>
<div style="position:absolute;left:239.97px;top:677.67px" class="cls_006"><span class="cls_006">Techniques  to  generate  code  which  will  handle  unaligned  data</span></div>
<div style="position:absolute;left:239.97px;top:688.67px" class="cls_006"><span class="cls_006">efficiently will be explained later.</span></div>
<div style="position:absolute;left:228.02px;top:702.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Jump instructions</span><span class="cls_006">: The smallest op-code field in a MIPS instruction is</span></div>
<div style="position:absolute;left:239.98px;top:713.67px" class="cls_006"><span class="cls_006">6 bits; leaving</span></div>
<div style="position:absolute;left:320.08px;top:713.67px" class="cls_006"><span class="cls_006">26 bits to define the target of a jump. Since all</span></div>
<div style="position:absolute;left:239.98px;top:724.67px" class="cls_006"><span class="cls_006">instructions are 4-byte aligned in memory the two least-significant</span></div>
<div style="position:absolute;left:305.77px;top:755.33px" class="cls_002"><span class="cls_002">1-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:13634px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 1</span></div>
<div style="position:absolute;left:489.49px;top:28.00px" class="cls_002"><span class="cls_002">INTRODUCTION</span></div>
<div style="position:absolute;left:59.98px;top:51.33px" class="cls_006"><span class="cls_006">address bits need not be stored, allowing an address range of 2</span><span class="cls_022"><sup>28</sup></span><span class="cls_006"> =</span></div>
<div style="position:absolute;left:59.97px;top:64.33px" class="cls_006"><span class="cls_006">256Mbytes.  Rather  than  make  this  branch  PC-relative,  this  is</span></div>
<div style="position:absolute;left:59.97px;top:75.33px" class="cls_006"><span class="cls_006">interpreted as an absolute address within a 256Mbyte ‘‘segment’’. In</span></div>
<div style="position:absolute;left:59.97px;top:86.33px" class="cls_006"><span class="cls_006">theory, this could impose a limit on the size of a single program; in</span></div>
<div style="position:absolute;left:59.97px;top:97.33px" class="cls_006"><span class="cls_006">reality, it hasn’t been a problem.</span></div>
<div style="position:absolute;left:59.97px;top:111.33px" class="cls_006"><span class="cls_006">Branches out of segment can be achieved by using a </span><span class="cls_008">jr</span><span class="cls_006"> instruction,</span></div>
<div style="position:absolute;left:59.98px;top:122.33px" class="cls_006"><span class="cls_006">which uses the contents of a register as the target.</span></div>
<div style="position:absolute;left:59.98px;top:137.00px" class="cls_006"><span class="cls_006">Conditional branches have only a 16-bit displacement field (2</span><span class="cls_022"><sup>18</sup></span><span class="cls_006"> byte</span></div>
<div style="position:absolute;left:59.98px;top:150.00px" class="cls_006"><span class="cls_006">range since instructions are 4-byte aligned) which is interpreted as a</span></div>
<div style="position:absolute;left:59.98px;top:161.00px" class="cls_006"><span class="cls_006">signed PC-relative displacement. Compilers can only code a simple</span></div>
<div style="position:absolute;left:59.98px;top:172.00px" class="cls_006"><span class="cls_006">conditional branch instruction if they know that the target will be</span></div>
<div style="position:absolute;left:59.98px;top:183.00px" class="cls_006"><span class="cls_006">within 128Kbytes of the instruction following the branch.</span></div>
<div style="position:absolute;left:36.00px;top:205.33px" class="cls_015"><span class="cls_015">Operations not directly supported</span></div>
<div style="position:absolute;left:48.02px;top:222.00px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:222.00px" class="cls_008"><span class="cls_008">No byte or halfword arithmetic</span><span class="cls_006">: all arithmetical and logical operations</span></div>
<div style="position:absolute;left:59.97px;top:233.00px" class="cls_006"><span class="cls_006">are performed on 32-bit quantities. Byte and/or halfword arithmetic</span></div>
<div style="position:absolute;left:59.97px;top:244.00px" class="cls_006"><span class="cls_006">would require significant extra resources, many more op-codes, and</span></div>
<div style="position:absolute;left:59.97px;top:255.00px" class="cls_006"><span class="cls_006">is an understandable omission. Most C programmers will use the </span><span class="cls_008">int</span></div>
<div style="position:absolute;left:59.98px;top:266.00px" class="cls_006"><span class="cls_006">data type for most arithmetic, and for MIPS an </span><span class="cls_008">int</span><span class="cls_006"> is 32 bits and such</span></div>
<div style="position:absolute;left:59.98px;top:277.00px" class="cls_006"><span class="cls_006">arithmetic will be efficient. C’s rules are to perform arithmetic in </span><span class="cls_008">int</span></div>
<div style="position:absolute;left:59.98px;top:288.00px" class="cls_006"><span class="cls_006">whenever any source or destination variable is as long as </span><span class="cls_008">int</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:59.97px;top:302.00px" class="cls_006"><span class="cls_006">However, where a program explicitly does arithmetic as </span><span class="cls_008">short</span><span class="cls_006"> the</span></div>
<div style="position:absolute;left:59.97px;top:313.00px" class="cls_006"><span class="cls_006">compiler must insert extra code to make sure that wraparound and</span></div>
<div style="position:absolute;left:59.97px;top:324.00px" class="cls_006"><span class="cls_006">overflows have the appropriate effect.</span></div>
<div style="position:absolute;left:48.02px;top:338.00px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:338.00px" class="cls_008"><span class="cls_008">No special stack support</span><span class="cls_006">: conventional MIPS assembler usage does</span></div>
<div style="position:absolute;left:59.98px;top:349.00px" class="cls_006"><span class="cls_006">define a </span><span class="cls_008">sp</span><span class="cls_006"> register, but the hardware treats </span><span class="cls_008">sp</span><span class="cls_006"> just like any other</span></div>
<div style="position:absolute;left:59.98px;top:360.00px" class="cls_006"><span class="cls_006">register. There is a recommended format for the stack frame layout of</span></div>
<div style="position:absolute;left:59.98px;top:371.00px" class="cls_006"><span class="cls_006">subroutines,  so  that  programs  can  mix  modules  from  different</span></div>
<div style="position:absolute;left:59.98px;top:382.00px" class="cls_006"><span class="cls_006">languages and compilers; it is recommended that programmers stick</span></div>
<div style="position:absolute;left:59.98px;top:393.00px" class="cls_006"><span class="cls_006">to these conventions, but they have no relationship to the hardware.</span></div>
<div style="position:absolute;left:48.03px;top:407.00px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:407.00px" class="cls_008"><span class="cls_008">Minimal subroutine overhead</span><span class="cls_006">: there is one special feature; jump</span></div>
<div style="position:absolute;left:59.98px;top:418.00px" class="cls_006"><span class="cls_006">instructions have a ‘‘jump and link’’ option which stores the return</span></div>
<div style="position:absolute;left:59.98px;top:429.00px" class="cls_006"><span class="cls_006">address into a register. $31 is the default, so for convenience and by</span></div>
<div style="position:absolute;left:59.98px;top:440.00px" class="cls_006"><span class="cls_006">convention $31 becomes the ‘‘return address’’ register.</span></div>
<div style="position:absolute;left:48.03px;top:454.00px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:454.00px" class="cls_008"><span class="cls_008">Minimal interrupt overhead</span><span class="cls_006">: The MIPS architecture makes very few</span></div>
<div style="position:absolute;left:59.98px;top:465.00px" class="cls_006"><span class="cls_006">presumptions   about   system   exception   handling,   allowing   fast</span></div>
<div style="position:absolute;left:59.98px;top:476.00px" class="cls_006"><span class="cls_006">response and a wide variety of software models. In the R30xx family,</span></div>
<div style="position:absolute;left:59.98px;top:487.00px" class="cls_006"><span class="cls_006">the CPU stashes away the restart location in the special register </span><span class="cls_008">EPC,</span></div>
<div style="position:absolute;left:59.98px;top:498.00px" class="cls_006"><span class="cls_006">modifies the machine state just enough to signal why the trap</span></div>
<div style="position:absolute;left:59.98px;top:509.00px" class="cls_006"><span class="cls_006">happened and to disallow further interrupts; then it jumps to a single</span></div>
<div style="position:absolute;left:59.98px;top:520.00px" class="cls_006"><span class="cls_006">predefined location† in low memory. Everything else is up to the</span></div>
<div style="position:absolute;left:59.98px;top:531.00px" class="cls_006"><span class="cls_006">software.</span></div>
<div style="position:absolute;left:59.98px;top:545.00px" class="cls_006"><span class="cls_006">Just to emphasize this: on an interrupt or trap a MIPS CPU </span><span class="cls_008">does not</span></div>
<div style="position:absolute;left:59.98px;top:556.00px" class="cls_006"><span class="cls_006">store anything on a stack, or write memory, or preserve any registers</span></div>
<div style="position:absolute;left:59.98px;top:567.00px" class="cls_006"><span class="cls_006">by itself.</span></div>
<div style="position:absolute;left:59.98px;top:581.00px" class="cls_006"><span class="cls_006">By convention, two registers ($k0, $k1; register conventions are</span></div>
<div style="position:absolute;left:59.98px;top:592.00px" class="cls_006"><span class="cls_006">explained in chapter 2) are reserved so that interrupt/trap routines</span></div>
<div style="position:absolute;left:59.98px;top:603.00px" class="cls_006"><span class="cls_006">can ‘‘bootstrap’’ themselves - it is impossible to do anything on a MIPS</span></div>
<div style="position:absolute;left:59.98px;top:614.00px" class="cls_006"><span class="cls_006">CPU without using some registers. For a program running in any</span></div>
<div style="position:absolute;left:59.98px;top:625.00px" class="cls_006"><span class="cls_006">system which takes interrupts or traps, the values of these registers</span></div>
<div style="position:absolute;left:59.98px;top:636.00px" class="cls_006"><span class="cls_006">may change at any time, and thus should not be used.</span></div>
<div style="position:absolute;left:54.00px;top:710.67px" class="cls_006"><span class="cls_006">† One particular kind of trap (a TLB miss on an address in the</span></div>
<div style="position:absolute;left:54.00px;top:722.67px" class="cls_006"><span class="cls_006">user-privilege address space) has a different dedicated entry point.</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">1-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:14436px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">INTRODUCTION</span></div>
<div style="position:absolute;left:524.74px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 1</span></div>
<div style="position:absolute;left:216.00px;top:50.00px" class="cls_015"><span class="cls_015">Multiply and divide operations</span></div>
<div style="position:absolute;left:228.02px;top:63.67px" class="cls_006"><span class="cls_006">The  MIPS  CPU  does  have  an  integer  multiply/divide  unit;  worth</span></div>
<div style="position:absolute;left:216.00px;top:74.67px" class="cls_006"><span class="cls_006">mentioning because many RISC machines don’t have multiply hardware.</span></div>
<div style="position:absolute;left:216.00px;top:85.67px" class="cls_006"><span class="cls_006">The multiply unit is relatively independent of the rest of the CPU, with its</span></div>
<div style="position:absolute;left:216.00px;top:96.67px" class="cls_006"><span class="cls_006">own special output registers.</span></div>
<div style="position:absolute;left:216.00px;top:119.00px" class="cls_015"><span class="cls_015">Programmer-visible pipeline effects</span></div>
<div style="position:absolute;left:228.02px;top:132.67px" class="cls_006"><span class="cls_006">In addition to the discussion above, programmers of R3xxx architecture</span></div>
<div style="position:absolute;left:216.00px;top:143.67px" class="cls_006"><span class="cls_006">CPUs  also  must  be  aware  of  certain  effects  of  the  MIPS  pipeline.</span></div>
<div style="position:absolute;left:216.00px;top:154.67px" class="cls_006"><span class="cls_006">Specifically, the results of certain operations may not be available in the</span></div>
<div style="position:absolute;left:216.00px;top:165.67px" class="cls_006"><span class="cls_006">immediately subsequent instruction; the programmer may need to be</span></div>
<div style="position:absolute;left:216.00px;top:176.67px" class="cls_006"><span class="cls_006">explicitly aware of such cases.</span></div>
<div style="position:absolute;left:352.93px;top:209.35px" class="cls_023"><span class="cls_023">branch</span></div>
<div style="position:absolute;left:227.66px;top:214.53px" class="cls_024"><span class="cls_024">branch</span></div>
<div style="position:absolute;left:301.39px;top:213.54px" class="cls_023"><span class="cls_023">IF</span></div>
<div style="position:absolute;left:335.18px;top:213.54px" class="cls_023"><span class="cls_023">RF</span></div>
<div style="position:absolute;left:414.34px;top:213.54px" class="cls_023"><span class="cls_023">MEM</span></div>
<div style="position:absolute;left:452.56px;top:213.54px" class="cls_023"><span class="cls_023">WB</span></div>
<div style="position:absolute;left:356.63px;top:217.73px" class="cls_023"><span class="cls_023">addr</span></div>
<div style="position:absolute;left:227.66px;top:256.70px" class="cls_024"><span class="cls_024">branch</span></div>
<div style="position:absolute;left:348.74px;top:260.89px" class="cls_023"><span class="cls_023">IF</span></div>
<div style="position:absolute;left:382.53px;top:260.89px" class="cls_023"><span class="cls_023">RF</span></div>
<div style="position:absolute;left:415.82px;top:260.89px" class="cls_023"><span class="cls_023">ALU</span></div>
<div style="position:absolute;left:461.69px;top:260.89px" class="cls_023"><span class="cls_023">MEM</span></div>
<div style="position:absolute;left:499.91px;top:260.89px" class="cls_023"><span class="cls_023">WB</span></div>
<div style="position:absolute;left:230.37px;top:265.08px" class="cls_024"><span class="cls_024">delay</span></div>
<div style="position:absolute;left:227.66px;top:304.05px" class="cls_024"><span class="cls_024">branch</span></div>
<div style="position:absolute;left:396.09px;top:308.24px" class="cls_023"><span class="cls_023">IF</span></div>
<div style="position:absolute;left:429.87px;top:308.24px" class="cls_023"><span class="cls_023">RF</span></div>
<div style="position:absolute;left:463.17px;top:308.24px" class="cls_023"><span class="cls_023">ALU</span></div>
<div style="position:absolute;left:509.03px;top:308.24px" class="cls_023"><span class="cls_023">MEM</span></div>
<div style="position:absolute;left:547.26px;top:308.24px" class="cls_023"><span class="cls_023">WB</span></div>
<div style="position:absolute;left:229.63px;top:312.43px" class="cls_024"><span class="cls_024">target</span></div>
<div style="position:absolute;left:293.24px;top:349.28px" class="cls_020"><span class="cls_020">Figure 1.2.   The pipeline and branch delays</span></div>
<div style="position:absolute;left:228.02px;top:362.95px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:362.95px" class="cls_008"><span class="cls_008">Delayed branches</span><span class="cls_006">: the pipeline structure of the MIPS CPU (see "Figure</span></div>
<div style="position:absolute;left:239.98px;top:373.95px" class="cls_006"><span class="cls_006">1.2. The pipeline and branch delays”) means that when a jump</span></div>
<div style="position:absolute;left:239.98px;top:384.95px" class="cls_006"><span class="cls_006">instruction reaches the ‘‘execute’’ phase and a new program counter</span></div>
<div style="position:absolute;left:239.98px;top:395.95px" class="cls_006"><span class="cls_006">is generated, the instruction after the jump will already have been</span></div>
<div style="position:absolute;left:239.98px;top:406.95px" class="cls_006"><span class="cls_006">decoded.  Rather  than  discard  this  potentially  useful  work,  the</span></div>
<div style="position:absolute;left:239.98px;top:417.95px" class="cls_006"><span class="cls_006">architecture rules state that the </span><span class="cls_008">instruction after a branch is always</span></div>
<div style="position:absolute;left:239.98px;top:428.95px" class="cls_008"><span class="cls_008">executed before the instruction at the target of the branch</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:239.97px;top:442.95px" class="cls_006"><span class="cls_006">"Figure 1.2. The pipeline and branch delays” show that a special path</span></div>
<div style="position:absolute;left:239.97px;top:453.95px" class="cls_006"><span class="cls_006">is provided through the ALU to make the branch address available a</span></div>
<div style="position:absolute;left:239.97px;top:464.95px" class="cls_006"><span class="cls_006">half-clock early, ensuring that there is only a one cycle delay before</span></div>
<div style="position:absolute;left:239.97px;top:475.95px" class="cls_006"><span class="cls_006">the  outcome  of  the  branch  is  determined  and  the  appropriate</span></div>
<div style="position:absolute;left:239.97px;top:486.95px" class="cls_006"><span class="cls_006">instruction flow (branch taken or not taken) is initiated.</span></div>
<div style="position:absolute;left:239.97px;top:500.95px" class="cls_006"><span class="cls_006">It is the responsibility of the compiler system or the assembler-</span></div>
<div style="position:absolute;left:239.97px;top:511.95px" class="cls_006"><span class="cls_006">programmer to allow for and even to exploit this “branch delay slot”;</span></div>
<div style="position:absolute;left:239.97px;top:522.95px" class="cls_006"><span class="cls_006">it turns out that it is usually possible to arrange code such that the</span></div>
<div style="position:absolute;left:239.97px;top:533.95px" class="cls_006"><span class="cls_006">instruction in the ‘‘delay slot’’ does useful work. Quite often, the</span></div>
<div style="position:absolute;left:239.97px;top:544.95px" class="cls_006"><span class="cls_006">instruction which would otherwise have been placed before the</span></div>
<div style="position:absolute;left:239.97px;top:555.95px" class="cls_006"><span class="cls_006">branch can be moved into the delay slot.</span></div>
<div style="position:absolute;left:239.97px;top:569.95px" class="cls_006"><span class="cls_006">This can be a bit tricky on a conditional branch, where the branch</span></div>
<div style="position:absolute;left:239.97px;top:580.95px" class="cls_006"><span class="cls_006">delay instruction must be (at least) harmless on the path where it isn’t</span></div>
<div style="position:absolute;left:239.97px;top:591.95px" class="cls_006"><span class="cls_006">wanted. Where nothing useful can be done the delay slot is filled with</span></div>
<div style="position:absolute;left:239.97px;top:602.95px" class="cls_006"><span class="cls_006">a ‘‘nop’’ (no-op, or no-operation) instruction.</span></div>
<div style="position:absolute;left:239.98px;top:616.95px" class="cls_006"><span class="cls_006">Many MIPS assemblers will hide this feature from the programmer</span></div>
<div style="position:absolute;left:239.98px;top:627.95px" class="cls_006"><span class="cls_006">unless explicitly told not to, as described later.</span></div>
<div style="position:absolute;left:228.03px;top:641.95px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:641.95px" class="cls_008"><span class="cls_008">Load data not available to next instruction</span><span class="cls_006">: another consequence of</span></div>
<div style="position:absolute;left:239.98px;top:652.95px" class="cls_006"><span class="cls_006">the pipeline is that a load instruction’s data arrives from the cache/</span></div>
<div style="position:absolute;left:239.98px;top:663.95px" class="cls_006"><span class="cls_006">memory system AFTER the </span><span class="cls_008">next</span><span class="cls_006"> instruction’s ALU phase starts - so it</span></div>
<div style="position:absolute;left:239.98px;top:674.95px" class="cls_006"><span class="cls_006">is not possible to use the data from a load in the following instruction.</span></div>
<div style="position:absolute;left:239.98px;top:685.95px" class="cls_006"><span class="cls_006">See "Figure 1.3. The pipeline and load delays” for how this works. On</span></div>
<div style="position:absolute;left:239.98px;top:696.95px" class="cls_006"><span class="cls_006">the MIPS-1 architecture, the programmer must insure that this rule</span></div>
<div style="position:absolute;left:239.98px;top:707.95px" class="cls_006"><span class="cls_006">is not violated</span></div>
<div style="position:absolute;left:305.77px;top:755.33px" class="cls_002"><span class="cls_002">1-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:15238px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 1</span></div>
<div style="position:absolute;left:489.49px;top:28.00px" class="cls_002"><span class="cls_002">INTRODUCTION</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:49.27px;top:88.80px" class="cls_025"><span class="cls_025">load</span></div>
<div style="position:absolute;left:117.96px;top:87.80px" class="cls_026"><span class="cls_026">IF</span></div>
<div style="position:absolute;left:151.69px;top:87.80px" class="cls_026"><span class="cls_026">RD</span></div>
<div style="position:absolute;left:185.91px;top:87.80px" class="cls_026"><span class="cls_026">ALU</span></div>
<div style="position:absolute;left:232.37px;top:87.80px" class="cls_026"><span class="cls_026">MEM</span></div>
<div style="position:absolute;left:271.08px;top:87.80px" class="cls_026"><span class="cls_026">WB</span></div>
<div style="position:absolute;left:49.27px;top:131.53px" class="cls_025"><span class="cls_025">load</span></div>
<div style="position:absolute;left:165.93px;top:135.77px" class="cls_026"><span class="cls_026">IF</span></div>
<div style="position:absolute;left:199.65px;top:135.77px" class="cls_026"><span class="cls_026">RD</span></div>
<div style="position:absolute;left:233.87px;top:135.77px" class="cls_026"><span class="cls_026">ALU</span></div>
<div style="position:absolute;left:280.33px;top:135.77px" class="cls_026"><span class="cls_026">MEM</span></div>
<div style="position:absolute;left:319.04px;top:135.77px" class="cls_026"><span class="cls_026">WB</span></div>
<div style="position:absolute;left:47.53px;top:140.02px" class="cls_025"><span class="cls_025">delay</span></div>
<div style="position:absolute;left:50.02px;top:179.50px" class="cls_025"><span class="cls_025">use</span></div>
<div style="position:absolute;left:213.88px;top:183.75px" class="cls_026"><span class="cls_026">IF</span></div>
<div style="position:absolute;left:247.60px;top:183.75px" class="cls_026"><span class="cls_026">RD</span></div>
<div style="position:absolute;left:281.83px;top:183.75px" class="cls_026"><span class="cls_026">ALU</span></div>
<div style="position:absolute;left:328.29px;top:183.75px" class="cls_026"><span class="cls_026">MEM</span></div>
<div style="position:absolute;left:367.00px;top:183.75px" class="cls_026"><span class="cls_026">WB</span></div>
<div style="position:absolute;left:49.02px;top:187.99px" class="cls_025"><span class="cls_025">data</span></div>
<div style="position:absolute;left:119.52px;top:225.37px" class="cls_020"><span class="cls_020">Figure 1.3.   The pipeline and load delays</span></div>
<div style="position:absolute;left:59.98px;top:239.04px" class="cls_006"><span class="cls_006">Again, most assemblers will hide this if they can. Frequently, the</span></div>
<div style="position:absolute;left:59.98px;top:250.04px" class="cls_006"><span class="cls_006">assembler can move an instruction which is independent of the load</span></div>
<div style="position:absolute;left:59.98px;top:261.04px" class="cls_006"><span class="cls_006">into the load delay slot; in the worst case, it can insert a NOP to insure</span></div>
<div style="position:absolute;left:59.98px;top:272.04px" class="cls_006"><span class="cls_006">proper program execution.</span></div>
<div style="position:absolute;left:36.00px;top:294.37px" class="cls_015"><span class="cls_015">A NOTE ON MACHINE AND ASSEMBLER LANGUAGE</span></div>
<div style="position:absolute;left:48.02px;top:308.04px" class="cls_006"><span class="cls_006">To simplify assembly level programming, the MIPS Corp’s assembler</span></div>
<div style="position:absolute;left:36.00px;top:319.04px" class="cls_006"><span class="cls_006">(and   many   other   MIPS   assemblers)   provides   a   set   of</span></div>
<div style="position:absolute;left:343.32px;top:319.04px" class="cls_006"><span class="cls_006">“synthetic”</span></div>
<div style="position:absolute;left:36.00px;top:330.04px" class="cls_006"><span class="cls_006">instructions. Typically, a synthetic instruction is a common assembly level</span></div>
<div style="position:absolute;left:36.00px;top:341.04px" class="cls_006"><span class="cls_006">operation that the assembler will map into one or more true instructions.</span></div>
<div style="position:absolute;left:36.00px;top:352.04px" class="cls_006"><span class="cls_006">This mapping can be more intelligent than a mere macro expansion. For</span></div>
<div style="position:absolute;left:36.00px;top:363.04px" class="cls_006"><span class="cls_006">example, an immediate load may map into one instruction if the datum is</span></div>
<div style="position:absolute;left:36.00px;top:374.04px" class="cls_006"><span class="cls_006">small enough, or multiple instructions if the datum is larger. However,</span></div>
<div style="position:absolute;left:36.00px;top:385.04px" class="cls_006"><span class="cls_006">these instructions can dramatically simplify assembly level programming.</span></div>
<div style="position:absolute;left:36.00px;top:396.04px" class="cls_006"><span class="cls_006">For example, the programmer just writes a ‘‘load immediate’’ instruction</span></div>
<div style="position:absolute;left:36.00px;top:407.04px" class="cls_006"><span class="cls_006">and the assembler will figure out whether it needs to generate multiple</span></div>
<div style="position:absolute;left:36.00px;top:418.04px" class="cls_006"><span class="cls_006">machine instructions or can get by with just one</span></div>
<div style="position:absolute;left:307.94px;top:418.04px" class="cls_006"><span class="cls_006">(in this example,</span></div>
<div style="position:absolute;left:36.00px;top:429.04px" class="cls_006"><span class="cls_006">depending on the size of the immediate datum).</span></div>
<div style="position:absolute;left:48.02px;top:440.04px" class="cls_006"><span class="cls_006">This is obviously useful, but can be confusing. This manual will try to</span></div>
<div style="position:absolute;left:36.00px;top:451.04px" class="cls_006"><span class="cls_006">use  synthetic  instructions  sparingly,  and  indicate  when  it  happens.</span></div>
<div style="position:absolute;left:36.00px;top:462.04px" class="cls_006"><span class="cls_006">Moreover,  the  instruction  tables  below  will  consistently  distinguish</span></div>
<div style="position:absolute;left:36.00px;top:473.04px" class="cls_006"><span class="cls_006">between synthetic and machine instructions.</span></div>
<div style="position:absolute;left:48.02px;top:484.04px" class="cls_006"><span class="cls_006">These features are there to help human programmers; most compilers</span></div>
<div style="position:absolute;left:36.00px;top:495.04px" class="cls_006"><span class="cls_006">generate instructions which are one-for-one with machine code. However,</span></div>
<div style="position:absolute;left:36.00px;top:506.03px" class="cls_006"><span class="cls_006">some compilers will in fact generate synthetic instructions.</span></div>
<div style="position:absolute;left:48.02px;top:517.03px" class="cls_006"><span class="cls_006">Helpful things the assembler does:</span></div>
<div style="position:absolute;left:48.02px;top:531.03px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:531.03px" class="cls_008"><span class="cls_008">32-bit load immediates</span><span class="cls_006">: The programmer can code a load with any</span></div>
<div style="position:absolute;left:59.98px;top:542.03px" class="cls_006"><span class="cls_006">value (including a memory location which will be computed at link</span></div>
<div style="position:absolute;left:59.98px;top:553.03px" class="cls_006"><span class="cls_006">time), and the assembler will break it down into two instructions to</span></div>
<div style="position:absolute;left:59.98px;top:564.03px" class="cls_006"><span class="cls_006">load the high and low half of the value.</span></div>
<div style="position:absolute;left:48.03px;top:578.03px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Load from memory location</span><span class="cls_006">: The programmer can code a load from a</span></div>
<div style="position:absolute;left:59.97px;top:589.03px" class="cls_006"><span class="cls_006">memory-resident variable. The assembler will normally replace this</span></div>
<div style="position:absolute;left:59.97px;top:600.03px" class="cls_006"><span class="cls_006">by loading a temporary register with the high-order half of the</span></div>
<div style="position:absolute;left:59.97px;top:611.03px" class="cls_006"><span class="cls_006">variable’s address, followed by a load whose displacement is the low-</span></div>
<div style="position:absolute;left:59.97px;top:622.03px" class="cls_006"><span class="cls_006">order half of the address.</span></div>
<div style="position:absolute;left:59.97px;top:636.03px" class="cls_006"><span class="cls_006">Of course, this does not apply to variables defined inside C functions,</span></div>
<div style="position:absolute;left:59.97px;top:647.03px" class="cls_006"><span class="cls_006">which are implemented either in registers or on the stack.</span></div>
<div style="position:absolute;left:48.02px;top:661.03px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Efficient access to memory variables</span><span class="cls_006">: some C programs contain many</span></div>
<div style="position:absolute;left:59.97px;top:672.03px" class="cls_006"><span class="cls_006">references  to </span><span class="cls_008"> static</span><span class="cls_006">  or </span><span class="cls_008"> extern</span><span class="cls_006">  variables,  and  a  two-instruction</span></div>
<div style="position:absolute;left:59.98px;top:683.03px" class="cls_006"><span class="cls_006">sequence to load/store any of them is expensive. Some compilation</span></div>
<div style="position:absolute;left:59.98px;top:694.03px" class="cls_006"><span class="cls_006">systems, with run-time support, get around this. Certain variables</span></div>
<div style="position:absolute;left:59.98px;top:705.03px" class="cls_006"><span class="cls_006">are  selected  at  compile/assemble  time</span></div>
<div style="position:absolute;left:269.73px;top:705.03px" class="cls_006"><span class="cls_006">(by  default  MIPS  Corp’s</span></div>
<div style="position:absolute;left:59.98px;top:716.03px" class="cls_006"><span class="cls_006">assembler selects variables which occupy 8 or less bytes of storage)</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">1-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:16040px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">INTRODUCTION</span></div>
<div style="position:absolute;left:524.74px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 1</span></div>
<div style="position:absolute;left:239.98px;top:50.67px" class="cls_006"><span class="cls_006">and kept together in a single section of memory which must end up</span></div>
<div style="position:absolute;left:239.98px;top:61.67px" class="cls_006"><span class="cls_006">smaller than 64Kbytes. The run-time system then initializes one</span></div>
<div style="position:absolute;left:239.98px;top:72.67px" class="cls_006"><span class="cls_006">register ($28 or </span><span class="cls_008">gp</span><span class="cls_006"> (global pointer) by convention) to point to the</span></div>
<div style="position:absolute;left:239.98px;top:83.67px" class="cls_006"><span class="cls_006">middle of this section.</span></div>
<div style="position:absolute;left:239.98px;top:97.67px" class="cls_006"><span class="cls_006">Loads and stores to these variables can now be coded as a single </span><span class="cls_008">gp</span></div>
<div style="position:absolute;left:239.98px;top:108.67px" class="cls_006"><span class="cls_006">relative load or store.</span></div>
<div style="position:absolute;left:228.03px;top:122.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:122.67px" class="cls_008"><span class="cls_008">More types of branch condition</span><span class="cls_006">: the assembler synthesizes a full set of</span></div>
<div style="position:absolute;left:239.97px;top:133.67px" class="cls_006"><span class="cls_006">branches conditional on an arithmetic test between two registers.</span></div>
<div style="position:absolute;left:228.02px;top:147.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:147.67px" class="cls_008"><span class="cls_008">Simple or different forms of instructions</span><span class="cls_006">: unary operations such as </span><span class="cls_008">not</span></div>
<div style="position:absolute;left:239.98px;top:158.67px" class="cls_006"><span class="cls_006">and </span><span class="cls_008">neg</span><span class="cls_006"> are produced as a </span><span class="cls_008">nor</span><span class="cls_006"> or </span><span class="cls_008">sub</span><span class="cls_006"> with the zero-valued register </span><span class="cls_008">$0.</span></div>
<div style="position:absolute;left:239.97px;top:172.67px" class="cls_006"><span class="cls_006">Two-operand forms of 3-operand instructions can be written; the</span></div>
<div style="position:absolute;left:239.97px;top:183.67px" class="cls_006"><span class="cls_006">assembler will put the result back into the first-specified register.</span></div>
<div style="position:absolute;left:228.02px;top:197.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:197.67px" class="cls_008"><span class="cls_008">Hiding the branch delay slot</span><span class="cls_006">: in normal coding most assemblers will</span></div>
<div style="position:absolute;left:239.97px;top:208.67px" class="cls_006"><span class="cls_006">not allow access the branch delay slot. MIPS Corp.’s assembler, in</span></div>
<div style="position:absolute;left:239.97px;top:219.67px" class="cls_006"><span class="cls_006">particular,  is  exceptionally  ingenious  and  may  re-organize  the</span></div>
<div style="position:absolute;left:239.97px;top:230.67px" class="cls_006"><span class="cls_006">instruction sequence substantially in search of something useful to</span></div>
<div style="position:absolute;left:239.97px;top:241.67px" class="cls_006"><span class="cls_006">do in the delay slot. An assembler directive ‘‘.noreorder’’ is available</span></div>
<div style="position:absolute;left:239.97px;top:252.67px" class="cls_006"><span class="cls_006">where this must not happen.</span></div>
<div style="position:absolute;left:228.02px;top:266.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:266.67px" class="cls_008"><span class="cls_008">Hiding the load delay</span><span class="cls_006">: many assemblers will detect an attempt to use</span></div>
<div style="position:absolute;left:239.97px;top:277.67px" class="cls_006"><span class="cls_006">the result of a load in the next instruction, and will either move code</span></div>
<div style="position:absolute;left:239.97px;top:288.67px" class="cls_006"><span class="cls_006">around or insert a nop.</span></div>
<div style="position:absolute;left:228.02px;top:302.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:302.67px" class="cls_008"><span class="cls_008">Unaligned transfers</span><span class="cls_006">: the</span></div>
<div style="position:absolute;left:371.60px;top:302.67px" class="cls_006"><span class="cls_006">‘‘unaligned’’ load/store instructions will</span></div>
<div style="position:absolute;left:239.97px;top:313.67px" class="cls_006"><span class="cls_006">fetch halfword and word quantities correctly, even if the target</span></div>
<div style="position:absolute;left:239.97px;top:324.67px" class="cls_006"><span class="cls_006">address turns out to be unaligned.</span></div>
<div style="position:absolute;left:228.02px;top:338.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:338.67px" class="cls_008"><span class="cls_008">Other pipeline corrections</span><span class="cls_006">: some instructions (such as those which use</span></div>
<div style="position:absolute;left:239.97px;top:349.67px" class="cls_006"><span class="cls_006">the  integer  multiply  unit)  have  additional  constraints  that  are</span></div>
<div style="position:absolute;left:239.97px;top:360.67px" class="cls_006"><span class="cls_006">implementation  specific</span></div>
<div style="position:absolute;left:369.65px;top:360.67px" class="cls_006"><span class="cls_006">(see  the  Appendix  on  hazards).  Many</span></div>
<div style="position:absolute;left:239.97px;top:371.67px" class="cls_006"><span class="cls_006">assemblers will just “handle” these cases automatically, or at least</span></div>
<div style="position:absolute;left:239.97px;top:382.67px" class="cls_006"><span class="cls_006">warn the programmer about possible hazards violations.</span></div>
<div style="position:absolute;left:228.02px;top:396.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:396.67px" class="cls_008"><span class="cls_008">Other optimizations</span><span class="cls_006">: some MIPS instructions (particularly floating</span></div>
<div style="position:absolute;left:239.97px;top:407.67px" class="cls_006"><span class="cls_006">point) take multiple clocks to produce results. However, the hardware</span></div>
<div style="position:absolute;left:239.97px;top:418.67px" class="cls_006"><span class="cls_006">is ‘‘interlocked’’, so the programmer does not need to be aware of these</span></div>
<div style="position:absolute;left:239.97px;top:429.67px" class="cls_006"><span class="cls_006">delays to write correct programs. But MIPS Corp.’s assembler is</span></div>
<div style="position:absolute;left:239.97px;top:440.67px" class="cls_006"><span class="cls_006">particularly aggressive in these circumstances, and will perform</span></div>
<div style="position:absolute;left:239.97px;top:451.67px" class="cls_006"><span class="cls_006">substantial code movement to try to make it run faster. This may need</span></div>
<div style="position:absolute;left:239.97px;top:462.67px" class="cls_006"><span class="cls_006">to be considered when debugging.</span></div>
<div style="position:absolute;left:228.02px;top:473.67px" class="cls_006"><span class="cls_006">In general, it is best to use a dis-assembler utility to disassemble a</span></div>
<div style="position:absolute;left:216.00px;top:484.67px" class="cls_006"><span class="cls_006">resulting binary during debug. This will show the system designers the</span></div>
<div style="position:absolute;left:216.00px;top:495.67px" class="cls_006"><span class="cls_006">true code sequence being executed, and thus “uncover” the modifications</span></div>
<div style="position:absolute;left:216.00px;top:506.67px" class="cls_006"><span class="cls_006">made by the assembler or compiler.</span></div>
<div style="position:absolute;left:305.77px;top:755.33px" class="cls_002"><span class="cls_002">1-9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:16842px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">MIPS-1 (R30xx)</span></div>
<div style="position:absolute;left:491.33px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 2</span></div>
<div style="position:absolute;left:222.89px;top:56.33px" class="cls_005"><span class="cls_005">ARCHITECTURE</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:216.00px;top:136.00px" class="cls_015"><span class="cls_015">PROGRAMMER’S VIEW OF THE PROCESSOR</span></div>
<div style="position:absolute;left:216.00px;top:148.99px" class="cls_015"><span class="cls_015">ARCHITECTURE</span></div>
<div style="position:absolute;left:228.02px;top:162.67px" class="cls_006"><span class="cls_006">This chapter describes the assembly programmer’s view of the CPU</span></div>
<div style="position:absolute;left:216.00px;top:173.67px" class="cls_006"><span class="cls_006">architecture,  in  terms  of  registers,  instructions,  and  computational</span></div>
<div style="position:absolute;left:216.00px;top:184.67px" class="cls_006"><span class="cls_006">resources.  This  viewpoint  corresponds,  for  example,  to  an  assembly</span></div>
<div style="position:absolute;left:216.00px;top:195.67px" class="cls_006"><span class="cls_006">programmer writing user applications (although more typically, such a</span></div>
<div style="position:absolute;left:216.00px;top:206.67px" class="cls_006"><span class="cls_006">programmer would use a high-level language).</span></div>
<div style="position:absolute;left:228.02px;top:217.67px" class="cls_006"><span class="cls_006">Information  about  kernel  software  development</span></div>
<div style="position:absolute;left:481.32px;top:217.67px" class="cls_006"><span class="cls_006">(such  as  handling</span></div>
<div style="position:absolute;left:216.00px;top:228.67px" class="cls_006"><span class="cls_006">interrupts, traps, and cache and memory management) are described in</span></div>
<div style="position:absolute;left:216.00px;top:239.67px" class="cls_006"><span class="cls_006">later chapters.</span></div>
<div style="position:absolute;left:216.00px;top:262.00px" class="cls_015"><span class="cls_015">Registers</span></div>
<div style="position:absolute;left:228.02px;top:275.67px" class="cls_006"><span class="cls_006">There are 32 general purpose registers: $0 to $31. Two, and only two,</span></div>
<div style="position:absolute;left:216.00px;top:286.67px" class="cls_006"><span class="cls_006">are special to the hardware:</span></div>
<div style="position:absolute;left:228.02px;top:300.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:300.67px" class="cls_006"><span class="cls_006">$0 always returns zero, no matter what software attempts to store to</span></div>
<div style="position:absolute;left:239.97px;top:311.67px" class="cls_006"><span class="cls_006">it.</span></div>
<div style="position:absolute;left:228.02px;top:325.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:325.67px" class="cls_006"><span class="cls_006">$31 is used by the normal subroutine-calling instruction (jal) for the</span></div>
<div style="position:absolute;left:239.97px;top:336.67px" class="cls_006"><span class="cls_006">return address. Note that the call-by-register version (jalr) can use</span></div>
<div style="position:absolute;left:239.97px;top:347.67px" class="cls_006"><span class="cls_006">ANY register for the return address, though practice is to use only</span></div>
<div style="position:absolute;left:239.97px;top:358.67px" class="cls_006"><span class="cls_006">$31.</span></div>
<div style="position:absolute;left:228.02px;top:369.67px" class="cls_006"><span class="cls_006">In all other respects all registers are identical and can be used in any</span></div>
<div style="position:absolute;left:216.00px;top:380.67px" class="cls_006"><span class="cls_006">instruction ($0 can be used as the destination of instructions; the value of</span></div>
<div style="position:absolute;left:216.00px;top:391.67px" class="cls_006"><span class="cls_006">$0 will remain unchanged, however, so the instruction would be effectively</span></div>
<div style="position:absolute;left:216.00px;top:402.67px" class="cls_006"><span class="cls_006">a NOP).</span></div>
<div style="position:absolute;left:228.02px;top:413.67px" class="cls_006"><span class="cls_006">In the MIPS architecture the ‘‘program counter’’ is not a register, and it</span></div>
<div style="position:absolute;left:216.00px;top:424.67px" class="cls_006"><span class="cls_006">is probably better to not think of it that way. The return address of a </span><span class="cls_008">jal</span><span class="cls_006"> is</span></div>
<div style="position:absolute;left:216.00px;top:435.67px" class="cls_006"><span class="cls_006">two instructions later in sequence (the instruction after the jump delay slot</span></div>
<div style="position:absolute;left:216.01px;top:446.67px" class="cls_006"><span class="cls_006">instruction); the instruction after the call is the call’s ‘‘delay slot’’ and is</span></div>
<div style="position:absolute;left:216.01px;top:457.67px" class="cls_006"><span class="cls_006">typically used to set up the last parameter.</span></div>
<div style="position:absolute;left:228.02px;top:468.67px" class="cls_006"><span class="cls_006">There are no condition codes and nothing in the ‘‘status register’’ or</span></div>
<div style="position:absolute;left:216.01px;top:479.67px" class="cls_006"><span class="cls_006">other CPU internals is of any consequence to the user-level programmer.</span></div>
<div style="position:absolute;left:228.02px;top:490.67px" class="cls_006"><span class="cls_006">There are two registers associated with the integer multiplier. These</span></div>
<div style="position:absolute;left:216.01px;top:501.67px" class="cls_006"><span class="cls_006">registers, referred to as “HI” and “LO”, contain the 64-bit product result of</span></div>
<div style="position:absolute;left:216.01px;top:512.67px" class="cls_006"><span class="cls_006">a multiply operation, or the quotient and remainder of a divide.</span></div>
<div style="position:absolute;left:228.02px;top:523.67px" class="cls_006"><span class="cls_006">The floating point math co-processor (called </span><span class="cls_008">FPA</span><span class="cls_006"> for floating point</span></div>
<div style="position:absolute;left:216.00px;top:534.67px" class="cls_006"><span class="cls_006">accelerator), if available, adds</span></div>
<div style="position:absolute;left:377.60px;top:534.67px" class="cls_006"><span class="cls_006">32 floating point registers†; in simple</span></div>
<div style="position:absolute;left:216.00px;top:545.67px" class="cls_006"><span class="cls_006">assembler language they are just called $0 to $31 again - the fact that</span></div>
<div style="position:absolute;left:216.00px;top:556.67px" class="cls_006"><span class="cls_006">these are floating point registers is implicitly defined by the instruction.</span></div>
<div style="position:absolute;left:216.00px;top:567.67px" class="cls_006"><span class="cls_006">Actually, only the 16 even-numbered registers are usable for math; but</span></div>
<div style="position:absolute;left:216.00px;top:578.67px" class="cls_006"><span class="cls_006">they can be used for either single-precision (32 bit) or double-precision</span></div>
<div style="position:absolute;left:216.00px;top:589.67px" class="cls_006"><span class="cls_006">(64-bit)  numbers,  When  performing  double-precision  arithmetic,  odd</span></div>
<div style="position:absolute;left:216.00px;top:600.67px" class="cls_006"><span class="cls_006">numbered register $N+1 holds the remaining bits of the even numbered</span></div>
<div style="position:absolute;left:216.00px;top:611.67px" class="cls_006"><span class="cls_006">register identified $N. Only moves between integer and FPA, or FPA load/</span></div>
<div style="position:absolute;left:216.00px;top:622.67px" class="cls_006"><span class="cls_006">store instructions, ever refer to odd-numbered registers (and even then the</span></div>
<div style="position:absolute;left:216.00px;top:633.67px" class="cls_006"><span class="cls_006">assembler helps the programmer forget...)</span></div>
<div style="position:absolute;left:234.00px;top:686.67px" class="cls_006"><span class="cls_006">† The FPA also has a different set of registers called ‘‘co-processor</span></div>
<div style="position:absolute;left:234.00px;top:698.67px" class="cls_006"><span class="cls_006">1 registers’’ for control purposes. These are typically used to</span></div>
<div style="position:absolute;left:234.00px;top:710.67px" class="cls_006"><span class="cls_006">manage the actions/state of the FPA, and should not be confused</span></div>
<div style="position:absolute;left:234.00px;top:722.67px" class="cls_006"><span class="cls_006">with the FPA data registers.</span></div>
<div style="position:absolute;left:299.28px;top:754.68px" class="cls_002"><span class="cls_002">2-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:17644px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:423.27px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:36.00px;top:50.00px" class="cls_015"><span class="cls_015">Conventional names and uses of general-purpose registers</span></div>
<div style="position:absolute;left:48.02px;top:63.67px" class="cls_006"><span class="cls_006">Although the hardware makes few rules about the use of registers, their</span></div>
<div style="position:absolute;left:36.00px;top:74.67px" class="cls_006"><span class="cls_006">practical use is governed by a number of conventions. These conventions</span></div>
<div style="position:absolute;left:36.00px;top:85.67px" class="cls_006"><span class="cls_006">allow inter-changeability of tools, operating systems, and library modules.</span></div>
<div style="position:absolute;left:36.00px;top:96.67px" class="cls_006"><span class="cls_006">It is strongly recommended that these conventions be followed.</span></div>
<div style="position:absolute;left:41.08px;top:130.00px" class="cls_020"><span class="cls_020">Reg No</span></div>
<div style="position:absolute;left:85.01px;top:130.00px" class="cls_020"><span class="cls_020">Name</span></div>
<div style="position:absolute;left:237.55px;top:130.00px" class="cls_020"><span class="cls_020">Used for</span></div>
<div style="position:absolute;left:39.51px;top:149.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:83.31px;top:149.00px" class="cls_020"><span class="cls_020">zero</span></div>
<div style="position:absolute;left:120.51px;top:149.00px" class="cls_020"><span class="cls_020">Always returns 0</span></div>
<div style="position:absolute;left:39.51px;top:166.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:83.31px;top:166.00px" class="cls_020"><span class="cls_020">at</span></div>
<div style="position:absolute;left:120.48px;top:166.00px" class="cls_020"><span class="cls_020">(assembler temporary) Reserved for use by assembler</span></div>
<div style="position:absolute;left:39.51px;top:183.00px" class="cls_020"><span class="cls_020">2-3</span></div>
<div style="position:absolute;left:83.35px;top:183.00px" class="cls_020"><span class="cls_020">v0-v1</span></div>
<div style="position:absolute;left:120.59px;top:183.00px" class="cls_020"><span class="cls_020">Value (except FP) returned by subroutine</span></div>
<div style="position:absolute;left:39.51px;top:200.00px" class="cls_020"><span class="cls_020">4-7</span></div>
<div style="position:absolute;left:83.35px;top:200.00px" class="cls_020"><span class="cls_020">a0-a3</span></div>
<div style="position:absolute;left:120.59px;top:200.00px" class="cls_020"><span class="cls_020">(arguments) First four parameters for a subroutine</span></div>
<div style="position:absolute;left:39.51px;top:217.00px" class="cls_020"><span class="cls_020">8-15</span></div>
<div style="position:absolute;left:83.37px;top:217.00px" class="cls_020"><span class="cls_020">t0-t7</span></div>
<div style="position:absolute;left:120.60px;top:217.00px" class="cls_020"><span class="cls_020">(temporaries) subroutines may use without saving</span></div>
<div style="position:absolute;left:39.51px;top:234.01px" class="cls_020"><span class="cls_020">24-25</span></div>
<div style="position:absolute;left:83.40px;top:234.01px" class="cls_020"><span class="cls_020">t8-t9</span></div>
<div style="position:absolute;left:39.51px;top:251.01px" class="cls_020"><span class="cls_020">16-23</span></div>
<div style="position:absolute;left:83.40px;top:251.01px" class="cls_020"><span class="cls_020">s0-s7</span></div>
<div style="position:absolute;left:120.63px;top:251.01px" class="cls_020"><span class="cls_020">Subroutine ‘‘register variables’’; a subroutine which will write</span></div>
<div style="position:absolute;left:120.40px;top:261.01px" class="cls_020"><span class="cls_020">one of these must save the old value and restore it before it</span></div>
<div style="position:absolute;left:120.40px;top:271.00px" class="cls_020"><span class="cls_020">exits, so the </span><span class="cls_027">calling</span><span class="cls_020"> routine sees their values preserved.</span></div>
<div style="position:absolute;left:39.50px;top:288.00px" class="cls_020"><span class="cls_020">26-27</span></div>
<div style="position:absolute;left:83.40px;top:288.00px" class="cls_020"><span class="cls_020">k0-k1</span></div>
<div style="position:absolute;left:120.64px;top:288.00px" class="cls_020"><span class="cls_020">Reserved for use by interrupt/trap handler - may change</span></div>
<div style="position:absolute;left:120.39px;top:298.00px" class="cls_020"><span class="cls_020">under your feet</span></div>
<div style="position:absolute;left:39.50px;top:315.00px" class="cls_020"><span class="cls_020">28</span></div>
<div style="position:absolute;left:83.33px;top:315.00px" class="cls_020"><span class="cls_020">gp</span></div>
<div style="position:absolute;left:120.51px;top:315.00px" class="cls_020"><span class="cls_020">global pointer - some runtime systems maintain this to give</span></div>
<div style="position:absolute;left:120.39px;top:325.00px" class="cls_020"><span class="cls_020">easy access to (some) ‘‘static’’ or ‘‘extern’’ variables.</span></div>
<div style="position:absolute;left:39.50px;top:342.00px" class="cls_020"><span class="cls_020">29</span></div>
<div style="position:absolute;left:83.33px;top:342.00px" class="cls_020"><span class="cls_020">sp</span></div>
<div style="position:absolute;left:120.51px;top:342.00px" class="cls_020"><span class="cls_020">stack pointer</span></div>
<div style="position:absolute;left:39.50px;top:359.00px" class="cls_020"><span class="cls_020">30</span></div>
<div style="position:absolute;left:83.33px;top:359.00px" class="cls_020"><span class="cls_020">s8/fp</span></div>
<div style="position:absolute;left:120.57px;top:359.00px" class="cls_020"><span class="cls_020">9th register variable. Subroutines which need one can use</span></div>
<div style="position:absolute;left:120.39px;top:369.00px" class="cls_020"><span class="cls_020">this as a ‘‘frame pointer’’.</span></div>
<div style="position:absolute;left:39.50px;top:386.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:83.33px;top:386.00px" class="cls_020"><span class="cls_020">ra</span></div>
<div style="position:absolute;left:120.50px;top:386.00px" class="cls_020"><span class="cls_020">Return address for subroutine</span></div>
<div style="position:absolute;left:59.66px;top:405.00px" class="cls_020"><span class="cls_020">Table 2.1.  Conventional names of registers with usage mnemonics</span></div>
<div style="position:absolute;left:48.02px;top:420.67px" class="cls_006"><span class="cls_006">With the conventional uses of the registers go a set of conventional</span></div>
<div style="position:absolute;left:36.00px;top:431.67px" class="cls_006"><span class="cls_006">names.  Given  the  need  to  fit  in  with  the  conventions,  use  of  the</span></div>
<div style="position:absolute;left:36.00px;top:442.67px" class="cls_006"><span class="cls_006">conventional names is pretty much mandatory. The common names are</span></div>
<div style="position:absolute;left:36.00px;top:453.67px" class="cls_006"><span class="cls_006">described in Table 2.1,</span></div>
<div style="position:absolute;left:163.24px;top:453.67px" class="cls_006"><span class="cls_006">“Conventional names of registers with usage</span></div>
<div style="position:absolute;left:36.00px;top:464.67px" class="cls_006"><span class="cls_006">mnemonics”.</span></div>
<div style="position:absolute;left:36.00px;top:485.67px" class="cls_006"><span class="cls_006">Notes on conventional register names</span></div>
<div style="position:absolute;left:48.02px;top:499.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> at</span><span class="cls_006">: this register is reserved for use inside the synthetic instructions</span></div>
<div style="position:absolute;left:59.98px;top:510.67px" class="cls_006"><span class="cls_006">generated by the assembler. If the programmer must use it explicitly</span></div>
<div style="position:absolute;left:59.98px;top:521.67px" class="cls_006"><span class="cls_006">the directive </span><span class="cls_008">.noat</span><span class="cls_006"> stops the assembler from using it, but then there</span></div>
<div style="position:absolute;left:59.98px;top:532.67px" class="cls_006"><span class="cls_006">are some things the assembler won’t be able to do.</span></div>
<div style="position:absolute;left:48.03px;top:546.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> v0-v1</span><span class="cls_006">:  used   when  returning   non-floating-point  values  from  a</span></div>
<div style="position:absolute;left:59.98px;top:557.67px" class="cls_006"><span class="cls_006">subroutine. To return anything bigger than 2</span><span class="cls_003">×</span><span class="cls_006">32 bits, memory must</span></div>
<div style="position:absolute;left:59.98px;top:568.67px" class="cls_006"><span class="cls_006">be used (described in a later chapter).</span></div>
<div style="position:absolute;left:48.03px;top:582.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> a0-a3</span><span class="cls_006">: used to pass the first four non-FP parameters to a subroutine.</span></div>
<div style="position:absolute;left:59.97px;top:593.67px" class="cls_006"><span class="cls_006">That’s an occasionally-false oversimplification; the actual convention</span></div>
<div style="position:absolute;left:59.97px;top:604.67px" class="cls_006"><span class="cls_006">is fully described in a later chapter.</span></div>
<div style="position:absolute;left:48.02px;top:618.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> t0-t9</span><span class="cls_006">: by convention, subroutines may use these values without</span></div>
<div style="position:absolute;left:59.97px;top:629.67px" class="cls_006"><span class="cls_006">preserving them. This makes them easy to use as ‘‘temporaries’’ when</span></div>
<div style="position:absolute;left:59.97px;top:640.67px" class="cls_006"><span class="cls_006">evaluating expressions - but a caller must remember that they may</span></div>
<div style="position:absolute;left:59.97px;top:651.67px" class="cls_006"><span class="cls_006">be destroyed by a subroutine call.</span></div>
<div style="position:absolute;left:48.02px;top:665.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> s0-s8</span><span class="cls_006">: by convention, subroutines must guarantee that the values of</span></div>
<div style="position:absolute;left:59.98px;top:676.67px" class="cls_006"><span class="cls_006">these registers on exit are the same as they were on entry - either by</span></div>
<div style="position:absolute;left:59.98px;top:687.67px" class="cls_006"><span class="cls_006">not using them, or by saving them on the stack and restoring before</span></div>
<div style="position:absolute;left:59.98px;top:698.67px" class="cls_006"><span class="cls_006">exit.</span></div>
<div style="position:absolute;left:59.98px;top:712.67px" class="cls_006"><span class="cls_006">This makes them eminently suitable for use as ‘‘register variables’’ or</span></div>
<div style="position:absolute;left:59.98px;top:723.67px" class="cls_006"><span class="cls_006">for storing any value which must be preserved over a subroutine call.</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">2-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:18446px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:525.01px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:50.67px" class="cls_008"><span class="cls_008">k0-k1</span><span class="cls_006">: reserved for use by the trap/interrupt routines, which will not</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">restore their original value; so they are of little use to anyone else.</span></div>
<div style="position:absolute;left:228.02px;top:75.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:75.67px" class="cls_008"><span class="cls_008">gp</span><span class="cls_006">: (global pointer). If present, it will point to a load-time-determined</span></div>
<div style="position:absolute;left:239.98px;top:86.67px" class="cls_006"><span class="cls_006">location in the midst of your static data. This means that loads and</span></div>
<div style="position:absolute;left:239.98px;top:97.67px" class="cls_006"><span class="cls_006">stores to data lying within 32Kbytes either side of the </span><span class="cls_008">gp</span><span class="cls_006"> value can be</span></div>
<div style="position:absolute;left:239.98px;top:108.67px" class="cls_006"><span class="cls_006">performed in a single instruction using </span><span class="cls_008">gp</span><span class="cls_006"> as the base register.</span></div>
<div style="position:absolute;left:239.98px;top:122.67px" class="cls_006"><span class="cls_006">Without the global pointer, loading data from a static memory area</span></div>
<div style="position:absolute;left:239.98px;top:133.67px" class="cls_006"><span class="cls_006">takes two instructions: one to load the most significant bits of the 32-</span></div>
<div style="position:absolute;left:239.98px;top:144.67px" class="cls_006"><span class="cls_006">bit constant address computed by the compiler and loader, and one</span></div>
<div style="position:absolute;left:239.98px;top:155.67px" class="cls_006"><span class="cls_006">to do the data load.</span></div>
<div style="position:absolute;left:239.98px;top:169.67px" class="cls_006"><span class="cls_006">To use </span><span class="cls_008">gp</span><span class="cls_006"> a compiler must know at compile time that a datum will end</span></div>
<div style="position:absolute;left:239.98px;top:180.67px" class="cls_006"><span class="cls_006">up linked within a 64Kbyte range of memory locations. In practice it</span></div>
<div style="position:absolute;left:239.98px;top:191.67px" class="cls_006"><span class="cls_006">can’t know, only guess. The usual practice is to put ‘‘small’’ global</span></div>
<div style="position:absolute;left:239.98px;top:202.67px" class="cls_006"><span class="cls_006">data items in the area pointed to by </span><span class="cls_008">gp</span><span class="cls_006">, and to get the linker to</span></div>
<div style="position:absolute;left:239.98px;top:213.67px" class="cls_006"><span class="cls_006">complain if it still gets too big. The definition of what is “small” can</span></div>
<div style="position:absolute;left:239.98px;top:224.67px" class="cls_006"><span class="cls_006">typically be specified with a compiler switch (most compilers use “-</span></div>
<div style="position:absolute;left:239.98px;top:235.67px" class="cls_006"><span class="cls_006">G“). The most common default size is 8 bytes or less.</span></div>
<div style="position:absolute;left:239.98px;top:249.67px" class="cls_006"><span class="cls_006">Not all compilation systems or OS loaders support </span><span class="cls_008">gp.</span></div>
<div style="position:absolute;left:228.02px;top:263.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:263.67px" class="cls_008"><span class="cls_008">sp</span><span class="cls_006">: (stack pointer). Since it takes explicit instructions to raise and</span></div>
<div style="position:absolute;left:239.98px;top:274.67px" class="cls_006"><span class="cls_006">lower the stack pointer, it is generally done only on subroutine entry</span></div>
<div style="position:absolute;left:239.98px;top:285.67px" class="cls_006"><span class="cls_006">and exit; and it is the responsibility of the subroutine being called to</span></div>
<div style="position:absolute;left:239.98px;top:296.67px" class="cls_006"><span class="cls_006">do this. </span><span class="cls_008">sp</span><span class="cls_006"> is normally adjusted, on entry, to the lowest point that the</span></div>
<div style="position:absolute;left:239.98px;top:307.67px" class="cls_006"><span class="cls_006">stack will need to reach at any point in the subroutine. Now the</span></div>
<div style="position:absolute;left:239.98px;top:318.67px" class="cls_006"><span class="cls_006">compiler can access stack variables by a constant offset from </span><span class="cls_008">sp.</span></div>
<div style="position:absolute;left:239.98px;top:329.67px" class="cls_006"><span class="cls_006">Stack usage conventions are explained in a later chapter.</span></div>
<div style="position:absolute;left:228.03px;top:343.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:343.67px" class="cls_008"><span class="cls_008">fp</span><span class="cls_006">: (also known as s8). A subroutine will use a ‘‘frame pointer’’ to keep</span></div>
<div style="position:absolute;left:239.98px;top:354.67px" class="cls_006"><span class="cls_006">track of the stack if it wants to use operations which involve extending</span></div>
<div style="position:absolute;left:239.98px;top:365.67px" class="cls_006"><span class="cls_006">the stack by an amount which is determined at run-time. Some</span></div>
<div style="position:absolute;left:239.98px;top:376.67px" class="cls_006"><span class="cls_006">languages may do this explicitly; assembler programmers are always</span></div>
<div style="position:absolute;left:239.98px;top:387.67px" class="cls_006"><span class="cls_006">welcome to experiment; and (for many toolchains) C programs which</span></div>
<div style="position:absolute;left:239.98px;top:398.67px" class="cls_006"><span class="cls_006">use the ‘‘alloca’’ library routine will find themselves doing so.</span></div>
<div style="position:absolute;left:239.98px;top:412.67px" class="cls_006"><span class="cls_006">In this case it is not possible to access stack variables from </span><span class="cls_008">sp,</span><span class="cls_006"> so </span><span class="cls_008">fp</span></div>
<div style="position:absolute;left:239.98px;top:423.67px" class="cls_006"><span class="cls_006">is initialized by the function prologue to a constant position relative</span></div>
<div style="position:absolute;left:239.98px;top:434.67px" class="cls_006"><span class="cls_006">to the function’s stack frame. Note that a ‘‘frame pointer’’ subroutine</span></div>
<div style="position:absolute;left:239.98px;top:445.67px" class="cls_006"><span class="cls_006">may call or be called by subroutines which do not use the frame</span></div>
<div style="position:absolute;left:239.98px;top:456.67px" class="cls_006"><span class="cls_006">pointer; so long as the functions it calls preserve the value of </span><span class="cls_008">fp</span><span class="cls_006"> (as</span></div>
<div style="position:absolute;left:239.98px;top:467.67px" class="cls_006"><span class="cls_006">they should) this is OK.</span></div>
<div style="position:absolute;left:228.02px;top:481.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:481.67px" class="cls_008"><span class="cls_008">ra</span><span class="cls_006">: (return address). On entry to any subroutine, ra holds the address</span></div>
<div style="position:absolute;left:239.98px;top:492.67px" class="cls_006"><span class="cls_006">to which control should be returned - so a subroutine typically ends</span></div>
<div style="position:absolute;left:239.98px;top:503.67px" class="cls_006"><span class="cls_006">with the instruction ‘‘jr ra’’.</span></div>
<div style="position:absolute;left:239.98px;top:517.67px" class="cls_006"><span class="cls_006">Subroutines which themselves call subroutines must first save </span><span class="cls_008">ra,</span></div>
<div style="position:absolute;left:239.98px;top:528.67px" class="cls_006"><span class="cls_006">usually on the stack.</span></div>
<div style="position:absolute;left:216.00px;top:551.00px" class="cls_015"><span class="cls_015">Integer multiply unit and registers</span></div>
<div style="position:absolute;left:228.02px;top:564.67px" class="cls_006"><span class="cls_006">MIPS’ architects decided that integer multiplication was important</span></div>
<div style="position:absolute;left:216.00px;top:575.67px" class="cls_006"><span class="cls_006">enough to deserve a hard-wired instruction. This is not so common in</span></div>
<div style="position:absolute;left:216.00px;top:586.67px" class="cls_006"><span class="cls_006">RISCs, which might instead:</span></div>
<div style="position:absolute;left:228.02px;top:600.67px" class="cls_006"><span class="cls_006">• implement  a  ‘‘multiply  step’’  which  fits  in  the  standard  integer</span></div>
<div style="position:absolute;left:239.97px;top:611.67px" class="cls_006"><span class="cls_006">execution   pipeline,   and   require   software   routines   for   every</span></div>
<div style="position:absolute;left:239.97px;top:622.67px" class="cls_006"><span class="cls_006">multiplication (e.g. Sparc or AM29000); or</span></div>
<div style="position:absolute;left:228.02px;top:636.67px" class="cls_006"><span class="cls_006">• perform integer multiplication in the floating point unit - a good</span></div>
<div style="position:absolute;left:239.97px;top:647.67px" class="cls_006"><span class="cls_006">solution but which compromises the optional nature of the MIPS</span></div>
<div style="position:absolute;left:239.97px;top:658.67px" class="cls_006"><span class="cls_006">floating point ‘‘co-processor’’.</span></div>
<div style="position:absolute;left:228.02px;top:669.67px" class="cls_006"><span class="cls_006">The  multiply  unit  consumes  a  small  amount  of  die  area,  but</span></div>
<div style="position:absolute;left:216.00px;top:680.67px" class="cls_006"><span class="cls_006">dramatically   improves   performance</span></div>
<div style="position:absolute;left:412.05px;top:680.67px" class="cls_006"><span class="cls_006">(and   cache   performance)   over</span></div>
<div style="position:absolute;left:216.00px;top:691.67px" class="cls_006"><span class="cls_006">“multiply step” operations. It’s basic operation is to multiply two 32-bit</span></div>
<div style="position:absolute;left:216.00px;top:702.67px" class="cls_006"><span class="cls_006">values together to produce a 64-bit result, which is stored in two 32-bit</span></div>
<div style="position:absolute;left:305.77px;top:755.33px" class="cls_002"><span class="cls_002">2-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:19248px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:423.27px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:36.00px;top:50.67px" class="cls_006"><span class="cls_006">registers (called ‘‘hi’’ and</span></div>
<div style="position:absolute;left:168.88px;top:50.67px" class="cls_006"><span class="cls_006">‘‘lo’’) which are private to the multiply unit.</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_006"><span class="cls_006">Instructions </span><span class="cls_008">mfhi</span><span class="cls_006">, </span><span class="cls_008">mflo</span><span class="cls_006"> are defined to copy the result out into general</span></div>
<div style="position:absolute;left:36.00px;top:72.67px" class="cls_006"><span class="cls_006">registers.</span></div>
<div style="position:absolute;left:48.02px;top:83.67px" class="cls_006"><span class="cls_006">Unlike results for integer operations, the multiply result registers are</span></div>
<div style="position:absolute;left:36.00px;top:94.67px" class="cls_008"><span class="cls_008">interlocked</span><span class="cls_006">. An attempt to read out the results before the multiplication is</span></div>
<div style="position:absolute;left:36.00px;top:105.67px" class="cls_006"><span class="cls_006">complete results in the CPU being stopped until the operation completes.</span></div>
<div style="position:absolute;left:48.02px;top:116.67px" class="cls_006"><span class="cls_006">The integer multiply unit will also perform an integer division between</span></div>
<div style="position:absolute;left:36.00px;top:127.67px" class="cls_006"><span class="cls_006">values in two general-purpose registers; in this case the ‘‘lo’’ register stores</span></div>
<div style="position:absolute;left:36.00px;top:138.67px" class="cls_006"><span class="cls_006">the quotient, and the ‘‘hi’’ register the remainder.</span></div>
<div style="position:absolute;left:48.02px;top:149.67px" class="cls_006"><span class="cls_006">In the R30xx family, multiply operations take 12 clocks and division</span></div>
<div style="position:absolute;left:36.00px;top:160.67px" class="cls_006"><span class="cls_006">takes 35. The assembler has a synthetic multiply operation which starts</span></div>
<div style="position:absolute;left:36.00px;top:171.67px" class="cls_006"><span class="cls_006">the multiply and then retrieves the result into an ordinary register. Note</span></div>
<div style="position:absolute;left:36.00px;top:182.67px" class="cls_006"><span class="cls_006">that MIPS Corp.’s assembler may even substitute a series of shifts and</span></div>
<div style="position:absolute;left:36.00px;top:193.67px" class="cls_006"><span class="cls_006">adds for multiplication by a constant, to improve execution speed.</span></div>
<div style="position:absolute;left:48.02px;top:204.67px" class="cls_006"><span class="cls_006">Multiply/divide results are written into ‘‘hi’’ and ‘‘lo’’ as soon as they are</span></div>
<div style="position:absolute;left:36.00px;top:215.67px" class="cls_006"><span class="cls_006">available; the effect is not deferred until the writeback pipeline stage, as</span></div>
<div style="position:absolute;left:36.00px;top:226.67px" class="cls_006"><span class="cls_006">with writes to general purpose (GP) registers. If a </span><span class="cls_008">mfhi</span><span class="cls_006"> or </span><span class="cls_008">mflo</span><span class="cls_006"> instruction</span></div>
<div style="position:absolute;left:36.00px;top:237.67px" class="cls_006"><span class="cls_006">is interrupted by some kind of exception before it reaches the writeback</span></div>
<div style="position:absolute;left:36.00px;top:248.67px" class="cls_006"><span class="cls_006">stage of the pipeline, it will be aborted with the intention of restarting it.</span></div>
<div style="position:absolute;left:36.00px;top:259.67px" class="cls_006"><span class="cls_006">However, a subsequent multiply instruction which has passed the ALU</span></div>
<div style="position:absolute;left:36.00px;top:270.67px" class="cls_006"><span class="cls_006">stage will continue (in parallel with exception processing) and would</span></div>
<div style="position:absolute;left:36.00px;top:281.67px" class="cls_006"><span class="cls_006">overwrite the ‘‘hi’’ and ‘‘lo’’ register values, so that the re-execution of the</span></div>
<div style="position:absolute;left:36.00px;top:292.67px" class="cls_008"><span class="cls_008">mfhi</span><span class="cls_006"> would get wrong (i.e. new) data. For this reason it is recommended</span></div>
<div style="position:absolute;left:36.00px;top:303.67px" class="cls_006"><span class="cls_006">that a multiply should not be started within two instructions of an </span><span class="cls_008">mfhi/</span></div>
<div style="position:absolute;left:36.00px;top:314.67px" class="cls_008"><span class="cls_008">mflo</span><span class="cls_006">. The assembler will avoid doing this where it can.</span></div>
<div style="position:absolute;left:48.02px;top:325.67px" class="cls_006"><span class="cls_006">Integer multiply and divide operations never produce an exception,</span></div>
<div style="position:absolute;left:36.00px;top:336.67px" class="cls_006"><span class="cls_006">though divide by zero produces an undefined result. Compilers will often</span></div>
<div style="position:absolute;left:36.00px;top:347.67px" class="cls_006"><span class="cls_006">generate code to trap on errors, particularly on divide by zero. Frequently,</span></div>
<div style="position:absolute;left:36.00px;top:358.67px" class="cls_006"><span class="cls_006">this instruction sequence is placed after the divide is initiated, to allow it</span></div>
<div style="position:absolute;left:36.00px;top:369.67px" class="cls_006"><span class="cls_006">to execute concurrently with the divide (and avoid a performance loss).</span></div>
<div style="position:absolute;left:48.02px;top:380.67px" class="cls_006"><span class="cls_006">Instructions </span><span class="cls_008">mthi</span><span class="cls_006">, </span><span class="cls_008">mtlo</span><span class="cls_006"> are defined to setup the internal registers from</span></div>
<div style="position:absolute;left:36.00px;top:391.67px" class="cls_006"><span class="cls_006">general-purpose registers. They are essential to restore the values of ‘‘hi’’</span></div>
<div style="position:absolute;left:36.00px;top:402.67px" class="cls_006"><span class="cls_006">and ‘‘lo’’ when returning from an exception, but probably not for anything</span></div>
<div style="position:absolute;left:36.00px;top:413.67px" class="cls_006"><span class="cls_006">else.</span></div>
<div style="position:absolute;left:36.00px;top:436.00px" class="cls_015"><span class="cls_015">Instruction types</span></div>
<div style="position:absolute;left:48.02px;top:449.67px" class="cls_006"><span class="cls_006">A full list of R30xx family integer instructions is presented in Appendix</span></div>
<div style="position:absolute;left:36.00px;top:460.67px" class="cls_006"><span class="cls_006">A. Floating point instructions are listed in Appendix B of this manual.</span></div>
<div style="position:absolute;left:36.00px;top:471.67px" class="cls_006"><span class="cls_006">Currently, floating point instructions are only available in the R3081, and</span></div>
<div style="position:absolute;left:36.00px;top:482.67px" class="cls_006"><span class="cls_006">are described in the R3081 User’s Manual.</span></div>
<div style="position:absolute;left:48.02px;top:493.67px" class="cls_006"><span class="cls_006">The MIPS-1 ISA uses only three basic instruction encoding formats; this</span></div>
<div style="position:absolute;left:36.00px;top:504.67px" class="cls_006"><span class="cls_006">is one of the keys to the high-frequencies attained by RISC architectures.</span></div>
<div style="position:absolute;left:48.02px;top:515.67px" class="cls_006"><span class="cls_006">Instructions are mostly in numerical order; to simplify reading, the list</span></div>
<div style="position:absolute;left:36.00px;top:526.67px" class="cls_006"><span class="cls_006">is occasionally re-ordered for clarity.</span></div>
<div style="position:absolute;left:48.02px;top:548.67px" class="cls_006"><span class="cls_006">Throughout this manual, the description of various instructions will</span></div>
<div style="position:absolute;left:36.00px;top:559.67px" class="cls_006"><span class="cls_006">also refer to various subfields of the instruction. In general, the following</span></div>
<div style="position:absolute;left:36.00px;top:570.67px" class="cls_006"><span class="cls_006">typical nomenclature is used:</span></div>
<div style="position:absolute;left:48.02px;top:584.67px" class="cls_006"><span class="cls_006">op</span></div>
<div style="position:absolute;left:84.02px;top:584.67px" class="cls_006"><span class="cls_006">The basic op-code, which is 6 bits long. Instructions which large</span></div>
<div style="position:absolute;left:84.02px;top:595.67px" class="cls_006"><span class="cls_006">sub-fields (for example, large immediate values, such as required</span></div>
<div style="position:absolute;left:84.02px;top:606.67px" class="cls_006"><span class="cls_006">for the</span></div>
<div style="position:absolute;left:124.88px;top:606.67px" class="cls_006"><span class="cls_006">‘‘long’’ </span><span class="cls_008">j/jal</span><span class="cls_006"> instructions, or arithmetic with a</span></div>
<div style="position:absolute;left:366.66px;top:606.67px" class="cls_006"><span class="cls_006">16-bit</span></div>
<div style="position:absolute;left:84.02px;top:617.67px" class="cls_006"><span class="cls_006">constant)  have  a  unique</span></div>
<div style="position:absolute;left:220.74px;top:617.67px" class="cls_006"><span class="cls_006">‘‘op’’  field.  Other  instructions  are</span></div>
<div style="position:absolute;left:84.02px;top:628.67px" class="cls_006"><span class="cls_006">classified in groups sharing an ‘‘op’’ value, distinguished by</span></div>
<div style="position:absolute;left:84.02px;top:639.67px" class="cls_006"><span class="cls_006">other fields (‘‘op2’’ etc.).</span></div>
<div style="position:absolute;left:48.02px;top:653.67px" class="cls_006"><span class="cls_006">rs, rs1,</span></div>
<div style="position:absolute;left:48.02px;top:667.67px" class="cls_006"><span class="cls_006">rs2</span></div>
<div style="position:absolute;left:84.02px;top:667.67px" class="cls_006"><span class="cls_006">One or two fields identifying source registers.</span></div>
<div style="position:absolute;left:48.02px;top:681.67px" class="cls_006"><span class="cls_006">rd</span></div>
<div style="position:absolute;left:84.02px;top:681.67px" class="cls_006"><span class="cls_006">The register to be changed by this instruction.</span></div>
<div style="position:absolute;left:48.02px;top:695.67px" class="cls_006"><span class="cls_006">sa</span></div>
<div style="position:absolute;left:84.02px;top:695.67px" class="cls_006"><span class="cls_006">Shift-amount:  How  far  to  shift,  used  in  shift-by-constant</span></div>
<div style="position:absolute;left:84.02px;top:706.67px" class="cls_006"><span class="cls_006">instructions.</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">2-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:20050px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:525.01px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">op2</span></div>
<div style="position:absolute;left:264.02px;top:50.67px" class="cls_006"><span class="cls_006">Sub-code field used for the 3-register arithmetic/logical group of</span></div>
<div style="position:absolute;left:264.02px;top:61.67px" class="cls_006"><span class="cls_006">instructions (</span><span class="cls_008">op</span><span class="cls_006"> value of zero).</span></div>
<div style="position:absolute;left:228.02px;top:75.67px" class="cls_006"><span class="cls_006">offset</span></div>
<div style="position:absolute;left:264.03px;top:75.67px" class="cls_006"><span class="cls_006">16-bit signed </span><span class="cls_008">word</span><span class="cls_006"> offset defining the destination of a ‘‘PC-</span></div>
<div style="position:absolute;left:264.02px;top:86.67px" class="cls_006"><span class="cls_006">relative’’  branch.  The  branch  target  will  be  the  instruction</span></div>
<div style="position:absolute;left:264.02px;top:97.67px" class="cls_006"><span class="cls_006">‘‘offset’’ words away from the ‘‘delay slot’’ instruction </span><span class="cls_008">after</span><span class="cls_006"> the</span></div>
<div style="position:absolute;left:264.02px;top:108.67px" class="cls_006"><span class="cls_006">branch; so a branch-to-self has an offset of -1.</span></div>
<div style="position:absolute;left:228.02px;top:122.67px" class="cls_006"><span class="cls_006">target</span></div>
<div style="position:absolute;left:264.03px;top:122.67px" class="cls_006"><span class="cls_006">26-bit </span><span class="cls_008">word</span><span class="cls_006"> address to be jumped to (it corresponds to a 28-bit</span></div>
<div style="position:absolute;left:264.02px;top:133.67px" class="cls_006"><span class="cls_006">byte  address,  which  is  always  word-aligned).  The  long </span><span class="cls_008"> j</span></div>
<div style="position:absolute;left:264.02px;top:144.67px" class="cls_006"><span class="cls_006">instruction  is  rarely  used,  so  this  format  is  pretty  much</span></div>
<div style="position:absolute;left:264.02px;top:155.67px" class="cls_006"><span class="cls_006">exclusively for function calls (</span><span class="cls_008">jal</span><span class="cls_006">).</span></div>
<div style="position:absolute;left:264.02px;top:169.67px" class="cls_006"><span class="cls_006">The high-order 4 bits of the target address can’t be specified by</span></div>
<div style="position:absolute;left:264.02px;top:180.67px" class="cls_006"><span class="cls_006">this instruction, and are taken from the address of the jump</span></div>
<div style="position:absolute;left:264.02px;top:191.67px" class="cls_006"><span class="cls_006">instruction.  This  means  that  these  instructions  can  reach</span></div>
<div style="position:absolute;left:264.02px;top:202.67px" class="cls_006"><span class="cls_006">anywhere  in  the  256Mbyte  region  around  the  instructions’</span></div>
<div style="position:absolute;left:264.02px;top:213.67px" class="cls_006"><span class="cls_006">location. To jump further use a </span><span class="cls_008">jr</span><span class="cls_006"> (jump register) instruction.</span></div>
<div style="position:absolute;left:228.02px;top:227.67px" class="cls_006"><span class="cls_006">constant</span></div>
<div style="position:absolute;left:264.02px;top:241.67px" class="cls_006"><span class="cls_006">16-bit  integer  constant  for</span></div>
<div style="position:absolute;left:411.98px;top:241.67px" class="cls_006"><span class="cls_006">‘‘immediate’’  arithmetic  or  logic</span></div>
<div style="position:absolute;left:264.02px;top:252.67px" class="cls_006"><span class="cls_006">operations.</span></div>
<div style="position:absolute;left:228.02px;top:266.67px" class="cls_006"><span class="cls_006">mf</span></div>
<div style="position:absolute;left:264.02px;top:266.67px" class="cls_006"><span class="cls_006">Yet  another  extended  opcode  field,  this  time  used  by</span></div>
<div style="position:absolute;left:556.86px;top:266.67px" class="cls_006"><span class="cls_006">‘‘co-</span></div>
<div style="position:absolute;left:264.02px;top:277.67px" class="cls_006"><span class="cls_006">processor’’ type instructions.</span></div>
<div style="position:absolute;left:228.02px;top:291.67px" class="cls_006"><span class="cls_006">rg</span></div>
<div style="position:absolute;left:264.02px;top:291.67px" class="cls_006"><span class="cls_006">Field which may hold a source or destination register.</span></div>
<div style="position:absolute;left:228.02px;top:305.67px" class="cls_006"><span class="cls_006">crg</span></div>
<div style="position:absolute;left:264.02px;top:305.67px" class="cls_006"><span class="cls_006">Field to hold the number of a CPU control register (different from</span></div>
<div style="position:absolute;left:264.02px;top:316.67px" class="cls_006"><span class="cls_006">the integer register file). Called ‘‘crs’’/‘‘crd’’ in contexts where it</span></div>
<div style="position:absolute;left:264.02px;top:327.67px" class="cls_006"><span class="cls_006">must be a source/destination respectively.</span></div>
<div style="position:absolute;left:228.02px;top:338.67px" class="cls_006"><span class="cls_006">The instruction encodings have been chosen to facilitate the design of a</span></div>
<div style="position:absolute;left:216.00px;top:349.67px" class="cls_006"><span class="cls_006">high-frequency CPU. Specifically:.</span></div>
<div style="position:absolute;left:228.02px;top:363.67px" class="cls_006"><span class="cls_006">• The instruction encodings do reveal portions of the internal CPU</span></div>
<div style="position:absolute;left:239.97px;top:374.67px" class="cls_006"><span class="cls_006">design. Although there are variable encodings, those fields which are</span></div>
<div style="position:absolute;left:239.97px;top:385.67px" class="cls_006"><span class="cls_006">required very early in the pipeline are encoded in a very regular way:</span></div>
<div style="position:absolute;left:228.02px;top:399.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Source registers are always in the same place</span><span class="cls_006">: so that the CPU can</span></div>
<div style="position:absolute;left:239.98px;top:410.67px" class="cls_006"><span class="cls_006">fetch two instructions from the integer register file without any</span></div>
<div style="position:absolute;left:239.98px;top:421.67px" class="cls_006"><span class="cls_006">conditional decoding. Some instructions may not need both registers</span></div>
<div style="position:absolute;left:239.98px;top:432.67px" class="cls_006"><span class="cls_006">- but since the register file is designed to provide two source values</span></div>
<div style="position:absolute;left:239.98px;top:443.67px" class="cls_006"><span class="cls_006">on every clock nothing has been lost.</span></div>
<div style="position:absolute;left:228.03px;top:457.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:457.67px" class="cls_008"><span class="cls_008">16-bit  constant  is  always  in  the  same  place</span><span class="cls_006">:   permitting   the</span></div>
<div style="position:absolute;left:239.98px;top:468.67px" class="cls_006"><span class="cls_006">appropriate instruction bits to be fed directly into the ALU’s input</span></div>
<div style="position:absolute;left:239.98px;top:479.67px" class="cls_006"><span class="cls_006">multiplexer, without conditional shifts.</span></div>
<div style="position:absolute;left:216.00px;top:502.00px" class="cls_015"><span class="cls_015">Loading and storing: addressing modes</span></div>
<div style="position:absolute;left:228.02px;top:515.67px" class="cls_006"><span class="cls_006">As mentioned above, there is only one basic ‘‘addressing mode’’. Any</span></div>
<div style="position:absolute;left:216.00px;top:526.67px" class="cls_006"><span class="cls_006">load or store machine instruction can be written as:</span></div>
<div style="position:absolute;left:288.00px;top:548.00px" class="cls_028"><span class="cls_028">operation dest-reg, offset(src-reg)</span></div>
<div style="position:absolute;left:288.00px;top:568.00px" class="cls_028"><span class="cls_028">e.g.:lw $1, offset($2); sw $3, offset($4)</span></div>
<div style="position:absolute;left:228.02px;top:587.67px" class="cls_006"><span class="cls_006">Any of the GP registers can be used for the destination and source. The</span></div>
<div style="position:absolute;left:216.00px;top:598.67px" class="cls_006"><span class="cls_006">offset is a signed, 16-bit number (so can be anywhere between -32768 and</span></div>
<div style="position:absolute;left:216.00px;top:609.67px" class="cls_006"><span class="cls_006">32767); the program address used for the load is the sum of </span><span class="cls_008">dest-reg</span><span class="cls_006"> and</span></div>
<div style="position:absolute;left:216.00px;top:620.67px" class="cls_006"><span class="cls_006">the </span><span class="cls_008">offset</span><span class="cls_006">. This address mode is normally enough to pick out a particular</span></div>
<div style="position:absolute;left:216.00px;top:631.67px" class="cls_006"><span class="cls_006">member of a C structure (‘‘offset’’ being the distance between the start of</span></div>
<div style="position:absolute;left:216.00px;top:642.67px" class="cls_006"><span class="cls_006">the structure and the member required); it implements an array indexed</span></div>
<div style="position:absolute;left:216.00px;top:653.67px" class="cls_006"><span class="cls_006">by a constant; it is enough to reference function variables from the stack</span></div>
<div style="position:absolute;left:216.00px;top:664.67px" class="cls_006"><span class="cls_006">or frame pointer; to provide a reasonable sized global area around the </span><span class="cls_008">gp</span></div>
<div style="position:absolute;left:216.00px;top:675.67px" class="cls_006"><span class="cls_006">value for static and extern variables.</span></div>
<div style="position:absolute;left:228.02px;top:686.67px" class="cls_006"><span class="cls_006">The assembler provides the semblance of a simple direct addressing</span></div>
<div style="position:absolute;left:216.00px;top:697.67px" class="cls_006"><span class="cls_006">mode, to load the values of memory variables whose address can be</span></div>
<div style="position:absolute;left:216.00px;top:708.67px" class="cls_006"><span class="cls_006">computed at link time.</span></div>
<div style="position:absolute;left:305.77px;top:755.33px" class="cls_002"><span class="cls_002">2-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:20852px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:423.27px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">More complex modes such as double-register or scaled index must be</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_006"><span class="cls_006">implemented with sequences of instructions.</span></div>
<div style="position:absolute;left:36.00px;top:84.00px" class="cls_015"><span class="cls_015">Data types in Memory and registers</span></div>
<div style="position:absolute;left:48.02px;top:97.67px" class="cls_006"><span class="cls_006">The R30xx family CPUs can load or store between 1 and 4 bytes in a</span></div>
<div style="position:absolute;left:36.00px;top:108.67px" class="cls_006"><span class="cls_006">single operation. Naming conventions are used in the documentation and</span></div>
<div style="position:absolute;left:36.00px;top:119.67px" class="cls_006"><span class="cls_006">to build instruction mnemonics:</span></div>
<div style="position:absolute;left:84.70px;top:153.00px" class="cls_020"><span class="cls_020">‘‘C’’ name</span></div>
<div style="position:absolute;left:154.03px;top:153.00px" class="cls_020"><span class="cls_020">MIPS name     Size(bytes)</span></div>
<div style="position:absolute;left:300.81px;top:153.00px" class="cls_020"><span class="cls_020">Assembler</span></div>
<div style="position:absolute;left:299.35px;top:163.00px" class="cls_020"><span class="cls_020">mnemonic</span></div>
<div style="position:absolute;left:76.00px;top:182.00px" class="cls_020"><span class="cls_020">int</span></div>
<div style="position:absolute;left:148.06px;top:182.00px" class="cls_020"><span class="cls_020">word</span></div>
<div style="position:absolute;left:220.15px;top:182.00px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:292.19px;top:182.00px" class="cls_020"><span class="cls_020">‘‘w’’ as in </span><span class="cls_027">lw</span></div>
<div style="position:absolute;left:76.00px;top:199.00px" class="cls_020"><span class="cls_020">long</span></div>
<div style="position:absolute;left:148.09px;top:199.00px" class="cls_020"><span class="cls_020">word</span></div>
<div style="position:absolute;left:220.18px;top:199.00px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:292.22px;top:199.00px" class="cls_020"><span class="cls_020">‘‘w’’ as in </span><span class="cls_027">lw</span></div>
<div style="position:absolute;left:76.00px;top:216.00px" class="cls_020"><span class="cls_020">short</span></div>
<div style="position:absolute;left:148.11px;top:216.00px" class="cls_020"><span class="cls_020">halfword</span></div>
<div style="position:absolute;left:220.28px;top:216.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:292.32px;top:216.00px" class="cls_020"><span class="cls_020">‘‘h’’ as in </span><span class="cls_027">lh</span></div>
<div style="position:absolute;left:76.00px;top:233.00px" class="cls_020"><span class="cls_020">char</span></div>
<div style="position:absolute;left:148.10px;top:233.00px" class="cls_020"><span class="cls_020">byte</span></div>
<div style="position:absolute;left:220.19px;top:233.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:292.22px;top:233.00px" class="cls_020"><span class="cls_020">‘‘b’’ as in </span><span class="cls_027">lb</span></div>
<div style="position:absolute;left:36.00px;top:256.67px" class="cls_006"><span class="cls_006">Integer data types</span></div>
<div style="position:absolute;left:48.02px;top:267.67px" class="cls_006"><span class="cls_006">Byte and halfword loads come in two flavors:</span></div>
<div style="position:absolute;left:48.02px;top:281.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Sign-extend</span><span class="cls_006">: </span><span class="cls_008">lb</span><span class="cls_006"> and </span><span class="cls_008">lh</span><span class="cls_006"> load the value into the least significant bits of</span></div>
<div style="position:absolute;left:59.98px;top:292.67px" class="cls_006"><span class="cls_006">the 32-bit register, but fill the high order bits by copying the ‘‘sign bit’’</span></div>
<div style="position:absolute;left:59.98px;top:303.67px" class="cls_006"><span class="cls_006">(bit 7 of a byte, bit 16 of a half-word). This correctly converts a signed</span></div>
<div style="position:absolute;left:59.98px;top:314.67px" class="cls_006"><span class="cls_006">value to a 32-bit signed integer.</span></div>
<div style="position:absolute;left:48.03px;top:328.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Zero-extend</span><span class="cls_006">: instructions </span><span class="cls_008">lbu</span><span class="cls_006"> and </span><span class="cls_008">lhu</span><span class="cls_006"> load the value into the least</span></div>
<div style="position:absolute;left:59.98px;top:339.67px" class="cls_006"><span class="cls_006">significant bits of a 32-bit register, with the high order bits filled with</span></div>
<div style="position:absolute;left:59.98px;top:350.67px" class="cls_006"><span class="cls_006">zero. This correctly converts an unsigned value in memory to the</span></div>
<div style="position:absolute;left:59.98px;top:361.67px" class="cls_006"><span class="cls_006">corresponding 32-bit unsigned integer value; so byte value</span></div>
<div style="position:absolute;left:377.46px;top:361.67px" class="cls_006"><span class="cls_006">254</span></div>
<div style="position:absolute;left:59.98px;top:372.67px" class="cls_006"><span class="cls_006">becomes 32-bit value 254.</span></div>
<div style="position:absolute;left:48.03px;top:383.67px" class="cls_006"><span class="cls_006">If the byte-wide memory location whose address is in </span><span class="cls_008">t1</span><span class="cls_006"> contains the</span></div>
<div style="position:absolute;left:36.00px;top:394.67px" class="cls_006"><span class="cls_006">value </span><span class="cls_029">0xFE</span><span class="cls_006"> (-2, or 254 if interpreted as unsigned), then:</span></div>
<div style="position:absolute;left:108.00px;top:416.00px" class="cls_028"><span class="cls_028">lb</span></div>
<div style="position:absolute;left:144.04px;top:416.00px" class="cls_028"><span class="cls_028">t2, 0(t1)</span></div>
<div style="position:absolute;left:108.00px;top:426.00px" class="cls_028"><span class="cls_028">lbu</span></div>
<div style="position:absolute;left:144.06px;top:426.00px" class="cls_028"><span class="cls_028">t3, 0(t1)</span></div>
<div style="position:absolute;left:48.02px;top:445.67px" class="cls_006"><span class="cls_006">will leave </span><span class="cls_008">t2</span><span class="cls_006"> holding the value </span><span class="cls_029">0xFFFF FFFE</span><span class="cls_006"> (-2 as signed 32-bit) and</span><span class="cls_008">t3</span></div>
<div style="position:absolute;left:36.00px;top:456.67px" class="cls_006"><span class="cls_006">holding the value </span><span class="cls_029">0x0000 00FE</span><span class="cls_006"> (254 as signed or unsigned 32-bit).</span></div>
<div style="position:absolute;left:48.02px;top:467.67px" class="cls_006"><span class="cls_006">Subtle differences in the way shorter integers are extended to longer</span></div>
<div style="position:absolute;left:36.00px;top:478.67px" class="cls_006"><span class="cls_006">ones are a historical cause of C portability problems, and the modern C</span></div>
<div style="position:absolute;left:36.00px;top:489.67px" class="cls_006"><span class="cls_006">standards have elaborate rules. On machines like the MIPS, which does</span></div>
<div style="position:absolute;left:36.00px;top:500.67px" class="cls_006"><span class="cls_006">not  perform</span></div>
<div style="position:absolute;left:106.58px;top:500.67px" class="cls_006"><span class="cls_006">8-  or</span></div>
<div style="position:absolute;left:142.96px;top:500.67px" class="cls_006"><span class="cls_006">16-bit  precision  arithmetic  directly,  expressions</span></div>
<div style="position:absolute;left:36.00px;top:511.67px" class="cls_006"><span class="cls_006">involving </span><span class="cls_008">short</span><span class="cls_006"> or </span><span class="cls_008">char</span><span class="cls_006"> variables are less efficient than word operations.</span></div>
<div style="position:absolute;left:36.00px;top:532.67px" class="cls_006"><span class="cls_006">Unaligned loads and stores</span></div>
<div style="position:absolute;left:48.02px;top:543.67px" class="cls_006"><span class="cls_006">Normal loads and stores in the MIPS architecture must be aligned; half-</span></div>
<div style="position:absolute;left:36.00px;top:554.67px" class="cls_006"><span class="cls_006">words may be loaded only from 2-byte boundaries, and words only from 4-</span></div>
<div style="position:absolute;left:36.00px;top:565.67px" class="cls_006"><span class="cls_006">byte  boundaries.  A  load  instruction  with  an  unaligned  address  will</span></div>
<div style="position:absolute;left:36.00px;top:576.67px" class="cls_006"><span class="cls_006">produce a trap. Because CISC architectures such as the MC680x0 and</span></div>
<div style="position:absolute;left:36.00px;top:587.67px" class="cls_006"><span class="cls_006">iAPXx86 do handle unaligned loads and stores, this could complicate</span></div>
<div style="position:absolute;left:36.00px;top:598.67px" class="cls_006"><span class="cls_006">porting software from one of these architectures. The MIPS architecture</span></div>
<div style="position:absolute;left:36.00px;top:609.67px" class="cls_006"><span class="cls_006">does provide mechanisms to support this type of operation; in extremity,</span></div>
<div style="position:absolute;left:36.00px;top:620.67px" class="cls_006"><span class="cls_006">software can provide a trap handler which will emulate the desired load</span></div>
<div style="position:absolute;left:36.00px;top:631.67px" class="cls_006"><span class="cls_006">operation and hide this feature from the application.</span></div>
<div style="position:absolute;left:48.02px;top:642.67px" class="cls_006"><span class="cls_006">All data items declared by C code will be correctly aligned.</span></div>
<div style="position:absolute;left:48.02px;top:653.67px" class="cls_006"><span class="cls_006">But when it is known in advance that the program will transfer a word</span></div>
<div style="position:absolute;left:36.00px;top:664.67px" class="cls_006"><span class="cls_006">from an address whose alignment is unknown and will be computed at run</span></div>
<div style="position:absolute;left:36.00px;top:675.67px" class="cls_006"><span class="cls_006">time, the architecture does allow for a special 2-instruction sequence</span></div>
<div style="position:absolute;left:36.00px;top:686.67px" class="cls_006"><span class="cls_006">(much more efficient than a series of byte loads, shifts and assembly). This</span></div>
<div style="position:absolute;left:36.00px;top:697.67px" class="cls_006"><span class="cls_006">sequence is normally generated by the macro-instruction </span><span class="cls_008">ulw</span><span class="cls_006"> (unaligned</span></div>
<div style="position:absolute;left:36.00px;top:708.67px" class="cls_006"><span class="cls_006">load word).</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">2-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:21654px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:525.01px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">(A macro-instruction </span><span class="cls_008">ulh</span><span class="cls_006">, unaligned load half, is also provided, and is</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">synthesized by two loads, a shift, and a bitwise ‘‘or’’ operation.)</span></div>
<div style="position:absolute;left:228.02px;top:72.67px" class="cls_006"><span class="cls_006">The special machine instructions are </span><span class="cls_008">lwl</span><span class="cls_006"> and </span><span class="cls_008">lwr</span><span class="cls_006"> (load word left, load</span></div>
<div style="position:absolute;left:215.99px;top:83.67px" class="cls_006"><span class="cls_006">word right). ‘‘Left’’ and ‘‘right’’ are arithmetical directions, as in ‘‘shift left’’;</span></div>
<div style="position:absolute;left:215.99px;top:94.67px" class="cls_006"><span class="cls_006">‘‘left’’ is movement towards more significant bits, ‘‘right’’ is towards less</span></div>
<div style="position:absolute;left:215.99px;top:105.67px" class="cls_006"><span class="cls_006">significant bits.</span></div>
<div style="position:absolute;left:228.01px;top:116.67px" class="cls_006"><span class="cls_006">These instructions do three things:</span></div>
<div style="position:absolute;left:228.01px;top:130.67px" class="cls_006"><span class="cls_006">• load 1, 2, 3 or 4 bytes from within one aligned 4-byte (word) location;</span></div>
<div style="position:absolute;left:228.01px;top:144.67px" class="cls_006"><span class="cls_006">• shift that data to move the byte selected by the address to either the</span></div>
<div style="position:absolute;left:239.96px;top:155.67px" class="cls_006"><span class="cls_006">most-significant (</span><span class="cls_008">lwl</span><span class="cls_006">) or least-significant (</span><span class="cls_008">lwr</span><span class="cls_006">) end of a 32-bit field;</span></div>
<div style="position:absolute;left:228.01px;top:169.67px" class="cls_006"><span class="cls_006">• merge the bytes fetched from memory with the data already in the</span></div>
<div style="position:absolute;left:239.96px;top:180.67px" class="cls_006"><span class="cls_006">destination.</span></div>
<div style="position:absolute;left:228.01px;top:191.67px" class="cls_006"><span class="cls_006">This breaks most of the rules the architecture usually sticks by; it does</span></div>
<div style="position:absolute;left:215.99px;top:202.67px" class="cls_006"><span class="cls_006">a logical operation on a memory variable, for example. Special hardware</span></div>
<div style="position:absolute;left:215.99px;top:213.67px" class="cls_006"><span class="cls_006">allows the </span><span class="cls_008">lwl</span><span class="cls_006">, </span><span class="cls_008">lwr</span><span class="cls_006"> pair to be used in consecutive instructions, even though</span></div>
<div style="position:absolute;left:216.00px;top:224.67px" class="cls_006"><span class="cls_006">the second instruction uses the value generated by the first.</span></div>
<div style="position:absolute;left:228.02px;top:235.67px" class="cls_006"><span class="cls_006">For  example,  on  a  CPU  configured  as  big-endian  the  assembler</span></div>
<div style="position:absolute;left:216.00px;top:246.67px" class="cls_006"><span class="cls_006">instruction:</span></div>
<div style="position:absolute;left:288.00px;top:268.00px" class="cls_028"><span class="cls_028">ulw</span></div>
<div style="position:absolute;left:324.07px;top:268.00px" class="cls_028"><span class="cls_028">t1, 0(t2)</span></div>
<div style="position:absolute;left:288.00px;top:278.00px" class="cls_028"><span class="cls_028">add</span></div>
<div style="position:absolute;left:324.07px;top:278.00px" class="cls_028"><span class="cls_028">t4, t3, t1</span></div>
<div style="position:absolute;left:228.02px;top:297.67px" class="cls_006"><span class="cls_006">is implemented as:</span></div>
<div style="position:absolute;left:288.00px;top:319.00px" class="cls_028"><span class="cls_028">lwl</span></div>
<div style="position:absolute;left:324.07px;top:319.00px" class="cls_028"><span class="cls_028">t1, 0(t2)</span></div>
<div style="position:absolute;left:288.00px;top:329.00px" class="cls_028"><span class="cls_028">lwr</span></div>
<div style="position:absolute;left:324.07px;top:329.00px" class="cls_028"><span class="cls_028">t1, 3(t2)</span></div>
<div style="position:absolute;left:288.00px;top:339.00px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:349.00px" class="cls_028"><span class="cls_028">add</span></div>
<div style="position:absolute;left:324.07px;top:349.00px" class="cls_028"><span class="cls_028">t4, t3, t1</span></div>
<div style="position:absolute;left:228.02px;top:368.67px" class="cls_006"><span class="cls_006">Where:</span></div>
<div style="position:absolute;left:228.02px;top:382.67px" class="cls_006"><span class="cls_006">• the </span><span class="cls_008">lwl</span><span class="cls_006"> picks up the lowest-addressed byte of the unaligned 4-byte</span></div>
<div style="position:absolute;left:239.98px;top:393.67px" class="cls_006"><span class="cls_006">region, together with however many more bytes which fit into an</span></div>
<div style="position:absolute;left:239.98px;top:404.67px" class="cls_006"><span class="cls_006">aligned word. It then shifts them left, to form the most-significant</span></div>
<div style="position:absolute;left:239.98px;top:415.67px" class="cls_006"><span class="cls_006">bytes of the register value.</span></div>
<div style="position:absolute;left:228.03px;top:429.67px" class="cls_006"><span class="cls_006">• the </span><span class="cls_008">lwr</span><span class="cls_006"> is aimed at the highest-addressed byte in the unaligned 4-byte</span></div>
<div style="position:absolute;left:239.98px;top:440.67px" class="cls_006"><span class="cls_006">region. It loads it, together with any bytes which precede it in the</span></div>
<div style="position:absolute;left:239.98px;top:451.67px" class="cls_006"><span class="cls_006">same memory word, and shifts it right to get the least significant bits</span></div>
<div style="position:absolute;left:239.98px;top:462.67px" class="cls_006"><span class="cls_006">of the register value. The merge leaves the high-order bits unchanged.</span></div>
<div style="position:absolute;left:228.03px;top:476.67px" class="cls_006"><span class="cls_006">• Although special hardware ensures that a </span><span class="cls_008">nop</span><span class="cls_006"> is not required between</span></div>
<div style="position:absolute;left:239.98px;top:487.67px" class="cls_006"><span class="cls_006">the </span><span class="cls_008">lwl</span><span class="cls_006"> and </span><span class="cls_008">lwr</span><span class="cls_006">, there is still a load delay between the second of them</span></div>
<div style="position:absolute;left:239.97px;top:498.67px" class="cls_006"><span class="cls_006">and a normal instruction.</span></div>
<div style="position:absolute;left:228.02px;top:509.67px" class="cls_006"><span class="cls_006">Note that if </span><span class="cls_008">t2</span><span class="cls_006"> was in fact 4-byte aligned, then both instructions load the</span></div>
<div style="position:absolute;left:216.00px;top:520.67px" class="cls_006"><span class="cls_006">entire word; duplicating effort, but achieving the desired effect.</span></div>
<div style="position:absolute;left:228.02px;top:531.67px" class="cls_006"><span class="cls_006">CPU behavior when operating with little-endian byte order is described</span></div>
<div style="position:absolute;left:216.00px;top:542.67px" class="cls_006"><span class="cls_006">in a later chapter.</span></div>
<div style="position:absolute;left:216.00px;top:563.67px" class="cls_006"><span class="cls_006">Floating point data in memory</span></div>
<div style="position:absolute;left:228.02px;top:574.67px" class="cls_006"><span class="cls_006">Loads into floating point registers from 4-byte aligned memory move</span></div>
<div style="position:absolute;left:216.00px;top:585.67px" class="cls_006"><span class="cls_006">data without any interpretation - a program can load an invalid floating</span></div>
<div style="position:absolute;left:216.00px;top:596.67px" class="cls_006"><span class="cls_006">point number and no FP error will result until an arithmetic operation is</span></div>
<div style="position:absolute;left:216.00px;top:607.67px" class="cls_006"><span class="cls_006">requested with it as an operand.</span></div>
<div style="position:absolute;left:228.02px;top:618.67px" class="cls_006"><span class="cls_006">This allows a programmer to load single-precision values by a load into</span></div>
<div style="position:absolute;left:216.00px;top:629.67px" class="cls_006"><span class="cls_006">an even-numbered floating point register; but the programmer can also</span></div>
<div style="position:absolute;left:216.00px;top:640.67px" class="cls_006"><span class="cls_006">load a double-precision value by a macro instruction, so that:</span></div>
<div style="position:absolute;left:288.00px;top:662.00px" class="cls_028"><span class="cls_028">ldc1</span></div>
<div style="position:absolute;left:324.09px;top:662.00px" class="cls_028"><span class="cls_028">$f2, 24(t1)</span></div>
<div style="position:absolute;left:228.02px;top:681.67px" class="cls_006"><span class="cls_006">is expanded to two loads to consecutive registers:</span></div>
<div style="position:absolute;left:288.00px;top:703.00px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:703.00px" class="cls_028"><span class="cls_028">$f2, 24(t1)</span></div>
<div style="position:absolute;left:288.00px;top:713.00px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:713.00px" class="cls_028"><span class="cls_028">$f3, 28(t1)</span></div>
<div style="position:absolute;left:305.77px;top:755.33px" class="cls_002"><span class="cls_002">2-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:22456px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:423.27px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">The  C  compiler  aligns</span></div>
<div style="position:absolute;left:173.06px;top:50.67px" class="cls_006"><span class="cls_006">8-byte  long  double-precision  floating  point</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_006"><span class="cls_006">variables to 8-byte boundaries. R30xx family hardware does not require</span></div>
<div style="position:absolute;left:36.00px;top:72.67px" class="cls_006"><span class="cls_006">this  alignment;  but  it  is  done  to  avoid  compatibility  problems  with</span></div>
<div style="position:absolute;left:36.00px;top:83.67px" class="cls_006"><span class="cls_006">implementations of MIPS-2 or MIPS-3 CPUs such as the IDT R4600</span></div>
<div style="position:absolute;left:36.00px;top:94.67px" class="cls_006"><span class="cls_006">(Orion), where the </span><span class="cls_008">ldc1</span><span class="cls_006"> instruction is part of the machine code, and the</span></div>
<div style="position:absolute;left:36.01px;top:105.67px" class="cls_006"><span class="cls_006">alignment is necessary.</span></div>
<div style="position:absolute;left:36.00px;top:128.00px" class="cls_015"><span class="cls_015">BASIC ADDRESS SPACE</span></div>
<div style="position:absolute;left:48.02px;top:141.67px" class="cls_006"><span class="cls_006">The way in which MIPS processors use and handle addresses is subtly</span></div>
<div style="position:absolute;left:36.00px;top:152.67px" class="cls_006"><span class="cls_006">different from that of traditional CISC CPUs, and may appear confusing.</span></div>
<div style="position:absolute;left:36.00px;top:163.67px" class="cls_006"><span class="cls_006">Read the first part of this section carefully. Here are some guidelines:</span></div>
<div style="position:absolute;left:48.02px;top:177.67px" class="cls_006"><span class="cls_006">• The addresses put into programs are rarely the same as the physical</span></div>
<div style="position:absolute;left:59.97px;top:188.67px" class="cls_006"><span class="cls_006">addresses which come out of the chip (sometimes they’re close, but</span></div>
<div style="position:absolute;left:59.97px;top:199.67px" class="cls_006"><span class="cls_006">not the same). This manual will refer to them as </span><span class="cls_008">program addresses</span></div>
<div style="position:absolute;left:59.97px;top:210.67px" class="cls_006"><span class="cls_006">and </span><span class="cls_008">physical addresses</span><span class="cls_006"> respectively. A more common name for</span></div>
<div style="position:absolute;left:59.96px;top:221.67px" class="cls_006"><span class="cls_006">program addresses is “virtual addresses”; note that the use of the</span></div>
<div style="position:absolute;left:59.96px;top:232.67px" class="cls_006"><span class="cls_006">term “virtual address” does not necessarily imply that an operating</span></div>
<div style="position:absolute;left:59.96px;top:243.67px" class="cls_006"><span class="cls_006">system must perform virtual memory management (e.g. demand</span></div>
<div style="position:absolute;left:59.96px;top:254.67px" class="cls_006"><span class="cls_006">paging from disks...), but rather that the address undergoes some</span></div>
<div style="position:absolute;left:59.96px;top:265.67px" class="cls_006"><span class="cls_006">transformation before being presented to physical memory. Although</span></div>
<div style="position:absolute;left:59.96px;top:276.67px" class="cls_006"><span class="cls_006">virtual address is a proper term, this manual will typically use the</span></div>
<div style="position:absolute;left:59.96px;top:287.67px" class="cls_006"><span class="cls_006">term “program address” to avoid confusing virtual addresses with</span></div>
<div style="position:absolute;left:59.96px;top:298.67px" class="cls_006"><span class="cls_006">virtual memory management requirements.</span></div>
<div style="position:absolute;left:48.01px;top:312.67px" class="cls_006"><span class="cls_006">• A MIPS-1 CPU has two operating modes: user and kernel. In user</span></div>
<div style="position:absolute;left:59.96px;top:323.67px" class="cls_006"><span class="cls_006">mode, any address above 2Gbytes (most-significant bit of the address</span></div>
<div style="position:absolute;left:59.96px;top:334.67px" class="cls_006"><span class="cls_006">set) is illegal and causes a trap. Also, some instructions cause a trap</span></div>
<div style="position:absolute;left:59.96px;top:345.67px" class="cls_006"><span class="cls_006">in user mode.</span></div>
<div style="position:absolute;left:48.01px;top:359.67px" class="cls_006"><span class="cls_006">• The 32-bit program address space is divided into four big areas with</span></div>
<div style="position:absolute;left:59.96px;top:370.67px" class="cls_006"><span class="cls_006">traditional names; and different things happen according to the area</span></div>
<div style="position:absolute;left:59.96px;top:381.67px" class="cls_006"><span class="cls_006">an address lies in:</span></div>
<div style="position:absolute;left:48.01px;top:395.67px" class="cls_006"><span class="cls_006">kuseg</span><span class="cls_029">  0000 0000 - 7FFF FFFF</span><span class="cls_006"> (low 2Gbytes): these are the addresses</span></div>
<div style="position:absolute;left:84.01px;top:406.67px" class="cls_006"><span class="cls_006">permitted in user mode. In machines with an MMU (“E” versions</span></div>
<div style="position:absolute;left:84.01px;top:417.67px" class="cls_006"><span class="cls_006">of the R30xx family), they will always be translated (more about</span></div>
<div style="position:absolute;left:84.01px;top:428.67px" class="cls_006"><span class="cls_006">the R30xx MMU in a later chapter). Software should not attempt</span></div>
<div style="position:absolute;left:84.01px;top:439.67px" class="cls_006"><span class="cls_006">to use these addresses unless the MMU is set up.</span></div>
<div style="position:absolute;left:84.01px;top:453.67px" class="cls_006"><span class="cls_006">For machines without an MMU (“base” versions of the R30xx</span></div>
<div style="position:absolute;left:84.01px;top:464.67px" class="cls_006"><span class="cls_006">family),  the  kuseg</span></div>
<div style="position:absolute;left:187.30px;top:464.67px" class="cls_006"><span class="cls_006">“program  address”  is  transformed  to  a</span></div>
<div style="position:absolute;left:84.01px;top:475.67px" class="cls_006"><span class="cls_006">physical   address   by   adding   a</span></div>
<div style="position:absolute;left:262.01px;top:475.67px" class="cls_006"><span class="cls_006">1GB   offset;   the   address</span></div>
<div style="position:absolute;left:84.01px;top:486.67px" class="cls_006"><span class="cls_006">transformations for “base versions” of the R30xx family are</span></div>
<div style="position:absolute;left:84.01px;top:497.67px" class="cls_006"><span class="cls_006">described  later  in  this  chapter.  Note,  however,  that  many</span></div>
<div style="position:absolute;left:84.01px;top:508.67px" class="cls_006"><span class="cls_006">embedded applications do not use this address segment (those</span></div>
<div style="position:absolute;left:84.01px;top:519.67px" class="cls_006"><span class="cls_006">applications  which  do  not  require  that  the  kernel  and  its</span></div>
<div style="position:absolute;left:84.01px;top:530.67px" class="cls_006"><span class="cls_006">resources be protected from user tasks).</span></div>
<div style="position:absolute;left:48.01px;top:544.67px" class="cls_006"><span class="cls_006">kseg0</span></div>
<div style="position:absolute;left:84.01px;top:544.67px" class="cls_029"><span class="cls_029">0x8000 0000 -</span></div>
<div style="position:absolute;left:171.02px;top:544.67px" class="cls_029"><span class="cls_029">9FFF FFFF</span><span class="cls_006"> (512 Mbytes): these addresses are</span></div>
<div style="position:absolute;left:84.01px;top:555.67px" class="cls_006"><span class="cls_006">‘‘translated’’ into physical addresses by merely stripping off the</span></div>
<div style="position:absolute;left:84.01px;top:566.67px" class="cls_006"><span class="cls_006">top bit, mapping them contiguously into the low 512 Mbytes of</span></div>
<div style="position:absolute;left:84.01px;top:577.67px" class="cls_006"><span class="cls_006">physical memory. This transformation operates the same for</span></div>
<div style="position:absolute;left:84.01px;top:588.67px" class="cls_006"><span class="cls_006">both “base” and “E” family members. This segment is referred to</span></div>
<div style="position:absolute;left:84.01px;top:599.67px" class="cls_006"><span class="cls_006">as “unmapped” because “E” version devices cannot redirect this</span></div>
<div style="position:absolute;left:84.01px;top:610.67px" class="cls_006"><span class="cls_006">translation to a different area of physical memory.</span></div>
<div style="position:absolute;left:84.01px;top:624.67px" class="cls_006"><span class="cls_006">Addresses in this region are always accessed through the cache,</span></div>
<div style="position:absolute;left:84.01px;top:635.67px" class="cls_006"><span class="cls_006">so may not be used until the caches are properly initialized. They</span></div>
<div style="position:absolute;left:84.01px;top:646.67px" class="cls_006"><span class="cls_006">will be used for most programs and data in systems using “base”</span></div>
<div style="position:absolute;left:84.01px;top:657.67px" class="cls_006"><span class="cls_006">family members; and will be used for the OS kernel for systems</span></div>
<div style="position:absolute;left:84.01px;top:668.67px" class="cls_006"><span class="cls_006">which do use the MMU (“E” version devices).</span></div>
<div style="position:absolute;left:292.02px;top:755.34px" class="cls_002"><span class="cls_002">2-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:23258px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:525.01px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">kseg1</span></div>
<div style="position:absolute;left:264.02px;top:50.67px" class="cls_029"><span class="cls_029">0xA000 0000 - BFFF FFFF</span><span class="cls_006"> (512 Mbytes): these addresses are</span></div>
<div style="position:absolute;left:264.02px;top:61.67px" class="cls_006"><span class="cls_006">mapped into physical addresses by stripping off the leading three</span></div>
<div style="position:absolute;left:264.02px;top:72.67px" class="cls_006"><span class="cls_006">bits, giving a duplicate mapping of the low</span></div>
<div style="position:absolute;left:500.66px;top:72.67px" class="cls_006"><span class="cls_006">512 Mbytes of</span></div>
<div style="position:absolute;left:264.02px;top:83.67px" class="cls_006"><span class="cls_006">physical memory. However, kseg1 program address accesses will</span></div>
<div style="position:absolute;left:264.02px;top:94.67px" class="cls_006"><span class="cls_006">not use the cache.</span></div>
<div style="position:absolute;left:264.02px;top:108.67px" class="cls_006"><span class="cls_006">The </span><span class="cls_008">kseg1</span><span class="cls_006"> region is the only chunk of the memory map which is</span></div>
<div style="position:absolute;left:264.02px;top:119.67px" class="cls_006"><span class="cls_006">guaranteed to behave properly from system reset; that’s why the</span></div>
<div style="position:absolute;left:264.02px;top:130.67px" class="cls_006"><span class="cls_006">after-reset starting point (</span><span class="cls_029"> 0xBFC0</span></div>
<div style="position:absolute;left:440.01px;top:130.67px" class="cls_029"><span class="cls_029">0000</span><span class="cls_006">, commonly called the</span></div>
<div style="position:absolute;left:264.02px;top:141.67px" class="cls_006"><span class="cls_006">“reset exception vector”) lies within it. The </span><span class="cls_008">physical</span><span class="cls_006"> address of</span></div>
<div style="position:absolute;left:264.02px;top:152.67px" class="cls_006"><span class="cls_006">the starting point is</span></div>
<div style="position:absolute;left:376.90px;top:152.67px" class="cls_029"><span class="cls_029">0x1FC0 0000</span><span class="cls_006"> - which means that the</span></div>
<div style="position:absolute;left:264.02px;top:163.67px" class="cls_006"><span class="cls_006">hardware should place the boot ROM at this physical address.</span></div>
<div style="position:absolute;left:264.02px;top:177.67px" class="cls_006"><span class="cls_006">Software will therefore use this region for the initial program</span></div>
<div style="position:absolute;left:264.02px;top:188.67px" class="cls_006"><span class="cls_006">ROM, and most systems also use it for I/O registers. In general,</span></div>
<div style="position:absolute;left:264.02px;top:199.67px" class="cls_006"><span class="cls_006">IO devices should always be mapped to addresses that are</span></div>
<div style="position:absolute;left:264.02px;top:210.67px" class="cls_006"><span class="cls_006">accessible from Kseg1, and system ROM is always mapped to</span></div>
<div style="position:absolute;left:264.02px;top:221.67px" class="cls_006"><span class="cls_006">contain the reset exception vector. Note that code in the ROM</span></div>
<div style="position:absolute;left:264.02px;top:232.67px" class="cls_006"><span class="cls_006">can then be accessed uncacheably (during boot up) using kseg1</span></div>
<div style="position:absolute;left:264.02px;top:243.67px" class="cls_006"><span class="cls_006">program addresses, and also can be accessed cacheably (for</span></div>
<div style="position:absolute;left:264.02px;top:254.67px" class="cls_006"><span class="cls_006">normal operation) using kseg0 program addresses.</span></div>
<div style="position:absolute;left:228.02px;top:268.67px" class="cls_006"><span class="cls_006">kseg2</span></div>
<div style="position:absolute;left:264.02px;top:268.67px" class="cls_029"><span class="cls_029">0xC000 0000 -</span></div>
<div style="position:absolute;left:359.28px;top:268.67px" class="cls_029"><span class="cls_029">FFFF</span></div>
<div style="position:absolute;left:400.52px;top:268.67px" class="cls_029"><span class="cls_029">FFFF</span><span class="cls_006">  (1  Gbyte):  this  area  is  only</span></div>
<div style="position:absolute;left:264.02px;top:279.67px" class="cls_006"><span class="cls_006">accessible in kernel mode. As for kuseg, in “E” devices program</span></div>
<div style="position:absolute;left:264.02px;top:290.67px" class="cls_006"><span class="cls_006">addresses are translated by the MMU into physical addresses;</span></div>
<div style="position:absolute;left:264.02px;top:301.67px" class="cls_006"><span class="cls_006">thus, these addresses must not be referenced prior to MMU</span></div>
<div style="position:absolute;left:264.02px;top:312.67px" class="cls_006"><span class="cls_006">initialization.   For</span></div>
<div style="position:absolute;left:362.18px;top:312.67px" class="cls_006"><span class="cls_006">“base   versions”,   physical   addresses   are</span></div>
<div style="position:absolute;left:264.02px;top:323.67px" class="cls_006"><span class="cls_006">generated to be the same as program addresses for kseg2.</span></div>
<div style="position:absolute;left:264.02px;top:337.67px" class="cls_006"><span class="cls_006">Note that many systems will not need this region. In “E” versions,</span></div>
<div style="position:absolute;left:264.02px;top:348.67px" class="cls_006"><span class="cls_006">it frequently contains OS structures such as page tables; simpler</span></div>
<div style="position:absolute;left:264.02px;top:359.67px" class="cls_006"><span class="cls_006">OS’es probably will have little need for kseg2.</span></div>
<div style="position:absolute;left:216.00px;top:382.00px" class="cls_015"><span class="cls_015">SUMMARY OF SYSTEM ADDRESSING</span></div>
<div style="position:absolute;left:228.02px;top:395.67px" class="cls_006"><span class="cls_006">MIPS  program  addresses  are  rarely  simply  the  same  as  physical</span></div>
<div style="position:absolute;left:216.00px;top:406.67px" class="cls_006"><span class="cls_006">addresses, but simple embedded software will probably use addresses in</span></div>
<div style="position:absolute;left:216.00px;top:417.67px" class="cls_006"><span class="cls_006">kseg0 and kseg1, where the program address is related in an obvious and</span></div>
<div style="position:absolute;left:216.00px;top:428.67px" class="cls_006"><span class="cls_006">unchangeable way to physical addresses.</span></div>
<div style="position:absolute;left:228.02px;top:439.67px" class="cls_006"><span class="cls_006">Physical memory locations from</span></div>
<div style="position:absolute;left:391.72px;top:439.67px" class="cls_029"><span class="cls_029">0x2000 0000</span><span class="cls_006"> (512Mbyte) upward may</span></div>
<div style="position:absolute;left:215.99px;top:450.67px" class="cls_006"><span class="cls_006">be difficult to access. In “E” versions of the R30xx family, the only way to</span></div>
<div style="position:absolute;left:215.99px;top:461.67px" class="cls_006"><span class="cls_006">reach these addresses is through the MMU. In “base” family members,</span></div>
<div style="position:absolute;left:215.99px;top:472.67px" class="cls_006"><span class="cls_006">certain of these physical addresses can be reached using kseg2 or kuseg</span></div>
<div style="position:absolute;left:215.99px;top:483.67px" class="cls_006"><span class="cls_006">addresses: the address transformations for base R30xx family members is</span></div>
<div style="position:absolute;left:215.99px;top:494.67px" class="cls_006"><span class="cls_006">described later in this chapter.</span></div>
<div style="position:absolute;left:216.00px;top:517.00px" class="cls_015"><span class="cls_015">Kernel vs. user mode</span></div>
<div style="position:absolute;left:228.02px;top:530.67px" class="cls_006"><span class="cls_006">In kernel mode (the CPU resets into this state), all program addresses</span></div>
<div style="position:absolute;left:216.00px;top:541.67px" class="cls_006"><span class="cls_006">are accessible.</span></div>
<div style="position:absolute;left:228.02px;top:552.67px" class="cls_006"><span class="cls_006">In user mode:</span></div>
<div style="position:absolute;left:228.02px;top:566.67px" class="cls_006"><span class="cls_006">• Program addresses above 2Gbytes (top bit set) are illegal and will</span></div>
<div style="position:absolute;left:239.97px;top:577.67px" class="cls_006"><span class="cls_006">cause a trap.</span></div>
<div style="position:absolute;left:239.97px;top:591.67px" class="cls_006"><span class="cls_006">Note that if the CPU has an MMU, this means all valid user mode</span></div>
<div style="position:absolute;left:239.97px;top:602.67px" class="cls_006"><span class="cls_006">addresses must be translated by the MMU; thus, User mode for “E”</span></div>
<div style="position:absolute;left:239.97px;top:613.67px" class="cls_006"><span class="cls_006">devices typically requires the use of a memory-mapped OS.</span></div>
<div style="position:absolute;left:239.97px;top:627.67px" class="cls_006"><span class="cls_006">For “base” CPUs, kuseg addresses are mapped to a distinct area of</span></div>
<div style="position:absolute;left:239.97px;top:638.67px" class="cls_006"><span class="cls_006">physical  memory.  Thus,  kernel  memory  resources  (including  IO</span></div>
<div style="position:absolute;left:239.97px;top:649.67px" class="cls_006"><span class="cls_006">devices) can be made inaccessible to User mode software, without</span></div>
<div style="position:absolute;left:239.97px;top:660.67px" class="cls_006"><span class="cls_006">requiring a memory-mapping function from the OS. Alternately, the</span></div>
<div style="position:absolute;left:239.97px;top:671.67px" class="cls_006"><span class="cls_006">hardware  can  choose  to</span></div>
<div style="position:absolute;left:375.25px;top:671.67px" class="cls_006"><span class="cls_006">“ignore”  high-order  address  bits  when</span></div>
<div style="position:absolute;left:239.97px;top:682.67px" class="cls_006"><span class="cls_006">performing address decoding, thus “condensing” kuseg, kseg2, kseg1,</span></div>
<div style="position:absolute;left:239.97px;top:693.67px" class="cls_006"><span class="cls_006">and kseg0 into the same physical memory.</span></div>
<div style="position:absolute;left:305.77px;top:755.34px" class="cls_002"><span class="cls_002">2-9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:24060px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:423.27px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">• Instructions beyond the standard user set become illegal. Specifically,</span></div>
<div style="position:absolute;left:59.97px;top:61.67px" class="cls_006"><span class="cls_006">the kernel can prevent User mode software from accessing the on-</span></div>
<div style="position:absolute;left:59.97px;top:72.67px" class="cls_006"><span class="cls_006">chip CP0 (system control coprocessor, which controls exception and</span></div>
<div style="position:absolute;left:59.97px;top:83.67px" class="cls_006"><span class="cls_006">machine state and performs the memory management functions of</span></div>
<div style="position:absolute;left:59.97px;top:94.67px" class="cls_006"><span class="cls_006">the CPU).</span></div>
<div style="position:absolute;left:48.02px;top:105.67px" class="cls_006"><span class="cls_006">Thus, the primary differences between User and Kernel modes are:</span></div>
<div style="position:absolute;left:48.02px;top:119.67px" class="cls_006"><span class="cls_006">• User mode tasks can be inhibited from accessing kernel memory</span></div>
<div style="position:absolute;left:59.97px;top:130.67px" class="cls_006"><span class="cls_006">resources, including OS data structures and IO devices. This also</span></div>
<div style="position:absolute;left:59.97px;top:141.67px" class="cls_006"><span class="cls_006">means that various user tasks can be protected from each other.</span></div>
<div style="position:absolute;left:48.02px;top:155.67px" class="cls_006"><span class="cls_006">• User mode tasks can be inhibited from modifying the basic machine</span></div>
<div style="position:absolute;left:59.97px;top:166.67px" class="cls_006"><span class="cls_006">state, by prohibiting accesses to CP0.</span></div>
<div style="position:absolute;left:48.02px;top:177.67px" class="cls_006"><span class="cls_006">Note that the kernel/user mode bit does not change the interpretation</span></div>
<div style="position:absolute;left:36.00px;top:188.67px" class="cls_006"><span class="cls_006">of anything - just some things cease to be allowed in user mode. In kernel</span></div>
<div style="position:absolute;left:36.00px;top:199.67px" class="cls_006"><span class="cls_006">mode the CPU can access low addresses just as if it was in user mode, and</span></div>
<div style="position:absolute;left:36.00px;top:210.67px" class="cls_006"><span class="cls_006">they will be translated in the same way.</span></div>
<div style="position:absolute;left:36.00px;top:233.00px" class="cls_015"><span class="cls_015">Memory map for CPUs without MMU hardware</span></div>
<div style="position:absolute;left:48.02px;top:246.67px" class="cls_006"><span class="cls_006">The treatment of kseg0 and kseg1 addresses is the same for all IDT</span></div>
<div style="position:absolute;left:36.00px;top:257.67px" class="cls_006"><span class="cls_006">R30xx CPUs. If the system can be implemented using only physical</span></div>
<div style="position:absolute;left:36.00px;top:268.67px" class="cls_006"><span class="cls_006">addresses in the low 512Mbytes, and system software can be written to use</span></div>
<div style="position:absolute;left:36.00px;top:279.67px" class="cls_006"><span class="cls_006">only kseg0 and kseg1, then the choice of “base” vs. “E” versions of the</span></div>
<div style="position:absolute;left:36.00px;top:290.67px" class="cls_006"><span class="cls_006">R30xx family is not relevant.</span></div>
<div style="position:absolute;left:48.02px;top:301.67px" class="cls_006"><span class="cls_006">For versions without the MMU (“base versions”), addresses in kuseg and</span></div>
<div style="position:absolute;left:36.00px;top:312.67px" class="cls_006"><span class="cls_006">kseg2 will undergo a fixed address translation, and provide the system</span></div>
<div style="position:absolute;left:36.00px;top:323.67px" class="cls_006"><span class="cls_006">designer the option to provide additional memory.</span></div>
<div style="position:absolute;left:48.02px;top:334.67px" class="cls_006"><span class="cls_006">The base members of the R30xx family provide the following address</span></div>
<div style="position:absolute;left:36.00px;top:345.67px" class="cls_006"><span class="cls_006">translations for kuseg and kseg2 program addresses:</span></div>
<div style="position:absolute;left:48.02px;top:359.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> kuseg</span><span class="cls_006">:  this  region</span></div>
<div style="position:absolute;left:164.71px;top:359.67px" class="cls_006"><span class="cls_006">(the  low</span></div>
<div style="position:absolute;left:215.25px;top:359.67px" class="cls_006"><span class="cls_006">2Gbytes  of  program  addresses)  is</span></div>
<div style="position:absolute;left:59.97px;top:370.67px" class="cls_006"><span class="cls_006">translated  to  a  contiguous</span></div>
<div style="position:absolute;left:209.73px;top:370.67px" class="cls_006"><span class="cls_006">2Gbyte  physical  region  between</span></div>
<div style="position:absolute;left:385.89px;top:370.67px" class="cls_006"><span class="cls_006">1-</span></div>
<div style="position:absolute;left:59.97px;top:381.67px" class="cls_006"><span class="cls_006">3Gbytes. In effect, a 1GB offset is added to each kuseg program</span></div>
<div style="position:absolute;left:59.97px;top:392.67px" class="cls_006"><span class="cls_006">address. In hex:</span></div>
<div style="position:absolute;left:81.98px;top:415.00px" class="cls_020"><span class="cls_020">Program address</span></div>
<div style="position:absolute;left:238.35px;top:415.00px" class="cls_020"><span class="cls_020">Physical Address</span></div>
<div style="position:absolute;left:81.98px;top:434.00px" class="cls_028"><span class="cls_028">0x0000 0000 -</span></div>
<div style="position:absolute;left:202.00px;top:434.00px" class="cls_021"><span class="cls_021">→</span></div>
<div style="position:absolute;left:238.00px;top:434.00px" class="cls_028"><span class="cls_028">0x4000 0000 -</span></div>
<div style="position:absolute;left:81.98px;top:444.00px" class="cls_028"><span class="cls_028">0x7FFF FFFF</span></div>
<div style="position:absolute;left:238.00px;top:444.00px" class="cls_028"><span class="cls_028">0xBFFF FFFF</span></div>
<div style="position:absolute;left:48.02px;top:463.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> kseg2</span><span class="cls_006">: these program addresses are genuinely untranslated. So</span></div>
<div style="position:absolute;left:59.97px;top:474.67px" class="cls_006"><span class="cls_006">program addresses from </span><span class="cls_029">0xC000 0000</span></div>
<div style="position:absolute;left:261.63px;top:474.67px" class="cls_029"><span class="cls_029">-</span></div>
<div style="position:absolute;left:277.47px;top:474.67px" class="cls_029"><span class="cls_029">0xFFFF FFFF</span><span class="cls_006"> emerge as</span></div>
<div style="position:absolute;left:59.97px;top:485.67px" class="cls_006"><span class="cls_006">identical physical addresses.</span></div>
<div style="position:absolute;left:48.02px;top:496.67px" class="cls_006"><span class="cls_006">This means that “base” versions can generate most physical addresses</span></div>
<div style="position:absolute;left:36.00px;top:507.67px" class="cls_006"><span class="cls_006">(without the use of an MMU), except for a gap between 512Mbyte and</span></div>
<div style="position:absolute;left:36.00px;top:518.67px" class="cls_006"><span class="cls_006">1Gbyte (0x2000 0000 through 0x3FFF FFFF). As noted above, many</span></div>
<div style="position:absolute;left:36.00px;top:529.67px" class="cls_006"><span class="cls_006">systems may ignore high-order address bits when performing address</span></div>
<div style="position:absolute;left:36.00px;top:540.67px" class="cls_006"><span class="cls_006">decoding, thus condensing all physical memory into the lowest 512MB</span></div>
<div style="position:absolute;left:36.00px;top:551.67px" class="cls_006"><span class="cls_006">addresses.</span></div>
<div style="position:absolute;left:36.00px;top:572.67px" class="cls_006"><span class="cls_006">Subsegments in the R3041 - memory width configuration</span></div>
<div style="position:absolute;left:48.02px;top:583.67px" class="cls_006"><span class="cls_006">The R3041 CPU can be configured to access different regions of memory</span></div>
<div style="position:absolute;left:36.00px;top:594.67px" class="cls_006"><span class="cls_006">as either 32-, 16- or 8-bits wide. Where the program requests a 32-bit</span></div>
<div style="position:absolute;left:36.00px;top:605.67px" class="cls_006"><span class="cls_006">operation to a narrow memory (either with an uncached access, or a cache</span></div>
<div style="position:absolute;left:36.00px;top:616.67px" class="cls_006"><span class="cls_006">miss, or a store), the CPU may break a transaction into multiple data</span></div>
<div style="position:absolute;left:36.00px;top:627.67px" class="cls_006"><span class="cls_006">phases, to match the datum size to the memory port width.</span></div>
<div style="position:absolute;left:48.02px;top:638.67px" class="cls_006"><span class="cls_006">The width configuration is applied independently to subsegments of the</span></div>
<div style="position:absolute;left:36.00px;top:649.67px" class="cls_006"><span class="cls_006">normal kseg regions, as follows:</span></div>
<div style="position:absolute;left:48.02px;top:663.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> kseg0 and kseg1</span><span class="cls_006">: as usual, these are both mapped onto the low</span></div>
<div style="position:absolute;left:59.97px;top:674.67px" class="cls_006"><span class="cls_006">512Mbytes.  This  common  region  is  split  into</span></div>
<div style="position:absolute;left:317.25px;top:674.67px" class="cls_006"><span class="cls_006">8  subsegments</span></div>
<div style="position:absolute;left:59.97px;top:685.67px" class="cls_006"><span class="cls_006">(64Mbytes each), each of which can be programmed as 8-, 16- or 32-</span></div>
<div style="position:absolute;left:59.97px;top:696.67px" class="cls_006"><span class="cls_006">bits  wide.  The  width  assignment  affects  both  kseg0  and  kseg1</span></div>
<div style="position:absolute;left:59.97px;top:707.67px" class="cls_006"><span class="cls_006">accesses</span></div>
<div style="position:absolute;left:109.94px;top:707.67px" class="cls_006"><span class="cls_006">(that  is,  one  can  view  these  as  subsegments  of  the</span></div>
<div style="position:absolute;left:59.97px;top:718.67px" class="cls_006"><span class="cls_006">corresponding “physical” addresses).</span></div>
<div style="position:absolute;left:289.78px;top:755.34px" class="cls_002"><span class="cls_002">2-10</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:24862px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:525.01px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> kuseg</span><span class="cls_006">:   is   divided   into   four</span></div>
<div style="position:absolute;left:413.84px;top:50.67px" class="cls_006"><span class="cls_006">512Mbyte   subsegments,   each</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">independently programmable for width. Thus, kuseg can be broken</span></div>
<div style="position:absolute;left:239.97px;top:72.67px" class="cls_006"><span class="cls_006">into multiple portions, which may have varying widths. An example of</span></div>
<div style="position:absolute;left:239.97px;top:83.67px" class="cls_006"><span class="cls_006">this may be a 32-bit main memory with some 16-bit PCMCIA font</span></div>
<div style="position:absolute;left:239.97px;top:94.67px" class="cls_006"><span class="cls_006">cards and an 8-bit NVRAM.</span></div>
<div style="position:absolute;left:228.02px;top:108.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> kseg2</span><span class="cls_006">: is divided into two 512Mbyte subsegments, independently</span></div>
<div style="position:absolute;left:239.97px;top:119.67px" class="cls_006"><span class="cls_006">programmable for width. Again, this means that kseg2 can support</span></div>
<div style="position:absolute;left:239.97px;top:130.67px" class="cls_006"><span class="cls_006">multiple memory subsystems, of varying port width.</span></div>
<div style="position:absolute;left:228.02px;top:141.67px" class="cls_006"><span class="cls_006">Note that once the various memory port widths have been configured</span></div>
<div style="position:absolute;left:216.00px;top:152.67px" class="cls_006"><span class="cls_006">(typically at boot time), software does not have to be aware of the actual</span></div>
<div style="position:absolute;left:216.00px;top:163.67px" class="cls_006"><span class="cls_006">width of any memory system. It can choose to treat all memory as 32-bit</span></div>
<div style="position:absolute;left:216.00px;top:174.67px" class="cls_006"><span class="cls_006">wide, and the CPU will automatically adjust when an access is made to a</span></div>
<div style="position:absolute;left:216.00px;top:185.67px" class="cls_006"><span class="cls_006">narrower memory region. This simplifies software development, and also</span></div>
<div style="position:absolute;left:216.00px;top:196.67px" class="cls_006"><span class="cls_006">facilitates porting to various system implementations (which may or may</span></div>
<div style="position:absolute;left:216.00px;top:207.67px" class="cls_006"><span class="cls_006">not choose the same memory port widths).</span></div>
<div style="position:absolute;left:303.53px;top:755.34px" class="cls_002"><span class="cls_002">2-11</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:25664px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">MIPS-1 (R30xx)</span></div>
<div style="position:absolute;left:491.33px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 2</span></div>
<div style="position:absolute;left:222.89px;top:56.33px" class="cls_005"><span class="cls_005">ARCHITECTURE</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:216.00px;top:136.00px" class="cls_015"><span class="cls_015">PROGRAMMER’S VIEW OF THE PROCESSOR</span></div>
<div style="position:absolute;left:216.00px;top:148.99px" class="cls_015"><span class="cls_015">ARCHITECTURE</span></div>
<div style="position:absolute;left:228.02px;top:162.67px" class="cls_006"><span class="cls_006">This chapter describes the assembly programmer’s view of the CPU</span></div>
<div style="position:absolute;left:216.00px;top:173.67px" class="cls_006"><span class="cls_006">architecture,  in  terms  of  registers,  instructions,  and  computational</span></div>
<div style="position:absolute;left:216.00px;top:184.67px" class="cls_006"><span class="cls_006">resources.  This  viewpoint  corresponds,  for  example,  to  an  assembly</span></div>
<div style="position:absolute;left:216.00px;top:195.67px" class="cls_006"><span class="cls_006">programmer writing user applications (although more typically, such a</span></div>
<div style="position:absolute;left:216.00px;top:206.67px" class="cls_006"><span class="cls_006">programmer would use a high-level language).</span></div>
<div style="position:absolute;left:228.02px;top:217.67px" class="cls_006"><span class="cls_006">Information  about  kernel  software  development</span></div>
<div style="position:absolute;left:481.32px;top:217.67px" class="cls_006"><span class="cls_006">(such  as  handling</span></div>
<div style="position:absolute;left:216.00px;top:228.67px" class="cls_006"><span class="cls_006">interrupts, traps, and cache and memory management) are described in</span></div>
<div style="position:absolute;left:216.00px;top:239.67px" class="cls_006"><span class="cls_006">later chapters.</span></div>
<div style="position:absolute;left:216.00px;top:262.00px" class="cls_015"><span class="cls_015">Registers</span></div>
<div style="position:absolute;left:228.02px;top:275.67px" class="cls_006"><span class="cls_006">There are 32 general purpose registers: $0 to $31. Two, and only two,</span></div>
<div style="position:absolute;left:216.00px;top:286.67px" class="cls_006"><span class="cls_006">are special to the hardware:</span></div>
<div style="position:absolute;left:228.02px;top:300.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:300.67px" class="cls_006"><span class="cls_006">$0 always returns zero, no matter what software attempts to store to</span></div>
<div style="position:absolute;left:239.97px;top:311.67px" class="cls_006"><span class="cls_006">it.</span></div>
<div style="position:absolute;left:228.02px;top:325.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:325.67px" class="cls_006"><span class="cls_006">$31 is used by the normal subroutine-calling instruction (jal) for the</span></div>
<div style="position:absolute;left:239.97px;top:336.67px" class="cls_006"><span class="cls_006">return address. Note that the call-by-register version (jalr) can use</span></div>
<div style="position:absolute;left:239.97px;top:347.67px" class="cls_006"><span class="cls_006">ANY register for the return address, though practice is to use only</span></div>
<div style="position:absolute;left:239.97px;top:358.67px" class="cls_006"><span class="cls_006">$31.</span></div>
<div style="position:absolute;left:228.02px;top:369.67px" class="cls_006"><span class="cls_006">In all other respects all registers are identical and can be used in any</span></div>
<div style="position:absolute;left:216.00px;top:380.67px" class="cls_006"><span class="cls_006">instruction ($0 can be used as the destination of instructions; the value of</span></div>
<div style="position:absolute;left:216.00px;top:391.67px" class="cls_006"><span class="cls_006">$0 will remain unchanged, however, so the instruction would be effectively</span></div>
<div style="position:absolute;left:216.00px;top:402.67px" class="cls_006"><span class="cls_006">a NOP).</span></div>
<div style="position:absolute;left:228.02px;top:413.67px" class="cls_006"><span class="cls_006">In the MIPS architecture the ‘‘program counter’’ is not a register, and it</span></div>
<div style="position:absolute;left:216.00px;top:424.67px" class="cls_006"><span class="cls_006">is probably better to not think of it that way. The return address of a </span><span class="cls_008">jal</span><span class="cls_006"> is</span></div>
<div style="position:absolute;left:216.00px;top:435.67px" class="cls_006"><span class="cls_006">two instructions later in sequence (the instruction after the jump delay slot</span></div>
<div style="position:absolute;left:216.01px;top:446.67px" class="cls_006"><span class="cls_006">instruction); the instruction after the call is the call’s ‘‘delay slot’’ and is</span></div>
<div style="position:absolute;left:216.01px;top:457.67px" class="cls_006"><span class="cls_006">typically used to set up the last parameter.</span></div>
<div style="position:absolute;left:228.02px;top:468.67px" class="cls_006"><span class="cls_006">There are no condition codes and nothing in the ‘‘status register’’ or</span></div>
<div style="position:absolute;left:216.01px;top:479.67px" class="cls_006"><span class="cls_006">other CPU internals is of any consequence to the user-level programmer.</span></div>
<div style="position:absolute;left:228.02px;top:490.67px" class="cls_006"><span class="cls_006">There are two registers associated with the integer multiplier. These</span></div>
<div style="position:absolute;left:216.01px;top:501.67px" class="cls_006"><span class="cls_006">registers, referred to as “HI” and “LO”, contain the 64-bit product result of</span></div>
<div style="position:absolute;left:216.01px;top:512.67px" class="cls_006"><span class="cls_006">a multiply operation, or the quotient and remainder of a divide.</span></div>
<div style="position:absolute;left:228.02px;top:523.67px" class="cls_006"><span class="cls_006">The floating point math co-processor (called </span><span class="cls_008">FPA</span><span class="cls_006"> for floating point</span></div>
<div style="position:absolute;left:216.00px;top:534.67px" class="cls_006"><span class="cls_006">accelerator), if available, adds</span></div>
<div style="position:absolute;left:377.60px;top:534.67px" class="cls_006"><span class="cls_006">32 floating point registers†; in simple</span></div>
<div style="position:absolute;left:216.00px;top:545.67px" class="cls_006"><span class="cls_006">assembler language they are just called $0 to $31 again - the fact that</span></div>
<div style="position:absolute;left:216.00px;top:556.67px" class="cls_006"><span class="cls_006">these are floating point registers is implicitly defined by the instruction.</span></div>
<div style="position:absolute;left:216.00px;top:567.67px" class="cls_006"><span class="cls_006">Actually, only the 16 even-numbered registers are usable for math; but</span></div>
<div style="position:absolute;left:216.00px;top:578.67px" class="cls_006"><span class="cls_006">they can be used for either single-precision (32 bit) or double-precision</span></div>
<div style="position:absolute;left:216.00px;top:589.67px" class="cls_006"><span class="cls_006">(64-bit)  numbers,  When  performing  double-precision  arithmetic,  odd</span></div>
<div style="position:absolute;left:216.00px;top:600.67px" class="cls_006"><span class="cls_006">numbered register $N+1 holds the remaining bits of the even numbered</span></div>
<div style="position:absolute;left:216.00px;top:611.67px" class="cls_006"><span class="cls_006">register identified $N. Only moves between integer and FPA, or FPA load/</span></div>
<div style="position:absolute;left:216.00px;top:622.67px" class="cls_006"><span class="cls_006">store instructions, ever refer to odd-numbered registers (and even then the</span></div>
<div style="position:absolute;left:216.00px;top:633.67px" class="cls_006"><span class="cls_006">assembler helps the programmer forget...)</span></div>
<div style="position:absolute;left:234.00px;top:686.67px" class="cls_006"><span class="cls_006">† The FPA also has a different set of registers called ‘‘co-processor</span></div>
<div style="position:absolute;left:234.00px;top:698.67px" class="cls_006"><span class="cls_006">1 registers’’ for control purposes. These are typically used to</span></div>
<div style="position:absolute;left:234.00px;top:710.67px" class="cls_006"><span class="cls_006">manage the actions/state of the FPA, and should not be confused</span></div>
<div style="position:absolute;left:234.00px;top:722.67px" class="cls_006"><span class="cls_006">with the FPA data registers.</span></div>
<div style="position:absolute;left:299.28px;top:754.68px" class="cls_002"><span class="cls_002">2-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:26466px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">SYSTEM CONTROL CO-</span></div>
<div style="position:absolute;left:491.33px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 3</span></div>
<div style="position:absolute;left:222.89px;top:56.33px" class="cls_005"><span class="cls_005">PROCESSOR ARCHITECTURE</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:228.02px;top:124.67px" class="cls_006"><span class="cls_006">This  chapter  concentrates  on  the  aspects  of  the  R30xx  family</span></div>
<div style="position:absolute;left:216.00px;top:135.67px" class="cls_006"><span class="cls_006">architecture that must be managed by the OS programmer. Note that most</span></div>
<div style="position:absolute;left:216.00px;top:146.67px" class="cls_006"><span class="cls_006">of these features are transparent to the user program author; however, the</span></div>
<div style="position:absolute;left:216.00px;top:157.67px" class="cls_006"><span class="cls_006">nature  of  embedded  systems  is  such  that  most  embedded  systems</span></div>
<div style="position:absolute;left:216.00px;top:168.67px" class="cls_006"><span class="cls_006">programmers  will  have  a  view  of  the  underlying  CPU  and  system</span></div>
<div style="position:absolute;left:216.00px;top:179.67px" class="cls_006"><span class="cls_006">architecture, and thus will find this material important.</span></div>
<div style="position:absolute;left:363.60px;top:201.00px" class="cls_020"><span class="cls_020">Co-processors</span></div>
<div style="position:absolute;left:235.86px;top:218.00px" class="cls_020"><span class="cls_020">MIPS uses the term “co-processor” both in a traditional fashion, and also</span></div>
<div style="position:absolute;left:235.86px;top:228.00px" class="cls_020"><span class="cls_020">in a non-traditional fashion. Specifically, the FPA device is a traditional</span></div>
<div style="position:absolute;left:235.86px;top:238.00px" class="cls_020"><span class="cls_020">microprocessor co-processor: it is an optional part of the architecture,</span></div>
<div style="position:absolute;left:235.86px;top:248.00px" class="cls_020"><span class="cls_020">with its own particular instruction set.</span></div>
<div style="position:absolute;left:235.86px;top:263.00px" class="cls_020"><span class="cls_020">Opcodes are reserved and instruction fields defined for up to four ‘‘co-</span></div>
<div style="position:absolute;left:235.86px;top:273.00px" class="cls_020"><span class="cls_020">processors’’. Architecturally, the co-processors can be tightly coupled to</span></div>
<div style="position:absolute;left:235.86px;top:283.00px" class="cls_020"><span class="cls_020">the base integer CPU; for example, the ISA defines instructions to move</span></div>
<div style="position:absolute;left:235.86px;top:293.00px" class="cls_020"><span class="cls_020">data directly between memory and the coprocessor, rather than requiring</span></div>
<div style="position:absolute;left:235.86px;top:303.00px" class="cls_020"><span class="cls_020">it to be moved into the integer processor first.</span></div>
<div style="position:absolute;left:235.86px;top:318.00px" class="cls_020"><span class="cls_020">However, MIPS also uses the term “co-processor” for the functions</span></div>
<div style="position:absolute;left:235.86px;top:328.00px" class="cls_020"><span class="cls_020">required to manage the CPU environment, including exception</span></div>
<div style="position:absolute;left:235.86px;top:338.00px" class="cls_020"><span class="cls_020">management, cache control, and memory management. This</span></div>
<div style="position:absolute;left:235.86px;top:348.00px" class="cls_020"><span class="cls_020">segmentation insures that the chip architecture can be varied (e.g. cache</span></div>
<div style="position:absolute;left:235.86px;top:357.99px" class="cls_020"><span class="cls_020">architecture, interrupt controller, etc.), without impacting user mode</span></div>
<div style="position:absolute;left:235.86px;top:367.99px" class="cls_020"><span class="cls_020">software compatibility.</span></div>
<div style="position:absolute;left:235.86px;top:383.00px" class="cls_020"><span class="cls_020">These functions are grouped by MIPS into the on-chip “co-processor 0”,</span></div>
<div style="position:absolute;left:235.86px;top:393.00px" class="cls_020"><span class="cls_020">or ‘‘system control co-processor’’ - and these instructions implement the</span></div>
<div style="position:absolute;left:235.86px;top:402.99px" class="cls_020"><span class="cls_020">whole CPU control system. Note that co-processor 0 has no independent</span></div>
<div style="position:absolute;left:235.86px;top:412.99px" class="cls_020"><span class="cls_020">existence, and is certainly not optional. It provides a standard way of</span></div>
<div style="position:absolute;left:235.86px;top:422.99px" class="cls_020"><span class="cls_020">encoding the instructions which access the CPU status register; so that,</span></div>
<div style="position:absolute;left:235.86px;top:432.99px" class="cls_020"><span class="cls_020">although the definition of the status register changes among</span></div>
<div style="position:absolute;left:235.86px;top:442.99px" class="cls_020"><span class="cls_020">implementations, programmers can use the same assembler for both</span></div>
<div style="position:absolute;left:235.86px;top:452.99px" class="cls_020"><span class="cls_020">CPUs. Similarly, the exception and memory management strategies can</span></div>
<div style="position:absolute;left:235.86px;top:462.99px" class="cls_020"><span class="cls_020">be varied among implementations, and these effects isolated to particular</span></div>
<div style="position:absolute;left:235.86px;top:472.99px" class="cls_020"><span class="cls_020">portions of the OS kernel.</span></div>
<div style="position:absolute;left:216.00px;top:497.00px" class="cls_015"><span class="cls_015">CPU CONTROL SUMMARY</span></div>
<div style="position:absolute;left:228.02px;top:510.67px" class="cls_006"><span class="cls_006">This chapter, coupled with chapters on cache management, memory</span></div>
<div style="position:absolute;left:216.00px;top:521.67px" class="cls_006"><span class="cls_006">management, and exception processing, provide details on managing the</span></div>
<div style="position:absolute;left:216.00px;top:532.67px" class="cls_006"><span class="cls_006">machine and OS state. The areas of interest include:</span></div>
<div style="position:absolute;left:228.02px;top:546.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> CPU  control  and  co-processor</span><span class="cls_006">:   how   privileged   instructions   are</span></div>
<div style="position:absolute;left:239.98px;top:557.67px" class="cls_006"><span class="cls_006">organized,  with  shortform  descriptions.  There  are  relatively  few</span></div>
<div style="position:absolute;left:239.98px;top:568.67px" class="cls_006"><span class="cls_006">privileged instructions; most of the low-level control over the CPU is</span></div>
<div style="position:absolute;left:239.98px;top:579.67px" class="cls_006"><span class="cls_006">exercised by reading and writing bit-fields within special registers.</span></div>
<div style="position:absolute;left:228.03px;top:593.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Exceptions</span><span class="cls_006">: external interrupts, invalid operations, arithmetic errors</span></div>
<div style="position:absolute;left:239.97px;top:604.67px" class="cls_006"><span class="cls_006">-  all  result  in</span></div>
<div style="position:absolute;left:322.73px;top:604.67px" class="cls_006"><span class="cls_006">‘‘exceptions’’,  where  control  is  transferred  to  an</span></div>
<div style="position:absolute;left:239.98px;top:615.67px" class="cls_008"><span class="cls_008">exception handler</span><span class="cls_006"> routine.</span></div>
<div style="position:absolute;left:239.98px;top:629.67px" class="cls_006"><span class="cls_006">MIPS exceptions are extremely simple - the hardware does the</span></div>
<div style="position:absolute;left:239.98px;top:640.67px" class="cls_006"><span class="cls_006">absolute minimum, allowing the programmer to tailor the exception</span></div>
<div style="position:absolute;left:239.98px;top:651.67px" class="cls_006"><span class="cls_006">mechanism to the needs of the particular system.</span></div>
<div style="position:absolute;left:239.98px;top:665.67px" class="cls_006"><span class="cls_006">A later chapter describes MIPS exceptions, why they are ‘‘precise’’,</span></div>
<div style="position:absolute;left:239.98px;top:676.67px" class="cls_006"><span class="cls_006">exception vectors, and conventions about how to code exception</span></div>
<div style="position:absolute;left:239.98px;top:687.67px" class="cls_006"><span class="cls_006">handling routines.</span></div>
<div style="position:absolute;left:239.98px;top:701.67px" class="cls_006"><span class="cls_006">Special  problems  can  arise  with </span><span class="cls_008"> nested  exceptions</span><span class="cls_006">:  exceptions</span></div>
<div style="position:absolute;left:239.97px;top:712.67px" class="cls_006"><span class="cls_006">occurring while the CPU is still handling an earlier exception.</span></div>
<div style="position:absolute;left:299.28px;top:754.68px" class="cls_002"><span class="cls_002">3-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:27268px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 3</span></div>
<div style="position:absolute;left:327.88px;top:28.00px" class="cls_002"><span class="cls_002">SYSTEM CONTROL CO-PROCESSOR ARCHITECTURE</span></div>
<div style="position:absolute;left:59.98px;top:50.67px" class="cls_006"><span class="cls_006">Hardware interrupts have their own style and rules.</span></div>
<div style="position:absolute;left:59.98px;top:64.67px" class="cls_006"><span class="cls_006">The Exception Management chapter includes an annotated example</span></div>
<div style="position:absolute;left:59.98px;top:75.67px" class="cls_006"><span class="cls_006">of a moderately-complicated exception handler.</span></div>
<div style="position:absolute;left:48.03px;top:89.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:89.67px" class="cls_008"><span class="cls_008">Caches and cache management</span><span class="cls_006">: all R30xx implementations have dual</span></div>
<div style="position:absolute;left:59.98px;top:100.67px" class="cls_006"><span class="cls_006">caches (the I-cache for instructions, the D-cache for data). On-chip</span></div>
<div style="position:absolute;left:59.98px;top:111.67px" class="cls_006"><span class="cls_006">hardware is provided to manage the caches, and the programmer</span></div>
<div style="position:absolute;left:59.98px;top:122.67px" class="cls_006"><span class="cls_006">working with I/O devices, particularly with DMA devices, may need to</span></div>
<div style="position:absolute;left:59.98px;top:133.67px" class="cls_006"><span class="cls_006">explicitly manage the caches in particular situations.</span></div>
<div style="position:absolute;left:59.98px;top:147.67px" class="cls_006"><span class="cls_006">To manipulate the caches, the CPU allows software to </span><span class="cls_008">isolate</span><span class="cls_006"> them,</span></div>
<div style="position:absolute;left:59.97px;top:158.67px" class="cls_006"><span class="cls_006">inhibiting cache/memory traffic and allowing the processor to access</span></div>
<div style="position:absolute;left:59.97px;top:169.67px" class="cls_006"><span class="cls_006">cache as if it were simple memory; and the CPU can </span><span class="cls_008">swap</span><span class="cls_006"> the roles of</span></div>
<div style="position:absolute;left:59.98px;top:180.67px" class="cls_006"><span class="cls_006">the I-cache and D-cache (the only way to make the I-cache writable).</span></div>
<div style="position:absolute;left:59.98px;top:194.67px" class="cls_006"><span class="cls_006">Caches must sometimes be cleared of stale or invalid/uninitialized</span></div>
<div style="position:absolute;left:59.98px;top:205.67px" class="cls_006"><span class="cls_006">data. Even following power-up, the R30xx caches are in a random</span></div>
<div style="position:absolute;left:59.98px;top:216.67px" class="cls_006"><span class="cls_006">state and must be cleaned up before they can be used. A later chapter</span></div>
<div style="position:absolute;left:59.98px;top:227.67px" class="cls_006"><span class="cls_006">will discuss the techniques used by software to manage the on-chip</span></div>
<div style="position:absolute;left:59.98px;top:238.67px" class="cls_006"><span class="cls_006">cache resources.</span></div>
<div style="position:absolute;left:59.98px;top:252.67px" class="cls_006"><span class="cls_006">In addition, techniques to determine the on-chip cache sizes will be</span></div>
<div style="position:absolute;left:59.98px;top:263.67px" class="cls_006"><span class="cls_006">shown (greatest flexibility is achieved if software can be written to be</span></div>
<div style="position:absolute;left:59.98px;top:274.67px" class="cls_006"><span class="cls_006">independent of cache sizes).</span></div>
<div style="position:absolute;left:59.98px;top:288.67px" class="cls_006"><span class="cls_006">For the diagnostics programmer, techniques to test the cache memory</span></div>
<div style="position:absolute;left:59.98px;top:299.67px" class="cls_006"><span class="cls_006">and probe for particular entries will be discussed.</span></div>
<div style="position:absolute;left:59.98px;top:313.67px" class="cls_006"><span class="cls_006">On  some  CPU  implementations  the  system  designer  may  make</span></div>
<div style="position:absolute;left:59.98px;top:324.67px" class="cls_006"><span class="cls_006">configuration choices about the cache (e.g. the R3081 and R3071</span></div>
<div style="position:absolute;left:59.98px;top:335.67px" class="cls_006"><span class="cls_006">allow the cache organization to be selected between 16kB of I-cache/</span></div>
<div style="position:absolute;left:59.98px;top:346.67px" class="cls_006"><span class="cls_006">4kB of D-cache and 8kB each of I- and D- cache). The cache</span></div>
<div style="position:absolute;left:59.98px;top:357.67px" class="cls_006"><span class="cls_006">management chapter will also discuss some of the considerations to</span></div>
<div style="position:absolute;left:59.98px;top:368.67px" class="cls_006"><span class="cls_006">apply to make a proper selection.</span></div>
<div style="position:absolute;left:48.03px;top:382.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:382.67px" class="cls_008"><span class="cls_008">Write buffer</span><span class="cls_006">: on R30xx family CPUs the D-cache is always </span><span class="cls_008">write</span></div>
<div style="position:absolute;left:59.98px;top:393.67px" class="cls_008"><span class="cls_008">through</span><span class="cls_006">; all writes go to main memory as well as the cache. This</span></div>
<div style="position:absolute;left:59.98px;top:404.67px" class="cls_006"><span class="cls_006">simplifies the caches, but main memory won’t be able to accept data</span></div>
<div style="position:absolute;left:59.98px;top:415.67px" class="cls_006"><span class="cls_006">as fast as the CPU can write it. Much of the performance loss can be</span></div>
<div style="position:absolute;left:59.98px;top:426.67px" class="cls_006"><span class="cls_006">made up by using a FIFO store which holds a number of ‘‘write cycles’’</span></div>
<div style="position:absolute;left:59.98px;top:437.67px" class="cls_006"><span class="cls_006">(it stores both address and data). In the R30xx family, this FIFO,</span></div>
<div style="position:absolute;left:59.98px;top:448.67px" class="cls_006"><span class="cls_006">called the write buffer, is integrated on-chip.</span></div>
<div style="position:absolute;left:59.98px;top:462.67px" class="cls_006"><span class="cls_006">System programmers may need to know that writes happen later than</span></div>
<div style="position:absolute;left:59.98px;top:473.67px" class="cls_006"><span class="cls_006">the code sequence suggests. The chapter on cache management</span></div>
<div style="position:absolute;left:59.98px;top:484.67px" class="cls_006"><span class="cls_006">discusses this.</span></div>
<div style="position:absolute;left:48.03px;top:498.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:498.67px" class="cls_008"><span class="cls_008">Starting up</span><span class="cls_006">: at reset almost nothing is defined, so the software must</span></div>
<div style="position:absolute;left:59.97px;top:509.67px" class="cls_006"><span class="cls_006">build carefully. In MIPS CPUs, reset is implemented in almost exactly</span></div>
<div style="position:absolute;left:59.97px;top:520.67px" class="cls_006"><span class="cls_006">the same way as the exceptions.</span></div>
<div style="position:absolute;left:59.97px;top:534.67px" class="cls_006"><span class="cls_006">A later chapter on reset initialization discusses ways of finding out</span></div>
<div style="position:absolute;left:59.97px;top:545.67px" class="cls_006"><span class="cls_006">which CPU is executing the software, and how to get a ROM program</span></div>
<div style="position:absolute;left:59.97px;top:556.67px" class="cls_006"><span class="cls_006">to run.</span></div>
<div style="position:absolute;left:59.97px;top:570.67px" class="cls_006"><span class="cls_006">An example of a C runtime environment, attending to the stack and</span></div>
<div style="position:absolute;left:59.97px;top:581.67px" class="cls_006"><span class="cls_006">special registers, is provided.</span></div>
<div style="position:absolute;left:48.02px;top:595.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:595.67px" class="cls_008"><span class="cls_008">Memory management and the TLB</span><span class="cls_006">: A later chapter will discuss</span></div>
<div style="position:absolute;left:59.98px;top:606.67px" class="cls_006"><span class="cls_006">address translation and managing the translation hardware (the</span></div>
<div style="position:absolute;left:59.98px;top:617.67px" class="cls_006"><span class="cls_006">TLB). This section is mostly for OS programmers.</span></div>
<div style="position:absolute;left:36.00px;top:640.00px" class="cls_015"><span class="cls_015">CPU CONTROL AND ‘‘CO-PROCESSOR 0’’</span></div>
<div style="position:absolute;left:36.00px;top:664.99px" class="cls_015"><span class="cls_015">CPU control instructions</span></div>
<div style="position:absolute;left:48.02px;top:678.67px" class="cls_006"><span class="cls_006">Most control functions are implemented with registers (most of which</span></div>
<div style="position:absolute;left:36.00px;top:689.67px" class="cls_006"><span class="cls_006">consist  of  multiple  bitfields).  The  MIPS  architecture  has  an  escape</span></div>
<div style="position:absolute;left:36.00px;top:700.67px" class="cls_006"><span class="cls_006">mechanism to define instructions for ‘‘co-processors’’ - and the CPU</span></div>
<div style="position:absolute;left:36.00px;top:711.67px" class="cls_006"><span class="cls_006">control instructions are coded for ‘‘co-processor 0’’.</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">3-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:28070px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">SYSTEM CONTROL CO-PROCESSOR ARCHITECTURE</span></div>
<div style="position:absolute;left:525.42px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 3</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">There  are  several  CPU  control  instructions  used  in  the  memory</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">management implementation, which are described in a later chapter. But</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_006"><span class="cls_006">leaving aside the MMU, CPU control defines just one instruction beyond</span></div>
<div style="position:absolute;left:216.00px;top:83.67px" class="cls_006"><span class="cls_006">the necessary move to and from the control registers.</span></div>
<div style="position:absolute;left:228.02px;top:94.67px" class="cls_006"><span class="cls_006">mtc0</span></div>
<div style="position:absolute;left:288.00px;top:94.67px" class="cls_008"><span class="cls_008">rs, &lt;nn></span></div>
<div style="position:absolute;left:360.01px;top:94.67px" class="cls_008"><span class="cls_008">-Move to co-processor zero</span></div>
<div style="position:absolute;left:216.00px;top:105.67px" class="cls_006"><span class="cls_006">Loads ‘‘co-processor 0’’ register number </span><span class="cls_008">nn </span><span class="cls_006">from CPU general register </span><span class="cls_008">rs</span><span class="cls_006">. It</span></div>
<div style="position:absolute;left:216.00px;top:116.67px" class="cls_006"><span class="cls_006">is unusual, and not good practice, to refer to CPU control registers by their</span></div>
<div style="position:absolute;left:216.00px;top:127.67px" class="cls_006"><span class="cls_006">number in assembler sources; normal practice is to use the names listed</span></div>
<div style="position:absolute;left:216.00px;top:138.67px" class="cls_006"><span class="cls_006">in Table 3.1, “Summary of CPU control registers (not MMU)”. In some tool-</span></div>
<div style="position:absolute;left:216.00px;top:149.67px" class="cls_006"><span class="cls_006">chains the names are defined by a C-style ‘‘include’’ file, and the C pre-</span></div>
<div style="position:absolute;left:216.00px;top:160.67px" class="cls_006"><span class="cls_006">processor run as a front-end to the assembler; the assembler manual</span></div>
<div style="position:absolute;left:216.00px;top:171.67px" class="cls_006"><span class="cls_006">should provide guidance on how to do this. This is the only way of setting</span></div>
<div style="position:absolute;left:216.00px;top:182.67px" class="cls_006"><span class="cls_006">bits in a CPU control register.</span></div>
<div style="position:absolute;left:228.02px;top:193.67px" class="cls_006"><span class="cls_006">mfc0</span></div>
<div style="position:absolute;left:288.00px;top:193.67px" class="cls_008"><span class="cls_008">rd, &lt;nn</span></div>
<div style="position:absolute;left:360.01px;top:193.67px" class="cls_008"><span class="cls_008">>-Move from co-processor zero</span></div>
<div style="position:absolute;left:216.00px;top:204.67px" class="cls_006"><span class="cls_006">General register </span><span class="cls_008">rd </span><span class="cls_006">is loaded with the values from CPU control register</span></div>
<div style="position:absolute;left:216.00px;top:215.67px" class="cls_006"><span class="cls_006">number </span><span class="cls_008">nn</span><span class="cls_006">. Once again, it is common to use a symbolic name and a</span></div>
<div style="position:absolute;left:216.00px;top:226.67px" class="cls_006"><span class="cls_006">macro-processor to save remembering the numbers. This is the only way</span></div>
<div style="position:absolute;left:216.00px;top:237.67px" class="cls_006"><span class="cls_006">of inspecting bits in a control register.</span></div>
<div style="position:absolute;left:228.02px;top:248.67px" class="cls_006"><span class="cls_006">rfe</span></div>
<div style="position:absolute;left:360.00px;top:248.67px" class="cls_008"><span class="cls_008">-Restore from exception</span></div>
<div style="position:absolute;left:216.00px;top:259.67px" class="cls_006"><span class="cls_006">Note that this is not ‘‘return from exception’’. This instruction restores the</span></div>
<div style="position:absolute;left:216.00px;top:270.67px" class="cls_006"><span class="cls_006">status register to go back to the state prior to the trap. To understand what</span></div>
<div style="position:absolute;left:216.00px;top:281.67px" class="cls_006"><span class="cls_006">it does, refer to the status register </span><span class="cls_008">SR</span><span class="cls_006"> defined later in this chapter. The only</span></div>
<div style="position:absolute;left:216.00px;top:292.67px" class="cls_006"><span class="cls_006">secure way of returning to user mode from an exception is to return with</span></div>
<div style="position:absolute;left:216.00px;top:303.67px" class="cls_006"><span class="cls_006">a </span><span class="cls_008">jr</span><span class="cls_006"> instruction which has the </span><span class="cls_008">rfe</span><span class="cls_006"> in its delay slot.</span></div>
<div style="position:absolute;left:216.00px;top:326.00px" class="cls_015"><span class="cls_015">Standard CPU control registers</span></div>
<div style="position:absolute;left:228.02px;top:339.67px" class="cls_006"><span class="cls_006">This table describes the general CPU control registers (ignoring the</span></div>
<div style="position:absolute;left:216.00px;top:350.67px" class="cls_006"><span class="cls_006">MMU control registers). Also note that typical convention is to reserve k0</span></div>
<div style="position:absolute;left:216.00px;top:361.67px" class="cls_006"><span class="cls_006">and k1 for exception processing, although they are proper GP registers of</span></div>
<div style="position:absolute;left:216.00px;top:372.67px" class="cls_006"><span class="cls_006">the integer CPU unit.</span></div>
<div style="position:absolute;left:249.75px;top:395.00px" class="cls_020"><span class="cls_020">Register</span></div>
<div style="position:absolute;left:377.25px;top:395.00px" class="cls_020"><span class="cls_020">Description</span></div>
<div style="position:absolute;left:522.21px;top:395.00px" class="cls_020"><span class="cls_020">CP0</span></div>
<div style="position:absolute;left:244.73px;top:405.00px" class="cls_020"><span class="cls_020">Mnemonic</span></div>
<div style="position:absolute;left:515.12px;top:405.00px" class="cls_020"><span class="cls_020">reg no.</span></div>
<div style="position:absolute;left:243.14px;top:424.00px" class="cls_020"><span class="cls_020">PRId</span></div>
<div style="position:absolute;left:303.19px;top:424.00px" class="cls_020"><span class="cls_020">CP0 type and rev level</span></div>
<div style="position:absolute;left:514.07px;top:424.00px" class="cls_020"><span class="cls_020">15</span></div>
<div style="position:absolute;left:243.14px;top:441.00px" class="cls_020"><span class="cls_020">SR</span></div>
<div style="position:absolute;left:303.15px;top:441.00px" class="cls_020"><span class="cls_020">(status register) CPU mode flags</span></div>
<div style="position:absolute;left:514.22px;top:441.00px" class="cls_020"><span class="cls_020">12</span></div>
<div style="position:absolute;left:243.14px;top:458.00px" class="cls_020"><span class="cls_020">Cause</span></div>
<div style="position:absolute;left:303.21px;top:458.00px" class="cls_020"><span class="cls_020">Describes the most recently recognized</span></div>
<div style="position:absolute;left:513.54px;top:458.00px" class="cls_020"><span class="cls_020">13</span></div>
<div style="position:absolute;left:303.09px;top:468.00px" class="cls_020"><span class="cls_020">exception</span></div>
<div style="position:absolute;left:243.14px;top:485.00px" class="cls_020"><span class="cls_020">EPC</span></div>
<div style="position:absolute;left:303.18px;top:485.00px" class="cls_020"><span class="cls_020">Return address from trap</span></div>
<div style="position:absolute;left:514.12px;top:485.00px" class="cls_020"><span class="cls_020">14</span></div>
<div style="position:absolute;left:243.14px;top:502.00px" class="cls_020"><span class="cls_020">BadVaddr     Contains the last invalid program address</span></div>
<div style="position:absolute;left:513.54px;top:502.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:303.09px;top:512.00px" class="cls_020"><span class="cls_020">which caused a trap. It is set by address</span></div>
<div style="position:absolute;left:303.09px;top:522.00px" class="cls_020"><span class="cls_020">errors of all kinds, even if there is no MMU</span></div>
<div style="position:absolute;left:243.14px;top:539.00px" class="cls_020"><span class="cls_020">Config</span></div>
<div style="position:absolute;left:303.21px;top:539.00px" class="cls_020"><span class="cls_020">CPU configuration (R3081 and R3041 only)</span></div>
<div style="position:absolute;left:514.48px;top:539.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:243.14px;top:556.00px" class="cls_020"><span class="cls_020">BusCtrl</span></div>
<div style="position:absolute;left:303.24px;top:556.00px" class="cls_020"><span class="cls_020">(R3041 only) configure bus interface signals.</span></div>
<div style="position:absolute;left:513.54px;top:556.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:303.09px;top:566.00px" class="cls_020"><span class="cls_020">Needs to be setup to match the hardware</span></div>
<div style="position:absolute;left:303.09px;top:576.00px" class="cls_020"><span class="cls_020">implementation.</span></div>
<div style="position:absolute;left:243.14px;top:593.00px" class="cls_020"><span class="cls_020">PortSize</span></div>
<div style="position:absolute;left:303.25px;top:593.00px" class="cls_020"><span class="cls_020">(R3041 only) used to flag some program</span></div>
<div style="position:absolute;left:513.54px;top:593.00px" class="cls_020"><span class="cls_020">10</span></div>
<div style="position:absolute;left:303.09px;top:603.00px" class="cls_020"><span class="cls_020">address regions as 8- or 16-bits wide. Must be</span></div>
<div style="position:absolute;left:303.09px;top:613.00px" class="cls_020"><span class="cls_020">programmed to match the hardware</span></div>
<div style="position:absolute;left:303.09px;top:623.00px" class="cls_020"><span class="cls_020">implementation.</span></div>
<div style="position:absolute;left:243.14px;top:640.00px" class="cls_020"><span class="cls_020">Count</span></div>
<div style="position:absolute;left:303.20px;top:640.00px" class="cls_020"><span class="cls_020">(R3041 only, read/write) a 24-bit counter</span></div>
<div style="position:absolute;left:513.54px;top:640.00px" class="cls_020"><span class="cls_020">9</span></div>
<div style="position:absolute;left:303.09px;top:650.00px" class="cls_020"><span class="cls_020">incrementing with the CPU clock.</span></div>
<div style="position:absolute;left:243.14px;top:667.00px" class="cls_020"><span class="cls_020">Compare</span></div>
<div style="position:absolute;left:303.26px;top:667.00px" class="cls_020"><span class="cls_020">(R3041 only, read/write) a 24-bit value used</span></div>
<div style="position:absolute;left:513.54px;top:667.00px" class="cls_020"><span class="cls_020">11</span></div>
<div style="position:absolute;left:303.09px;top:677.00px" class="cls_020"><span class="cls_020">to wraparound the </span><span class="cls_027">Count</span><span class="cls_020"> value and set an</span></div>
<div style="position:absolute;left:303.08px;top:687.00px" class="cls_020"><span class="cls_020">output signal.</span></div>
<div style="position:absolute;left:264.97px;top:706.00px" class="cls_020"><span class="cls_020">Table 3.1.  Summary of CPU control registers (not MMU)</span></div>
<div style="position:absolute;left:305.78px;top:755.33px" class="cls_002"><span class="cls_002">3-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:28872px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 3</span></div>
<div style="position:absolute;left:327.88px;top:28.00px" class="cls_002"><span class="cls_002">SYSTEM CONTROL CO-PROCESSOR ARCHITECTURE</span></div>
<div style="position:absolute;left:42.00px;top:54.00px" class="cls_020"><span class="cls_020">Encoding of control registers</span></div>
<div style="position:absolute;left:42.00px;top:69.00px" class="cls_020"><span class="cls_020">The next section describes the format of the control registers, with a</span></div>
<div style="position:absolute;left:42.00px;top:79.00px" class="cls_020"><span class="cls_020">sketch of the function of each field. In most cases, more information</span></div>
<div style="position:absolute;left:42.00px;top:89.00px" class="cls_020"><span class="cls_020">about how things work is to be found in separate sections or chapters</span></div>
<div style="position:absolute;left:42.00px;top:99.00px" class="cls_020"><span class="cls_020">later.</span></div>
<div style="position:absolute;left:42.00px;top:114.00px" class="cls_020"><span class="cls_020">A note about reserved fields is in order here. Many unused control</span></div>
<div style="position:absolute;left:42.00px;top:124.00px" class="cls_020"><span class="cls_020">register fields are marked ‘‘0’’. Bits in such fields are guaranteed to read</span></div>
<div style="position:absolute;left:42.00px;top:134.00px" class="cls_020"><span class="cls_020">zero, and should be written as zero. Other reserved fields are marked</span></div>
<div style="position:absolute;left:42.00px;top:144.00px" class="cls_020"><span class="cls_020">‘‘reserved’’ or ‘‘</span><span class="cls_021">×</span><span class="cls_020">’’; software must always write them as zero, and should</span></div>
<div style="position:absolute;left:42.00px;top:154.00px" class="cls_020"><span class="cls_020">not assume that it will get back zero or any other particular value.</span></div>
<div style="position:absolute;left:42.00px;top:169.00px" class="cls_020"><span class="cls_020">Registers specific to the memory management system are described in a</span></div>
<div style="position:absolute;left:42.00px;top:179.00px" class="cls_020"><span class="cls_020">later chapter.</span></div>
<div style="position:absolute;left:36.00px;top:200.67px" class="cls_006"><span class="cls_006">PRId Register</span></div>
<div style="position:absolute;left:40.00px;top:232.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:175.07px;top:232.00px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:220.13px;top:232.00px" class="cls_020"><span class="cls_020">15</span></div>
<div style="position:absolute;left:265.19px;top:232.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:310.23px;top:232.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:355.26px;top:232.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:40.00px;top:252.00px" class="cls_027"><span class="cls_027">reserved</span></div>
<div style="position:absolute;left:220.01px;top:252.00px" class="cls_020"><span class="cls_020">Imp</span></div>
<div style="position:absolute;left:310.10px;top:252.00px" class="cls_020"><span class="cls_020">Rev</span></div>
<div style="position:absolute;left:139.95px;top:271.00px" class="cls_020"><span class="cls_020">Figure 3.1.   PRId Register fields</span></div>
<div style="position:absolute;left:48.02px;top:286.67px" class="cls_006"><span class="cls_006">Figure 3.1, “PRId Register fields” shows the layout of the </span><span class="cls_008">PRId</span><span class="cls_006"> register,</span></div>
<div style="position:absolute;left:36.00px;top:297.67px" class="cls_006"><span class="cls_006">a read-only register to be consulted to identify the CPU type</span></div>
<div style="position:absolute;left:368.45px;top:297.67px" class="cls_006"><span class="cls_006">(more</span></div>
<div style="position:absolute;left:36.00px;top:308.67px" class="cls_006"><span class="cls_006">properly, this register describes CP0, allowing the kernel to dynamically</span></div>
<div style="position:absolute;left:36.00px;top:319.67px" class="cls_006"><span class="cls_006">configure itself for various CPU implementations). ‘‘Imp’’ should be related</span></div>
<div style="position:absolute;left:36.00px;top:330.67px" class="cls_006"><span class="cls_006">to the CPU control register set. The encoding of Imp is described below:</span></div>
<div style="position:absolute;left:134.62px;top:351.00px" class="cls_020"><span class="cls_020">CPU type</span></div>
<div style="position:absolute;left:243.46px;top:351.00px" class="cls_020"><span class="cls_020">‘‘Imp’’ value</span></div>
<div style="position:absolute;left:134.62px;top:368.00px" class="cls_020"><span class="cls_020">R3000A (including</span></div>
<div style="position:absolute;left:243.27px;top:368.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:134.62px;top:378.00px" class="cls_020"><span class="cls_020">R3051, R3052, R3071,</span></div>
<div style="position:absolute;left:134.62px;top:388.00px" class="cls_020"><span class="cls_020">and R3081)</span></div>
<div style="position:absolute;left:134.62px;top:405.00px" class="cls_020"><span class="cls_020">IDT unique (R3041)</span></div>
<div style="position:absolute;left:243.63px;top:405.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:48.02px;top:424.67px" class="cls_006"><span class="cls_006">Note that when the Imp field indicates IDT unique, the revision number</span></div>
<div style="position:absolute;left:36.00px;top:435.67px" class="cls_006"><span class="cls_006">can be used to distinguish among various CP0 implementations. Refer to</span></div>
<div style="position:absolute;left:36.00px;top:446.67px" class="cls_006"><span class="cls_006">the R3041 User’s manual for the revision level appropriate for that device.</span></div>
<div style="position:absolute;left:36.00px;top:457.67px" class="cls_006"><span class="cls_006">Since the R3051, 52, 71, and 81 are kernel compatible with the R3000A,</span></div>
<div style="position:absolute;left:36.00px;top:468.67px" class="cls_006"><span class="cls_006">they share the same Imp value.</span></div>
<div style="position:absolute;left:48.02px;top:479.67px" class="cls_006"><span class="cls_006">When printing the value of this register, it is conventional to print them</span></div>
<div style="position:absolute;left:36.00px;top:490.67px" class="cls_006"><span class="cls_006">out as ‘‘x.y’’ where ‘‘x’’ and ‘‘y’’ are the decimal values of Imp and Rev</span></div>
<div style="position:absolute;left:36.00px;top:501.67px" class="cls_006"><span class="cls_006">respectively. Try not to use this register and the CPU manuals to size</span></div>
<div style="position:absolute;left:36.00px;top:512.67px" class="cls_006"><span class="cls_006">things, or to establish the presence or absence of particular features;</span></div>
<div style="position:absolute;left:36.00px;top:523.67px" class="cls_006"><span class="cls_006">software will be more portable and robust if it is designed to include code</span></div>
<div style="position:absolute;left:36.00px;top:534.67px" class="cls_006"><span class="cls_006">sequences to probe for the existence of individual features. This manual</span></div>
<div style="position:absolute;left:36.00px;top:545.67px" class="cls_006"><span class="cls_006">will  provide  numerous  examples  designed  to  determine  cache  sizes,</span></div>
<div style="position:absolute;left:36.00px;top:556.67px" class="cls_006"><span class="cls_006">presence or absence of TLB, FPA, etc.</span></div>
<div style="position:absolute;left:36.00px;top:577.67px" class="cls_006"><span class="cls_006">SR Register</span></div>
<div style="position:absolute;left:44.84px;top:609.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:73.71px;top:609.00px" class="cls_020"><span class="cls_020">30</span></div>
<div style="position:absolute;left:102.57px;top:609.00px" class="cls_020"><span class="cls_020">29</span></div>
<div style="position:absolute;left:131.43px;top:609.00px" class="cls_020"><span class="cls_020">28</span></div>
<div style="position:absolute;left:160.29px;top:609.00px" class="cls_020"><span class="cls_020">27</span></div>
<div style="position:absolute;left:189.16px;top:609.00px" class="cls_020"><span class="cls_020">26</span></div>
<div style="position:absolute;left:218.02px;top:609.00px" class="cls_020"><span class="cls_020">25</span></div>
<div style="position:absolute;left:246.88px;top:609.00px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:275.75px;top:609.00px" class="cls_020"><span class="cls_020">23</span></div>
<div style="position:absolute;left:304.61px;top:609.00px" class="cls_020"><span class="cls_020">22</span></div>
<div style="position:absolute;left:333.47px;top:609.00px" class="cls_020"><span class="cls_020">21</span></div>
<div style="position:absolute;left:362.34px;top:609.00px" class="cls_020"><span class="cls_020">20</span></div>
<div style="position:absolute;left:391.20px;top:609.00px" class="cls_020"><span class="cls_020">19</span></div>
<div style="position:absolute;left:420.06px;top:609.00px" class="cls_020"><span class="cls_020">18</span></div>
<div style="position:absolute;left:448.92px;top:609.00px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:477.79px;top:609.00px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:40.81px;top:626.00px" class="cls_020"><span class="cls_020">CU3</span></div>
<div style="position:absolute;left:69.69px;top:626.00px" class="cls_020"><span class="cls_020">CU2</span></div>
<div style="position:absolute;left:98.57px;top:626.00px" class="cls_020"><span class="cls_020">CU1</span></div>
<div style="position:absolute;left:127.46px;top:626.00px" class="cls_020"><span class="cls_020">CU0</span></div>
<div style="position:absolute;left:177.57px;top:626.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:217.13px;top:626.00px" class="cls_020"><span class="cls_020">RE</span></div>
<div style="position:absolute;left:264.07px;top:626.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:300.41px;top:626.00px" class="cls_020"><span class="cls_020">BEV</span></div>
<div style="position:absolute;left:333.24px;top:626.00px" class="cls_020"><span class="cls_020">TS</span></div>
<div style="position:absolute;left:361.83px;top:626.00px" class="cls_020"><span class="cls_020">PE</span></div>
<div style="position:absolute;left:389.26px;top:626.00px" class="cls_020"><span class="cls_020">CM</span></div>
<div style="position:absolute;left:419.92px;top:626.00px" class="cls_020"><span class="cls_020">PZ</span></div>
<div style="position:absolute;left:444.65px;top:626.00px" class="cls_020"><span class="cls_020">SwC</span></div>
<div style="position:absolute;left:476.14px;top:626.00px" class="cls_020"><span class="cls_020">IsC</span></div>
<div style="position:absolute;left:44.84px;top:660.01px" class="cls_020"><span class="cls_020">15</span></div>
<div style="position:absolute;left:249.28px;top:660.01px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:278.11px;top:660.01px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:306.94px;top:660.01px" class="cls_020"><span class="cls_020">6</span></div>
<div style="position:absolute;left:335.78px;top:660.01px" class="cls_020"><span class="cls_020">5</span></div>
<div style="position:absolute;left:364.61px;top:660.01px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:393.45px;top:660.01px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:422.29px;top:660.01px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:451.12px;top:660.01px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:479.96px;top:660.01px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:145.55px;top:677.01px" class="cls_020"><span class="cls_020">IM</span></div>
<div style="position:absolute;left:292.48px;top:677.01px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:329.26px;top:677.01px" class="cls_020"><span class="cls_020">KUo</span></div>
<div style="position:absolute;left:360.12px;top:677.01px" class="cls_020"><span class="cls_020">IEo</span></div>
<div style="position:absolute;left:386.75px;top:677.01px" class="cls_020"><span class="cls_020">KUp</span></div>
<div style="position:absolute;left:417.61px;top:677.01px" class="cls_020"><span class="cls_020">IEp</span></div>
<div style="position:absolute;left:444.96px;top:677.01px" class="cls_020"><span class="cls_020">KUc</span></div>
<div style="position:absolute;left:475.83px;top:677.01px" class="cls_020"><span class="cls_020">IEc</span></div>
<div style="position:absolute;left:170.23px;top:696.00px" class="cls_020"><span class="cls_020">Figure 3.2.   Fields in status register (SR)</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">3-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:29674px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">SYSTEM CONTROL CO-PROCESSOR ARCHITECTURE</span></div>
<div style="position:absolute;left:525.41px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 3</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">The MIPS CPU has remarkably few mode bits; those that exist are</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">defined by fields in the CPU status register </span><span class="cls_008">SR,</span><span class="cls_006"> as shown in Figure 3.2,</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_006"><span class="cls_006">“Fields in status register (SR)”.</span></div>
<div style="position:absolute;left:228.02px;top:83.67px" class="cls_006"><span class="cls_006">Note that there are no modes such as non-translated or non-cached in</span></div>
<div style="position:absolute;left:216.00px;top:94.67px" class="cls_006"><span class="cls_006">MIPS CPUs; all translation and caching decisions are made on the basis of</span></div>
<div style="position:absolute;left:216.00px;top:105.67px" class="cls_006"><span class="cls_006">the program address. Fields are:</span></div>
<div style="position:absolute;left:228.02px;top:119.67px" class="cls_006"><span class="cls_006">CU3,</span></div>
<div style="position:absolute;left:228.02px;top:133.67px" class="cls_006"><span class="cls_006">CU2</span></div>
<div style="position:absolute;left:264.02px;top:133.67px" class="cls_006"><span class="cls_006">Bits (31:30) control the usability of ‘‘co-processors’’ 3 and 2</span></div>
<div style="position:absolute;left:264.02px;top:144.67px" class="cls_006"><span class="cls_006">respectively. In the R30xx family, these might be enabled if</span></div>
<div style="position:absolute;left:264.02px;top:155.67px" class="cls_006"><span class="cls_006">software wishes to use the BrCond(3:2) input pins for polling, or</span></div>
<div style="position:absolute;left:264.02px;top:166.67px" class="cls_006"><span class="cls_006">to speed exception decoding.</span></div>
<div style="position:absolute;left:228.02px;top:180.67px" class="cls_006"><span class="cls_006">CU1</span></div>
<div style="position:absolute;left:264.02px;top:180.67px" class="cls_006"><span class="cls_006">‘‘co-processor 1 usable’’: 1 to use FPA if present, 0 to disable.</span></div>
<div style="position:absolute;left:264.02px;top:191.67px" class="cls_006"><span class="cls_006">When 0, all FPA instructions cause an exception, even for the</span></div>
<div style="position:absolute;left:264.02px;top:202.67px" class="cls_006"><span class="cls_006">kernel. It can be useful to turn off an FPA even when one is</span></div>
<div style="position:absolute;left:264.02px;top:213.67px" class="cls_006"><span class="cls_006">available; it may also be enabled in devices which do not include</span></div>
<div style="position:absolute;left:264.02px;top:224.67px" class="cls_006"><span class="cls_006">an FPA, if the intent is to use the BrCond(1) pin as a polled input.</span></div>
<div style="position:absolute;left:228.02px;top:238.67px" class="cls_006"><span class="cls_006">CU0</span></div>
<div style="position:absolute;left:264.02px;top:238.67px" class="cls_006"><span class="cls_006">‘‘co-processor 0 usable’’: set 1 to be able to use some nominally-</span></div>
<div style="position:absolute;left:264.02px;top:249.67px" class="cls_006"><span class="cls_006">privileged instructions in user mode (this is rarely if ever done).</span></div>
<div style="position:absolute;left:264.02px;top:260.67px" class="cls_006"><span class="cls_006">The CPU control instructions encoded as ‘‘co-processor 0’’ type</span></div>
<div style="position:absolute;left:264.02px;top:271.67px" class="cls_006"><span class="cls_006">are always usable in kernel mode, regardless of the setting of this</span></div>
<div style="position:absolute;left:264.02px;top:282.67px" class="cls_006"><span class="cls_006">bit.</span></div>
<div style="position:absolute;left:228.02px;top:296.67px" class="cls_006"><span class="cls_006">RE</span></div>
<div style="position:absolute;left:264.02px;top:296.67px" class="cls_006"><span class="cls_006">‘‘reverse endianness in user mode’’. The MIPS processors can be</span></div>
<div style="position:absolute;left:264.02px;top:307.67px" class="cls_006"><span class="cls_006">configured, at reset time, with either ‘‘endianness’’ (byte ordering</span></div>
<div style="position:absolute;left:264.02px;top:318.67px" class="cls_006"><span class="cls_006">convention, discussed in the various CPU’s User’s Manuals and</span></div>
<div style="position:absolute;left:264.02px;top:329.67px" class="cls_006"><span class="cls_006">later in this manual). The RE bit allows binaries intended to be</span></div>
<div style="position:absolute;left:264.02px;top:340.67px" class="cls_006"><span class="cls_006">run with one byte ordering convention to be run in systems with</span></div>
<div style="position:absolute;left:264.02px;top:351.67px" class="cls_006"><span class="cls_006">the opposite convention, presuming OS software provided the</span></div>
<div style="position:absolute;left:264.02px;top:362.67px" class="cls_006"><span class="cls_006">necessary support.</span></div>
<div style="position:absolute;left:264.02px;top:376.67px" class="cls_006"><span class="cls_006">When RE is active, user-privilege software runs as if the CPU had</span></div>
<div style="position:absolute;left:264.02px;top:387.67px" class="cls_006"><span class="cls_006">been configured with the opposite endianness.</span></div>
<div style="position:absolute;left:264.02px;top:401.67px" class="cls_006"><span class="cls_006">However, achieving cross-universe running would require a large</span></div>
<div style="position:absolute;left:264.02px;top:412.67px" class="cls_006"><span class="cls_006">software effort as well, and should not be necessary in embedded</span></div>
<div style="position:absolute;left:264.02px;top:423.67px" class="cls_006"><span class="cls_006">systems.</span></div>
<div style="position:absolute;left:228.02px;top:437.67px" class="cls_006"><span class="cls_006">BEV</span></div>
<div style="position:absolute;left:264.02px;top:437.67px" class="cls_006"><span class="cls_006">‘‘boot exception vectors’’: when BEV == 1, the CPU uses the ROM</span></div>
<div style="position:absolute;left:264.02px;top:448.67px" class="cls_006"><span class="cls_006">(kseg1) space exception entry point (described in a later chapter).</span></div>
<div style="position:absolute;left:264.02px;top:459.67px" class="cls_006"><span class="cls_006">BEV is usually set to zero in running systems; this relocates the</span></div>
<div style="position:absolute;left:264.02px;top:470.67px" class="cls_006"><span class="cls_006">exception vectors. to RAM addresses, speeding accesses and</span></div>
<div style="position:absolute;left:264.02px;top:481.67px" class="cls_006"><span class="cls_006">allowing the use of “user supplied” exception service routines.</span></div>
<div style="position:absolute;left:228.02px;top:495.67px" class="cls_006"><span class="cls_006">TS</span></div>
<div style="position:absolute;left:264.02px;top:495.67px" class="cls_006"><span class="cls_006">‘‘TLB shutdown’’: In devices which implement the full R3000A</span></div>
<div style="position:absolute;left:264.02px;top:506.67px" class="cls_006"><span class="cls_006">MMU, TS gets set if a program address simultaneously matches</span></div>
<div style="position:absolute;left:264.02px;top:517.67px" class="cls_006"><span class="cls_006">two TLB entries. Prolonged operation in this state, in some</span></div>
<div style="position:absolute;left:264.02px;top:528.67px" class="cls_006"><span class="cls_006">implementations, could cause internal contention and damage</span></div>
<div style="position:absolute;left:264.02px;top:539.67px" class="cls_006"><span class="cls_006">to the chip. TLB shutdown is terminal, and can be cleared only</span></div>
<div style="position:absolute;left:264.02px;top:550.67px" class="cls_006"><span class="cls_006">by a hardware reset.</span></div>
<div style="position:absolute;left:264.02px;top:564.67px" class="cls_006"><span class="cls_006">In base family members, which do not include the TLB, this bit</span></div>
<div style="position:absolute;left:264.02px;top:575.67px" class="cls_006"><span class="cls_006">is set by reset; software can rely on this feature to determine the</span></div>
<div style="position:absolute;left:264.02px;top:586.67px" class="cls_006"><span class="cls_006">presence or absence of TLB support hardware.</span></div>
<div style="position:absolute;left:228.02px;top:600.67px" class="cls_006"><span class="cls_006">PE</span></div>
<div style="position:absolute;left:264.02px;top:600.67px" class="cls_006"><span class="cls_006">set  if  a  cache  parity  error  has  occurred.  No  exception  is</span></div>
<div style="position:absolute;left:264.02px;top:611.67px" class="cls_006"><span class="cls_006">generated by this condition, which is really only useful for</span></div>
<div style="position:absolute;left:264.02px;top:622.67px" class="cls_006"><span class="cls_006">diagnostics.   The   MIPS   architecture   has   cache   diagnostic</span></div>
<div style="position:absolute;left:264.02px;top:633.67px" class="cls_006"><span class="cls_006">facilities because earlier versions of the CPU used external</span></div>
<div style="position:absolute;left:264.02px;top:644.67px" class="cls_006"><span class="cls_006">caches, and this provided a way to verify the timing of a</span></div>
<div style="position:absolute;left:264.02px;top:655.67px" class="cls_006"><span class="cls_006">particular system. For those implementations the cache parity</span></div>
<div style="position:absolute;left:264.02px;top:666.67px" class="cls_006"><span class="cls_006">error bit was an essential design debug tool.</span></div>
<div style="position:absolute;left:264.02px;top:680.67px" class="cls_006"><span class="cls_006">For CPUs with on-chip caches this feature is rarely needed; only</span></div>
<div style="position:absolute;left:264.02px;top:691.67px" class="cls_006"><span class="cls_006">the R3071 and R3081 implement parity over the on-chip caches.</span></div>
<div style="position:absolute;left:305.78px;top:755.33px" class="cls_002"><span class="cls_002">3-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:30476px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 3</span></div>
<div style="position:absolute;left:327.88px;top:28.00px" class="cls_002"><span class="cls_002">SYSTEM CONTROL CO-PROCESSOR ARCHITECTURE</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">CM</span></div>
<div style="position:absolute;left:84.02px;top:50.67px" class="cls_006"><span class="cls_006">shows the result of the last load operation performed with the D-</span></div>
<div style="position:absolute;left:84.02px;top:61.67px" class="cls_006"><span class="cls_006">cache isolated (described in the chapter on cache management).</span></div>
<div style="position:absolute;left:84.02px;top:72.67px" class="cls_006"><span class="cls_006">CM is set if the cache really contained data for the addressed</span></div>
<div style="position:absolute;left:84.02px;top:83.67px" class="cls_006"><span class="cls_006">memory location (i.e. if the load would have hit in the cache even</span></div>
<div style="position:absolute;left:84.02px;top:94.67px" class="cls_006"><span class="cls_006">if the cache had not been isolated).</span></div>
<div style="position:absolute;left:48.02px;top:108.67px" class="cls_006"><span class="cls_006">PZ</span></div>
<div style="position:absolute;left:84.02px;top:108.67px" class="cls_006"><span class="cls_006">When set, cache parity bits are written as zero and not checked.</span></div>
<div style="position:absolute;left:84.02px;top:119.67px" class="cls_006"><span class="cls_006">This was useful in old R3000A systems which required external</span></div>
<div style="position:absolute;left:84.02px;top:130.67px" class="cls_006"><span class="cls_006">cache RAMs, but is of little relevance to the R30xx family.</span></div>
<div style="position:absolute;left:48.02px;top:144.67px" class="cls_006"><span class="cls_006">SwC,</span></div>
<div style="position:absolute;left:48.02px;top:158.67px" class="cls_006"><span class="cls_006">IsC</span></div>
<div style="position:absolute;left:84.02px;top:158.67px" class="cls_006"><span class="cls_006">‘‘swap caches’’ and ‘‘isolate (data) cache’’. Cache mode bits for</span></div>
<div style="position:absolute;left:84.02px;top:169.67px" class="cls_006"><span class="cls_006">cache management and diagnostics; their use is described in</span></div>
<div style="position:absolute;left:84.02px;top:180.67px" class="cls_006"><span class="cls_006">detail in a later chapter on cache management. In simple terms:</span></div>
<div style="position:absolute;left:99.00px;top:194.67px" class="cls_006"><span class="cls_006">•   IsC set 1: makes all loads and stores access only the data</span></div>
<div style="position:absolute;left:117.00px;top:205.67px" class="cls_006"><span class="cls_006">cache, and never memory; and in this mode a partial-</span></div>
<div style="position:absolute;left:117.00px;top:216.67px" class="cls_006"><span class="cls_006">word store invalidates the cache entry. Note that when</span></div>
<div style="position:absolute;left:117.00px;top:227.67px" class="cls_006"><span class="cls_006">this bit is set, even uncached data accesses will not be</span></div>
<div style="position:absolute;left:117.00px;top:238.67px" class="cls_006"><span class="cls_006">seen on the bus; further, this bit is not initialized by reset.</span></div>
<div style="position:absolute;left:117.00px;top:249.67px" class="cls_006"><span class="cls_006">Boot-up   software   must   insure   this   bit   is   properly</span></div>
<div style="position:absolute;left:117.00px;top:260.67px" class="cls_006"><span class="cls_006">initialized before relying on external data references.</span></div>
<div style="position:absolute;left:99.00px;top:274.67px" class="cls_006"><span class="cls_006">•   SwC set 1: reverses the roles of the I-cache and D-cache,</span></div>
<div style="position:absolute;left:117.00px;top:285.67px" class="cls_006"><span class="cls_006">so that software can access and invalidate I-cache entries.</span></div>
<div style="position:absolute;left:48.02px;top:299.67px" class="cls_006"><span class="cls_006">IM</span></div>
<div style="position:absolute;left:84.02px;top:299.67px" class="cls_006"><span class="cls_006">‘‘interrupt mask’’: an 8 bit field defining which interrupt sources,</span></div>
<div style="position:absolute;left:84.02px;top:310.67px" class="cls_006"><span class="cls_006">when active, will be allowed to cause an exception. Six of the</span></div>
<div style="position:absolute;left:84.02px;top:321.67px" class="cls_006"><span class="cls_006">interrupt sources are external pins (one may be used by the FPA,</span></div>
<div style="position:absolute;left:84.02px;top:332.67px" class="cls_006"><span class="cls_006">which although it lives on the same chip is logically external); the</span></div>
<div style="position:absolute;left:84.02px;top:343.67px" class="cls_006"><span class="cls_006">other two are the software-writable interrupt bits in the </span><span class="cls_008">Cause</span></div>
<div style="position:absolute;left:84.02px;top:354.67px" class="cls_006"><span class="cls_006">register.</span></div>
<div style="position:absolute;left:84.02px;top:368.67px" class="cls_006"><span class="cls_006">No interrupt prioritization is provided by the CPU: the hardware</span></div>
<div style="position:absolute;left:84.02px;top:379.67px" class="cls_006"><span class="cls_006">treats all interrupt bits the same. This is described in greater</span></div>
<div style="position:absolute;left:84.02px;top:390.67px" class="cls_006"><span class="cls_006">detail in the chapter dealing with exceptions.</span></div>
<div style="position:absolute;left:48.02px;top:404.67px" class="cls_006"><span class="cls_006">KUc,</span></div>
<div style="position:absolute;left:48.02px;top:418.67px" class="cls_006"><span class="cls_006">IEc</span></div>
<div style="position:absolute;left:84.02px;top:418.67px" class="cls_006"><span class="cls_006">The two basic CPU protection bits.</span></div>
<div style="position:absolute;left:84.02px;top:432.67px" class="cls_006"><span class="cls_006">KUc is set 1 when running with kernel privileges, 0 for user</span></div>
<div style="position:absolute;left:84.02px;top:443.67px" class="cls_006"><span class="cls_006">mode. In kernel mode, software can get at the whole program</span></div>
<div style="position:absolute;left:84.02px;top:454.67px" class="cls_006"><span class="cls_006">address   space,   and   use   privileged</span></div>
<div style="position:absolute;left:300.32px;top:454.67px" class="cls_006"><span class="cls_006">(‘‘co-processor</span></div>
<div style="position:absolute;left:382.46px;top:454.67px" class="cls_006"><span class="cls_006">0’’)</span></div>
<div style="position:absolute;left:84.02px;top:465.67px" class="cls_006"><span class="cls_006">instructions. User mode restricts software to program addresses</span></div>
<div style="position:absolute;left:84.02px;top:476.67px" class="cls_006"><span class="cls_006">between 0x0000 0000 and </span><span class="cls_029">0x7FFF FFFF</span><span class="cls_006">, and can be denied</span></div>
<div style="position:absolute;left:84.02px;top:487.67px" class="cls_006"><span class="cls_006">permission to run privileged instructions; attempts to break the</span></div>
<div style="position:absolute;left:84.02px;top:498.67px" class="cls_006"><span class="cls_006">rules result in an exception.</span></div>
<div style="position:absolute;left:84.02px;top:512.67px" class="cls_006"><span class="cls_006">IEc is set 0 to prevent the CPU taking any interrupt, 1 to enable.</span></div>
<div style="position:absolute;left:48.02px;top:526.67px" class="cls_006"><span class="cls_006">KUp, IEp‘‘KU previous, IE previous’’:</span></div>
<div style="position:absolute;left:84.02px;top:540.67px" class="cls_006"><span class="cls_006">on an exception, the hardware takes the values of KUc and IEc</span></div>
<div style="position:absolute;left:84.02px;top:551.67px" class="cls_006"><span class="cls_006">and saves them here; at the same time as changing the values of</span></div>
<div style="position:absolute;left:84.02px;top:562.67px" class="cls_006"><span class="cls_006">KUc,  IEc  to</span></div>
<div style="position:absolute;left:155.51px;top:562.67px" class="cls_006"><span class="cls_006">[1, 0]</span></div>
<div style="position:absolute;left:187.94px;top:562.67px" class="cls_006"><span class="cls_006">(kernel  mode,  interrupts  disabled).  The</span></div>
<div style="position:absolute;left:84.02px;top:573.67px" class="cls_006"><span class="cls_006">instruction </span><span class="cls_008">rfe</span><span class="cls_006"> can be used to copy KUp, IEp back into KUc, IEc.</span></div>
<div style="position:absolute;left:48.02px;top:587.67px" class="cls_006"><span class="cls_006">KUo, IEo‘‘KU old, IE old’’:</span></div>
<div style="position:absolute;left:84.02px;top:601.67px" class="cls_006"><span class="cls_006">on an exception the KUp, IEp bits are saved here. Effectively, the</span></div>
<div style="position:absolute;left:84.02px;top:612.67px" class="cls_006"><span class="cls_006">six KU/IE bits are operated as a 3-deep, 2-bit wide stack which</span></div>
<div style="position:absolute;left:84.02px;top:623.67px" class="cls_006"><span class="cls_006">is pushed on an exception and popped by an </span><span class="cls_008">rfe</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:84.02px;top:637.67px" class="cls_006"><span class="cls_006">This provides a chance of recovering cleanly from an exception</span></div>
<div style="position:absolute;left:84.02px;top:648.67px" class="cls_006"><span class="cls_006">occurring so early in an exception handling routine that the first</span></div>
<div style="position:absolute;left:84.02px;top:659.67px" class="cls_006"><span class="cls_006">exception has not yet saved </span><span class="cls_008">SR.</span><span class="cls_006"> The circumstances in which this</span></div>
<div style="position:absolute;left:84.02px;top:670.67px" class="cls_006"><span class="cls_006">can be done are limited, and it is probably only really of use in</span></div>
<div style="position:absolute;left:84.02px;top:681.67px" class="cls_006"><span class="cls_006">allowing the user TLB refill code to be made a little shorter, as</span></div>
<div style="position:absolute;left:84.02px;top:692.67px" class="cls_006"><span class="cls_006">described in the chapter on memory management.</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">3-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:31278px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">SYSTEM CONTROL CO-PROCESSOR ARCHITECTURE</span></div>
<div style="position:absolute;left:525.41px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 3</span></div>
<div style="position:absolute;left:216.00px;top:50.67px" class="cls_006"><span class="cls_006">Cause Register</span></div>
<div style="position:absolute;left:220.00px;top:82.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:246.93px;top:82.00px" class="cls_020"><span class="cls_020">30</span></div>
<div style="position:absolute;left:283.14px;top:82.00px" class="cls_020"><span class="cls_020">29</span></div>
<div style="position:absolute;left:319.36px;top:82.00px" class="cls_020"><span class="cls_020">28</span></div>
<div style="position:absolute;left:343.35px;top:82.00px" class="cls_020"><span class="cls_020">27</span></div>
<div style="position:absolute;left:391.55px;top:82.00px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:415.54px;top:82.00px" class="cls_020"><span class="cls_020">15</span></div>
<div style="position:absolute;left:457.71px;top:82.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:475.63px;top:82.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:493.55px;top:82.00px" class="cls_020"><span class="cls_020">6</span></div>
<div style="position:absolute;left:529.74px;top:82.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:547.66px;top:82.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:562.73px;top:82.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:220.00px;top:99.00px" class="cls_020"><span class="cls_020">BD</span></div>
<div style="position:absolute;left:246.94px;top:99.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:283.14px;top:99.00px" class="cls_020"><span class="cls_020">CE</span></div>
<div style="position:absolute;left:343.29px;top:99.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:415.40px;top:99.00px" class="cls_020"><span class="cls_020">IP</span></div>
<div style="position:absolute;left:475.44px;top:99.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:493.36px;top:99.00px" class="cls_020"><span class="cls_020">ExcCode</span></div>
<div style="position:absolute;left:547.56px;top:99.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:301.98px;top:118.00px" class="cls_020"><span class="cls_020">Figure 3.3.   Fields in the Cause register</span></div>
<div style="position:absolute;left:228.02px;top:133.67px" class="cls_006"><span class="cls_006">Figure 3.3, “Fields in the Cause register” shows the fields in the </span><span class="cls_008">Cause</span></div>
<div style="position:absolute;left:216.00px;top:144.67px" class="cls_006"><span class="cls_006">register, which are consulted to determine the kind of exception which</span></div>
<div style="position:absolute;left:216.00px;top:155.67px" class="cls_006"><span class="cls_006">happened and will be used to decide which exception routine to call.</span></div>
<div style="position:absolute;left:228.02px;top:169.67px" class="cls_006"><span class="cls_006">BD</span></div>
<div style="position:absolute;left:264.02px;top:169.67px" class="cls_006"><span class="cls_006">‘‘branch delay’’: if set, this bit indicates that the EPC does not</span></div>
<div style="position:absolute;left:264.02px;top:180.67px" class="cls_006"><span class="cls_006">point to the actual “exception” instruction, but rather to the</span></div>
<div style="position:absolute;left:264.02px;top:191.67px" class="cls_006"><span class="cls_006">branch instruction which immediately precedes it.</span></div>
<div style="position:absolute;left:264.02px;top:205.67px" class="cls_006"><span class="cls_006">When the exception restart point is an instruction which is in the</span></div>
<div style="position:absolute;left:264.02px;top:216.67px" class="cls_006"><span class="cls_006">‘‘delay slot’’ following a branch, </span><span class="cls_008">EPC</span><span class="cls_006"> has to point to the branch</span></div>
<div style="position:absolute;left:264.03px;top:227.67px" class="cls_006"><span class="cls_006">instruction; it is harmless to re-execute the branch, but if the</span></div>
<div style="position:absolute;left:264.03px;top:238.67px" class="cls_006"><span class="cls_006">CPU returned from the exception to the branch delay instruction</span></div>
<div style="position:absolute;left:264.03px;top:249.67px" class="cls_006"><span class="cls_006">itself the branch would not be taken and the exception would</span></div>
<div style="position:absolute;left:264.03px;top:260.67px" class="cls_006"><span class="cls_006">have broken the interrupted program.</span></div>
<div style="position:absolute;left:264.03px;top:274.67px" class="cls_006"><span class="cls_006">The only time software might be sensitive to this bit is if it must</span></div>
<div style="position:absolute;left:264.03px;top:285.67px" class="cls_006"><span class="cls_006">analyze  the</span></div>
<div style="position:absolute;left:332.11px;top:285.67px" class="cls_006"><span class="cls_006">‘‘offending’’  instruction</span></div>
<div style="position:absolute;left:455.79px;top:285.67px" class="cls_006"><span class="cls_006">(if  BD</span></div>
<div style="position:absolute;left:496.27px;top:285.67px" class="cls_006"><span class="cls_006">==</span></div>
<div style="position:absolute;left:516.21px;top:285.67px" class="cls_006"><span class="cls_006">1  then  the</span></div>
<div style="position:absolute;left:264.03px;top:296.67px" class="cls_006"><span class="cls_006">instruction is at </span><span class="cls_008">EPC</span><span class="cls_006"> + 4). This would occur if the instruction</span></div>
<div style="position:absolute;left:264.02px;top:307.67px" class="cls_006"><span class="cls_006">needs to be emulated (e.g. a floating point instruction in a device</span></div>
<div style="position:absolute;left:264.02px;top:318.67px" class="cls_006"><span class="cls_006">with no hardware FPA; or a breakpoint placed in a branch delay</span></div>
<div style="position:absolute;left:264.02px;top:329.67px" class="cls_006"><span class="cls_006">slot).</span></div>
<div style="position:absolute;left:228.02px;top:343.67px" class="cls_006"><span class="cls_006">CE</span></div>
<div style="position:absolute;left:264.02px;top:343.67px" class="cls_006"><span class="cls_006">‘‘co-processor error’’: if the exception is taken because a ‘‘co-</span></div>
<div style="position:absolute;left:264.02px;top:354.67px" class="cls_006"><span class="cls_006">processor’’ format instruction was for a ‘‘co-processor’’ which is</span></div>
<div style="position:absolute;left:264.02px;top:365.67px" class="cls_006"><span class="cls_006">not enabled by the CUx bit in </span><span class="cls_008">SR,</span><span class="cls_006"> then this field has the co-</span></div>
<div style="position:absolute;left:264.02px;top:376.67px" class="cls_006"><span class="cls_006">processor number from that instruction.</span></div>
<div style="position:absolute;left:228.02px;top:390.67px" class="cls_006"><span class="cls_006">IP</span></div>
<div style="position:absolute;left:264.02px;top:390.67px" class="cls_006"><span class="cls_006">‘‘Interrupt Pending’’: shows the interrupts which are currently</span></div>
<div style="position:absolute;left:264.02px;top:401.67px" class="cls_006"><span class="cls_006">asserted</span></div>
<div style="position:absolute;left:311.58px;top:401.67px" class="cls_006"><span class="cls_006">(but may be “masked” from actually signalling an</span></div>
<div style="position:absolute;left:264.02px;top:412.67px" class="cls_006"><span class="cls_006">exception). These bits follow the CPU inputs for the six hardware</span></div>
<div style="position:absolute;left:264.02px;top:423.67px" class="cls_006"><span class="cls_006">levels. Bits 9 and 8 are read/writable, and contain the value last</span></div>
<div style="position:absolute;left:264.02px;top:434.67px" class="cls_006"><span class="cls_006">written to them. However, any of the 8 bits active when enabled</span></div>
<div style="position:absolute;left:264.02px;top:445.67px" class="cls_006"><span class="cls_006">by the appropriate IM bit and the global interrupt enable flag IEc</span></div>
<div style="position:absolute;left:264.02px;top:456.67px" class="cls_006"><span class="cls_006">in </span><span class="cls_008">SR,</span><span class="cls_006"> will cause an interrupt.</span></div>
<div style="position:absolute;left:264.03px;top:470.67px" class="cls_006"><span class="cls_006">IP is subtly different from the rest of the </span><span class="cls_008">Cause</span><span class="cls_006"> register fields; it</span></div>
<div style="position:absolute;left:264.02px;top:481.67px" class="cls_006"><span class="cls_006">doesn’t indicate what happened when the exception took place,</span></div>
<div style="position:absolute;left:264.02px;top:492.67px" class="cls_006"><span class="cls_006">but rather shows what is happening now.</span></div>
<div style="position:absolute;left:228.02px;top:506.67px" class="cls_006"><span class="cls_006">ExcCode</span></div>
<div style="position:absolute;left:264.02px;top:520.67px" class="cls_006"><span class="cls_006">A 5-bit code which indicates what kind of exception happened,</span></div>
<div style="position:absolute;left:264.02px;top:531.67px" class="cls_006"><span class="cls_006">as detailed in Table 3.2, “ExcCode values: different kinds of</span></div>
<div style="position:absolute;left:264.02px;top:542.67px" class="cls_006"><span class="cls_006">exceptions”.</span></div>
<div style="position:absolute;left:220.48px;top:565.00px" class="cls_020"><span class="cls_020">ExcCode</span></div>
<div style="position:absolute;left:271.81px;top:565.00px" class="cls_020"><span class="cls_020">Mnemonic</span></div>
<div style="position:absolute;left:424.78px;top:565.00px" class="cls_020"><span class="cls_020">Description</span></div>
<div style="position:absolute;left:227.98px;top:575.00px" class="cls_020"><span class="cls_020">Value</span></div>
<div style="position:absolute;left:218.90px;top:594.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:270.25px;top:594.00px" class="cls_020"><span class="cls_020">Int</span></div>
<div style="position:absolute;left:330.27px;top:594.00px" class="cls_020"><span class="cls_020">Interrupt</span></div>
<div style="position:absolute;left:218.90px;top:611.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:270.25px;top:611.00px" class="cls_020"><span class="cls_020">Mod</span></div>
<div style="position:absolute;left:330.29px;top:611.00px" class="cls_020"><span class="cls_020">‘‘TLB modification’’</span></div>
<div style="position:absolute;left:218.90px;top:628.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:270.25px;top:628.00px" class="cls_020"><span class="cls_020">TLBL</span></div>
<div style="position:absolute;left:330.31px;top:628.00px" class="cls_020"><span class="cls_020">‘‘TLB load/TLB store’’</span></div>
<div style="position:absolute;left:218.90px;top:645.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:270.25px;top:645.00px" class="cls_020"><span class="cls_020">TLBS</span></div>
<div style="position:absolute;left:218.90px;top:662.00px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:270.25px;top:662.00px" class="cls_020"><span class="cls_020">AdEL</span></div>
<div style="position:absolute;left:330.31px;top:662.00px" class="cls_020"><span class="cls_020">Address error (on load/I-fetch or store respectively).</span></div>
<div style="position:absolute;left:330.17px;top:672.00px" class="cls_020"><span class="cls_020">Either an attempt to access outside kuseg when in user</span></div>
<div style="position:absolute;left:218.90px;top:679.00px" class="cls_020"><span class="cls_020">5</span></div>
<div style="position:absolute;left:270.25px;top:679.00px" class="cls_020"><span class="cls_020">AdES</span></div>
<div style="position:absolute;left:330.17px;top:682.00px" class="cls_020"><span class="cls_020">mode, or an attempt to read a word or half-word at a</span></div>
<div style="position:absolute;left:330.17px;top:692.00px" class="cls_020"><span class="cls_020">misaligned address.</span></div>
<div style="position:absolute;left:263.32px;top:711.00px" class="cls_020"><span class="cls_020">Table 3.2.  ExcCode values: different kinds of exceptions</span></div>
<div style="position:absolute;left:305.78px;top:755.33px" class="cls_002"><span class="cls_002">3-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:32080px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 3</span></div>
<div style="position:absolute;left:327.88px;top:28.00px" class="cls_002"><span class="cls_002">SYSTEM CONTROL CO-PROCESSOR ARCHITECTURE</span></div>
<div style="position:absolute;left:40.48px;top:57.00px" class="cls_020"><span class="cls_020">ExcCode</span></div>
<div style="position:absolute;left:91.82px;top:57.00px" class="cls_020"><span class="cls_020">Mnemonic</span></div>
<div style="position:absolute;left:244.78px;top:57.00px" class="cls_020"><span class="cls_020">Description</span></div>
<div style="position:absolute;left:47.99px;top:67.00px" class="cls_020"><span class="cls_020">Value</span></div>
<div style="position:absolute;left:38.90px;top:86.00px" class="cls_020"><span class="cls_020">6</span></div>
<div style="position:absolute;left:90.25px;top:86.00px" class="cls_020"><span class="cls_020">IBE</span></div>
<div style="position:absolute;left:150.27px;top:86.00px" class="cls_020"><span class="cls_020">Bus error (instruction fetch or data load, respectively).</span></div>
<div style="position:absolute;left:150.17px;top:96.00px" class="cls_020"><span class="cls_020">External hardware has signalled an error of some kind;</span></div>
<div style="position:absolute;left:38.90px;top:102.99px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:90.25px;top:102.99px" class="cls_020"><span class="cls_020">DBE</span></div>
<div style="position:absolute;left:150.17px;top:106.00px" class="cls_020"><span class="cls_020">proper exception handling is system-dependent. The</span></div>
<div style="position:absolute;left:150.17px;top:116.00px" class="cls_020"><span class="cls_020">R30xx family CPUs can’t take a bus error on a store;</span></div>
<div style="position:absolute;left:150.17px;top:126.00px" class="cls_020"><span class="cls_020">the write buffer would make such an exception</span></div>
<div style="position:absolute;left:150.17px;top:135.99px" class="cls_020"><span class="cls_020">“imprecise”.</span></div>
<div style="position:absolute;left:38.90px;top:153.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:90.25px;top:153.00px" class="cls_020"><span class="cls_020">Syscall</span></div>
<div style="position:absolute;left:150.35px;top:153.00px" class="cls_020"><span class="cls_020">Generated unconditionally by a </span><span class="cls_027">syscall</span><span class="cls_020"> instruction.</span></div>
<div style="position:absolute;left:38.90px;top:170.00px" class="cls_020"><span class="cls_020">9</span></div>
<div style="position:absolute;left:90.25px;top:170.00px" class="cls_020"><span class="cls_020">Bp</span></div>
<div style="position:absolute;left:150.26px;top:170.00px" class="cls_020"><span class="cls_020">Breakpoint - a </span><span class="cls_027">break</span><span class="cls_020"> instruction.</span></div>
<div style="position:absolute;left:38.90px;top:187.00px" class="cls_020"><span class="cls_020">10</span></div>
<div style="position:absolute;left:90.28px;top:187.00px" class="cls_020"><span class="cls_020">RI</span></div>
<div style="position:absolute;left:150.28px;top:187.00px" class="cls_020"><span class="cls_020">‘‘reserved instruction’’</span></div>
<div style="position:absolute;left:38.90px;top:204.00px" class="cls_020"><span class="cls_020">11</span></div>
<div style="position:absolute;left:90.28px;top:204.00px" class="cls_020"><span class="cls_020">CpU</span></div>
<div style="position:absolute;left:150.32px;top:204.00px" class="cls_020"><span class="cls_020">‘‘Co-Processor unusable’’</span></div>
<div style="position:absolute;left:38.90px;top:221.00px" class="cls_020"><span class="cls_020">12</span></div>
<div style="position:absolute;left:90.28px;top:221.00px" class="cls_020"><span class="cls_020">Ov</span></div>
<div style="position:absolute;left:150.29px;top:221.00px" class="cls_020"><span class="cls_020">‘‘arithmetic overflow’’. Note that ‘‘unsigned’’ versions of</span></div>
<div style="position:absolute;left:150.16px;top:231.00px" class="cls_020"><span class="cls_020">instructions (e.g. </span><span class="cls_027">addu</span><span class="cls_020">) never cause this exception.</span></div>
<div style="position:absolute;left:38.90px;top:248.00px" class="cls_020"><span class="cls_020">13-31</span></div>
<div style="position:absolute;left:90.33px;top:248.00px" class="cls_020"><span class="cls_020">-</span></div>
<div style="position:absolute;left:150.31px;top:248.00px" class="cls_020"><span class="cls_020">reserved. Some are already defined for MIPS CPUs such</span></div>
<div style="position:absolute;left:150.17px;top:258.00px" class="cls_020"><span class="cls_020">as the R6000 and R4xxx</span></div>
<div style="position:absolute;left:83.33px;top:276.99px" class="cls_020"><span class="cls_020">Table 3.2.  ExcCode values: different kinds of exceptions</span></div>
<div style="position:absolute;left:36.00px;top:295.67px" class="cls_006"><span class="cls_006">EPC Register</span></div>
<div style="position:absolute;left:48.02px;top:306.67px" class="cls_006"><span class="cls_006">This is a 32-bit register containing the 32-bit address of the return point</span></div>
<div style="position:absolute;left:36.00px;top:317.67px" class="cls_006"><span class="cls_006">for this exception. The instruction causing (or suffering) the exception is at</span></div>
<div style="position:absolute;left:36.00px;top:328.67px" class="cls_006"><span class="cls_006">EPC, unless BD is set in </span><span class="cls_008">Cause,</span><span class="cls_006"> in which case EPC points to the previous</span></div>
<div style="position:absolute;left:36.00px;top:339.67px" class="cls_006"><span class="cls_006">(branch) instruction.</span></div>
<div style="position:absolute;left:36.00px;top:360.67px" class="cls_006"><span class="cls_006">BadVaddr Register</span></div>
<div style="position:absolute;left:48.02px;top:371.67px" class="cls_006"><span class="cls_006">A 32-bit register containing the address whose reference led to an</span></div>
<div style="position:absolute;left:36.00px;top:382.67px" class="cls_006"><span class="cls_006">exception; set on any MMU-related exception, on an attempt by a user</span></div>
<div style="position:absolute;left:36.00px;top:393.67px" class="cls_006"><span class="cls_006">program to access addresses outside kuseg, or if an address is wrongly</span></div>
<div style="position:absolute;left:36.00px;top:404.67px" class="cls_006"><span class="cls_006">aligned for the datum size referenced.</span></div>
<div style="position:absolute;left:48.02px;top:415.67px" class="cls_006"><span class="cls_006">After any other exception this register is undefined. Note in particular</span></div>
<div style="position:absolute;left:36.00px;top:426.67px" class="cls_006"><span class="cls_006">that it is not set after a bus error.</span></div>
<div style="position:absolute;left:36.00px;top:449.00px" class="cls_015"><span class="cls_015">R3041, R3071, and R3081 specific registers</span></div>
<div style="position:absolute;left:36.00px;top:472.67px" class="cls_006"><span class="cls_006">Count and Compare Registers (R3041 only)</span></div>
<div style="position:absolute;left:48.02px;top:483.67px" class="cls_006"><span class="cls_006">Only present in the R3041, these provide a simple 24-bit counter/timer</span></div>
<div style="position:absolute;left:36.00px;top:494.67px" class="cls_006"><span class="cls_006">running at CPU cycle rate. </span><span class="cls_008">Count</span><span class="cls_006"> counts up, and then wraps around to</span></div>
<div style="position:absolute;left:36.00px;top:505.67px" class="cls_006"><span class="cls_006">zero once it has reached the value in the </span><span class="cls_008">Compare</span><span class="cls_006"> register. As it wraps</span></div>
<div style="position:absolute;left:36.00px;top:516.67px" class="cls_006"><span class="cls_006">around the Tc* CPU output is asserted. According to CPU configuration</span></div>
<div style="position:absolute;left:36.00px;top:527.67px" class="cls_006"><span class="cls_006">(bit TC of the </span><span class="cls_008">BusCtrl</span><span class="cls_006"> register), Tc* will either remain active until reset by</span></div>
<div style="position:absolute;left:36.00px;top:538.67px" class="cls_006"><span class="cls_006">software (re-write </span><span class="cls_008">Compare</span><span class="cls_006">), or will pulse. In either case the counter just</span></div>
<div style="position:absolute;left:36.00px;top:549.67px" class="cls_006"><span class="cls_006">keeps counting. To generate an interrupt Tc* must be connected to one of</span></div>
<div style="position:absolute;left:36.00px;top:560.67px" class="cls_006"><span class="cls_006">the interrupt inputs.</span></div>
<div style="position:absolute;left:48.02px;top:571.67px" class="cls_006"><span class="cls_006">From reset </span><span class="cls_008">Compare</span><span class="cls_006">  is setup to its maximum value </span><span class="cls_029">0xFF FFFF</span><span class="cls_006">), so the</span></div>
<div style="position:absolute;left:36.00px;top:583.33px" class="cls_006"><span class="cls_006">counter runs up to 2</span><span class="cls_022"><sup>24</sup></span><span class="cls_006">-1 before wrapping around.</span></div>
<div style="position:absolute;left:36.00px;top:617.33px" class="cls_006"><span class="cls_006">Config Register (R3071 and R3081)</span></div>
<div style="position:absolute;left:40.00px;top:648.66px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:83.07px;top:648.66px" class="cls_020"><span class="cls_020">30</span></div>
<div style="position:absolute;left:126.15px;top:648.66px" class="cls_020"><span class="cls_020">29</span></div>
<div style="position:absolute;left:171.18px;top:648.66px" class="cls_020"><span class="cls_020">28</span></div>
<div style="position:absolute;left:201.27px;top:648.66px" class="cls_020"><span class="cls_020">26</span></div>
<div style="position:absolute;left:231.36px;top:648.66px" class="cls_020"><span class="cls_020">25</span></div>
<div style="position:absolute;left:271.49px;top:648.66px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:303.04px;top:648.66px" class="cls_020"><span class="cls_020">23</span></div>
<div style="position:absolute;left:335.33px;top:648.66px" class="cls_020"><span class="cls_020">22</span></div>
<div style="position:absolute;left:372.69px;top:648.66px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:40.00px;top:665.66px" class="cls_020"><span class="cls_020">Lock</span></div>
<div style="position:absolute;left:83.11px;top:665.66px" class="cls_020"><span class="cls_020">Slow</span></div>
<div style="position:absolute;left:126.02px;top:665.66px" class="cls_020"><span class="cls_020">DB</span></div>
<div style="position:absolute;left:170.99px;top:665.66px" class="cls_020"><span class="cls_020">FPInt</span></div>
<div style="position:absolute;left:231.15px;top:665.66px" class="cls_020"><span class="cls_020">Halt</span></div>
<div style="position:absolute;left:271.32px;top:665.66px" class="cls_020"><span class="cls_020">RF     AC     reserved</span></div>
<div style="position:absolute;left:83.01px;top:675.66px" class="cls_020"><span class="cls_020">Bus</span></div>
<div style="position:absolute;left:126.02px;top:675.66px" class="cls_020"><span class="cls_020">Refill</span></div>
<div style="position:absolute;left:93.79px;top:694.67px" class="cls_020"><span class="cls_020">Figure 3.4.   Fields in the R3071/81 Config Register</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">3-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:32882px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">SYSTEM CONTROL CO-PROCESSOR ARCHITECTURE</span></div>
<div style="position:absolute;left:525.41px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 3</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:50.67px" class="cls_008"><span class="cls_008">Lock</span><span class="cls_006">: set this bit to write to the register for the last time; all future</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">writes to </span><span class="cls_008">Config</span><span class="cls_006"> will be ignored. The intention is that initialization</span></div>
<div style="position:absolute;left:239.98px;top:72.67px" class="cls_006"><span class="cls_006">software will set the register and can then lock it in case some ill-</span></div>
<div style="position:absolute;left:239.98px;top:83.67px" class="cls_006"><span class="cls_006">behaved piece of software developed on some earlier version of the</span></div>
<div style="position:absolute;left:239.98px;top:94.67px" class="cls_006"><span class="cls_006">MIPS architecture tries to stomp on </span><span class="cls_008">Config;</span><span class="cls_006"> this would have had no</span></div>
<div style="position:absolute;left:239.98px;top:105.67px" class="cls_006"><span class="cls_006">effect on earlier CPUs.</span></div>
<div style="position:absolute;left:228.03px;top:119.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:119.67px" class="cls_008"><span class="cls_008">Slow Bus</span><span class="cls_006">: hardware may require that this bit be set. It only matters</span></div>
<div style="position:absolute;left:239.98px;top:130.67px" class="cls_006"><span class="cls_006">when the CPU performs a store while running from a cached location.</span></div>
<div style="position:absolute;left:239.98px;top:141.67px" class="cls_006"><span class="cls_006">The system hardware design determines the proper setting for this</span></div>
<div style="position:absolute;left:239.98px;top:152.67px" class="cls_006"><span class="cls_006">bit; setting it to ‘1’ should be permissible for any system, but loses</span></div>
<div style="position:absolute;left:239.98px;top:163.67px" class="cls_006"><span class="cls_006">some  performance  in  memory  systems  able  to  support  more</span></div>
<div style="position:absolute;left:239.98px;top:174.67px" class="cls_006"><span class="cls_006">aggressive bus performance.</span></div>
<div style="position:absolute;left:239.98px;top:188.67px" class="cls_006"><span class="cls_006">If set 1, an idle bus cycle is guaranteed between any read and write</span></div>
<div style="position:absolute;left:239.98px;top:199.67px" class="cls_006"><span class="cls_006">transfer. This enables additional time for bus tri-stating, control logic</span></div>
<div style="position:absolute;left:239.98px;top:210.67px" class="cls_006"><span class="cls_006">generation, etc.</span></div>
<div style="position:absolute;left:228.02px;top:224.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:224.67px" class="cls_008"><span class="cls_008">DB</span><span class="cls_006">: ‘‘data cache block refill’’, set 1 to reload 4 words into the data</span></div>
<div style="position:absolute;left:239.98px;top:235.67px" class="cls_006"><span class="cls_006">cache on any miss, set 0 to reload just one word. Can be initialized</span></div>
<div style="position:absolute;left:239.98px;top:246.67px" class="cls_006"><span class="cls_006">either way on the R3081, by a reset-time hardware input.</span></div>
<div style="position:absolute;left:228.03px;top:260.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:260.67px" class="cls_008"><span class="cls_008">FPInt</span><span class="cls_006">: controls the CPU interrupt level on which FPA interrupts are</span></div>
<div style="position:absolute;left:239.97px;top:271.67px" class="cls_006"><span class="cls_006">reported. On original R3000 CPUs the FPA was external and this was</span></div>
<div style="position:absolute;left:239.97px;top:282.67px" class="cls_006"><span class="cls_006">determined by wiring; but the R3081’s FPA is on the chip and it would</span></div>
<div style="position:absolute;left:239.97px;top:293.67px" class="cls_006"><span class="cls_006">be inefficient (and jeopardize pin-compatibility) to send the interrupt</span></div>
<div style="position:absolute;left:239.97px;top:304.67px" class="cls_006"><span class="cls_006">off chip and on again.</span></div>
<div style="position:absolute;left:239.97px;top:318.67px" class="cls_006"><span class="cls_006">Set FPInt to the binary value of the CPU interrupt pin number which</span></div>
<div style="position:absolute;left:239.97px;top:329.67px" class="cls_006"><span class="cls_006">is dedicated to FPA interrupts. By default the field is initialized to</span></div>
<div style="position:absolute;left:239.97px;top:340.67px" class="cls_006"><span class="cls_006">“011’’ to select the pin Int3†; MIPS convention put the FPA on</span></div>
<div style="position:absolute;left:239.97px;top:351.67px" class="cls_006"><span class="cls_006">external interrupt pin 3. For whichever pin is dedicated to the FPA,</span></div>
<div style="position:absolute;left:239.97px;top:362.67px" class="cls_006"><span class="cls_006">the CPU will then ignore the value on the external pin; the IP field of</span></div>
<div style="position:absolute;left:239.97px;top:373.67px" class="cls_006"><span class="cls_006">the cause register will simply follow the FPA.</span></div>
<div style="position:absolute;left:239.97px;top:387.67px" class="cls_006"><span class="cls_006">On the R3071, this field is “reserved”, and must be written as “000”.</span></div>
<div style="position:absolute;left:228.02px;top:401.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:401.67px" class="cls_008"><span class="cls_008">Halt</span><span class="cls_006">: set to bring the CPU to a standstill. It will start again as soon as</span></div>
<div style="position:absolute;left:239.97px;top:412.67px" class="cls_006"><span class="cls_006">any interrupt input is asserted (regardless of the state of the interrupt</span></div>
<div style="position:absolute;left:239.97px;top:423.67px" class="cls_006"><span class="cls_006">mask). This is useful for power reduction, and can also be used to</span></div>
<div style="position:absolute;left:239.97px;top:434.67px" class="cls_006"><span class="cls_006">emulate old MC68000 “Halt” operation.</span></div>
<div style="position:absolute;left:228.02px;top:448.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:448.67px" class="cls_008"><span class="cls_008">RF</span><span class="cls_006">: slows the CPU to 1/16th of the normal clock rate, to reduce power</span></div>
<div style="position:absolute;left:239.98px;top:459.67px" class="cls_006"><span class="cls_006">consumption. Illegal unless the CPU is running at 33Mhz or higher.</span></div>
<div style="position:absolute;left:239.98px;top:470.67px" class="cls_006"><span class="cls_006">Note  that  the  CPUs  output  clock</span></div>
<div style="position:absolute;left:428.76px;top:470.67px" class="cls_006"><span class="cls_006">(which  is  normally  used  to</span></div>
<div style="position:absolute;left:239.98px;top:481.67px" class="cls_006"><span class="cls_006">synchronize all the interface logic) slows down too; the hardware</span></div>
<div style="position:absolute;left:239.98px;top:492.67px" class="cls_006"><span class="cls_006">design should also accommodate this feature if software desires to</span></div>
<div style="position:absolute;left:239.98px;top:503.67px" class="cls_006"><span class="cls_006">use it.</span></div>
<div style="position:absolute;left:228.03px;top:517.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:517.67px" class="cls_008"><span class="cls_008">AC</span><span class="cls_006">: ‘‘alternate cache’’. 0 for 16K I-cache/4K D-cache, but set 1 for 8K</span></div>
<div style="position:absolute;left:239.98px;top:528.67px" class="cls_006"><span class="cls_006">I-cache/8K D-cache.</span></div>
<div style="position:absolute;left:228.03px;top:542.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:542.67px" class="cls_008"><span class="cls_008">Reserved</span><span class="cls_006">: must only be written as zero. It will probably read as zero,</span></div>
<div style="position:absolute;left:239.98px;top:553.67px" class="cls_006"><span class="cls_006">but software should not rely on this.</span></div>
<div style="position:absolute;left:216.00px;top:574.67px" class="cls_006"><span class="cls_006">Config Register (R3041)</span></div>
<div style="position:absolute;left:220.00px;top:606.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:255.39px;top:606.00px" class="cls_020"><span class="cls_020">30</span></div>
<div style="position:absolute;left:280.10px;top:606.00px" class="cls_020"><span class="cls_020">29</span></div>
<div style="position:absolute;left:315.08px;top:606.00px" class="cls_020"><span class="cls_020">28</span></div>
<div style="position:absolute;left:408.19px;top:606.00px" class="cls_020"><span class="cls_020">20</span></div>
<div style="position:absolute;left:432.90px;top:606.00px" class="cls_020"><span class="cls_020">19</span></div>
<div style="position:absolute;left:468.89px;top:606.00px" class="cls_020"><span class="cls_020">18</span></div>
<div style="position:absolute;left:562.00px;top:606.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:220.00px;top:623.00px" class="cls_020"><span class="cls_020">Lock</span></div>
<div style="position:absolute;left:255.33px;top:623.00px" class="cls_028"><span class="cls_028">1</span></div>
<div style="position:absolute;left:280.01px;top:623.00px" class="cls_020"><span class="cls_020">DBR</span></div>
<div style="position:absolute;left:314.92px;top:623.00px" class="cls_028"><span class="cls_028">0</span></div>
<div style="position:absolute;left:432.63px;top:623.00px" class="cls_020"><span class="cls_020">FDM</span></div>
<div style="position:absolute;left:468.55px;top:623.00px" class="cls_028"><span class="cls_028">0</span></div>
<div style="position:absolute;left:230.15px;top:642.00px" class="cls_020"><span class="cls_020">Figure 3.5.   Fields in the R3041 Config (Cache Configuration) Register</span></div>
<div style="position:absolute;left:234.00px;top:686.67px" class="cls_006"><span class="cls_006">† Take care: the external pin </span><span class="cls_008">Int3</span><span class="cls_006"> corresponds to the bit numbered</span></div>
<div style="position:absolute;left:234.00px;top:698.67px" class="cls_006"><span class="cls_006">‘‘5’’ in IP of the Cause register or IM of the SR register. That’s</span></div>
<div style="position:absolute;left:234.00px;top:710.67px" class="cls_006"><span class="cls_006">because both the Cause and SR fields support two ‘‘software</span></div>
<div style="position:absolute;left:234.00px;top:722.67px" class="cls_006"><span class="cls_006">interrupts’’ numbered as bits 0 and 1.</span></div>
<div style="position:absolute;left:305.78px;top:755.33px" class="cls_002"><span class="cls_002">3-9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:33684px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 3</span></div>
<div style="position:absolute;left:327.88px;top:28.00px" class="cls_002"><span class="cls_002">SYSTEM CONTROL CO-PROCESSOR ARCHITECTURE</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Lock</span><span class="cls_006">: set 1 to finally configure register (additional writes will not have</span></div>
<div style="position:absolute;left:59.97px;top:61.67px" class="cls_006"><span class="cls_006">any effect until the CPU is reset).</span></div>
<div style="position:absolute;left:48.02px;top:75.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:75.67px" class="cls_029"><span class="cls_029">1 and 0</span><span class="cls_006">: set fields to exactly the value shown.</span></div>
<div style="position:absolute;left:48.03px;top:89.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> DBR</span><span class="cls_006">: ‘‘DBlockRefill’’, set 1 to read 4 words into the cache on a miss,</span></div>
<div style="position:absolute;left:59.98px;top:100.67px" class="cls_006"><span class="cls_006">0 to refill just the word missed on. The proper setting for a given</span></div>
<div style="position:absolute;left:59.98px;top:111.67px" class="cls_006"><span class="cls_006">system is dependent on a number of factors, and may best be</span></div>
<div style="position:absolute;left:59.98px;top:122.67px" class="cls_006"><span class="cls_006">determined by measuring performance in each mode and selecting</span></div>
<div style="position:absolute;left:59.98px;top:133.67px" class="cls_006"><span class="cls_006">the best one. Note that it is possible for software to dynamically</span></div>
<div style="position:absolute;left:59.98px;top:144.67px" class="cls_006"><span class="cls_006">reconfigure  the  refill  algorithm  depending  on  the  current  code</span></div>
<div style="position:absolute;left:59.98px;top:155.67px" class="cls_006"><span class="cls_006">executing, presuming the register has not been “locked”.</span></div>
<div style="position:absolute;left:48.03px;top:169.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> FDM</span><span class="cls_006">: “Force D-Cache Miss”, set 1 for an R3041-specific cache mode,</span></div>
<div style="position:absolute;left:59.98px;top:180.67px" class="cls_006"><span class="cls_006">where all loads result in data being fetched from memory (missing in</span></div>
<div style="position:absolute;left:59.98px;top:191.67px" class="cls_006"><span class="cls_006">the data cache), but the incoming data is still used to refill the cache.</span></div>
<div style="position:absolute;left:59.98px;top:202.67px" class="cls_006"><span class="cls_006">Stores continue to write the cache. This is useful when software</span></div>
<div style="position:absolute;left:59.98px;top:213.67px" class="cls_006"><span class="cls_006">desires to obtain the high-bandwidth of the cache and cache refills,</span></div>
<div style="position:absolute;left:59.98px;top:224.67px" class="cls_006"><span class="cls_006">but the corresponding main memory is “volatile” (e.g. a FIFO, or</span></div>
<div style="position:absolute;left:59.98px;top:235.67px" class="cls_006"><span class="cls_006">updated by DMA).</span></div>
<div style="position:absolute;left:36.00px;top:256.67px" class="cls_006"><span class="cls_006">BusCtrl Register (R3041 only)</span></div>
<div style="position:absolute;left:48.02px;top:267.67px" class="cls_006"><span class="cls_006">The R3041 CPU has many hardware interface options not available on</span></div>
<div style="position:absolute;left:36.00px;top:278.67px" class="cls_006"><span class="cls_006">other members of the R30xx family, which are intended to allow the use of</span></div>
<div style="position:absolute;left:36.00px;top:289.67px" class="cls_006"><span class="cls_006">simpler and cheaper interface and memory components. The </span><span class="cls_008">BusCtrl</span></div>
<div style="position:absolute;left:36.00px;top:300.67px" class="cls_006"><span class="cls_006">register does most of the configuration work. It needs to be set strictly in</span></div>
<div style="position:absolute;left:36.00px;top:311.67px" class="cls_006"><span class="cls_006">accordance with the needs of the hardware implementation. Note also that</span></div>
<div style="position:absolute;left:36.00px;top:322.67px" class="cls_006"><span class="cls_006">its default settings (from reset) leave the interface compatible with other</span></div>
<div style="position:absolute;left:36.00px;top:333.67px" class="cls_006"><span class="cls_006">R30xx family members.</span></div>
<div style="position:absolute;left:48.02px;top:344.67px" class="cls_006"><span class="cls_006">Figure 3.6, “Fields in the R3041 Bus Control (BusCtrl) Register” shows</span></div>
<div style="position:absolute;left:36.00px;top:355.67px" class="cls_006"><span class="cls_006">the layout of the fields, and their uses are provided for completeness.</span></div>
<div style="position:absolute;left:40.00px;top:376.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:63.97px;top:376.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:79.83px;top:376.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:95.75px;top:376.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:111.68px;top:376.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:127.60px;top:376.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:143.52px;top:376.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:159.44px;top:376.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:175.36px;top:376.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:191.28px;top:376.00px" class="cls_020"><span class="cls_020">21</span></div>
<div style="position:absolute;left:214.47px;top:376.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:230.34px;top:376.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:247.62px;top:376.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:263.54px;top:376.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:279.46px;top:376.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:295.38px;top:376.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:311.30px;top:376.00px" class="cls_020"><span class="cls_020">13</span></div>
<div style="position:absolute;left:335.88px;top:376.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:354.05px;top:376.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:371.33px;top:376.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:387.25px;top:376.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:63.91px;top:386.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:79.83px;top:386.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:95.75px;top:386.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:111.68px;top:386.00px" class="cls_020"><span class="cls_020">6</span></div>
<div style="position:absolute;left:127.60px;top:386.00px" class="cls_020"><span class="cls_020">5</span></div>
<div style="position:absolute;left:143.52px;top:386.00px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:159.44px;top:386.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:175.36px;top:386.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:214.42px;top:386.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:230.34px;top:386.00px" class="cls_020"><span class="cls_020">9</span></div>
<div style="position:absolute;left:247.62px;top:386.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:263.54px;top:386.00px" class="cls_020"><span class="cls_020">6</span></div>
<div style="position:absolute;left:279.46px;top:386.00px" class="cls_020"><span class="cls_020">5</span></div>
<div style="position:absolute;left:295.38px;top:386.00px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:335.82px;top:386.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:354.05px;top:386.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:371.33px;top:386.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:40.04px;top:403.00px" class="cls_020"><span class="cls_020">Loc</span></div>
<div style="position:absolute;left:63.96px;top:403.00px" class="cls_028"><span class="cls_028">10</span></div>
<div style="position:absolute;left:95.79px;top:403.00px" class="cls_020"><span class="cls_020">Mem</span></div>
<div style="position:absolute;left:127.72px;top:403.00px" class="cls_020"><span class="cls_020">ED</span></div>
<div style="position:absolute;left:159.63px;top:403.00px" class="cls_020"><span class="cls_020">IO</span></div>
<div style="position:absolute;left:191.52px;top:403.00px" class="cls_020"><span class="cls_020">BE</span></div>
<div style="position:absolute;left:214.39px;top:403.00px" class="cls_028"><span class="cls_028">1</span></div>
<div style="position:absolute;left:230.33px;top:403.00px" class="cls_020"><span class="cls_020">B</span></div>
<div style="position:absolute;left:247.59px;top:403.00px" class="cls_028"><span class="cls_028">11</span></div>
<div style="position:absolute;left:279.42px;top:403.00px" class="cls_020"><span class="cls_020">BTA</span></div>
<div style="position:absolute;left:311.34px;top:403.00px" class="cls_020"><span class="cls_020">DM</span></div>
<div style="position:absolute;left:335.77px;top:403.00px" class="cls_020"><span class="cls_020">T</span></div>
<div style="position:absolute;left:354.00px;top:403.00px" class="cls_020"><span class="cls_020">B</span></div>
<div style="position:absolute;left:371.28px;top:403.00px" class="cls_028"><span class="cls_028">0x30</span></div>
<div style="position:absolute;left:40.04px;top:413.00px" class="cls_020"><span class="cls_020">k</span></div>
<div style="position:absolute;left:191.25px;top:417.00px" class="cls_030"><span class="cls_030">16</span></div>
<div style="position:absolute;left:230.31px;top:413.00px" class="cls_020"><span class="cls_020">E</span></div>
<div style="position:absolute;left:311.26px;top:413.00px" class="cls_020"><span class="cls_020">A</span></div>
<div style="position:absolute;left:335.77px;top:413.00px" class="cls_020"><span class="cls_020">C</span></div>
<div style="position:absolute;left:354.00px;top:413.00px" class="cls_020"><span class="cls_020">R</span></div>
<div style="position:absolute;left:371.28px;top:413.00px" class="cls_028"><span class="cls_028">0</span></div>
<div style="position:absolute;left:68.01px;top:432.00px" class="cls_020"><span class="cls_020">Figure 3.6.   Fields in the R3041 Bus Control (BusCtrl) Register</span></div>
<div style="position:absolute;left:48.02px;top:447.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:447.67px" class="cls_008"><span class="cls_008">Lock</span><span class="cls_006">: when software has initialized </span><span class="cls_008">BusCtrl</span><span class="cls_006"> to its desired state it may</span></div>
<div style="position:absolute;left:59.97px;top:458.67px" class="cls_006"><span class="cls_006">write this bit to prevent its contents being changed again until the</span></div>
<div style="position:absolute;left:59.97px;top:469.67px" class="cls_006"><span class="cls_006">system is reset.</span></div>
<div style="position:absolute;left:48.02px;top:483.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:483.67px" class="cls_029"><span class="cls_029">10 and other numbers</span><span class="cls_006">: write exactly the specified bit pattern to this</span></div>
<div style="position:absolute;left:59.97px;top:494.67px" class="cls_006"><span class="cls_006">field (hex used for big ones, but others are given as binary). Improper</span></div>
<div style="position:absolute;left:59.97px;top:505.67px" class="cls_006"><span class="cls_006">values may cause test modes and other unexpected side effects.</span></div>
<div style="position:absolute;left:48.02px;top:519.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:519.67px" class="cls_008"><span class="cls_008">Mem</span><span class="cls_006"> : ‘‘MemStrobe*  control’’. Set this field to </span><span class="cls_029">xy</span><span class="cls_006"> binary, where </span><span class="cls_029">x</span><span class="cls_006"> set</span></div>
<div style="position:absolute;left:59.96px;top:530.67px" class="cls_006"><span class="cls_006">means the strobe activates on reads, and </span><span class="cls_029">y</span><span class="cls_006"> set makes it active on</span></div>
<div style="position:absolute;left:59.96px;top:541.67px" class="cls_006"><span class="cls_006">writes.</span></div>
<div style="position:absolute;left:48.01px;top:555.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.96px;top:555.67px" class="cls_008"><span class="cls_008">ED</span><span class="cls_006">: ‘‘ExtDataEn* control’’. Encoded as for ‘‘Mem’’. Note that the BR</span></div>
<div style="position:absolute;left:59.95px;top:566.67px" class="cls_006"><span class="cls_006">bit must be zero for this pin to function as an output.</span></div>
<div style="position:absolute;left:48.00px;top:580.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.95px;top:580.67px" class="cls_008"><span class="cls_008">IO</span><span class="cls_006">: ‘‘IOStrobe* control’’. Encoded as for ‘‘Mem’’. Note that the BR bit</span></div>
<div style="position:absolute;left:59.95px;top:591.67px" class="cls_006"><span class="cls_006">must be zero for this pin to function as an output.</span></div>
<div style="position:absolute;left:48.00px;top:605.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.95px;top:605.67px" class="cls_008"><span class="cls_008">BE16</span><span class="cls_006">: ‘‘BE16(1:0)* read control’’ - 0 to make these pins active on</span></div>
<div style="position:absolute;left:59.95px;top:616.67px" class="cls_006"><span class="cls_006">write cycles only.</span></div>
<div style="position:absolute;left:48.00px;top:630.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.95px;top:630.67px" class="cls_008"><span class="cls_008">BE</span><span class="cls_006">: ‘‘BE(3:0)* read control’’ - 0 to make these pins active on write</span></div>
<div style="position:absolute;left:59.95px;top:641.67px" class="cls_006"><span class="cls_006">cycles only.</span></div>
<div style="position:absolute;left:48.00px;top:655.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.95px;top:655.67px" class="cls_008"><span class="cls_008">BTA</span><span class="cls_006">:  ‘‘Bus  turn  around  time’’.  Program  with  a  binary  number</span></div>
<div style="position:absolute;left:59.95px;top:666.67px" class="cls_006"><span class="cls_006">between 0 and 3, for 0-3 cycles of guaranteed delay between the end</span></div>
<div style="position:absolute;left:59.95px;top:677.67px" class="cls_006"><span class="cls_006">of a read cycle and the start of the address phase of the next cycle.</span></div>
<div style="position:absolute;left:59.95px;top:688.67px" class="cls_006"><span class="cls_006">This field enables the use of devices with slow tri-state time, and</span></div>
<div style="position:absolute;left:59.95px;top:699.67px" class="cls_006"><span class="cls_006">enables   the   system   designer   to   save   cost   by   omitting   data</span></div>
<div style="position:absolute;left:59.95px;top:710.67px" class="cls_006"><span class="cls_006">transceivers.</span></div>
<div style="position:absolute;left:289.78px;top:755.34px" class="cls_002"><span class="cls_002">3-10</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:34486px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">SYSTEM CONTROL CO-PROCESSOR ARCHITECTURE</span></div>
<div style="position:absolute;left:525.41px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 3</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> DMA</span><span class="cls_006">: ‘‘DMA Protocol Control’’, enables ‘‘DMA pulse protocol’’. When</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">set, the CPU uses its DMA control pins to communicate its desire for</span></div>
<div style="position:absolute;left:239.97px;top:72.67px" class="cls_006"><span class="cls_006">the bus even while a DMA is in progress.</span></div>
<div style="position:absolute;left:228.02px;top:86.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> TC</span><span class="cls_006">: ‘‘TC* negation control’’. TC* is the output pin which is activated</span></div>
<div style="position:absolute;left:239.97px;top:97.67px" class="cls_006"><span class="cls_006">when the internal timer register </span><span class="cls_008">Count</span><span class="cls_006"> reaches the value stored in</span></div>
<div style="position:absolute;left:239.96px;top:108.67px" class="cls_008"><span class="cls_008">Compare.</span><span class="cls_006"> Set TC zero to make the TC* pin just pulse for a couple of</span></div>
<div style="position:absolute;left:239.96px;top:119.67px" class="cls_006"><span class="cls_006">clock periods; leave TC as 1, and TC* will be asserted on a compare</span></div>
<div style="position:absolute;left:239.96px;top:130.67px" class="cls_006"><span class="cls_006">and remain asserted until software explicitly clears it (by re-writing</span></div>
<div style="position:absolute;left:239.96px;top:141.67px" class="cls_008"><span class="cls_008">Compare</span><span class="cls_006"> with any value).</span></div>
<div style="position:absolute;left:239.96px;top:155.67px" class="cls_006"><span class="cls_006">If TC* is used to generate a timer interrupt, then use the default (TC</span></div>
<div style="position:absolute;left:239.96px;top:166.67px" class="cls_006"><span class="cls_006">==</span></div>
<div style="position:absolute;left:256.57px;top:166.67px" class="cls_006"><span class="cls_006">0). The pulse is more useful when the output is being used by</span></div>
<div style="position:absolute;left:239.96px;top:177.67px" class="cls_006"><span class="cls_006">external logic (e.g. to signal a DRAM refresh).</span></div>
<div style="position:absolute;left:228.01px;top:191.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> BR</span><span class="cls_006">: ‘‘SBrCond(3:2) control’’. Set zero to recycle the SBrCond(3:2)</span></div>
<div style="position:absolute;left:239.96px;top:202.67px" class="cls_006"><span class="cls_006">pins as IOStrobe and ExtDataEn respectively.</span></div>
<div style="position:absolute;left:215.98px;top:223.67px" class="cls_006"><span class="cls_006">PortSize Register (R3041 only)</span></div>
<div style="position:absolute;left:228.00px;top:234.67px" class="cls_006"><span class="cls_006">The </span><span class="cls_008">PortSize</span><span class="cls_006"> register is used to flag different parts of the program</span></div>
<div style="position:absolute;left:215.98px;top:245.67px" class="cls_006"><span class="cls_006">address space for accesses to 8-, 16- or 32-bit wide memory.</span></div>
<div style="position:absolute;left:228.00px;top:256.67px" class="cls_006"><span class="cls_006">Settings of this register have to be made at a time and to values which</span></div>
<div style="position:absolute;left:215.98px;top:267.67px" class="cls_006"><span class="cls_006">will be mandated by the hardware design. See ‘‘IDT79R3041 Hardware</span></div>
<div style="position:absolute;left:215.98px;top:278.67px" class="cls_006"><span class="cls_006">User’s Manual’’ for details.</span></div>
<div style="position:absolute;left:216.00px;top:301.00px" class="cls_015"><span class="cls_015">What registers are relevant when?</span></div>
<div style="position:absolute;left:228.02px;top:314.67px" class="cls_006"><span class="cls_006">The various CP0 registers and their fields provide support at specific</span></div>
<div style="position:absolute;left:216.00px;top:325.67px" class="cls_006"><span class="cls_006">times during system operation.</span></div>
<div style="position:absolute;left:228.02px;top:339.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:339.67px" class="cls_008"><span class="cls_008">After hardware reset</span><span class="cls_006">: software must initialize </span><span class="cls_008">SR</span><span class="cls_006"> to get the CPU into</span></div>
<div style="position:absolute;left:239.98px;top:350.67px" class="cls_006"><span class="cls_006">the right state to bootstrap itself.</span></div>
<div style="position:absolute;left:228.03px;top:364.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:364.67px" class="cls_008"><span class="cls_008">Hardware configuration at start-up</span><span class="cls_006">: an R3041, R3071, or R3081</span></div>
<div style="position:absolute;left:239.98px;top:375.67px" class="cls_006"><span class="cls_006">require initialization of </span><span class="cls_008">Config,</span><span class="cls_006"> </span><span class="cls_008">BusCtrl,</span><span class="cls_006"> and/or </span><span class="cls_008">PortSize</span><span class="cls_006"> before very</span></div>
<div style="position:absolute;left:239.98px;top:386.67px" class="cls_006"><span class="cls_006">much will work. The system hardware implementation will dictate the</span></div>
<div style="position:absolute;left:239.98px;top:397.67px" class="cls_006"><span class="cls_006">proper configuration of these registers.</span></div>
<div style="position:absolute;left:228.03px;top:411.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:411.67px" class="cls_008"><span class="cls_008">After any exception</span><span class="cls_006">: any MIPS exception (apart from one particular</span></div>
<div style="position:absolute;left:239.98px;top:422.67px" class="cls_006"><span class="cls_006">MMU event) invokes a single common ‘‘general exception handler’’</span></div>
<div style="position:absolute;left:239.98px;top:433.67px" class="cls_006"><span class="cls_006">routine, at a fixed address.</span></div>
<div style="position:absolute;left:239.98px;top:447.67px" class="cls_006"><span class="cls_006">On entry, no program registers are saved, only the return address in</span></div>
<div style="position:absolute;left:239.98px;top:458.67px" class="cls_008"><span class="cls_008">EPC.</span><span class="cls_006"> The MIPS hardware knows nothing about stacks. In any case the</span></div>
<div style="position:absolute;left:239.98px;top:469.67px" class="cls_006"><span class="cls_006">exception routine cannot use the user-mode stack for any purpose;</span></div>
<div style="position:absolute;left:239.98px;top:480.67px" class="cls_006"><span class="cls_006">the exception might have been a TLB miss on stack memory.</span></div>
<div style="position:absolute;left:239.98px;top:494.67px" class="cls_006"><span class="cls_006">Exception software will need to use at least one of </span><span class="cls_008">k0</span><span class="cls_006"> and </span><span class="cls_008">k1</span><span class="cls_006"> to point</span></div>
<div style="position:absolute;left:239.98px;top:505.67px" class="cls_006"><span class="cls_006">to some ‘‘safe’’ (exception-proof) memory space. Key information can</span></div>
<div style="position:absolute;left:239.98px;top:516.67px" class="cls_006"><span class="cls_006">be saved, using the other </span><span class="cls_008">k0</span><span class="cls_006"> or </span><span class="cls_008">k1</span><span class="cls_006"> register to stage data from control</span></div>
<div style="position:absolute;left:239.98px;top:527.67px" class="cls_006"><span class="cls_006">registers where necessary.</span></div>
<div style="position:absolute;left:239.98px;top:541.67px" class="cls_006"><span class="cls_006">Consult the </span><span class="cls_008">Cause</span><span class="cls_006"> register to find out what kind of exception it was</span></div>
<div style="position:absolute;left:239.98px;top:552.67px" class="cls_006"><span class="cls_006">and dispatch accordingly.</span></div>
<div style="position:absolute;left:228.03px;top:566.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:566.67px" class="cls_008"><span class="cls_008">Returning from exception</span><span class="cls_006">: control must eventually be returned to the</span></div>
<div style="position:absolute;left:239.98px;top:577.67px" class="cls_006"><span class="cls_006">value stored in </span><span class="cls_008">EPC</span><span class="cls_006"> on entry.</span></div>
<div style="position:absolute;left:239.98px;top:591.67px" class="cls_006"><span class="cls_006">Whatever kind of exception it was, software will have to adjust </span><span class="cls_008">SR</span></div>
<div style="position:absolute;left:239.98px;top:602.67px" class="cls_006"><span class="cls_006">back upon return from exception. The special instruction </span><span class="cls_008">rfe</span><span class="cls_006"> does the</span></div>
<div style="position:absolute;left:239.99px;top:613.67px" class="cls_006"><span class="cls_006">job; but note that it does not transfer control. To make the jump back</span></div>
<div style="position:absolute;left:239.99px;top:624.67px" class="cls_006"><span class="cls_006">software must load the original </span><span class="cls_008">EPC</span><span class="cls_006"> value back into a general-</span></div>
<div style="position:absolute;left:239.99px;top:635.67px" class="cls_006"><span class="cls_006">purpose register and use a </span><span class="cls_008">jr</span><span class="cls_006"> operation.</span></div>
<div style="position:absolute;left:228.04px;top:649.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.99px;top:649.67px" class="cls_008"><span class="cls_008">Interrupts</span><span class="cls_006">: </span><span class="cls_008">SR</span><span class="cls_006"> is used to adjust the interrupt masks, to determine</span></div>
<div style="position:absolute;left:240.00px;top:660.67px" class="cls_006"><span class="cls_006">which (if any) interrupts will be allowed ‘‘higher priority’’ than the</span></div>
<div style="position:absolute;left:240.00px;top:671.67px" class="cls_006"><span class="cls_006">current one. The hardware offers no interrupt prioritization, but the</span></div>
<div style="position:absolute;left:240.00px;top:682.67px" class="cls_006"><span class="cls_006">software can do whatever it likes.</span></div>
<div style="position:absolute;left:228.05px;top:696.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:240.00px;top:696.67px" class="cls_008"><span class="cls_008">Instructions which always cause exceptions</span><span class="cls_006">:  are  often  used</span></div>
<div style="position:absolute;left:559.84px;top:696.67px" class="cls_006"><span class="cls_006">(for</span></div>
<div style="position:absolute;left:240.00px;top:707.67px" class="cls_006"><span class="cls_006">system calls, breakpoints, and to emulate some kinds of instruction).</span></div>
<div style="position:absolute;left:240.00px;top:718.67px" class="cls_006"><span class="cls_006">These   sometimes   requires   partial   decoding   of   the   offending</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">3-11</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:35288px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 3</span></div>
<div style="position:absolute;left:327.88px;top:28.00px" class="cls_002"><span class="cls_002">SYSTEM CONTROL CO-PROCESSOR ARCHITECTURE</span></div>
<div style="position:absolute;left:59.98px;top:50.67px" class="cls_006"><span class="cls_006">instruction, which can usually be found at the location </span><span class="cls_008">EPC.</span><span class="cls_006"> But</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">there is a complication; suppose that an exception occurs just after a</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">branch but in time to prevent the branch delay slot instruction from</span></div>
<div style="position:absolute;left:59.98px;top:83.67px" class="cls_006"><span class="cls_006">running. Then </span><span class="cls_008">EPC</span><span class="cls_006"> will point to the branch instruction (resuming</span></div>
<div style="position:absolute;left:59.98px;top:94.67px" class="cls_006"><span class="cls_006">execution starting at the delay slot would cause the branch to be</span></div>
<div style="position:absolute;left:59.98px;top:105.67px" class="cls_006"><span class="cls_006">ignored), and the BD bit will be set.</span></div>
<div style="position:absolute;left:59.98px;top:119.67px" class="cls_006"><span class="cls_006">This </span><span class="cls_008">Cause</span><span class="cls_006"> register bit flags this event; to find the instruction at</span></div>
<div style="position:absolute;left:59.98px;top:130.67px" class="cls_006"><span class="cls_006">which the exception occurred, add 4 to the </span><span class="cls_008">EPC</span><span class="cls_006"> value when the BD</span></div>
<div style="position:absolute;left:59.98px;top:141.67px" class="cls_006"><span class="cls_006">bit is set.</span></div>
<div style="position:absolute;left:48.03px;top:155.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Cache management routines</span><span class="cls_006">: </span><span class="cls_008">SR</span><span class="cls_006"> contains bits defining special modes</span></div>
<div style="position:absolute;left:59.98px;top:166.67px" class="cls_006"><span class="cls_006">for cache management. In particular they allow software to </span><span class="cls_008">isolate</span><span class="cls_006"> the</span></div>
<div style="position:absolute;left:59.98px;top:177.67px" class="cls_006"><span class="cls_006">data cache, and to </span><span class="cls_008">swap</span><span class="cls_006"> the roles of the instruction and data caches.</span></div>
<div style="position:absolute;left:48.02px;top:199.67px" class="cls_006"><span class="cls_006">The subsequent chapters will describe appropriate treatment of these</span></div>
<div style="position:absolute;left:36.00px;top:210.67px" class="cls_006"><span class="cls_006">registers, and provide software examples of their use.</span></div>
<div style="position:absolute;left:289.78px;top:755.34px" class="cls_002"><span class="cls_002">3-12</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:36090px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:423.27px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:36.00px;top:50.00px" class="cls_015"><span class="cls_015">Conventional names and uses of general-purpose registers</span></div>
<div style="position:absolute;left:48.02px;top:63.67px" class="cls_006"><span class="cls_006">Although the hardware makes few rules about the use of registers, their</span></div>
<div style="position:absolute;left:36.00px;top:74.67px" class="cls_006"><span class="cls_006">practical use is governed by a number of conventions. These conventions</span></div>
<div style="position:absolute;left:36.00px;top:85.67px" class="cls_006"><span class="cls_006">allow inter-changeability of tools, operating systems, and library modules.</span></div>
<div style="position:absolute;left:36.00px;top:96.67px" class="cls_006"><span class="cls_006">It is strongly recommended that these conventions be followed.</span></div>
<div style="position:absolute;left:41.08px;top:130.00px" class="cls_020"><span class="cls_020">Reg No</span></div>
<div style="position:absolute;left:85.01px;top:130.00px" class="cls_020"><span class="cls_020">Name</span></div>
<div style="position:absolute;left:237.55px;top:130.00px" class="cls_020"><span class="cls_020">Used for</span></div>
<div style="position:absolute;left:39.51px;top:149.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:83.31px;top:149.00px" class="cls_020"><span class="cls_020">zero</span></div>
<div style="position:absolute;left:120.51px;top:149.00px" class="cls_020"><span class="cls_020">Always returns 0</span></div>
<div style="position:absolute;left:39.51px;top:166.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:83.31px;top:166.00px" class="cls_020"><span class="cls_020">at</span></div>
<div style="position:absolute;left:120.48px;top:166.00px" class="cls_020"><span class="cls_020">(assembler temporary) Reserved for use by assembler</span></div>
<div style="position:absolute;left:39.51px;top:183.00px" class="cls_020"><span class="cls_020">2-3</span></div>
<div style="position:absolute;left:83.35px;top:183.00px" class="cls_020"><span class="cls_020">v0-v1</span></div>
<div style="position:absolute;left:120.59px;top:183.00px" class="cls_020"><span class="cls_020">Value (except FP) returned by subroutine</span></div>
<div style="position:absolute;left:39.51px;top:200.00px" class="cls_020"><span class="cls_020">4-7</span></div>
<div style="position:absolute;left:83.35px;top:200.00px" class="cls_020"><span class="cls_020">a0-a3</span></div>
<div style="position:absolute;left:120.59px;top:200.00px" class="cls_020"><span class="cls_020">(arguments) First four parameters for a subroutine</span></div>
<div style="position:absolute;left:39.51px;top:217.00px" class="cls_020"><span class="cls_020">8-15</span></div>
<div style="position:absolute;left:83.37px;top:217.00px" class="cls_020"><span class="cls_020">t0-t7</span></div>
<div style="position:absolute;left:120.60px;top:217.00px" class="cls_020"><span class="cls_020">(temporaries) subroutines may use without saving</span></div>
<div style="position:absolute;left:39.51px;top:234.01px" class="cls_020"><span class="cls_020">24-25</span></div>
<div style="position:absolute;left:83.40px;top:234.01px" class="cls_020"><span class="cls_020">t8-t9</span></div>
<div style="position:absolute;left:39.51px;top:251.01px" class="cls_020"><span class="cls_020">16-23</span></div>
<div style="position:absolute;left:83.40px;top:251.01px" class="cls_020"><span class="cls_020">s0-s7</span></div>
<div style="position:absolute;left:120.63px;top:251.01px" class="cls_020"><span class="cls_020">Subroutine ‘‘register variables’’; a subroutine which will write</span></div>
<div style="position:absolute;left:120.40px;top:261.01px" class="cls_020"><span class="cls_020">one of these must save the old value and restore it before it</span></div>
<div style="position:absolute;left:120.40px;top:271.00px" class="cls_020"><span class="cls_020">exits, so the </span><span class="cls_027">calling</span><span class="cls_020"> routine sees their values preserved.</span></div>
<div style="position:absolute;left:39.50px;top:288.00px" class="cls_020"><span class="cls_020">26-27</span></div>
<div style="position:absolute;left:83.40px;top:288.00px" class="cls_020"><span class="cls_020">k0-k1</span></div>
<div style="position:absolute;left:120.64px;top:288.00px" class="cls_020"><span class="cls_020">Reserved for use by interrupt/trap handler - may change</span></div>
<div style="position:absolute;left:120.39px;top:298.00px" class="cls_020"><span class="cls_020">under your feet</span></div>
<div style="position:absolute;left:39.50px;top:315.00px" class="cls_020"><span class="cls_020">28</span></div>
<div style="position:absolute;left:83.33px;top:315.00px" class="cls_020"><span class="cls_020">gp</span></div>
<div style="position:absolute;left:120.51px;top:315.00px" class="cls_020"><span class="cls_020">global pointer - some runtime systems maintain this to give</span></div>
<div style="position:absolute;left:120.39px;top:325.00px" class="cls_020"><span class="cls_020">easy access to (some) ‘‘static’’ or ‘‘extern’’ variables.</span></div>
<div style="position:absolute;left:39.50px;top:342.00px" class="cls_020"><span class="cls_020">29</span></div>
<div style="position:absolute;left:83.33px;top:342.00px" class="cls_020"><span class="cls_020">sp</span></div>
<div style="position:absolute;left:120.51px;top:342.00px" class="cls_020"><span class="cls_020">stack pointer</span></div>
<div style="position:absolute;left:39.50px;top:359.00px" class="cls_020"><span class="cls_020">30</span></div>
<div style="position:absolute;left:83.33px;top:359.00px" class="cls_020"><span class="cls_020">s8/fp</span></div>
<div style="position:absolute;left:120.57px;top:359.00px" class="cls_020"><span class="cls_020">9th register variable. Subroutines which need one can use</span></div>
<div style="position:absolute;left:120.39px;top:369.00px" class="cls_020"><span class="cls_020">this as a ‘‘frame pointer’’.</span></div>
<div style="position:absolute;left:39.50px;top:386.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:83.33px;top:386.00px" class="cls_020"><span class="cls_020">ra</span></div>
<div style="position:absolute;left:120.50px;top:386.00px" class="cls_020"><span class="cls_020">Return address for subroutine</span></div>
<div style="position:absolute;left:59.66px;top:405.00px" class="cls_020"><span class="cls_020">Table 2.1.  Conventional names of registers with usage mnemonics</span></div>
<div style="position:absolute;left:48.02px;top:420.67px" class="cls_006"><span class="cls_006">With the conventional uses of the registers go a set of conventional</span></div>
<div style="position:absolute;left:36.00px;top:431.67px" class="cls_006"><span class="cls_006">names.  Given  the  need  to  fit  in  with  the  conventions,  use  of  the</span></div>
<div style="position:absolute;left:36.00px;top:442.67px" class="cls_006"><span class="cls_006">conventional names is pretty much mandatory. The common names are</span></div>
<div style="position:absolute;left:36.00px;top:453.67px" class="cls_006"><span class="cls_006">described in Table 2.1,</span></div>
<div style="position:absolute;left:163.24px;top:453.67px" class="cls_006"><span class="cls_006">“Conventional names of registers with usage</span></div>
<div style="position:absolute;left:36.00px;top:464.67px" class="cls_006"><span class="cls_006">mnemonics”.</span></div>
<div style="position:absolute;left:36.00px;top:485.67px" class="cls_006"><span class="cls_006">Notes on conventional register names</span></div>
<div style="position:absolute;left:48.02px;top:499.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> at</span><span class="cls_006">: this register is reserved for use inside the synthetic instructions</span></div>
<div style="position:absolute;left:59.98px;top:510.67px" class="cls_006"><span class="cls_006">generated by the assembler. If the programmer must use it explicitly</span></div>
<div style="position:absolute;left:59.98px;top:521.67px" class="cls_006"><span class="cls_006">the directive </span><span class="cls_008">.noat</span><span class="cls_006"> stops the assembler from using it, but then there</span></div>
<div style="position:absolute;left:59.98px;top:532.67px" class="cls_006"><span class="cls_006">are some things the assembler won’t be able to do.</span></div>
<div style="position:absolute;left:48.03px;top:546.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> v0-v1</span><span class="cls_006">:  used   when  returning   non-floating-point  values  from  a</span></div>
<div style="position:absolute;left:59.98px;top:557.67px" class="cls_006"><span class="cls_006">subroutine. To return anything bigger than 2</span><span class="cls_003">×</span><span class="cls_006">32 bits, memory must</span></div>
<div style="position:absolute;left:59.98px;top:568.67px" class="cls_006"><span class="cls_006">be used (described in a later chapter).</span></div>
<div style="position:absolute;left:48.03px;top:582.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> a0-a3</span><span class="cls_006">: used to pass the first four non-FP parameters to a subroutine.</span></div>
<div style="position:absolute;left:59.97px;top:593.67px" class="cls_006"><span class="cls_006">That’s an occasionally-false oversimplification; the actual convention</span></div>
<div style="position:absolute;left:59.97px;top:604.67px" class="cls_006"><span class="cls_006">is fully described in a later chapter.</span></div>
<div style="position:absolute;left:48.02px;top:618.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> t0-t9</span><span class="cls_006">: by convention, subroutines may use these values without</span></div>
<div style="position:absolute;left:59.97px;top:629.67px" class="cls_006"><span class="cls_006">preserving them. This makes them easy to use as ‘‘temporaries’’ when</span></div>
<div style="position:absolute;left:59.97px;top:640.67px" class="cls_006"><span class="cls_006">evaluating expressions - but a caller must remember that they may</span></div>
<div style="position:absolute;left:59.97px;top:651.67px" class="cls_006"><span class="cls_006">be destroyed by a subroutine call.</span></div>
<div style="position:absolute;left:48.02px;top:665.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> s0-s8</span><span class="cls_006">: by convention, subroutines must guarantee that the values of</span></div>
<div style="position:absolute;left:59.98px;top:676.67px" class="cls_006"><span class="cls_006">these registers on exit are the same as they were on entry - either by</span></div>
<div style="position:absolute;left:59.98px;top:687.67px" class="cls_006"><span class="cls_006">not using them, or by saving them on the stack and restoring before</span></div>
<div style="position:absolute;left:59.98px;top:698.67px" class="cls_006"><span class="cls_006">exit.</span></div>
<div style="position:absolute;left:59.98px;top:712.67px" class="cls_006"><span class="cls_006">This makes them eminently suitable for use as ‘‘register variables’’ or</span></div>
<div style="position:absolute;left:59.98px;top:723.67px" class="cls_006"><span class="cls_006">for storing any value which must be preserved over a subroutine call.</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">2-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:36892px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:525.01px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:50.67px" class="cls_008"><span class="cls_008">k0-k1</span><span class="cls_006">: reserved for use by the trap/interrupt routines, which will not</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">restore their original value; so they are of little use to anyone else.</span></div>
<div style="position:absolute;left:228.02px;top:75.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:75.67px" class="cls_008"><span class="cls_008">gp</span><span class="cls_006">: (global pointer). If present, it will point to a load-time-determined</span></div>
<div style="position:absolute;left:239.98px;top:86.67px" class="cls_006"><span class="cls_006">location in the midst of your static data. This means that loads and</span></div>
<div style="position:absolute;left:239.98px;top:97.67px" class="cls_006"><span class="cls_006">stores to data lying within 32Kbytes either side of the </span><span class="cls_008">gp</span><span class="cls_006"> value can be</span></div>
<div style="position:absolute;left:239.98px;top:108.67px" class="cls_006"><span class="cls_006">performed in a single instruction using </span><span class="cls_008">gp</span><span class="cls_006"> as the base register.</span></div>
<div style="position:absolute;left:239.98px;top:122.67px" class="cls_006"><span class="cls_006">Without the global pointer, loading data from a static memory area</span></div>
<div style="position:absolute;left:239.98px;top:133.67px" class="cls_006"><span class="cls_006">takes two instructions: one to load the most significant bits of the 32-</span></div>
<div style="position:absolute;left:239.98px;top:144.67px" class="cls_006"><span class="cls_006">bit constant address computed by the compiler and loader, and one</span></div>
<div style="position:absolute;left:239.98px;top:155.67px" class="cls_006"><span class="cls_006">to do the data load.</span></div>
<div style="position:absolute;left:239.98px;top:169.67px" class="cls_006"><span class="cls_006">To use </span><span class="cls_008">gp</span><span class="cls_006"> a compiler must know at compile time that a datum will end</span></div>
<div style="position:absolute;left:239.98px;top:180.67px" class="cls_006"><span class="cls_006">up linked within a 64Kbyte range of memory locations. In practice it</span></div>
<div style="position:absolute;left:239.98px;top:191.67px" class="cls_006"><span class="cls_006">can’t know, only guess. The usual practice is to put ‘‘small’’ global</span></div>
<div style="position:absolute;left:239.98px;top:202.67px" class="cls_006"><span class="cls_006">data items in the area pointed to by </span><span class="cls_008">gp</span><span class="cls_006">, and to get the linker to</span></div>
<div style="position:absolute;left:239.98px;top:213.67px" class="cls_006"><span class="cls_006">complain if it still gets too big. The definition of what is “small” can</span></div>
<div style="position:absolute;left:239.98px;top:224.67px" class="cls_006"><span class="cls_006">typically be specified with a compiler switch (most compilers use “-</span></div>
<div style="position:absolute;left:239.98px;top:235.67px" class="cls_006"><span class="cls_006">G“). The most common default size is 8 bytes or less.</span></div>
<div style="position:absolute;left:239.98px;top:249.67px" class="cls_006"><span class="cls_006">Not all compilation systems or OS loaders support </span><span class="cls_008">gp.</span></div>
<div style="position:absolute;left:228.02px;top:263.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:263.67px" class="cls_008"><span class="cls_008">sp</span><span class="cls_006">: (stack pointer). Since it takes explicit instructions to raise and</span></div>
<div style="position:absolute;left:239.98px;top:274.67px" class="cls_006"><span class="cls_006">lower the stack pointer, it is generally done only on subroutine entry</span></div>
<div style="position:absolute;left:239.98px;top:285.67px" class="cls_006"><span class="cls_006">and exit; and it is the responsibility of the subroutine being called to</span></div>
<div style="position:absolute;left:239.98px;top:296.67px" class="cls_006"><span class="cls_006">do this. </span><span class="cls_008">sp</span><span class="cls_006"> is normally adjusted, on entry, to the lowest point that the</span></div>
<div style="position:absolute;left:239.98px;top:307.67px" class="cls_006"><span class="cls_006">stack will need to reach at any point in the subroutine. Now the</span></div>
<div style="position:absolute;left:239.98px;top:318.67px" class="cls_006"><span class="cls_006">compiler can access stack variables by a constant offset from </span><span class="cls_008">sp.</span></div>
<div style="position:absolute;left:239.98px;top:329.67px" class="cls_006"><span class="cls_006">Stack usage conventions are explained in a later chapter.</span></div>
<div style="position:absolute;left:228.03px;top:343.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:343.67px" class="cls_008"><span class="cls_008">fp</span><span class="cls_006">: (also known as s8). A subroutine will use a ‘‘frame pointer’’ to keep</span></div>
<div style="position:absolute;left:239.98px;top:354.67px" class="cls_006"><span class="cls_006">track of the stack if it wants to use operations which involve extending</span></div>
<div style="position:absolute;left:239.98px;top:365.67px" class="cls_006"><span class="cls_006">the stack by an amount which is determined at run-time. Some</span></div>
<div style="position:absolute;left:239.98px;top:376.67px" class="cls_006"><span class="cls_006">languages may do this explicitly; assembler programmers are always</span></div>
<div style="position:absolute;left:239.98px;top:387.67px" class="cls_006"><span class="cls_006">welcome to experiment; and (for many toolchains) C programs which</span></div>
<div style="position:absolute;left:239.98px;top:398.67px" class="cls_006"><span class="cls_006">use the ‘‘alloca’’ library routine will find themselves doing so.</span></div>
<div style="position:absolute;left:239.98px;top:412.67px" class="cls_006"><span class="cls_006">In this case it is not possible to access stack variables from </span><span class="cls_008">sp,</span><span class="cls_006"> so </span><span class="cls_008">fp</span></div>
<div style="position:absolute;left:239.98px;top:423.67px" class="cls_006"><span class="cls_006">is initialized by the function prologue to a constant position relative</span></div>
<div style="position:absolute;left:239.98px;top:434.67px" class="cls_006"><span class="cls_006">to the function’s stack frame. Note that a ‘‘frame pointer’’ subroutine</span></div>
<div style="position:absolute;left:239.98px;top:445.67px" class="cls_006"><span class="cls_006">may call or be called by subroutines which do not use the frame</span></div>
<div style="position:absolute;left:239.98px;top:456.67px" class="cls_006"><span class="cls_006">pointer; so long as the functions it calls preserve the value of </span><span class="cls_008">fp</span><span class="cls_006"> (as</span></div>
<div style="position:absolute;left:239.98px;top:467.67px" class="cls_006"><span class="cls_006">they should) this is OK.</span></div>
<div style="position:absolute;left:228.02px;top:481.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:481.67px" class="cls_008"><span class="cls_008">ra</span><span class="cls_006">: (return address). On entry to any subroutine, ra holds the address</span></div>
<div style="position:absolute;left:239.98px;top:492.67px" class="cls_006"><span class="cls_006">to which control should be returned - so a subroutine typically ends</span></div>
<div style="position:absolute;left:239.98px;top:503.67px" class="cls_006"><span class="cls_006">with the instruction ‘‘jr ra’’.</span></div>
<div style="position:absolute;left:239.98px;top:517.67px" class="cls_006"><span class="cls_006">Subroutines which themselves call subroutines must first save </span><span class="cls_008">ra,</span></div>
<div style="position:absolute;left:239.98px;top:528.67px" class="cls_006"><span class="cls_006">usually on the stack.</span></div>
<div style="position:absolute;left:216.00px;top:551.00px" class="cls_015"><span class="cls_015">Integer multiply unit and registers</span></div>
<div style="position:absolute;left:228.02px;top:564.67px" class="cls_006"><span class="cls_006">MIPS’ architects decided that integer multiplication was important</span></div>
<div style="position:absolute;left:216.00px;top:575.67px" class="cls_006"><span class="cls_006">enough to deserve a hard-wired instruction. This is not so common in</span></div>
<div style="position:absolute;left:216.00px;top:586.67px" class="cls_006"><span class="cls_006">RISCs, which might instead:</span></div>
<div style="position:absolute;left:228.02px;top:600.67px" class="cls_006"><span class="cls_006">• implement  a  ‘‘multiply  step’’  which  fits  in  the  standard  integer</span></div>
<div style="position:absolute;left:239.97px;top:611.67px" class="cls_006"><span class="cls_006">execution   pipeline,   and   require   software   routines   for   every</span></div>
<div style="position:absolute;left:239.97px;top:622.67px" class="cls_006"><span class="cls_006">multiplication (e.g. Sparc or AM29000); or</span></div>
<div style="position:absolute;left:228.02px;top:636.67px" class="cls_006"><span class="cls_006">• perform integer multiplication in the floating point unit - a good</span></div>
<div style="position:absolute;left:239.97px;top:647.67px" class="cls_006"><span class="cls_006">solution but which compromises the optional nature of the MIPS</span></div>
<div style="position:absolute;left:239.97px;top:658.67px" class="cls_006"><span class="cls_006">floating point ‘‘co-processor’’.</span></div>
<div style="position:absolute;left:228.02px;top:669.67px" class="cls_006"><span class="cls_006">The  multiply  unit  consumes  a  small  amount  of  die  area,  but</span></div>
<div style="position:absolute;left:216.00px;top:680.67px" class="cls_006"><span class="cls_006">dramatically   improves   performance</span></div>
<div style="position:absolute;left:412.05px;top:680.67px" class="cls_006"><span class="cls_006">(and   cache   performance)   over</span></div>
<div style="position:absolute;left:216.00px;top:691.67px" class="cls_006"><span class="cls_006">“multiply step” operations. It’s basic operation is to multiply two 32-bit</span></div>
<div style="position:absolute;left:216.00px;top:702.67px" class="cls_006"><span class="cls_006">values together to produce a 64-bit result, which is stored in two 32-bit</span></div>
<div style="position:absolute;left:305.77px;top:755.33px" class="cls_002"><span class="cls_002">2-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:37694px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:423.27px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:36.00px;top:50.67px" class="cls_006"><span class="cls_006">registers (called ‘‘hi’’ and</span></div>
<div style="position:absolute;left:168.88px;top:50.67px" class="cls_006"><span class="cls_006">‘‘lo’’) which are private to the multiply unit.</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_006"><span class="cls_006">Instructions </span><span class="cls_008">mfhi</span><span class="cls_006">, </span><span class="cls_008">mflo</span><span class="cls_006"> are defined to copy the result out into general</span></div>
<div style="position:absolute;left:36.00px;top:72.67px" class="cls_006"><span class="cls_006">registers.</span></div>
<div style="position:absolute;left:48.02px;top:83.67px" class="cls_006"><span class="cls_006">Unlike results for integer operations, the multiply result registers are</span></div>
<div style="position:absolute;left:36.00px;top:94.67px" class="cls_008"><span class="cls_008">interlocked</span><span class="cls_006">. An attempt to read out the results before the multiplication is</span></div>
<div style="position:absolute;left:36.00px;top:105.67px" class="cls_006"><span class="cls_006">complete results in the CPU being stopped until the operation completes.</span></div>
<div style="position:absolute;left:48.02px;top:116.67px" class="cls_006"><span class="cls_006">The integer multiply unit will also perform an integer division between</span></div>
<div style="position:absolute;left:36.00px;top:127.67px" class="cls_006"><span class="cls_006">values in two general-purpose registers; in this case the ‘‘lo’’ register stores</span></div>
<div style="position:absolute;left:36.00px;top:138.67px" class="cls_006"><span class="cls_006">the quotient, and the ‘‘hi’’ register the remainder.</span></div>
<div style="position:absolute;left:48.02px;top:149.67px" class="cls_006"><span class="cls_006">In the R30xx family, multiply operations take 12 clocks and division</span></div>
<div style="position:absolute;left:36.00px;top:160.67px" class="cls_006"><span class="cls_006">takes 35. The assembler has a synthetic multiply operation which starts</span></div>
<div style="position:absolute;left:36.00px;top:171.67px" class="cls_006"><span class="cls_006">the multiply and then retrieves the result into an ordinary register. Note</span></div>
<div style="position:absolute;left:36.00px;top:182.67px" class="cls_006"><span class="cls_006">that MIPS Corp.’s assembler may even substitute a series of shifts and</span></div>
<div style="position:absolute;left:36.00px;top:193.67px" class="cls_006"><span class="cls_006">adds for multiplication by a constant, to improve execution speed.</span></div>
<div style="position:absolute;left:48.02px;top:204.67px" class="cls_006"><span class="cls_006">Multiply/divide results are written into ‘‘hi’’ and ‘‘lo’’ as soon as they are</span></div>
<div style="position:absolute;left:36.00px;top:215.67px" class="cls_006"><span class="cls_006">available; the effect is not deferred until the writeback pipeline stage, as</span></div>
<div style="position:absolute;left:36.00px;top:226.67px" class="cls_006"><span class="cls_006">with writes to general purpose (GP) registers. If a </span><span class="cls_008">mfhi</span><span class="cls_006"> or </span><span class="cls_008">mflo</span><span class="cls_006"> instruction</span></div>
<div style="position:absolute;left:36.00px;top:237.67px" class="cls_006"><span class="cls_006">is interrupted by some kind of exception before it reaches the writeback</span></div>
<div style="position:absolute;left:36.00px;top:248.67px" class="cls_006"><span class="cls_006">stage of the pipeline, it will be aborted with the intention of restarting it.</span></div>
<div style="position:absolute;left:36.00px;top:259.67px" class="cls_006"><span class="cls_006">However, a subsequent multiply instruction which has passed the ALU</span></div>
<div style="position:absolute;left:36.00px;top:270.67px" class="cls_006"><span class="cls_006">stage will continue (in parallel with exception processing) and would</span></div>
<div style="position:absolute;left:36.00px;top:281.67px" class="cls_006"><span class="cls_006">overwrite the ‘‘hi’’ and ‘‘lo’’ register values, so that the re-execution of the</span></div>
<div style="position:absolute;left:36.00px;top:292.67px" class="cls_008"><span class="cls_008">mfhi</span><span class="cls_006"> would get wrong (i.e. new) data. For this reason it is recommended</span></div>
<div style="position:absolute;left:36.00px;top:303.67px" class="cls_006"><span class="cls_006">that a multiply should not be started within two instructions of an </span><span class="cls_008">mfhi/</span></div>
<div style="position:absolute;left:36.00px;top:314.67px" class="cls_008"><span class="cls_008">mflo</span><span class="cls_006">. The assembler will avoid doing this where it can.</span></div>
<div style="position:absolute;left:48.02px;top:325.67px" class="cls_006"><span class="cls_006">Integer multiply and divide operations never produce an exception,</span></div>
<div style="position:absolute;left:36.00px;top:336.67px" class="cls_006"><span class="cls_006">though divide by zero produces an undefined result. Compilers will often</span></div>
<div style="position:absolute;left:36.00px;top:347.67px" class="cls_006"><span class="cls_006">generate code to trap on errors, particularly on divide by zero. Frequently,</span></div>
<div style="position:absolute;left:36.00px;top:358.67px" class="cls_006"><span class="cls_006">this instruction sequence is placed after the divide is initiated, to allow it</span></div>
<div style="position:absolute;left:36.00px;top:369.67px" class="cls_006"><span class="cls_006">to execute concurrently with the divide (and avoid a performance loss).</span></div>
<div style="position:absolute;left:48.02px;top:380.67px" class="cls_006"><span class="cls_006">Instructions </span><span class="cls_008">mthi</span><span class="cls_006">, </span><span class="cls_008">mtlo</span><span class="cls_006"> are defined to setup the internal registers from</span></div>
<div style="position:absolute;left:36.00px;top:391.67px" class="cls_006"><span class="cls_006">general-purpose registers. They are essential to restore the values of ‘‘hi’’</span></div>
<div style="position:absolute;left:36.00px;top:402.67px" class="cls_006"><span class="cls_006">and ‘‘lo’’ when returning from an exception, but probably not for anything</span></div>
<div style="position:absolute;left:36.00px;top:413.67px" class="cls_006"><span class="cls_006">else.</span></div>
<div style="position:absolute;left:36.00px;top:436.00px" class="cls_015"><span class="cls_015">Instruction types</span></div>
<div style="position:absolute;left:48.02px;top:449.67px" class="cls_006"><span class="cls_006">A full list of R30xx family integer instructions is presented in Appendix</span></div>
<div style="position:absolute;left:36.00px;top:460.67px" class="cls_006"><span class="cls_006">A. Floating point instructions are listed in Appendix B of this manual.</span></div>
<div style="position:absolute;left:36.00px;top:471.67px" class="cls_006"><span class="cls_006">Currently, floating point instructions are only available in the R3081, and</span></div>
<div style="position:absolute;left:36.00px;top:482.67px" class="cls_006"><span class="cls_006">are described in the R3081 User’s Manual.</span></div>
<div style="position:absolute;left:48.02px;top:493.67px" class="cls_006"><span class="cls_006">The MIPS-1 ISA uses only three basic instruction encoding formats; this</span></div>
<div style="position:absolute;left:36.00px;top:504.67px" class="cls_006"><span class="cls_006">is one of the keys to the high-frequencies attained by RISC architectures.</span></div>
<div style="position:absolute;left:48.02px;top:515.67px" class="cls_006"><span class="cls_006">Instructions are mostly in numerical order; to simplify reading, the list</span></div>
<div style="position:absolute;left:36.00px;top:526.67px" class="cls_006"><span class="cls_006">is occasionally re-ordered for clarity.</span></div>
<div style="position:absolute;left:48.02px;top:548.67px" class="cls_006"><span class="cls_006">Throughout this manual, the description of various instructions will</span></div>
<div style="position:absolute;left:36.00px;top:559.67px" class="cls_006"><span class="cls_006">also refer to various subfields of the instruction. In general, the following</span></div>
<div style="position:absolute;left:36.00px;top:570.67px" class="cls_006"><span class="cls_006">typical nomenclature is used:</span></div>
<div style="position:absolute;left:48.02px;top:584.67px" class="cls_006"><span class="cls_006">op</span></div>
<div style="position:absolute;left:84.02px;top:584.67px" class="cls_006"><span class="cls_006">The basic op-code, which is 6 bits long. Instructions which large</span></div>
<div style="position:absolute;left:84.02px;top:595.67px" class="cls_006"><span class="cls_006">sub-fields (for example, large immediate values, such as required</span></div>
<div style="position:absolute;left:84.02px;top:606.67px" class="cls_006"><span class="cls_006">for the</span></div>
<div style="position:absolute;left:124.88px;top:606.67px" class="cls_006"><span class="cls_006">‘‘long’’ </span><span class="cls_008">j/jal</span><span class="cls_006"> instructions, or arithmetic with a</span></div>
<div style="position:absolute;left:366.66px;top:606.67px" class="cls_006"><span class="cls_006">16-bit</span></div>
<div style="position:absolute;left:84.02px;top:617.67px" class="cls_006"><span class="cls_006">constant)  have  a  unique</span></div>
<div style="position:absolute;left:220.74px;top:617.67px" class="cls_006"><span class="cls_006">‘‘op’’  field.  Other  instructions  are</span></div>
<div style="position:absolute;left:84.02px;top:628.67px" class="cls_006"><span class="cls_006">classified in groups sharing an ‘‘op’’ value, distinguished by</span></div>
<div style="position:absolute;left:84.02px;top:639.67px" class="cls_006"><span class="cls_006">other fields (‘‘op2’’ etc.).</span></div>
<div style="position:absolute;left:48.02px;top:653.67px" class="cls_006"><span class="cls_006">rs, rs1,</span></div>
<div style="position:absolute;left:48.02px;top:667.67px" class="cls_006"><span class="cls_006">rs2</span></div>
<div style="position:absolute;left:84.02px;top:667.67px" class="cls_006"><span class="cls_006">One or two fields identifying source registers.</span></div>
<div style="position:absolute;left:48.02px;top:681.67px" class="cls_006"><span class="cls_006">rd</span></div>
<div style="position:absolute;left:84.02px;top:681.67px" class="cls_006"><span class="cls_006">The register to be changed by this instruction.</span></div>
<div style="position:absolute;left:48.02px;top:695.67px" class="cls_006"><span class="cls_006">sa</span></div>
<div style="position:absolute;left:84.02px;top:695.67px" class="cls_006"><span class="cls_006">Shift-amount:  How  far  to  shift,  used  in  shift-by-constant</span></div>
<div style="position:absolute;left:84.02px;top:706.67px" class="cls_006"><span class="cls_006">instructions.</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">2-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:38496px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:525.01px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">op2</span></div>
<div style="position:absolute;left:264.02px;top:50.67px" class="cls_006"><span class="cls_006">Sub-code field used for the 3-register arithmetic/logical group of</span></div>
<div style="position:absolute;left:264.02px;top:61.67px" class="cls_006"><span class="cls_006">instructions (</span><span class="cls_008">op</span><span class="cls_006"> value of zero).</span></div>
<div style="position:absolute;left:228.02px;top:75.67px" class="cls_006"><span class="cls_006">offset</span></div>
<div style="position:absolute;left:264.03px;top:75.67px" class="cls_006"><span class="cls_006">16-bit signed </span><span class="cls_008">word</span><span class="cls_006"> offset defining the destination of a ‘‘PC-</span></div>
<div style="position:absolute;left:264.02px;top:86.67px" class="cls_006"><span class="cls_006">relative’’  branch.  The  branch  target  will  be  the  instruction</span></div>
<div style="position:absolute;left:264.02px;top:97.67px" class="cls_006"><span class="cls_006">‘‘offset’’ words away from the ‘‘delay slot’’ instruction </span><span class="cls_008">after</span><span class="cls_006"> the</span></div>
<div style="position:absolute;left:264.02px;top:108.67px" class="cls_006"><span class="cls_006">branch; so a branch-to-self has an offset of -1.</span></div>
<div style="position:absolute;left:228.02px;top:122.67px" class="cls_006"><span class="cls_006">target</span></div>
<div style="position:absolute;left:264.03px;top:122.67px" class="cls_006"><span class="cls_006">26-bit </span><span class="cls_008">word</span><span class="cls_006"> address to be jumped to (it corresponds to a 28-bit</span></div>
<div style="position:absolute;left:264.02px;top:133.67px" class="cls_006"><span class="cls_006">byte  address,  which  is  always  word-aligned).  The  long </span><span class="cls_008"> j</span></div>
<div style="position:absolute;left:264.02px;top:144.67px" class="cls_006"><span class="cls_006">instruction  is  rarely  used,  so  this  format  is  pretty  much</span></div>
<div style="position:absolute;left:264.02px;top:155.67px" class="cls_006"><span class="cls_006">exclusively for function calls (</span><span class="cls_008">jal</span><span class="cls_006">).</span></div>
<div style="position:absolute;left:264.02px;top:169.67px" class="cls_006"><span class="cls_006">The high-order 4 bits of the target address can’t be specified by</span></div>
<div style="position:absolute;left:264.02px;top:180.67px" class="cls_006"><span class="cls_006">this instruction, and are taken from the address of the jump</span></div>
<div style="position:absolute;left:264.02px;top:191.67px" class="cls_006"><span class="cls_006">instruction.  This  means  that  these  instructions  can  reach</span></div>
<div style="position:absolute;left:264.02px;top:202.67px" class="cls_006"><span class="cls_006">anywhere  in  the  256Mbyte  region  around  the  instructions’</span></div>
<div style="position:absolute;left:264.02px;top:213.67px" class="cls_006"><span class="cls_006">location. To jump further use a </span><span class="cls_008">jr</span><span class="cls_006"> (jump register) instruction.</span></div>
<div style="position:absolute;left:228.02px;top:227.67px" class="cls_006"><span class="cls_006">constant</span></div>
<div style="position:absolute;left:264.02px;top:241.67px" class="cls_006"><span class="cls_006">16-bit  integer  constant  for</span></div>
<div style="position:absolute;left:411.98px;top:241.67px" class="cls_006"><span class="cls_006">‘‘immediate’’  arithmetic  or  logic</span></div>
<div style="position:absolute;left:264.02px;top:252.67px" class="cls_006"><span class="cls_006">operations.</span></div>
<div style="position:absolute;left:228.02px;top:266.67px" class="cls_006"><span class="cls_006">mf</span></div>
<div style="position:absolute;left:264.02px;top:266.67px" class="cls_006"><span class="cls_006">Yet  another  extended  opcode  field,  this  time  used  by</span></div>
<div style="position:absolute;left:556.86px;top:266.67px" class="cls_006"><span class="cls_006">‘‘co-</span></div>
<div style="position:absolute;left:264.02px;top:277.67px" class="cls_006"><span class="cls_006">processor’’ type instructions.</span></div>
<div style="position:absolute;left:228.02px;top:291.67px" class="cls_006"><span class="cls_006">rg</span></div>
<div style="position:absolute;left:264.02px;top:291.67px" class="cls_006"><span class="cls_006">Field which may hold a source or destination register.</span></div>
<div style="position:absolute;left:228.02px;top:305.67px" class="cls_006"><span class="cls_006">crg</span></div>
<div style="position:absolute;left:264.02px;top:305.67px" class="cls_006"><span class="cls_006">Field to hold the number of a CPU control register (different from</span></div>
<div style="position:absolute;left:264.02px;top:316.67px" class="cls_006"><span class="cls_006">the integer register file). Called ‘‘crs’’/‘‘crd’’ in contexts where it</span></div>
<div style="position:absolute;left:264.02px;top:327.67px" class="cls_006"><span class="cls_006">must be a source/destination respectively.</span></div>
<div style="position:absolute;left:228.02px;top:338.67px" class="cls_006"><span class="cls_006">The instruction encodings have been chosen to facilitate the design of a</span></div>
<div style="position:absolute;left:216.00px;top:349.67px" class="cls_006"><span class="cls_006">high-frequency CPU. Specifically:.</span></div>
<div style="position:absolute;left:228.02px;top:363.67px" class="cls_006"><span class="cls_006">• The instruction encodings do reveal portions of the internal CPU</span></div>
<div style="position:absolute;left:239.97px;top:374.67px" class="cls_006"><span class="cls_006">design. Although there are variable encodings, those fields which are</span></div>
<div style="position:absolute;left:239.97px;top:385.67px" class="cls_006"><span class="cls_006">required very early in the pipeline are encoded in a very regular way:</span></div>
<div style="position:absolute;left:228.02px;top:399.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Source registers are always in the same place</span><span class="cls_006">: so that the CPU can</span></div>
<div style="position:absolute;left:239.98px;top:410.67px" class="cls_006"><span class="cls_006">fetch two instructions from the integer register file without any</span></div>
<div style="position:absolute;left:239.98px;top:421.67px" class="cls_006"><span class="cls_006">conditional decoding. Some instructions may not need both registers</span></div>
<div style="position:absolute;left:239.98px;top:432.67px" class="cls_006"><span class="cls_006">- but since the register file is designed to provide two source values</span></div>
<div style="position:absolute;left:239.98px;top:443.67px" class="cls_006"><span class="cls_006">on every clock nothing has been lost.</span></div>
<div style="position:absolute;left:228.03px;top:457.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:457.67px" class="cls_008"><span class="cls_008">16-bit  constant  is  always  in  the  same  place</span><span class="cls_006">:   permitting   the</span></div>
<div style="position:absolute;left:239.98px;top:468.67px" class="cls_006"><span class="cls_006">appropriate instruction bits to be fed directly into the ALU’s input</span></div>
<div style="position:absolute;left:239.98px;top:479.67px" class="cls_006"><span class="cls_006">multiplexer, without conditional shifts.</span></div>
<div style="position:absolute;left:216.00px;top:502.00px" class="cls_015"><span class="cls_015">Loading and storing: addressing modes</span></div>
<div style="position:absolute;left:228.02px;top:515.67px" class="cls_006"><span class="cls_006">As mentioned above, there is only one basic ‘‘addressing mode’’. Any</span></div>
<div style="position:absolute;left:216.00px;top:526.67px" class="cls_006"><span class="cls_006">load or store machine instruction can be written as:</span></div>
<div style="position:absolute;left:288.00px;top:548.00px" class="cls_028"><span class="cls_028">operation dest-reg, offset(src-reg)</span></div>
<div style="position:absolute;left:288.00px;top:568.00px" class="cls_028"><span class="cls_028">e.g.:lw $1, offset($2); sw $3, offset($4)</span></div>
<div style="position:absolute;left:228.02px;top:587.67px" class="cls_006"><span class="cls_006">Any of the GP registers can be used for the destination and source. The</span></div>
<div style="position:absolute;left:216.00px;top:598.67px" class="cls_006"><span class="cls_006">offset is a signed, 16-bit number (so can be anywhere between -32768 and</span></div>
<div style="position:absolute;left:216.00px;top:609.67px" class="cls_006"><span class="cls_006">32767); the program address used for the load is the sum of </span><span class="cls_008">dest-reg</span><span class="cls_006"> and</span></div>
<div style="position:absolute;left:216.00px;top:620.67px" class="cls_006"><span class="cls_006">the </span><span class="cls_008">offset</span><span class="cls_006">. This address mode is normally enough to pick out a particular</span></div>
<div style="position:absolute;left:216.00px;top:631.67px" class="cls_006"><span class="cls_006">member of a C structure (‘‘offset’’ being the distance between the start of</span></div>
<div style="position:absolute;left:216.00px;top:642.67px" class="cls_006"><span class="cls_006">the structure and the member required); it implements an array indexed</span></div>
<div style="position:absolute;left:216.00px;top:653.67px" class="cls_006"><span class="cls_006">by a constant; it is enough to reference function variables from the stack</span></div>
<div style="position:absolute;left:216.00px;top:664.67px" class="cls_006"><span class="cls_006">or frame pointer; to provide a reasonable sized global area around the </span><span class="cls_008">gp</span></div>
<div style="position:absolute;left:216.00px;top:675.67px" class="cls_006"><span class="cls_006">value for static and extern variables.</span></div>
<div style="position:absolute;left:228.02px;top:686.67px" class="cls_006"><span class="cls_006">The assembler provides the semblance of a simple direct addressing</span></div>
<div style="position:absolute;left:216.00px;top:697.67px" class="cls_006"><span class="cls_006">mode, to load the values of memory variables whose address can be</span></div>
<div style="position:absolute;left:216.00px;top:708.67px" class="cls_006"><span class="cls_006">computed at link time.</span></div>
<div style="position:absolute;left:305.77px;top:755.33px" class="cls_002"><span class="cls_002">2-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:39298px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:423.27px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">More complex modes such as double-register or scaled index must be</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_006"><span class="cls_006">implemented with sequences of instructions.</span></div>
<div style="position:absolute;left:36.00px;top:84.00px" class="cls_015"><span class="cls_015">Data types in Memory and registers</span></div>
<div style="position:absolute;left:48.02px;top:97.67px" class="cls_006"><span class="cls_006">The R30xx family CPUs can load or store between 1 and 4 bytes in a</span></div>
<div style="position:absolute;left:36.00px;top:108.67px" class="cls_006"><span class="cls_006">single operation. Naming conventions are used in the documentation and</span></div>
<div style="position:absolute;left:36.00px;top:119.67px" class="cls_006"><span class="cls_006">to build instruction mnemonics:</span></div>
<div style="position:absolute;left:84.70px;top:153.00px" class="cls_020"><span class="cls_020">‘‘C’’ name</span></div>
<div style="position:absolute;left:154.03px;top:153.00px" class="cls_020"><span class="cls_020">MIPS name     Size(bytes)</span></div>
<div style="position:absolute;left:300.81px;top:153.00px" class="cls_020"><span class="cls_020">Assembler</span></div>
<div style="position:absolute;left:299.35px;top:163.00px" class="cls_020"><span class="cls_020">mnemonic</span></div>
<div style="position:absolute;left:76.00px;top:182.00px" class="cls_020"><span class="cls_020">int</span></div>
<div style="position:absolute;left:148.06px;top:182.00px" class="cls_020"><span class="cls_020">word</span></div>
<div style="position:absolute;left:220.15px;top:182.00px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:292.19px;top:182.00px" class="cls_020"><span class="cls_020">‘‘w’’ as in </span><span class="cls_027">lw</span></div>
<div style="position:absolute;left:76.00px;top:199.00px" class="cls_020"><span class="cls_020">long</span></div>
<div style="position:absolute;left:148.09px;top:199.00px" class="cls_020"><span class="cls_020">word</span></div>
<div style="position:absolute;left:220.18px;top:199.00px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:292.22px;top:199.00px" class="cls_020"><span class="cls_020">‘‘w’’ as in </span><span class="cls_027">lw</span></div>
<div style="position:absolute;left:76.00px;top:216.00px" class="cls_020"><span class="cls_020">short</span></div>
<div style="position:absolute;left:148.11px;top:216.00px" class="cls_020"><span class="cls_020">halfword</span></div>
<div style="position:absolute;left:220.28px;top:216.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:292.32px;top:216.00px" class="cls_020"><span class="cls_020">‘‘h’’ as in </span><span class="cls_027">lh</span></div>
<div style="position:absolute;left:76.00px;top:233.00px" class="cls_020"><span class="cls_020">char</span></div>
<div style="position:absolute;left:148.10px;top:233.00px" class="cls_020"><span class="cls_020">byte</span></div>
<div style="position:absolute;left:220.19px;top:233.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:292.22px;top:233.00px" class="cls_020"><span class="cls_020">‘‘b’’ as in </span><span class="cls_027">lb</span></div>
<div style="position:absolute;left:36.00px;top:256.67px" class="cls_006"><span class="cls_006">Integer data types</span></div>
<div style="position:absolute;left:48.02px;top:267.67px" class="cls_006"><span class="cls_006">Byte and halfword loads come in two flavors:</span></div>
<div style="position:absolute;left:48.02px;top:281.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Sign-extend</span><span class="cls_006">: </span><span class="cls_008">lb</span><span class="cls_006"> and </span><span class="cls_008">lh</span><span class="cls_006"> load the value into the least significant bits of</span></div>
<div style="position:absolute;left:59.98px;top:292.67px" class="cls_006"><span class="cls_006">the 32-bit register, but fill the high order bits by copying the ‘‘sign bit’’</span></div>
<div style="position:absolute;left:59.98px;top:303.67px" class="cls_006"><span class="cls_006">(bit 7 of a byte, bit 16 of a half-word). This correctly converts a signed</span></div>
<div style="position:absolute;left:59.98px;top:314.67px" class="cls_006"><span class="cls_006">value to a 32-bit signed integer.</span></div>
<div style="position:absolute;left:48.03px;top:328.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Zero-extend</span><span class="cls_006">: instructions </span><span class="cls_008">lbu</span><span class="cls_006"> and </span><span class="cls_008">lhu</span><span class="cls_006"> load the value into the least</span></div>
<div style="position:absolute;left:59.98px;top:339.67px" class="cls_006"><span class="cls_006">significant bits of a 32-bit register, with the high order bits filled with</span></div>
<div style="position:absolute;left:59.98px;top:350.67px" class="cls_006"><span class="cls_006">zero. This correctly converts an unsigned value in memory to the</span></div>
<div style="position:absolute;left:59.98px;top:361.67px" class="cls_006"><span class="cls_006">corresponding 32-bit unsigned integer value; so byte value</span></div>
<div style="position:absolute;left:377.46px;top:361.67px" class="cls_006"><span class="cls_006">254</span></div>
<div style="position:absolute;left:59.98px;top:372.67px" class="cls_006"><span class="cls_006">becomes 32-bit value 254.</span></div>
<div style="position:absolute;left:48.03px;top:383.67px" class="cls_006"><span class="cls_006">If the byte-wide memory location whose address is in </span><span class="cls_008">t1</span><span class="cls_006"> contains the</span></div>
<div style="position:absolute;left:36.00px;top:394.67px" class="cls_006"><span class="cls_006">value </span><span class="cls_029">0xFE</span><span class="cls_006"> (-2, or 254 if interpreted as unsigned), then:</span></div>
<div style="position:absolute;left:108.00px;top:416.00px" class="cls_028"><span class="cls_028">lb</span></div>
<div style="position:absolute;left:144.04px;top:416.00px" class="cls_028"><span class="cls_028">t2, 0(t1)</span></div>
<div style="position:absolute;left:108.00px;top:426.00px" class="cls_028"><span class="cls_028">lbu</span></div>
<div style="position:absolute;left:144.06px;top:426.00px" class="cls_028"><span class="cls_028">t3, 0(t1)</span></div>
<div style="position:absolute;left:48.02px;top:445.67px" class="cls_006"><span class="cls_006">will leave </span><span class="cls_008">t2</span><span class="cls_006"> holding the value </span><span class="cls_029">0xFFFF FFFE</span><span class="cls_006"> (-2 as signed 32-bit) and</span><span class="cls_008">t3</span></div>
<div style="position:absolute;left:36.00px;top:456.67px" class="cls_006"><span class="cls_006">holding the value </span><span class="cls_029">0x0000 00FE</span><span class="cls_006"> (254 as signed or unsigned 32-bit).</span></div>
<div style="position:absolute;left:48.02px;top:467.67px" class="cls_006"><span class="cls_006">Subtle differences in the way shorter integers are extended to longer</span></div>
<div style="position:absolute;left:36.00px;top:478.67px" class="cls_006"><span class="cls_006">ones are a historical cause of C portability problems, and the modern C</span></div>
<div style="position:absolute;left:36.00px;top:489.67px" class="cls_006"><span class="cls_006">standards have elaborate rules. On machines like the MIPS, which does</span></div>
<div style="position:absolute;left:36.00px;top:500.67px" class="cls_006"><span class="cls_006">not  perform</span></div>
<div style="position:absolute;left:106.58px;top:500.67px" class="cls_006"><span class="cls_006">8-  or</span></div>
<div style="position:absolute;left:142.96px;top:500.67px" class="cls_006"><span class="cls_006">16-bit  precision  arithmetic  directly,  expressions</span></div>
<div style="position:absolute;left:36.00px;top:511.67px" class="cls_006"><span class="cls_006">involving </span><span class="cls_008">short</span><span class="cls_006"> or </span><span class="cls_008">char</span><span class="cls_006"> variables are less efficient than word operations.</span></div>
<div style="position:absolute;left:36.00px;top:532.67px" class="cls_006"><span class="cls_006">Unaligned loads and stores</span></div>
<div style="position:absolute;left:48.02px;top:543.67px" class="cls_006"><span class="cls_006">Normal loads and stores in the MIPS architecture must be aligned; half-</span></div>
<div style="position:absolute;left:36.00px;top:554.67px" class="cls_006"><span class="cls_006">words may be loaded only from 2-byte boundaries, and words only from 4-</span></div>
<div style="position:absolute;left:36.00px;top:565.67px" class="cls_006"><span class="cls_006">byte  boundaries.  A  load  instruction  with  an  unaligned  address  will</span></div>
<div style="position:absolute;left:36.00px;top:576.67px" class="cls_006"><span class="cls_006">produce a trap. Because CISC architectures such as the MC680x0 and</span></div>
<div style="position:absolute;left:36.00px;top:587.67px" class="cls_006"><span class="cls_006">iAPXx86 do handle unaligned loads and stores, this could complicate</span></div>
<div style="position:absolute;left:36.00px;top:598.67px" class="cls_006"><span class="cls_006">porting software from one of these architectures. The MIPS architecture</span></div>
<div style="position:absolute;left:36.00px;top:609.67px" class="cls_006"><span class="cls_006">does provide mechanisms to support this type of operation; in extremity,</span></div>
<div style="position:absolute;left:36.00px;top:620.67px" class="cls_006"><span class="cls_006">software can provide a trap handler which will emulate the desired load</span></div>
<div style="position:absolute;left:36.00px;top:631.67px" class="cls_006"><span class="cls_006">operation and hide this feature from the application.</span></div>
<div style="position:absolute;left:48.02px;top:642.67px" class="cls_006"><span class="cls_006">All data items declared by C code will be correctly aligned.</span></div>
<div style="position:absolute;left:48.02px;top:653.67px" class="cls_006"><span class="cls_006">But when it is known in advance that the program will transfer a word</span></div>
<div style="position:absolute;left:36.00px;top:664.67px" class="cls_006"><span class="cls_006">from an address whose alignment is unknown and will be computed at run</span></div>
<div style="position:absolute;left:36.00px;top:675.67px" class="cls_006"><span class="cls_006">time, the architecture does allow for a special 2-instruction sequence</span></div>
<div style="position:absolute;left:36.00px;top:686.67px" class="cls_006"><span class="cls_006">(much more efficient than a series of byte loads, shifts and assembly). This</span></div>
<div style="position:absolute;left:36.00px;top:697.67px" class="cls_006"><span class="cls_006">sequence is normally generated by the macro-instruction </span><span class="cls_008">ulw</span><span class="cls_006"> (unaligned</span></div>
<div style="position:absolute;left:36.00px;top:708.67px" class="cls_006"><span class="cls_006">load word).</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">2-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:40100px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:525.01px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">(A macro-instruction </span><span class="cls_008">ulh</span><span class="cls_006">, unaligned load half, is also provided, and is</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">synthesized by two loads, a shift, and a bitwise ‘‘or’’ operation.)</span></div>
<div style="position:absolute;left:228.02px;top:72.67px" class="cls_006"><span class="cls_006">The special machine instructions are </span><span class="cls_008">lwl</span><span class="cls_006"> and </span><span class="cls_008">lwr</span><span class="cls_006"> (load word left, load</span></div>
<div style="position:absolute;left:215.99px;top:83.67px" class="cls_006"><span class="cls_006">word right). ‘‘Left’’ and ‘‘right’’ are arithmetical directions, as in ‘‘shift left’’;</span></div>
<div style="position:absolute;left:215.99px;top:94.67px" class="cls_006"><span class="cls_006">‘‘left’’ is movement towards more significant bits, ‘‘right’’ is towards less</span></div>
<div style="position:absolute;left:215.99px;top:105.67px" class="cls_006"><span class="cls_006">significant bits.</span></div>
<div style="position:absolute;left:228.01px;top:116.67px" class="cls_006"><span class="cls_006">These instructions do three things:</span></div>
<div style="position:absolute;left:228.01px;top:130.67px" class="cls_006"><span class="cls_006">• load 1, 2, 3 or 4 bytes from within one aligned 4-byte (word) location;</span></div>
<div style="position:absolute;left:228.01px;top:144.67px" class="cls_006"><span class="cls_006">• shift that data to move the byte selected by the address to either the</span></div>
<div style="position:absolute;left:239.96px;top:155.67px" class="cls_006"><span class="cls_006">most-significant (</span><span class="cls_008">lwl</span><span class="cls_006">) or least-significant (</span><span class="cls_008">lwr</span><span class="cls_006">) end of a 32-bit field;</span></div>
<div style="position:absolute;left:228.01px;top:169.67px" class="cls_006"><span class="cls_006">• merge the bytes fetched from memory with the data already in the</span></div>
<div style="position:absolute;left:239.96px;top:180.67px" class="cls_006"><span class="cls_006">destination.</span></div>
<div style="position:absolute;left:228.01px;top:191.67px" class="cls_006"><span class="cls_006">This breaks most of the rules the architecture usually sticks by; it does</span></div>
<div style="position:absolute;left:215.99px;top:202.67px" class="cls_006"><span class="cls_006">a logical operation on a memory variable, for example. Special hardware</span></div>
<div style="position:absolute;left:215.99px;top:213.67px" class="cls_006"><span class="cls_006">allows the </span><span class="cls_008">lwl</span><span class="cls_006">, </span><span class="cls_008">lwr</span><span class="cls_006"> pair to be used in consecutive instructions, even though</span></div>
<div style="position:absolute;left:216.00px;top:224.67px" class="cls_006"><span class="cls_006">the second instruction uses the value generated by the first.</span></div>
<div style="position:absolute;left:228.02px;top:235.67px" class="cls_006"><span class="cls_006">For  example,  on  a  CPU  configured  as  big-endian  the  assembler</span></div>
<div style="position:absolute;left:216.00px;top:246.67px" class="cls_006"><span class="cls_006">instruction:</span></div>
<div style="position:absolute;left:288.00px;top:268.00px" class="cls_028"><span class="cls_028">ulw</span></div>
<div style="position:absolute;left:324.07px;top:268.00px" class="cls_028"><span class="cls_028">t1, 0(t2)</span></div>
<div style="position:absolute;left:288.00px;top:278.00px" class="cls_028"><span class="cls_028">add</span></div>
<div style="position:absolute;left:324.07px;top:278.00px" class="cls_028"><span class="cls_028">t4, t3, t1</span></div>
<div style="position:absolute;left:228.02px;top:297.67px" class="cls_006"><span class="cls_006">is implemented as:</span></div>
<div style="position:absolute;left:288.00px;top:319.00px" class="cls_028"><span class="cls_028">lwl</span></div>
<div style="position:absolute;left:324.07px;top:319.00px" class="cls_028"><span class="cls_028">t1, 0(t2)</span></div>
<div style="position:absolute;left:288.00px;top:329.00px" class="cls_028"><span class="cls_028">lwr</span></div>
<div style="position:absolute;left:324.07px;top:329.00px" class="cls_028"><span class="cls_028">t1, 3(t2)</span></div>
<div style="position:absolute;left:288.00px;top:339.00px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:349.00px" class="cls_028"><span class="cls_028">add</span></div>
<div style="position:absolute;left:324.07px;top:349.00px" class="cls_028"><span class="cls_028">t4, t3, t1</span></div>
<div style="position:absolute;left:228.02px;top:368.67px" class="cls_006"><span class="cls_006">Where:</span></div>
<div style="position:absolute;left:228.02px;top:382.67px" class="cls_006"><span class="cls_006">• the </span><span class="cls_008">lwl</span><span class="cls_006"> picks up the lowest-addressed byte of the unaligned 4-byte</span></div>
<div style="position:absolute;left:239.98px;top:393.67px" class="cls_006"><span class="cls_006">region, together with however many more bytes which fit into an</span></div>
<div style="position:absolute;left:239.98px;top:404.67px" class="cls_006"><span class="cls_006">aligned word. It then shifts them left, to form the most-significant</span></div>
<div style="position:absolute;left:239.98px;top:415.67px" class="cls_006"><span class="cls_006">bytes of the register value.</span></div>
<div style="position:absolute;left:228.03px;top:429.67px" class="cls_006"><span class="cls_006">• the </span><span class="cls_008">lwr</span><span class="cls_006"> is aimed at the highest-addressed byte in the unaligned 4-byte</span></div>
<div style="position:absolute;left:239.98px;top:440.67px" class="cls_006"><span class="cls_006">region. It loads it, together with any bytes which precede it in the</span></div>
<div style="position:absolute;left:239.98px;top:451.67px" class="cls_006"><span class="cls_006">same memory word, and shifts it right to get the least significant bits</span></div>
<div style="position:absolute;left:239.98px;top:462.67px" class="cls_006"><span class="cls_006">of the register value. The merge leaves the high-order bits unchanged.</span></div>
<div style="position:absolute;left:228.03px;top:476.67px" class="cls_006"><span class="cls_006">• Although special hardware ensures that a </span><span class="cls_008">nop</span><span class="cls_006"> is not required between</span></div>
<div style="position:absolute;left:239.98px;top:487.67px" class="cls_006"><span class="cls_006">the </span><span class="cls_008">lwl</span><span class="cls_006"> and </span><span class="cls_008">lwr</span><span class="cls_006">, there is still a load delay between the second of them</span></div>
<div style="position:absolute;left:239.97px;top:498.67px" class="cls_006"><span class="cls_006">and a normal instruction.</span></div>
<div style="position:absolute;left:228.02px;top:509.67px" class="cls_006"><span class="cls_006">Note that if </span><span class="cls_008">t2</span><span class="cls_006"> was in fact 4-byte aligned, then both instructions load the</span></div>
<div style="position:absolute;left:216.00px;top:520.67px" class="cls_006"><span class="cls_006">entire word; duplicating effort, but achieving the desired effect.</span></div>
<div style="position:absolute;left:228.02px;top:531.67px" class="cls_006"><span class="cls_006">CPU behavior when operating with little-endian byte order is described</span></div>
<div style="position:absolute;left:216.00px;top:542.67px" class="cls_006"><span class="cls_006">in a later chapter.</span></div>
<div style="position:absolute;left:216.00px;top:563.67px" class="cls_006"><span class="cls_006">Floating point data in memory</span></div>
<div style="position:absolute;left:228.02px;top:574.67px" class="cls_006"><span class="cls_006">Loads into floating point registers from 4-byte aligned memory move</span></div>
<div style="position:absolute;left:216.00px;top:585.67px" class="cls_006"><span class="cls_006">data without any interpretation - a program can load an invalid floating</span></div>
<div style="position:absolute;left:216.00px;top:596.67px" class="cls_006"><span class="cls_006">point number and no FP error will result until an arithmetic operation is</span></div>
<div style="position:absolute;left:216.00px;top:607.67px" class="cls_006"><span class="cls_006">requested with it as an operand.</span></div>
<div style="position:absolute;left:228.02px;top:618.67px" class="cls_006"><span class="cls_006">This allows a programmer to load single-precision values by a load into</span></div>
<div style="position:absolute;left:216.00px;top:629.67px" class="cls_006"><span class="cls_006">an even-numbered floating point register; but the programmer can also</span></div>
<div style="position:absolute;left:216.00px;top:640.67px" class="cls_006"><span class="cls_006">load a double-precision value by a macro instruction, so that:</span></div>
<div style="position:absolute;left:288.00px;top:662.00px" class="cls_028"><span class="cls_028">ldc1</span></div>
<div style="position:absolute;left:324.09px;top:662.00px" class="cls_028"><span class="cls_028">$f2, 24(t1)</span></div>
<div style="position:absolute;left:228.02px;top:681.67px" class="cls_006"><span class="cls_006">is expanded to two loads to consecutive registers:</span></div>
<div style="position:absolute;left:288.00px;top:703.00px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:703.00px" class="cls_028"><span class="cls_028">$f2, 24(t1)</span></div>
<div style="position:absolute;left:288.00px;top:713.00px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:713.00px" class="cls_028"><span class="cls_028">$f3, 28(t1)</span></div>
<div style="position:absolute;left:305.77px;top:755.33px" class="cls_002"><span class="cls_002">2-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:40902px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:423.27px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">The  C  compiler  aligns</span></div>
<div style="position:absolute;left:173.06px;top:50.67px" class="cls_006"><span class="cls_006">8-byte  long  double-precision  floating  point</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_006"><span class="cls_006">variables to 8-byte boundaries. R30xx family hardware does not require</span></div>
<div style="position:absolute;left:36.00px;top:72.67px" class="cls_006"><span class="cls_006">this  alignment;  but  it  is  done  to  avoid  compatibility  problems  with</span></div>
<div style="position:absolute;left:36.00px;top:83.67px" class="cls_006"><span class="cls_006">implementations of MIPS-2 or MIPS-3 CPUs such as the IDT R4600</span></div>
<div style="position:absolute;left:36.00px;top:94.67px" class="cls_006"><span class="cls_006">(Orion), where the </span><span class="cls_008">ldc1</span><span class="cls_006"> instruction is part of the machine code, and the</span></div>
<div style="position:absolute;left:36.01px;top:105.67px" class="cls_006"><span class="cls_006">alignment is necessary.</span></div>
<div style="position:absolute;left:36.00px;top:128.00px" class="cls_015"><span class="cls_015">BASIC ADDRESS SPACE</span></div>
<div style="position:absolute;left:48.02px;top:141.67px" class="cls_006"><span class="cls_006">The way in which MIPS processors use and handle addresses is subtly</span></div>
<div style="position:absolute;left:36.00px;top:152.67px" class="cls_006"><span class="cls_006">different from that of traditional CISC CPUs, and may appear confusing.</span></div>
<div style="position:absolute;left:36.00px;top:163.67px" class="cls_006"><span class="cls_006">Read the first part of this section carefully. Here are some guidelines:</span></div>
<div style="position:absolute;left:48.02px;top:177.67px" class="cls_006"><span class="cls_006">• The addresses put into programs are rarely the same as the physical</span></div>
<div style="position:absolute;left:59.97px;top:188.67px" class="cls_006"><span class="cls_006">addresses which come out of the chip (sometimes they’re close, but</span></div>
<div style="position:absolute;left:59.97px;top:199.67px" class="cls_006"><span class="cls_006">not the same). This manual will refer to them as </span><span class="cls_008">program addresses</span></div>
<div style="position:absolute;left:59.97px;top:210.67px" class="cls_006"><span class="cls_006">and </span><span class="cls_008">physical addresses</span><span class="cls_006"> respectively. A more common name for</span></div>
<div style="position:absolute;left:59.96px;top:221.67px" class="cls_006"><span class="cls_006">program addresses is “virtual addresses”; note that the use of the</span></div>
<div style="position:absolute;left:59.96px;top:232.67px" class="cls_006"><span class="cls_006">term “virtual address” does not necessarily imply that an operating</span></div>
<div style="position:absolute;left:59.96px;top:243.67px" class="cls_006"><span class="cls_006">system must perform virtual memory management (e.g. demand</span></div>
<div style="position:absolute;left:59.96px;top:254.67px" class="cls_006"><span class="cls_006">paging from disks...), but rather that the address undergoes some</span></div>
<div style="position:absolute;left:59.96px;top:265.67px" class="cls_006"><span class="cls_006">transformation before being presented to physical memory. Although</span></div>
<div style="position:absolute;left:59.96px;top:276.67px" class="cls_006"><span class="cls_006">virtual address is a proper term, this manual will typically use the</span></div>
<div style="position:absolute;left:59.96px;top:287.67px" class="cls_006"><span class="cls_006">term “program address” to avoid confusing virtual addresses with</span></div>
<div style="position:absolute;left:59.96px;top:298.67px" class="cls_006"><span class="cls_006">virtual memory management requirements.</span></div>
<div style="position:absolute;left:48.01px;top:312.67px" class="cls_006"><span class="cls_006">• A MIPS-1 CPU has two operating modes: user and kernel. In user</span></div>
<div style="position:absolute;left:59.96px;top:323.67px" class="cls_006"><span class="cls_006">mode, any address above 2Gbytes (most-significant bit of the address</span></div>
<div style="position:absolute;left:59.96px;top:334.67px" class="cls_006"><span class="cls_006">set) is illegal and causes a trap. Also, some instructions cause a trap</span></div>
<div style="position:absolute;left:59.96px;top:345.67px" class="cls_006"><span class="cls_006">in user mode.</span></div>
<div style="position:absolute;left:48.01px;top:359.67px" class="cls_006"><span class="cls_006">• The 32-bit program address space is divided into four big areas with</span></div>
<div style="position:absolute;left:59.96px;top:370.67px" class="cls_006"><span class="cls_006">traditional names; and different things happen according to the area</span></div>
<div style="position:absolute;left:59.96px;top:381.67px" class="cls_006"><span class="cls_006">an address lies in:</span></div>
<div style="position:absolute;left:48.01px;top:395.67px" class="cls_006"><span class="cls_006">kuseg</span><span class="cls_029">  0000 0000 - 7FFF FFFF</span><span class="cls_006"> (low 2Gbytes): these are the addresses</span></div>
<div style="position:absolute;left:84.01px;top:406.67px" class="cls_006"><span class="cls_006">permitted in user mode. In machines with an MMU (“E” versions</span></div>
<div style="position:absolute;left:84.01px;top:417.67px" class="cls_006"><span class="cls_006">of the R30xx family), they will always be translated (more about</span></div>
<div style="position:absolute;left:84.01px;top:428.67px" class="cls_006"><span class="cls_006">the R30xx MMU in a later chapter). Software should not attempt</span></div>
<div style="position:absolute;left:84.01px;top:439.67px" class="cls_006"><span class="cls_006">to use these addresses unless the MMU is set up.</span></div>
<div style="position:absolute;left:84.01px;top:453.67px" class="cls_006"><span class="cls_006">For machines without an MMU (“base” versions of the R30xx</span></div>
<div style="position:absolute;left:84.01px;top:464.67px" class="cls_006"><span class="cls_006">family),  the  kuseg</span></div>
<div style="position:absolute;left:187.30px;top:464.67px" class="cls_006"><span class="cls_006">“program  address”  is  transformed  to  a</span></div>
<div style="position:absolute;left:84.01px;top:475.67px" class="cls_006"><span class="cls_006">physical   address   by   adding   a</span></div>
<div style="position:absolute;left:262.01px;top:475.67px" class="cls_006"><span class="cls_006">1GB   offset;   the   address</span></div>
<div style="position:absolute;left:84.01px;top:486.67px" class="cls_006"><span class="cls_006">transformations for “base versions” of the R30xx family are</span></div>
<div style="position:absolute;left:84.01px;top:497.67px" class="cls_006"><span class="cls_006">described  later  in  this  chapter.  Note,  however,  that  many</span></div>
<div style="position:absolute;left:84.01px;top:508.67px" class="cls_006"><span class="cls_006">embedded applications do not use this address segment (those</span></div>
<div style="position:absolute;left:84.01px;top:519.67px" class="cls_006"><span class="cls_006">applications  which  do  not  require  that  the  kernel  and  its</span></div>
<div style="position:absolute;left:84.01px;top:530.67px" class="cls_006"><span class="cls_006">resources be protected from user tasks).</span></div>
<div style="position:absolute;left:48.01px;top:544.67px" class="cls_006"><span class="cls_006">kseg0</span></div>
<div style="position:absolute;left:84.01px;top:544.67px" class="cls_029"><span class="cls_029">0x8000 0000 -</span></div>
<div style="position:absolute;left:171.02px;top:544.67px" class="cls_029"><span class="cls_029">9FFF FFFF</span><span class="cls_006"> (512 Mbytes): these addresses are</span></div>
<div style="position:absolute;left:84.01px;top:555.67px" class="cls_006"><span class="cls_006">‘‘translated’’ into physical addresses by merely stripping off the</span></div>
<div style="position:absolute;left:84.01px;top:566.67px" class="cls_006"><span class="cls_006">top bit, mapping them contiguously into the low 512 Mbytes of</span></div>
<div style="position:absolute;left:84.01px;top:577.67px" class="cls_006"><span class="cls_006">physical memory. This transformation operates the same for</span></div>
<div style="position:absolute;left:84.01px;top:588.67px" class="cls_006"><span class="cls_006">both “base” and “E” family members. This segment is referred to</span></div>
<div style="position:absolute;left:84.01px;top:599.67px" class="cls_006"><span class="cls_006">as “unmapped” because “E” version devices cannot redirect this</span></div>
<div style="position:absolute;left:84.01px;top:610.67px" class="cls_006"><span class="cls_006">translation to a different area of physical memory.</span></div>
<div style="position:absolute;left:84.01px;top:624.67px" class="cls_006"><span class="cls_006">Addresses in this region are always accessed through the cache,</span></div>
<div style="position:absolute;left:84.01px;top:635.67px" class="cls_006"><span class="cls_006">so may not be used until the caches are properly initialized. They</span></div>
<div style="position:absolute;left:84.01px;top:646.67px" class="cls_006"><span class="cls_006">will be used for most programs and data in systems using “base”</span></div>
<div style="position:absolute;left:84.01px;top:657.67px" class="cls_006"><span class="cls_006">family members; and will be used for the OS kernel for systems</span></div>
<div style="position:absolute;left:84.01px;top:668.67px" class="cls_006"><span class="cls_006">which do use the MMU (“E” version devices).</span></div>
<div style="position:absolute;left:292.02px;top:755.34px" class="cls_002"><span class="cls_002">2-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:41704px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:525.01px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">kseg1</span></div>
<div style="position:absolute;left:264.02px;top:50.67px" class="cls_029"><span class="cls_029">0xA000 0000 - BFFF FFFF</span><span class="cls_006"> (512 Mbytes): these addresses are</span></div>
<div style="position:absolute;left:264.02px;top:61.67px" class="cls_006"><span class="cls_006">mapped into physical addresses by stripping off the leading three</span></div>
<div style="position:absolute;left:264.02px;top:72.67px" class="cls_006"><span class="cls_006">bits, giving a duplicate mapping of the low</span></div>
<div style="position:absolute;left:500.66px;top:72.67px" class="cls_006"><span class="cls_006">512 Mbytes of</span></div>
<div style="position:absolute;left:264.02px;top:83.67px" class="cls_006"><span class="cls_006">physical memory. However, kseg1 program address accesses will</span></div>
<div style="position:absolute;left:264.02px;top:94.67px" class="cls_006"><span class="cls_006">not use the cache.</span></div>
<div style="position:absolute;left:264.02px;top:108.67px" class="cls_006"><span class="cls_006">The </span><span class="cls_008">kseg1</span><span class="cls_006"> region is the only chunk of the memory map which is</span></div>
<div style="position:absolute;left:264.02px;top:119.67px" class="cls_006"><span class="cls_006">guaranteed to behave properly from system reset; that’s why the</span></div>
<div style="position:absolute;left:264.02px;top:130.67px" class="cls_006"><span class="cls_006">after-reset starting point (</span><span class="cls_029"> 0xBFC0</span></div>
<div style="position:absolute;left:440.01px;top:130.67px" class="cls_029"><span class="cls_029">0000</span><span class="cls_006">, commonly called the</span></div>
<div style="position:absolute;left:264.02px;top:141.67px" class="cls_006"><span class="cls_006">“reset exception vector”) lies within it. The </span><span class="cls_008">physical</span><span class="cls_006"> address of</span></div>
<div style="position:absolute;left:264.02px;top:152.67px" class="cls_006"><span class="cls_006">the starting point is</span></div>
<div style="position:absolute;left:376.90px;top:152.67px" class="cls_029"><span class="cls_029">0x1FC0 0000</span><span class="cls_006"> - which means that the</span></div>
<div style="position:absolute;left:264.02px;top:163.67px" class="cls_006"><span class="cls_006">hardware should place the boot ROM at this physical address.</span></div>
<div style="position:absolute;left:264.02px;top:177.67px" class="cls_006"><span class="cls_006">Software will therefore use this region for the initial program</span></div>
<div style="position:absolute;left:264.02px;top:188.67px" class="cls_006"><span class="cls_006">ROM, and most systems also use it for I/O registers. In general,</span></div>
<div style="position:absolute;left:264.02px;top:199.67px" class="cls_006"><span class="cls_006">IO devices should always be mapped to addresses that are</span></div>
<div style="position:absolute;left:264.02px;top:210.67px" class="cls_006"><span class="cls_006">accessible from Kseg1, and system ROM is always mapped to</span></div>
<div style="position:absolute;left:264.02px;top:221.67px" class="cls_006"><span class="cls_006">contain the reset exception vector. Note that code in the ROM</span></div>
<div style="position:absolute;left:264.02px;top:232.67px" class="cls_006"><span class="cls_006">can then be accessed uncacheably (during boot up) using kseg1</span></div>
<div style="position:absolute;left:264.02px;top:243.67px" class="cls_006"><span class="cls_006">program addresses, and also can be accessed cacheably (for</span></div>
<div style="position:absolute;left:264.02px;top:254.67px" class="cls_006"><span class="cls_006">normal operation) using kseg0 program addresses.</span></div>
<div style="position:absolute;left:228.02px;top:268.67px" class="cls_006"><span class="cls_006">kseg2</span></div>
<div style="position:absolute;left:264.02px;top:268.67px" class="cls_029"><span class="cls_029">0xC000 0000 -</span></div>
<div style="position:absolute;left:359.28px;top:268.67px" class="cls_029"><span class="cls_029">FFFF</span></div>
<div style="position:absolute;left:400.52px;top:268.67px" class="cls_029"><span class="cls_029">FFFF</span><span class="cls_006">  (1  Gbyte):  this  area  is  only</span></div>
<div style="position:absolute;left:264.02px;top:279.67px" class="cls_006"><span class="cls_006">accessible in kernel mode. As for kuseg, in “E” devices program</span></div>
<div style="position:absolute;left:264.02px;top:290.67px" class="cls_006"><span class="cls_006">addresses are translated by the MMU into physical addresses;</span></div>
<div style="position:absolute;left:264.02px;top:301.67px" class="cls_006"><span class="cls_006">thus, these addresses must not be referenced prior to MMU</span></div>
<div style="position:absolute;left:264.02px;top:312.67px" class="cls_006"><span class="cls_006">initialization.   For</span></div>
<div style="position:absolute;left:362.18px;top:312.67px" class="cls_006"><span class="cls_006">“base   versions”,   physical   addresses   are</span></div>
<div style="position:absolute;left:264.02px;top:323.67px" class="cls_006"><span class="cls_006">generated to be the same as program addresses for kseg2.</span></div>
<div style="position:absolute;left:264.02px;top:337.67px" class="cls_006"><span class="cls_006">Note that many systems will not need this region. In “E” versions,</span></div>
<div style="position:absolute;left:264.02px;top:348.67px" class="cls_006"><span class="cls_006">it frequently contains OS structures such as page tables; simpler</span></div>
<div style="position:absolute;left:264.02px;top:359.67px" class="cls_006"><span class="cls_006">OS’es probably will have little need for kseg2.</span></div>
<div style="position:absolute;left:216.00px;top:382.00px" class="cls_015"><span class="cls_015">SUMMARY OF SYSTEM ADDRESSING</span></div>
<div style="position:absolute;left:228.02px;top:395.67px" class="cls_006"><span class="cls_006">MIPS  program  addresses  are  rarely  simply  the  same  as  physical</span></div>
<div style="position:absolute;left:216.00px;top:406.67px" class="cls_006"><span class="cls_006">addresses, but simple embedded software will probably use addresses in</span></div>
<div style="position:absolute;left:216.00px;top:417.67px" class="cls_006"><span class="cls_006">kseg0 and kseg1, where the program address is related in an obvious and</span></div>
<div style="position:absolute;left:216.00px;top:428.67px" class="cls_006"><span class="cls_006">unchangeable way to physical addresses.</span></div>
<div style="position:absolute;left:228.02px;top:439.67px" class="cls_006"><span class="cls_006">Physical memory locations from</span></div>
<div style="position:absolute;left:391.72px;top:439.67px" class="cls_029"><span class="cls_029">0x2000 0000</span><span class="cls_006"> (512Mbyte) upward may</span></div>
<div style="position:absolute;left:215.99px;top:450.67px" class="cls_006"><span class="cls_006">be difficult to access. In “E” versions of the R30xx family, the only way to</span></div>
<div style="position:absolute;left:215.99px;top:461.67px" class="cls_006"><span class="cls_006">reach these addresses is through the MMU. In “base” family members,</span></div>
<div style="position:absolute;left:215.99px;top:472.67px" class="cls_006"><span class="cls_006">certain of these physical addresses can be reached using kseg2 or kuseg</span></div>
<div style="position:absolute;left:215.99px;top:483.67px" class="cls_006"><span class="cls_006">addresses: the address transformations for base R30xx family members is</span></div>
<div style="position:absolute;left:215.99px;top:494.67px" class="cls_006"><span class="cls_006">described later in this chapter.</span></div>
<div style="position:absolute;left:216.00px;top:517.00px" class="cls_015"><span class="cls_015">Kernel vs. user mode</span></div>
<div style="position:absolute;left:228.02px;top:530.67px" class="cls_006"><span class="cls_006">In kernel mode (the CPU resets into this state), all program addresses</span></div>
<div style="position:absolute;left:216.00px;top:541.67px" class="cls_006"><span class="cls_006">are accessible.</span></div>
<div style="position:absolute;left:228.02px;top:552.67px" class="cls_006"><span class="cls_006">In user mode:</span></div>
<div style="position:absolute;left:228.02px;top:566.67px" class="cls_006"><span class="cls_006">• Program addresses above 2Gbytes (top bit set) are illegal and will</span></div>
<div style="position:absolute;left:239.97px;top:577.67px" class="cls_006"><span class="cls_006">cause a trap.</span></div>
<div style="position:absolute;left:239.97px;top:591.67px" class="cls_006"><span class="cls_006">Note that if the CPU has an MMU, this means all valid user mode</span></div>
<div style="position:absolute;left:239.97px;top:602.67px" class="cls_006"><span class="cls_006">addresses must be translated by the MMU; thus, User mode for “E”</span></div>
<div style="position:absolute;left:239.97px;top:613.67px" class="cls_006"><span class="cls_006">devices typically requires the use of a memory-mapped OS.</span></div>
<div style="position:absolute;left:239.97px;top:627.67px" class="cls_006"><span class="cls_006">For “base” CPUs, kuseg addresses are mapped to a distinct area of</span></div>
<div style="position:absolute;left:239.97px;top:638.67px" class="cls_006"><span class="cls_006">physical  memory.  Thus,  kernel  memory  resources  (including  IO</span></div>
<div style="position:absolute;left:239.97px;top:649.67px" class="cls_006"><span class="cls_006">devices) can be made inaccessible to User mode software, without</span></div>
<div style="position:absolute;left:239.97px;top:660.67px" class="cls_006"><span class="cls_006">requiring a memory-mapping function from the OS. Alternately, the</span></div>
<div style="position:absolute;left:239.97px;top:671.67px" class="cls_006"><span class="cls_006">hardware  can  choose  to</span></div>
<div style="position:absolute;left:375.25px;top:671.67px" class="cls_006"><span class="cls_006">“ignore”  high-order  address  bits  when</span></div>
<div style="position:absolute;left:239.97px;top:682.67px" class="cls_006"><span class="cls_006">performing address decoding, thus “condensing” kuseg, kseg2, kseg1,</span></div>
<div style="position:absolute;left:239.97px;top:693.67px" class="cls_006"><span class="cls_006">and kseg0 into the same physical memory.</span></div>
<div style="position:absolute;left:305.77px;top:755.34px" class="cls_002"><span class="cls_002">2-9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:42506px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:423.27px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">• Instructions beyond the standard user set become illegal. Specifically,</span></div>
<div style="position:absolute;left:59.97px;top:61.67px" class="cls_006"><span class="cls_006">the kernel can prevent User mode software from accessing the on-</span></div>
<div style="position:absolute;left:59.97px;top:72.67px" class="cls_006"><span class="cls_006">chip CP0 (system control coprocessor, which controls exception and</span></div>
<div style="position:absolute;left:59.97px;top:83.67px" class="cls_006"><span class="cls_006">machine state and performs the memory management functions of</span></div>
<div style="position:absolute;left:59.97px;top:94.67px" class="cls_006"><span class="cls_006">the CPU).</span></div>
<div style="position:absolute;left:48.02px;top:105.67px" class="cls_006"><span class="cls_006">Thus, the primary differences between User and Kernel modes are:</span></div>
<div style="position:absolute;left:48.02px;top:119.67px" class="cls_006"><span class="cls_006">• User mode tasks can be inhibited from accessing kernel memory</span></div>
<div style="position:absolute;left:59.97px;top:130.67px" class="cls_006"><span class="cls_006">resources, including OS data structures and IO devices. This also</span></div>
<div style="position:absolute;left:59.97px;top:141.67px" class="cls_006"><span class="cls_006">means that various user tasks can be protected from each other.</span></div>
<div style="position:absolute;left:48.02px;top:155.67px" class="cls_006"><span class="cls_006">• User mode tasks can be inhibited from modifying the basic machine</span></div>
<div style="position:absolute;left:59.97px;top:166.67px" class="cls_006"><span class="cls_006">state, by prohibiting accesses to CP0.</span></div>
<div style="position:absolute;left:48.02px;top:177.67px" class="cls_006"><span class="cls_006">Note that the kernel/user mode bit does not change the interpretation</span></div>
<div style="position:absolute;left:36.00px;top:188.67px" class="cls_006"><span class="cls_006">of anything - just some things cease to be allowed in user mode. In kernel</span></div>
<div style="position:absolute;left:36.00px;top:199.67px" class="cls_006"><span class="cls_006">mode the CPU can access low addresses just as if it was in user mode, and</span></div>
<div style="position:absolute;left:36.00px;top:210.67px" class="cls_006"><span class="cls_006">they will be translated in the same way.</span></div>
<div style="position:absolute;left:36.00px;top:233.00px" class="cls_015"><span class="cls_015">Memory map for CPUs without MMU hardware</span></div>
<div style="position:absolute;left:48.02px;top:246.67px" class="cls_006"><span class="cls_006">The treatment of kseg0 and kseg1 addresses is the same for all IDT</span></div>
<div style="position:absolute;left:36.00px;top:257.67px" class="cls_006"><span class="cls_006">R30xx CPUs. If the system can be implemented using only physical</span></div>
<div style="position:absolute;left:36.00px;top:268.67px" class="cls_006"><span class="cls_006">addresses in the low 512Mbytes, and system software can be written to use</span></div>
<div style="position:absolute;left:36.00px;top:279.67px" class="cls_006"><span class="cls_006">only kseg0 and kseg1, then the choice of “base” vs. “E” versions of the</span></div>
<div style="position:absolute;left:36.00px;top:290.67px" class="cls_006"><span class="cls_006">R30xx family is not relevant.</span></div>
<div style="position:absolute;left:48.02px;top:301.67px" class="cls_006"><span class="cls_006">For versions without the MMU (“base versions”), addresses in kuseg and</span></div>
<div style="position:absolute;left:36.00px;top:312.67px" class="cls_006"><span class="cls_006">kseg2 will undergo a fixed address translation, and provide the system</span></div>
<div style="position:absolute;left:36.00px;top:323.67px" class="cls_006"><span class="cls_006">designer the option to provide additional memory.</span></div>
<div style="position:absolute;left:48.02px;top:334.67px" class="cls_006"><span class="cls_006">The base members of the R30xx family provide the following address</span></div>
<div style="position:absolute;left:36.00px;top:345.67px" class="cls_006"><span class="cls_006">translations for kuseg and kseg2 program addresses:</span></div>
<div style="position:absolute;left:48.02px;top:359.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> kuseg</span><span class="cls_006">:  this  region</span></div>
<div style="position:absolute;left:164.71px;top:359.67px" class="cls_006"><span class="cls_006">(the  low</span></div>
<div style="position:absolute;left:215.25px;top:359.67px" class="cls_006"><span class="cls_006">2Gbytes  of  program  addresses)  is</span></div>
<div style="position:absolute;left:59.97px;top:370.67px" class="cls_006"><span class="cls_006">translated  to  a  contiguous</span></div>
<div style="position:absolute;left:209.73px;top:370.67px" class="cls_006"><span class="cls_006">2Gbyte  physical  region  between</span></div>
<div style="position:absolute;left:385.89px;top:370.67px" class="cls_006"><span class="cls_006">1-</span></div>
<div style="position:absolute;left:59.97px;top:381.67px" class="cls_006"><span class="cls_006">3Gbytes. In effect, a 1GB offset is added to each kuseg program</span></div>
<div style="position:absolute;left:59.97px;top:392.67px" class="cls_006"><span class="cls_006">address. In hex:</span></div>
<div style="position:absolute;left:81.98px;top:415.00px" class="cls_020"><span class="cls_020">Program address</span></div>
<div style="position:absolute;left:238.35px;top:415.00px" class="cls_020"><span class="cls_020">Physical Address</span></div>
<div style="position:absolute;left:81.98px;top:434.00px" class="cls_028"><span class="cls_028">0x0000 0000 -</span></div>
<div style="position:absolute;left:202.00px;top:434.00px" class="cls_021"><span class="cls_021">→</span></div>
<div style="position:absolute;left:238.00px;top:434.00px" class="cls_028"><span class="cls_028">0x4000 0000 -</span></div>
<div style="position:absolute;left:81.98px;top:444.00px" class="cls_028"><span class="cls_028">0x7FFF FFFF</span></div>
<div style="position:absolute;left:238.00px;top:444.00px" class="cls_028"><span class="cls_028">0xBFFF FFFF</span></div>
<div style="position:absolute;left:48.02px;top:463.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> kseg2</span><span class="cls_006">: these program addresses are genuinely untranslated. So</span></div>
<div style="position:absolute;left:59.97px;top:474.67px" class="cls_006"><span class="cls_006">program addresses from </span><span class="cls_029">0xC000 0000</span></div>
<div style="position:absolute;left:261.63px;top:474.67px" class="cls_029"><span class="cls_029">-</span></div>
<div style="position:absolute;left:277.47px;top:474.67px" class="cls_029"><span class="cls_029">0xFFFF FFFF</span><span class="cls_006"> emerge as</span></div>
<div style="position:absolute;left:59.97px;top:485.67px" class="cls_006"><span class="cls_006">identical physical addresses.</span></div>
<div style="position:absolute;left:48.02px;top:496.67px" class="cls_006"><span class="cls_006">This means that “base” versions can generate most physical addresses</span></div>
<div style="position:absolute;left:36.00px;top:507.67px" class="cls_006"><span class="cls_006">(without the use of an MMU), except for a gap between 512Mbyte and</span></div>
<div style="position:absolute;left:36.00px;top:518.67px" class="cls_006"><span class="cls_006">1Gbyte (0x2000 0000 through 0x3FFF FFFF). As noted above, many</span></div>
<div style="position:absolute;left:36.00px;top:529.67px" class="cls_006"><span class="cls_006">systems may ignore high-order address bits when performing address</span></div>
<div style="position:absolute;left:36.00px;top:540.67px" class="cls_006"><span class="cls_006">decoding, thus condensing all physical memory into the lowest 512MB</span></div>
<div style="position:absolute;left:36.00px;top:551.67px" class="cls_006"><span class="cls_006">addresses.</span></div>
<div style="position:absolute;left:36.00px;top:572.67px" class="cls_006"><span class="cls_006">Subsegments in the R3041 - memory width configuration</span></div>
<div style="position:absolute;left:48.02px;top:583.67px" class="cls_006"><span class="cls_006">The R3041 CPU can be configured to access different regions of memory</span></div>
<div style="position:absolute;left:36.00px;top:594.67px" class="cls_006"><span class="cls_006">as either 32-, 16- or 8-bits wide. Where the program requests a 32-bit</span></div>
<div style="position:absolute;left:36.00px;top:605.67px" class="cls_006"><span class="cls_006">operation to a narrow memory (either with an uncached access, or a cache</span></div>
<div style="position:absolute;left:36.00px;top:616.67px" class="cls_006"><span class="cls_006">miss, or a store), the CPU may break a transaction into multiple data</span></div>
<div style="position:absolute;left:36.00px;top:627.67px" class="cls_006"><span class="cls_006">phases, to match the datum size to the memory port width.</span></div>
<div style="position:absolute;left:48.02px;top:638.67px" class="cls_006"><span class="cls_006">The width configuration is applied independently to subsegments of the</span></div>
<div style="position:absolute;left:36.00px;top:649.67px" class="cls_006"><span class="cls_006">normal kseg regions, as follows:</span></div>
<div style="position:absolute;left:48.02px;top:663.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> kseg0 and kseg1</span><span class="cls_006">: as usual, these are both mapped onto the low</span></div>
<div style="position:absolute;left:59.97px;top:674.67px" class="cls_006"><span class="cls_006">512Mbytes.  This  common  region  is  split  into</span></div>
<div style="position:absolute;left:317.25px;top:674.67px" class="cls_006"><span class="cls_006">8  subsegments</span></div>
<div style="position:absolute;left:59.97px;top:685.67px" class="cls_006"><span class="cls_006">(64Mbytes each), each of which can be programmed as 8-, 16- or 32-</span></div>
<div style="position:absolute;left:59.97px;top:696.67px" class="cls_006"><span class="cls_006">bits  wide.  The  width  assignment  affects  both  kseg0  and  kseg1</span></div>
<div style="position:absolute;left:59.97px;top:707.67px" class="cls_006"><span class="cls_006">accesses</span></div>
<div style="position:absolute;left:109.94px;top:707.67px" class="cls_006"><span class="cls_006">(that  is,  one  can  view  these  as  subsegments  of  the</span></div>
<div style="position:absolute;left:59.97px;top:718.67px" class="cls_006"><span class="cls_006">corresponding “physical” addresses).</span></div>
<div style="position:absolute;left:289.78px;top:755.34px" class="cls_002"><span class="cls_002">2-10</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:43308px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MIPS-1 (R30xx) ARCHITECTURE</span></div>
<div style="position:absolute;left:525.01px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 2</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> kuseg</span><span class="cls_006">:   is   divided   into   four</span></div>
<div style="position:absolute;left:413.84px;top:50.67px" class="cls_006"><span class="cls_006">512Mbyte   subsegments,   each</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">independently programmable for width. Thus, kuseg can be broken</span></div>
<div style="position:absolute;left:239.97px;top:72.67px" class="cls_006"><span class="cls_006">into multiple portions, which may have varying widths. An example of</span></div>
<div style="position:absolute;left:239.97px;top:83.67px" class="cls_006"><span class="cls_006">this may be a 32-bit main memory with some 16-bit PCMCIA font</span></div>
<div style="position:absolute;left:239.97px;top:94.67px" class="cls_006"><span class="cls_006">cards and an 8-bit NVRAM.</span></div>
<div style="position:absolute;left:228.02px;top:108.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> kseg2</span><span class="cls_006">: is divided into two 512Mbyte subsegments, independently</span></div>
<div style="position:absolute;left:239.97px;top:119.67px" class="cls_006"><span class="cls_006">programmable for width. Again, this means that kseg2 can support</span></div>
<div style="position:absolute;left:239.97px;top:130.67px" class="cls_006"><span class="cls_006">multiple memory subsystems, of varying port width.</span></div>
<div style="position:absolute;left:228.02px;top:141.67px" class="cls_006"><span class="cls_006">Note that once the various memory port widths have been configured</span></div>
<div style="position:absolute;left:216.00px;top:152.67px" class="cls_006"><span class="cls_006">(typically at boot time), software does not have to be aware of the actual</span></div>
<div style="position:absolute;left:216.00px;top:163.67px" class="cls_006"><span class="cls_006">width of any memory system. It can choose to treat all memory as 32-bit</span></div>
<div style="position:absolute;left:216.00px;top:174.67px" class="cls_006"><span class="cls_006">wide, and the CPU will automatically adjust when an access is made to a</span></div>
<div style="position:absolute;left:216.00px;top:185.67px" class="cls_006"><span class="cls_006">narrower memory region. This simplifies software development, and also</span></div>
<div style="position:absolute;left:216.00px;top:196.67px" class="cls_006"><span class="cls_006">facilitates porting to various system implementations (which may or may</span></div>
<div style="position:absolute;left:216.00px;top:207.67px" class="cls_006"><span class="cls_006">not choose the same memory port widths).</span></div>
<div style="position:absolute;left:303.53px;top:755.34px" class="cls_002"><span class="cls_002">2-11</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:44110px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">EXCEPTION MANAGEMENT</span></div>
<div style="position:absolute;left:491.33px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 4</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:228.02px;top:124.67px" class="cls_006"><span class="cls_006">This chapter describes the software techniques used to recognize and</span></div>
<div style="position:absolute;left:216.00px;top:135.67px" class="cls_006"><span class="cls_006">decode exceptions, save state, dispatch exception service routines, and</span></div>
<div style="position:absolute;left:216.00px;top:146.67px" class="cls_006"><span class="cls_006">return from exception. Various code examples are provided.</span></div>
<div style="position:absolute;left:216.00px;top:169.00px" class="cls_015"><span class="cls_015">EXCEPTIONS</span></div>
<div style="position:absolute;left:228.02px;top:182.67px" class="cls_006"><span class="cls_006">In the MIPS architecture interrupts, traps, system calls and everything</span></div>
<div style="position:absolute;left:216.00px;top:193.67px" class="cls_006"><span class="cls_006">else which disrupts the normal flow of execution are called ‘‘exceptions’’</span></div>
<div style="position:absolute;left:216.00px;top:204.67px" class="cls_006"><span class="cls_006">and handled by a single mechanism. These kinds of events include:</span></div>
<div style="position:absolute;left:228.02px;top:218.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> External events</span><span class="cls_006">: interrupts, or a bus error on a read. Note that for the</span></div>
<div style="position:absolute;left:239.98px;top:229.67px" class="cls_006"><span class="cls_006">R30xx floating point exceptions are reported as interrupts, since</span></div>
<div style="position:absolute;left:239.98px;top:240.67px" class="cls_006"><span class="cls_006">when the R3000A was originally implemented the FPA was indeed</span></div>
<div style="position:absolute;left:239.98px;top:251.67px" class="cls_006"><span class="cls_006">external.</span></div>
<div style="position:absolute;left:239.98px;top:265.67px" class="cls_006"><span class="cls_006">Interrupts are the only exception conditions which can be disabled</span></div>
<div style="position:absolute;left:239.98px;top:276.67px" class="cls_006"><span class="cls_006">under software control.</span></div>
<div style="position:absolute;left:228.03px;top:290.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Program errors and unusual conditions</span><span class="cls_006">: non-existent instructions</span></div>
<div style="position:absolute;left:239.98px;top:301.67px" class="cls_006"><span class="cls_006">(including ‘‘co-processor’’ instructions executed with the appropriate</span></div>
<div style="position:absolute;left:239.98px;top:312.67px" class="cls_008"><span class="cls_008">SR</span><span class="cls_006"> disabled), integer overflow, address alignment errors, accesses</span></div>
<div style="position:absolute;left:239.97px;top:323.67px" class="cls_006"><span class="cls_006">outside </span><span class="cls_008">kuseg</span><span class="cls_006"> in user mode.</span></div>
<div style="position:absolute;left:228.02px;top:337.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Memory translation exceptions</span><span class="cls_006">: using an invalid translation, or a write</span></div>
<div style="position:absolute;left:239.98px;top:348.67px" class="cls_006"><span class="cls_006">to a write-protected page; and access to a page for which there is no</span></div>
<div style="position:absolute;left:239.98px;top:359.67px" class="cls_006"><span class="cls_006">translation in the TLB.</span></div>
<div style="position:absolute;left:228.03px;top:373.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> System calls and traps</span><span class="cls_006">: exceptions deliberately generated by software</span></div>
<div style="position:absolute;left:239.98px;top:384.67px" class="cls_006"><span class="cls_006">to access kernel facilities in a secure way (syscalls, conditional traps</span></div>
<div style="position:absolute;left:239.98px;top:395.67px" class="cls_006"><span class="cls_006">planted by careful code, and breakpoints).</span></div>
<div style="position:absolute;left:228.03px;top:406.67px" class="cls_006"><span class="cls_006">Some things do not cause exceptions, although other CPU architectures</span></div>
<div style="position:absolute;left:216.01px;top:417.67px" class="cls_006"><span class="cls_006">may handle them that way. Software must use other mechanisms to</span></div>
<div style="position:absolute;left:216.01px;top:428.67px" class="cls_006"><span class="cls_006">detect:</span></div>
<div style="position:absolute;left:228.03px;top:442.67px" class="cls_006"><span class="cls_006">• bus  errors  on  write  cycles</span></div>
<div style="position:absolute;left:388.93px;top:442.67px" class="cls_006"><span class="cls_006">(R30xx  CPUs  don’t  detect  these  as</span></div>
<div style="position:absolute;left:239.98px;top:453.67px" class="cls_006"><span class="cls_006">exceptions at all; the use of a write buffer would make such an</span></div>
<div style="position:absolute;left:239.98px;top:464.67px" class="cls_006"><span class="cls_006">exception “imprecise”, in that the instruction which generated the</span></div>
<div style="position:absolute;left:239.98px;top:475.67px" class="cls_006"><span class="cls_006">store data is not guaranteed to be the one which recognizes the</span></div>
<div style="position:absolute;left:239.98px;top:486.67px" class="cls_006"><span class="cls_006">exception).</span></div>
<div style="position:absolute;left:228.03px;top:500.67px" class="cls_006"><span class="cls_006">• parity errors detected in the cache (the PE bit in </span><span class="cls_008">SR</span><span class="cls_006"> is set, but no</span></div>
<div style="position:absolute;left:239.98px;top:511.67px" class="cls_006"><span class="cls_006">exception is signalled).</span></div>
<div style="position:absolute;left:216.00px;top:534.00px" class="cls_015"><span class="cls_015">Precise exceptions</span></div>
<div style="position:absolute;left:228.02px;top:547.67px" class="cls_006"><span class="cls_006">The MIPS architecture implements </span><span class="cls_008">precise exceptions</span><span class="cls_006">. This is quite a</span></div>
<div style="position:absolute;left:216.00px;top:558.67px" class="cls_006"><span class="cls_006">useful feature, as it provides:</span></div>
<div style="position:absolute;left:228.02px;top:572.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Unambiguous proof of cause</span><span class="cls_006">:  after  an  exception  caused  by  any</span></div>
<div style="position:absolute;left:239.98px;top:583.67px" class="cls_006"><span class="cls_006">internal error, the EPC points to the instruction which caused the</span></div>
<div style="position:absolute;left:239.98px;top:594.67px" class="cls_006"><span class="cls_006">error (it might point to the preceding branch for an instruction which</span></div>
<div style="position:absolute;left:239.98px;top:605.67px" class="cls_006"><span class="cls_006">is in a branch delay slot, but will signal occurrence of this using the</span></div>
<div style="position:absolute;left:239.98px;top:616.67px" class="cls_006"><span class="cls_006">BD bit).</span></div>
<div style="position:absolute;left:228.02px;top:630.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Exceptions are seen in instruction sequence</span><span class="cls_006">: exceptions can arise at</span></div>
<div style="position:absolute;left:239.98px;top:641.67px" class="cls_006"><span class="cls_006">several different stages of execution, creating a potential hazard. For</span></div>
<div style="position:absolute;left:239.98px;top:652.67px" class="cls_006"><span class="cls_006">example, if a load instruction suffers a TLB miss the exception won’t</span></div>
<div style="position:absolute;left:239.98px;top:663.67px" class="cls_006"><span class="cls_006">be signalled until the ‘‘MEM’’ pipestage; if the next instruction suffers</span></div>
<div style="position:absolute;left:239.98px;top:674.67px" class="cls_006"><span class="cls_006">an instruction TLB miss (at the ‘‘IF’’ pipestage) the logically second</span></div>
<div style="position:absolute;left:239.98px;top:685.67px" class="cls_006"><span class="cls_006">exception will be signalled first (since the IF occurs earlier in the pipe</span></div>
<div style="position:absolute;left:239.98px;top:696.67px" class="cls_006"><span class="cls_006">than MEM).</span></div>
<div style="position:absolute;left:299.28px;top:754.68px" class="cls_002"><span class="cls_002">4-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:44912px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 4</span></div>
<div style="position:absolute;left:437.95px;top:28.00px" class="cls_002"><span class="cls_002">EXCEPTION MANAGEMENT</span></div>
<div style="position:absolute;left:59.98px;top:50.67px" class="cls_006"><span class="cls_006">To avoid this problem, early-detected exceptions are not activated</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">until  it  is  known  that  all  previous  instructions  will  complete</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">successfully; in this case, the instruction TLB miss is suppressed and</span></div>
<div style="position:absolute;left:59.98px;top:83.67px" class="cls_006"><span class="cls_006">the exception caused by the earlier instruction handled. The second</span></div>
<div style="position:absolute;left:59.98px;top:94.67px" class="cls_006"><span class="cls_006">exception will likely happen again upon return from handling the data</span></div>
<div style="position:absolute;left:59.98px;top:105.67px" class="cls_006"><span class="cls_006">fault.</span></div>
<div style="position:absolute;left:48.03px;top:119.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Subsequent   instructions   nullified</span><span class="cls_006">:   because   of   the   pipelining,</span></div>
<div style="position:absolute;left:59.98px;top:130.67px" class="cls_006"><span class="cls_006">instructions lying in sequence after the EPC may well have been</span></div>
<div style="position:absolute;left:59.98px;top:141.67px" class="cls_006"><span class="cls_006">started. But the architecture guarantees that no effects produced by</span></div>
<div style="position:absolute;left:59.98px;top:152.67px" class="cls_006"><span class="cls_006">these instructions will be visible in the registers or CPU state; and no</span></div>
<div style="position:absolute;left:59.98px;top:163.67px" class="cls_006"><span class="cls_006">effect at all will occur which will prevent execution being restarted at</span></div>
<div style="position:absolute;left:59.98px;top:174.67px" class="cls_006"><span class="cls_006">the EPC.</span></div>
<div style="position:absolute;left:59.98px;top:188.67px" class="cls_006"><span class="cls_006">Note that this isn’t quite true of, for example, the result registers in</span></div>
<div style="position:absolute;left:59.98px;top:199.67px" class="cls_006"><span class="cls_006">the integer multiply unit (logically, the architecture considers these</span></div>
<div style="position:absolute;left:59.98px;top:210.67px" class="cls_006"><span class="cls_006">changed by the initiation of a multiply or divide). But provided that</span></div>
<div style="position:absolute;left:59.98px;top:221.67px" class="cls_006"><span class="cls_006">the instruction arrangement rules required by the assembler are</span></div>
<div style="position:absolute;left:59.98px;top:232.67px" class="cls_006"><span class="cls_006">followed, no problems will arise.</span></div>
<div style="position:absolute;left:48.03px;top:243.67px" class="cls_006"><span class="cls_006">The implementation of precise exceptions requires a number of clever</span></div>
<div style="position:absolute;left:36.01px;top:254.67px" class="cls_006"><span class="cls_006">techniques. For example, the FPA cannot update the register file until it</span></div>
<div style="position:absolute;left:36.01px;top:265.67px" class="cls_006"><span class="cls_006">knows that the operation will not generate an exception. However, the</span></div>
<div style="position:absolute;left:36.01px;top:276.67px" class="cls_006"><span class="cls_006">R30xx family contains logic to allow multi-cycle FPA operations to occur</span></div>
<div style="position:absolute;left:36.01px;top:287.67px" class="cls_006"><span class="cls_006">concurrently with integer operations, yet maintain precise exceptions.</span></div>
<div style="position:absolute;left:36.00px;top:310.00px" class="cls_015"><span class="cls_015">When exceptions happen</span></div>
<div style="position:absolute;left:48.02px;top:323.67px" class="cls_006"><span class="cls_006">Since  exceptions  are  precise,  the  architecture  determines  that  an</span></div>
<div style="position:absolute;left:36.00px;top:334.67px" class="cls_006"><span class="cls_006">exception seems to have happened just before the execution of the</span></div>
<div style="position:absolute;left:36.00px;top:345.67px" class="cls_006"><span class="cls_006">instruction which caused it. The first fetch from the exception routine will</span></div>
<div style="position:absolute;left:36.00px;top:356.67px" class="cls_006"><span class="cls_006">be made within 1 clock of the time when the faulting instruction would</span></div>
<div style="position:absolute;left:36.00px;top:367.67px" class="cls_006"><span class="cls_006">have finished; in practice it is often faster.</span></div>
<div style="position:absolute;left:48.02px;top:378.67px" class="cls_006"><span class="cls_006">On an interrupt, the last instruction to be completed before interrupt</span></div>
<div style="position:absolute;left:36.00px;top:389.67px" class="cls_006"><span class="cls_006">processing starts will be the one which has just finished its MEM stage</span></div>
<div style="position:absolute;left:36.00px;top:400.67px" class="cls_006"><span class="cls_006">when the interrupt is detected. The </span><span class="cls_008">EPC</span><span class="cls_006"> target will be the one which has</span></div>
<div style="position:absolute;left:36.00px;top:411.67px" class="cls_006"><span class="cls_006">just finished its ALU stage.</span></div>
<div style="position:absolute;left:48.02px;top:422.67px" class="cls_006"><span class="cls_006">However, take care; some of the interrupt inputs to R30xx family CPUs</span></div>
<div style="position:absolute;left:36.00px;top:433.67px" class="cls_006"><span class="cls_006">are  resynchronised  internally</span></div>
<div style="position:absolute;left:198.17px;top:433.67px" class="cls_006"><span class="cls_006">(to  support  interrupt  signalling  from</span></div>
<div style="position:absolute;left:36.00px;top:444.67px" class="cls_006"><span class="cls_006">asynchronous sources) and the interrupt will be detected only on the rising</span></div>
<div style="position:absolute;left:36.00px;top:455.67px" class="cls_006"><span class="cls_006">edge of the second clock after the interrupt becomes active.</span></div>
<div style="position:absolute;left:36.00px;top:478.00px" class="cls_015"><span class="cls_015">Exception vectors</span></div>
<div style="position:absolute;left:48.02px;top:491.67px" class="cls_006"><span class="cls_006">Unlike most CISC processors, the MIPS CPU does no part of the job of</span></div>
<div style="position:absolute;left:36.00px;top:502.67px" class="cls_006"><span class="cls_006">dispatching  exceptions  to  specialist  routines  to  deal  with  individual</span></div>
<div style="position:absolute;left:36.00px;top:513.67px" class="cls_006"><span class="cls_006">conditions. The rationale for this is twofold:</span></div>
<div style="position:absolute;left:48.02px;top:527.67px" class="cls_006"><span class="cls_006">• on CISC CPUs this feature is not so useful in practice as one might</span></div>
<div style="position:absolute;left:59.97px;top:538.67px" class="cls_006"><span class="cls_006">hope. For example, most interrupts are likely to share code for saving</span></div>
<div style="position:absolute;left:59.97px;top:549.67px" class="cls_006"><span class="cls_006">registers  and  it  is  common  for  CISC  microcode  to  spend  time</span></div>
<div style="position:absolute;left:59.97px;top:560.67px" class="cls_006"><span class="cls_006">dispatching to different interrupt entry points, where system software</span></div>
<div style="position:absolute;left:59.97px;top:571.67px" class="cls_006"><span class="cls_006">loads a code number and jumps back to a common handler.</span></div>
<div style="position:absolute;left:48.02px;top:585.67px" class="cls_006"><span class="cls_006">• on a RISC CPU ordinary code is fast enough to be used in preference</span></div>
<div style="position:absolute;left:59.97px;top:596.67px" class="cls_006"><span class="cls_006">to microcode.</span></div>
<div style="position:absolute;left:48.02px;top:607.67px" class="cls_006"><span class="cls_006">Only one exception is handled differently; a TLB miss on an address in</span></div>
<div style="position:absolute;left:36.00px;top:618.67px" class="cls_008"><span class="cls_008">kuseg</span><span class="cls_006">. Although the architecture uses software to handle this condition</span></div>
<div style="position:absolute;left:36.00px;top:629.67px" class="cls_006"><span class="cls_006">(which occurs very frequently in a heavily-used multi-tasking, virtual</span></div>
<div style="position:absolute;left:36.00px;top:640.67px" class="cls_006"><span class="cls_006">memory OS), there is significant architectural support for a ‘‘preferred’’</span></div>
<div style="position:absolute;left:36.00px;top:651.67px" class="cls_006"><span class="cls_006">scheme for TLB refill. The preferred refill scheme can be completed in</span></div>
<div style="position:absolute;left:36.00px;top:662.67px" class="cls_006"><span class="cls_006">about 13 clocks.</span></div>
<div style="position:absolute;left:48.02px;top:673.67px" class="cls_006"><span class="cls_006">It is also useful to have two alternate pairs of entry points. It is essential</span></div>
<div style="position:absolute;left:36.00px;top:684.67px" class="cls_006"><span class="cls_006">for high performance to locate the vectors in cached memory for OS use,</span></div>
<div style="position:absolute;left:36.00px;top:695.67px" class="cls_006"><span class="cls_006">but this is highly undesirable at start-up; the need for a robust and self-</span></div>
<div style="position:absolute;left:36.00px;top:706.67px" class="cls_006"><span class="cls_006">diagnosing start-up sequence mandates the use of uncached read-only</span></div>
<div style="position:absolute;left:36.00px;top:717.67px" class="cls_006"><span class="cls_006">memory for vectors.</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">4-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:45714px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">EXCEPTION MANAGEMENT</span></div>
<div style="position:absolute;left:524.94px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 4</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">So the exception system adds four more “magic” addresses to the one</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">used for system start-up. The reset mechanism on the MIPS CPU is</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_006"><span class="cls_006">remarkably like the exception mechanism, and is sometimes referred to as</span></div>
<div style="position:absolute;left:216.00px;top:83.67px" class="cls_006"><span class="cls_006">the </span><span class="cls_008">reset exception</span><span class="cls_006">. The complete list of exception vector addresses is</span></div>
<div style="position:absolute;left:216.00px;top:94.67px" class="cls_006"><span class="cls_006">shown in Table 4.1, “Reset and exception entry points (vectors) for R30xx</span></div>
<div style="position:absolute;left:216.00px;top:105.67px" class="cls_006"><span class="cls_006">family”:</span></div>
<div style="position:absolute;left:229.31px;top:128.00px" class="cls_020"><span class="cls_020">Program</span></div>
<div style="position:absolute;left:289.51px;top:128.00px" class="cls_020"><span class="cls_020">‘‘segment’’</span></div>
<div style="position:absolute;left:361.89px;top:128.00px" class="cls_020"><span class="cls_020">Physical</span></div>
<div style="position:absolute;left:470.18px;top:128.00px" class="cls_020"><span class="cls_020">Description</span></div>
<div style="position:absolute;left:231.20px;top:138.00px" class="cls_020"><span class="cls_020">address</span></div>
<div style="position:absolute;left:362.87px;top:138.00px" class="cls_020"><span class="cls_020">Address</span></div>
<div style="position:absolute;left:217.71px;top:157.00px" class="cls_028"><span class="cls_028">0x8000 0000</span><span class="cls_020">   kseg0</span></div>
<div style="position:absolute;left:350.01px;top:157.00px" class="cls_028"><span class="cls_028">0x0000 0000</span><span class="cls_020">   TLB miss on </span><span class="cls_027">kuseg</span><span class="cls_020"> reference only.</span></div>
<div style="position:absolute;left:217.71px;top:173.99px" class="cls_028"><span class="cls_028">0x8000 0080</span><span class="cls_020">   kseg0</span></div>
<div style="position:absolute;left:350.00px;top:174.00px" class="cls_028"><span class="cls_028">0x0000 0080</span><span class="cls_020">   All other exceptions.</span></div>
<div style="position:absolute;left:217.72px;top:191.00px" class="cls_028"><span class="cls_028">0xbfc0 0100</span><span class="cls_020">   kseg1</span></div>
<div style="position:absolute;left:350.01px;top:191.00px" class="cls_028"><span class="cls_028">0x1fc0 0100</span><span class="cls_020">   Uncached alternative </span><span class="cls_027">kuseg</span><span class="cls_020"> TLB</span></div>
<div style="position:absolute;left:420.20px;top:201.00px" class="cls_020"><span class="cls_020">miss entry point (used if </span><span class="cls_027">SR</span><span class="cls_020"> bit</span></div>
<div style="position:absolute;left:420.20px;top:211.00px" class="cls_020"><span class="cls_020">BEV set).</span></div>
<div style="position:absolute;left:217.71px;top:227.99px" class="cls_028"><span class="cls_028">0xbfc0 0180</span><span class="cls_020">   kseg1</span></div>
<div style="position:absolute;left:350.00px;top:228.00px" class="cls_028"><span class="cls_028">0x1fc0 0180</span><span class="cls_020">   Uncached alternative for all other</span></div>
<div style="position:absolute;left:420.20px;top:238.00px" class="cls_020"><span class="cls_020">exceptions, used if </span><span class="cls_027">SR</span><span class="cls_020"> bit BEV set).</span></div>
<div style="position:absolute;left:217.71px;top:254.99px" class="cls_028"><span class="cls_028">0xbfc0 0000</span><span class="cls_020">   kseg1</span></div>
<div style="position:absolute;left:350.00px;top:255.00px" class="cls_028"><span class="cls_028">0x1fc0 0000</span><span class="cls_020">   The ‘‘reset exception’’.</span></div>
<div style="position:absolute;left:230.12px;top:274.00px" class="cls_020"><span class="cls_020">Table 4.1.  Reset and exception entry points (vectors) for R30xx family</span></div>
<div style="position:absolute;left:228.02px;top:289.67px" class="cls_006"><span class="cls_006">The 128 byte </span><span class="cls_029">0x80</span><span class="cls_006">) gap between the two exception vectors is because</span></div>
<div style="position:absolute;left:216.00px;top:300.67px" class="cls_006"><span class="cls_006">the MIPS architects felt that 32 instructions would be enough to code the</span></div>
<div style="position:absolute;left:216.00px;top:311.67px" class="cls_006"><span class="cls_006">user-space TLB miss routine, saving a branch instruction without wasting</span></div>
<div style="position:absolute;left:216.00px;top:322.67px" class="cls_006"><span class="cls_006">too much memory.</span></div>
<div style="position:absolute;left:228.02px;top:333.67px" class="cls_006"><span class="cls_006">So on an exception, the CPU:</span></div>
<div style="position:absolute;left:228.02px;top:347.67px" class="cls_006"><span class="cls_006">1)</span></div>
<div style="position:absolute;left:264.02px;top:347.67px" class="cls_006"><span class="cls_006">sets up </span><span class="cls_008">EPC</span><span class="cls_006"> to point to the restart location.</span></div>
<div style="position:absolute;left:228.03px;top:361.67px" class="cls_006"><span class="cls_006">2)</span></div>
<div style="position:absolute;left:264.03px;top:361.67px" class="cls_006"><span class="cls_006">the pre-existing user-mode and interrupt-enable flags in </span><span class="cls_008">SR</span><span class="cls_006"> are</span></div>
<div style="position:absolute;left:264.02px;top:372.67px" class="cls_006"><span class="cls_006">saved by pushing the 3-entry stack inside </span><span class="cls_008">SR,</span><span class="cls_006"> and changing to</span></div>
<div style="position:absolute;left:264.02px;top:383.67px" class="cls_006"><span class="cls_006">kernel mode with interrupts disabled.</span></div>
<div style="position:absolute;left:228.02px;top:397.67px" class="cls_006"><span class="cls_006">3)</span></div>
<div style="position:absolute;left:264.02px;top:397.67px" class="cls_008"><span class="cls_008">Cause</span><span class="cls_006"> is setup so that software can see the reason for the</span></div>
<div style="position:absolute;left:264.03px;top:408.67px" class="cls_006"><span class="cls_006">exception. On address exceptions </span><span class="cls_008">BadVaddr</span><span class="cls_006"> is also set. Memory</span></div>
<div style="position:absolute;left:264.03px;top:419.67px" class="cls_006"><span class="cls_006">management  system  exceptions  set  up  some  of  the  MMU</span></div>
<div style="position:absolute;left:264.03px;top:430.67px" class="cls_006"><span class="cls_006">registers too; see the chapter on memory management for more</span></div>
<div style="position:absolute;left:264.03px;top:441.67px" class="cls_006"><span class="cls_006">detail.</span></div>
<div style="position:absolute;left:228.03px;top:455.67px" class="cls_006"><span class="cls_006">4)</span></div>
<div style="position:absolute;left:264.03px;top:455.67px" class="cls_006"><span class="cls_006">transfers control to the exception entry point.</span></div>
<div style="position:absolute;left:216.00px;top:478.00px" class="cls_015"><span class="cls_015">Exception handling - basics</span></div>
<div style="position:absolute;left:228.02px;top:491.67px" class="cls_006"><span class="cls_006">Any MIPS exception handler has to go through the same stages:</span></div>
<div style="position:absolute;left:228.02px;top:505.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Bootstrapping</span><span class="cls_006">: on entry to the exception handler very little of the state</span></div>
<div style="position:absolute;left:239.98px;top:516.67px" class="cls_006"><span class="cls_006">of the interrupted program has been saved, so the first job is to</span></div>
<div style="position:absolute;left:239.98px;top:527.67px" class="cls_006"><span class="cls_006">provide room to preserve relevant state information.</span></div>
<div style="position:absolute;left:239.98px;top:541.67px" class="cls_006"><span class="cls_006">Almost inevitably, this is done by using the </span><span class="cls_008">k0</span><span class="cls_006"> and </span><span class="cls_008">k1</span><span class="cls_006"> registers (which</span></div>
<div style="position:absolute;left:239.97px;top:552.67px" class="cls_006"><span class="cls_006">are reserved for ‘‘kernel mode’’ use, and therefore should contain no</span></div>
<div style="position:absolute;left:239.97px;top:563.67px" class="cls_006"><span class="cls_006">application program state), to reference a piece of memory which can</span></div>
<div style="position:absolute;left:239.97px;top:574.67px" class="cls_006"><span class="cls_006">be used for other register saves.</span></div>
<div style="position:absolute;left:228.02px;top:588.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Dispatching different exceptions</span><span class="cls_006">: consult the </span><span class="cls_008">Cause</span><span class="cls_006"> register. The</span></div>
<div style="position:absolute;left:239.98px;top:599.67px" class="cls_006"><span class="cls_006">initial decision is likely to be made on the ‘‘ExcCode’’ field, which is</span></div>
<div style="position:absolute;left:239.98px;top:610.67px" class="cls_006"><span class="cls_006">thoughtfully aligned so that its code value (between 0 and 31) can be</span></div>
<div style="position:absolute;left:239.98px;top:621.67px" class="cls_006"><span class="cls_006">used to index an array of words without a shift. The code will be</span></div>
<div style="position:absolute;left:239.98px;top:632.67px" class="cls_006"><span class="cls_006">something like this:</span></div>
<div style="position:absolute;left:288.00px;top:654.00px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.09px;top:654.00px" class="cls_028"><span class="cls_028">t1, C0_CAUSE</span></div>
<div style="position:absolute;left:288.00px;top:664.00px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:324.07px;top:664.00px" class="cls_028"><span class="cls_028">t2, t1, 0x3f</span></div>
<div style="position:absolute;left:288.00px;top:674.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:674.00px" class="cls_028"><span class="cls_028">t2, tablebase(t2)</span></div>
<div style="position:absolute;left:288.00px;top:684.00px" class="cls_028"><span class="cls_028">jr</span></div>
<div style="position:absolute;left:324.05px;top:684.00px" class="cls_028"><span class="cls_028">t2</span></div>
<div style="position:absolute;left:305.77px;top:755.33px" class="cls_002"><span class="cls_002">4-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:46516px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 4</span></div>
<div style="position:absolute;left:437.95px;top:28.00px" class="cls_002"><span class="cls_002">EXCEPTION MANAGEMENT</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Constructing the exception processing environment</span><span class="cls_006">: complex exception</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">handling routines may be written in a high level language; in addition,</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">software may wish to be able to use standard library routines. To do</span></div>
<div style="position:absolute;left:59.98px;top:83.67px" class="cls_006"><span class="cls_006">this, software will have to switch to a suitable stack, and save the</span></div>
<div style="position:absolute;left:59.98px;top:94.67px" class="cls_006"><span class="cls_006">values of all registers which “called subroutines” may use.</span></div>
<div style="position:absolute;left:48.03px;top:108.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Processing the exception</span><span class="cls_006">: this is system and cause dependent.</span></div>
<div style="position:absolute;left:48.02px;top:122.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Returning from an exception</span><span class="cls_006">: The return address is contained in the</span></div>
<div style="position:absolute;left:59.98px;top:133.67px" class="cls_008"><span class="cls_008">EPC</span><span class="cls_006"> register on exception entry; the value must be placed into a</span></div>
<div style="position:absolute;left:59.97px;top:144.67px" class="cls_006"><span class="cls_006">general purpose register for return from exception (note that the EPC</span></div>
<div style="position:absolute;left:59.97px;top:155.67px" class="cls_006"><span class="cls_006">value  may  have  been  placed  on  the  stack  at  exception  entry).</span></div>
<div style="position:absolute;left:59.97px;top:166.67px" class="cls_006"><span class="cls_006">Returning control is now done with a </span><span class="cls_008">jr</span><span class="cls_006"> instruction, and the change</span></div>
<div style="position:absolute;left:59.98px;top:177.67px" class="cls_006"><span class="cls_006">of state back from kernel to the previous mode is done by an </span><span class="cls_008">rfe</span></div>
<div style="position:absolute;left:59.98px;top:188.67px" class="cls_006"><span class="cls_006">instruction after the </span><span class="cls_008">jr</span><span class="cls_006">, in the delay slot.</span></div>
<div style="position:absolute;left:36.00px;top:211.00px" class="cls_015"><span class="cls_015">Nesting exceptions</span></div>
<div style="position:absolute;left:48.02px;top:224.67px" class="cls_006"><span class="cls_006">In many cases the system may wish to permit (or will not be able to</span></div>
<div style="position:absolute;left:36.00px;top:235.67px" class="cls_006"><span class="cls_006">avoid)  further  exceptions  occurring  within  the  exception  processing</span></div>
<div style="position:absolute;left:36.00px;top:246.67px" class="cls_006"><span class="cls_006">routine - </span><span class="cls_008">nested</span><span class="cls_006"> exceptions.</span></div>
<div style="position:absolute;left:48.03px;top:257.67px" class="cls_006"><span class="cls_006">If improperly handled, this could cause chaos; vital state for the</span></div>
<div style="position:absolute;left:36.01px;top:268.67px" class="cls_006"><span class="cls_006">interrupted program is held in </span><span class="cls_008">EPC</span><span class="cls_006"> and </span><span class="cls_008">SR,</span><span class="cls_006"> and another exception would</span></div>
<div style="position:absolute;left:36.00px;top:279.67px" class="cls_006"><span class="cls_006">overwrite them. To permit nested exceptions, these values must be saved</span></div>
<div style="position:absolute;left:36.00px;top:290.67px" class="cls_006"><span class="cls_006">elsewhere. Moreover, once exceptions are re-enabled, software can no</span></div>
<div style="position:absolute;left:36.00px;top:301.67px" class="cls_006"><span class="cls_006">longer rely on the values of </span><span class="cls_008">k0</span><span class="cls_006"> and </span><span class="cls_008">k1</span><span class="cls_006">, since a subsequent (nested)</span></div>
<div style="position:absolute;left:36.00px;top:312.67px" class="cls_006"><span class="cls_006">exception may alter their values</span><span class="cls_008">.</span></div>
<div style="position:absolute;left:48.03px;top:323.67px" class="cls_006"><span class="cls_006">The normal approach to this is to define an </span><span class="cls_008">exception frame</span><span class="cls_006">; a memory-</span></div>
<div style="position:absolute;left:36.00px;top:334.67px" class="cls_006"><span class="cls_006">resident data structure with fields to store incoming register values, so</span></div>
<div style="position:absolute;left:36.00px;top:345.67px" class="cls_006"><span class="cls_006">that they can be retrieved on return. Exception frames are usually</span></div>
<div style="position:absolute;left:36.00px;top:356.67px" class="cls_006"><span class="cls_006">arranged logically as a stack.</span></div>
<div style="position:absolute;left:48.02px;top:367.67px" class="cls_006"><span class="cls_006">Stack resources are consumed by each exception, so arbitrarily nested</span></div>
<div style="position:absolute;left:36.00px;top:378.67px" class="cls_006"><span class="cls_006">exceptions cannot be tolerated. Most systems sort exceptions into a</span></div>
<div style="position:absolute;left:36.00px;top:389.67px" class="cls_006"><span class="cls_006">priority order, and arrange that while an exception is being processed only</span></div>
<div style="position:absolute;left:36.00px;top:400.67px" class="cls_006"><span class="cls_006">higher-priority exceptions are permitted. Such systems need have only as</span></div>
<div style="position:absolute;left:36.00px;top:411.67px" class="cls_006"><span class="cls_006">many exception frames as there are priority levels.</span></div>
<div style="position:absolute;left:48.02px;top:422.67px" class="cls_006"><span class="cls_006">Software can inhibit certain exceptions, as follows:</span></div>
<div style="position:absolute;left:48.02px;top:436.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Interrupts</span><span class="cls_006">: can be individually masked by software to conform to</span></div>
<div style="position:absolute;left:59.97px;top:447.67px" class="cls_006"><span class="cls_006">system priority rules;</span></div>
<div style="position:absolute;left:48.02px;top:461.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Privilege  Violations</span><span class="cls_006">:  can’t  happen  in  kernel  mode;  virtually  all</span></div>
<div style="position:absolute;left:59.97px;top:472.67px" class="cls_006"><span class="cls_006">exception service routines will execute in kernel mode;</span></div>
<div style="position:absolute;left:48.02px;top:486.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Addressing errors and TLB misses</span><span class="cls_006">: software must be written to</span></div>
<div style="position:absolute;left:59.97px;top:497.67px" class="cls_006"><span class="cls_006">ensure that these never happen when processing higher priority</span></div>
<div style="position:absolute;left:59.97px;top:508.67px" class="cls_006"><span class="cls_006">exceptions.</span></div>
<div style="position:absolute;left:48.02px;top:519.67px" class="cls_006"><span class="cls_006">Typical system priorities are (lowest first): non-exception code, TLB miss</span></div>
<div style="position:absolute;left:36.00px;top:530.67px" class="cls_006"><span class="cls_006">on </span><span class="cls_008"> kuseg</span><span class="cls_006">  address,  TLB  miss  on </span><span class="cls_008"> kseg2</span><span class="cls_006">  address,  interrupt</span></div>
<div style="position:absolute;left:349.85px;top:530.67px" class="cls_006"><span class="cls_006">(lowest)...</span></div>
<div style="position:absolute;left:36.00px;top:541.67px" class="cls_006"><span class="cls_006">interrupt (highest), illegal instructions and traps, bus errors.</span></div>
<div style="position:absolute;left:36.00px;top:564.00px" class="cls_015"><span class="cls_015">An exception routine</span></div>
<div style="position:absolute;left:48.02px;top:577.67px" class="cls_006"><span class="cls_006">The following is an exception routine from IDT/sim.</span></div>
<div style="position:absolute;left:48.02px;top:588.67px" class="cls_006"><span class="cls_006">It receives exceptions, saves all state, and calls the appropriate service</span></div>
<div style="position:absolute;left:36.00px;top:599.67px" class="cls_006"><span class="cls_006">routine. It also shows the code used to install the exception handler in</span></div>
<div style="position:absolute;left:36.00px;top:610.67px" class="cls_006"><span class="cls_006">memory.</span></div>
<div style="position:absolute;left:36.00px;top:636.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:72.00px;top:647.00px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:108.04px;top:647.00px" class="cls_028"><span class="cls_028">exception.s - contains functions for setting up and</span></div>
<div style="position:absolute;left:72.00px;top:657.00px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:180.04px;top:657.00px" class="cls_028"><span class="cls_028">handling exceptions</span></div>
<div style="position:absolute;left:72.00px;top:667.00px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:72.00px;top:677.00px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:108.04px;top:677.00px" class="cls_028"><span class="cls_028">Copyright 1989 Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:72.00px;top:687.00px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:108.04px;top:687.00px" class="cls_028"><span class="cls_028">All Rights Reserved</span></div>
<div style="position:absolute;left:72.00px;top:696.99px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:72.00px;top:706.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:292.03px;top:755.33px" class="cls_002"><span class="cls_002">4-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:47318px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">EXCEPTION MANAGEMENT</span></div>
<div style="position:absolute;left:524.95px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 4</span></div>
<div style="position:absolute;left:252.00px;top:61.00px" class="cls_028"><span class="cls_028">#include "iregdef.h"</span></div>
<div style="position:absolute;left:252.00px;top:71.00px" class="cls_028"><span class="cls_028">#include "idtcpu.h"</span></div>
<div style="position:absolute;left:252.00px;top:81.00px" class="cls_028"><span class="cls_028">#include "idtmon.h"</span></div>
<div style="position:absolute;left:252.00px;top:91.00px" class="cls_028"><span class="cls_028">#include "setjmp.h"</span></div>
<div style="position:absolute;left:252.00px;top:101.00px" class="cls_028"><span class="cls_028">#include "excepthdr.h"</span></div>
<div style="position:absolute;left:252.00px;top:120.99px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:252.00px;top:130.99px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:288.05px;top:130.99px" class="cls_028"><span class="cls_028">move_exc_code() - moves the exception code to the utlb and</span></div>
<div style="position:absolute;left:252.03px;top:140.99px" class="cls_028"><span class="cls_028">gen</span></div>
<div style="position:absolute;left:252.03px;top:150.99px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:360.08px;top:150.99px" class="cls_028"><span class="cls_028">exception vectors</span></div>
<div style="position:absolute;left:252.03px;top:160.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.03px;top:170.99px" class="cls_028"><span class="cls_028">FRAME(move_exc_code,sp,0,ra)</span></div>
<div style="position:absolute;left:288.03px;top:180.99px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.12px;top:180.99px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:288.03px;top:190.99px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:324.08px;top:190.99px" class="cls_028"><span class="cls_028">t1,exc_utlb_code</span></div>
<div style="position:absolute;left:288.03px;top:200.99px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:324.08px;top:200.99px" class="cls_028"><span class="cls_028">t2,exc_norm_code</span></div>
<div style="position:absolute;left:288.03px;top:210.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.08px;top:210.99px" class="cls_028"><span class="cls_028">t3,UT_VEC</span></div>
<div style="position:absolute;left:288.03px;top:220.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.08px;top:220.99px" class="cls_028"><span class="cls_028">t4,E_VEC</span></div>
<div style="position:absolute;left:288.03px;top:230.98px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.08px;top:230.98px" class="cls_028"><span class="cls_028">t5,VEC_CODE_LENGTH</span></div>
<div style="position:absolute;left:252.03px;top:240.98px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:288.03px;top:250.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:250.98px" class="cls_028"><span class="cls_028">t6,0(t1)</span></div>
<div style="position:absolute;left:288.03px;top:260.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:260.98px" class="cls_028"><span class="cls_028">t7,0(t2)</span></div>
<div style="position:absolute;left:288.03px;top:270.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.08px;top:270.98px" class="cls_028"><span class="cls_028">t6,0(t3)</span></div>
<div style="position:absolute;left:288.03px;top:280.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.08px;top:280.98px" class="cls_028"><span class="cls_028">t7,0(t4)</span></div>
<div style="position:absolute;left:288.03px;top:290.98px" class="cls_028"><span class="cls_028">addiu</span></div>
<div style="position:absolute;left:324.14px;top:290.98px" class="cls_028"><span class="cls_028">t1,4</span></div>
<div style="position:absolute;left:288.03px;top:300.98px" class="cls_028"><span class="cls_028">addiu</span></div>
<div style="position:absolute;left:324.14px;top:300.98px" class="cls_028"><span class="cls_028">t3,4</span></div>
<div style="position:absolute;left:288.03px;top:310.98px" class="cls_028"><span class="cls_028">addiu</span></div>
<div style="position:absolute;left:324.14px;top:310.98px" class="cls_028"><span class="cls_028">t4,4</span></div>
<div style="position:absolute;left:288.03px;top:320.98px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:324.12px;top:320.98px" class="cls_028"><span class="cls_028">t5,4</span></div>
<div style="position:absolute;left:288.03px;top:330.97px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:324.10px;top:330.97px" class="cls_028"><span class="cls_028">t5,zero,1b</span></div>
<div style="position:absolute;left:288.03px;top:340.97px" class="cls_028"><span class="cls_028">addiu</span></div>
<div style="position:absolute;left:324.14px;top:340.97px" class="cls_028"><span class="cls_028">t2,4</span></div>
<div style="position:absolute;left:288.03px;top:350.97px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.12px;top:350.97px" class="cls_028"><span class="cls_028">t5,ra</span></div>
<div style="position:absolute;left:396.24px;top:350.97px" class="cls_028"><span class="cls_028"># assumes clear_cache doesnt use t5</span></div>
<div style="position:absolute;left:288.03px;top:360.97px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.08px;top:360.97px" class="cls_028"><span class="cls_028">a0,UT_VEC</span></div>
<div style="position:absolute;left:288.03px;top:370.97px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.10px;top:370.97px" class="cls_028"><span class="cls_028">clear_cache</span></div>
<div style="position:absolute;left:288.03px;top:380.97px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.08px;top:380.97px" class="cls_028"><span class="cls_028">a1,VEC_CODE_LENGTH</span></div>
<div style="position:absolute;left:288.03px;top:390.97px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.03px;top:400.97px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.08px;top:400.97px" class="cls_028"><span class="cls_028">a0,E_VEC</span></div>
<div style="position:absolute;left:288.03px;top:410.97px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.10px;top:410.97px" class="cls_028"><span class="cls_028">clear_cache</span></div>
<div style="position:absolute;left:288.03px;top:420.96px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.08px;top:420.96px" class="cls_028"><span class="cls_028">a1,VEC_CODE_LENGTH</span></div>
<div style="position:absolute;left:288.03px;top:430.96px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.12px;top:430.96px" class="cls_028"><span class="cls_028">ra,t5</span></div>
<div style="position:absolute;left:396.24px;top:430.96px" class="cls_028"><span class="cls_028"># restore ra</span></div>
<div style="position:absolute;left:288.03px;top:440.96px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.05px;top:440.96px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:288.03px;top:450.96px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.03px;top:460.96px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.12px;top:460.96px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:252.03px;top:470.96px" class="cls_028"><span class="cls_028">ENDFRAME(move_exc_code)</span></div>
<div style="position:absolute;left:252.03px;top:480.96px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:252.03px;top:490.96px" class="cls_028"><span class="cls_028">** enable_int(mask) - enables interrupts - mask is positoned so it</span></div>
<div style="position:absolute;left:252.00px;top:500.96px" class="cls_028"><span class="cls_028">only</span></div>
<div style="position:absolute;left:252.00px;top:510.96px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:360.05px;top:510.96px" class="cls_028"><span class="cls_028">needs to be or'ed into the status reg. This</span></div>
<div style="position:absolute;left:252.00px;top:520.96px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:360.05px;top:520.96px" class="cls_028"><span class="cls_028">also does some other things !!!! caution</span></div>
<div style="position:absolute;left:252.00px;top:530.95px" class="cls_028"><span class="cls_028">should</span></div>
<div style="position:absolute;left:252.00px;top:540.95px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:360.05px;top:540.95px" class="cls_028"><span class="cls_028">be used if invoking this while in the middle</span></div>
<div style="position:absolute;left:252.03px;top:550.95px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:360.08px;top:550.95px" class="cls_028"><span class="cls_028">of a debugging session where the client may</span></div>
<div style="position:absolute;left:252.05px;top:560.95px" class="cls_028"><span class="cls_028">have</span></div>
<div style="position:absolute;left:252.05px;top:570.95px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:360.10px;top:570.95px" class="cls_028"><span class="cls_028">nested interrupts.</span></div>
<div style="position:absolute;left:252.05px;top:580.95px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:252.05px;top:590.95px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.05px;top:600.95px" class="cls_028"><span class="cls_028">FRAME(enable_int,sp,0,ra)</span></div>
<div style="position:absolute;left:288.05px;top:610.95px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.14px;top:610.95px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:288.05px;top:620.95px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:324.10px;top:620.95px" class="cls_028"><span class="cls_028">t0,client_regs</span></div>
<div style="position:absolute;left:288.05px;top:630.94px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.10px;top:630.94px" class="cls_028"><span class="cls_028">t1,R_SR*4(t0)</span></div>
<div style="position:absolute;left:288.05px;top:640.94px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.05px;top:650.94px" class="cls_028"><span class="cls_028">or</span></div>
<div style="position:absolute;left:324.10px;top:650.94px" class="cls_028"><span class="cls_028">t1,0x4</span></div>
<div style="position:absolute;left:288.05px;top:660.94px" class="cls_028"><span class="cls_028">or</span></div>
<div style="position:absolute;left:324.10px;top:660.94px" class="cls_028"><span class="cls_028">t1,a0</span></div>
<div style="position:absolute;left:288.05px;top:670.94px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.10px;top:670.94px" class="cls_028"><span class="cls_028">t1,R_SR*4(t0)</span></div>
<div style="position:absolute;left:288.05px;top:680.94px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.14px;top:680.94px" class="cls_028"><span class="cls_028">t0,C0_SR</span></div>
<div style="position:absolute;left:288.05px;top:690.94px" class="cls_028"><span class="cls_028">or</span></div>
<div style="position:absolute;left:324.10px;top:690.94px" class="cls_028"><span class="cls_028">a0,1</span></div>
<div style="position:absolute;left:288.05px;top:700.94px" class="cls_028"><span class="cls_028">or</span></div>
<div style="position:absolute;left:324.10px;top:700.94px" class="cls_028"><span class="cls_028">t0,a0</span></div>
<div style="position:absolute;left:288.05px;top:710.94px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.14px;top:710.94px" class="cls_028"><span class="cls_028">t0,C0_SR</span></div>
<div style="position:absolute;left:288.05px;top:720.93px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.07px;top:720.93px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:305.77px;top:755.33px" class="cls_002"><span class="cls_002">4-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:48120px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 4</span></div>
<div style="position:absolute;left:437.95px;top:28.00px" class="cls_002"><span class="cls_002">EXCEPTION MANAGEMENT</span></div>
<div style="position:absolute;left:108.00px;top:51.00px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:108.00px;top:61.00px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.10px;top:61.00px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:72.00px;top:71.00px" class="cls_028"><span class="cls_028">ENDFRAME(enable_int)</span></div>
<div style="position:absolute;left:72.00px;top:81.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:72.00px;top:91.00px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:108.05px;top:91.00px" class="cls_028"><span class="cls_028">disable_int(mask) - disable the interrupt - mask is the</span></div>
<div style="position:absolute;left:72.00px;top:101.00px" class="cls_028"><span class="cls_028">compliment</span></div>
<div style="position:absolute;left:72.00px;top:111.00px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:192.76px;top:111.00px" class="cls_028"><span class="cls_028">of the bits to be cleared - i.e. to clear</span></div>
<div style="position:absolute;left:72.00px;top:120.99px" class="cls_028"><span class="cls_028">ext int</span></div>
<div style="position:absolute;left:72.00px;top:130.99px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:201.65px;top:130.99px" class="cls_028"><span class="cls_028">5 the mask would be - 0xffff7fff</span></div>
<div style="position:absolute;left:72.00px;top:140.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:72.00px;top:150.99px" class="cls_028"><span class="cls_028">FRAME(disable_int,sp,0,ra)</span></div>
<div style="position:absolute;left:108.00px;top:160.99px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.10px;top:160.99px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:108.00px;top:170.99px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:144.05px;top:170.99px" class="cls_028"><span class="cls_028">t0,client_regs</span></div>
<div style="position:absolute;left:108.00px;top:180.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:180.99px" class="cls_028"><span class="cls_028">t1,R_SR*4(t0)</span></div>
<div style="position:absolute;left:108.00px;top:190.99px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:108.00px;top:200.99px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.07px;top:200.99px" class="cls_028"><span class="cls_028">t1,a0</span></div>
<div style="position:absolute;left:108.00px;top:210.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:210.99px" class="cls_028"><span class="cls_028">t1,R_SR*4(t0)</span></div>
<div style="position:absolute;left:108.00px;top:220.99px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:144.10px;top:220.99px" class="cls_028"><span class="cls_028">t0,C0_SR</span></div>
<div style="position:absolute;left:108.00px;top:230.98px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:108.00px;top:240.98px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.07px;top:240.98px" class="cls_028"><span class="cls_028">t0,a0</span></div>
<div style="position:absolute;left:108.00px;top:250.98px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.10px;top:250.98px" class="cls_028"><span class="cls_028">t0,C0_SR</span></div>
<div style="position:absolute;left:108.00px;top:260.98px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:260.98px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:108.00px;top:270.98px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:108.00px;top:280.98px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.10px;top:280.98px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:72.00px;top:290.98px" class="cls_028"><span class="cls_028">ENDFRAME(disable_int)</span></div>
<div style="position:absolute;left:72.00px;top:310.98px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:72.00px;top:320.98px" class="cls_028"><span class="cls_028">** the following sections of code are copied to the vector area</span></div>
<div style="position:absolute;left:72.00px;top:330.97px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:108.05px;top:330.97px" class="cls_028"><span class="cls_028">at location 0x80000000 (utlb miss) and location 0x80000080</span></div>
<div style="position:absolute;left:72.02px;top:340.97px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:108.07px;top:340.97px" class="cls_028"><span class="cls_028">(general exception).</span></div>
<div style="position:absolute;left:72.02px;top:350.97px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:72.02px;top:360.97px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:108.02px;top:380.97px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.11px;top:380.97px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:108.02px;top:390.97px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.11px;top:390.97px" class="cls_028"><span class="cls_028">noat</span></div>
<div style="position:absolute;left:216.21px;top:390.97px" class="cls_028"><span class="cls_028"># must be set so la does not use at</span></div>
<div style="position:absolute;left:72.02px;top:410.97px" class="cls_028"><span class="cls_028">FRAME(exc_norm_code,sp,0,ra)</span></div>
<div style="position:absolute;left:108.02px;top:420.96px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:144.07px;top:420.96px" class="cls_028"><span class="cls_028">k0,except_regs</span></div>
<div style="position:absolute;left:108.02px;top:430.96px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.07px;top:430.96px" class="cls_028"><span class="cls_028">AT,R_AT*4(k0)</span></div>
<div style="position:absolute;left:108.02px;top:440.96px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.07px;top:440.96px" class="cls_028"><span class="cls_028">gp,R_GP*4(k0)</span></div>
<div style="position:absolute;left:108.02px;top:450.96px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.07px;top:450.96px" class="cls_028"><span class="cls_028">v0,R_V0*4(k0)</span></div>
<div style="position:absolute;left:108.02px;top:460.96px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.07px;top:460.96px" class="cls_028"><span class="cls_028">v0,NORM_EXCEPT</span></div>
<div style="position:absolute;left:108.02px;top:470.96px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:144.07px;top:470.96px" class="cls_028"><span class="cls_028">AT,exception</span></div>
<div style="position:absolute;left:108.02px;top:480.96px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.04px;top:480.96px" class="cls_028"><span class="cls_028">AT</span></div>
<div style="position:absolute;left:108.02px;top:490.96px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:108.02px;top:500.96px" class="cls_028"><span class="cls_028">ENDFRAME(exc_norm_code)</span></div>
<div style="position:absolute;left:72.02px;top:510.96px" class="cls_028"><span class="cls_028">FRAME(exc_utlb_code,sp,0,ra)</span></div>
<div style="position:absolute;left:108.02px;top:520.96px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:144.07px;top:520.96px" class="cls_028"><span class="cls_028">k0,except_regs</span></div>
<div style="position:absolute;left:108.02px;top:530.95px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.07px;top:530.95px" class="cls_028"><span class="cls_028">AT,R_AT*4(k0)</span></div>
<div style="position:absolute;left:108.02px;top:540.95px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.07px;top:540.95px" class="cls_028"><span class="cls_028">gp,R_GP*4(k0)</span></div>
<div style="position:absolute;left:108.02px;top:550.95px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.07px;top:550.95px" class="cls_028"><span class="cls_028">v0,R_V0*4(k0)</span></div>
<div style="position:absolute;left:108.02px;top:560.95px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.07px;top:560.95px" class="cls_028"><span class="cls_028">v0,UTLB_EXCEPT</span></div>
<div style="position:absolute;left:108.02px;top:570.95px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:144.07px;top:570.95px" class="cls_028"><span class="cls_028">AT,exception</span></div>
<div style="position:absolute;left:108.02px;top:580.95px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.04px;top:580.95px" class="cls_028"><span class="cls_028">AT</span></div>
<div style="position:absolute;left:108.02px;top:590.95px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:108.02px;top:610.95px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.11px;top:610.95px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:72.02px;top:630.94px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:72.02px;top:640.94px" class="cls_028"><span class="cls_028">** common exception handling code</span></div>
<div style="position:absolute;left:72.02px;top:650.94px" class="cls_028"><span class="cls_028">** Save various registers so we can print informative messages</span></div>
<div style="position:absolute;left:72.02px;top:660.94px" class="cls_028"><span class="cls_028">** for faults (whether in monitor or client mode)</span></div>
<div style="position:absolute;left:72.02px;top:670.94px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:108.07px;top:670.94px" class="cls_028"><span class="cls_028">Reg.(k0) points to the exception register save area.</span></div>
<div style="position:absolute;left:72.02px;top:680.94px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:108.07px;top:680.94px" class="cls_028"><span class="cls_028">If we are in client mode then some of these values will</span></div>
<div style="position:absolute;left:72.02px;top:690.94px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:108.07px;top:690.94px" class="cls_028"><span class="cls_028">have to be copied to the client register save area.</span></div>
<div style="position:absolute;left:72.02px;top:700.94px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:108.02px;top:710.94px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.11px;top:710.94px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">4-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:48922px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:49.99px;top:28.00px" class="cls_002"><span class="cls_002">EXCEPTION MANAGEMENT</span></div>
<div style="position:absolute;left:524.94px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 4</span></div>
<div style="position:absolute;left:252.00px;top:51.00px" class="cls_028"><span class="cls_028">exception:</span></div>
<div style="position:absolute;left:288.00px;top:61.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:61.00px" class="cls_028"><span class="cls_028">v0,R_EXCTYPE*4(k0)</span></div>
<div style="position:absolute;left:431.80px;top:61.00px" class="cls_028"><span class="cls_028"># save exception type (gen or</span></div>
<div style="position:absolute;left:252.00px;top:71.00px" class="cls_028"><span class="cls_028">utlb)</span></div>
<div style="position:absolute;left:288.00px;top:81.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:81.00px" class="cls_028"><span class="cls_028">v1,R_V1*4(k0)</span></div>
<div style="position:absolute;left:288.00px;top:91.00px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.10px;top:91.00px" class="cls_028"><span class="cls_028">v0,C0_EPC</span></div>
<div style="position:absolute;left:288.00px;top:101.00px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.10px;top:101.00px" class="cls_028"><span class="cls_028">v1,C0_SR</span></div>
<div style="position:absolute;left:288.00px;top:111.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:111.00px" class="cls_028"><span class="cls_028">v0,R_EPC*4(k0)# save the pc at the time of the</span></div>
<div style="position:absolute;left:252.00px;top:120.99px" class="cls_028"><span class="cls_028">exception</span></div>
<div style="position:absolute;left:288.00px;top:130.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:130.99px" class="cls_028"><span class="cls_028">v1,R_SR*4(k0)</span></div>
<div style="position:absolute;left:288.00px;top:140.99px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.10px;top:140.99px" class="cls_028"><span class="cls_028">noat</span></div>
<div style="position:absolute;left:288.00px;top:150.99px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:324.05px;top:150.99px" class="cls_028"><span class="cls_028">AT,client_regs# get address of client reg save area</span></div>
<div style="position:absolute;left:288.02px;top:160.99px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.11px;top:160.99px" class="cls_028"><span class="cls_028">v0,C0_BADVADDR</span></div>
<div style="position:absolute;left:288.02px;top:170.99px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.11px;top:170.99px" class="cls_028"><span class="cls_028">v1,C0_CAUSE</span></div>
<div style="position:absolute;left:288.02px;top:180.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.07px;top:180.99px" class="cls_028"><span class="cls_028">v0,R_BADVADDR*4(k0)</span></div>
<div style="position:absolute;left:288.02px;top:190.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.07px;top:190.99px" class="cls_028"><span class="cls_028">v0,R_BADVADDR*4(AT)</span></div>
<div style="position:absolute;left:288.02px;top:200.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.07px;top:200.99px" class="cls_028"><span class="cls_028">v1,R_CAUSE*4(k0)</span></div>
<div style="position:absolute;left:288.02px;top:210.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.07px;top:210.99px" class="cls_028"><span class="cls_028">v1,R_CAUSE*4(AT)</span></div>
<div style="position:absolute;left:288.02px;top:220.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.07px;top:220.99px" class="cls_028"><span class="cls_028">sp,R_SP*4(k0)</span></div>
<div style="position:absolute;left:288.02px;top:230.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.07px;top:230.98px" class="cls_028"><span class="cls_028">sp,R_SP*4(AT)</span></div>
<div style="position:absolute;left:288.02px;top:240.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.07px;top:240.98px" class="cls_028"><span class="cls_028">v0,user_int_fast#see if a client wants a shot at it</span></div>
<div style="position:absolute;left:288.04px;top:250.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.08px;top:250.98px" class="cls_028"><span class="cls_028">a0,R_A0*4(k0)</span></div>
<div style="position:absolute;left:288.04px;top:260.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.08px;top:260.98px" class="cls_028"><span class="cls_028">a0,R_A0*4(AT)</span></div>
<div style="position:absolute;left:288.04px;top:270.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.08px;top:270.98px" class="cls_028"><span class="cls_028">ra,R_RA*4(k0)</span></div>
<div style="position:absolute;left:288.04px;top:280.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.08px;top:280.98px" class="cls_028"><span class="cls_028">ra,R_RA*4(AT)</span></div>
<div style="position:absolute;left:288.04px;top:290.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:290.98px" class="cls_028"><span class="cls_028">sp,fault_stack # use "fault" stack</span></div>
<div style="position:absolute;left:288.04px;top:300.98px" class="cls_028"><span class="cls_028">beq</span></div>
<div style="position:absolute;left:324.10px;top:300.98px" class="cls_028"><span class="cls_028">v0,zero,1f</span></div>
<div style="position:absolute;left:396.34px;top:300.98px" class="cls_028"><span class="cls_028"># skip the following if no client</span></div>
<div style="position:absolute;left:288.04px;top:310.98px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.04px;top:320.98px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.13px;top:320.98px" class="cls_028"><span class="cls_028">a0,AT</span></div>
<div style="position:absolute;left:288.04px;top:330.97px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.10px;top:330.97px" class="cls_028"><span class="cls_028">v0</span></div>
<div style="position:absolute;left:288.04px;top:340.97px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.04px;top:350.97px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:324.08px;top:350.97px" class="cls_028"><span class="cls_028">k0,except_regs</span></div>
<div style="position:absolute;left:288.04px;top:360.97px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:324.08px;top:360.97px" class="cls_028"><span class="cls_028">AT,client_regs</span></div>
<div style="position:absolute;left:288.04px;top:370.97px" class="cls_028"><span class="cls_028">beq</span></div>
<div style="position:absolute;left:324.10px;top:370.97px" class="cls_028"><span class="cls_028">v0,zero,1f</span></div>
<div style="position:absolute;left:396.34px;top:370.97px" class="cls_028"><span class="cls_028"># returns false if user did not</span></div>
<div style="position:absolute;left:252.04px;top:380.97px" class="cls_028"><span class="cls_028">handle</span></div>
<div style="position:absolute;left:288.04px;top:390.97px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.04px;top:400.97px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:324.08px;top:400.97px" class="cls_028"><span class="cls_028">v1,except_regs</span></div>
<div style="position:absolute;left:288.04px;top:410.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:410.97px" class="cls_028"><span class="cls_028">ra,R_RA*4(v1)</span></div>
<div style="position:absolute;left:288.04px;top:420.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:420.96px" class="cls_028"><span class="cls_028">AT,R_AT*4(v1)</span></div>
<div style="position:absolute;left:288.04px;top:430.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:430.96px" class="cls_028"><span class="cls_028">gp,R_GP*4(v1)</span></div>
<div style="position:absolute;left:288.04px;top:440.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:440.96px" class="cls_028"><span class="cls_028">v0,R_V0*4(v1)</span></div>
<div style="position:absolute;left:288.04px;top:450.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:450.96px" class="cls_028"><span class="cls_028">sp,R_SP*4(v1)</span></div>
<div style="position:absolute;left:288.04px;top:460.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:460.96px" class="cls_028"><span class="cls_028">a0,R_A0*4(v1)</span></div>
<div style="position:absolute;left:288.04px;top:470.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:470.96px" class="cls_028"><span class="cls_028">k0,R_EPC*4(v1)</span></div>
<div style="position:absolute;left:288.04px;top:480.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:480.96px" class="cls_028"><span class="cls_028">v1,R_V1*4(v1)</span></div>
<div style="position:absolute;left:288.04px;top:490.96px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.06px;top:490.96px" class="cls_028"><span class="cls_028">k0</span></div>
<div style="position:absolute;left:288.04px;top:500.96px" class="cls_028"><span class="cls_028">rfe</span></div>
<div style="position:absolute;left:252.04px;top:510.96px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:252.04px;top:520.96px" class="cls_028"><span class="cls_028">** Save registers if in client mode</span></div>
<div style="position:absolute;left:252.04px;top:530.95px" class="cls_028"><span class="cls_028">** then change mode to prom mode currently k0 is pointing</span></div>
<div style="position:absolute;left:252.04px;top:540.95px" class="cls_028"><span class="cls_028">** exception reg. save area - v0, v1, AT, gp, sp regs were saved</span></div>
<div style="position:absolute;left:252.04px;top:550.95px" class="cls_028"><span class="cls_028">** epc, sr, badvaddr and cause were also saved.</span></div>
<div style="position:absolute;left:252.04px;top:560.95px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.04px;top:570.95px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:288.04px;top:580.95px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:580.95px" class="cls_028"><span class="cls_028">v0,R_MODE*4(AT)# get the current op. mode</span></div>
<div style="position:absolute;left:288.04px;top:590.95px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:590.95px" class="cls_028"><span class="cls_028">v1,R_EXCTYPE*4(k0)</span></div>
<div style="position:absolute;left:288.04px;top:600.95px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.08px;top:600.95px" class="cls_028"><span class="cls_028">v0,R_MODE*4(k0)# save the current prom mode</span></div>
<div style="position:absolute;left:288.04px;top:610.95px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.08px;top:610.95px" class="cls_028"><span class="cls_028">v1,R_EXCTYPE*4(AT)</span></div>
<div style="position:absolute;left:288.04px;top:620.95px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.08px;top:620.95px" class="cls_028"><span class="cls_028">v1,MODE_MONITOR# see if it</span></div>
<div style="position:absolute;left:288.04px;top:630.94px" class="cls_028"><span class="cls_028">beq</span></div>
<div style="position:absolute;left:324.10px;top:630.94px" class="cls_028"><span class="cls_028">v0,v1,nosave</span></div>
<div style="position:absolute;left:396.38px;top:630.94px" class="cls_028"><span class="cls_028"># was in prom mode</span></div>
<div style="position:absolute;left:288.04px;top:640.94px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.04px;top:650.94px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.08px;top:650.94px" class="cls_028"><span class="cls_028">v0,MODE_MONITOR</span></div>
<div style="position:absolute;left:288.04px;top:660.94px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.08px;top:660.94px" class="cls_028"><span class="cls_028">v0,R_MODE*4(AT)# now in prom mode</span></div>
<div style="position:absolute;left:288.04px;top:670.94px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:670.94px" class="cls_028"><span class="cls_028">v0,R_GP*4(k0)</span></div>
<div style="position:absolute;left:288.04px;top:680.94px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:680.94px" class="cls_028"><span class="cls_028">v1,R_EPC*4(k0)</span></div>
<div style="position:absolute;left:288.04px;top:690.94px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.08px;top:690.94px" class="cls_028"><span class="cls_028">v0,R_GP*4(AT)</span></div>
<div style="position:absolute;left:288.04px;top:700.94px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.08px;top:700.94px" class="cls_028"><span class="cls_028">v1,R_EPC*4(AT)</span></div>
<div style="position:absolute;left:288.04px;top:710.94px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:710.94px" class="cls_028"><span class="cls_028">v0,R_SR*4(k0)</span></div>
<div style="position:absolute;left:288.04px;top:720.93px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.08px;top:720.93px" class="cls_028"><span class="cls_028">v1,R_AT*4(k0)</span></div>
<div style="position:absolute;left:305.77px;top:755.33px" class="cls_002"><span class="cls_002">4-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:49724px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 4</span></div>
<div style="position:absolute;left:437.95px;top:28.00px" class="cls_002"><span class="cls_002">EXCEPTION MANAGEMENT</span></div>
<div style="position:absolute;left:108.00px;top:51.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:51.00px" class="cls_028"><span class="cls_028">v0,R_SR*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:61.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:61.00px" class="cls_028"><span class="cls_028">v1,R_AT*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:71.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:71.00px" class="cls_028"><span class="cls_028">v0,R_V0*4(k0)</span></div>
<div style="position:absolute;left:108.00px;top:81.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:81.00px" class="cls_028"><span class="cls_028">v1,R_V1*4(k0)</span></div>
<div style="position:absolute;left:108.00px;top:91.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:91.00px" class="cls_028"><span class="cls_028">v0,R_V0*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:101.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:101.00px" class="cls_028"><span class="cls_028">v1,R_V1*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:111.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:111.00px" class="cls_028"><span class="cls_028">a1,R_A1*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:120.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:120.99px" class="cls_028"><span class="cls_028">a2,R_A2*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:130.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:130.99px" class="cls_028"><span class="cls_028">a3,R_A3*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:140.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:140.99px" class="cls_028"><span class="cls_028">t0,R_T0*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:150.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:150.99px" class="cls_028"><span class="cls_028">t1,R_T1*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:160.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:160.99px" class="cls_028"><span class="cls_028">t2,R_T2*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:170.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:170.99px" class="cls_028"><span class="cls_028">t3,R_T3*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:180.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:180.99px" class="cls_028"><span class="cls_028">t4,R_T4*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:190.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:190.99px" class="cls_028"><span class="cls_028">t5,R_T5*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:200.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:200.99px" class="cls_028"><span class="cls_028">t6,R_T6*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:210.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:210.99px" class="cls_028"><span class="cls_028">t7,R_T7*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:220.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:220.99px" class="cls_028"><span class="cls_028">s0,R_S0*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:230.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:230.98px" class="cls_028"><span class="cls_028">s1,R_S1*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:240.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:240.98px" class="cls_028"><span class="cls_028">s2,R_S2*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:250.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:250.98px" class="cls_028"><span class="cls_028">s3,R_S3*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:260.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:260.98px" class="cls_028"><span class="cls_028">s4,R_S4*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:270.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:270.98px" class="cls_028"><span class="cls_028">s5,R_S5*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:280.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:280.98px" class="cls_028"><span class="cls_028">s6,R_S6*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:290.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:290.98px" class="cls_028"><span class="cls_028">s7,R_S7*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:300.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:300.98px" class="cls_028"><span class="cls_028">t8,R_T8*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:310.98px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:310.98px" class="cls_028"><span class="cls_028">v0,0xbababadd #This reg (k0) is invalid</span></div>
<div style="position:absolute;left:108.00px;top:320.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:320.98px" class="cls_028"><span class="cls_028">t9,R_T9*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:330.97px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:330.97px" class="cls_028"><span class="cls_028">v0,R_K0*4(AT) # should be obvious</span></div>
<div style="position:absolute;left:108.00px;top:340.97px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:340.97px" class="cls_028"><span class="cls_028">k1,R_K1*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:350.97px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:350.97px" class="cls_028"><span class="cls_028">fp,R_FP*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:360.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:360.97px" class="cls_028"><span class="cls_028">v0,status_base</span></div>
<div style="position:absolute;left:108.00px;top:370.97px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:370.97px" class="cls_028"><span class="cls_028">v1,AT</span></div>
<div style="position:absolute;left:108.00px;top:380.97px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.07px;top:380.97px" class="cls_028"><span class="cls_028">v0,SR_CU1</span></div>
<div style="position:absolute;left:108.00px;top:390.97px" class="cls_028"><span class="cls_028">beq</span></div>
<div style="position:absolute;left:144.07px;top:390.97px" class="cls_028"><span class="cls_028">v0,zero,1f</span></div>
<div style="position:absolute;left:252.30px;top:390.97px" class="cls_028"><span class="cls_028"># only save fpu regs if</span></div>
<div style="position:absolute;left:72.00px;top:400.97px" class="cls_028"><span class="cls_028">present</span></div>
<div style="position:absolute;left:108.00px;top:410.97px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:410.97px" class="cls_028"><span class="cls_028">AT,v1</span></div>
<div style="position:absolute;left:108.00px;top:420.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:420.96px" class="cls_028"><span class="cls_028">v1,R_SR*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:430.96px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.07px;top:430.96px" class="cls_028"><span class="cls_028">v0,v1</span></div>
<div style="position:absolute;left:108.00px;top:440.96px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:440.96px" class="cls_028"><span class="cls_028">v0,C0_SR</span></div>
<div style="position:absolute;left:108.00px;top:450.96px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:108.00px;top:460.96px" class="cls_028"><span class="cls_028">cfc1</span></div>
<div style="position:absolute;left:144.09px;top:460.96px" class="cls_028"><span class="cls_028">v0,$30</span></div>
<div style="position:absolute;left:108.00px;top:470.96px" class="cls_028"><span class="cls_028">cfc1</span></div>
<div style="position:absolute;left:144.09px;top:470.96px" class="cls_028"><span class="cls_028">v1,$31</span></div>
<div style="position:absolute;left:108.00px;top:480.96px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:480.96px" class="cls_028"><span class="cls_028">v0,R_FEIR*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:490.96px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:490.96px" class="cls_028"><span class="cls_028">v1,R_FCSR*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:500.96px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:500.96px" class="cls_028"><span class="cls_028">fp0,R_F0*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:510.96px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:510.96px" class="cls_028"><span class="cls_028">fp1,R_F1*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:520.96px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:520.96px" class="cls_028"><span class="cls_028">fp2,R_F2*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:530.95px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:530.95px" class="cls_028"><span class="cls_028">fp3,R_F3*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:540.95px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:540.95px" class="cls_028"><span class="cls_028">fp4,R_F4*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:550.95px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:550.95px" class="cls_028"><span class="cls_028">fp5,R_F5*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:560.95px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:560.95px" class="cls_028"><span class="cls_028">fp6,R_F6*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:570.95px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:570.95px" class="cls_028"><span class="cls_028">fp7,R_F7*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:580.95px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:580.95px" class="cls_028"><span class="cls_028">fp8,R_F8*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:590.95px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:590.95px" class="cls_028"><span class="cls_028">fp9,R_F9*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:600.95px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:600.95px" class="cls_028"><span class="cls_028">fp10,R_F10*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:610.95px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:610.95px" class="cls_028"><span class="cls_028">fp11,R_F11*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:620.95px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:620.95px" class="cls_028"><span class="cls_028">fp12,R_F12*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:630.94px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:630.94px" class="cls_028"><span class="cls_028">fp13,R_F13*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:640.94px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:640.94px" class="cls_028"><span class="cls_028">fp14,R_F14*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:650.94px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:650.94px" class="cls_028"><span class="cls_028">fp15,R_F15*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:660.94px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:660.94px" class="cls_028"><span class="cls_028">fp16,R_F16*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:670.94px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:670.94px" class="cls_028"><span class="cls_028">fp17,R_F17*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:680.94px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:680.94px" class="cls_028"><span class="cls_028">fp18,R_F18*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:690.94px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:690.94px" class="cls_028"><span class="cls_028">fp19,R_F19*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:700.94px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:700.94px" class="cls_028"><span class="cls_028">fp20,R_F20*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:710.94px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:710.94px" class="cls_028"><span class="cls_028">fp21,R_F21*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:720.93px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:144.09px;top:720.93px" class="cls_028"><span class="cls_028">fp22,R_F22*4(AT)</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">4-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:50526px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">EXCEPTION MANAGEMENT</span></div>
<div style="position:absolute;left:524.95px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 4</span></div>
<div style="position:absolute;left:288.00px;top:51.00px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:324.09px;top:51.00px" class="cls_028"><span class="cls_028">fp23,R_F23*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:61.00px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:324.09px;top:61.00px" class="cls_028"><span class="cls_028">fp24,R_F24*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:71.00px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:324.09px;top:71.00px" class="cls_028"><span class="cls_028">fp25,R_F25*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:81.00px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:324.09px;top:81.00px" class="cls_028"><span class="cls_028">fp26,R_F26*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:91.00px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:324.09px;top:91.00px" class="cls_028"><span class="cls_028">fp27,R_F27*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:101.00px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:324.09px;top:101.00px" class="cls_028"><span class="cls_028">fp28,R_F28*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:111.00px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:324.09px;top:111.00px" class="cls_028"><span class="cls_028">fp29,R_F29*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:120.99px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:324.09px;top:120.99px" class="cls_028"><span class="cls_028">fp30,R_F30*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:130.99px" class="cls_028"><span class="cls_028">swc1</span></div>
<div style="position:absolute;left:324.09px;top:130.99px" class="cls_028"><span class="cls_028">fp31,R_F31*4(AT)</span></div>
<div style="position:absolute;left:252.00px;top:140.99px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:288.00px;top:150.99px" class="cls_028"><span class="cls_028">mflo</span></div>
<div style="position:absolute;left:324.09px;top:150.99px" class="cls_028"><span class="cls_028">v0</span></div>
<div style="position:absolute;left:288.00px;top:160.99px" class="cls_028"><span class="cls_028">mfhi</span></div>
<div style="position:absolute;left:324.09px;top:160.99px" class="cls_028"><span class="cls_028">v1</span></div>
<div style="position:absolute;left:288.00px;top:170.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:170.99px" class="cls_028"><span class="cls_028">v0,R_MDLO*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:180.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:180.99px" class="cls_028"><span class="cls_028">v1,R_MDHI*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:190.99px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.09px;top:190.99px" class="cls_028"><span class="cls_028">v0,C0_INX</span></div>
<div style="position:absolute;left:288.00px;top:200.99px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.09px;top:200.99px" class="cls_028"><span class="cls_028">v1,C0_RAND</span></div>
<div style="position:absolute;left:288.00px;top:210.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:210.99px" class="cls_028"><span class="cls_028">v0,R_INX*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:220.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:220.99px" class="cls_028"><span class="cls_028">v1,R_RAND*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:230.98px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.09px;top:230.98px" class="cls_028"><span class="cls_028">v0,C0_TLBLO</span></div>
<div style="position:absolute;left:288.00px;top:240.98px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.09px;top:240.98px" class="cls_028"><span class="cls_028">v1,C0_TLBHI</span></div>
<div style="position:absolute;left:288.00px;top:250.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:250.98px" class="cls_028"><span class="cls_028">v0,R_TLBLO*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:260.98px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.09px;top:260.98px" class="cls_028"><span class="cls_028">v0,C0_CTXT</span></div>
<div style="position:absolute;left:288.00px;top:270.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:270.98px" class="cls_028"><span class="cls_028">v1,R_TLBHI*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:280.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:280.98px" class="cls_028"><span class="cls_028">v0,R_CTXT*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:290.98px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:290.98px" class="cls_028"><span class="cls_028">at</span></div>
<div style="position:absolute;left:252.00px;top:300.98px" class="cls_028"><span class="cls_028">nosave:</span></div>
<div style="position:absolute;left:288.00px;top:310.98px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:310.98px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:288.00px;top:320.98px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.02px;top:320.98px" class="cls_028"><span class="cls_028">exception_handler</span></div>
<div style="position:absolute;left:288.00px;top:340.97px" class="cls_028"><span class="cls_028">ENDFRAME(exc_utlb_code)</span></div>
<div style="position:absolute;left:252.00px;top:350.97px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:252.00px;top:360.97px" class="cls_028"><span class="cls_028">** resume -- resume execution of client code</span></div>
<div style="position:absolute;left:252.00px;top:370.97px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.00px;top:380.97px" class="cls_028"><span class="cls_028">FRAME(resume,sp,0,ra)</span></div>
<div style="position:absolute;left:288.00px;top:390.97px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:390.97px" class="cls_028"><span class="cls_028">install_sticky</span></div>
<div style="position:absolute;left:288.00px;top:400.97px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:400.97px" class="cls_028"><span class="cls_028">clr_extern_brk</span></div>
<div style="position:absolute;left:288.00px;top:410.97px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:410.97px" class="cls_028"><span class="cls_028">clear_remote_int</span></div>
<div style="position:absolute;left:288.00px;top:420.96px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:420.96px" class="cls_028"><span class="cls_028">noat</span></div>
<div style="position:absolute;left:288.00px;top:430.96px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:430.96px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:288.00px;top:440.96px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:324.05px;top:440.96px" class="cls_028"><span class="cls_028">AT,client_regs</span></div>
<div style="position:absolute;left:288.00px;top:450.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:450.96px" class="cls_028"><span class="cls_028">v0,status_base</span></div>
<div style="position:absolute;left:288.00px;top:460.96px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.09px;top:460.96px" class="cls_028"><span class="cls_028">v1,AT</span></div>
<div style="position:absolute;left:288.00px;top:470.96px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:324.07px;top:470.96px" class="cls_028"><span class="cls_028">v0,SR_CU1</span></div>
<div style="position:absolute;left:288.00px;top:480.96px" class="cls_028"><span class="cls_028">beq</span></div>
<div style="position:absolute;left:324.07px;top:480.96px" class="cls_028"><span class="cls_028">v0,zero,1f</span></div>
<div style="position:absolute;left:396.30px;top:480.96px" class="cls_028"><span class="cls_028"># only save fpu regs if present</span></div>
<div style="position:absolute;left:288.00px;top:490.96px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.09px;top:490.96px" class="cls_028"><span class="cls_028">AT,v1</span></div>
<div style="position:absolute;left:288.00px;top:500.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:500.96px" class="cls_028"><span class="cls_028">v1,R_SR*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:510.96px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:520.96px" class="cls_028"><span class="cls_028">or</span></div>
<div style="position:absolute;left:324.05px;top:520.96px" class="cls_028"><span class="cls_028">v0,v1</span></div>
<div style="position:absolute;left:288.00px;top:530.95px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:530.95px" class="cls_028"><span class="cls_028">v0,C0_SR</span></div>
<div style="position:absolute;left:288.00px;top:540.95px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:540.95px" class="cls_028"><span class="cls_028">v1,R_FCSR*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:550.95px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:550.95px" class="cls_028"><span class="cls_028">fp0,R_F0*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:560.95px" class="cls_028"><span class="cls_028">ctc1</span></div>
<div style="position:absolute;left:324.09px;top:560.95px" class="cls_028"><span class="cls_028">v1,$31</span></div>
<div style="position:absolute;left:288.00px;top:570.95px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:570.95px" class="cls_028"><span class="cls_028">fp1,R_F1*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:580.95px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:580.95px" class="cls_028"><span class="cls_028">fp2,R_F2*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:590.95px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:590.95px" class="cls_028"><span class="cls_028">fp3,R_F3*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:600.95px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:600.95px" class="cls_028"><span class="cls_028">fp4,R_F4*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:610.95px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:610.95px" class="cls_028"><span class="cls_028">fp5,R_F5*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:620.95px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:620.95px" class="cls_028"><span class="cls_028">fp6,R_F6*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:630.94px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:630.94px" class="cls_028"><span class="cls_028">fp7,R_F7*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:640.94px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:640.94px" class="cls_028"><span class="cls_028">fp8,R_F8*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:650.94px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:650.94px" class="cls_028"><span class="cls_028">fp9,R_F9*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:660.94px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:660.94px" class="cls_028"><span class="cls_028">fp10,R_F10*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:670.94px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:670.94px" class="cls_028"><span class="cls_028">fp11,R_F11*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:680.94px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:680.94px" class="cls_028"><span class="cls_028">fp12,R_F12*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:690.94px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:690.94px" class="cls_028"><span class="cls_028">fp13,R_F13*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:700.94px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:700.94px" class="cls_028"><span class="cls_028">fp14,R_F14*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:710.94px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:710.94px" class="cls_028"><span class="cls_028">fp15,R_F15*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:720.93px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:324.09px;top:720.93px" class="cls_028"><span class="cls_028">fp16,R_F16*4(AT)</span></div>
<div style="position:absolute;left:305.77px;top:755.33px" class="cls_002"><span class="cls_002">4-9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:51328px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 4</span></div>
<div style="position:absolute;left:437.95px;top:28.00px" class="cls_002"><span class="cls_002">EXCEPTION MANAGEMENT</span></div>
<div style="position:absolute;left:108.00px;top:51.00px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:144.09px;top:51.00px" class="cls_028"><span class="cls_028">fp17,R_F17*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:61.00px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:144.09px;top:61.00px" class="cls_028"><span class="cls_028">fp18,R_F18*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:71.00px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:144.09px;top:71.00px" class="cls_028"><span class="cls_028">fp19,R_F19*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:81.00px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:144.09px;top:81.00px" class="cls_028"><span class="cls_028">fp20,R_F20*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:91.00px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:144.09px;top:91.00px" class="cls_028"><span class="cls_028">fp21,R_F21*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:101.00px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:144.09px;top:101.00px" class="cls_028"><span class="cls_028">fp22,R_F22*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:111.00px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:144.09px;top:111.00px" class="cls_028"><span class="cls_028">fp23,R_F23*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:120.99px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:144.09px;top:120.99px" class="cls_028"><span class="cls_028">fp24,R_F24*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:130.99px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:144.09px;top:130.99px" class="cls_028"><span class="cls_028">fp25,R_F25*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:140.99px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:144.09px;top:140.99px" class="cls_028"><span class="cls_028">fp26,R_F26*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:150.99px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:144.09px;top:150.99px" class="cls_028"><span class="cls_028">fp27,R_F27*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:160.99px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:144.09px;top:160.99px" class="cls_028"><span class="cls_028">fp28,R_F28*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:170.99px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:144.09px;top:170.99px" class="cls_028"><span class="cls_028">fp29,R_F29*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:180.99px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:144.09px;top:180.99px" class="cls_028"><span class="cls_028">fp30,R_F30*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:190.99px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:144.09px;top:190.99px" class="cls_028"><span class="cls_028">fp31,R_F31*4(AT)</span></div>
<div style="position:absolute;left:72.00px;top:200.99px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:108.00px;top:210.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:210.99px" class="cls_028"><span class="cls_028">a0,R_A0*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:220.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:220.99px" class="cls_028"><span class="cls_028">a1,R_A1*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:230.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:230.98px" class="cls_028"><span class="cls_028">a2,R_A2*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:240.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:240.98px" class="cls_028"><span class="cls_028">a3,R_A3*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:250.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:250.98px" class="cls_028"><span class="cls_028">t0,R_T0*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:260.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:260.98px" class="cls_028"><span class="cls_028">t1,R_T1*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:270.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:270.98px" class="cls_028"><span class="cls_028">t2,R_T2*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:280.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:280.98px" class="cls_028"><span class="cls_028">t3,R_T3*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:290.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:290.98px" class="cls_028"><span class="cls_028">t4,R_T4*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:300.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:300.98px" class="cls_028"><span class="cls_028">t5,R_T5*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:310.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:310.98px" class="cls_028"><span class="cls_028">t6,R_T6*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:320.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:320.98px" class="cls_028"><span class="cls_028">t7,R_T7*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:330.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:330.97px" class="cls_028"><span class="cls_028">s0,R_S0*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:340.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:340.97px" class="cls_028"><span class="cls_028">s1,R_S1*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:350.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:350.97px" class="cls_028"><span class="cls_028">s2,R_S2*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:360.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:360.97px" class="cls_028"><span class="cls_028">s3,R_S3*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:370.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:370.97px" class="cls_028"><span class="cls_028">s4,R_S4*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:380.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:380.97px" class="cls_028"><span class="cls_028">s5,R_S5*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:390.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:390.97px" class="cls_028"><span class="cls_028">s6,R_S6*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:400.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:400.97px" class="cls_028"><span class="cls_028">s7,R_S7*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:410.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:410.97px" class="cls_028"><span class="cls_028">t8,R_T8*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:420.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:420.96px" class="cls_028"><span class="cls_028">t9,R_T9*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:430.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:430.96px" class="cls_028"><span class="cls_028">k1,R_K1*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:440.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:440.96px" class="cls_028"><span class="cls_028">gp,R_GP*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:450.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:450.96px" class="cls_028"><span class="cls_028">fp,R_FP*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:460.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:460.96px" class="cls_028"><span class="cls_028">ra,R_RA*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:470.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:470.96px" class="cls_028"><span class="cls_028">v0,R_MDLO*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:480.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:480.96px" class="cls_028"><span class="cls_028">v1,R_MDHI*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:490.96px" class="cls_028"><span class="cls_028">mtlo</span></div>
<div style="position:absolute;left:144.09px;top:490.96px" class="cls_028"><span class="cls_028">v0</span></div>
<div style="position:absolute;left:108.00px;top:500.96px" class="cls_028"><span class="cls_028">mthi</span></div>
<div style="position:absolute;left:144.09px;top:500.96px" class="cls_028"><span class="cls_028">v1</span></div>
<div style="position:absolute;left:108.00px;top:510.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:510.96px" class="cls_028"><span class="cls_028">v0,R_INX*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:520.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:520.96px" class="cls_028"><span class="cls_028">v1,R_TLBLO*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:530.95px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:530.95px" class="cls_028"><span class="cls_028">v0,C0_INX</span></div>
<div style="position:absolute;left:108.00px;top:540.95px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:540.95px" class="cls_028"><span class="cls_028">v1,C0_TLBLO</span></div>
<div style="position:absolute;left:108.00px;top:550.95px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:550.95px" class="cls_028"><span class="cls_028">v0,R_TLBHI*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:560.95px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:560.95px" class="cls_028"><span class="cls_028">v1,R_CTXT*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:570.95px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:570.95px" class="cls_028"><span class="cls_028">v0,C0_TLBHI</span></div>
<div style="position:absolute;left:108.00px;top:580.95px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:580.95px" class="cls_028"><span class="cls_028">v1,C0_CTXT</span></div>
<div style="position:absolute;left:108.00px;top:590.95px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:590.95px" class="cls_028"><span class="cls_028">v0,R_CAUSE*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:600.95px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:600.95px" class="cls_028"><span class="cls_028">v1,R_SR*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:610.95px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:610.95px" class="cls_028"><span class="cls_028">v0,C0_CAUSE</span></div>
<div style="position:absolute;left:252.35px;top:610.95px" class="cls_028"><span class="cls_028">/* only sw0 and 1 writable  */</span></div>
<div style="position:absolute;left:108.00px;top:620.95px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:620.95px" class="cls_028"><span class="cls_028">v0,AT</span></div>
<div style="position:absolute;left:108.00px;top:630.94px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.06px;top:630.94px" class="cls_028"><span class="cls_028">v1,~(SR_KUC|SR_IEC|SR_PE)/* make sure we aren't</span></div>
<div style="position:absolute;left:72.00px;top:640.94px" class="cls_028"><span class="cls_028">intr */</span></div>
<div style="position:absolute;left:108.00px;top:650.94px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:650.94px" class="cls_028"><span class="cls_028">v1,C0_SR</span></div>
<div style="position:absolute;left:108.00px;top:660.94px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:660.94px" class="cls_028"><span class="cls_028">k0,MODE_USER</span></div>
<div style="position:absolute;left:108.00px;top:670.94px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:670.94px" class="cls_028"><span class="cls_028">AT,v0</span></div>
<div style="position:absolute;left:108.00px;top:680.94px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:680.94px" class="cls_028"><span class="cls_028">k0,R_MODE*4(AT)</span></div>
<div style="position:absolute;left:252.39px;top:680.94px" class="cls_028"><span class="cls_028">/* reset  mode */</span></div>
<div style="position:absolute;left:108.00px;top:690.94px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:690.94px" class="cls_028"><span class="cls_028">v1,R_V1*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:700.94px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:700.94px" class="cls_028"><span class="cls_028">sp,R_SP*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:710.94px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:710.94px" class="cls_028"><span class="cls_028">k0,R_EPC*4(AT)</span></div>
<div style="position:absolute;left:108.00px;top:720.93px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:720.93px" class="cls_028"><span class="cls_028">v0,R_V0*4(AT)</span></div>
<div style="position:absolute;left:289.78px;top:755.33px" class="cls_002"><span class="cls_002">4-10</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:52130px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">EXCEPTION MANAGEMENT</span></div>
<div style="position:absolute;left:524.95px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 4</span></div>
<div style="position:absolute;left:288.00px;top:51.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.04px;top:51.00px" class="cls_028"><span class="cls_028">AT,R_AT*4(AT)</span></div>
<div style="position:absolute;left:288.00px;top:61.00px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.02px;top:61.00px" class="cls_028"><span class="cls_028">k0</span></div>
<div style="position:absolute;left:288.00px;top:71.00px" class="cls_028"><span class="cls_028">rfe</span></div>
<div style="position:absolute;left:288.00px;top:81.00px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:81.00px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:288.00px;top:91.00px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:91.00px" class="cls_028"><span class="cls_028">at</span></div>
<div style="position:absolute;left:288.00px;top:101.00px" class="cls_028"><span class="cls_028">ENDFRAME(resume)</span></div>
<div style="position:absolute;left:252.00px;top:120.99px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:252.00px;top:130.99px" class="cls_028"><span class="cls_028">** do_call(procedure, arg1, arg2, arg3, arg4, arg5, arg6, arg7,</span></div>
<div style="position:absolute;left:252.00px;top:140.99px" class="cls_028"><span class="cls_028">arg8)</span></div>
<div style="position:absolute;left:252.00px;top:150.99px" class="cls_028"><span class="cls_028">** interface for call command to client code</span></div>
<div style="position:absolute;left:252.00px;top:160.99px" class="cls_028"><span class="cls_028">** copies arguments to new frame and sets up gp for client</span></div>
<div style="position:absolute;left:252.00px;top:170.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.00px;top:180.99px" class="cls_028"><span class="cls_028">#define CALLFRM ((8*4)+4+4)</span></div>
<div style="position:absolute;left:252.00px;top:190.99px" class="cls_028"><span class="cls_028">FRAME(do_call, sp,CALLFRM,ra)</span></div>
<div style="position:absolute;left:288.00px;top:200.99px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:324.09px;top:200.99px" class="cls_028"><span class="cls_028">sp,CALLFRM</span></div>
<div style="position:absolute;left:288.00px;top:210.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:210.99px" class="cls_028"><span class="cls_028">ra,CALLFRM-4(sp)</span></div>
<div style="position:absolute;left:288.00px;top:220.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:220.99px" class="cls_028"><span class="cls_028">gp,CALLFRM-8(sp)</span></div>
<div style="position:absolute;left:288.00px;top:230.98px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.09px;top:230.98px" class="cls_028"><span class="cls_028">v0,a0</span></div>
<div style="position:absolute;left:288.00px;top:240.98px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.09px;top:240.98px" class="cls_028"><span class="cls_028">a0,a1</span></div>
<div style="position:absolute;left:288.00px;top:250.98px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.09px;top:250.98px" class="cls_028"><span class="cls_028">a1,a2</span></div>
<div style="position:absolute;left:288.00px;top:260.98px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.09px;top:260.98px" class="cls_028"><span class="cls_028">a2,a3</span></div>
<div style="position:absolute;left:288.00px;top:270.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.04px;top:270.98px" class="cls_028"><span class="cls_028">a3,CALLFRM+(4*4)(sp)</span></div>
<div style="position:absolute;left:288.00px;top:280.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.04px;top:280.98px" class="cls_028"><span class="cls_028">v1,CALLFRM+(5*4)(sp)</span></div>
<div style="position:absolute;left:288.00px;top:290.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:290.98px" class="cls_028"><span class="cls_028">v1,4*4(sp)</span></div>
<div style="position:absolute;left:288.00px;top:300.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.04px;top:300.98px" class="cls_028"><span class="cls_028">v1,CALLFRM+(6*4)(sp)</span></div>
<div style="position:absolute;left:288.00px;top:310.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:310.98px" class="cls_028"><span class="cls_028">v1,5*4(sp)</span></div>
<div style="position:absolute;left:288.00px;top:320.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.04px;top:320.98px" class="cls_028"><span class="cls_028">v1,CALLFRM+(7*4)(sp)</span></div>
<div style="position:absolute;left:288.00px;top:330.97px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:330.97px" class="cls_028"><span class="cls_028">v1,6*4(sp)</span></div>
<div style="position:absolute;left:288.00px;top:340.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.04px;top:340.97px" class="cls_028"><span class="cls_028">v1,CALLFRM+(8*4)(sp)</span></div>
<div style="position:absolute;left:288.00px;top:350.97px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:350.97px" class="cls_028"><span class="cls_028">v1,7*4(sp)</span></div>
<div style="position:absolute;left:288.00px;top:360.97px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:324.04px;top:360.97px" class="cls_028"><span class="cls_028">t1,client_regs</span></div>
<div style="position:absolute;left:288.00px;top:370.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.04px;top:370.97px" class="cls_028"><span class="cls_028">gp,R_GP*4(t1)</span></div>
<div style="position:absolute;left:288.00px;top:380.97px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.06px;top:380.97px" class="cls_028"><span class="cls_028">v0</span></div>
<div style="position:absolute;left:288.00px;top:390.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.04px;top:390.97px" class="cls_028"><span class="cls_028">gp,CALLFRM-8(sp)</span></div>
<div style="position:absolute;left:288.00px;top:400.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.04px;top:400.97px" class="cls_028"><span class="cls_028">ra,CALLFRM-4(sp)</span></div>
<div style="position:absolute;left:288.00px;top:410.97px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:324.09px;top:410.97px" class="cls_028"><span class="cls_028">sp,CALLFRM</span></div>
<div style="position:absolute;left:288.00px;top:420.96px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.02px;top:420.96px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:288.00px;top:430.96px" class="cls_028"><span class="cls_028">ENDFRAME(do_call)</span></div>
<div style="position:absolute;left:252.00px;top:450.96px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:252.00px;top:460.96px" class="cls_028"><span class="cls_028">** clear_stat() -- clear status register</span></div>
<div style="position:absolute;left:252.00px;top:470.96px" class="cls_028"><span class="cls_028">** returns current sr</span></div>
<div style="position:absolute;left:252.00px;top:480.96px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.00px;top:490.96px" class="cls_028"><span class="cls_028">FRAME(clear_stat,sp,0,ra)</span></div>
<div style="position:absolute;left:288.00px;top:500.96px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:500.96px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:288.00px;top:510.96px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.04px;top:510.96px" class="cls_028"><span class="cls_028">v1,status_base</span></div>
<div style="position:absolute;left:288.00px;top:520.96px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.09px;top:520.96px" class="cls_028"><span class="cls_028">v0,C0_SR</span></div>
<div style="position:absolute;left:288.00px;top:530.95px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:530.95px" class="cls_028"><span class="cls_028">v1,C0_SR</span></div>
<div style="position:absolute;left:288.00px;top:540.95px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.02px;top:540.95px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:288.00px;top:550.95px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:560.95px" class="cls_028"><span class="cls_028">ENDFRAME(clear_stat)</span></div>
<div style="position:absolute;left:288.00px;top:580.95px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:580.95px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:252.00px;top:600.95px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:252.00px;top:610.95px" class="cls_028"><span class="cls_028">** setjmp(jmp_buf) -- save current context for non-local goto's</span></div>
<div style="position:absolute;left:252.00px;top:620.95px" class="cls_028"><span class="cls_028">** return 0</span></div>
<div style="position:absolute;left:252.00px;top:630.94px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.00px;top:640.94px" class="cls_028"><span class="cls_028">FRAME(setjmp,sp,0,ra)</span></div>
<div style="position:absolute;left:288.00px;top:650.94px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:650.94px" class="cls_028"><span class="cls_028">ra,JB_PC*4(a0)</span></div>
<div style="position:absolute;left:288.00px;top:660.94px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:660.94px" class="cls_028"><span class="cls_028">sp,JB_SP*4(a0)</span></div>
<div style="position:absolute;left:288.00px;top:670.94px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:670.94px" class="cls_028"><span class="cls_028">fp,JB_FP*4(a0)</span></div>
<div style="position:absolute;left:288.00px;top:680.94px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:680.94px" class="cls_028"><span class="cls_028">s0,JB_S0*4(a0)</span></div>
<div style="position:absolute;left:288.00px;top:690.94px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:690.94px" class="cls_028"><span class="cls_028">s1,JB_S1*4(a0)</span></div>
<div style="position:absolute;left:288.00px;top:700.94px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:700.94px" class="cls_028"><span class="cls_028">s2,JB_S2*4(a0)</span></div>
<div style="position:absolute;left:288.00px;top:710.94px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:710.94px" class="cls_028"><span class="cls_028">s3,JB_S3*4(a0)</span></div>
<div style="position:absolute;left:288.00px;top:720.93px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:720.93px" class="cls_028"><span class="cls_028">s4,JB_S4*4(a0)</span></div>
<div style="position:absolute;left:303.53px;top:755.33px" class="cls_002"><span class="cls_002">4-11</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:52932px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 4</span></div>
<div style="position:absolute;left:437.95px;top:28.00px" class="cls_002"><span class="cls_002">EXCEPTION MANAGEMENT</span></div>
<div style="position:absolute;left:108.00px;top:51.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.04px;top:51.00px" class="cls_028"><span class="cls_028">s5,JB_S5*4(a0)</span></div>
<div style="position:absolute;left:108.00px;top:61.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.04px;top:61.00px" class="cls_028"><span class="cls_028">s6,JB_S6*4(a0)</span></div>
<div style="position:absolute;left:108.00px;top:71.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.04px;top:71.00px" class="cls_028"><span class="cls_028">s7,JB_S7*4(a0)</span></div>
<div style="position:absolute;left:108.00px;top:81.00px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:81.00px" class="cls_028"><span class="cls_028">v0,zero</span></div>
<div style="position:absolute;left:108.00px;top:91.00px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:91.00px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:108.00px;top:101.00px" class="cls_028"><span class="cls_028">ENDFRAME(setjmp)</span></div>
<div style="position:absolute;left:72.00px;top:130.99px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:72.00px;top:140.99px" class="cls_028"><span class="cls_028">** longjmp(jmp_buf, rval)</span></div>
<div style="position:absolute;left:72.00px;top:150.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:72.00px;top:160.99px" class="cls_028"><span class="cls_028">FRAME(longjmp,sp,0,ra)</span></div>
<div style="position:absolute;left:108.00px;top:170.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.04px;top:170.99px" class="cls_028"><span class="cls_028">ra,JB_PC*4(a0)</span></div>
<div style="position:absolute;left:108.00px;top:180.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.04px;top:180.99px" class="cls_028"><span class="cls_028">sp,JB_SP*4(a0)</span></div>
<div style="position:absolute;left:108.00px;top:190.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.04px;top:190.99px" class="cls_028"><span class="cls_028">fp,JB_FP*4(a0)</span></div>
<div style="position:absolute;left:108.00px;top:200.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.04px;top:200.99px" class="cls_028"><span class="cls_028">s0,JB_S0*4(a0)</span></div>
<div style="position:absolute;left:108.00px;top:210.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.04px;top:210.99px" class="cls_028"><span class="cls_028">s1,JB_S1*4(a0)</span></div>
<div style="position:absolute;left:108.00px;top:220.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.04px;top:220.99px" class="cls_028"><span class="cls_028">s2,JB_S2*4(a0)</span></div>
<div style="position:absolute;left:108.00px;top:230.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.04px;top:230.98px" class="cls_028"><span class="cls_028">s3,JB_S3*4(a0)</span></div>
<div style="position:absolute;left:108.00px;top:240.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.04px;top:240.98px" class="cls_028"><span class="cls_028">s4,JB_S4*4(a0)</span></div>
<div style="position:absolute;left:108.00px;top:250.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.04px;top:250.98px" class="cls_028"><span class="cls_028">s5,JB_S5*4(a0)</span></div>
<div style="position:absolute;left:108.00px;top:260.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.04px;top:260.98px" class="cls_028"><span class="cls_028">s6,JB_S6*4(a0)</span></div>
<div style="position:absolute;left:108.00px;top:270.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.04px;top:270.98px" class="cls_028"><span class="cls_028">s7,JB_S7*4(a0)</span></div>
<div style="position:absolute;left:108.00px;top:280.98px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:280.98px" class="cls_028"><span class="cls_028">v0,a1</span></div>
<div style="position:absolute;left:108.00px;top:290.98px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:290.98px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:108.00px;top:300.98px" class="cls_028"><span class="cls_028">ENDFRAME(longjmp)</span></div>
<div style="position:absolute;left:72.00px;top:310.98px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:72.00px;top:320.98px" class="cls_028"><span class="cls_028">** wbflush() flush the write buffer - this is specific for each</span></div>
<div style="position:absolute;left:72.00px;top:330.97px" class="cls_028"><span class="cls_028">hardware</span></div>
<div style="position:absolute;left:72.00px;top:340.97px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:180.04px;top:340.97px" class="cls_028"><span class="cls_028">configuration.</span></div>
<div style="position:absolute;left:72.00px;top:350.97px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:72.00px;top:360.97px" class="cls_028"><span class="cls_028">FRAME(wbflush,sp,0,ra)</span></div>
<div style="position:absolute;left:108.00px;top:370.97px" class="cls_028"><span class="cls_028">.set noreorder</span></div>
<div style="position:absolute;left:108.00px;top:390.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.04px;top:390.97px" class="cls_028"><span class="cls_028">t0,wbflush#read an uncached memory location</span></div>
<div style="position:absolute;left:108.00px;top:400.97px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.04px;top:400.97px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:108.00px;top:410.97px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:108.00px;top:420.96px" class="cls_028"><span class="cls_028">.set reorder</span></div>
<div style="position:absolute;left:108.00px;top:430.96px" class="cls_028"><span class="cls_028">ENDFRAME(wbflush)</span></div>
<div style="position:absolute;left:36.00px;top:452.00px" class="cls_015"><span class="cls_015">INTERRUPTS</span></div>
<div style="position:absolute;left:48.02px;top:465.67px" class="cls_006"><span class="cls_006">The MIPS CPUs are provided with 6 individual hardware interrupt bits,</span></div>
<div style="position:absolute;left:36.00px;top:476.67px" class="cls_006"><span class="cls_006">activated by CPU input pins (in the case of the R3081, one pin is used</span></div>
<div style="position:absolute;left:36.00px;top:487.67px" class="cls_006"><span class="cls_006">internally by the FPA), and 2 additional software-settable interrupt bits. An</span></div>
<div style="position:absolute;left:36.00px;top:498.67px" class="cls_006"><span class="cls_006">active level on any pin is sensed in each cycle, and will cause an exception</span></div>
<div style="position:absolute;left:36.00px;top:509.67px" class="cls_006"><span class="cls_006">if enabled.</span></div>
<div style="position:absolute;left:48.02px;top:520.67px" class="cls_006"><span class="cls_006">The interrupt enable comes in two parts:</span></div>
<div style="position:absolute;left:48.02px;top:534.67px" class="cls_006"><span class="cls_006">• The global interrupt enable bit (IEc) in the status register - when zero</span></div>
<div style="position:absolute;left:59.97px;top:545.67px" class="cls_006"><span class="cls_006">no interrupt exception will occur. Simple, fast and comprehensive,</span></div>
<div style="position:absolute;left:59.97px;top:556.67px" class="cls_006"><span class="cls_006">this is what prevents interrupts occurring during the early and</span></div>
<div style="position:absolute;left:59.97px;top:567.67px" class="cls_006"><span class="cls_006">vulnerable stages of processing exceptions. Also, the global interrupt</span></div>
<div style="position:absolute;left:59.97px;top:578.67px" class="cls_006"><span class="cls_006">enable is usually switched back on by an </span><span class="cls_008">rfe</span><span class="cls_006"> instruction at the end of</span></div>
<div style="position:absolute;left:59.98px;top:589.67px" class="cls_006"><span class="cls_006">an exception routine; this means that the interrupt cannot take effect</span></div>
<div style="position:absolute;left:59.98px;top:600.67px" class="cls_006"><span class="cls_006">until the CPU has returned from the exception and finished with the</span></div>
<div style="position:absolute;left:59.98px;top:611.67px" class="cls_008"><span class="cls_008">EPC</span><span class="cls_006"> register, avoiding undesirable recursion in the interrupt routine.</span></div>
<div style="position:absolute;left:48.03px;top:625.67px" class="cls_006"><span class="cls_006">• The individual interrupt mask bits IM in the status register, one for</span></div>
<div style="position:absolute;left:59.98px;top:636.67px" class="cls_006"><span class="cls_006">each interrupt. Set the bit 1 to enable the corresponding interrupt.</span></div>
<div style="position:absolute;left:59.98px;top:647.67px" class="cls_006"><span class="cls_006">These are manipulated by software to allow whichever interrupts are</span></div>
<div style="position:absolute;left:59.98px;top:658.67px" class="cls_006"><span class="cls_006">appropriate to the system.</span></div>
<div style="position:absolute;left:289.79px;top:755.33px" class="cls_002"><span class="cls_002">4-12</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:53734px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">EXCEPTION MANAGEMENT</span></div>
<div style="position:absolute;left:524.95px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 4</span></div>
<div style="position:absolute;left:239.98px;top:50.67px" class="cls_006"><span class="cls_006">Changes to the individual bits are usually made “under cover”, with</span></div>
<div style="position:absolute;left:239.98px;top:61.67px" class="cls_006"><span class="cls_006">the global interrupt enable off.</span></div>
<div style="position:absolute;left:300.81px;top:83.00px" class="cls_020"><span class="cls_020">What are the software interrupt bits for?</span></div>
<div style="position:absolute;left:235.86px;top:100.00px" class="cls_020"><span class="cls_020">One commonly asked question is: “Why does the CPU provide two bits in</span></div>
<div style="position:absolute;left:235.86px;top:110.00px" class="cls_020"><span class="cls_020">the </span><span class="cls_027">Cause</span><span class="cls_020"> register which, when set, immediately cause an interrupt</span></div>
<div style="position:absolute;left:235.86px;top:120.00px" class="cls_020"><span class="cls_020">unless masked?”</span></div>
<div style="position:absolute;left:235.86px;top:135.00px" class="cls_020"><span class="cls_020">The clue is in ‘‘unless masked’’. Typically this is used as a mechanism for</span></div>
<div style="position:absolute;left:235.86px;top:145.00px" class="cls_020"><span class="cls_020">high-priority interrupt routines to flag actions which will be performed by</span></div>
<div style="position:absolute;left:235.86px;top:155.00px" class="cls_020"><span class="cls_020">lower-priority interrupt routines, once the system has dealt with all high</span></div>
<div style="position:absolute;left:235.86px;top:165.00px" class="cls_020"><span class="cls_020">priority business. As the high-priority processing completes, the software</span></div>
<div style="position:absolute;left:235.86px;top:175.00px" class="cls_020"><span class="cls_020">will open up the interrupt mask, and the pending software interrupt will</span></div>
<div style="position:absolute;left:235.86px;top:185.00px" class="cls_020"><span class="cls_020">occur.</span></div>
<div style="position:absolute;left:235.86px;top:200.00px" class="cls_020"><span class="cls_020">There is no definitive reason why the same effect should not be simulated</span></div>
<div style="position:absolute;left:235.86px;top:210.00px" class="cls_020"><span class="cls_020">by system software (using flags in memory, for example) but the soft</span></div>
<div style="position:absolute;left:235.86px;top:220.00px" class="cls_020"><span class="cls_020">interrupt bits are convenient because they fit in with the already</span></div>
<div style="position:absolute;left:235.86px;top:230.00px" class="cls_020"><span class="cls_020">provided interrupt handling mechanism.</span></div>
<div style="position:absolute;left:227.62px;top:254.00px" class="cls_020"><span class="cls_020">Pin</span></div>
<div style="position:absolute;left:261.75px;top:254.00px" class="cls_020"><span class="cls_020">SR/Cause</span></div>
<div style="position:absolute;left:432.30px;top:254.00px" class="cls_020"><span class="cls_020">Notes</span></div>
<div style="position:absolute;left:270.91px;top:264.00px" class="cls_020"><span class="cls_020">bit no</span></div>
<div style="position:absolute;left:260.09px;top:283.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:317.19px;top:283.00px" class="cls_020"><span class="cls_020">software interrupt</span></div>
<div style="position:absolute;left:260.09px;top:303.00px" class="cls_020"><span class="cls_020">9</span></div>
<div style="position:absolute;left:317.19px;top:303.00px" class="cls_020"><span class="cls_020">software interrupt</span></div>
<div style="position:absolute;left:218.37px;top:322.99px" class="cls_020"><span class="cls_020">Int0*</span></div>
<div style="position:absolute;left:260.19px;top:322.99px" class="cls_020"><span class="cls_020">10</span></div>
<div style="position:absolute;left:317.32px;top:322.99px" class="cls_020"><span class="cls_020">Cause bit reads 1 when pin low (active)</span></div>
<div style="position:absolute;left:218.37px;top:339.99px" class="cls_020"><span class="cls_020">Int1*</span></div>
<div style="position:absolute;left:260.19px;top:339.99px" class="cls_020"><span class="cls_020">11</span></div>
<div style="position:absolute;left:218.37px;top:359.99px" class="cls_020"><span class="cls_020">Int2*</span></div>
<div style="position:absolute;left:260.19px;top:359.99px" class="cls_020"><span class="cls_020">12</span></div>
<div style="position:absolute;left:218.37px;top:379.99px" class="cls_020"><span class="cls_020">Int3*</span></div>
<div style="position:absolute;left:260.19px;top:379.99px" class="cls_020"><span class="cls_020">13</span></div>
<div style="position:absolute;left:317.32px;top:379.99px" class="cls_020"><span class="cls_020">Usual choice for FPA. The pin corresponding to the</span></div>
<div style="position:absolute;left:317.16px;top:389.99px" class="cls_020"><span class="cls_020">interrupt selected for FPA interrupts on an R3081 is</span></div>
<div style="position:absolute;left:317.16px;top:399.99px" class="cls_020"><span class="cls_020">effectively a no-connect.</span></div>
<div style="position:absolute;left:218.37px;top:416.99px" class="cls_020"><span class="cls_020">Int4*</span></div>
<div style="position:absolute;left:260.19px;top:416.99px" class="cls_020"><span class="cls_020">14</span></div>
<div style="position:absolute;left:218.37px;top:436.99px" class="cls_020"><span class="cls_020">Int5*</span></div>
<div style="position:absolute;left:260.19px;top:436.99px" class="cls_020"><span class="cls_020">15</span></div>
<div style="position:absolute;left:283.70px;top:458.98px" class="cls_020"><span class="cls_020">Table 4.2.  Interrupt bitfields and interrupt pins</span></div>
<div style="position:absolute;left:228.03px;top:474.67px" class="cls_006"><span class="cls_006">Interrupt processing proper begins after an exception is received and the</span></div>
<div style="position:absolute;left:216.01px;top:485.67px" class="cls_006"><span class="cls_006">Type field in </span><span class="cls_008">Cause</span><span class="cls_006"> signals that it was caused by an interrupt. Table 4.2,</span></div>
<div style="position:absolute;left:216.01px;top:496.67px" class="cls_006"><span class="cls_006">“Interrupt bitfields and interrupt pins” describes the relationship between</span></div>
<div style="position:absolute;left:216.01px;top:507.67px" class="cls_008"><span class="cls_008">Cause</span><span class="cls_006"> bits and input pins.</span></div>
<div style="position:absolute;left:228.03px;top:518.67px" class="cls_006"><span class="cls_006">Once the interrupt exception is “recognized” by the CPU, the stages are:</span></div>
<div style="position:absolute;left:228.03px;top:532.67px" class="cls_006"><span class="cls_006">• Consult the </span><span class="cls_008">Cause</span><span class="cls_006"> register IP field, logically-‘‘and’’ it with the current</span></div>
<div style="position:absolute;left:239.98px;top:543.67px" class="cls_006"><span class="cls_006">interrupt masks in the </span><span class="cls_008">SR</span><span class="cls_006"> IM field to obtain a bit-map of active,</span></div>
<div style="position:absolute;left:239.98px;top:554.67px" class="cls_006"><span class="cls_006">enabled interrupt requests. There may be more than one, and any of</span></div>
<div style="position:absolute;left:239.98px;top:565.67px" class="cls_006"><span class="cls_006">them would have caused the interrupt.</span></div>
<div style="position:absolute;left:228.03px;top:579.67px" class="cls_006"><span class="cls_006">• Select one active, enabled interrupt for attention. The selection can be</span></div>
<div style="position:absolute;left:239.98px;top:590.67px" class="cls_006"><span class="cls_006">done simply by using fixed priorities; however, software is free to</span></div>
<div style="position:absolute;left:239.98px;top:601.67px" class="cls_006"><span class="cls_006">implement  whatever  priority  mechanism  is  appropriate  for  the</span></div>
<div style="position:absolute;left:239.98px;top:612.67px" class="cls_006"><span class="cls_006">system.</span></div>
<div style="position:absolute;left:228.03px;top:626.67px" class="cls_006"><span class="cls_006">• Software needs to save the old interrupt mask bits of the SR register,</span></div>
<div style="position:absolute;left:239.98px;top:637.67px" class="cls_006"><span class="cls_006">but it is quite likely that the whole </span><span class="cls_008">SR</span><span class="cls_006"> register was saved in the main</span></div>
<div style="position:absolute;left:239.98px;top:648.67px" class="cls_006"><span class="cls_006">exception routine.</span></div>
<div style="position:absolute;left:228.03px;top:662.67px" class="cls_006"><span class="cls_006">• Change IM in </span><span class="cls_008">SR</span><span class="cls_006"> to ensure that the current interrupt and all</span></div>
<div style="position:absolute;left:239.98px;top:673.67px" class="cls_006"><span class="cls_006">interrupts of equal or lesser priority are inhibited.</span></div>
<div style="position:absolute;left:228.03px;top:687.67px" class="cls_006"><span class="cls_006">• If not already performed by the main exception routine, save the state</span></div>
<div style="position:absolute;left:239.98px;top:698.67px" class="cls_006"><span class="cls_006">required for nested exception processing.</span></div>
<div style="position:absolute;left:228.03px;top:712.67px" class="cls_006"><span class="cls_006">• Set the global interrupt enable bit IEc in </span><span class="cls_008">SR</span><span class="cls_006"> to allow higher-priority</span></div>
<div style="position:absolute;left:239.98px;top:723.67px" class="cls_006"><span class="cls_006">interrupts to be processed.</span></div>
<div style="position:absolute;left:303.53px;top:755.34px" class="cls_002"><span class="cls_002">4-13</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:54536px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 4</span></div>
<div style="position:absolute;left:437.95px;top:28.00px" class="cls_002"><span class="cls_002">EXCEPTION MANAGEMENT</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">• Call the particular interrupt service routine for the selected, current</span></div>
<div style="position:absolute;left:59.97px;top:61.67px" class="cls_006"><span class="cls_006">interrupt.</span></div>
<div style="position:absolute;left:48.02px;top:75.67px" class="cls_006"><span class="cls_006">• On return, disable interrupts again by clearing IEc in </span><span class="cls_008">SR,</span><span class="cls_006"> before</span></div>
<div style="position:absolute;left:59.98px;top:86.67px" class="cls_006"><span class="cls_006">returning to the normal exception stream.</span></div>
<div style="position:absolute;left:36.00px;top:109.00px" class="cls_015"><span class="cls_015">Conventions and Examples</span></div>
<div style="position:absolute;left:48.02px;top:122.67px" class="cls_006"><span class="cls_006">The following is as simple as an exception routine can be. It does nothing</span></div>
<div style="position:absolute;left:36.00px;top:133.67px" class="cls_006"><span class="cls_006">except increment a counter on each exception:</span></div>
<div style="position:absolute;left:108.00px;top:155.00px" class="cls_028"><span class="cls_028">.set noreorder</span></div>
<div style="position:absolute;left:108.00px;top:165.00px" class="cls_028"><span class="cls_028">.set noat</span></div>
<div style="position:absolute;left:72.00px;top:175.00px" class="cls_028"><span class="cls_028">xcptgen:</span></div>
<div style="position:absolute;left:108.00px;top:185.00px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:144.05px;top:185.00px" class="cls_028"><span class="cls_028">k0,xcptcount# get address of counter</span></div>
<div style="position:absolute;left:108.00px;top:195.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:195.00px" class="cls_028"><span class="cls_028">k1,0(k0)# load counter</span></div>
<div style="position:absolute;left:108.00px;top:204.99px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:216.07px;top:204.99px" class="cls_028"><span class="cls_028"># (load delay)</span></div>
<div style="position:absolute;left:108.00px;top:214.99px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:144.09px;top:214.99px" class="cls_028"><span class="cls_028">k1,1</span></div>
<div style="position:absolute;left:216.19px;top:214.99px" class="cls_028"><span class="cls_028"># increment counter</span></div>
<div style="position:absolute;left:108.00px;top:224.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:224.99px" class="cls_028"><span class="cls_028">k1,0(k0)# store counter</span></div>
<div style="position:absolute;left:108.00px;top:234.99px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:144.09px;top:234.99px" class="cls_028"><span class="cls_028">k0,C0_EPC# get EPC</span></div>
<div style="position:absolute;left:108.00px;top:244.99px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:216.07px;top:244.99px" class="cls_028"><span class="cls_028"># (load delay, mfc0 slow)</span></div>
<div style="position:absolute;left:108.00px;top:254.99px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:254.99px" class="cls_028"><span class="cls_028">k0</span></div>
<div style="position:absolute;left:216.07px;top:254.99px" class="cls_028"><span class="cls_028"># return to program</span></div>
<div style="position:absolute;left:108.00px;top:264.99px" class="cls_028"><span class="cls_028">rfe</span></div>
<div style="position:absolute;left:216.07px;top:264.99px" class="cls_028"><span class="cls_028"># branch delay slot</span></div>
<div style="position:absolute;left:108.00px;top:274.99px" class="cls_028"><span class="cls_028">.set at</span></div>
<div style="position:absolute;left:108.00px;top:284.99px" class="cls_028"><span class="cls_028">.set reorder</span></div>
<div style="position:absolute;left:48.02px;top:304.67px" class="cls_006"><span class="cls_006">Note that this routine cannot survive a nested exception (the original</span></div>
<div style="position:absolute;left:36.00px;top:315.67px" class="cls_006"><span class="cls_006">return address in </span><span class="cls_008">EPC</span><span class="cls_006"> would be lost, for example). It doesn’t re-enable</span></div>
<div style="position:absolute;left:36.01px;top:326.67px" class="cls_006"><span class="cls_006">interrupts; but note that the counter </span><span class="cls_008">xcptcount</span><span class="cls_006"> should be at an address</span></div>
<div style="position:absolute;left:36.02px;top:337.67px" class="cls_006"><span class="cls_006">which can’t possibly suffer a TLB miss.</span></div>
<div style="position:absolute;left:289.78px;top:755.34px" class="cls_002"><span class="cls_002">4-14</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:55338px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">CACHE MANAGEMENT</span></div>
<div style="position:absolute;left:459.00px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 5</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:216.00px;top:113.00px" class="cls_015"><span class="cls_015">CACHES AND CACHE MANAGEMENT</span></div>
<div style="position:absolute;left:228.02px;top:126.67px" class="cls_006"><span class="cls_006">R30xx family CPUs implement separate on-chip caches for instructions</span></div>
<div style="position:absolute;left:216.00px;top:137.67px" class="cls_006"><span class="cls_006">(I-cache)  and  data</span></div>
<div style="position:absolute;left:323.70px;top:137.67px" class="cls_006"><span class="cls_006">(D-cache).  Following  RISC  principles,  hardware</span></div>
<div style="position:absolute;left:216.00px;top:148.67px" class="cls_006"><span class="cls_006">functions are provided only for normal operation of the caches; software</span></div>
<div style="position:absolute;left:216.00px;top:159.67px" class="cls_006"><span class="cls_006">routines must be provided to initialize the cache following system start-up,</span></div>
<div style="position:absolute;left:216.00px;top:170.67px" class="cls_006"><span class="cls_006">and to invalidate cache data when required†.</span></div>
<div style="position:absolute;left:374.42px;top:203.51px" class="cls_031"><span class="cls_031">Cache Memory</span></div>
<div style="position:absolute;left:242.25px;top:216.71px" class="cls_032"><span class="cls_032">memory address</span></div>
<div style="position:absolute;left:390.49px;top:216.71px" class="cls_032"><span class="cls_032">tagstore</span></div>
<div style="position:absolute;left:466.79px;top:216.71px" class="cls_032"><span class="cls_032">cache data store</span></div>
<div style="position:absolute;left:237.74px;top:236.53px" class="cls_032"><span class="cls_032">higher bits</span></div>
<div style="position:absolute;left:298.78px;top:236.53px" class="cls_032"><span class="cls_032">lo bits</span></div>
<div style="position:absolute;left:373.54px;top:237.41px" class="cls_033"><span class="cls_033">0</span></div>
<div style="position:absolute;left:351.85px;top:282.77px" class="cls_032"><span class="cls_032">index</span></div>
<div style="position:absolute;left:297.24px;top:370.85px" class="cls_031"><span class="cls_031">match?</span></div>
<div style="position:absolute;left:306.49px;top:441.32px" class="cls_032"><span class="cls_032">hit?</span></div>
<div style="position:absolute;left:394.02px;top:440.22px" class="cls_032"><span class="cls_032">data</span></div>
<div style="position:absolute;left:316.95px;top:462.57px" class="cls_020"><span class="cls_020">Figure 5.1.   Direct mapped cache</span></div>
<div style="position:absolute;left:228.02px;top:473.23px" class="cls_006"><span class="cls_006">The cache’s job is to hold a copy of memory data which has been recently</span></div>
<div style="position:absolute;left:216.00px;top:484.23px" class="cls_006"><span class="cls_006">read or written, so it can be returned quickly to the CPU; in the R30xx</span></div>
<div style="position:absolute;left:216.00px;top:495.23px" class="cls_006"><span class="cls_006">architecture data accesses in the cache take just one clock, and an I-cache</span></div>
<div style="position:absolute;left:216.00px;top:506.23px" class="cls_006"><span class="cls_006">and a D-cache operation can occur together.</span></div>
<div style="position:absolute;left:228.02px;top:517.23px" class="cls_006"><span class="cls_006">When a cacheable location is read (a data load):</span></div>
<div style="position:absolute;left:228.02px;top:531.23px" class="cls_006"><span class="cls_006">• It will be returned from the D-cache if the cache contains the</span></div>
<div style="position:absolute;left:239.97px;top:542.23px" class="cls_006"><span class="cls_006">corresponding physical address and the cache line is valid there</span></div>
<div style="position:absolute;left:239.97px;top:553.23px" class="cls_006"><span class="cls_006">(called a cache ‘‘hit’’). In this case nothing happens at the CPUs</span></div>
<div style="position:absolute;left:239.97px;top:564.23px" class="cls_006"><span class="cls_006">memory interface, so the read is invisible to the outside world.</span></div>
<div style="position:absolute;left:228.02px;top:578.23px" class="cls_006"><span class="cls_006">• If the data is not found in the D-cache (called a cache “miss”), the data</span></div>
<div style="position:absolute;left:239.97px;top:589.23px" class="cls_006"><span class="cls_006">will be read from external memory. According to the CPU type and</span></div>
<div style="position:absolute;left:239.97px;top:600.23px" class="cls_006"><span class="cls_006">how it is set up, it may read one or more words from memory. The</span></div>
<div style="position:absolute;left:239.97px;top:611.23px" class="cls_006"><span class="cls_006">data is loaded into the cache, and normal operation then resumes.</span></div>
<div style="position:absolute;left:239.97px;top:625.23px" class="cls_006"><span class="cls_006">In normal operation, cache miss processing will cause the targeted</span></div>
<div style="position:absolute;left:239.97px;top:636.23px" class="cls_006"><span class="cls_006">cache line to “invalidate” the valid data already present in the cache.</span></div>
<div style="position:absolute;left:239.97px;top:647.23px" class="cls_006"><span class="cls_006">In the R30xx caches, cache data is never more up-to-date than</span></div>
<div style="position:absolute;left:239.97px;top:658.23px" class="cls_006"><span class="cls_006">memory (because the cache is </span><span class="cls_008">write-through</span><span class="cls_006">, described below), so the</span></div>
<div style="position:absolute;left:239.98px;top:669.23px" class="cls_006"><span class="cls_006">previously cached data can be discarded without any trouble.</span></div>
<div style="position:absolute;left:234.00px;top:710.67px" class="cls_006"><span class="cls_006">† Note that the R3071 and R3081 do implement a DMA protocol</span></div>
<div style="position:absolute;left:234.00px;top:722.67px" class="cls_006"><span class="cls_006">that allows automatic, hardware-based data cache invalidation.</span></div>
<div style="position:absolute;left:299.28px;top:754.68px" class="cls_002"><span class="cls_002">5-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:56140px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 5</span></div>
<div style="position:absolute;left:458.88px;top:28.00px" class="cls_002"><span class="cls_002">CACHE MANAGEMENT</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">When data is loaded from an uncacheable location, it is always obtained</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_006"><span class="cls_006">from external memory (or a memory-mapped IO location). Most systems</span></div>
<div style="position:absolute;left:36.00px;top:72.67px" class="cls_006"><span class="cls_006">never access the same data locations as cached and uncached; however,</span></div>
<div style="position:absolute;left:36.00px;top:83.67px" class="cls_006"><span class="cls_006">the results of such a system would be predictable. On an uncacheable load</span></div>
<div style="position:absolute;left:36.00px;top:94.67px" class="cls_006"><span class="cls_006">cache data is neither used nor updated.</span></div>
<div style="position:absolute;left:48.02px;top:105.67px" class="cls_006"><span class="cls_006">When software writes a cached location:</span></div>
<div style="position:absolute;left:48.02px;top:119.67px" class="cls_006"><span class="cls_006">• If the CPU is doing a 32-bit store, the cache is always updated</span></div>
<div style="position:absolute;left:59.97px;top:130.67px" class="cls_006"><span class="cls_006">(possibly discarding data from a previously cached location).</span></div>
<div style="position:absolute;left:48.02px;top:144.67px" class="cls_006"><span class="cls_006">• For byte or half-word stores, the cache will only be updated if the</span></div>
<div style="position:absolute;left:59.97px;top:155.67px" class="cls_006"><span class="cls_006">reference hits in the cache; then data will be extracted from the cache,</span></div>
<div style="position:absolute;left:59.97px;top:166.67px" class="cls_006"><span class="cls_006">merged with the store data, and written back†.</span></div>
<div style="position:absolute;left:48.02px;top:180.67px" class="cls_006"><span class="cls_006">• If the partial-word store misses in the cache, then the cache is left</span></div>
<div style="position:absolute;left:59.97px;top:191.67px" class="cls_006"><span class="cls_006">alone.</span></div>
<div style="position:absolute;left:48.02px;top:205.67px" class="cls_006"><span class="cls_006">• In all cases, the write is also made to main memory.</span></div>
<div style="position:absolute;left:48.02px;top:216.67px" class="cls_006"><span class="cls_006">When the store target is an uncached location the cache is not consulted</span></div>
<div style="position:absolute;left:36.00px;top:227.67px" class="cls_006"><span class="cls_006">or modified.</span></div>
<div style="position:absolute;left:48.02px;top:238.67px" class="cls_006"><span class="cls_006">Figure 5.1, “Direct mapped cache” is a diagrammatic representation of</span></div>
<div style="position:absolute;left:36.00px;top:249.67px" class="cls_006"><span class="cls_006">the way the MIPS cache works. Both caches are:</span></div>
<div style="position:absolute;left:48.02px;top:263.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:263.67px" class="cls_008"><span class="cls_008">Physically indexed, physically tagged</span><span class="cls_006">: the CPUs program address</span></div>
<div style="position:absolute;left:59.97px;top:274.67px" class="cls_006"><span class="cls_006">(virtual address) is translated to a physical address, just as is used to</span></div>
<div style="position:absolute;left:59.97px;top:285.67px" class="cls_006"><span class="cls_006">address real memory, before being used for the cache lookup. The</span></div>
<div style="position:absolute;left:59.97px;top:296.67px" class="cls_006"><span class="cls_006">TAG comparison (checking for a hit) is also based on physical</span></div>
<div style="position:absolute;left:59.97px;top:307.67px" class="cls_006"><span class="cls_006">addresses.</span></div>
<div style="position:absolute;left:59.97px;top:321.67px" class="cls_006"><span class="cls_006">On certain other CPU families the cache index is based on program</span></div>
<div style="position:absolute;left:59.97px;top:332.67px" class="cls_006"><span class="cls_006">addresses (which are available a bit earlier); some CPUs even use</span></div>
<div style="position:absolute;left:59.97px;top:343.67px" class="cls_006"><span class="cls_006">virtual TAGs, which then require that the cache be flushed at context</span></div>
<div style="position:absolute;left:59.97px;top:354.67px" class="cls_006"><span class="cls_006">switch. But physical caches are easier to manage.</span></div>
<div style="position:absolute;left:48.03px;top:368.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:368.67px" class="cls_008"><span class="cls_008">Direct mapped</span><span class="cls_006">: Each physical address has only one location in each</span></div>
<div style="position:absolute;left:59.98px;top:379.67px" class="cls_006"><span class="cls_006">cache where it may reside. At each cache index there is only one data</span></div>
<div style="position:absolute;left:59.98px;top:390.67px" class="cls_006"><span class="cls_006">item stored - this will be just one word in the D-cache but is usually</span></div>
<div style="position:absolute;left:59.98px;top:401.67px" class="cls_006"><span class="cls_006">a 4-word </span><span class="cls_008">line</span><span class="cls_006"> for the I-cache (see Figure 5.1, “Direct mapped cache”).</span></div>
<div style="position:absolute;left:59.98px;top:412.67px" class="cls_006"><span class="cls_006">Next to the data is kept the </span><span class="cls_008">tag</span><span class="cls_006">, which stores the memory address for</span></div>
<div style="position:absolute;left:59.98px;top:423.67px" class="cls_006"><span class="cls_006">which this data is a copy.</span></div>
<div style="position:absolute;left:59.98px;top:437.67px" class="cls_006"><span class="cls_006">If the tag matches the high-order (higher number) address bits then</span></div>
<div style="position:absolute;left:59.98px;top:448.67px" class="cls_006"><span class="cls_006">the cache line contains the data the CPU is looking for; the data is</span></div>
<div style="position:absolute;left:59.98px;top:459.67px" class="cls_006"><span class="cls_006">returned and execution continues.</span></div>
<div style="position:absolute;left:59.98px;top:473.67px" class="cls_006"><span class="cls_006">For an I-cache access, the CPU must select one of the four words</span></div>
<div style="position:absolute;left:59.98px;top:484.67px" class="cls_006"><span class="cls_006">based on the lowest address bits.</span></div>
<div style="position:absolute;left:59.98px;top:498.67px" class="cls_006"><span class="cls_006">This is a </span><span class="cls_008">direct mapped</span><span class="cls_006"> cache because there is only one tag/data pair</span></div>
<div style="position:absolute;left:59.97px;top:509.67px" class="cls_006"><span class="cls_006">at each cache index. More complex caches may have more than one</span></div>
<div style="position:absolute;left:59.97px;top:520.67px" class="cls_006"><span class="cls_006">tag  field,  and  compare  them  simultaneously  with  the  physical</span></div>
<div style="position:absolute;left:59.97px;top:531.67px" class="cls_006"><span class="cls_006">address.</span></div>
<div style="position:absolute;left:59.97px;top:545.67px" class="cls_006"><span class="cls_006">A direct-mapped cache is very simple, but can suffer from cache</span></div>
<div style="position:absolute;left:59.97px;top:556.67px" class="cls_006"><span class="cls_006">thrashing; so the CPU can run slowly if a program loop is regularly</span></div>
<div style="position:absolute;left:59.97px;top:567.67px" class="cls_006"><span class="cls_006">accessing a pair of locations whose low-order addresses happen to be</span></div>
<div style="position:absolute;left:59.97px;top:578.67px" class="cls_006"><span class="cls_006">equal. To avoid this situation, the R30xx family implements relatively</span></div>
<div style="position:absolute;left:59.97px;top:589.67px" class="cls_006"><span class="cls_006">large caches, which minimize the probability of reasonable program</span></div>
<div style="position:absolute;left:59.97px;top:600.67px" class="cls_006"><span class="cls_006">loops causing CPU thrashing.</span></div>
<div style="position:absolute;left:48.02px;top:614.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:614.67px" class="cls_008"><span class="cls_008">Cache lines</span><span class="cls_006">: the line size is the number of data elements stored with</span></div>
<div style="position:absolute;left:59.97px;top:625.67px" class="cls_006"><span class="cls_006">each tag. For R30xx family CPUs the I-cache implements a 4-word</span></div>
<div style="position:absolute;left:59.97px;top:636.67px" class="cls_006"><span class="cls_006">line size; the D-cache always has 1-word lines.</span></div>
<div style="position:absolute;left:54.00px;top:686.67px" class="cls_006"><span class="cls_006">† In the R30xx family, the data will be merged in the D-Cache.</span></div>
<div style="position:absolute;left:54.00px;top:698.67px" class="cls_006"><span class="cls_006">However, the CPU bus will perform the store only to the bytes</span></div>
<div style="position:absolute;left:54.00px;top:710.67px" class="cls_006"><span class="cls_006">which were actually changed (i.e. the store datum size), facilitating</span></div>
<div style="position:absolute;left:54.00px;top:722.67px" class="cls_006"><span class="cls_006">debugging.</span></div>
<div style="position:absolute;left:292.03px;top:755.33px" class="cls_002"><span class="cls_002">5-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:56942px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">CACHE MANAGEMENT</span></div>
<div style="position:absolute;left:524.86px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 5</span></div>
<div style="position:absolute;left:239.98px;top:50.67px" class="cls_006"><span class="cls_006">When a cache miss occurs the whole line must be filled from memory.</span></div>
<div style="position:absolute;left:239.98px;top:61.67px" class="cls_006"><span class="cls_006">But it is quite possible to fetch more than a line’s worth of data; and</span></div>
<div style="position:absolute;left:239.98px;top:72.67px" class="cls_006"><span class="cls_006">R30xx family CPUs can be configured to fetch 4 words of data on a D-</span></div>
<div style="position:absolute;left:239.98px;top:83.67px" class="cls_006"><span class="cls_006">cache miss, refilling 4 1-word ‘‘lines’’.</span></div>
<div style="position:absolute;left:228.03px;top:97.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Write through</span><span class="cls_006">: the D-cache is write-through, meaning that all store</span></div>
<div style="position:absolute;left:239.97px;top:108.67px" class="cls_006"><span class="cls_006">operations result in a store to main memory. This means that all data</span></div>
<div style="position:absolute;left:239.97px;top:119.67px" class="cls_006"><span class="cls_006">in the cache is duplicated in main memory, and can therefore be</span></div>
<div style="position:absolute;left:239.97px;top:130.67px" class="cls_006"><span class="cls_006">discarded at any time. In particular, when data is being read following</span></div>
<div style="position:absolute;left:239.97px;top:141.67px" class="cls_006"><span class="cls_006">a cache miss it can always be stored in the cache without regard for</span></div>
<div style="position:absolute;left:239.97px;top:152.67px" class="cls_006"><span class="cls_006">the data which was previously stored at the same index.</span></div>
<div style="position:absolute;left:228.02px;top:166.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Partial word write implementations</span><span class="cls_006">: when the CPU writes only part of</span></div>
<div style="position:absolute;left:239.98px;top:177.67px" class="cls_006"><span class="cls_006">a word, it is essential that any valid cache data should still end up as</span></div>
<div style="position:absolute;left:239.98px;top:188.67px" class="cls_006"><span class="cls_006">a duplicate of main memory. One simple approach is to invalidate the</span></div>
<div style="position:absolute;left:239.98px;top:199.67px" class="cls_006"><span class="cls_006">cache line and to write only to main memory (the main memory must</span></div>
<div style="position:absolute;left:239.98px;top:210.67px" class="cls_006"><span class="cls_006">be byte-addressable). But the R30xx family uses a more efficient</span></div>
<div style="position:absolute;left:239.98px;top:221.67px" class="cls_006"><span class="cls_006">strategy:</span></div>
<div style="position:absolute;left:228.03px;top:235.67px" class="cls_006"><span class="cls_006">a)</span></div>
<div style="position:absolute;left:264.03px;top:235.67px" class="cls_006"><span class="cls_006">if the location being written is present in the cache (cache hit) the</span></div>
<div style="position:absolute;left:264.03px;top:246.67px" class="cls_006"><span class="cls_006">cache data is read into the CPU, the partial-word data merged</span></div>
<div style="position:absolute;left:264.03px;top:257.67px" class="cls_006"><span class="cls_006">with it, the whole word written back to the cache, and the</span></div>
<div style="position:absolute;left:264.03px;top:268.67px" class="cls_006"><span class="cls_006">partial-word written to memory.</span></div>
<div style="position:absolute;left:228.03px;top:282.67px" class="cls_006"><span class="cls_006">b)</span></div>
<div style="position:absolute;left:264.03px;top:282.67px" class="cls_006"><span class="cls_006">where the write misses in the cache the partial-word write is</span></div>
<div style="position:absolute;left:264.03px;top:293.67px" class="cls_006"><span class="cls_006">performed to memory only, and the cache left alone.</span></div>
<div style="position:absolute;left:239.98px;top:307.67px" class="cls_006"><span class="cls_006">Note that this takes an extra clock, so a partial-word write which hits</span></div>
<div style="position:absolute;left:239.98px;top:318.67px" class="cls_006"><span class="cls_006">in the cache is slower than a whole-word write.</span></div>
<div style="position:absolute;left:216.00px;top:341.00px" class="cls_015"><span class="cls_015">Cache isolation and swapping</span></div>
<div style="position:absolute;left:228.02px;top:354.67px" class="cls_006"><span class="cls_006">No special instructions are provided to explicitly access the caches;</span></div>
<div style="position:absolute;left:216.00px;top:365.67px" class="cls_006"><span class="cls_006">everything has to be done with load and store instructions.</span></div>
<div style="position:absolute;left:228.02px;top:376.67px" class="cls_006"><span class="cls_006">To distinguish operations for cache management from regular memory</span></div>
<div style="position:absolute;left:216.00px;top:387.67px" class="cls_006"><span class="cls_006">references, without having to dedicate a special address region for this</span></div>
<div style="position:absolute;left:216.00px;top:398.67px" class="cls_006"><span class="cls_006">purpose, the R30xx architecture provides bits in the </span><span class="cls_008">SR</span><span class="cls_006"> to support cache</span></div>
<div style="position:absolute;left:216.00px;top:409.67px" class="cls_006"><span class="cls_006">management:</span></div>
<div style="position:absolute;left:228.02px;top:423.67px" class="cls_006"><span class="cls_006">• The </span><span class="cls_008">SR</span><span class="cls_006"> mode bit “IsC” will </span><span class="cls_008">isolate</span><span class="cls_006"> the D-cache; in this mode loads and</span></div>
<div style="position:absolute;left:239.98px;top:434.67px" class="cls_006"><span class="cls_006">stores affect only the cache, and loads also ‘‘hit’’ regardless of whether</span></div>
<div style="position:absolute;left:239.98px;top:445.67px" class="cls_006"><span class="cls_006">the tag matches. As a special mechanism, with the D-cache isolated</span></div>
<div style="position:absolute;left:239.98px;top:456.67px" class="cls_006"><span class="cls_006">a partial-word write will invalidate the appropriate cache line.</span></div>
<div style="position:absolute;left:239.98px;top:470.67px" class="cls_006"><span class="cls_006">Caution: when the D-cache is isolated, not even loads/stores marked</span></div>
<div style="position:absolute;left:239.98px;top:481.67px" class="cls_006"><span class="cls_006">by their address or TLB entry as ‘‘uncached’’ will operate normally.</span></div>
<div style="position:absolute;left:239.98px;top:492.67px" class="cls_006"><span class="cls_006">One consequence of this is that the cache management routines must</span></div>
<div style="position:absolute;left:239.98px;top:503.67px" class="cls_006"><span class="cls_006">not make any data accesses; they are typically written in assembler,</span></div>
<div style="position:absolute;left:239.98px;top:514.67px" class="cls_006"><span class="cls_006">using only register variables.</span></div>
<div style="position:absolute;left:228.03px;top:528.67px" class="cls_006"><span class="cls_006">• The CPU provides a mode where the caches are </span><span class="cls_008">swapped</span><span class="cls_006"> (SR SwC</span></div>
<div style="position:absolute;left:239.98px;top:539.67px" class="cls_006"><span class="cls_006">bit), to allow the I-Cache to be targeted by store instructions; then the</span></div>
<div style="position:absolute;left:239.98px;top:550.67px" class="cls_006"><span class="cls_006">D-cache acts as an I-cache, and the I-cache acts as the D-cache. Once</span></div>
<div style="position:absolute;left:239.98px;top:561.67px" class="cls_006"><span class="cls_006">the caches are swapped and isolated I-cache entries may be read,</span></div>
<div style="position:absolute;left:239.98px;top:572.67px" class="cls_006"><span class="cls_006">written and invalidated (invalidation uses the same partial word write</span></div>
<div style="position:absolute;left:239.98px;top:583.67px" class="cls_006"><span class="cls_006">mechanism described above).</span></div>
<div style="position:absolute;left:239.98px;top:597.67px" class="cls_006"><span class="cls_006">Note that cache isolation does not stop instruction fetches from</span></div>
<div style="position:absolute;left:239.98px;top:608.67px" class="cls_006"><span class="cls_006">referencing main memory.</span></div>
<div style="position:absolute;left:239.98px;top:622.67px" class="cls_006"><span class="cls_006">The D-cache behaves ‘‘perfectly’’ as an I-cache</span></div>
<div style="position:absolute;left:492.43px;top:622.67px" class="cls_006"><span class="cls_006">(provided it was</span></div>
<div style="position:absolute;left:239.98px;top:633.67px" class="cls_006"><span class="cls_006">sufficiently initialized to work as a D-cache) but the I-cache does not</span></div>
<div style="position:absolute;left:239.98px;top:644.67px" class="cls_006"><span class="cls_006">behave properly as a D-cache. It is unlikely that it will ever be useful</span></div>
<div style="position:absolute;left:239.98px;top:655.67px" class="cls_006"><span class="cls_006">to have the caches swapped but not isolated.</span></div>
<div style="position:absolute;left:239.98px;top:669.67px" class="cls_006"><span class="cls_006">If software does use a swapped I-cache for word stores (a partial-word</span></div>
<div style="position:absolute;left:239.98px;top:680.67px" class="cls_006"><span class="cls_006">store invalidates the line, as before) it must make sure those locations</span></div>
<div style="position:absolute;left:239.98px;top:691.67px" class="cls_006"><span class="cls_006">are invalidated before returning to normal operation.</span></div>
<div style="position:absolute;left:305.78px;top:755.33px" class="cls_002"><span class="cls_002">5-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:57744px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 5</span></div>
<div style="position:absolute;left:458.87px;top:28.00px" class="cls_002"><span class="cls_002">CACHE MANAGEMENT</span></div>
<div style="position:absolute;left:36.00px;top:50.00px" class="cls_015"><span class="cls_015">Initializing and sizing the caches</span></div>
<div style="position:absolute;left:48.02px;top:63.67px" class="cls_006"><span class="cls_006">At machine start-up the caches are in a random state, so the result of a</span></div>
<div style="position:absolute;left:36.00px;top:74.67px" class="cls_006"><span class="cls_006">cached read is unpredictable. In addition, following a reset the status</span></div>
<div style="position:absolute;left:36.00px;top:85.67px" class="cls_006"><span class="cls_006">register SwC and IsC bits are also in a random state, so start-up software</span></div>
<div style="position:absolute;left:36.00px;top:96.67px" class="cls_006"><span class="cls_006">had better set them to a known state before attempting any load or store</span></div>
<div style="position:absolute;left:36.00px;top:107.67px" class="cls_006"><span class="cls_006">(even uncached).</span></div>
<div style="position:absolute;left:48.02px;top:118.67px" class="cls_006"><span class="cls_006">Different members of the R3051 family have different cache sizes.</span></div>
<div style="position:absolute;left:36.00px;top:129.67px" class="cls_006"><span class="cls_006">Software will be more portable if it dynamically determines the size of the</span></div>
<div style="position:absolute;left:36.00px;top:140.67px" class="cls_006"><span class="cls_006">I-cache and D-cache at initialization time, rather than hard-wiring a</span></div>
<div style="position:absolute;left:36.00px;top:151.67px" class="cls_006"><span class="cls_006">particular value.</span></div>
<div style="position:absolute;left:48.02px;top:162.67px" class="cls_006"><span class="cls_006">A number of algorithms are possible. Shown below is the code contained</span></div>
<div style="position:absolute;left:36.00px;top:173.67px" class="cls_006"><span class="cls_006">in IDT/sim for cache sizing. The basic algorithm works as follows:isolate</span></div>
<div style="position:absolute;left:36.00px;top:184.67px" class="cls_006"><span class="cls_006">the D-cache;</span></div>
<div style="position:absolute;left:48.02px;top:198.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:198.67px" class="cls_006"><span class="cls_006">swap the caches when sizing the I-cache;</span></div>
<div style="position:absolute;left:48.02px;top:212.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:212.67px" class="cls_006"><span class="cls_006">Write a marker into the initial cache entry.</span></div>
<div style="position:absolute;left:48.02px;top:226.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:226.67px" class="cls_006"><span class="cls_006">Start with the smallest permissible cache size.</span></div>
<div style="position:absolute;left:48.02px;top:240.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:240.67px" class="cls_006"><span class="cls_006">Read memory at the location for the current cache size. If it contains</span></div>
<div style="position:absolute;left:59.97px;top:251.67px" class="cls_006"><span class="cls_006">the marker, that is the correct size. Otherwise, double the size to try</span></div>
<div style="position:absolute;left:59.97px;top:262.67px" class="cls_006"><span class="cls_006">and repeat this step until the marker is found.</span></div>
<div style="position:absolute;left:72.00px;top:274.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:72.00px;top:284.00px" class="cls_028"><span class="cls_028">** Config_cache() -- determine sizes of i and d caches</span></div>
<div style="position:absolute;left:72.00px;top:294.00px" class="cls_028"><span class="cls_028">** Sizes stored in globals dcache_size and icache_size</span></div>
<div style="position:absolute;left:72.00px;top:304.00px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:72.00px;top:314.00px" class="cls_028"><span class="cls_028">#define CONFIGFRM ((4*4)+4+4)</span></div>
<div style="position:absolute;left:72.00px;top:324.00px" class="cls_028"><span class="cls_028">FRAME(config_cache,sp, CONFIGFRM, ra)</span></div>
<div style="position:absolute;left:108.00px;top:334.00px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:334.00px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:108.00px;top:344.00px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:144.09px;top:344.00px" class="cls_028"><span class="cls_028">sp,CONFIGFRM</span></div>
<div style="position:absolute;left:108.00px;top:354.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:354.00px" class="cls_028"><span class="cls_028">ra,CONFIGFRM-4(sp)# save return address</span></div>
<div style="position:absolute;left:108.00px;top:363.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:363.99px" class="cls_028"><span class="cls_028">s0,4*4(sp)</span></div>
<div style="position:absolute;left:216.28px;top:363.99px" class="cls_028"><span class="cls_028"># save s0 in first regsave slot</span></div>
<div style="position:absolute;left:108.00px;top:373.99px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:144.09px;top:373.99px" class="cls_028"><span class="cls_028">s0,C0_SR</span></div>
<div style="position:absolute;left:216.28px;top:373.99px" class="cls_028"><span class="cls_028"># save SR</span></div>
<div style="position:absolute;left:108.00px;top:383.99px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:383.99px" class="cls_028"><span class="cls_028">zero,C0_SR</span></div>
<div style="position:absolute;left:216.33px;top:383.99px" class="cls_028"><span class="cls_028"># disable interrupts</span></div>
<div style="position:absolute;left:108.00px;top:393.99px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:393.99px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:108.00px;top:403.99px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:144.06px;top:403.99px" class="cls_028"><span class="cls_028">_size_cache</span></div>
<div style="position:absolute;left:108.00px;top:413.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:413.99px" class="cls_028"><span class="cls_028">v0,dcache_size</span></div>
<div style="position:absolute;left:108.00px;top:423.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:423.99px" class="cls_028"><span class="cls_028">v0,SR_SWC</span></div>
<div style="position:absolute;left:216.25px;top:423.99px" class="cls_028"><span class="cls_028"># swap caches</span></div>
<div style="position:absolute;left:108.00px;top:433.99px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:433.99px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:108.00px;top:443.99px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:443.99px" class="cls_028"><span class="cls_028">v0,C0_SR</span></div>
<div style="position:absolute;left:108.00px;top:453.99px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:144.06px;top:453.99px" class="cls_028"><span class="cls_028">_size_cache</span></div>
<div style="position:absolute;left:108.00px;top:463.98px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:108.00px;top:473.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:473.98px" class="cls_028"><span class="cls_028">v0,icache_size</span></div>
<div style="position:absolute;left:108.00px;top:483.98px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:483.98px" class="cls_028"><span class="cls_028">zero,C0_SR</span></div>
<div style="position:absolute;left:216.33px;top:483.98px" class="cls_028"><span class="cls_028"># swap back caches</span></div>
<div style="position:absolute;left:108.00px;top:493.98px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.06px;top:493.98px" class="cls_028"><span class="cls_028">s0,~SR_PE</span></div>
<div style="position:absolute;left:216.27px;top:493.98px" class="cls_028"><span class="cls_028"># do not inadvertantly clear PE</span></div>
<div style="position:absolute;left:108.00px;top:503.98px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:503.98px" class="cls_028"><span class="cls_028">s0,C0_SR</span></div>
<div style="position:absolute;left:216.28px;top:503.98px" class="cls_028"><span class="cls_028"># restore SR</span></div>
<div style="position:absolute;left:108.00px;top:513.98px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:513.98px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:108.00px;top:523.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:523.98px" class="cls_028"><span class="cls_028">s0,4*4(sp)</span></div>
<div style="position:absolute;left:216.28px;top:523.98px" class="cls_028"><span class="cls_028"># restore s0</span></div>
<div style="position:absolute;left:108.00px;top:533.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:533.98px" class="cls_028"><span class="cls_028">ra,CONFIGFRM-4(sp)# restore ra</span></div>
<div style="position:absolute;left:108.00px;top:543.98px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:144.09px;top:543.98px" class="cls_028"><span class="cls_028">sp,CONFIGFRM</span></div>
<div style="position:absolute;left:216.37px;top:543.98px" class="cls_028"><span class="cls_028"># pop stack</span></div>
<div style="position:absolute;left:108.00px;top:553.98px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:553.98px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:108.00px;top:563.97px" class="cls_028"><span class="cls_028">ENDFRAME(config_cache)</span></div>
<div style="position:absolute;left:72.00px;top:583.97px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:72.00px;top:593.97px" class="cls_028"><span class="cls_028">** _size_cache()</span></div>
<div style="position:absolute;left:72.00px;top:603.97px" class="cls_028"><span class="cls_028">** return size of current data cache</span></div>
<div style="position:absolute;left:72.00px;top:613.97px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:72.00px;top:623.97px" class="cls_028"><span class="cls_028">FRAME(_size_cache,sp,0,ra)</span></div>
<div style="position:absolute;left:108.00px;top:633.97px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:633.97px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:108.00px;top:643.97px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:144.09px;top:643.97px" class="cls_028"><span class="cls_028">t0,C0_SR</span></div>
<div style="position:absolute;left:216.28px;top:643.97px" class="cls_028"><span class="cls_028"># save current sr</span></div>
<div style="position:absolute;left:108.00px;top:653.97px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.06px;top:653.97px" class="cls_028"><span class="cls_028">t0,~SR_PE</span></div>
<div style="position:absolute;left:216.27px;top:653.97px" class="cls_028"><span class="cls_028"># do not inadvertently clear PE</span></div>
<div style="position:absolute;left:108.00px;top:663.97px" class="cls_028"><span class="cls_028">or</span></div>
<div style="position:absolute;left:144.05px;top:663.97px" class="cls_028"><span class="cls_028">v0,t0,SR_ISC</span></div>
<div style="position:absolute;left:216.33px;top:663.97px" class="cls_028"><span class="cls_028"># isolate cache</span></div>
<div style="position:absolute;left:108.00px;top:673.96px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:673.96px" class="cls_028"><span class="cls_028">v0,C0_SR</span></div>
<div style="position:absolute;left:108.00px;top:683.96px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:113.40px;top:693.96px" class="cls_028"><span class="cls_028">* First check if there is a cache there at all</span></div>
<div style="position:absolute;left:113.40px;top:703.96px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:108.00px;top:713.96px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:713.96px" class="cls_028"><span class="cls_028">v0,zero</span></div>
<div style="position:absolute;left:108.00px;top:723.96px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:723.96px" class="cls_028"><span class="cls_028">v1,0xa5a5a5a5 # distinctive pattern</span></div>
<div style="position:absolute;left:292.03px;top:755.33px" class="cls_002"><span class="cls_002">5-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:58546px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">CACHE MANAGEMENT</span></div>
<div style="position:absolute;left:524.87px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 5</span></div>
<div style="position:absolute;left:288.00px;top:51.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:51.00px" class="cls_028"><span class="cls_028">v1,K0BASE</span></div>
<div style="position:absolute;left:396.25px;top:51.00px" class="cls_028"><span class="cls_028"># try to write into cache</span></div>
<div style="position:absolute;left:288.00px;top:61.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.04px;top:61.00px" class="cls_028"><span class="cls_028">t1,K0BASE</span></div>
<div style="position:absolute;left:396.25px;top:61.00px" class="cls_028"><span class="cls_028"># try to read from cache</span></div>
<div style="position:absolute;left:288.00px;top:71.00px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:81.00px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.09px;top:81.00px" class="cls_028"><span class="cls_028">t2,C0_SR</span></div>
<div style="position:absolute;left:288.00px;top:91.00px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:101.00px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:101.00px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:288.00px;top:111.00px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:324.06px;top:111.00px" class="cls_028"><span class="cls_028">t2,SR_CM</span></div>
<div style="position:absolute;left:288.00px;top:120.99px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:324.06px;top:120.99px" class="cls_028"><span class="cls_028">t2,zero,3f</span></div>
<div style="position:absolute;left:396.30px;top:120.99px" class="cls_028"><span class="cls_028"># cache miss, must be no cache</span></div>
<div style="position:absolute;left:288.00px;top:130.99px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:324.06px;top:130.99px" class="cls_028"><span class="cls_028">v1,t1,3f</span></div>
<div style="position:absolute;left:396.25px;top:130.99px" class="cls_028"><span class="cls_028"># data not equal -> no cache</span></div>
<div style="position:absolute;left:288.00px;top:140.99px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:293.40px;top:150.99px" class="cls_028"><span class="cls_028">* Clear cache size boundries to known state.</span></div>
<div style="position:absolute;left:293.40px;top:160.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:288.00px;top:170.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.04px;top:170.99px" class="cls_028"><span class="cls_028">v0,MINCACHE</span></div>
<div style="position:absolute;left:252.00px;top:180.99px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:288.00px;top:190.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:190.99px" class="cls_028"><span class="cls_028">zero,K0BASE(v0)</span></div>
<div style="position:absolute;left:288.00px;top:200.99px" class="cls_028"><span class="cls_028">sll</span></div>
<div style="position:absolute;left:324.06px;top:200.99px" class="cls_028"><span class="cls_028">v0,1</span></div>
<div style="position:absolute;left:288.00px;top:210.99px" class="cls_028"><span class="cls_028">ble</span></div>
<div style="position:absolute;left:324.06px;top:210.99px" class="cls_028"><span class="cls_028">v0,MAXCACHE,1b</span></div>
<div style="position:absolute;left:288.00px;top:230.98px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.04px;top:230.98px" class="cls_028"><span class="cls_028">v0,-1</span></div>
<div style="position:absolute;left:288.00px;top:240.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.04px;top:240.98px" class="cls_028"><span class="cls_028">v0,K0BASE(zero)# store marker in cache</span></div>
<div style="position:absolute;left:288.00px;top:250.98px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.04px;top:250.98px" class="cls_028"><span class="cls_028">v0,MINCACHE</span></div>
<div style="position:absolute;left:396.30px;top:250.98px" class="cls_028"><span class="cls_028"># MIN cache size</span></div>
<div style="position:absolute;left:252.00px;top:270.98px" class="cls_028"><span class="cls_028">2:</span></div>
<div style="position:absolute;left:288.04px;top:270.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.09px;top:270.98px" class="cls_028"><span class="cls_028">v1,K0BASE(v0) # Look for marker</span></div>
<div style="position:absolute;left:288.00px;top:280.98px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:324.06px;top:280.98px" class="cls_028"><span class="cls_028">v1,zero,3f</span></div>
<div style="position:absolute;left:396.30px;top:280.98px" class="cls_028"><span class="cls_028"># found marker</span></div>
<div style="position:absolute;left:288.00px;top:290.98px" class="cls_028"><span class="cls_028">sll</span></div>
<div style="position:absolute;left:324.06px;top:290.98px" class="cls_028"><span class="cls_028">v0,1</span></div>
<div style="position:absolute;left:432.16px;top:290.98px" class="cls_028"><span class="cls_028"># cache size * 2</span></div>
<div style="position:absolute;left:288.00px;top:300.98px" class="cls_028"><span class="cls_028">ble</span></div>
<div style="position:absolute;left:324.06px;top:300.98px" class="cls_028"><span class="cls_028">v0,MAXCACHE,2b# keep looking</span></div>
<div style="position:absolute;left:288.00px;top:310.98px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.09px;top:310.98px" class="cls_028"><span class="cls_028">v0,zero</span></div>
<div style="position:absolute;left:432.25px;top:310.98px" class="cls_028"><span class="cls_028"># must be no cache</span></div>
<div style="position:absolute;left:288.00px;top:320.98px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:320.98px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:252.00px;top:330.97px" class="cls_028"><span class="cls_028">3:</span></div>
<div style="position:absolute;left:288.04px;top:330.97px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.14px;top:330.97px" class="cls_028"><span class="cls_028">t0,C0_SR</span></div>
<div style="position:absolute;left:396.32px;top:330.97px" class="cls_028"><span class="cls_028"># restore sr</span></div>
<div style="position:absolute;left:288.00px;top:340.97px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.02px;top:340.97px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:288.00px;top:350.97px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:360.97px" class="cls_028"><span class="cls_028">ENDFRAME(_size_cache)</span></div>
<div style="position:absolute;left:288.00px;top:370.97px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:370.97px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:228.02px;top:390.67px" class="cls_006"><span class="cls_006">In a properly initialized cache, every cache entry is either invalid or</span></div>
<div style="position:absolute;left:216.00px;top:401.67px" class="cls_006"><span class="cls_006">correctly corresponds to a memory location, and also contains correct</span></div>
<div style="position:absolute;left:216.00px;top:412.67px" class="cls_006"><span class="cls_006">parity. Again, the sample code shown is from IDT/sim. The code works as</span></div>
<div style="position:absolute;left:216.00px;top:423.67px" class="cls_006"><span class="cls_006">follows:</span></div>
<div style="position:absolute;left:228.02px;top:437.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:437.67px" class="cls_006"><span class="cls_006">Check that </span><span class="cls_008">SR</span><span class="cls_006"> bit PZ is cleared to zero (1 disables parity; the R3071</span></div>
<div style="position:absolute;left:239.97px;top:448.67px" class="cls_006"><span class="cls_006">and R3081 contain parity bits, and thus PZ=1 could cause the caches</span></div>
<div style="position:absolute;left:239.97px;top:459.67px" class="cls_006"><span class="cls_006">to be initialized improperly).</span></div>
<div style="position:absolute;left:228.02px;top:473.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:473.67px" class="cls_006"><span class="cls_006">Isolate the D-cache, swap to access the I-cache.</span></div>
<div style="position:absolute;left:228.02px;top:487.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:487.67px" class="cls_006"><span class="cls_006">For each word of the cache: first write a word value (writing correct</span></div>
<div style="position:absolute;left:239.97px;top:498.67px" class="cls_006"><span class="cls_006">tag, data and parity), then write a byte (invalidating the line).</span></div>
<div style="position:absolute;left:239.97px;top:512.67px" class="cls_006"><span class="cls_006">Note that for an I-cache with 4 words per line this is inefficient; it</span></div>
<div style="position:absolute;left:239.97px;top:523.67px" class="cls_006"><span class="cls_006">would be enough to write just one byte in the line to invalidate the</span></div>
<div style="position:absolute;left:239.97px;top:534.67px" class="cls_006"><span class="cls_006">entry. Unless the system uses the invalidate routine often it doesn’t</span></div>
<div style="position:absolute;left:239.97px;top:545.67px" class="cls_006"><span class="cls_006">seem worth the trouble.</span></div>
<div style="position:absolute;left:252.00px;top:571.00px" class="cls_028"><span class="cls_028">FRAME(flush_cache,sp,0,ra)</span></div>
<div style="position:absolute;left:288.00px;top:581.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:581.00px" class="cls_028"><span class="cls_028">t1,icache_size</span></div>
<div style="position:absolute;left:288.00px;top:591.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:591.00px" class="cls_028"><span class="cls_028">t2,dcache_size</span></div>
<div style="position:absolute;left:288.00px;top:601.00px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.10px;top:601.00px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:288.00px;top:611.00px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.10px;top:611.00px" class="cls_028"><span class="cls_028">t3,C0_SR</span></div>
<div style="position:absolute;left:396.28px;top:611.00px" class="cls_028"><span class="cls_028"># save SR</span></div>
<div style="position:absolute;left:288.00px;top:621.00px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:631.00px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:324.07px;top:631.00px" class="cls_028"><span class="cls_028">t3,~SR_PE</span></div>
<div style="position:absolute;left:396.27px;top:631.00px" class="cls_028"><span class="cls_028"># dont inadvertently clear PE</span></div>
<div style="position:absolute;left:288.00px;top:641.00px" class="cls_028"><span class="cls_028">beq</span></div>
<div style="position:absolute;left:324.07px;top:641.00px" class="cls_028"><span class="cls_028">t1,zero,_check_dcache# if no i-cache check d-cache</span></div>
<div style="position:absolute;left:288.00px;top:651.00px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:660.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:660.99px" class="cls_028"><span class="cls_028">v0,SR_ISC|SR_SWC# disable intr, isolate and swap</span></div>
<div style="position:absolute;left:288.00px;top:670.99px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.10px;top:670.99px" class="cls_028"><span class="cls_028">v0,C0_SR</span></div>
<div style="position:absolute;left:288.00px;top:680.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:680.99px" class="cls_028"><span class="cls_028">t0,K0BASE</span></div>
<div style="position:absolute;left:288.00px;top:690.99px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.10px;top:690.99px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:288.00px;top:700.99px" class="cls_028"><span class="cls_028">or</span></div>
<div style="position:absolute;left:324.05px;top:700.99px" class="cls_028"><span class="cls_028">t1,t0,t1</span></div>
<div style="position:absolute;left:252.00px;top:720.99px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:288.05px;top:720.99px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:324.10px;top:720.99px" class="cls_028"><span class="cls_028">zero,0(t0)</span></div>
<div style="position:absolute;left:305.78px;top:755.33px" class="cls_002"><span class="cls_002">5-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:59348px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 5</span></div>
<div style="position:absolute;left:458.87px;top:28.00px" class="cls_002"><span class="cls_002">CACHE MANAGEMENT</span></div>
<div style="position:absolute;left:108.00px;top:51.00px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:51.00px" class="cls_028"><span class="cls_028">zero,4(t0)</span></div>
<div style="position:absolute;left:108.00px;top:61.00px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:61.00px" class="cls_028"><span class="cls_028">zero,8(t0)</span></div>
<div style="position:absolute;left:108.00px;top:71.00px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:71.00px" class="cls_028"><span class="cls_028">zero,12(t0)</span></div>
<div style="position:absolute;left:108.00px;top:81.00px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:81.00px" class="cls_028"><span class="cls_028">zero,16(t0)</span></div>
<div style="position:absolute;left:108.00px;top:91.00px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:91.00px" class="cls_028"><span class="cls_028">zero,20(t0)</span></div>
<div style="position:absolute;left:108.00px;top:101.00px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:101.00px" class="cls_028"><span class="cls_028">zero,24(t0)</span></div>
<div style="position:absolute;left:108.00px;top:111.00px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:144.09px;top:111.00px" class="cls_028"><span class="cls_028">t0,32</span></div>
<div style="position:absolute;left:108.00px;top:120.99px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:120.99px" class="cls_028"><span class="cls_028">zero,-4(t0)</span></div>
<div style="position:absolute;left:108.00px;top:130.99px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:144.07px;top:130.99px" class="cls_028"><span class="cls_028">t0,t1,1b</span></div>
<div style="position:absolute;left:108.00px;top:140.99px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:113.40px;top:150.99px" class="cls_028"><span class="cls_028">* flush data cache</span></div>
<div style="position:absolute;left:113.40px;top:160.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:72.00px;top:170.99px" class="cls_028"><span class="cls_028">_check_dcache:</span></div>
<div style="position:absolute;left:108.00px;top:180.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:180.99px" class="cls_028"><span class="cls_028">v0,SR_ISC</span></div>
<div style="position:absolute;left:216.25px;top:180.99px" class="cls_028"><span class="cls_028"># isolate and swap back caches</span></div>
<div style="position:absolute;left:108.00px;top:190.99px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:190.99px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:108.00px;top:200.99px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:200.99px" class="cls_028"><span class="cls_028">v0,C0_SR</span></div>
<div style="position:absolute;left:108.00px;top:210.99px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:108.00px;top:220.99px" class="cls_028"><span class="cls_028">beq</span></div>
<div style="position:absolute;left:144.07px;top:220.99px" class="cls_028"><span class="cls_028">t2,zero,_flush_done</span></div>
<div style="position:absolute;left:108.00px;top:230.98px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:230.98px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:108.00px;top:240.98px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:240.98px" class="cls_028"><span class="cls_028">t0,K0BASE</span></div>
<div style="position:absolute;left:108.00px;top:250.98px" class="cls_028"><span class="cls_028">or</span></div>
<div style="position:absolute;left:144.05px;top:250.98px" class="cls_028"><span class="cls_028">t1,t0,t2</span></div>
<div style="position:absolute;left:72.00px;top:270.98px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:108.05px;top:270.98px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.09px;top:270.98px" class="cls_028"><span class="cls_028">zero,0(t0)</span></div>
<div style="position:absolute;left:108.00px;top:280.98px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:280.98px" class="cls_028"><span class="cls_028">zero,4(t0)</span></div>
<div style="position:absolute;left:108.00px;top:290.98px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:290.98px" class="cls_028"><span class="cls_028">zero,8(t0)</span></div>
<div style="position:absolute;left:108.00px;top:300.98px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:300.98px" class="cls_028"><span class="cls_028">zero,12(t0)</span></div>
<div style="position:absolute;left:108.00px;top:310.98px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:310.98px" class="cls_028"><span class="cls_028">zero,16(t0)</span></div>
<div style="position:absolute;left:108.00px;top:320.98px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:320.98px" class="cls_028"><span class="cls_028">zero,20(t0)</span></div>
<div style="position:absolute;left:108.00px;top:330.97px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:330.97px" class="cls_028"><span class="cls_028">zero,24(t0)</span></div>
<div style="position:absolute;left:108.00px;top:340.97px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:144.09px;top:340.97px" class="cls_028"><span class="cls_028">t0,32</span></div>
<div style="position:absolute;left:108.00px;top:350.97px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:350.97px" class="cls_028"><span class="cls_028">zero,-4(t0)</span></div>
<div style="position:absolute;left:108.00px;top:360.97px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:144.07px;top:360.97px" class="cls_028"><span class="cls_028">t0,t1,1b</span></div>
<div style="position:absolute;left:108.00px;top:380.97px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:380.97px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:72.00px;top:390.97px" class="cls_028"><span class="cls_028">_flush_done:</span></div>
<div style="position:absolute;left:108.00px;top:400.97px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:400.97px" class="cls_028"><span class="cls_028">t3,C0_SR</span></div>
<div style="position:absolute;left:216.28px;top:400.97px" class="cls_028"><span class="cls_028"># un-isolate, enable interrupts</span></div>
<div style="position:absolute;left:108.00px;top:410.97px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:410.97px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:108.00px;top:420.96px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:420.96px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:108.00px;top:430.96px" class="cls_028"><span class="cls_028">ENDFRAME(flush_cache)</span></div>
<div style="position:absolute;left:36.00px;top:452.00px" class="cls_015"><span class="cls_015">Invalidation</span></div>
<div style="position:absolute;left:48.02px;top:465.67px" class="cls_006"><span class="cls_006">Invalidation refers to the act of setting specified cache lines to contain</span></div>
<div style="position:absolute;left:36.00px;top:476.67px" class="cls_006"><span class="cls_006">no valid references to main memory, but to otherwise be consistent (e.g.</span></div>
<div style="position:absolute;left:36.00px;top:487.67px" class="cls_006"><span class="cls_006">valid parity). Software needs to invalidate:</span></div>
<div style="position:absolute;left:48.02px;top:501.67px" class="cls_006"><span class="cls_006">• the D-cache when memory contents have been changed by something</span></div>
<div style="position:absolute;left:59.97px;top:512.67px" class="cls_006"><span class="cls_006">other than store operations from the CPU. Typically this is done when</span></div>
<div style="position:absolute;left:59.97px;top:523.67px" class="cls_006"><span class="cls_006">some DMA device is reading into memory.</span></div>
<div style="position:absolute;left:48.02px;top:537.67px" class="cls_006"><span class="cls_006">• the I-cache when instructions have been either written by the CPU or</span></div>
<div style="position:absolute;left:59.97px;top:548.67px" class="cls_006"><span class="cls_006">obtained by DMA. The hardware does nothing to prevent the same</span></div>
<div style="position:absolute;left:59.97px;top:559.67px" class="cls_006"><span class="cls_006">locations being used in the I- and D-cache; and an update by the</span></div>
<div style="position:absolute;left:59.97px;top:570.67px" class="cls_006"><span class="cls_006">processor will not change the I-cache contents.</span></div>
<div style="position:absolute;left:48.02px;top:581.67px" class="cls_006"><span class="cls_006">Note that the system could be constructed to use unmapped accesses to</span></div>
<div style="position:absolute;left:36.00px;top:592.67px" class="cls_006"><span class="cls_006">those variables shared with a DMA device; the only difference is in</span></div>
<div style="position:absolute;left:36.00px;top:603.67px" class="cls_006"><span class="cls_006">performance. In general small areas where DMA is frequent compared to</span></div>
<div style="position:absolute;left:36.00px;top:614.67px" class="cls_006"><span class="cls_006">CPU activity should be mapped uncached; and larger areas where CPU</span></div>
<div style="position:absolute;left:36.00px;top:625.67px" class="cls_006"><span class="cls_006">activity predominates should be invalidated by the driver at appropriate</span></div>
<div style="position:absolute;left:36.00px;top:636.67px" class="cls_006"><span class="cls_006">points. Bear in mind that invalidating a word of data in the cache is faster</span></div>
<div style="position:absolute;left:36.00px;top:647.67px" class="cls_006"><span class="cls_006">(probably 4-7 times faster) than an uncached load.</span></div>
<div style="position:absolute;left:48.02px;top:658.67px" class="cls_006"><span class="cls_006">To invalidate the cache:</span></div>
<div style="position:absolute;left:48.02px;top:672.67px" class="cls_006"><span class="cls_006">• Figure out the address range to invalidate. Invalidating a region larger</span></div>
<div style="position:absolute;left:59.97px;top:683.67px" class="cls_006"><span class="cls_006">than the cache size is a waste of time.</span></div>
<div style="position:absolute;left:292.03px;top:755.33px" class="cls_002"><span class="cls_002">5-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:60150px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">CACHE MANAGEMENT</span></div>
<div style="position:absolute;left:524.87px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 5</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">• isolate the D-cache. Once it is isolated, the system must insure at all</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">costs  against  an  exception</span></div>
<div style="position:absolute;left:387.33px;top:61.67px" class="cls_006"><span class="cls_006">(since  the  memory  interface  will  be</span></div>
<div style="position:absolute;left:239.97px;top:72.67px" class="cls_006"><span class="cls_006">temporarily disabled). Disable interrupts and ensure that software</span></div>
<div style="position:absolute;left:239.97px;top:83.67px" class="cls_006"><span class="cls_006">which follows cannot cause a memory access exception;</span></div>
<div style="position:absolute;left:228.02px;top:97.67px" class="cls_006"><span class="cls_006">• to work on the I-cache, swap the caches;</span></div>
<div style="position:absolute;left:228.02px;top:111.67px" class="cls_006"><span class="cls_006">• write a byte value to each cache line in the range;</span></div>
<div style="position:absolute;left:228.02px;top:125.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:125.67px" class="cls_006"><span class="cls_006">(unswap and) unisolate.</span></div>
<div style="position:absolute;left:228.02px;top:136.67px" class="cls_006"><span class="cls_006">The  invalidate  routine  is  normally  executed  with  its  instructions</span></div>
<div style="position:absolute;left:216.00px;top:147.67px" class="cls_006"><span class="cls_006">cacheable. This sounds like a lot of trouble; but in fact shouldn’t require</span></div>
<div style="position:absolute;left:216.00px;top:158.67px" class="cls_006"><span class="cls_006">any extra steps to run cached. An invalidation routine in uncached space</span></div>
<div style="position:absolute;left:216.00px;top:169.67px" class="cls_006"><span class="cls_006">will run 4-10 times slower.</span></div>
<div style="position:absolute;left:228.02px;top:180.67px" class="cls_006"><span class="cls_006">Again, the example code fragment shown is taken from IDT/sim:</span></div>
<div style="position:absolute;left:252.00px;top:192.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:252.00px;top:201.99px" class="cls_028"><span class="cls_028">** clear_cache(base_addr, byte_count)</span></div>
<div style="position:absolute;left:252.00px;top:211.99px" class="cls_028"><span class="cls_028">** flush portion of cache</span></div>
<div style="position:absolute;left:252.00px;top:221.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.00px;top:231.99px" class="cls_028"><span class="cls_028">FRAME(clear_cache,sp,0,ra)</span></div>
<div style="position:absolute;left:288.00px;top:251.99px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:293.40px;top:261.99px" class="cls_028"><span class="cls_028">* flush instruction cache</span></div>
<div style="position:absolute;left:293.40px;top:271.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:288.00px;top:281.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:281.99px" class="cls_028"><span class="cls_028">t1,icache_size</span></div>
<div style="position:absolute;left:288.00px;top:291.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:291.99px" class="cls_028"><span class="cls_028">t2,dcache_size</span></div>
<div style="position:absolute;left:288.00px;top:301.98px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:301.98px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:288.00px;top:311.98px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.09px;top:311.98px" class="cls_028"><span class="cls_028">t3,C0_SR</span></div>
<div style="position:absolute;left:396.28px;top:311.98px" class="cls_028"><span class="cls_028"># save SR</span></div>
<div style="position:absolute;left:288.00px;top:321.98px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:324.07px;top:321.98px" class="cls_028"><span class="cls_028">t3,~SR_PE</span></div>
<div style="position:absolute;left:396.27px;top:321.98px" class="cls_028"><span class="cls_028"># dont inadvertently clear PE</span></div>
<div style="position:absolute;left:288.00px;top:331.98px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:341.98px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:351.98px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:351.98px" class="cls_028"><span class="cls_028">v0,SR_ISC|SR_SWC# disable intr, isolate and swap</span></div>
<div style="position:absolute;left:288.00px;top:361.98px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:361.98px" class="cls_028"><span class="cls_028">v0,C0_SR</span></div>
<div style="position:absolute;left:288.00px;top:371.98px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:371.98px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:288.00px;top:381.98px" class="cls_028"><span class="cls_028">bltu</span></div>
<div style="position:absolute;left:324.09px;top:381.98px" class="cls_028"><span class="cls_028">t1,a1,1f</span></div>
<div style="position:absolute;left:396.28px;top:381.98px" class="cls_028"><span class="cls_028"># cache is smaller than region</span></div>
<div style="position:absolute;left:288.00px;top:391.98px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.09px;top:391.98px" class="cls_028"><span class="cls_028">t1,a1</span></div>
<div style="position:absolute;left:252.00px;top:401.98px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:288.05px;top:401.98px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:324.14px;top:401.98px" class="cls_028"><span class="cls_028">t1,a0</span></div>
<div style="position:absolute;left:432.25px;top:401.98px" class="cls_028"><span class="cls_028"># ending address + 1</span></div>
<div style="position:absolute;left:288.00px;top:411.97px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.09px;top:411.97px" class="cls_028"><span class="cls_028">t0,a0</span></div>
<div style="position:absolute;left:288.00px;top:431.97px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:324.05px;top:431.97px" class="cls_028"><span class="cls_028">zero,0(t0)</span></div>
<div style="position:absolute;left:288.00px;top:441.97px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:324.05px;top:441.97px" class="cls_028"><span class="cls_028">zero,4(t0)</span></div>
<div style="position:absolute;left:288.00px;top:451.97px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:324.05px;top:451.97px" class="cls_028"><span class="cls_028">zero,8(t0)</span></div>
<div style="position:absolute;left:288.00px;top:461.97px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:324.05px;top:461.97px" class="cls_028"><span class="cls_028">zero,12(t0)</span></div>
<div style="position:absolute;left:288.00px;top:471.97px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:324.05px;top:471.97px" class="cls_028"><span class="cls_028">zero,16(t0)</span></div>
<div style="position:absolute;left:288.00px;top:481.97px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:324.05px;top:481.97px" class="cls_028"><span class="cls_028">zero,20(t0)</span></div>
<div style="position:absolute;left:288.00px;top:491.97px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:324.05px;top:491.97px" class="cls_028"><span class="cls_028">zero,24(t0)</span></div>
<div style="position:absolute;left:288.00px;top:501.96px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:324.09px;top:501.96px" class="cls_028"><span class="cls_028">t0,32</span></div>
<div style="position:absolute;left:288.00px;top:511.96px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:324.05px;top:511.96px" class="cls_028"><span class="cls_028">zero,-4(t0)</span></div>
<div style="position:absolute;left:288.00px;top:521.96px" class="cls_028"><span class="cls_028">bltu</span></div>
<div style="position:absolute;left:324.09px;top:521.96px" class="cls_028"><span class="cls_028">t0,t1,1b</span></div>
<div style="position:absolute;left:288.00px;top:541.96px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:293.40px;top:551.96px" class="cls_028"><span class="cls_028">* flush data cache</span></div>
<div style="position:absolute;left:293.40px;top:561.96px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:288.00px;top:581.96px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:581.96px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:288.00px;top:591.96px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:601.96px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:601.96px" class="cls_028"><span class="cls_028">v0,SR_ISC</span></div>
<div style="position:absolute;left:396.25px;top:601.96px" class="cls_028"><span class="cls_028"># isolate and swap back caches</span></div>
<div style="position:absolute;left:288.00px;top:611.95px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:611.95px" class="cls_028"><span class="cls_028">v0,C0_SR</span></div>
<div style="position:absolute;left:288.00px;top:621.95px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:631.95px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:631.95px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:288.00px;top:641.95px" class="cls_028"><span class="cls_028">bltu</span></div>
<div style="position:absolute;left:324.09px;top:641.95px" class="cls_028"><span class="cls_028">t2,a1,1f</span></div>
<div style="position:absolute;left:396.28px;top:641.95px" class="cls_028"><span class="cls_028"># cache is smaller than region</span></div>
<div style="position:absolute;left:288.00px;top:651.95px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.09px;top:651.95px" class="cls_028"><span class="cls_028">t2,a1</span></div>
<div style="position:absolute;left:252.00px;top:661.95px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:288.05px;top:661.95px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:324.14px;top:661.95px" class="cls_028"><span class="cls_028">t2,a0</span></div>
<div style="position:absolute;left:432.25px;top:661.95px" class="cls_028"><span class="cls_028"># ending address + 1</span></div>
<div style="position:absolute;left:288.00px;top:671.95px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.09px;top:671.95px" class="cls_028"><span class="cls_028">t0,a0</span></div>
<div style="position:absolute;left:252.00px;top:691.95px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:288.05px;top:691.95px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:324.09px;top:691.95px" class="cls_028"><span class="cls_028">zero,0(t0)</span></div>
<div style="position:absolute;left:288.00px;top:701.95px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:324.05px;top:701.95px" class="cls_028"><span class="cls_028">zero,4(t0)</span></div>
<div style="position:absolute;left:288.00px;top:711.94px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:324.05px;top:711.94px" class="cls_028"><span class="cls_028">zero,8(t0)</span></div>
<div style="position:absolute;left:288.00px;top:721.94px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:324.05px;top:721.94px" class="cls_028"><span class="cls_028">zero,12(t0)</span></div>
<div style="position:absolute;left:305.78px;top:755.33px" class="cls_002"><span class="cls_002">5-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:60952px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 5</span></div>
<div style="position:absolute;left:458.87px;top:28.00px" class="cls_002"><span class="cls_002">CACHE MANAGEMENT</span></div>
<div style="position:absolute;left:108.00px;top:51.00px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:51.00px" class="cls_028"><span class="cls_028">zero,16(t0)</span></div>
<div style="position:absolute;left:108.00px;top:61.00px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:61.00px" class="cls_028"><span class="cls_028">zero,20(t0)</span></div>
<div style="position:absolute;left:108.00px;top:71.00px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:71.00px" class="cls_028"><span class="cls_028">zero,24(t0)</span></div>
<div style="position:absolute;left:108.00px;top:81.00px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:144.09px;top:81.00px" class="cls_028"><span class="cls_028">t0,32</span></div>
<div style="position:absolute;left:108.00px;top:91.00px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:91.00px" class="cls_028"><span class="cls_028">zero,-4(t0)</span></div>
<div style="position:absolute;left:108.00px;top:101.00px" class="cls_028"><span class="cls_028">bltu</span></div>
<div style="position:absolute;left:144.09px;top:101.00px" class="cls_028"><span class="cls_028">t0,t2,1b</span></div>
<div style="position:absolute;left:108.00px;top:120.99px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:120.99px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:108.00px;top:130.99px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:130.99px" class="cls_028"><span class="cls_028">t3,C0_SR</span></div>
<div style="position:absolute;left:216.28px;top:130.99px" class="cls_028"><span class="cls_028"># un-isolate, enable interrupts</span></div>
<div style="position:absolute;left:108.00px;top:140.99px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:140.99px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:108.00px;top:150.99px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:150.99px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:108.00px;top:160.99px" class="cls_028"><span class="cls_028">ENDFRAME(clear_cache)</span></div>
<div style="position:absolute;left:36.00px;top:193.00px" class="cls_015"><span class="cls_015">Testing and probing</span></div>
<div style="position:absolute;left:48.02px;top:206.67px" class="cls_006"><span class="cls_006">During test, debug or when profiling, it may be useful to build up a</span></div>
<div style="position:absolute;left:36.00px;top:217.67px" class="cls_006"><span class="cls_006">picture of the cache contents. Software cannot read the tag value directly,</span></div>
<div style="position:absolute;left:36.00px;top:228.67px" class="cls_006"><span class="cls_006">but, for a valid line, can determine the tag value by exhaustive search:</span></div>
<div style="position:absolute;left:48.02px;top:242.67px" class="cls_006"><span class="cls_006">• isolate the cache;</span></div>
<div style="position:absolute;left:48.02px;top:256.67px" class="cls_006"><span class="cls_006">• load from the cache line at each possible line start address (low order</span></div>
<div style="position:absolute;left:59.97px;top:267.67px" class="cls_006"><span class="cls_006">bits fixed, high order bits ranging over physical memory which exists</span></div>
<div style="position:absolute;left:59.97px;top:278.67px" class="cls_006"><span class="cls_006">in the system). After each load consult the CM bit in </span><span class="cls_008">SR,</span><span class="cls_006"> which will be</span></div>
<div style="position:absolute;left:59.98px;top:289.67px" class="cls_006"><span class="cls_006">‘‘0’’ only when the tag value matches.</span></div>
<div style="position:absolute;left:48.03px;top:300.67px" class="cls_006"><span class="cls_006">This takes a long time by computer terms; but to fully search a 1K D-</span></div>
<div style="position:absolute;left:36.01px;top:311.67px" class="cls_006"><span class="cls_006">cache with 4Mbytes of cacheable physical memory on a 20Mhz processor</span></div>
<div style="position:absolute;left:36.01px;top:322.67px" class="cls_006"><span class="cls_006">will take only a couple of seconds, and will provide very valuable debugging</span></div>
<div style="position:absolute;left:36.01px;top:333.67px" class="cls_006"><span class="cls_006">information. IDT/sim provides this capability.</span></div>
<div style="position:absolute;left:36.00px;top:356.00px" class="cls_015"><span class="cls_015">Configuration (R3041/71/81 only)</span></div>
<div style="position:absolute;left:48.02px;top:369.67px" class="cls_006"><span class="cls_006">The R3041, R3071, and R3081 processors allow the programmer to</span></div>
<div style="position:absolute;left:36.00px;top:380.67px" class="cls_006"><span class="cls_006">make choices about the cache by setting fields in the </span><span class="cls_008">Config</span><span class="cls_006"> register:</span></div>
<div style="position:absolute;left:48.02px;top:394.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:394.67px" class="cls_008"><span class="cls_008">Cache refill burst size (R3041/71/81)</span><span class="cls_006">: by default the R3041 refills</span></div>
<div style="position:absolute;left:59.97px;top:405.67px" class="cls_006"><span class="cls_006">only 1 word in the D-cache on a cache miss; but software can program</span></div>
<div style="position:absolute;left:59.97px;top:416.67px" class="cls_006"><span class="cls_006">it to use 4-word burst reads instead, by setting the </span><span class="cls_008">Config</span><span class="cls_006"> DBR bit.</span></div>
<div style="position:absolute;left:59.97px;top:427.67px" class="cls_006"><span class="cls_006">The bit can be changed at any time, without needing to invalidate the</span></div>
<div style="position:absolute;left:59.97px;top:438.67px" class="cls_006"><span class="cls_006">cache.</span></div>
<div style="position:absolute;left:59.97px;top:452.67px" class="cls_006"><span class="cls_006">The refill of R3071 and R3081 processors can be configured by</span></div>
<div style="position:absolute;left:59.97px;top:463.67px" class="cls_006"><span class="cls_006">hardware at reset-time, but software can override that choice.</span></div>
<div style="position:absolute;left:59.97px;top:477.67px" class="cls_006"><span class="cls_006">This support is provided in the hope of enhancing performance. The</span></div>
<div style="position:absolute;left:59.97px;top:488.67px" class="cls_006"><span class="cls_006">proper selection for a given system will depend on both the hardware</span></div>
<div style="position:absolute;left:59.97px;top:499.67px" class="cls_006"><span class="cls_006">and  the  application.  Some  systems  may  find  an  advantage  in</span></div>
<div style="position:absolute;left:59.97px;top:510.67px" class="cls_006"><span class="cls_006">“toggling” the bit for various portions of the software. In general, the</span></div>
<div style="position:absolute;left:59.97px;top:521.67px" class="cls_006"><span class="cls_006">proper burst size selection can be determined as follows:</span></div>
<div style="position:absolute;left:59.97px;top:535.67px" class="cls_006"><span class="cls_006">Burst  reads  make  most  sense  when  the  memory  is  capable  of</span></div>
<div style="position:absolute;left:59.97px;top:546.67px" class="cls_006"><span class="cls_006">returning a burst of data significantly faster than it can return 4</span></div>
<div style="position:absolute;left:59.97px;top:557.67px" class="cls_006"><span class="cls_006">individual words. Many DRAM systems are like this; most ROM and</span></div>
<div style="position:absolute;left:59.97px;top:568.67px" class="cls_006"><span class="cls_006">static RAM memories are not. Similarly, data accessed from narrow</span></div>
<div style="position:absolute;left:59.97px;top:579.67px" class="cls_006"><span class="cls_006">memory ports should rarely be configured for a multi-word burst.</span></div>
<div style="position:absolute;left:59.97px;top:593.67px" class="cls_006"><span class="cls_006">If programs tend to access memory sequentially (working up or down</span></div>
<div style="position:absolute;left:59.97px;top:604.67px" class="cls_006"><span class="cls_006">a large array, for example) then the burst refill will offer a very useful</span></div>
<div style="position:absolute;left:59.97px;top:615.67px" class="cls_006"><span class="cls_006">degree of data prefetch, and performance will be enhanced. If cache</span></div>
<div style="position:absolute;left:59.97px;top:626.67px" class="cls_006"><span class="cls_006">access  is  more  random,  the  burst  refill  may  actually  reduce</span></div>
<div style="position:absolute;left:59.97px;top:637.67px" class="cls_006"><span class="cls_006">performance (since it involves overwriting cached data with memory</span></div>
<div style="position:absolute;left:59.97px;top:648.67px" class="cls_006"><span class="cls_006">data the program may never use).</span></div>
<div style="position:absolute;left:59.97px;top:662.67px" class="cls_006"><span class="cls_006">As a general rule, the bigger the D-cache, the smaller the penalty for</span></div>
<div style="position:absolute;left:59.97px;top:673.67px" class="cls_006"><span class="cls_006">burst refills.</span></div>
<div style="position:absolute;left:48.02px;top:687.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:687.67px" class="cls_008"><span class="cls_008">Bigger I-cache in exchange for smaller D-cache (R3071/81)</span><span class="cls_006">: the R3081</span></div>
<div style="position:absolute;left:59.97px;top:698.67px" class="cls_006"><span class="cls_006">cache can be organized either with both I-cache and D-cache 8Kbytes</span></div>
<div style="position:absolute;left:59.97px;top:709.67px" class="cls_006"><span class="cls_006">in  size,  or  with  a</span></div>
<div style="position:absolute;left:167.32px;top:709.67px" class="cls_006"><span class="cls_006">16Kbyte  I-cache  and</span></div>
<div style="position:absolute;left:285.14px;top:709.67px" class="cls_006"><span class="cls_006">4Kbyte  D-cache.  The</span></div>
<div style="position:absolute;left:59.97px;top:720.67px" class="cls_006"><span class="cls_006">configuration is programmed using the AC bit in the </span><span class="cls_008">Config</span><span class="cls_006"> register.</span></div>
<div style="position:absolute;left:292.03px;top:755.33px" class="cls_002"><span class="cls_002">5-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:61754px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">CACHE MANAGEMENT</span></div>
<div style="position:absolute;left:524.86px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 5</span></div>
<div style="position:absolute;left:239.98px;top:50.67px" class="cls_006"><span class="cls_006">After changing the cache configuration both caches should be re-</span></div>
<div style="position:absolute;left:239.98px;top:61.67px" class="cls_006"><span class="cls_006">initialized, while running uncached. This means that most systems</span></div>
<div style="position:absolute;left:239.98px;top:72.67px" class="cls_006"><span class="cls_006">will not dynamically reconfigure the caches.</span></div>
<div style="position:absolute;left:239.98px;top:86.67px" class="cls_006"><span class="cls_006">Which configuration is best for a given system is mainly dependent on</span></div>
<div style="position:absolute;left:239.98px;top:97.67px" class="cls_006"><span class="cls_006">the software. Cache effects are extremely hard to predict, and it is</span></div>
<div style="position:absolute;left:239.98px;top:108.67px" class="cls_006"><span class="cls_006">recommended that both configurations be tried and measured, while</span></div>
<div style="position:absolute;left:239.98px;top:119.67px" class="cls_006"><span class="cls_006">running as much of the real system as possible.</span></div>
<div style="position:absolute;left:239.98px;top:133.67px" class="cls_006"><span class="cls_006">As a general rule: with large applications (like in a big OS) the big I-</span></div>
<div style="position:absolute;left:239.98px;top:144.67px" class="cls_006"><span class="cls_006">cache will probably be best. If the system spends most of its time</span></div>
<div style="position:absolute;left:239.98px;top:155.67px" class="cls_006"><span class="cls_006">manipulating lots of data from tight program loops, the big D-cache</span></div>
<div style="position:absolute;left:239.98px;top:166.67px" class="cls_006"><span class="cls_006">may be better.</span></div>
<div style="position:absolute;left:216.00px;top:189.00px" class="cls_015"><span class="cls_015">WRITE BUFFER</span></div>
<div style="position:absolute;left:228.02px;top:202.67px" class="cls_006"><span class="cls_006">The write-through cache common to all R30xx family CPUs can be a big</span></div>
<div style="position:absolute;left:216.00px;top:213.67px" class="cls_006"><span class="cls_006">performance bottleneck. In the average C program only about 10% of</span></div>
<div style="position:absolute;left:216.00px;top:224.67px" class="cls_006"><span class="cls_006">instructions are stores, but these accesses tend to come in bursts; for</span></div>
<div style="position:absolute;left:216.00px;top:235.67px" class="cls_006"><span class="cls_006">example, when a function prologue saves a few registers.</span></div>
<div style="position:absolute;left:228.02px;top:246.67px" class="cls_006"><span class="cls_006">DRAM memory frequently has the characteristic that the first write of a</span></div>
<div style="position:absolute;left:216.00px;top:257.67px" class="cls_006"><span class="cls_006">group takes quite a long time (5-10 clocks typical on these CPUs), and</span></div>
<div style="position:absolute;left:216.00px;top:268.67px" class="cls_006"><span class="cls_006">subsequent ones are relatively fast so long as they follow quickly.</span></div>
<div style="position:absolute;left:228.02px;top:279.67px" class="cls_006"><span class="cls_006">If the CPU simply waits for all writes to complete, the performance hit</span></div>
<div style="position:absolute;left:216.00px;top:290.67px" class="cls_006"><span class="cls_006">will be significant. So the R30xx provides a </span><span class="cls_008">write buffer</span><span class="cls_006">, a FIFO store which</span></div>
<div style="position:absolute;left:216.00px;top:301.67px" class="cls_006"><span class="cls_006">keeps a number of entries each containing both data to be written, and the</span></div>
<div style="position:absolute;left:216.00px;top:312.67px" class="cls_006"><span class="cls_006">address at which to write it. The 4-entry queue provided by R30xx family</span></div>
<div style="position:absolute;left:216.00px;top:323.67px" class="cls_006"><span class="cls_006">CPUs is efficient for well-tuned DRAM.</span></div>
<div style="position:absolute;left:228.02px;top:334.67px" class="cls_006"><span class="cls_006">In general, the operation of the write buffer is completely transparent to</span></div>
<div style="position:absolute;left:216.00px;top:345.67px" class="cls_006"><span class="cls_006">software. Occasionally, the programmer needs to be aware of what is</span></div>
<div style="position:absolute;left:216.00px;top:356.67px" class="cls_006"><span class="cls_006">happening:</span></div>
<div style="position:absolute;left:228.02px;top:370.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Timing relations for IO register accesses</span><span class="cls_006">: When software performs a</span></div>
<div style="position:absolute;left:239.97px;top:381.67px" class="cls_006"><span class="cls_006">store to write an IO register, the store reaches memory after a small,</span></div>
<div style="position:absolute;left:239.97px;top:392.67px" class="cls_006"><span class="cls_006">but indeterminate, delay. Some consequences are:</span></div>
<div style="position:absolute;left:239.97px;top:403.67px" class="cls_006"><span class="cls_006">— other  communication  with  the  IO  system  (e.g.  interrupts)  may</span></div>
<div style="position:absolute;left:251.99px;top:414.67px" class="cls_006"><span class="cls_006">happen more quickly - for example, the CPU may get an interrupt</span></div>
<div style="position:absolute;left:251.99px;top:425.67px" class="cls_006"><span class="cls_006">from a device ‘‘after’’ it has been programmed to generate no</span></div>
<div style="position:absolute;left:251.99px;top:436.67px" class="cls_006"><span class="cls_006">interrupts.</span></div>
<div style="position:absolute;left:239.97px;top:447.67px" class="cls_006"><span class="cls_006">— if the IO device needs some time to recover after a write the program</span></div>
<div style="position:absolute;left:251.99px;top:458.67px" class="cls_006"><span class="cls_006">must ensure that the write buffer FIFO is empty before counting</span></div>
<div style="position:absolute;left:251.99px;top:469.67px" class="cls_006"><span class="cls_006">out that time period.</span></div>
<div style="position:absolute;left:239.97px;top:480.67px" class="cls_006"><span class="cls_006">— at the end of interrupt service, when writing to an IO device to clear</span></div>
<div style="position:absolute;left:251.99px;top:491.67px" class="cls_006"><span class="cls_006">the  interrupt  it  is  asserting,  software  must  insure  that  the</span></div>
<div style="position:absolute;left:251.99px;top:502.67px" class="cls_006"><span class="cls_006">command is actually written to the device, and that it has had to</span></div>
<div style="position:absolute;left:251.99px;top:513.67px" class="cls_006"><span class="cls_006">respond, before re-enabling that interrupt; otherwise, spurious</span></div>
<div style="position:absolute;left:251.99px;top:524.67px" class="cls_006"><span class="cls_006">interrupts may be signalled.</span></div>
<div style="position:absolute;left:239.97px;top:538.67px" class="cls_006"><span class="cls_006">In these cases the programmer must ensure that the CPU waits while</span></div>
<div style="position:absolute;left:239.97px;top:549.67px" class="cls_006"><span class="cls_006">the write buffer empties. It is good practice to define a subroutine</span></div>
<div style="position:absolute;left:239.97px;top:560.67px" class="cls_006"><span class="cls_006">which does this job; it is traditionally called </span><span class="cls_008">wbflush()</span><span class="cls_006">. Hints on</span></div>
<div style="position:absolute;left:239.98px;top:571.67px" class="cls_006"><span class="cls_006">implementing this function are provided later in this chapter.</span></div>
<div style="position:absolute;left:228.03px;top:582.67px" class="cls_006"><span class="cls_006">On CPUs outside the R30xx family, even stranger things can happen:</span></div>
<div style="position:absolute;left:228.03px;top:596.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Reads overtaking writes</span><span class="cls_006">: a load instruction (uncached or missing in</span></div>
<div style="position:absolute;left:239.97px;top:607.67px" class="cls_006"><span class="cls_006">the cache) executed while the write buffer FIFO is not empty gives the</span></div>
<div style="position:absolute;left:239.97px;top:618.67px" class="cls_006"><span class="cls_006">CPU a choice: should it finish off the write, or use the memory</span></div>
<div style="position:absolute;left:239.97px;top:629.67px" class="cls_006"><span class="cls_006">interface to fetch data for the load?</span></div>
<div style="position:absolute;left:239.97px;top:643.67px" class="cls_006"><span class="cls_006">The R3041, R3051, R3052 and R3081 all have the same rule, which</span></div>
<div style="position:absolute;left:239.97px;top:654.67px" class="cls_006"><span class="cls_006">avoids potential problems: the write buffer is emptied before the load</span></div>
<div style="position:absolute;left:239.97px;top:665.67px" class="cls_006"><span class="cls_006">occurs.</span></div>
<div style="position:absolute;left:239.97px;top:679.67px" class="cls_006"><span class="cls_006">Although it seems tempting to instead implement a scheme which</span></div>
<div style="position:absolute;left:239.97px;top:690.67px" class="cls_006"><span class="cls_006">checks for conflicts, and allows the read to progress if no write buffer</span></div>
<div style="position:absolute;left:239.97px;top:701.67px" class="cls_006"><span class="cls_006">entry matches the read target address, such a scheme does not avoid</span></div>
<div style="position:absolute;left:239.97px;top:712.67px" class="cls_006"><span class="cls_006">the possible system problems. Specifically, writes to locations which</span></div>
<div style="position:absolute;left:305.78px;top:755.33px" class="cls_002"><span class="cls_002">5-9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:62556px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 5</span></div>
<div style="position:absolute;left:458.87px;top:28.00px" class="cls_002"><span class="cls_002">CACHE MANAGEMENT</span></div>
<div style="position:absolute;left:59.98px;top:50.67px" class="cls_006"><span class="cls_006">may have side effects (e.g. semaphores, IO registers, etc.), are not</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">detected under such a scheme, and can cause great headaches to the</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">programmer.</span></div>
<div style="position:absolute;left:48.03px;top:86.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Byte gathering</span><span class="cls_006">: some write buffers watch for partial-word writes</span></div>
<div style="position:absolute;left:59.98px;top:97.67px" class="cls_006"><span class="cls_006">within the same memory word, and will combine those partial writes</span></div>
<div style="position:absolute;left:59.98px;top:108.67px" class="cls_006"><span class="cls_006">into a single operation. This is not done by any current R30xx family</span></div>
<div style="position:absolute;left:59.98px;top:119.67px" class="cls_006"><span class="cls_006">CPU, because such operation would pose problems with IO register</span></div>
<div style="position:absolute;left:59.98px;top:130.67px" class="cls_006"><span class="cls_006">writes.</span></div>
<div style="position:absolute;left:36.00px;top:153.00px" class="cls_015"><span class="cls_015">Implementing </span><span class="cls_034">wbflush()</span></div>
<div style="position:absolute;left:48.02px;top:166.67px" class="cls_006"><span class="cls_006">IDT R30xx family CPUs enforce strict write priority (all pending writes</span></div>
<div style="position:absolute;left:36.00px;top:177.67px" class="cls_006"><span class="cls_006">retired to memory before main memory is read). Thus, implementing</span></div>
<div style="position:absolute;left:36.00px;top:188.67px" class="cls_008"><span class="cls_008">wbflush()</span><span class="cls_006"> is as simple as implementing an uncached load (e.g. from the</span></div>
<div style="position:absolute;left:36.01px;top:199.67px" class="cls_006"><span class="cls_006">boot PROM vector). This will stall the CPU until the writes have finished,</span></div>
<div style="position:absolute;left:36.01px;top:210.67px" class="cls_006"><span class="cls_006">and the load finished too. Alternately, the overhead can be minimized by</span></div>
<div style="position:absolute;left:36.01px;top:221.67px" class="cls_006"><span class="cls_006">performing an uncached load from the fastest memory available in the</span></div>
<div style="position:absolute;left:36.01px;top:232.67px" class="cls_006"><span class="cls_006">system.</span></div>
<div style="position:absolute;left:48.03px;top:243.67px" class="cls_006"><span class="cls_006">The code fragment below shows an implementation of WbFlush, taken</span></div>
<div style="position:absolute;left:36.01px;top:254.67px" class="cls_006"><span class="cls_006">from IDT/sim:</span></div>
<div style="position:absolute;left:72.00px;top:266.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:72.00px;top:276.00px" class="cls_028"><span class="cls_028">** wbflush() flush the write buffer - this is specific for each</span></div>
<div style="position:absolute;left:72.00px;top:286.00px" class="cls_028"><span class="cls_028">hardware</span></div>
<div style="position:absolute;left:72.00px;top:296.00px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:180.04px;top:296.00px" class="cls_028"><span class="cls_028">configuration.</span></div>
<div style="position:absolute;left:72.00px;top:306.00px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:72.00px;top:316.00px" class="cls_028"><span class="cls_028">FRAME(wbflush,sp,0,ra)</span></div>
<div style="position:absolute;left:108.00px;top:326.00px" class="cls_028"><span class="cls_028">.set noreorder</span></div>
<div style="position:absolute;left:108.00px;top:345.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.04px;top:345.99px" class="cls_028"><span class="cls_028">t0,wbflush#read an uncached memory location</span></div>
<div style="position:absolute;left:108.00px;top:355.99px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.04px;top:355.99px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:108.00px;top:365.99px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:108.00px;top:375.99px" class="cls_028"><span class="cls_028">.set reorder</span></div>
<div style="position:absolute;left:108.00px;top:385.99px" class="cls_028"><span class="cls_028">ENDFRAME(wbflush)</span></div>
<div style="position:absolute;left:289.79px;top:755.33px" class="cls_002"><span class="cls_002">5-10</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:63358px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">MEMORY MANAGEMENT AND</span></div>
<div style="position:absolute;left:491.33px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 6</span></div>
<div style="position:absolute;left:222.89px;top:56.33px" class="cls_005"><span class="cls_005">THE TLB</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:216.00px;top:113.00px" class="cls_015"><span class="cls_015">MEMORY MANAGEMENT AND THE TLB</span></div>
<div style="position:absolute;left:228.02px;top:126.67px" class="cls_006"><span class="cls_006">Some R30xx family processors (“E” versions) have on-chip memory</span></div>
<div style="position:absolute;left:216.00px;top:137.67px" class="cls_006"><span class="cls_006">management  hardware.  This  provides  a  mechanism  for  dynamically</span></div>
<div style="position:absolute;left:216.00px;top:148.67px" class="cls_006"><span class="cls_006">translating program addresses in the </span><span class="cls_008">kuseg</span><span class="cls_006"> and </span><span class="cls_008">kseg2</span><span class="cls_006"> regions. The key</span></div>
<div style="position:absolute;left:216.01px;top:159.67px" class="cls_006"><span class="cls_006">piece of hardware is the ‘‘TLB†’’.</span></div>
<div style="position:absolute;left:228.02px;top:170.67px" class="cls_006"><span class="cls_006">The memory management is </span><span class="cls_008">paged</span><span class="cls_006">: with a fixed page size of 4Kbytes.</span></div>
<div style="position:absolute;left:216.00px;top:181.67px" class="cls_006"><span class="cls_006">The low-order 12 bit of the program address are used directly as the low</span></div>
<div style="position:absolute;left:216.00px;top:192.67px" class="cls_006"><span class="cls_006">order bits of the physical address, so address translation operates in 4K</span></div>
<div style="position:absolute;left:216.00px;top:203.67px" class="cls_006"><span class="cls_006">chunks.</span></div>
<div style="position:absolute;left:228.02px;top:214.67px" class="cls_006"><span class="cls_006">The TLB is a 64-entry </span><span class="cls_008">associative memory</span><span class="cls_006">. Each entry in an associative</span></div>
<div style="position:absolute;left:216.00px;top:225.67px" class="cls_006"><span class="cls_006">memory consists of a key field and a data field; when presented with a key,</span></div>
<div style="position:absolute;left:216.00px;top:236.67px" class="cls_006"><span class="cls_006">the memory returns the data of any entry where the key matches.</span></div>
<div style="position:absolute;left:228.02px;top:247.67px" class="cls_006"><span class="cls_006">In the R30xx family, the TLB is referred to as ‘‘fully-associative’’; this</span></div>
<div style="position:absolute;left:216.00px;top:258.67px" class="cls_006"><span class="cls_006">emphasizes that all keys are really compared with the input value in</span></div>
<div style="position:absolute;left:216.00px;top:269.67px" class="cls_006"><span class="cls_006">parallel.</span></div>
<div style="position:absolute;left:228.02px;top:280.67px" class="cls_006"><span class="cls_006">The TLB’s key field contains two sections:</span></div>
<div style="position:absolute;left:228.02px;top:294.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:294.67px" class="cls_008"><span class="cls_008">Virtual page number</span><span class="cls_006">: (VPN) this is just a program address with the low</span></div>
<div style="position:absolute;left:239.98px;top:305.67px" class="cls_006"><span class="cls_006">12 bits cut off, since the low-order bits don’t participate in the</span></div>
<div style="position:absolute;left:239.98px;top:316.67px" class="cls_006"><span class="cls_006">translation process.</span></div>
<div style="position:absolute;left:228.03px;top:330.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:330.67px" class="cls_008"><span class="cls_008">Address Space Identifier. </span><span class="cls_006">(ASID): this is a magic number used to</span></div>
<div style="position:absolute;left:239.97px;top:341.67px" class="cls_006"><span class="cls_006">stamp translations, and (optionally) is compared with an extended</span></div>
<div style="position:absolute;left:239.97px;top:352.67px" class="cls_006"><span class="cls_006">part of the key. Why?</span></div>
<div style="position:absolute;left:239.97px;top:366.67px" class="cls_006"><span class="cls_006">In multi-tasking systems it is common to have all user-level tasks</span></div>
<div style="position:absolute;left:239.97px;top:377.67px" class="cls_006"><span class="cls_006">executing at the same sort of program addresses (though of course</span></div>
<div style="position:absolute;left:239.97px;top:388.67px" class="cls_006"><span class="cls_006">they are using different physical addresses); they are said to be using</span></div>
<div style="position:absolute;left:239.97px;top:399.67px" class="cls_006"><span class="cls_006">different </span><span class="cls_008">address spaces</span><span class="cls_006">. So translation records for different tasks</span></div>
<div style="position:absolute;left:239.98px;top:410.67px" class="cls_006"><span class="cls_006">will often share the same value of ‘‘VPN’’. If the TLB mechanism was</span></div>
<div style="position:absolute;left:239.98px;top:421.67px" class="cls_006"><span class="cls_006">not supported with an ASID, when the OS switches from one task to</span></div>
<div style="position:absolute;left:239.98px;top:432.67px" class="cls_006"><span class="cls_006">another, it would have to find and invalidate all TLB translations</span></div>
<div style="position:absolute;left:239.98px;top:443.67px" class="cls_006"><span class="cls_006">relating to the old task’s address space, to prevent them from being</span></div>
<div style="position:absolute;left:239.98px;top:454.67px" class="cls_006"><span class="cls_006">erroneously  used  for  the  new  one.  This  would  be  desperately</span></div>
<div style="position:absolute;left:239.98px;top:465.67px" class="cls_006"><span class="cls_006">inefficient.</span></div>
<div style="position:absolute;left:239.98px;top:479.67px" class="cls_006"><span class="cls_006">Instead, the OS assigns a 6-bit unique code to each task’s distinct</span></div>
<div style="position:absolute;left:239.98px;top:490.67px" class="cls_006"><span class="cls_006">address space. During normal running this code is kept in the ASID</span></div>
<div style="position:absolute;left:239.98px;top:501.67px" class="cls_006"><span class="cls_006">field of the </span><span class="cls_008">EntryHi</span><span class="cls_006"> register, and is used together with the program</span></div>
<div style="position:absolute;left:239.98px;top:512.67px" class="cls_006"><span class="cls_006">address to form the lookup key; so a translation with an ASID code</span></div>
<div style="position:absolute;left:239.98px;top:523.67px" class="cls_006"><span class="cls_006">which doesn’t match is quietly ignored.</span></div>
<div style="position:absolute;left:239.98px;top:537.67px" class="cls_006"><span class="cls_006">Since the ASID is only 6 bits long, OS software does have to lend a</span></div>
<div style="position:absolute;left:239.98px;top:548.67px" class="cls_006"><span class="cls_006">hand if there are ever more than 64 address spaces in concurrent use;</span></div>
<div style="position:absolute;left:239.98px;top:559.67px" class="cls_006"><span class="cls_006">but it probably won’t happen too often. In such a system, new tasks</span></div>
<div style="position:absolute;left:239.98px;top:570.67px" class="cls_006"><span class="cls_006">are assigned new ASIDs until all 64 are assigned; at that time, all</span></div>
<div style="position:absolute;left:239.98px;top:581.67px" class="cls_006"><span class="cls_006">tasks are flushed of their ASIDs “de-assigned” and the TLB flushed;</span></div>
<div style="position:absolute;left:239.98px;top:592.67px" class="cls_006"><span class="cls_006">as each task is re-entered, a new ASID is given. Thus, ASID flushing</span></div>
<div style="position:absolute;left:239.98px;top:603.67px" class="cls_006"><span class="cls_006">is relatively infrequent.</span></div>
<div style="position:absolute;left:228.03px;top:614.67px" class="cls_006"><span class="cls_006">The TLB data field includes:</span></div>
<div style="position:absolute;left:228.03px;top:628.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Physical frame number (PFN)</span><span class="cls_006">: the physical address with the low 12</span></div>
<div style="position:absolute;left:239.98px;top:639.67px" class="cls_006"><span class="cls_006">bits cut off. In an address translation, the VPN bits are replaced by</span></div>
<div style="position:absolute;left:239.98px;top:650.67px" class="cls_006"><span class="cls_006">the corresponding PFN bits to form the true physical address.</span></div>
<div style="position:absolute;left:228.03px;top:664.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Cache control bit (N)</span><span class="cls_006">: set 1 to make the page uncacheable.</span></div>
<div style="position:absolute;left:234.00px;top:710.67px" class="cls_006"><span class="cls_006">† This is an acronym for ‘‘translation lookaside buffer’’, which is a</span></div>
<div style="position:absolute;left:234.00px;top:722.67px" class="cls_006"><span class="cls_006">look-up table of virtual to physical address translations.</span></div>
<div style="position:absolute;left:299.28px;top:754.68px" class="cls_002"><span class="cls_002">6-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:64160px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 6</span></div>
<div style="position:absolute;left:385.41px;top:28.00px" class="cls_002"><span class="cls_002">MEMORY MANAGEMENT AND THE TLB</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Write control bit (D)</span><span class="cls_006">: set 1 to allow stores to this page to happen. The</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">‘‘D’’ comes from this being called the ‘‘dirty bit’’; a later section on</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">“Simulating dirty bits” describes a typical use for these bits.</span></div>
<div style="position:absolute;left:48.03px;top:86.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Valid bit (V)</span><span class="cls_006">: set 0 to make this entry usable. This seems pretty</span></div>
<div style="position:absolute;left:59.98px;top:97.67px" class="cls_006"><span class="cls_006">pointless; why have a record loaded into the TLB if the translation is</span></div>
<div style="position:absolute;left:59.98px;top:108.67px" class="cls_006"><span class="cls_006">not usable? But an access to an invalid page produces a different trap</span></div>
<div style="position:absolute;left:59.98px;top:119.67px" class="cls_006"><span class="cls_006">from a TLB refill exception, so making a page invalid means that some</span></div>
<div style="position:absolute;left:59.98px;top:130.67px" class="cls_006"><span class="cls_006">strange conditions can be made to take a different trap, which does</span></div>
<div style="position:absolute;left:59.98px;top:141.67px" class="cls_006"><span class="cls_006">not have to be handled by the superfast refill code.</span></div>
<div style="position:absolute;left:48.03px;top:155.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Global bit (G)</span><span class="cls_006">: set to disable the ASID-matching scheme, allowing an</span></div>
<div style="position:absolute;left:59.98px;top:166.67px" class="cls_006"><span class="cls_006">OS to map some program addresses to the same physical address for</span></div>
<div style="position:absolute;left:59.98px;top:177.67px" class="cls_006"><span class="cls_006">all tasks; it can be useful to have some corner of each address space</span></div>
<div style="position:absolute;left:59.98px;top:188.67px" class="cls_006"><span class="cls_006">mapped to the same physical locations. Sharp-eyed or experienced</span></div>
<div style="position:absolute;left:59.98px;top:199.67px" class="cls_006"><span class="cls_006">readers will notice that this means that the global bit is really more</span></div>
<div style="position:absolute;left:59.98px;top:210.67px" class="cls_006"><span class="cls_006">like part of the key than part of the data; the distinction tends to get</span></div>
<div style="position:absolute;left:59.98px;top:221.67px" class="cls_006"><span class="cls_006">blurred in associative memories.</span></div>
<div style="position:absolute;left:48.03px;top:243.67px" class="cls_006"><span class="cls_006">Translating an address is now simple, and goes like this:</span></div>
<div style="position:absolute;left:48.03px;top:257.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> CPU generates a program address</span><span class="cls_006">: either for an instruction fetch, a</span></div>
<div style="position:absolute;left:59.98px;top:268.67px" class="cls_006"><span class="cls_006">load or a store, in one of the translated address regions. The low 12</span></div>
<div style="position:absolute;left:59.98px;top:279.67px" class="cls_006"><span class="cls_006">bits are separated off, and the resulting VPN together with the current</span></div>
<div style="position:absolute;left:59.98px;top:290.67px" class="cls_006"><span class="cls_006">value of the ASID field in </span><span class="cls_008">EntryHi</span><span class="cls_006"> used as the key to the TLB.</span></div>
<div style="position:absolute;left:48.02px;top:304.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> TLB matches key</span><span class="cls_006">: selecting the matching entry. The PFN is glued to</span></div>
<div style="position:absolute;left:59.97px;top:315.67px" class="cls_006"><span class="cls_006">the low-order bits of the program address to form a complete physical</span></div>
<div style="position:absolute;left:59.97px;top:326.67px" class="cls_006"><span class="cls_006">address.</span></div>
<div style="position:absolute;left:48.02px;top:340.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Valid?</span><span class="cls_006">: the V and D bits are consulted. If it isn’t valid, or a store is</span></div>
<div style="position:absolute;left:59.98px;top:351.67px" class="cls_006"><span class="cls_006">being attempted with D cleared, the CPU takes a trap. As with all</span></div>
<div style="position:absolute;left:59.98px;top:362.67px" class="cls_006"><span class="cls_006">translation  traps,  the </span><span class="cls_008"> BadVaddr</span><span class="cls_006">  register  will  be  filled  with  the</span></div>
<div style="position:absolute;left:59.98px;top:373.67px" class="cls_006"><span class="cls_006">offending program address and TLB registers </span><span class="cls_008">Context</span><span class="cls_006"> and </span><span class="cls_008">EntryHi</span></div>
<div style="position:absolute;left:59.98px;top:384.67px" class="cls_006"><span class="cls_006">pre-filled with relevant information. The system software can use</span></div>
<div style="position:absolute;left:59.98px;top:395.67px" class="cls_006"><span class="cls_006">these registers to obtain data for exception service.</span></div>
<div style="position:absolute;left:48.03px;top:409.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Cached?</span><span class="cls_006">: if the N bit is set the CPU looks in the cache for a copy of</span></div>
<div style="position:absolute;left:59.97px;top:420.67px" class="cls_006"><span class="cls_006">the physical location’s data; if it isn’t there it will be fetched from</span></div>
<div style="position:absolute;left:59.97px;top:431.67px" class="cls_006"><span class="cls_006">memory and a copy left in the cache. Where the C bit is clear the CPU</span></div>
<div style="position:absolute;left:59.97px;top:442.67px" class="cls_006"><span class="cls_006">neither looks in nor refills the cache.</span></div>
<div style="position:absolute;left:48.02px;top:453.67px" class="cls_006"><span class="cls_006">Of course, there are only</span></div>
<div style="position:absolute;left:188.57px;top:453.67px" class="cls_006"><span class="cls_006">64 entries in the TLB, which can hold</span></div>
<div style="position:absolute;left:36.00px;top:464.67px" class="cls_006"><span class="cls_006">translations for a maximum of 256 Kbytes of program addresses. This is</span></div>
<div style="position:absolute;left:36.00px;top:475.67px" class="cls_006"><span class="cls_006">far short of enough for most systems. The TLB is almost always going to be</span></div>
<div style="position:absolute;left:36.00px;top:486.67px" class="cls_006"><span class="cls_006">used  as  a  software-maintained</span></div>
<div style="position:absolute;left:210.40px;top:486.67px" class="cls_006"><span class="cls_006">‘‘cache’’  for  a  much  larger  set  of</span></div>
<div style="position:absolute;left:36.00px;top:497.67px" class="cls_006"><span class="cls_006">translations.</span></div>
<div style="position:absolute;left:48.02px;top:508.67px" class="cls_006"><span class="cls_006">When a program address lookup in the TLB fails, a </span><span class="cls_008">TLB refill</span><span class="cls_006"> trap is</span></div>
<div style="position:absolute;left:36.00px;top:519.67px" class="cls_006"><span class="cls_006">taken. System software has the job of:</span></div>
<div style="position:absolute;left:48.02px;top:533.67px" class="cls_006"><span class="cls_006">• figuring out whether there is a correct translation; if not the trap will</span></div>
<div style="position:absolute;left:59.97px;top:544.67px" class="cls_006"><span class="cls_006">be dispatched to the software which handles address errors.</span></div>
<div style="position:absolute;left:48.02px;top:558.67px" class="cls_006"><span class="cls_006">• if there is a correct translation, constructing a TLB entry which will</span></div>
<div style="position:absolute;left:59.97px;top:569.67px" class="cls_006"><span class="cls_006">implement it;</span></div>
<div style="position:absolute;left:48.02px;top:583.67px" class="cls_006"><span class="cls_006">• if the TLB is already full (and it almost always is full in running</span></div>
<div style="position:absolute;left:59.97px;top:594.67px" class="cls_006"><span class="cls_006">systems), selecting an entry which can be discarded;</span></div>
<div style="position:absolute;left:48.02px;top:608.67px" class="cls_006"><span class="cls_006">• writing the new entry into the TLB.</span></div>
<div style="position:absolute;left:292.03px;top:755.33px" class="cls_002"><span class="cls_002">6-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:64962px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MEMORY MANAGEMENT AND THE TLB</span></div>
<div style="position:absolute;left:525.16px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 6</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">See below for how this can be tackled; but note here that although</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">special   CPU   features   help   out   with   one   particular   class   of</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_006"><span class="cls_006">implementations, the software can refill the TLB any way it likes.</span></div>
<div style="position:absolute;left:225.08px;top:95.00px" class="cls_020"><span class="cls_020">Register</span></div>
<div style="position:absolute;left:378.78px;top:95.00px" class="cls_020"><span class="cls_020">Description</span></div>
<div style="position:absolute;left:548.41px;top:95.00px" class="cls_020"><span class="cls_020">CP0</span></div>
<div style="position:absolute;left:220.06px;top:105.00px" class="cls_020"><span class="cls_020">Mnemonic</span></div>
<div style="position:absolute;left:542.84px;top:105.00px" class="cls_020"><span class="cls_020">reg no</span></div>
<div style="position:absolute;left:218.47px;top:124.00px" class="cls_020"><span class="cls_020">EntryHi</span></div>
<div style="position:absolute;left:278.57px;top:124.00px" class="cls_020"><span class="cls_020">Together these registers hold a TLB entry. All reads and</span></div>
<div style="position:absolute;left:541.27px;top:124.00px" class="cls_020"><span class="cls_020">10</span></div>
<div style="position:absolute;left:278.42px;top:134.00px" class="cls_020"><span class="cls_020">writes to the TLB must be staged through them.</span></div>
<div style="position:absolute;left:218.47px;top:141.00px" class="cls_020"><span class="cls_020">EntryLo</span></div>
<div style="position:absolute;left:278.42px;top:144.00px" class="cls_020"><span class="cls_020">EntryHi also remembers the current ASID.</span></div>
<div style="position:absolute;left:541.41px;top:141.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:218.47px;top:161.00px" class="cls_020"><span class="cls_020">Index</span></div>
<div style="position:absolute;left:278.53px;top:161.00px" class="cls_020"><span class="cls_020">Determines which TLB entry will be read/written by</span></div>
<div style="position:absolute;left:541.27px;top:161.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:278.42px;top:171.00px" class="cls_020"><span class="cls_020">appropriate instructions</span></div>
<div style="position:absolute;left:218.47px;top:188.00px" class="cls_020"><span class="cls_020">Random</span></div>
<div style="position:absolute;left:278.58px;top:188.00px" class="cls_020"><span class="cls_020">pseudo-random value (actually a free-running counter)</span></div>
<div style="position:absolute;left:541.27px;top:188.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:278.42px;top:198.00px" class="cls_020"><span class="cls_020">used by a </span><span class="cls_027">tlbwr</span><span class="cls_020"> to write a new TLB entry into a ‘‘randomly’’</span></div>
<div style="position:absolute;left:278.41px;top:208.00px" class="cls_020"><span class="cls_020">selected location.</span></div>
<div style="position:absolute;left:218.46px;top:225.00px" class="cls_020"><span class="cls_020">Context</span></div>
<div style="position:absolute;left:278.56px;top:225.00px" class="cls_020"><span class="cls_020">Convenience register provided to speed up the processing</span></div>
<div style="position:absolute;left:541.27px;top:224.99px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:278.41px;top:235.00px" class="cls_020"><span class="cls_020">of TLB refill traps. The high-order bits are read/write; the</span></div>
<div style="position:absolute;left:278.41px;top:245.00px" class="cls_020"><span class="cls_020">low-order 21 bits reflect the </span><span class="cls_027">BadVaddr </span><span class="cls_020">value.</span></div>
<div style="position:absolute;left:278.41px;top:255.00px" class="cls_020"><span class="cls_020">(The register is designed so that, if the system uses the</span></div>
<div style="position:absolute;left:278.41px;top:265.00px" class="cls_020"><span class="cls_020">‘‘favored’’ arrangement of memory-held copies of memory</span></div>
<div style="position:absolute;left:278.41px;top:275.00px" class="cls_020"><span class="cls_020">translation records, it will be setup by a TLB refill trap to</span></div>
<div style="position:absolute;left:278.41px;top:285.00px" class="cls_020"><span class="cls_020">point to the memory location of the record needed to map</span></div>
<div style="position:absolute;left:278.41px;top:294.99px" class="cls_020"><span class="cls_020">the offending address. This speeds up the process of</span></div>
<div style="position:absolute;left:278.41px;top:304.99px" class="cls_020"><span class="cls_020">finding the current memory mapping, and arranging</span></div>
<div style="position:absolute;left:278.41px;top:314.99px" class="cls_020"><span class="cls_020">EntryHi/Lo properly).</span></div>
<div style="position:absolute;left:259.95px;top:334.00px" class="cls_020"><span class="cls_020">Table 6.1.  CPU control registers for memory management</span></div>
<div style="position:absolute;left:216.00px;top:355.00px" class="cls_015"><span class="cls_015">MMU registers described</span></div>
<div style="position:absolute;left:216.00px;top:378.67px" class="cls_006"><span class="cls_006">EntryHi, EntryLo</span></div>
<div style="position:absolute;left:220.00px;top:410.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:370.20px;top:410.00px" class="cls_020"><span class="cls_020">12</span></div>
<div style="position:absolute;left:400.12px;top:410.00px" class="cls_020"><span class="cls_020">11</span></div>
<div style="position:absolute;left:492.30px;top:410.00px" class="cls_020"><span class="cls_020">6</span></div>
<div style="position:absolute;left:517.21px;top:410.00px" class="cls_020"><span class="cls_020">5</span></div>
<div style="position:absolute;left:564.61px;top:410.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:220.00px;top:427.00px" class="cls_020"><span class="cls_020">VPN</span></div>
<div style="position:absolute;left:400.09px;top:427.00px" class="cls_020"><span class="cls_020">ASID</span></div>
<div style="position:absolute;left:517.20px;top:427.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:220.00px;top:444.00px" class="cls_020"><span class="cls_020">EntryHi Register (TLB key fields)</span></div>
<div style="position:absolute;left:283.69px;top:463.00px" class="cls_020"><span class="cls_020">Figure 6.1.   EntryHi and EntryLo register fields</span></div>
<div style="position:absolute;left:220.00px;top:499.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:369.25px;top:499.00px" class="cls_020"><span class="cls_020">12</span></div>
<div style="position:absolute;left:398.97px;top:499.00px" class="cls_020"><span class="cls_020">11</span></div>
<div style="position:absolute;left:428.70px;top:499.00px" class="cls_020"><span class="cls_020">10</span></div>
<div style="position:absolute;left:458.43px;top:499.00px" class="cls_020"><span class="cls_020">9</span></div>
<div style="position:absolute;left:481.59px;top:499.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:505.97px;top:499.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:558.18px;top:499.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:220.00px;top:516.00px" class="cls_020"><span class="cls_020">PFN</span></div>
<div style="position:absolute;left:398.94px;top:516.00px" class="cls_020"><span class="cls_020">N</span></div>
<div style="position:absolute;left:428.65px;top:516.00px" class="cls_020"><span class="cls_020">D</span></div>
<div style="position:absolute;left:458.36px;top:516.00px" class="cls_020"><span class="cls_020">V</span></div>
<div style="position:absolute;left:481.52px;top:516.00px" class="cls_020"><span class="cls_020">G</span></div>
<div style="position:absolute;left:505.90px;top:516.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:220.00px;top:533.00px" class="cls_020"><span class="cls_020">EntryLo Register (TLB data fields)</span></div>
<div style="position:absolute;left:283.69px;top:552.00px" class="cls_020"><span class="cls_020">Figure 6.2.   EntryHi and EntryLo register fields</span></div>
<div style="position:absolute;left:228.02px;top:567.67px" class="cls_006"><span class="cls_006">These two registers represent a TLB entry, and are best considered as a</span></div>
<div style="position:absolute;left:216.00px;top:578.67px" class="cls_006"><span class="cls_006">pair. Fields in </span><span class="cls_008">EntryHi</span><span class="cls_006"> are:</span></div>
<div style="position:absolute;left:228.02px;top:592.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> VPN</span><span class="cls_006">: ‘‘virtual page number’’, the high-order bits of a program address.</span></div>
<div style="position:absolute;left:239.98px;top:603.67px" class="cls_006"><span class="cls_006">On a refill exception this field is set up automatically to match the</span></div>
<div style="position:absolute;left:239.98px;top:614.67px" class="cls_006"><span class="cls_006">program address which could not be translated. To write a different</span></div>
<div style="position:absolute;left:239.98px;top:625.67px" class="cls_006"><span class="cls_006">TLB  entry,  or  attempt  a  TLB  probe,  software  must  set  it  up</span></div>
<div style="position:absolute;left:239.98px;top:636.67px" class="cls_006"><span class="cls_006">“manually”.</span></div>
<div style="position:absolute;left:228.03px;top:650.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> ASID</span><span class="cls_006">: ‘‘address space identifier’’, normally left holding the OS’ value</span></div>
<div style="position:absolute;left:239.98px;top:661.67px" class="cls_006"><span class="cls_006">for the current address space. This is not changed by exceptions.</span></div>
<div style="position:absolute;left:239.98px;top:672.67px" class="cls_006"><span class="cls_006">Most software systems will deliberately write this field only to setup</span></div>
<div style="position:absolute;left:239.98px;top:683.67px" class="cls_006"><span class="cls_006">the current address space.</span></div>
<div style="position:absolute;left:239.98px;top:697.67px" class="cls_006"><span class="cls_006">However, software must be careful when using </span><span class="cls_008">tlbr</span><span class="cls_006"> to inspect TLB</span></div>
<div style="position:absolute;left:239.98px;top:708.67px" class="cls_006"><span class="cls_006">entries; the operation overwrites the whole of </span><span class="cls_008">EntryHi,</span><span class="cls_006"> so software</span></div>
<div style="position:absolute;left:239.97px;top:719.67px" class="cls_006"><span class="cls_006">needs to restore the correct current ASID value afterwards.</span></div>
<div style="position:absolute;left:305.78px;top:755.33px" class="cls_002"><span class="cls_002">6-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:65764px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 6</span></div>
<div style="position:absolute;left:385.42px;top:28.00px" class="cls_002"><span class="cls_002">MEMORY MANAGEMENT AND THE TLB</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">Fields in </span><span class="cls_008">EntryLo</span><span class="cls_006"> are:</span></div>
<div style="position:absolute;left:48.03px;top:64.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> PFN</span><span class="cls_006">: the high-order bits of the physical address to which values</span></div>
<div style="position:absolute;left:59.98px;top:75.67px" class="cls_006"><span class="cls_006">matching </span><span class="cls_008">EntryHi’s</span><span class="cls_006"> VPN will be translated.</span></div>
<div style="position:absolute;left:48.02px;top:89.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> N</span><span class="cls_006">:</span></div>
<div style="position:absolute;left:80.71px;top:89.67px" class="cls_006"><span class="cls_006">‘‘noncacheable’’;</span></div>
<div style="position:absolute;left:169.21px;top:89.67px" class="cls_006"><span class="cls_006">0   to   make   the   access   cacheable,</span></div>
<div style="position:absolute;left:367.21px;top:89.67px" class="cls_006"><span class="cls_006">1   for</span></div>
<div style="position:absolute;left:59.98px;top:100.67px" class="cls_006"><span class="cls_006">uncacheable.</span></div>
<div style="position:absolute;left:48.03px;top:114.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> D</span><span class="cls_006">: ‘‘dirty’’, but really a write-enable bit. 1 to allow writes, 0 and any</span></div>
<div style="position:absolute;left:59.98px;top:125.67px" class="cls_006"><span class="cls_006">store using this translation will be trapped.</span></div>
<div style="position:absolute;left:48.03px;top:139.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> V</span><span class="cls_006">:</span></div>
<div style="position:absolute;left:77.58px;top:139.67px" class="cls_006"><span class="cls_006">‘‘valid’’, if</span></div>
<div style="position:absolute;left:132.52px;top:139.67px" class="cls_006"><span class="cls_006">0 any address matching this entry will cause an</span></div>
<div style="position:absolute;left:59.98px;top:150.67px" class="cls_006"><span class="cls_006">exception.</span></div>
<div style="position:absolute;left:48.03px;top:164.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> G</span><span class="cls_006">: ‘‘global’’. When the G bit in a TLB entry is set, that TLB entry will</span></div>
<div style="position:absolute;left:59.98px;top:175.67px" class="cls_006"><span class="cls_006">match solely on the VPN field, regardless of whether the TLB entry’s</span></div>
<div style="position:absolute;left:59.98px;top:186.67px" class="cls_006"><span class="cls_006">ASID field matches the value in </span><span class="cls_008">EntryHi.</span></div>
<div style="position:absolute;left:48.02px;top:200.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Fields called ‘‘0’’</span><span class="cls_006">: these fields always return zero; but unlike many</span></div>
<div style="position:absolute;left:59.98px;top:211.67px" class="cls_006"><span class="cls_006">reserved fields, they do not need to be written as zero (nothing</span></div>
<div style="position:absolute;left:59.98px;top:222.67px" class="cls_006"><span class="cls_006">happens regardless of the data written). This is important; it means</span></div>
<div style="position:absolute;left:59.98px;top:233.67px" class="cls_006"><span class="cls_006">that the memory-resident data which is used to generate </span><span class="cls_008">EntryLo</span></div>
<div style="position:absolute;left:59.98px;top:244.67px" class="cls_006"><span class="cls_006">when refilling the TLB can contain some software-interpreted data in</span></div>
<div style="position:absolute;left:59.98px;top:255.67px" class="cls_006"><span class="cls_006">these fields, which the TLB hardware will ignore without the need to</span></div>
<div style="position:absolute;left:59.98px;top:266.67px" class="cls_006"><span class="cls_006">spend precious CPU cycles masking it.</span></div>
<div style="position:absolute;left:36.00px;top:287.67px" class="cls_006"><span class="cls_006">Index</span></div>
<div style="position:absolute;left:40.00px;top:319.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:64.79px;top:319.00px" class="cls_020"><span class="cls_020">30</span></div>
<div style="position:absolute;left:189.19px;top:319.00px" class="cls_020"><span class="cls_020">14</span></div>
<div style="position:absolute;left:213.98px;top:319.00px" class="cls_020"><span class="cls_020">13</span></div>
<div style="position:absolute;left:288.66px;top:319.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:307.17px;top:319.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:381.83px;top:319.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:40.00px;top:336.00px" class="cls_020"><span class="cls_020">P</span></div>
<div style="position:absolute;left:64.73px;top:336.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:213.82px;top:336.00px" class="cls_020"><span class="cls_020">Index</span></div>
<div style="position:absolute;left:306.90px;top:336.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:122.79px;top:355.00px" class="cls_020"><span class="cls_020">Figure 6.3.   Fields in the Index register</span></div>
<div style="position:absolute;left:48.02px;top:370.67px" class="cls_006"><span class="cls_006">The ‘‘P’’ field is set when a </span><span class="cls_008">tlbp</span><span class="cls_006"> instruction (tlb probe, used to see if the</span></div>
<div style="position:absolute;left:36.00px;top:381.67px" class="cls_006"><span class="cls_006">TLB can translate a particular VPN) failed to find a valid translation; since</span></div>
<div style="position:absolute;left:36.00px;top:392.67px" class="cls_006"><span class="cls_006">it is the top bit it appears to make the 32-bit value negative, which is easy</span></div>
<div style="position:absolute;left:36.00px;top:403.67px" class="cls_006"><span class="cls_006">to test for.</span></div>
<div style="position:absolute;left:36.00px;top:424.67px" class="cls_006"><span class="cls_006">Random</span></div>
<div style="position:absolute;left:40.00px;top:456.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:173.58px;top:456.00px" class="cls_020"><span class="cls_020">14</span></div>
<div style="position:absolute;left:200.19px;top:456.00px" class="cls_020"><span class="cls_020">13</span></div>
<div style="position:absolute;left:280.38px;top:456.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:300.25px;top:456.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:380.42px;top:456.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:40.00px;top:473.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:200.09px;top:473.00px" class="cls_020"><span class="cls_020">Random</span></div>
<div style="position:absolute;left:300.04px;top:473.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:116.51px;top:492.00px" class="cls_020"><span class="cls_020">Figure 6.4.   Fields in the Random register</span></div>
<div style="position:absolute;left:48.02px;top:507.67px" class="cls_006"><span class="cls_006">Most systems never have to read or write the </span><span class="cls_008">Random</span><span class="cls_006"> register, shown as</span></div>
<div style="position:absolute;left:36.00px;top:518.67px" class="cls_006"><span class="cls_006">Figure 6.4, “Fields in the Random register”, in normal use; but it may be</span></div>
<div style="position:absolute;left:36.00px;top:529.67px" class="cls_006"><span class="cls_006">useful for diagnostics. The hardware initializes the </span><span class="cls_008">Random</span><span class="cls_006"> field to its</span></div>
<div style="position:absolute;left:36.00px;top:540.67px" class="cls_006"><span class="cls_006">maximum value (63) on reset, and it decrements every clock period until it</span></div>
<div style="position:absolute;left:36.00px;top:551.67px" class="cls_006"><span class="cls_006">reaches 8, when it wraps back to 63 and starts again.</span></div>
<div style="position:absolute;left:36.00px;top:572.67px" class="cls_006"><span class="cls_006">Context</span></div>
<div style="position:absolute;left:40.00px;top:604.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:130.30px;top:604.00px" class="cls_020"><span class="cls_020">21</span></div>
<div style="position:absolute;left:162.98px;top:604.00px" class="cls_020"><span class="cls_020">20</span></div>
<div style="position:absolute;left:327.08px;top:604.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:351.48px;top:604.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:375.88px;top:604.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:40.00px;top:621.00px" class="cls_020"><span class="cls_020">PTEBase</span></div>
<div style="position:absolute;left:163.03px;top:621.00px" class="cls_020"><span class="cls_020">Bad VPN</span></div>
<div style="position:absolute;left:351.61px;top:621.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:115.75px;top:640.00px" class="cls_020"><span class="cls_020">Figure 6.5.   Fields in the Context Register</span></div>
<div style="position:absolute;left:48.02px;top:655.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> PTEBase</span><span class="cls_006">: a location which just stores what is put in it. In the</span></div>
<div style="position:absolute;left:59.98px;top:666.67px" class="cls_006"><span class="cls_006">‘‘standard’’ refill handler, this will be the high-order bits of the</span></div>
<div style="position:absolute;left:59.98px;top:677.67px" class="cls_006"><span class="cls_006">(1Mbyte aligned) starting address of a memory-resident page table.</span></div>
<div style="position:absolute;left:48.03px;top:691.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Bad VPN</span><span class="cls_006">: following an addressing exception this holds the high-order</span></div>
<div style="position:absolute;left:59.97px;top:702.67px" class="cls_006"><span class="cls_006">bits of the address; exactly the same as the high-order bits of</span></div>
<div style="position:absolute;left:59.98px;top:713.67px" class="cls_008"><span class="cls_008">BadVaddr.</span><span class="cls_006"> However, if the system uses the ‘‘standard’’ TLB refill</span></div>
<div style="position:absolute;left:292.03px;top:755.33px" class="cls_002"><span class="cls_002">6-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:66566px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MEMORY MANAGEMENT AND THE TLB</span></div>
<div style="position:absolute;left:525.16px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 6</span></div>
<div style="position:absolute;left:239.98px;top:50.67px" class="cls_006"><span class="cls_006">exception handling code the 32-bit value formed by </span><span class="cls_008">Context</span><span class="cls_006"> is directly</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">usable as a pointer to the memory-resident page table, considerably</span></div>
<div style="position:absolute;left:239.97px;top:72.67px" class="cls_006"><span class="cls_006">shortening the refill exception code.</span></div>
<div style="position:absolute;left:228.02px;top:86.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Fields marked 0</span><span class="cls_006">: can be written with any value, but they will always</span></div>
<div style="position:absolute;left:239.97px;top:97.67px" class="cls_006"><span class="cls_006">read zero.</span></div>
<div style="position:absolute;left:216.00px;top:120.00px" class="cls_015"><span class="cls_015">MMU control instructions</span></div>
<div style="position:absolute;left:216.00px;top:133.67px" class="cls_006"><span class="cls_006">tlbr</span></div>
<div style="position:absolute;left:288.00px;top:133.67px" class="cls_008"><span class="cls_008">-</span></div>
<div style="position:absolute;left:360.00px;top:133.67px" class="cls_008"><span class="cls_008">Read TLB entry at index</span></div>
<div style="position:absolute;left:216.00px;top:155.67px" class="cls_006"><span class="cls_006">tlbwi</span></div>
<div style="position:absolute;left:288.00px;top:155.67px" class="cls_008"><span class="cls_008">-</span></div>
<div style="position:absolute;left:360.00px;top:155.67px" class="cls_008"><span class="cls_008">Write TLB entry at index</span></div>
<div style="position:absolute;left:243.00px;top:166.67px" class="cls_006"><span class="cls_006">The above two instructions move MMU data between the TLB entry</span></div>
<div style="position:absolute;left:243.00px;top:177.67px" class="cls_006"><span class="cls_006">selected by the </span><span class="cls_008">Index </span><span class="cls_006">register and the </span><span class="cls_008">EntryHi</span><span class="cls_006"> and </span><span class="cls_008">EntryLo</span><span class="cls_006"> registers.</span></div>
<div style="position:absolute;left:216.00px;top:188.67px" class="cls_006"><span class="cls_006">tlbwr</span></div>
<div style="position:absolute;left:288.00px;top:188.67px" class="cls_008"><span class="cls_008">-</span></div>
<div style="position:absolute;left:360.00px;top:188.67px" class="cls_008"><span class="cls_008">Write TLB entry selected by Random</span></div>
<div style="position:absolute;left:243.00px;top:199.67px" class="cls_006"><span class="cls_006">copies the contents of </span><span class="cls_008">EntryHi</span><span class="cls_006"> & </span><span class="cls_008">EntryLo</span><span class="cls_006"> into the TLB entry indexed</span></div>
<div style="position:absolute;left:243.00px;top:210.67px" class="cls_006"><span class="cls_006">by   the </span><span class="cls_008">  random</span><span class="cls_006">   register.   This   saves   time   when   using   the</span></div>
<div style="position:absolute;left:243.00px;top:221.67px" class="cls_006"><span class="cls_006">recommended random replacement policy. In practice, </span><span class="cls_008">tlbwr</span><span class="cls_006"> will be</span></div>
<div style="position:absolute;left:243.00px;top:232.67px" class="cls_006"><span class="cls_006">used to write a new TLB entry in a TLB refill exception handler; </span><span class="cls_008">tlbwi</span></div>
<div style="position:absolute;left:243.00px;top:243.67px" class="cls_006"><span class="cls_006">will be used anywhere else.</span></div>
<div style="position:absolute;left:216.00px;top:254.67px" class="cls_006"><span class="cls_006">tlbp</span></div>
<div style="position:absolute;left:288.00px;top:254.67px" class="cls_008"><span class="cls_008">-</span></div>
<div style="position:absolute;left:360.00px;top:254.67px" class="cls_008"><span class="cls_008">TLB lookup</span></div>
<div style="position:absolute;left:243.00px;top:265.67px" class="cls_006"><span class="cls_006">searches (probes) the TLB for an entry whose virtual page number</span></div>
<div style="position:absolute;left:243.00px;top:276.67px" class="cls_006"><span class="cls_006">and ASID matches those currently in</span><span class="cls_008"> EntryHi</span><span class="cls_006">, and stores the index</span></div>
<div style="position:absolute;left:243.00px;top:287.67px" class="cls_006"><span class="cls_006">of that entry in the </span><span class="cls_008">index</span><span class="cls_006"> register (</span><span class="cls_008">index</span><span class="cls_006"> is set to a negative value if</span></div>
<div style="position:absolute;left:243.00px;top:298.67px" class="cls_006"><span class="cls_006">nothing matches). If more than one entry matches, anything might</span></div>
<div style="position:absolute;left:243.00px;top:309.67px" class="cls_006"><span class="cls_006">happen. Note that </span><span class="cls_008">tlbp</span><span class="cls_006"> does not fetch data from the TLB. The</span></div>
<div style="position:absolute;left:243.00px;top:320.67px" class="cls_006"><span class="cls_006">instruction following a </span><span class="cls_008">tlbp</span><span class="cls_006"> must not be a load or store.</span></div>
<div style="position:absolute;left:216.00px;top:343.00px" class="cls_015"><span class="cls_015">Programming interface to the TLB</span></div>
<div style="position:absolute;left:228.02px;top:356.67px" class="cls_006"><span class="cls_006">TLB entries are set up by writing the required fields into </span><span class="cls_008">EntryHi</span><span class="cls_006"> and</span></div>
<div style="position:absolute;left:216.00px;top:367.67px" class="cls_008"><span class="cls_008">EntryLo</span><span class="cls_006"> and using a </span><span class="cls_008">tlbwr</span><span class="cls_006"> or </span><span class="cls_008">tlbwi</span><span class="cls_006"> instruction to copy that entry into the</span></div>
<div style="position:absolute;left:216.00px;top:378.67px" class="cls_006"><span class="cls_006">TLB proper.</span></div>
<div style="position:absolute;left:228.02px;top:389.67px" class="cls_006"><span class="cls_006">When  handling  a  TLB  refill  exception, </span><span class="cls_008"> EntryHi</span><span class="cls_006">  has  been  set  up</span></div>
<div style="position:absolute;left:215.99px;top:400.67px" class="cls_006"><span class="cls_006">automatically, with the current ASID and the required VPN.</span></div>
<div style="position:absolute;left:228.01px;top:411.67px" class="cls_006"><span class="cls_006">Be very careful not to create two entries which will match the same</span></div>
<div style="position:absolute;left:215.99px;top:422.67px" class="cls_006"><span class="cls_006">program address/ASID pair. If the TLB contains duplicate entries an</span></div>
<div style="position:absolute;left:215.99px;top:433.67px" class="cls_006"><span class="cls_006">attempt to translate such an address, or probe for it, produces a fatal ‘‘TLB</span></div>
<div style="position:absolute;left:215.99px;top:444.67px" class="cls_006"><span class="cls_006">shutdown’’ condition (indicated by the TS bit in </span><span class="cls_008">SR</span><span class="cls_006"> being set). It can be</span></div>
<div style="position:absolute;left:215.99px;top:455.67px" class="cls_006"><span class="cls_006">cleared only by a hardware reset.</span></div>
<div style="position:absolute;left:228.01px;top:466.67px" class="cls_006"><span class="cls_006">System software often won’t need to read TLB entries at all. But if</span></div>
<div style="position:absolute;left:215.99px;top:477.67px" class="cls_006"><span class="cls_006">necessary, software can find the TLB entry matching some particular</span></div>
<div style="position:absolute;left:215.99px;top:488.67px" class="cls_006"><span class="cls_006">program address using </span><span class="cls_008">tlbp</span><span class="cls_006"> to setup the </span><span class="cls_008">Index</span><span class="cls_006"> register. Don’t forget to save</span></div>
<div style="position:absolute;left:215.99px;top:499.67px" class="cls_008"><span class="cls_008">EntryHi</span><span class="cls_006"> and restore it afterwards because its ASID field is likely to be</span></div>
<div style="position:absolute;left:215.99px;top:510.67px" class="cls_006"><span class="cls_006">important.</span></div>
<div style="position:absolute;left:228.01px;top:521.67px" class="cls_006"><span class="cls_006">Use a </span><span class="cls_008">tlbr</span><span class="cls_006"> to read the TLB entry into </span><span class="cls_008">EntryHi</span><span class="cls_006"> and </span><span class="cls_008">EntryLo.</span></div>
<div style="position:absolute;left:215.98px;top:542.67px" class="cls_006"><span class="cls_006">How refill happens</span></div>
<div style="position:absolute;left:228.00px;top:553.67px" class="cls_006"><span class="cls_006">When a program makes an access in kuseg or kseg2 to a page for which</span></div>
<div style="position:absolute;left:215.98px;top:564.67px" class="cls_006"><span class="cls_006">no translation record is present, the CPU takes a TLB refill exception. The</span></div>
<div style="position:absolute;left:215.98px;top:575.67px" class="cls_006"><span class="cls_006">assumption is that system software is maintaining a large number of page</span></div>
<div style="position:absolute;left:215.98px;top:586.67px" class="cls_006"><span class="cls_006">translations and is using the TLB as a cache of recently-used translations;</span></div>
<div style="position:absolute;left:215.98px;top:597.67px" class="cls_006"><span class="cls_006">so the refill exception will normally be handled by finding a correct</span></div>
<div style="position:absolute;left:215.98px;top:608.67px" class="cls_006"><span class="cls_006">translation, installing it, and returning to user code.</span></div>
<div style="position:absolute;left:228.00px;top:619.67px" class="cls_006"><span class="cls_006">In ‘‘CISC’’ CPUs the TLB is a cache (usually implemented by microcode),</span></div>
<div style="position:absolute;left:215.98px;top:630.67px" class="cls_006"><span class="cls_006">and the CPU automatically reads memory-resident ‘‘page tables’’ whose</span></div>
<div style="position:absolute;left:215.98px;top:641.67px" class="cls_006"><span class="cls_006">structure is part of the CPU architecture.</span></div>
<div style="position:absolute;left:228.00px;top:652.67px" class="cls_006"><span class="cls_006">In the MIPS architecture software is fast enough, and offers greater</span></div>
<div style="position:absolute;left:215.98px;top:663.67px" class="cls_006"><span class="cls_006">flexibility.</span></div>
<div style="position:absolute;left:228.00px;top:674.67px" class="cls_006"><span class="cls_006">To save time on user-program TLB refill exceptions (which will happen</span></div>
<div style="position:absolute;left:215.98px;top:685.67px" class="cls_006"><span class="cls_006">frequently in a ‘‘big’’ OS):</span></div>
<div style="position:absolute;left:228.00px;top:699.67px" class="cls_006"><span class="cls_006">• refill exceptions on kuseg program addresses are vectored through a</span></div>
<div style="position:absolute;left:239.95px;top:710.67px" class="cls_006"><span class="cls_006">low-memory address used for no other exception;</span></div>
<div style="position:absolute;left:305.78px;top:755.33px" class="cls_002"><span class="cls_002">6-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:67368px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 6</span></div>
<div style="position:absolute;left:385.42px;top:28.00px" class="cls_002"><span class="cls_002">MEMORY MANAGEMENT AND THE TLB</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">• special exception rules permit the kuseg refill handler to risk a nested</span></div>
<div style="position:absolute;left:59.97px;top:61.67px" class="cls_006"><span class="cls_006">TLB refill exception on a kseg2 address.</span></div>
<div style="position:absolute;left:59.97px;top:75.67px" class="cls_006"><span class="cls_006">The problem is that before an exception routine can itself suffer an</span></div>
<div style="position:absolute;left:59.97px;top:86.67px" class="cls_006"><span class="cls_006">exception it must first save the previous program state, represented</span></div>
<div style="position:absolute;left:59.97px;top:97.67px" class="cls_006"><span class="cls_006">by the </span><span class="cls_008">EPC</span><span class="cls_006"> return address and some </span><span class="cls_008">SR</span><span class="cls_006"> bits. This is helped out by a</span></div>
<div style="position:absolute;left:59.97px;top:108.67px" class="cls_006"><span class="cls_006">hardware feature and a software convention:</span></div>
<div style="position:absolute;left:48.02px;top:122.67px" class="cls_006"><span class="cls_006">a)</span></div>
<div style="position:absolute;left:84.02px;top:122.67px" class="cls_006"><span class="cls_006">the KUo, IEo bits in the status register act as a third level of the</span></div>
<div style="position:absolute;left:84.02px;top:133.67px" class="cls_006"><span class="cls_006">processor-state stack, so that the CPU state already saved as a</span></div>
<div style="position:absolute;left:84.02px;top:144.67px" class="cls_006"><span class="cls_006">result of the kuseg refill exception can be preserved during the</span></div>
<div style="position:absolute;left:84.02px;top:155.67px" class="cls_006"><span class="cls_006">nested exception.</span></div>
<div style="position:absolute;left:48.02px;top:169.67px" class="cls_006"><span class="cls_006">b)</span></div>
<div style="position:absolute;left:84.02px;top:169.67px" class="cls_006"><span class="cls_006">The kuseg refill handler copies </span><span class="cls_008">EPC</span><span class="cls_006"> into the </span><span class="cls_008">k1</span><span class="cls_006"> register; the</span></div>
<div style="position:absolute;left:84.03px;top:180.67px" class="cls_006"><span class="cls_006">general exception code and kseg2 refill handler are then careful</span></div>
<div style="position:absolute;left:84.03px;top:191.67px" class="cls_006"><span class="cls_006">to preserve its value, enabling a clean return.</span></div>
<div style="position:absolute;left:48.03px;top:202.67px" class="cls_006"><span class="cls_006">Refill exceptions on kseg2 addresses are expected to be rare enough that</span></div>
<div style="position:absolute;left:36.01px;top:213.67px" class="cls_006"><span class="cls_006">it will not matter if they share in the overhead of the ‘‘all other exceptions’’</span></div>
<div style="position:absolute;left:36.01px;top:224.67px" class="cls_006"><span class="cls_006">entry point. However, once software determines the type of exception the</span></div>
<div style="position:absolute;left:36.01px;top:235.67px" class="cls_006"><span class="cls_006">handling is similar.</span></div>
<div style="position:absolute;left:36.01px;top:256.67px" class="cls_006"><span class="cls_006">Using ASIDs</span></div>
<div style="position:absolute;left:48.03px;top:267.67px" class="cls_006"><span class="cls_006">By setting up TLB entries with a particular ASID setting and with the</span></div>
<div style="position:absolute;left:36.01px;top:278.67px" class="cls_008"><span class="cls_008">EntryLo</span><span class="cls_006"> G bit zero, those entries will only ever match a program address</span></div>
<div style="position:absolute;left:36.01px;top:289.67px" class="cls_006"><span class="cls_006">when the CPU’s </span><span class="cls_008">ASID</span><span class="cls_006"> register is set the same. This allows software to map</span></div>
<div style="position:absolute;left:36.02px;top:300.67px" class="cls_006"><span class="cls_006">up to 64 different address spaces simultaneously, without requiring that</span></div>
<div style="position:absolute;left:36.02px;top:311.67px" class="cls_006"><span class="cls_006">the OS clear out the TLB on a context change.</span></div>
<div style="position:absolute;left:48.04px;top:322.67px" class="cls_006"><span class="cls_006">In typical usage, new tasks are assigned an “un-initialized” ASID. The</span></div>
<div style="position:absolute;left:36.02px;top:333.67px" class="cls_006"><span class="cls_006">first time the task is invoked, it will presumably miss in the TLB, allowing</span></div>
<div style="position:absolute;left:36.02px;top:344.67px" class="cls_006"><span class="cls_006">the assignment of an ASID. If the system does run out of new ASIDs, it will</span></div>
<div style="position:absolute;left:36.02px;top:355.67px" class="cls_006"><span class="cls_006">flush the TLB and mark all tasks as “new”. Thus, as each task is re-</span></div>
<div style="position:absolute;left:36.02px;top:366.67px" class="cls_006"><span class="cls_006">entered, it will be assigned a new ASID. This sequence is expected to</span></div>
<div style="position:absolute;left:36.02px;top:377.67px" class="cls_006"><span class="cls_006">happen infrequently if ever.</span></div>
<div style="position:absolute;left:36.02px;top:398.67px" class="cls_006"><span class="cls_006">The Random register and wired entries</span></div>
<div style="position:absolute;left:48.04px;top:409.67px" class="cls_006"><span class="cls_006">The hardware offers no way of finding out which TLB entries have been</span></div>
<div style="position:absolute;left:36.02px;top:420.67px" class="cls_006"><span class="cls_006">used  most  recently.  When  the  system  needs  to  replace  a  mapping</span></div>
<div style="position:absolute;left:36.02px;top:431.67px" class="cls_006"><span class="cls_006">dynamically (using the TLB as a cache) the only practicable strategy is to</span></div>
<div style="position:absolute;left:36.02px;top:442.67px" class="cls_006"><span class="cls_006">replace an entry at random. The CPU makes this easy by maintaining the</span></div>
<div style="position:absolute;left:36.02px;top:453.67px" class="cls_008"><span class="cls_008">Random</span><span class="cls_006"> register, which counts (down) with every processor cycle.</span></div>
<div style="position:absolute;left:48.04px;top:464.67px" class="cls_006"><span class="cls_006">However,  it  is  often  useful  to  have  some  TLB  entries  which  are</span></div>
<div style="position:absolute;left:36.02px;top:475.67px" class="cls_006"><span class="cls_006">guaranteed to stay there unless explicitly removed. These may be useful to</span></div>
<div style="position:absolute;left:36.02px;top:486.67px" class="cls_006"><span class="cls_006">map pages which are known to be required very often; they are critical</span></div>
<div style="position:absolute;left:36.02px;top:497.67px" class="cls_006"><span class="cls_006">because they allow the system to map pages and </span><span class="cls_008">guarantee</span><span class="cls_006"> that no refill</span></div>
<div style="position:absolute;left:36.03px;top:508.67px" class="cls_006"><span class="cls_006">exception will be generated on them.</span></div>
<div style="position:absolute;left:48.05px;top:519.67px" class="cls_006"><span class="cls_006">The stable TLB entries are described as ‘‘wired’’ and on R30xx family</span></div>
<div style="position:absolute;left:36.03px;top:530.67px" class="cls_006"><span class="cls_006">CPUs consist of TLB entries 0 through 7. There is nothing special about</span></div>
<div style="position:absolute;left:36.03px;top:541.67px" class="cls_006"><span class="cls_006">these entries; the magic is in the </span><span class="cls_008">Random</span><span class="cls_006"> register, which never takes</span></div>
<div style="position:absolute;left:36.02px;top:552.67px" class="cls_006"><span class="cls_006">values 0-7; it cycles directly from 63 down to 8 before reloading with 63.</span></div>
<div style="position:absolute;left:36.02px;top:563.67px" class="cls_006"><span class="cls_006">So conventional random replacement leaves TLB entries 0 through 7</span></div>
<div style="position:absolute;left:36.02px;top:574.67px" class="cls_006"><span class="cls_006">unaffected, and entries written there will stay until explicitly removed.</span></div>
<div style="position:absolute;left:36.00px;top:597.00px" class="cls_015"><span class="cls_015">Memory translation - setup</span></div>
<div style="position:absolute;left:48.02px;top:610.67px" class="cls_006"><span class="cls_006">The following code fragment initializes the TLB to ensure no match on</span></div>
<div style="position:absolute;left:36.00px;top:621.67px" class="cls_006"><span class="cls_006">any kuseg or kseg2 address. This is important, and is preferable to</span></div>
<div style="position:absolute;left:36.00px;top:632.67px" class="cls_006"><span class="cls_006">initializing with all “0”’s (which is a kuseg address, and which would cause</span></div>
<div style="position:absolute;left:36.00px;top:643.67px" class="cls_006"><span class="cls_006">multiple matches if referenced):</span></div>
<div style="position:absolute;left:72.00px;top:665.00px" class="cls_028"><span class="cls_028">LEAF(mips_init_tlb)</span></div>
<div style="position:absolute;left:108.00px;top:675.00px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:144.09px;top:675.00px" class="cls_028"><span class="cls_028">t0,C0_ENTRYHI # save asid</span></div>
<div style="position:absolute;left:108.00px;top:685.00px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:685.00px" class="cls_028"><span class="cls_028">zero,C0_ENTRYLO# tlblo = !valid</span></div>
<div style="position:absolute;left:108.00px;top:695.00px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:695.00px" class="cls_028"><span class="cls_028">a1,NTLBID&lt;&lt;TLBIDX_SHIFT # index</span></div>
<div style="position:absolute;left:108.00px;top:704.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:704.99px" class="cls_028"><span class="cls_028">a0,KSEG1_BASE # tlbhi = impossible vpn</span></div>
<div style="position:absolute;left:108.00px;top:724.99px" class="cls_028"><span class="cls_028">.set noreorder</span></div>
<div style="position:absolute;left:292.03px;top:755.34px" class="cls_002"><span class="cls_002">6-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:68170px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MEMORY MANAGEMENT AND THE TLB</span></div>
<div style="position:absolute;left:525.16px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 6</span></div>
<div style="position:absolute;left:252.00px;top:51.00px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:288.05px;top:51.00px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:324.14px;top:51.00px" class="cls_028"><span class="cls_028">a1,1&lt;&lt;TLBIDX_SHIFT</span></div>
<div style="position:absolute;left:288.00px;top:61.00px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:61.00px" class="cls_028"><span class="cls_028">a0,C0_ENTRYHI</span></div>
<div style="position:absolute;left:288.00px;top:71.00px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:71.00px" class="cls_028"><span class="cls_028">a1,C0_INDEX</span></div>
<div style="position:absolute;left:288.00px;top:81.00px" class="cls_028"><span class="cls_028">bnez</span></div>
<div style="position:absolute;left:324.09px;top:81.00px" class="cls_028"><span class="cls_028">a1,1b</span></div>
<div style="position:absolute;left:288.00px;top:91.00px" class="cls_028"><span class="cls_028">tlbwi</span></div>
<div style="position:absolute;left:432.11px;top:91.00px" class="cls_028"><span class="cls_028"># BDSLOT</span></div>
<div style="position:absolute;left:288.00px;top:101.00px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:101.00px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:288.00px;top:120.99px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:120.99px" class="cls_028"><span class="cls_028">t0,C0_ENTRYHI # restore asid</span></div>
<div style="position:absolute;left:288.00px;top:130.99px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.02px;top:130.99px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:252.00px;top:140.99px" class="cls_028"><span class="cls_028">END(mips_init_tlb)</span></div>
<div style="position:absolute;left:216.00px;top:172.00px" class="cls_015"><span class="cls_015">TLB exception sample code</span></div>
<div style="position:absolute;left:228.02px;top:185.67px" class="cls_006"><span class="cls_006">There are two examples provided. The first is written in C, and assumes</span></div>
<div style="position:absolute;left:216.00px;top:196.67px" class="cls_006"><span class="cls_006">that the OS provides a low-level handler which saves state, including</span></div>
<div style="position:absolute;left:216.00px;top:207.67px" class="cls_006"><span class="cls_006">copying  the  exception  registers  into  an</span></div>
<div style="position:absolute;left:432.46px;top:207.67px" class="cls_006"><span class="cls_006">‘‘xcpcontext’’  structure,  and</span></div>
<div style="position:absolute;left:216.00px;top:218.67px" class="cls_006"><span class="cls_006">dispatches through programmable tables to a C routine:</span></div>
<div style="position:absolute;left:216.00px;top:239.67px" class="cls_006"><span class="cls_006">Basic exception handler</span></div>
<div style="position:absolute;left:252.00px;top:261.00px" class="cls_028"><span class="cls_028">/* install C exception handler for TLB miss exception */</span></div>
<div style="position:absolute;left:252.00px;top:271.00px" class="cls_028"><span class="cls_028">xcption (XCPTTLBMISS, tlbmiss);</span></div>
<div style="position:absolute;left:252.00px;top:310.99px" class="cls_028"><span class="cls_028">#define VMPGSHIFT12/* convert address to page number */</span></div>
<div style="position:absolute;left:252.00px;top:330.99px" class="cls_028"><span class="cls_028">tlbmiss (int code, struct xcptcontext *xcp)</span></div>
<div style="position:absolute;left:252.00px;top:340.99px" class="cls_028"><span class="cls_028">{</span></div>
<div style="position:absolute;left:257.40px;top:350.99px" class="cls_028"><span class="cls_028">unsigned pfn = map_virt_to_phys (xcp->vaddr) >> VMPGSHIFT;</span></div>
<div style="position:absolute;left:257.40px;top:360.99px" class="cls_028"><span class="cls_028">unsigned vpn = xcp->vaddr >> VMPGSHIFT;</span></div>
<div style="position:absolute;left:257.40px;top:370.99px" class="cls_028"><span class="cls_028">unsigned asid = 0;</span></div>
<div style="position:absolute;left:257.40px;top:390.99px" class="cls_028"><span class="cls_028">/* write a random tlb (entryhi, entrylo) pair */</span></div>
<div style="position:absolute;left:256.08px;top:400.99px" class="cls_028"><span class="cls_028">/* mark it valid, global, uncached, and not writable/dirty */</span></div>
<div style="position:absolute;left:256.08px;top:410.98px" class="cls_028"><span class="cls_028">r3k_tlbwr ((vpn &lt;&lt;TLBHI_VPNSHIFT) | (asid &lt;&lt;TLBHI_PIDSHIFT),</span></div>
<div style="position:absolute;left:293.40px;top:420.98px" class="cls_028"><span class="cls_028">(pfn &lt;&lt;TLBLO_PFNSHIFT) | TLB_V | TLB_G | TLB_N);</span></div>
<div style="position:absolute;left:257.40px;top:430.98px" class="cls_028"><span class="cls_028">return 0;</span></div>
<div style="position:absolute;left:252.00px;top:440.98px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:228.02px;top:460.67px" class="cls_006"><span class="cls_006">The macro (or routine) </span><span class="cls_008">map_virt_to_phys</span><span class="cls_006">() which does the actual work,</span></div>
<div style="position:absolute;left:215.99px;top:471.67px" class="cls_006"><span class="cls_006">will be system dependent.</span></div>
<div style="position:absolute;left:215.99px;top:492.67px" class="cls_006"><span class="cls_006">Fast kuseg refill from page table</span></div>
<div style="position:absolute;left:228.01px;top:503.67px" class="cls_006"><span class="cls_006">This routine implements the translation mechanism which the MIPS</span></div>
<div style="position:absolute;left:215.99px;top:514.67px" class="cls_006"><span class="cls_006">architects had in mind for user addresses in a Unix-like OS. It relies upon</span></div>
<div style="position:absolute;left:215.99px;top:525.67px" class="cls_006"><span class="cls_006">building a page table in memory, for each address space. The page table</span></div>
<div style="position:absolute;left:215.99px;top:536.67px" class="cls_006"><span class="cls_006">consists of a linear array of one-word entries, indexed by the VPN, whose</span></div>
<div style="position:absolute;left:215.99px;top:547.67px" class="cls_006"><span class="cls_006">format is matched to the bitfields of the </span><span class="cls_008">EntryLo</span><span class="cls_006"> register.</span></div>
<div style="position:absolute;left:228.01px;top:558.67px" class="cls_006"><span class="cls_006">Such a scheme is simple, but has one problem. Since each 4Kbytes of</span></div>
<div style="position:absolute;left:215.99px;top:569.67px" class="cls_006"><span class="cls_006">user address space takes 4 bytes of table space, the entire 2Gbyte user</span></div>
<div style="position:absolute;left:215.99px;top:580.67px" class="cls_006"><span class="cls_006">space needs a 2Mbyte table, which is a large chunk of data. Moreover,</span></div>
<div style="position:absolute;left:215.99px;top:591.67px" class="cls_006"><span class="cls_006">most user address spaces are used at the bottom (for code and data) and</span></div>
<div style="position:absolute;left:215.99px;top:602.67px" class="cls_006"><span class="cls_006">at the top (for a downward growing stack) with a huge gap in between. The</span></div>
<div style="position:absolute;left:215.99px;top:613.67px" class="cls_006"><span class="cls_006">solution adopted is inspired by Digital’s VAX architecture, and is to locate</span></div>
<div style="position:absolute;left:215.99px;top:624.67px" class="cls_006"><span class="cls_006">the page table itself in virtual memory, in the kseg2 region. This neatly</span></div>
<div style="position:absolute;left:215.99px;top:635.67px" class="cls_006"><span class="cls_006">solves two problems at once:</span></div>
<div style="position:absolute;left:228.01px;top:649.67px" class="cls_006"><span class="cls_006">• saves physical memory, since the unused gap in the middle of the</span></div>
<div style="position:absolute;left:239.96px;top:660.67px" class="cls_006"><span class="cls_006">page table will never be referenced.</span></div>
<div style="position:absolute;left:228.01px;top:674.67px" class="cls_006"><span class="cls_006">• provides an easy mechanism for remapping a new user page table</span></div>
<div style="position:absolute;left:239.96px;top:685.67px" class="cls_006"><span class="cls_006">when  changing  context,  without  having  to  find  enough  virtual</span></div>
<div style="position:absolute;left:239.96px;top:696.67px" class="cls_006"><span class="cls_006">addresses in the OS to map all the page tables at once.</span></div>
<div style="position:absolute;left:305.78px;top:755.34px" class="cls_002"><span class="cls_002">6-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:68972px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 6</span></div>
<div style="position:absolute;left:385.42px;top:28.00px" class="cls_002"><span class="cls_002">MEMORY MANAGEMENT AND THE TLB</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">The MIPS architecture gives positive support to this mechanism in the</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_006"><span class="cls_006">form of the </span><span class="cls_008">Context</span><span class="cls_006"> register. If the page table starts at a 1Mbyte boundary</span></div>
<div style="position:absolute;left:36.00px;top:72.67px" class="cls_006"><span class="cls_006">(since it is in virtual memory, any gap created won’t use up physical</span></div>
<div style="position:absolute;left:36.00px;top:83.67px" class="cls_006"><span class="cls_006">memory space) and the </span><span class="cls_008">Context</span><span class="cls_006"> PTEBase field is filled with the high-order</span></div>
<div style="position:absolute;left:36.00px;top:94.67px" class="cls_006"><span class="cls_006">bits of the page table starting address, then following a user refill exception</span></div>
<div style="position:absolute;left:36.00px;top:105.67px" class="cls_006"><span class="cls_006">the </span><span class="cls_008">Context</span><span class="cls_006"> register will contain the address of the entry needed for the</span></div>
<div style="position:absolute;left:36.00px;top:116.67px" class="cls_006"><span class="cls_006">refill, with no further calculation.</span></div>
<div style="position:absolute;left:48.02px;top:127.67px" class="cls_006"><span class="cls_006">The resulting routine looks like this:</span></div>
<div style="position:absolute;left:108.00px;top:149.00px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:149.00px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:108.00px;top:159.00px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:159.00px" class="cls_028"><span class="cls_028">noat</span></div>
<div style="position:absolute;left:72.00px;top:169.00px" class="cls_028"><span class="cls_028">xcpt_vecfastutlb:</span></div>
<div style="position:absolute;left:108.00px;top:179.00px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:144.09px;top:179.00px" class="cls_028"><span class="cls_028">k1,C0_CONTEXT</span></div>
<div style="position:absolute;left:108.00px;top:189.00px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:144.09px;top:189.00px" class="cls_028"><span class="cls_028">k0,C0_EPC</span></div>
<div style="position:absolute;left:216.30px;top:189.00px" class="cls_028"><span class="cls_028"># mfc0 delay slot</span></div>
<div style="position:absolute;left:108.00px;top:198.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:198.99px" class="cls_028"><span class="cls_028">k1,0(k1)</span></div>
<div style="position:absolute;left:216.23px;top:198.99px" class="cls_028"><span class="cls_028"># may double fault (k0 = orig EPC)</span></div>
<div style="position:absolute;left:108.00px;top:208.99px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:108.00px;top:218.99px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:218.99px" class="cls_028"><span class="cls_028">k1,C0_ENTRYLO</span></div>
<div style="position:absolute;left:108.00px;top:228.99px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:108.00px;top:238.99px" class="cls_028"><span class="cls_028">tlbwr</span></div>
<div style="position:absolute;left:108.00px;top:248.99px" class="cls_028"><span class="cls_028">jr</span></div>
<div style="position:absolute;left:144.05px;top:248.99px" class="cls_028"><span class="cls_028">k0</span></div>
<div style="position:absolute;left:108.00px;top:258.99px" class="cls_028"><span class="cls_028">rfe</span></div>
<div style="position:absolute;left:72.00px;top:268.99px" class="cls_028"><span class="cls_028">xcpt_endfastutlb:</span></div>
<div style="position:absolute;left:108.00px;top:278.99px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:278.99px" class="cls_028"><span class="cls_028">at</span></div>
<div style="position:absolute;left:108.00px;top:288.99px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:288.99px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:36.00px;top:320.00px" class="cls_015"><span class="cls_015">Simulating dirty bits</span></div>
<div style="position:absolute;left:48.02px;top:333.67px" class="cls_006"><span class="cls_006">An operating system providing a page for an application program to use</span></div>
<div style="position:absolute;left:36.00px;top:344.67px" class="cls_006"><span class="cls_006">often wants to keep track of whether that page has been modified since the</span></div>
<div style="position:absolute;left:36.00px;top:355.67px" class="cls_006"><span class="cls_006">OS last obtained it (perhaps from disc or network) or saved a copy of it.</span></div>
<div style="position:absolute;left:36.00px;top:366.67px" class="cls_006"><span class="cls_006">Non-modified pages are cheap to discard, since they can easily be replaced</span></div>
<div style="position:absolute;left:36.00px;top:377.67px" class="cls_006"><span class="cls_006">if required.</span></div>
<div style="position:absolute;left:48.02px;top:388.67px" class="cls_006"><span class="cls_006">In OS parlance such modified pages are called ‘‘dirty’’ and the OS must</span></div>
<div style="position:absolute;left:36.00px;top:399.67px" class="cls_006"><span class="cls_006">take care of them until the application program exits, or the dirty page</span></div>
<div style="position:absolute;left:36.00px;top:410.67px" class="cls_006"><span class="cls_006">saved away to backing store.</span></div>
<div style="position:absolute;left:48.02px;top:421.67px" class="cls_006"><span class="cls_006">To help out with this process it is common for CISC CPUs to maintain a</span></div>
<div style="position:absolute;left:36.00px;top:432.67px" class="cls_006"><span class="cls_006">bit in the memory-resident page table indicating that a write operation to</span></div>
<div style="position:absolute;left:36.00px;top:443.67px" class="cls_006"><span class="cls_006">the page has occurred.</span></div>
<div style="position:absolute;left:48.02px;top:454.67px" class="cls_006"><span class="cls_006">The MIPS CPU does not directly implement this feature, even in the TLB</span></div>
<div style="position:absolute;left:36.00px;top:465.67px" class="cls_006"><span class="cls_006">entries. The ‘‘D’’ bit of the page table (found in the </span><span class="cls_008">EntryLo</span><span class="cls_006"> register) is a</span></div>
<div style="position:absolute;left:36.00px;top:476.67px" class="cls_006"><span class="cls_006">write-enable, and is of course used to flag read-only pages.</span></div>
<div style="position:absolute;left:48.02px;top:487.67px" class="cls_006"><span class="cls_006">To simulate “dirty” bits, the OS should mark new pages (in the page</span></div>
<div style="position:absolute;left:36.00px;top:498.67px" class="cls_006"><span class="cls_006">table) with D clear. Since the CPU will consider that page “write-protected”,</span></div>
<div style="position:absolute;left:36.00px;top:509.67px" class="cls_006"><span class="cls_006">a trap will result when the page is first modified; system software can</span></div>
<div style="position:absolute;left:36.00px;top:520.67px" class="cls_006"><span class="cls_006">identify this as a legitimate write but use the event to set a ‘‘modified’’ bit</span></div>
<div style="position:absolute;left:36.00px;top:531.67px" class="cls_006"><span class="cls_006">in the memory resident tables (it will also want to set the D bit in the TLB</span></div>
<div style="position:absolute;left:36.00px;top:542.67px" class="cls_006"><span class="cls_006">entry so that the write can proceed, but since TLB entries are randomly</span></div>
<div style="position:absolute;left:36.00px;top:553.67px" class="cls_006"><span class="cls_006">and unpredictably replaced this would be useless as a way of remembering</span></div>
<div style="position:absolute;left:36.00px;top:564.67px" class="cls_006"><span class="cls_006">the modified state).</span></div>
<div style="position:absolute;left:36.00px;top:587.00px" class="cls_015"><span class="cls_015">USE OF TLB IN DEBUGGING</span></div>
<div style="position:absolute;left:48.02px;top:600.67px" class="cls_006"><span class="cls_006">In systems which do not require the TLB for normal execution, it still</span></div>
<div style="position:absolute;left:36.00px;top:611.67px" class="cls_006"><span class="cls_006">may prove useful during initial system debug. Although its use for this</span></div>
<div style="position:absolute;left:36.00px;top:622.67px" class="cls_006"><span class="cls_006">purpose will be system dependent, some general ideas follow:</span></div>
<div style="position:absolute;left:48.02px;top:636.67px" class="cls_006"><span class="cls_006">• To hit a “trap” when software “wanders into the weeds” (e.g. makes</span></div>
<div style="position:absolute;left:59.97px;top:647.67px" class="cls_006"><span class="cls_006">mysterious references or instruction fetches from strange memory</span></div>
<div style="position:absolute;left:59.97px;top:658.67px" class="cls_006"><span class="cls_006">locations), software can initialize the TLB with only those mappings</span></div>
<div style="position:absolute;left:59.97px;top:669.67px" class="cls_006"><span class="cls_006">which correspond to valid program addresses. Thus, a TLB trap will</span></div>
<div style="position:absolute;left:59.97px;top:680.67px" class="cls_006"><span class="cls_006">occur in the exact instruction which makes the reference, and full</span></div>
<div style="position:absolute;left:59.97px;top:691.67px" class="cls_006"><span class="cls_006">processor state will be visible.</span></div>
<div style="position:absolute;left:292.03px;top:755.34px" class="cls_002"><span class="cls_002">6-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:69774px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MEMORY MANAGEMENT AND THE TLB</span></div>
<div style="position:absolute;left:525.16px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 6</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">• To identify which task or subroutine is modifying a particular memory</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">location, that location can be “write-protected”, generating a trap on</span></div>
<div style="position:absolute;left:239.97px;top:72.67px" class="cls_006"><span class="cls_006">store.</span></div>
<div style="position:absolute;left:228.02px;top:83.67px" class="cls_006"><span class="cls_006">The TLB may have one additional consequence in debugging. In a virtual</span></div>
<div style="position:absolute;left:216.00px;top:94.67px" class="cls_006"><span class="cls_006">memory OS, the actual physical memory location of a task (or even of</span></div>
<div style="position:absolute;left:216.00px;top:105.67px" class="cls_006"><span class="cls_006">portions of the OS) can move around as memory is paged. This can make</span></div>
<div style="position:absolute;left:216.00px;top:116.67px" class="cls_006"><span class="cls_006">low-level debugging difficult, since one cannot set a logic analyzer to trap</span></div>
<div style="position:absolute;left:216.00px;top:127.67px" class="cls_006"><span class="cls_006">on the right physical address.</span></div>
<div style="position:absolute;left:228.02px;top:138.67px" class="cls_006"><span class="cls_006">To resolve this situation, software can utilize a system specific “NOP”</span></div>
<div style="position:absolute;left:216.00px;top:149.67px" class="cls_006"><span class="cls_006">instruction. Recall that updates to the zero register $0 will be ignored;</span></div>
<div style="position:absolute;left:216.00px;top:160.67px" class="cls_006"><span class="cls_006">software can use this fact to generate a specific NOP instruction for the</span></div>
<div style="position:absolute;left:216.00px;top:171.67px" class="cls_006"><span class="cls_006">reference in question; the logic analyzer can then be used to search for this</span></div>
<div style="position:absolute;left:216.00px;top:182.67px" class="cls_006"><span class="cls_006">particular instruction fetch, correctly identifying the current virtual to</span></div>
<div style="position:absolute;left:216.00px;top:193.67px" class="cls_006"><span class="cls_006">physical mapping.</span></div>
<div style="position:absolute;left:216.00px;top:216.00px" class="cls_015"><span class="cls_015">TLB MANAGEMENT UTILITIES</span></div>
<div style="position:absolute;left:228.02px;top:229.67px" class="cls_006"><span class="cls_006">The following routines implement the most common TLB management</span></div>
<div style="position:absolute;left:216.00px;top:240.67px" class="cls_006"><span class="cls_006">functions. These code fragments are taken from IDT/sim.</span></div>
<div style="position:absolute;left:252.00px;top:252.00px" class="cls_028"><span class="cls_028">/*  Functions dealing with the TLB.</span></div>
<div style="position:absolute;left:252.00px;top:262.00px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:288.07px;top:262.00px" class="cls_028"><span class="cls_028">Use resettlb() defined here and called from excepthand.c</span></div>
<div style="position:absolute;left:252.00px;top:272.00px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:288.05px;top:272.00px" class="cls_028"><span class="cls_028">to initialize tlb.</span></div>
<div style="position:absolute;left:252.00px;top:282.00px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.00px;top:301.99px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:252.00px;top:311.99px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:288.05px;top:311.99px" class="cls_028"><span class="cls_028">idttlb.s - fetch the registers associated with and the</span></div>
<div style="position:absolute;left:252.00px;top:321.99px" class="cls_028"><span class="cls_028">contents</span></div>
<div style="position:absolute;left:252.00px;top:331.99px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:340.25px;top:331.99px" class="cls_028"><span class="cls_028">of the tlb.</span></div>
<div style="position:absolute;left:252.00px;top:341.99px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:252.00px;top:351.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.00px;top:361.99px" class="cls_028"><span class="cls_028">#include "iregdef.h"</span></div>
<div style="position:absolute;left:252.00px;top:371.99px" class="cls_028"><span class="cls_028">#include "idtcpu.h"</span></div>
<div style="position:absolute;left:252.00px;top:381.99px" class="cls_028"><span class="cls_028">#include "idtmon.h"</span></div>
<div style="position:absolute;left:288.00px;top:411.98px" class="cls_028"><span class="cls_028">.text</span></div>
<div style="position:absolute;left:252.00px;top:431.98px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:252.00px;top:441.98px" class="cls_028"><span class="cls_028">** ret_tlblo -- returns the 'entrylo' contents for the TLB</span></div>
<div style="position:absolute;left:252.00px;top:451.98px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:288.05px;top:451.98px" class="cls_028"><span class="cls_028">'c' callable - as ret_tlblo(index) - where index is the</span></div>
<div style="position:absolute;left:252.00px;top:461.98px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:288.05px;top:461.98px" class="cls_028"><span class="cls_028">tlb entry to return the lo value for - if called from</span></div>
<div style="position:absolute;left:252.00px;top:471.98px" class="cls_028"><span class="cls_028">assembly</span></div>
<div style="position:absolute;left:252.00px;top:481.98px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:288.05px;top:481.98px" class="cls_028"><span class="cls_028">language then index should be in register a0.</span></div>
<div style="position:absolute;left:252.00px;top:491.98px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.00px;top:501.98px" class="cls_028"><span class="cls_028">FRAME(ret_tlblo,sp,0,ra)</span></div>
<div style="position:absolute;left:288.00px;top:511.97px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.09px;top:511.97px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:288.00px;top:521.97px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.09px;top:521.97px" class="cls_028"><span class="cls_028">t0,C0_SR</span></div>
<div style="position:absolute;left:396.28px;top:521.97px" class="cls_028"><span class="cls_028"># save sr</span></div>
<div style="position:absolute;left:288.00px;top:531.97px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:541.97px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:324.07px;top:541.97px" class="cls_028"><span class="cls_028">t0,~SR_PE</span></div>
<div style="position:absolute;left:396.27px;top:541.97px" class="cls_028"><span class="cls_028"># dont inadvertantly clear PE</span></div>
<div style="position:absolute;left:288.00px;top:551.97px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:551.97px" class="cls_028"><span class="cls_028">zero,C0_SR</span></div>
<div style="position:absolute;left:396.33px;top:551.97px" class="cls_028"><span class="cls_028"># clear interrupts</span></div>
<div style="position:absolute;left:288.00px;top:561.97px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.09px;top:561.97px" class="cls_028"><span class="cls_028">t1,C0_TLBHI</span></div>
<div style="position:absolute;left:396.35px;top:561.97px" class="cls_028"><span class="cls_028"># save pid</span></div>
<div style="position:absolute;left:288.00px;top:571.97px" class="cls_028"><span class="cls_028">sll</span></div>
<div style="position:absolute;left:324.07px;top:571.97px" class="cls_028"><span class="cls_028">a0,TLBINX_INXSHIFT# position index</span></div>
<div style="position:absolute;left:288.00px;top:581.97px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:581.97px" class="cls_028"><span class="cls_028">a0,C0_INX</span></div>
<div style="position:absolute;left:396.30px;top:581.97px" class="cls_028"><span class="cls_028"># write to index register</span></div>
<div style="position:absolute;left:288.00px;top:591.97px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:601.97px" class="cls_028"><span class="cls_028">tlbr</span></div>
<div style="position:absolute;left:432.09px;top:601.97px" class="cls_028"><span class="cls_028"># put tlb entry in entrylo and</span></div>
<div style="position:absolute;left:252.03px;top:611.96px" class="cls_028"><span class="cls_028">hi</span></div>
<div style="position:absolute;left:288.03px;top:621.96px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.03px;top:631.96px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.12px;top:631.96px" class="cls_028"><span class="cls_028">v0,C0_TLBLO</span></div>
<div style="position:absolute;left:396.37px;top:631.96px" class="cls_028"><span class="cls_028"># get the requested entry lo</span></div>
<div style="position:absolute;left:288.03px;top:641.96px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.12px;top:641.96px" class="cls_028"><span class="cls_028">t1,C0_TLBHI</span></div>
<div style="position:absolute;left:396.37px;top:641.96px" class="cls_028"><span class="cls_028"># restore pid</span></div>
<div style="position:absolute;left:288.03px;top:651.96px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.12px;top:651.96px" class="cls_028"><span class="cls_028">t0,C0_SR</span></div>
<div style="position:absolute;left:396.31px;top:651.96px" class="cls_028"><span class="cls_028"># restore status register</span></div>
<div style="position:absolute;left:288.03px;top:661.96px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.05px;top:661.96px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:288.03px;top:671.96px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:252.03px;top:681.96px" class="cls_028"><span class="cls_028">ENDFRAME(ret_tlblo)</span></div>
<div style="position:absolute;left:252.03px;top:701.96px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:252.03px;top:711.95px" class="cls_028"><span class="cls_028">** ret_tlbhi -- return the tlb entry high content for tlb entry</span></div>
<div style="position:absolute;left:252.03px;top:721.95px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:360.07px;top:721.95px" class="cls_028"><span class="cls_028">index</span></div>
<div style="position:absolute;left:305.78px;top:755.34px" class="cls_002"><span class="cls_002">6-9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:70576px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 6</span></div>
<div style="position:absolute;left:385.42px;top:28.00px" class="cls_002"><span class="cls_002">MEMORY MANAGEMENT AND THE TLB</span></div>
<div style="position:absolute;left:72.00px;top:51.00px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:72.00px;top:61.00px" class="cls_028"><span class="cls_028">FRAME(ret_tlbhi,sp,0,ra)</span></div>
<div style="position:absolute;left:108.00px;top:71.00px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:144.09px;top:71.00px" class="cls_028"><span class="cls_028">t0,C0_SR</span></div>
<div style="position:absolute;left:216.28px;top:71.00px" class="cls_028"><span class="cls_028"># save sr</span></div>
<div style="position:absolute;left:108.00px;top:81.00px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:108.00px;top:91.00px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.07px;top:91.00px" class="cls_028"><span class="cls_028">t0,~SR_PE</span></div>
<div style="position:absolute;left:108.00px;top:101.00px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:101.00px" class="cls_028"><span class="cls_028">zero,C0_SR</span></div>
<div style="position:absolute;left:216.33px;top:101.00px" class="cls_028"><span class="cls_028"># disable interrupts</span></div>
<div style="position:absolute;left:108.00px;top:110.99px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:144.09px;top:110.99px" class="cls_028"><span class="cls_028">t1,C0_TLBHI</span></div>
<div style="position:absolute;left:216.35px;top:110.99px" class="cls_028"><span class="cls_028"># save current pid</span></div>
<div style="position:absolute;left:108.00px;top:120.99px" class="cls_028"><span class="cls_028">sll</span></div>
<div style="position:absolute;left:144.07px;top:120.99px" class="cls_028"><span class="cls_028">a0,TLBINX_INXSHIFT# position index</span></div>
<div style="position:absolute;left:108.00px;top:130.99px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:130.99px" class="cls_028"><span class="cls_028">a0,C0_INX</span></div>
<div style="position:absolute;left:216.30px;top:130.99px" class="cls_028"><span class="cls_028"># drop it in C0 register</span></div>
<div style="position:absolute;left:108.00px;top:140.99px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:108.00px;top:150.99px" class="cls_028"><span class="cls_028">tlbr</span></div>
<div style="position:absolute;left:252.09px;top:150.99px" class="cls_028"><span class="cls_028"># read entry to entry hi/lo</span></div>
<div style="position:absolute;left:108.00px;top:160.99px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:108.00px;top:170.99px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:144.09px;top:170.99px" class="cls_028"><span class="cls_028">v0,C0_TLBHI</span></div>
<div style="position:absolute;left:216.35px;top:170.99px" class="cls_028"><span class="cls_028"># to return value</span></div>
<div style="position:absolute;left:108.00px;top:180.99px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:180.99px" class="cls_028"><span class="cls_028">t1,C0_TLBHI</span></div>
<div style="position:absolute;left:216.35px;top:180.99px" class="cls_028"><span class="cls_028"># restore current pid</span></div>
<div style="position:absolute;left:108.00px;top:190.99px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:190.99px" class="cls_028"><span class="cls_028">t0,C0_SR</span></div>
<div style="position:absolute;left:216.28px;top:190.99px" class="cls_028"><span class="cls_028"># restore sr</span></div>
<div style="position:absolute;left:108.00px;top:200.99px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:200.99px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:108.00px;top:210.98px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:72.00px;top:220.98px" class="cls_028"><span class="cls_028">ENDFRAME(ret_tlbhi)</span></div>
<div style="position:absolute;left:72.00px;top:240.98px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:72.00px;top:250.98px" class="cls_028"><span class="cls_028">** ret_tlbpid() -- return tlb pid contained in the current entry hi</span></div>
<div style="position:absolute;left:71.96px;top:260.98px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:71.96px;top:270.98px" class="cls_028"><span class="cls_028">FRAME(ret_tlbpid,sp,0,ra)</span></div>
<div style="position:absolute;left:107.96px;top:280.98px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:144.06px;top:280.98px" class="cls_028"><span class="cls_028">v0,C0_TLBHI</span></div>
<div style="position:absolute;left:216.31px;top:280.98px" class="cls_028"><span class="cls_028"># fetch tlb high</span></div>
<div style="position:absolute;left:107.96px;top:290.98px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:107.96px;top:300.98px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.03px;top:300.98px" class="cls_028"><span class="cls_028">v0,TLBHI_PIDMASK# isolate and position</span></div>
<div style="position:absolute;left:107.96px;top:310.97px" class="cls_028"><span class="cls_028">srl</span></div>
<div style="position:absolute;left:144.03px;top:310.97px" class="cls_028"><span class="cls_028">v0,TLBHI_PIDSHIFT</span></div>
<div style="position:absolute;left:107.96px;top:320.97px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:143.98px;top:320.97px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:107.96px;top:330.97px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:71.96px;top:340.97px" class="cls_028"><span class="cls_028">ENDFRAME(ret_tlbpid)</span></div>
<div style="position:absolute;left:71.96px;top:360.97px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:71.96px;top:370.97px" class="cls_028"><span class="cls_028">** tlbprobe(address, pid) -- probe the tlb to see if address is</span></div>
<div style="position:absolute;left:71.96px;top:380.97px" class="cls_028"><span class="cls_028">currently</span></div>
<div style="position:absolute;left:71.96px;top:390.97px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:216.01px;top:390.97px" class="cls_028"><span class="cls_028">mapped</span></div>
<div style="position:absolute;left:71.96px;top:400.96px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:108.01px;top:400.96px" class="cls_028"><span class="cls_028">a0 = vpn</span></div>
<div style="position:absolute;left:162.02px;top:400.96px" class="cls_028"><span class="cls_028">- virtual page numbers are 0=0 1=0x1000,</span></div>
<div style="position:absolute;left:71.96px;top:410.96px" class="cls_028"><span class="cls_028">2=0x2000...</span></div>
<div style="position:absolute;left:71.96px;top:420.96px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:180.01px;top:420.96px" class="cls_028"><span class="cls_028">virtual page numbers for the r3000 are in</span></div>
<div style="position:absolute;left:71.96px;top:430.96px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:180.01px;top:430.96px" class="cls_028"><span class="cls_028">entry hi bits 31-12</span></div>
<div style="position:absolute;left:71.96px;top:440.96px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:108.01px;top:440.96px" class="cls_028"><span class="cls_028">a1 = pid</span></div>
<div style="position:absolute;left:162.02px;top:440.96px" class="cls_028"><span class="cls_028">- this is a process id ranging from 0 to 63</span></div>
<div style="position:absolute;left:71.96px;top:450.96px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:156.18px;top:450.96px" class="cls_028"><span class="cls_028">this process id is shifted left 6 bits and or'ed</span></div>
<div style="position:absolute;left:71.96px;top:460.96px" class="cls_028"><span class="cls_028">into</span></div>
<div style="position:absolute;left:71.96px;top:470.96px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:165.61px;top:470.96px" class="cls_028"><span class="cls_028">the entry hi register</span></div>
<div style="position:absolute;left:71.96px;top:480.96px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:108.01px;top:480.96px" class="cls_028"><span class="cls_028">returns an index value (0-63) if successful -1 -f not</span></div>
<div style="position:absolute;left:71.96px;top:490.96px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:71.96px;top:500.95px" class="cls_028"><span class="cls_028">FRAME(tlbprobe,sp,0,ra)</span></div>
<div style="position:absolute;left:107.96px;top:510.95px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:144.06px;top:510.95px" class="cls_028"><span class="cls_028">t0,C0_SR</span></div>
<div style="position:absolute;left:216.24px;top:510.95px" class="cls_028"><span class="cls_028">/* fetch status reg */</span></div>
<div style="position:absolute;left:107.96px;top:520.95px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.03px;top:520.95px" class="cls_028"><span class="cls_028">a0,TLBHI_VPNMASK/* isolate just the vpn */</span></div>
<div style="position:absolute;left:107.96px;top:530.95px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.03px;top:530.95px" class="cls_028"><span class="cls_028">t0,~SR_PE</span></div>
<div style="position:absolute;left:216.24px;top:530.95px" class="cls_028"><span class="cls_028">/* don't inadvertantly clear pe */</span></div>
<div style="position:absolute;left:107.96px;top:540.95px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.06px;top:540.95px" class="cls_028"><span class="cls_028">zero,C0_SR</span></div>
<div style="position:absolute;left:107.96px;top:550.95px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:144.06px;top:550.95px" class="cls_028"><span class="cls_028">t1,C0_TLBHI</span></div>
<div style="position:absolute;left:107.96px;top:560.95px" class="cls_028"><span class="cls_028">sll</span></div>
<div style="position:absolute;left:144.03px;top:560.95px" class="cls_028"><span class="cls_028">a1,TLBHI_PIDSHIFT/* possition the pid */</span></div>
<div style="position:absolute;left:107.96px;top:570.95px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.03px;top:570.95px" class="cls_028"><span class="cls_028">a1,TLBHI_PIDMASK</span></div>
<div style="position:absolute;left:107.96px;top:580.95px" class="cls_028"><span class="cls_028">or</span></div>
<div style="position:absolute;left:144.01px;top:580.95px" class="cls_028"><span class="cls_028">a0,a1</span></div>
<div style="position:absolute;left:252.12px;top:580.95px" class="cls_028"><span class="cls_028">/* build entry hi value */</span></div>
<div style="position:absolute;left:107.96px;top:590.95px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.06px;top:590.95px" class="cls_028"><span class="cls_028">a0,C0_TLBHI</span></div>
<div style="position:absolute;left:107.96px;top:600.95px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:107.96px;top:610.94px" class="cls_028"><span class="cls_028">tlbp</span></div>
<div style="position:absolute;left:252.06px;top:610.94px" class="cls_028"><span class="cls_028">/* do the probe */</span></div>
<div style="position:absolute;left:107.96px;top:620.94px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:107.96px;top:630.94px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:144.06px;top:630.94px" class="cls_028"><span class="cls_028">v1,C0_INX</span></div>
<div style="position:absolute;left:107.96px;top:640.94px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.01px;top:640.94px" class="cls_028"><span class="cls_028">v0,-1</span></div>
<div style="position:absolute;left:107.96px;top:650.94px" class="cls_028"><span class="cls_028">bltz</span></div>
<div style="position:absolute;left:144.06px;top:650.94px" class="cls_028"><span class="cls_028">v1,1f</span></div>
<div style="position:absolute;left:107.96px;top:660.94px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:107.96px;top:670.94px" class="cls_028"><span class="cls_028">sra</span></div>
<div style="position:absolute;left:144.03px;top:670.94px" class="cls_028"><span class="cls_028">v0,v1,TLBINX_INXSHIFT/* get index positioned for</span></div>
<div style="position:absolute;left:71.96px;top:680.94px" class="cls_028"><span class="cls_028">return */</span></div>
<div style="position:absolute;left:71.96px;top:690.94px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:107.96px;top:700.93px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.05px;top:700.93px" class="cls_028"><span class="cls_028">t1,C0_TLBHI</span></div>
<div style="position:absolute;left:216.30px;top:700.93px" class="cls_028"><span class="cls_028">/* restore tlb hi */</span></div>
<div style="position:absolute;left:107.96px;top:710.93px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.05px;top:710.93px" class="cls_028"><span class="cls_028">t0,C0_SR</span></div>
<div style="position:absolute;left:216.24px;top:710.93px" class="cls_028"><span class="cls_028">/* restore the status reg */</span></div>
<div style="position:absolute;left:107.96px;top:720.93px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:143.97px;top:720.93px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">6-10</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:71378px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MEMORY MANAGEMENT AND THE TLB</span></div>
<div style="position:absolute;left:525.16px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 6</span></div>
<div style="position:absolute;left:288.00px;top:51.00px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:252.00px;top:61.00px" class="cls_028"><span class="cls_028">ENDFRAME(tlbprobe)</span></div>
<div style="position:absolute;left:252.00px;top:81.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:252.00px;top:91.00px" class="cls_028"><span class="cls_028">** resettlb(index) Invalidate the  TLB entry specified by index</span></div>
<div style="position:absolute;left:252.00px;top:101.00px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.00px;top:110.99px" class="cls_028"><span class="cls_028">FRAME(resettlb,sp,0,ra)</span></div>
<div style="position:absolute;left:288.00px;top:120.99px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.09px;top:120.99px" class="cls_028"><span class="cls_028">t0,C0_TLBHI</span></div>
<div style="position:absolute;left:396.35px;top:120.99px" class="cls_028"><span class="cls_028"># fetch the current hi</span></div>
<div style="position:absolute;left:288.00px;top:130.99px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.09px;top:130.99px" class="cls_028"><span class="cls_028">v0,C0_SR</span></div>
<div style="position:absolute;left:396.28px;top:130.99px" class="cls_028"><span class="cls_028"># fetch the status reg.</span></div>
<div style="position:absolute;left:288.00px;top:140.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:140.99px" class="cls_028"><span class="cls_028">t2,K0BASE&TLBHI_VPNMASK</span></div>
<div style="position:absolute;left:288.00px;top:150.99px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:324.07px;top:150.99px" class="cls_028"><span class="cls_028">v0,~SR_PE</span></div>
<div style="position:absolute;left:396.27px;top:150.99px" class="cls_028"><span class="cls_028"># dont inadvertantly clear PE</span></div>
<div style="position:absolute;left:288.00px;top:160.99px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:160.99px" class="cls_028"><span class="cls_028">zero,C0_SR</span></div>
<div style="position:absolute;left:288.00px;top:170.99px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:170.99px" class="cls_028"><span class="cls_028">t2,C0_TLBHI</span></div>
<div style="position:absolute;left:396.35px;top:170.99px" class="cls_028"><span class="cls_028"># set up tlbhi</span></div>
<div style="position:absolute;left:288.00px;top:180.99px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:180.99px" class="cls_028"><span class="cls_028">zero,C0_TLBLO</span></div>
<div style="position:absolute;left:288.00px;top:190.99px" class="cls_028"><span class="cls_028">sll</span></div>
<div style="position:absolute;left:324.07px;top:190.99px" class="cls_028"><span class="cls_028">a0,TLBINX_INXSHIFT</span></div>
<div style="position:absolute;left:288.00px;top:200.99px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:200.99px" class="cls_028"><span class="cls_028">a0,C0_INX</span></div>
<div style="position:absolute;left:288.00px;top:210.98px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:220.98px" class="cls_028"><span class="cls_028">tlbwi</span></div>
<div style="position:absolute;left:432.11px;top:220.98px" class="cls_028"><span class="cls_028"># do actual invalidate</span></div>
<div style="position:absolute;left:288.00px;top:230.98px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:240.98px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:240.98px" class="cls_028"><span class="cls_028">t0,C0_TLBHI</span></div>
<div style="position:absolute;left:288.00px;top:250.98px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:250.98px" class="cls_028"><span class="cls_028">v0,C0_SR</span></div>
<div style="position:absolute;left:288.00px;top:260.98px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.02px;top:260.98px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:288.00px;top:270.98px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:252.00px;top:280.98px" class="cls_028"><span class="cls_028">ENDFRAME(resettlb)</span></div>
<div style="position:absolute;left:252.00px;top:300.98px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:252.00px;top:310.97px" class="cls_028"><span class="cls_028">** Setup TLB entry</span></div>
<div style="position:absolute;left:252.00px;top:320.97px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:252.00px;top:330.97px" class="cls_028"><span class="cls_028">** map_tlb(index, tlbhi, phypage)</span></div>
<div style="position:absolute;left:252.00px;top:340.97px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:288.07px;top:340.97px" class="cls_028"><span class="cls_028">a0</span></div>
<div style="position:absolute;left:309.67px;top:340.97px" class="cls_028"><span class="cls_028">=  TLB entry index</span></div>
<div style="position:absolute;left:252.00px;top:350.97px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:288.05px;top:350.97px" class="cls_028"><span class="cls_028">a1</span></div>
<div style="position:absolute;left:309.65px;top:350.97px" class="cls_028"><span class="cls_028">=  virtual page number and PID</span></div>
<div style="position:absolute;left:252.00px;top:360.97px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:288.05px;top:360.97px" class="cls_028"><span class="cls_028">a2</span></div>
<div style="position:absolute;left:309.65px;top:360.97px" class="cls_028"><span class="cls_028">=  physical page</span></div>
<div style="position:absolute;left:252.00px;top:370.97px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.00px;top:380.97px" class="cls_028"><span class="cls_028">FRAME(map_tlb,sp,0,ra)</span></div>
<div style="position:absolute;left:288.00px;top:400.96px" class="cls_028"><span class="cls_028">sll</span></div>
<div style="position:absolute;left:324.07px;top:400.96px" class="cls_028"><span class="cls_028">a0,TLBINX_INXSHIFT</span></div>
<div style="position:absolute;left:288.00px;top:410.96px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.09px;top:410.96px" class="cls_028"><span class="cls_028">v0,C0_SR</span></div>
<div style="position:absolute;left:396.28px;top:410.96px" class="cls_028"><span class="cls_028"># fetch the current status</span></div>
<div style="position:absolute;left:288.00px;top:420.96px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:324.09px;top:420.96px" class="cls_028"><span class="cls_028">a3,C0_TLBHI</span></div>
<div style="position:absolute;left:396.35px;top:420.96px" class="cls_028"><span class="cls_028"># save the current hi</span></div>
<div style="position:absolute;left:288.00px;top:430.96px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:324.07px;top:430.96px" class="cls_028"><span class="cls_028">v0,~SR_PE</span></div>
<div style="position:absolute;left:396.27px;top:430.96px" class="cls_028"><span class="cls_028"># dont inadvertantly clear parity</span></div>
<div style="position:absolute;left:288.00px;top:450.96px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:450.96px" class="cls_028"><span class="cls_028">zero,C0_SR</span></div>
<div style="position:absolute;left:288.00px;top:460.96px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:460.96px" class="cls_028"><span class="cls_028">a1,C0_TLBHI</span></div>
<div style="position:absolute;left:396.35px;top:460.96px" class="cls_028"><span class="cls_028"># set the hi entry</span></div>
<div style="position:absolute;left:288.00px;top:470.96px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:470.96px" class="cls_028"><span class="cls_028">a2,C0_TLBLO</span></div>
<div style="position:absolute;left:396.35px;top:470.96px" class="cls_028"><span class="cls_028"># set the lo entry</span></div>
<div style="position:absolute;left:288.00px;top:480.96px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:480.96px" class="cls_028"><span class="cls_028">a0,C0_INX</span></div>
<div style="position:absolute;left:396.30px;top:480.96px" class="cls_028"><span class="cls_028"># load the index</span></div>
<div style="position:absolute;left:288.00px;top:490.96px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:500.95px" class="cls_028"><span class="cls_028">tlbwi</span></div>
<div style="position:absolute;left:432.11px;top:500.95px" class="cls_028"><span class="cls_028"># put the hi/lo in tlb entry</span></div>
<div style="position:absolute;left:252.00px;top:510.95px" class="cls_028"><span class="cls_028">indexed</span></div>
<div style="position:absolute;left:288.00px;top:520.95px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:530.95px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:530.95px" class="cls_028"><span class="cls_028">a3,C0_TLBHI</span></div>
<div style="position:absolute;left:396.35px;top:530.95px" class="cls_028"><span class="cls_028"># put back the tlb hi reg</span></div>
<div style="position:absolute;left:288.00px;top:540.95px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.09px;top:540.95px" class="cls_028"><span class="cls_028">v0,C0_SR</span></div>
<div style="position:absolute;left:396.28px;top:540.95px" class="cls_028"><span class="cls_028"># restore the status register</span></div>
<div style="position:absolute;left:288.00px;top:550.95px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.02px;top:550.95px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:288.00px;top:560.95px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:252.00px;top:570.95px" class="cls_028"><span class="cls_028">ENDFRAME(map_tlb)</span></div>
<div style="position:absolute;left:252.00px;top:600.95px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:252.00px;top:610.94px" class="cls_028"><span class="cls_028">** Set current TLBPID. This assumes PID is positioned correctly in</span></div>
<div style="position:absolute;left:251.97px;top:620.94px" class="cls_028"><span class="cls_028">reg.</span></div>
<div style="position:absolute;left:251.97px;top:630.94px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:360.02px;top:630.94px" class="cls_028"><span class="cls_028">a0.</span></div>
<div style="position:absolute;left:251.97px;top:640.94px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:251.97px;top:650.94px" class="cls_028"><span class="cls_028">FRAME(set_tlbpid,sp,0,ra)</span></div>
<div style="position:absolute;left:287.97px;top:670.94px" class="cls_028"><span class="cls_028">sll</span></div>
<div style="position:absolute;left:324.04px;top:670.94px" class="cls_028"><span class="cls_028">a0,TLBHI_PIDSHIFT</span></div>
<div style="position:absolute;left:287.97px;top:680.94px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.07px;top:680.94px" class="cls_028"><span class="cls_028">a0,C0_TLBHI</span></div>
<div style="position:absolute;left:287.97px;top:690.94px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:323.99px;top:690.94px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:287.97px;top:700.93px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:287.97px;top:710.93px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.07px;top:710.93px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:251.97px;top:720.93px" class="cls_028"><span class="cls_028">ENDFRAME(set_tlbpid)</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">6-11</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:72180px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">RESET INITIALIZATION</span></div>
<div style="position:absolute;left:491.33px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 7</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:216.00px;top:113.00px" class="cls_015"><span class="cls_015">STARTING UP</span></div>
<div style="position:absolute;left:228.02px;top:126.67px" class="cls_006"><span class="cls_006">In terms of its effect on the CPU, “reset” is almost the same as an</span></div>
<div style="position:absolute;left:216.00px;top:137.67px" class="cls_006"><span class="cls_006">exception. Following reset, </span><span class="cls_008">EPC</span><span class="cls_006"> points to the instruction being executed</span></div>
<div style="position:absolute;left:216.00px;top:148.67px" class="cls_006"><span class="cls_006">when reset was detected, and most registers are unchanged. However,</span></div>
<div style="position:absolute;left:216.00px;top:159.67px" class="cls_006"><span class="cls_006">reset disrupts normal operation and a register being loaded or a cache</span></div>
<div style="position:absolute;left:216.00px;top:170.67px" class="cls_006"><span class="cls_006">location being stored to or refilled at the moment reset occurred may be</span></div>
<div style="position:absolute;left:216.00px;top:181.67px" class="cls_006"><span class="cls_006">trashed.</span></div>
<div style="position:absolute;left:228.02px;top:192.67px" class="cls_006"><span class="cls_006">It is quite possible to use the preservation of state through reset to</span></div>
<div style="position:absolute;left:216.00px;top:203.67px" class="cls_006"><span class="cls_006">implement some useful post-mortem debugging, but the system hardware</span></div>
<div style="position:absolute;left:216.00px;top:214.67px" class="cls_006"><span class="cls_006">engineer needs to help; the CPU cannot tell whether reset occurred to a</span></div>
<div style="position:absolute;left:216.00px;top:225.67px" class="cls_006"><span class="cls_006">running system or from power-up. This chapter will focus on starting up</span></div>
<div style="position:absolute;left:216.00px;top:236.67px" class="cls_006"><span class="cls_006">the system from scratch.</span></div>
<div style="position:absolute;left:228.02px;top:247.67px" class="cls_006"><span class="cls_006">The   CPU   responds   to   reset   with   a   jump   to   program   location</span></div>
<div style="position:absolute;left:216.00px;top:258.67px" class="cls_029"><span class="cls_029">0xBFC0 0000</span><span class="cls_006">. This is physical address </span><span class="cls_029">0x1FC0 0000</span><span class="cls_006"> in the uncached</span></div>
<div style="position:absolute;left:216.00px;top:269.67px" class="cls_008"><span class="cls_008">kseg1</span><span class="cls_006"> region.</span></div>
<div style="position:absolute;left:228.02px;top:280.67px" class="cls_006"><span class="cls_006">Following reset, enough state is defined so that the CPU can execute</span></div>
<div style="position:absolute;left:216.00px;top:291.67px" class="cls_006"><span class="cls_006">uncached instructions. Virtually nothing else is defined:</span></div>
<div style="position:absolute;left:228.02px;top:305.67px" class="cls_006"><span class="cls_006">• Only a few state bits are guaranteed in </span><span class="cls_008">SR;</span><span class="cls_006"> these are that the CPU is</span></div>
<div style="position:absolute;left:239.97px;top:316.67px" class="cls_006"><span class="cls_006">in kernel mode (KUc = 0), interrupts are disabled (IEc = 0), exceptions</span></div>
<div style="position:absolute;left:239.97px;top:327.67px" class="cls_006"><span class="cls_006">will vector through the uncached entry points (BEV = 1); the TS bit is</span></div>
<div style="position:absolute;left:239.97px;top:338.67px" class="cls_006"><span class="cls_006">guaranteed in R30xx family CPUs (it will be cleared to 0 if the CPU has</span></div>
<div style="position:absolute;left:239.97px;top:349.67px" class="cls_006"><span class="cls_006">MMU hardware (“E” versions), set to 1 for base versions).</span></div>
<div style="position:absolute;left:228.02px;top:363.67px" class="cls_006"><span class="cls_006">• The D-cache may or may not be isolated (IsC = 1), so software cannot</span></div>
<div style="position:absolute;left:239.97px;top:374.67px" class="cls_006"><span class="cls_006">rely on data loads and stores working, even to uncached space,</span></div>
<div style="position:absolute;left:239.97px;top:385.67px" class="cls_006"><span class="cls_006">without first initializing this field to ‘0’.</span></div>
<div style="position:absolute;left:228.02px;top:399.67px" class="cls_006"><span class="cls_006">• The cache may be in a random, undefined state; so a cached load</span></div>
<div style="position:absolute;left:239.97px;top:410.67px" class="cls_006"><span class="cls_006">might return uninitialized cache data without reading memory.</span></div>
<div style="position:absolute;left:228.02px;top:424.67px" class="cls_006"><span class="cls_006">• For “E” versions, the TLB may be in a random state and </span><span class="cls_008">must not be</span></div>
<div style="position:absolute;left:239.98px;top:435.67px" class="cls_008"><span class="cls_008">accessed  or  referenced</span><span class="cls_006">  until  initialized</span></div>
<div style="position:absolute;left:450.61px;top:435.67px" class="cls_006"><span class="cls_006">(the  hardware  has  only</span></div>
<div style="position:absolute;left:239.97px;top:446.67px" class="cls_006"><span class="cls_006">minimal protection against the possibility that there are duplicate</span></div>
<div style="position:absolute;left:239.97px;top:457.67px" class="cls_006"><span class="cls_006">matches in the TLB, and the result will be a TLB shutdown which can</span></div>
<div style="position:absolute;left:239.97px;top:468.67px" class="cls_006"><span class="cls_006">be amended only by a further reset).</span></div>
<div style="position:absolute;left:228.02px;top:479.67px" class="cls_006"><span class="cls_006">The traditional start-up sequence is:</span></div>
<div style="position:absolute;left:228.02px;top:493.67px" class="cls_006"><span class="cls_006">• branch to the main ROM code. Why do a branch now?</span></div>
<div style="position:absolute;left:228.02px;top:507.67px" class="cls_006"><span class="cls_006">a)</span></div>
<div style="position:absolute;left:264.02px;top:507.67px" class="cls_006"><span class="cls_006">the  exception  vectors  must  start  at </span><span class="cls_029">0xBFC0 0100</span><span class="cls_006">,  which</span></div>
<div style="position:absolute;left:264.02px;top:518.67px" class="cls_006"><span class="cls_006">wouldn’t leave enough space for start-up code to get to a ‘‘natural</span></div>
<div style="position:absolute;left:264.02px;top:529.67px" class="cls_006"><span class="cls_006">break’’;</span></div>
<div style="position:absolute;left:228.02px;top:543.67px" class="cls_006"><span class="cls_006">b)</span></div>
<div style="position:absolute;left:264.02px;top:543.67px" class="cls_006"><span class="cls_006">the  branch  represents  a  very  simple  test  that  the  CPU  is</span></div>
<div style="position:absolute;left:264.02px;top:554.67px" class="cls_006"><span class="cls_006">functioning   and   is   successfully   reading   instructions.   If</span></div>
<div style="position:absolute;left:264.02px;top:565.67px" class="cls_006"><span class="cls_006">something terrible goes wrong with the hardware, the CPU is</span></div>
<div style="position:absolute;left:264.02px;top:576.67px" class="cls_006"><span class="cls_006">most likely to keep fetching instructions in sequence.</span></div>
<div style="position:absolute;left:264.02px;top:590.67px" class="cls_006"><span class="cls_006">Test equipment which can track the addresses of CPU reads and</span></div>
<div style="position:absolute;left:264.02px;top:601.67px" class="cls_006"><span class="cls_006">writes will show the CPUs uncached instruction fetches from</span></div>
<div style="position:absolute;left:264.02px;top:612.67px" class="cls_006"><span class="cls_006">reset; if the CPU starts up and branches to the right place, then</span></div>
<div style="position:absolute;left:264.02px;top:623.67px" class="cls_006"><span class="cls_006">evidence is strong that the CPU is getting mostly-correct data</span></div>
<div style="position:absolute;left:264.02px;top:634.67px" class="cls_006"><span class="cls_006">from the ROM.</span></div>
<div style="position:absolute;left:264.02px;top:648.67px" class="cls_006"><span class="cls_006">By  contrast,  if  the  ROM  software  plows  straight  in  and</span></div>
<div style="position:absolute;left:264.02px;top:659.67px" class="cls_006"><span class="cls_006">manipulates </span><span class="cls_008">SR,</span><span class="cls_006"> strange and undiagnosable consequences may</span></div>
<div style="position:absolute;left:264.03px;top:670.67px" class="cls_006"><span class="cls_006">be produced by simple faults.</span></div>
<div style="position:absolute;left:228.03px;top:684.67px" class="cls_006"><span class="cls_006">• Set the status register to some known and sensible state. Now</span></div>
<div style="position:absolute;left:239.98px;top:695.67px" class="cls_006"><span class="cls_006">software can load and store reliably in uncached space.</span></div>
<div style="position:absolute;left:299.28px;top:754.68px" class="cls_002"><span class="cls_002">7-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:72982px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 7</span></div>
<div style="position:absolute;left:455.36px;top:28.00px" class="cls_002"><span class="cls_002">RESET INITIALIZATION</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">• Software will probably have to run using registers only until it has</span></div>
<div style="position:absolute;left:59.97px;top:61.67px" class="cls_006"><span class="cls_006">initialized and (most likely) run a quick check on the integrity of RAM</span></div>
<div style="position:absolute;left:59.97px;top:72.67px" class="cls_006"><span class="cls_006">memory. This will be slow (the CPU is still running uncached from</span></div>
<div style="position:absolute;left:59.97px;top:83.67px" class="cls_006"><span class="cls_006">ROM), so it may be desirable to constrain the initialization and check</span></div>
<div style="position:absolute;left:59.97px;top:94.67px" class="cls_006"><span class="cls_006">function to the data which the ROM program itself will use.</span></div>
<div style="position:absolute;left:48.02px;top:108.67px" class="cls_006"><span class="cls_006">• The system will probably have to make some contact with the outside</span></div>
<div style="position:absolute;left:59.97px;top:119.67px" class="cls_006"><span class="cls_006">world (a console port or diagnostic register) so it can report any</span></div>
<div style="position:absolute;left:59.97px;top:130.67px" class="cls_006"><span class="cls_006">problem with the initialization process.</span></div>
<div style="position:absolute;left:48.02px;top:144.67px" class="cls_006"><span class="cls_006">• Software can now assign some stack space and set up enough</span></div>
<div style="position:absolute;left:59.97px;top:155.67px" class="cls_006"><span class="cls_006">registers to be able to call a standard C routine.</span></div>
<div style="position:absolute;left:48.02px;top:169.67px" class="cls_006"><span class="cls_006">• Now the caches can be initialized, and the CPU can be used for more</span></div>
<div style="position:absolute;left:59.97px;top:180.67px" class="cls_006"><span class="cls_006">strenuous tasks. Some systems can run code from ROM cached, and</span></div>
<div style="position:absolute;left:59.97px;top:191.67px" class="cls_006"><span class="cls_006">some can’t; the CPU can only cache instructions from a memory</span></div>
<div style="position:absolute;left:59.97px;top:202.67px" class="cls_006"><span class="cls_006">which is capable of supplying data in 4-word bursts, and the ROM</span></div>
<div style="position:absolute;left:59.97px;top:213.67px" class="cls_006"><span class="cls_006">subsystem may or may not oblige.</span></div>
<div style="position:absolute;left:48.02px;top:224.67px" class="cls_006"><span class="cls_006">The following start-up code is taken from IDT/sim:</span></div>
<div style="position:absolute;left:72.00px;top:247.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:72.00px;top:257.00px" class="cls_028"><span class="cls_028">** Copyright 1989 Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:72.00px;top:267.00px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:108.04px;top:267.00px" class="cls_028"><span class="cls_028">All Rights Reserved</span></div>
<div style="position:absolute;left:72.00px;top:277.00px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:72.00px;top:287.00px" class="cls_028"><span class="cls_028">** sample initialization (reset) code</span></div>
<div style="position:absolute;left:72.00px;top:297.00px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:72.00px;top:317.00px" class="cls_028"><span class="cls_028">#include "excepthdr.h"</span></div>
<div style="position:absolute;left:72.00px;top:327.00px" class="cls_028"><span class="cls_028">#include "iregdef.h"</span></div>
<div style="position:absolute;left:72.00px;top:336.99px" class="cls_028"><span class="cls_028">#include "idtcpu.h"</span></div>
<div style="position:absolute;left:72.00px;top:346.99px" class="cls_028"><span class="cls_028">#include "idtmon.h"</span></div>
<div style="position:absolute;left:72.00px;top:356.99px" class="cls_028"><span class="cls_028">#include "under.h"</span></div>
<div style="position:absolute;left:72.00px;top:376.99px" class="cls_028"><span class="cls_028">/*--------------------------------------------------------------</span></div>
<div style="position:absolute;left:72.00px;top:386.99px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:108.04px;top:386.99px" class="cls_028"><span class="cls_028">external declarations - defined in the module shown in</span></div>
<div style="position:absolute;left:72.00px;top:396.99px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:216.04px;top:396.99px" class="cls_028"><span class="cls_028">parenthesis</span></div>
<div style="position:absolute;left:72.00px;top:406.99px" class="cls_028"><span class="cls_028">*--------------------------------------------------------------</span></div>
<div style="position:absolute;left:72.00px;top:416.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:72.00px;top:426.99px" class="cls_028"><span class="cls_028">.externmem_start,4</span></div>
<div style="position:absolute;left:180.01px;top:426.99px" class="cls_028"><span class="cls_028">/*start loc. for mem test */</span></div>
<div style="position:absolute;left:72.00px;top:436.98px" class="cls_028"><span class="cls_028">.externmem_end,4</span></div>
<div style="position:absolute;left:169.21px;top:436.98px" class="cls_028"><span class="cls_028">/*end loc. for mem test */</span></div>
<div style="position:absolute;left:72.00px;top:446.98px" class="cls_028"><span class="cls_028">.extern parity_error,4</span></div>
<div style="position:absolute;left:201.62px;top:446.98px" class="cls_028"><span class="cls_028">/* global parity error count</span></div>
<div style="position:absolute;left:72.00px;top:456.98px" class="cls_028"><span class="cls_028">(idtglobals.c) */</span></div>
<div style="position:absolute;left:72.00px;top:466.98px" class="cls_028"><span class="cls_028">.extern status_base,4  /* contains value to be loaded into status</span></div>
<div style="position:absolute;left:71.96px;top:476.98px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:190.76px;top:486.98px" class="cls_028"><span class="cls_028">/* register on startup */</span></div>
<div style="position:absolute;left:71.96px;top:496.98px" class="cls_028"><span class="cls_028">.extern fp_int_line,4</span></div>
<div style="position:absolute;left:196.18px;top:496.98px" class="cls_028"><span class="cls_028">/* fpu external interrupt line */</span></div>
<div style="position:absolute;left:71.96px;top:506.98px" class="cls_028"><span class="cls_028">.extern fp_int_num,4</span></div>
<div style="position:absolute;left:190.78px;top:506.98px" class="cls_028"><span class="cls_028">/* fpu external interrupt number */</span></div>
<div style="position:absolute;left:107.96px;top:526.98px" class="cls_028"><span class="cls_028">.text</span></div>
<div style="position:absolute;left:71.96px;top:536.97px" class="cls_028"><span class="cls_028">FRAME(start,sp,0,ra)</span></div>
<div style="position:absolute;left:107.96px;top:546.97px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.05px;top:546.97px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:107.96px;top:556.97px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.01px;top:556.97px" class="cls_028"><span class="cls_028">v0,SR_PE|SR_CU1# enable coproc 1 clear parity error</span></div>
<div style="position:absolute;left:71.94px;top:566.97px" class="cls_028"><span class="cls_028">and set</span></div>
<div style="position:absolute;left:107.94px;top:576.97px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.04px;top:576.97px" class="cls_028"><span class="cls_028">v0,C0_SR</span></div>
<div style="position:absolute;left:216.22px;top:576.97px" class="cls_028"><span class="cls_028"># state unknown on reset</span></div>
<div style="position:absolute;left:107.94px;top:586.97px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.04px;top:586.97px" class="cls_028"><span class="cls_028">zero,C0_CAUSE # clear software interrupts</span></div>
<div style="position:absolute;left:115.15px;top:606.97px" class="cls_028"><span class="cls_028"># check to see if R3041</span></div>
<div style="position:absolute;left:107.94px;top:616.97px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:144.04px;top:616.97px" class="cls_028"><span class="cls_028">t0, CO_PRID</span></div>
<div style="position:absolute;left:107.94px;top:626.97px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:107.94px;top:636.97px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:143.99px;top:636.97px" class="cls_028"><span class="cls_028">t2, 0x00000700# R3041 has rev no 0x00000700</span></div>
<div style="position:absolute;left:107.94px;top:646.96px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:144.01px;top:646.96px" class="cls_028"><span class="cls_028">t0, t2,not41</span></div>
<div style="position:absolute;left:107.94px;top:666.96px" class="cls_028"><span class="cls_028"># R3041 specific initialization code here</span></div>
<div style="position:absolute;left:107.94px;top:686.96px" class="cls_028"><span class="cls_028"># load appropriate values in busctrl and portsize</span></div>
<div style="position:absolute;left:71.94px;top:696.96px" class="cls_028"><span class="cls_028">registers.</span></div>
<div style="position:absolute;left:107.94px;top:706.96px" class="cls_028"><span class="cls_028"># disable coprocessor 1</span></div>
<div style="position:absolute;left:107.94px;top:716.96px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:143.96px;top:716.96px" class="cls_028"><span class="cls_028">commcod</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">7-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:73784px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">RESET INITIALIZATION</span></div>
<div style="position:absolute;left:524.87px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 7</span></div>
<div style="position:absolute;left:252.00px;top:51.00px" class="cls_028"><span class="cls_028">not41:</span></div>
<div style="position:absolute;left:288.00px;top:61.00px" class="cls_028"><span class="cls_028"># check to see if R3081</span></div>
<div style="position:absolute;left:288.00px;top:81.00px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:81.00px" class="cls_028"><span class="cls_028">t3,0xaaaa5555</span></div>
<div style="position:absolute;left:288.00px;top:91.00px" class="cls_028"><span class="cls_028">mtc1</span></div>
<div style="position:absolute;left:324.10px;top:91.00px" class="cls_028"><span class="cls_028">t3, $f0</span></div>
<div style="position:absolute;left:396.26px;top:91.00px" class="cls_028"><span class="cls_028">#put 0xaaaa5555 in f0</span></div>
<div style="position:absolute;left:288.00px;top:101.00px" class="cls_028"><span class="cls_028">mtc1</span></div>
<div style="position:absolute;left:324.10px;top:101.00px" class="cls_028"><span class="cls_028">zero, $f1# 0 in f1</span></div>
<div style="position:absolute;left:288.00px;top:111.00px" class="cls_028"><span class="cls_028">mfc1</span></div>
<div style="position:absolute;left:324.10px;top:111.00px" class="cls_028"><span class="cls_028">t0, $f0</span></div>
<div style="position:absolute;left:288.00px;top:120.99px" class="cls_028"><span class="cls_028">mfc1</span></div>
<div style="position:absolute;left:324.10px;top:120.99px" class="cls_028"><span class="cls_028">t4, $f1</span></div>
<div style="position:absolute;left:396.26px;top:120.99px" class="cls_028"><span class="cls_028"># read registers back</span></div>
<div style="position:absolute;left:288.00px;top:130.99px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:324.07px;top:130.99px" class="cls_028"><span class="cls_028">t0, t3, its51# no FPA, must be 3051(52)</span></div>
<div style="position:absolute;left:288.00px;top:140.99px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:324.07px;top:140.99px" class="cls_028"><span class="cls_028">t4, zer0, its51 # no FPA, must be 3051(52)</span></div>
<div style="position:absolute;left:288.00px;top:160.99px" class="cls_028"><span class="cls_028"># R3081 specific initialization code here</span></div>
<div style="position:absolute;left:288.00px;top:170.99px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.02px;top:170.99px" class="cls_028"><span class="cls_028">commcod</span></div>
<div style="position:absolute;left:252.00px;top:190.99px" class="cls_028"><span class="cls_028">its51:</span></div>
<div style="position:absolute;left:288.00px;top:200.99px" class="cls_028"><span class="cls_028"># R3051 specific initialization here</span></div>
<div style="position:absolute;left:288.00px;top:210.99px" class="cls_028"><span class="cls_028"># disable coprocessor 1</span></div>
<div style="position:absolute;left:252.00px;top:220.99px" class="cls_028"><span class="cls_028">commcod:</span></div>
<div style="position:absolute;left:288.00px;top:230.98px" class="cls_028"><span class="cls_028"># code common to all processors</span></div>
<div style="position:absolute;left:288.00px;top:240.98px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:240.98px" class="cls_028"><span class="cls_028">v0,K1BASE # verify that ram can be accessed</span></div>
<div style="position:absolute;left:288.00px;top:250.98px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:250.98px" class="cls_028"><span class="cls_028">t0,0xaaaa5555</span></div>
<div style="position:absolute;left:288.00px;top:260.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:260.98px" class="cls_028"><span class="cls_028">t0,0(v0)</span></div>
<div style="position:absolute;left:288.00px;top:270.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:270.98px" class="cls_028"><span class="cls_028">zero,4(v0)# put a different pattern on bus</span></div>
<div style="position:absolute;left:288.00px;top:280.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:280.98px" class="cls_028"><span class="cls_028">t1,0(v0)</span></div>
<div style="position:absolute;left:288.00px;top:290.98px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:300.98px" class="cls_028"><span class="cls_028">beq</span></div>
<div style="position:absolute;left:324.07px;top:300.98px" class="cls_028"><span class="cls_028">t1,t0,2f# is memory accessable</span></div>
<div style="position:absolute;left:252.00px;top:310.98px" class="cls_028"><span class="cls_028">/* memory not accessable, hang here, no point in proceeding */</span></div>
<div style="position:absolute;left:252.00px;top:320.98px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:288.05px;top:320.98px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:330.97px" class="cls_028"><span class="cls_028">b</span></div>
<div style="position:absolute;left:324.02px;top:330.97px" class="cls_028"><span class="cls_028">1b</span></div>
<div style="position:absolute;left:288.00px;top:340.97px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:252.00px;top:360.97px" class="cls_028"><span class="cls_028">2:</span></div>
<div style="position:absolute;left:288.05px;top:360.97px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.10px;top:360.97px" class="cls_028"><span class="cls_028">t0,-1</span></div>
<div style="position:absolute;left:288.00px;top:370.97px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:370.97px" class="cls_028"><span class="cls_028">t0,8(v0)</span></div>
<div style="position:absolute;left:288.00px;top:380.97px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:380.97px" class="cls_028"><span class="cls_028">zero,4(v0)</span></div>
<div style="position:absolute;left:288.00px;top:390.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:390.97px" class="cls_028"><span class="cls_028">t1,8(v0)</span></div>
<div style="position:absolute;left:288.00px;top:400.97px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:410.97px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:324.07px;top:410.97px" class="cls_028"><span class="cls_028">t0,t1,1b</span></div>
<div style="position:absolute;left:288.00px;top:420.96px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:430.96px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.10px;top:430.96px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:288.00px;top:440.96px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:440.96px" class="cls_028"><span class="cls_028">zero,parity_error# clear parity error count</span></div>
<div style="position:absolute;left:288.00px;top:450.96px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:450.96px" class="cls_028"><span class="cls_028">initmem</span></div>
<div style="position:absolute;left:432.23px;top:450.96px" class="cls_028"><span class="cls_028"># initializes sp</span></div>
<div style="position:absolute;left:288.00px;top:460.96px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:460.96px" class="cls_028"><span class="cls_028">initialize</span></div>
<div style="position:absolute;left:396.30px;top:460.96px" class="cls_028"><span class="cls_028"># initialize memory and tlb</span></div>
<div style="position:absolute;left:288.00px;top:470.96px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.02px;top:470.96px" class="cls_028"><span class="cls_028">yourcode</span></div>
<div style="position:absolute;left:252.00px;top:480.96px" class="cls_028"><span class="cls_028">ENDFRAME(start)</span></div>
<div style="position:absolute;left:252.00px;top:500.96px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:252.00px;top:510.96px" class="cls_028"><span class="cls_028">** initmem -- config and init cache, clear prom bss</span></div>
<div style="position:absolute;left:252.00px;top:520.96px" class="cls_028"><span class="cls_028">** clears memory between PROM_STACK-0x2000 and PROM_STACK-4</span></div>
<div style="position:absolute;left:252.00px;top:530.95px" class="cls_028"><span class="cls_028">inclusive</span></div>
<div style="position:absolute;left:252.00px;top:540.95px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.00px;top:550.95px" class="cls_028"><span class="cls_028">#define INITMEMFRM ((4*4)+4)</span></div>
<div style="position:absolute;left:252.00px;top:560.95px" class="cls_028"><span class="cls_028">FRAME(initmem,sp, INITMEMFRM, ra)</span></div>
<div style="position:absolute;left:288.00px;top:570.95px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:324.05px;top:570.95px" class="cls_028"><span class="cls_028">v0,_fbss # clear bss</span></div>
<div style="position:absolute;left:288.00px;top:580.95px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:324.05px;top:580.95px" class="cls_028"><span class="cls_028">v1,end</span></div>
<div style="position:absolute;left:396.21px;top:580.95px" class="cls_028"><span class="cls_028"># end of bss</span></div>
<div style="position:absolute;left:288.00px;top:610.95px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.10px;top:610.95px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:252.00px;top:620.95px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:288.05px;top:620.95px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.10px;top:620.95px" class="cls_028"><span class="cls_028">zero,0(v0)/* clear bss */</span></div>
<div style="position:absolute;left:288.00px;top:630.94px" class="cls_028"><span class="cls_028">bltu</span></div>
<div style="position:absolute;left:324.10px;top:630.94px" class="cls_028"><span class="cls_028">v0,v1,1b</span></div>
<div style="position:absolute;left:288.00px;top:640.94px" class="cls_028"><span class="cls_028">add</span></div>
<div style="position:absolute;left:324.07px;top:640.94px" class="cls_028"><span class="cls_028">v0,4</span></div>
<div style="position:absolute;left:252.00px;top:670.94px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:252.00px;top:680.94px" class="cls_028"><span class="cls_028">**</span></div>
<div style="position:absolute;left:288.05px;top:680.94px" class="cls_028"><span class="cls_028">Initialize stack</span></div>
<div style="position:absolute;left:252.00px;top:690.94px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:288.00px;top:700.94px" class="cls_028"><span class="cls_028">add</span></div>
<div style="position:absolute;left:324.07px;top:700.94px" class="cls_028"><span class="cls_028">v1,v0,P_STACKSIZE/* end of prom stack */</span></div>
<div style="position:absolute;left:288.00px;top:710.94px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:710.94px" class="cls_028"><span class="cls_028">v1,mem_start</span></div>
<div style="position:absolute;left:288.00px;top:720.93px" class="cls_028"><span class="cls_028">sub</span></div>
<div style="position:absolute;left:324.07px;top:720.93px" class="cls_028"><span class="cls_028">v1,v1,(4*4)</span></div>
<div style="position:absolute;left:305.77px;top:755.33px" class="cls_002"><span class="cls_002">7-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:74586px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 7</span></div>
<div style="position:absolute;left:455.36px;top:28.00px" class="cls_002"><span class="cls_002">RESET INITIALIZATION</span></div>
<div style="position:absolute;left:108.00px;top:51.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:51.00px" class="cls_028"><span class="cls_028">v1,fault_stack/* top of fault stack */</span></div>
<div style="position:absolute;left:108.00px;top:61.00px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:144.10px;top:61.00px" class="cls_028"><span class="cls_028">sp,v1,P_STACKSIZE/4/* monitor stack top */</span></div>
<div style="position:absolute;left:108.00px;top:71.00px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:144.10px;top:71.00px" class="cls_028"><span class="cls_028">sp,INITMEMFRM</span></div>
<div style="position:absolute;left:72.00px;top:81.00px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:108.05px;top:81.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.10px;top:81.00px" class="cls_028"><span class="cls_028">zero,0(v0)</span></div>
<div style="position:absolute;left:108.00px;top:91.00px" class="cls_028"><span class="cls_028">bltu</span></div>
<div style="position:absolute;left:144.10px;top:91.00px" class="cls_028"><span class="cls_028">v0,v1,1b</span></div>
<div style="position:absolute;left:108.00px;top:101.00px" class="cls_028"><span class="cls_028">add</span></div>
<div style="position:absolute;left:144.07px;top:101.00px" class="cls_028"><span class="cls_028">v0,4</span></div>
<div style="position:absolute;left:108.00px;top:111.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:111.00px" class="cls_028"><span class="cls_028">ra,INITMEMFRM-4(sp)</span></div>
<div style="position:absolute;left:108.00px;top:120.99px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.10px;top:120.99px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:108.00px;top:140.99px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:144.07px;top:140.99px" class="cls_028"><span class="cls_028">config_cache</span></div>
<div style="position:absolute;left:216.35px;top:140.99px" class="cls_028"><span class="cls_028">/* determine cache sizes */</span></div>
<div style="position:absolute;left:108.00px;top:150.99px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:144.07px;top:150.99px" class="cls_028"><span class="cls_028">flush_cache</span></div>
<div style="position:absolute;left:216.32px;top:150.99px" class="cls_028"><span class="cls_028">/* flush cache */</span></div>
<div style="position:absolute;left:108.00px;top:160.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:160.99px" class="cls_028"><span class="cls_028">ra,INITMEMFRM-4(sp)</span></div>
<div style="position:absolute;left:108.00px;top:170.99px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:144.10px;top:170.99px" class="cls_028"><span class="cls_028">sp,INITMEMFRM</span></div>
<div style="position:absolute;left:108.00px;top:180.99px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:180.99px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:72.00px;top:190.99px" class="cls_028"><span class="cls_028">ENDFRAME(initmem)</span></div>
<div style="position:absolute;left:72.00px;top:210.99px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:72.00px;top:220.99px" class="cls_028"><span class="cls_028">** initialize -- initializes memory and tlb</span></div>
<div style="position:absolute;left:72.00px;top:230.98px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:72.00px;top:240.98px" class="cls_028"><span class="cls_028">#define  INITFRM ((4*4)+4)</span></div>
<div style="position:absolute;left:72.00px;top:250.98px" class="cls_028"><span class="cls_028">FRAME(initialize,sp, INITFRM,ra)</span></div>
<div style="position:absolute;left:108.00px;top:260.98px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:144.10px;top:260.98px" class="cls_028"><span class="cls_028">sp,INITFRM</span></div>
<div style="position:absolute;left:108.00px;top:270.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:270.98px" class="cls_028"><span class="cls_028">ra,INITFRM-4(sp)</span></div>
<div style="position:absolute;left:108.00px;top:280.98px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:144.07px;top:280.98px" class="cls_028"><span class="cls_028">init_io</span></div>
<div style="position:absolute;left:252.23px;top:280.98px" class="cls_028"><span class="cls_028">/* initialize io */</span></div>
<div style="position:absolute;left:108.00px;top:290.98px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:144.07px;top:290.98px" class="cls_028"><span class="cls_028">init_memory</span></div>
<div style="position:absolute;left:216.32px;top:290.98px" class="cls_028"><span class="cls_028">/* initialize memory and tlb */</span></div>
<div style="position:absolute;left:108.00px;top:300.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:300.98px" class="cls_028"><span class="cls_028">ra,INITFRM-4(sp)</span></div>
<div style="position:absolute;left:108.00px;top:310.98px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:144.10px;top:310.98px" class="cls_028"><span class="cls_028">sp,INITFRM</span></div>
<div style="position:absolute;left:108.00px;top:320.98px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:320.98px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:72.00px;top:330.97px" class="cls_028"><span class="cls_028">ENDFRAME(initialize)</span></div>
<div style="position:absolute;left:36.00px;top:352.00px" class="cls_015"><span class="cls_015">Probing and recognizing the CPU</span></div>
<div style="position:absolute;left:48.02px;top:365.67px" class="cls_006"><span class="cls_006">The </span><span class="cls_008">PRId</span><span class="cls_006"> register Imp and Rev fields is useful for the first check, to</span></div>
<div style="position:absolute;left:36.00px;top:376.67px" class="cls_006"><span class="cls_006">differentiate the R3041 from other family members. The Imp field will be</span></div>
<div style="position:absolute;left:36.00px;top:387.67px" class="cls_006"><span class="cls_006">‘‘2’’ for the R3051, R3052, R3071 and R3081 (indicating that their control</span></div>
<div style="position:absolute;left:36.00px;top:398.67px" class="cls_006"><span class="cls_006">register sets are identical to the R3000A), but ‘‘7’’ for the R3041†, which</span></div>
<div style="position:absolute;left:36.00px;top:409.67px" class="cls_006"><span class="cls_006">has no MMU and assigns some control register numbers differently.</span></div>
<div style="position:absolute;left:36.00px;top:420.67px" class="cls_006"><span class="cls_006">Diagnostic software should also make the “Rev” field visible.</span></div>
<div style="position:absolute;left:48.02px;top:431.67px" class="cls_006"><span class="cls_006">Software can investigate the presence of FPA hardware. The ‘‘official’’</span></div>
<div style="position:absolute;left:36.00px;top:442.67px" class="cls_006"><span class="cls_006">technique is to set CU1 in </span><span class="cls_008">SR</span><span class="cls_006"> to enable co-processor 1 operations, and use</span></div>
<div style="position:absolute;left:36.00px;top:453.67px" class="cls_006"><span class="cls_006">a </span><span class="cls_008">cfc1</span><span class="cls_006"> instruction from co-processor 1 register 0, which is defined to hold</span></div>
<div style="position:absolute;left:36.00px;top:464.67px" class="cls_006"><span class="cls_006">the revision ID. A non-zero value in bits 15-8 indicates the presence of FPA</span></div>
<div style="position:absolute;left:36.00px;top:475.67px" class="cls_006"><span class="cls_006">hardware; the value ‘‘3’’ is standard for the FPA type which partners the</span></div>
<div style="position:absolute;left:36.00px;top:486.67px" class="cls_006"><span class="cls_006">R3000 CPU. Don’t forget to reset CU1 in </span><span class="cls_008">SR</span><span class="cls_006"> afterwards! A skeptical</span></div>
<div style="position:absolute;left:36.00px;top:497.67px" class="cls_006"><span class="cls_006">programmer will probably follow this up by checking that it is possible to</span></div>
<div style="position:absolute;left:36.00px;top:508.67px" class="cls_006"><span class="cls_006">store and retrieve data from the FPA registers.</span></div>
<div style="position:absolute;left:48.02px;top:519.67px" class="cls_006"><span class="cls_006">The size of the on-chip caches can be determined, as described in</span></div>
<div style="position:absolute;left:36.00px;top:530.67px" class="cls_006"><span class="cls_006">chapter 5. The programmer can NOT assume the cache sizes based on the</span></div>
<div style="position:absolute;left:36.00px;top:541.67px" class="cls_006"><span class="cls_006">value of the PrId register; instead, the cache sizes must be explicitly</span></div>
<div style="position:absolute;left:36.00px;top:552.67px" class="cls_006"><span class="cls_006">measured.</span></div>
<div style="position:absolute;left:48.02px;top:563.67px" class="cls_006"><span class="cls_006">The test for the presence of a TLB in an R30xx family CPU is that the TS</span></div>
<div style="position:absolute;left:36.00px;top:574.67px" class="cls_006"><span class="cls_006">bit will be clear in </span><span class="cls_008">SR</span><span class="cls_006"> following a hardware reset.</span></div>
<div style="position:absolute;left:48.02px;top:585.67px" class="cls_006"><span class="cls_006">It is often useful to work out the system clock rate. This can be</span></div>
<div style="position:absolute;left:36.00px;top:596.67px" class="cls_006"><span class="cls_006">accomplished by running a loop of known length, cached, which will take</span></div>
<div style="position:absolute;left:36.00px;top:607.67px" class="cls_006"><span class="cls_006">a fixed large number of CPU cycles, and comparing with ‘‘before’’ and</span></div>
<div style="position:absolute;left:36.00px;top:618.67px" class="cls_006"><span class="cls_006">‘‘after’’ values of a counter which increments at known speed.</span></div>
<div style="position:absolute;left:48.02px;top:629.67px" class="cls_006"><span class="cls_006">Printing out the CPU type, clock rate and cache sizes as part of a sign-</span></div>
<div style="position:absolute;left:36.00px;top:640.67px" class="cls_006"><span class="cls_006">on message may be useful.</span></div>
<div style="position:absolute;left:54.00px;top:686.67px" class="cls_006"><span class="cls_006">† Actually, “7” indicates an IDT specified CP0 architecture. When</span></div>
<div style="position:absolute;left:54.00px;top:698.67px" class="cls_006"><span class="cls_006">the IMP field matches ‘7’, the revision field is used to distinguish</span></div>
<div style="position:absolute;left:54.00px;top:710.67px" class="cls_006"><span class="cls_006">among incompatible CP0’s. In the case of the R3041, the REV field</span></div>
<div style="position:absolute;left:54.00px;top:722.67px" class="cls_006"><span class="cls_006">will match “0”.</span></div>
<div style="position:absolute;left:292.02px;top:755.33px" class="cls_002"><span class="cls_002">7-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:75388px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">RESET INITIALIZATION</span></div>
<div style="position:absolute;left:524.88px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 7</span></div>
<div style="position:absolute;left:216.00px;top:50.00px" class="cls_015"><span class="cls_015">Bootstrap sequences</span></div>
<div style="position:absolute;left:228.02px;top:63.67px" class="cls_006"><span class="cls_006">Start-up code suffers from the clash of two opposing but desirable goals:</span></div>
<div style="position:absolute;left:228.02px;top:77.67px" class="cls_006"><span class="cls_006">• Make minimal assumptions about the integrity of the hardware, and</span></div>
<div style="position:absolute;left:239.97px;top:88.67px" class="cls_006"><span class="cls_006">attempt to check each subsystem before using it (think of climbing a</span></div>
<div style="position:absolute;left:239.97px;top:99.67px" class="cls_006"><span class="cls_006">ladder and trying to check each rung before putting weight on it);</span></div>
<div style="position:absolute;left:228.02px;top:113.67px" class="cls_006"><span class="cls_006">• Minimize the amount of tricky assembler code. Bootstrap sequences</span></div>
<div style="position:absolute;left:239.97px;top:124.67px" class="cls_006"><span class="cls_006">are almost never performance-sensitive, so an early change to a high-</span></div>
<div style="position:absolute;left:239.97px;top:135.67px" class="cls_006"><span class="cls_006">level language is desirable. But high-level language code tends to</span></div>
<div style="position:absolute;left:239.97px;top:146.67px" class="cls_006"><span class="cls_006">require more subsystems to be operational.</span></div>
<div style="position:absolute;left:228.02px;top:157.67px" class="cls_006"><span class="cls_006">After basic initialization (like setting up </span><span class="cls_008">SR</span><span class="cls_006"> so that the CPU can at least</span></div>
<div style="position:absolute;left:216.00px;top:168.67px" class="cls_006"><span class="cls_006">perform loads and stores) the major question is how soon read/write</span></div>
<div style="position:absolute;left:216.00px;top:179.67px" class="cls_006"><span class="cls_006">memory is available to the program, which is essential for calling functions</span></div>
<div style="position:absolute;left:216.00px;top:190.67px" class="cls_006"><span class="cls_006">written in C.</span></div>
<div style="position:absolute;left:228.02px;top:201.67px" class="cls_006"><span class="cls_006">Software has an option here. R30xx family CPUs all have data cache on</span></div>
<div style="position:absolute;left:216.00px;top:212.67px" class="cls_006"><span class="cls_006">chip, and it is reasonable to regard on-chip resources as the lowest rungs</span></div>
<div style="position:absolute;left:216.00px;top:223.67px" class="cls_006"><span class="cls_006">on the ladder. The data cache can provide enough storage for C functions</span></div>
<div style="position:absolute;left:216.00px;top:234.67px" class="cls_006"><span class="cls_006">during bootstrap; memory might be read or written, but provided software</span></div>
<div style="position:absolute;left:216.00px;top:245.67px" class="cls_006"><span class="cls_006">uses less than a cache-size chunk of memory space it will never need to</span></div>
<div style="position:absolute;left:216.00px;top:256.67px" class="cls_006"><span class="cls_006">read memory data back from main memory.</span></div>
<div style="position:absolute;left:216.00px;top:279.00px" class="cls_015"><span class="cls_015">Starting up an application</span></div>
<div style="position:absolute;left:228.02px;top:292.67px" class="cls_006"><span class="cls_006">To be able to start a C application the system needs:</span></div>
<div style="position:absolute;left:228.02px;top:306.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:306.67px" class="cls_008"><span class="cls_008">Stack space</span><span class="cls_006">: assign a large enough piece of writable memory and</span></div>
<div style="position:absolute;left:239.97px;top:317.67px" class="cls_006"><span class="cls_006">initialize the </span><span class="cls_008">sp</span><span class="cls_006"> register to its upper limit</span></div>
<div style="position:absolute;left:466.68px;top:317.67px" class="cls_006"><span class="cls_006">(aligned to an 8-byte</span></div>
<div style="position:absolute;left:239.98px;top:328.67px" class="cls_006"><span class="cls_006">boundary). Working out how large the stack should be can be</span></div>
<div style="position:absolute;left:239.98px;top:339.67px" class="cls_006"><span class="cls_006">difficult, so a large guess helps.</span></div>
<div style="position:absolute;left:228.03px;top:353.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:353.67px" class="cls_006"><span class="cls_006">Many systems implement a strategy of determining the amount of</span></div>
<div style="position:absolute;left:239.98px;top:364.67px" class="cls_006"><span class="cls_006">system RAM available, and assigning the start of the stack to the top</span></div>
<div style="position:absolute;left:239.98px;top:375.67px" class="cls_006"><span class="cls_006">of physical RAM. This is the technique used by IDT/sim. With such a</span></div>
<div style="position:absolute;left:239.98px;top:386.67px" class="cls_006"><span class="cls_006">strategy, the stack can have as much RAM as is available in the</span></div>
<div style="position:absolute;left:239.98px;top:397.67px" class="cls_006"><span class="cls_006">system, after the program.</span></div>
<div style="position:absolute;left:228.03px;top:411.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:411.67px" class="cls_008"><span class="cls_008">Initialized data</span><span class="cls_006">: normally the C data area is initialized by the program</span></div>
<div style="position:absolute;left:239.98px;top:422.67px" class="cls_006"><span class="cls_006">loader to set up any variables which have been allocated values. Some</span></div>
<div style="position:absolute;left:239.98px;top:433.67px" class="cls_006"><span class="cls_006">compilation systems permit read-only data (implicit strings and data</span></div>
<div style="position:absolute;left:239.98px;top:444.67px" class="cls_006"><span class="cls_006">items declared </span><span class="cls_008">const</span><span class="cls_006">) to be managed in a separate ‘‘segment’’ of object</span></div>
<div style="position:absolute;left:239.98px;top:455.67px" class="cls_006"><span class="cls_006">code and put into ROM memory.</span></div>
<div style="position:absolute;left:239.98px;top:469.67px" class="cls_006"><span class="cls_006">Initialized writable data can be used only if the compilation system</span></div>
<div style="position:absolute;left:239.98px;top:480.67px" class="cls_006"><span class="cls_006">and run-time system co-operate to arrange to copy writable data</span></div>
<div style="position:absolute;left:239.98px;top:491.67px" class="cls_006"><span class="cls_006">initialization from ROM into RAM. IDT/sim provides code which does</span></div>
<div style="position:absolute;left:239.98px;top:502.67px" class="cls_006"><span class="cls_006">this for the IDT/c and MIPS compilers.</span></div>
<div style="position:absolute;left:228.03px;top:516.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:516.67px" class="cls_008"><span class="cls_008">Zeroed data (bss)</span><span class="cls_006">: in C all </span><span class="cls_008">static</span><span class="cls_006"> and </span><span class="cls_008">extern</span><span class="cls_006"> data items which are not</span></div>
<div style="position:absolute;left:239.98px;top:527.67px" class="cls_006"><span class="cls_006">explicitly initialized will be set up with a zero value. The compilation</span></div>
<div style="position:absolute;left:239.98px;top:538.67px" class="cls_006"><span class="cls_006">system may provide a routine for use at run time which zeroes the</span></div>
<div style="position:absolute;left:239.98px;top:549.67px" class="cls_006"><span class="cls_006">data segments.</span></div>
<div style="position:absolute;left:228.03px;top:563.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:563.67px" class="cls_008"><span class="cls_008">global pointer initialization</span><span class="cls_006">: some compilation systems use the </span><span class="cls_008">gp</span></div>
<div style="position:absolute;left:239.98px;top:574.67px" class="cls_006"><span class="cls_006">register for more efficient access to global variables. If the system</span></div>
<div style="position:absolute;left:239.98px;top:585.67px" class="cls_006"><span class="cls_006">software is compiled with this option, the OS must set the register to</span></div>
<div style="position:absolute;left:239.98px;top:596.67px" class="cls_006"><span class="cls_006">the right value.</span></div>
<div style="position:absolute;left:228.03px;top:610.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:610.67px" class="cls_008"><span class="cls_008">Extra effort needed</span><span class="cls_006">: routines which may cause non-fatal exceptions</span></div>
<div style="position:absolute;left:239.98px;top:621.67px" class="cls_006"><span class="cls_006">require more run-time support. In particular, software should be</span></div>
<div style="position:absolute;left:239.98px;top:632.67px" class="cls_006"><span class="cls_006">aware that the architecture permits the FPA to abort an instruction</span></div>
<div style="position:absolute;left:239.98px;top:643.67px" class="cls_006"><span class="cls_006">with  the</span></div>
<div style="position:absolute;left:291.44px;top:643.67px" class="cls_006"><span class="cls_006">‘‘illegal  opcode’’  trap  when  confronted  with  legal</span></div>
<div style="position:absolute;left:556.35px;top:643.67px" class="cls_006"><span class="cls_006">(but</span></div>
<div style="position:absolute;left:239.98px;top:654.67px" class="cls_006"><span class="cls_006">unusual) operand values (see the chapter on FPA architecture, later</span></div>
<div style="position:absolute;left:239.98px;top:665.67px" class="cls_006"><span class="cls_006">in this manual). Many ordinary arithmetic operations will produce an</span></div>
<div style="position:absolute;left:239.98px;top:676.67px" class="cls_006"><span class="cls_006">exception if they overflow.</span></div>
<div style="position:absolute;left:305.77px;top:755.33px" class="cls_002"><span class="cls_002">7-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:76190px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">FLOATING POINT CO-</span></div>
<div style="position:absolute;left:491.33px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 8</span></div>
<div style="position:absolute;left:222.89px;top:56.33px" class="cls_005"><span class="cls_005">PROCESSOR</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:228.02px;top:113.67px" class="cls_006"><span class="cls_006">In</span></div>
<div style="position:absolute;left:244.39px;top:113.67px" class="cls_006"><span class="cls_006">1987 the MIPS FPA set a new benchmark for performance for</span></div>
<div style="position:absolute;left:216.00px;top:124.67px" class="cls_006"><span class="cls_006">microprocessor math performance. The FPA was a leading-edge silicon</span></div>
<div style="position:absolute;left:216.00px;top:135.67px" class="cls_006"><span class="cls_006">design bristling with innovation and ingenuity.</span></div>
<div style="position:absolute;left:228.02px;top:146.67px" class="cls_006"><span class="cls_006">In the R30xx family, the R3081 contains this same FPA device, providing</span></div>
<div style="position:absolute;left:216.00px;top:157.67px" class="cls_006"><span class="cls_006">a combination of large caches, and high-performance integer and floating-</span></div>
<div style="position:absolute;left:216.00px;top:168.67px" class="cls_006"><span class="cls_006">point computation. This chapter describes the architecture of the FPA on-</span></div>
<div style="position:absolute;left:216.00px;top:179.67px" class="cls_006"><span class="cls_006">board the R3081 CPU.</span></div>
<div style="position:absolute;left:216.00px;top:202.00px" class="cls_015"><span class="cls_015">THE IEEE754 STANDARD AND ITS BACKGROUND</span></div>
<div style="position:absolute;left:228.02px;top:215.67px" class="cls_006"><span class="cls_006">Floating point deals with the approximate representations of numbers</span></div>
<div style="position:absolute;left:216.00px;top:226.67px" class="cls_006"><span class="cls_006">(in the same way as decimals do); early computer implementations differed</span></div>
<div style="position:absolute;left:216.00px;top:237.67px" class="cls_006"><span class="cls_006">in the details of their behavior with very small or large numbers. This</span></div>
<div style="position:absolute;left:216.00px;top:248.67px" class="cls_006"><span class="cls_006">meant that numerical routines, identically coded, might behave differently.</span></div>
<div style="position:absolute;left:216.00px;top:259.67px" class="cls_006"><span class="cls_006">In some sense these differences shouldn’t have mattered; systems would</span></div>
<div style="position:absolute;left:216.00px;top:270.67px" class="cls_006"><span class="cls_006">only produce different answers in circumstances where no implementation</span></div>
<div style="position:absolute;left:216.00px;top:281.67px" class="cls_006"><span class="cls_006">could really produce a ‘‘correct’’ answer.</span></div>
<div style="position:absolute;left:228.02px;top:292.67px" class="cls_006"><span class="cls_006">Numerical routines are hard to prove correct. Small differences in values</span></div>
<div style="position:absolute;left:216.00px;top:303.67px" class="cls_006"><span class="cls_006">could accumulate and could mean, for example, that a routine relying on</span></div>
<div style="position:absolute;left:216.00px;top:314.67px" class="cls_006"><span class="cls_006">repeated approximation might converge to the correct result on one CPU,</span></div>
<div style="position:absolute;left:216.00px;top:325.67px" class="cls_006"><span class="cls_006">and fail to do so on another.</span></div>
<div style="position:absolute;left:228.02px;top:336.67px" class="cls_006"><span class="cls_006">The  IEEE754  standard</span></div>
<div style="position:absolute;left:357.71px;top:336.67px" class="cls_006"><span class="cls_006">(in  full</span></div>
<div style="position:absolute;left:402.37px;top:336.67px" class="cls_006"><span class="cls_006">‘‘ANSI/IEEE  Std</span></div>
<div style="position:absolute;left:494.63px;top:336.67px" class="cls_006"><span class="cls_006">754-1985  IEEE</span></div>
<div style="position:absolute;left:216.00px;top:347.67px" class="cls_006"><span class="cls_006">Standard for Binary Floating-Point Arithmetic’’) was introduced to bring</span></div>
<div style="position:absolute;left:216.00px;top:358.67px" class="cls_006"><span class="cls_006">order to this situation. The standard defines exactly what result will be</span></div>
<div style="position:absolute;left:216.00px;top:369.67px" class="cls_006"><span class="cls_006">produced by a small class of basic operations, even under extreme</span></div>
<div style="position:absolute;left:216.00px;top:380.67px" class="cls_006"><span class="cls_006">situations, ensuring that programmers can obtain identical results from</span></div>
<div style="position:absolute;left:216.00px;top:391.67px" class="cls_006"><span class="cls_006">identical inputs regardless of the machine used. IEEE754 has perhaps too</span></div>
<div style="position:absolute;left:216.00px;top:402.67px" class="cls_006"><span class="cls_006">many options, but is a huge improvement on the chaos which motivated</span></div>
<div style="position:absolute;left:216.00px;top:413.67px" class="cls_006"><span class="cls_006">it; since it became a real international standard in 1985, it has become the</span></div>
<div style="position:absolute;left:216.00px;top:424.67px" class="cls_006"><span class="cls_006">basis for all new implementations.</span></div>
<div style="position:absolute;left:228.02px;top:435.67px" class="cls_006"><span class="cls_006">The operations regulated by IEEE754 include every operation which any</span></div>
<div style="position:absolute;left:216.00px;top:446.67px" class="cls_006"><span class="cls_006">MIPS R3000 FPA can do in hardware, plus some that must be emulated by</span></div>
<div style="position:absolute;left:216.00px;top:457.67px" class="cls_006"><span class="cls_006">software. IEEE754 legislates for:</span></div>
<div style="position:absolute;left:228.02px;top:471.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Rounding  and  precision  of  results</span><span class="cls_006">:  even  results  of  the  simplest</span></div>
<div style="position:absolute;left:239.98px;top:482.67px" class="cls_006"><span class="cls_006">operations may not be representable as finite fractions - in decimals</span></div>
<div style="position:absolute;left:361.58px;top:501.00px" class="cls_035"><span class="cls_035">1</span><span class="cls_021">⁄</span><span class="cls_035">3</span></div>
<div style="position:absolute;left:381.07px;top:501.00px" class="cls_035"><span class="cls_035">= 0.3333</span><span class="cls_021">…</span></div>
<div style="position:absolute;left:239.98px;top:520.67px" class="cls_006"><span class="cls_006">is infinitely recurring and can’t be written precisely. IEEE754 allows</span></div>
<div style="position:absolute;left:239.98px;top:531.67px" class="cls_006"><span class="cls_006">the user to choose between four options: round up, round down,</span></div>
<div style="position:absolute;left:239.98px;top:542.67px" class="cls_006"><span class="cls_006">round towards zero and round to nearest. The rounded result will be</span></div>
<div style="position:absolute;left:239.98px;top:553.67px" class="cls_006"><span class="cls_006">that which would have been achieved by computing with infinite</span></div>
<div style="position:absolute;left:239.98px;top:564.67px" class="cls_006"><span class="cls_006">precision and then rounding. This would leave an ambiguity in</span></div>
<div style="position:absolute;left:239.98px;top:575.67px" class="cls_006"><span class="cls_006">‘‘round to nearest’’ when the infinite-precision result is exactly half-</span></div>
<div style="position:absolute;left:239.98px;top:586.67px" class="cls_006"><span class="cls_006">way between two representable forms; the rules provide that in this</span></div>
<div style="position:absolute;left:239.98px;top:597.67px" class="cls_006"><span class="cls_006">cas, rounding towards zero is proper.</span></div>
<div style="position:absolute;left:228.03px;top:611.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> When is a result exceptional?</span><span class="cls_006">: IEEE754 has its own meaning for the</span></div>
<div style="position:absolute;left:239.98px;top:622.67px" class="cls_006"><span class="cls_006">word ‘‘exception’’. A computation can produce a result which is:</span></div>
<div style="position:absolute;left:228.03px;top:636.67px" class="cls_006"><span class="cls_006">a)</span></div>
<div style="position:absolute;left:264.03px;top:636.67px" class="cls_006"><span class="cls_006">nonsense, such as the square root of -1 (‘‘invalid’’);</span></div>
<div style="position:absolute;left:228.03px;top:650.67px" class="cls_006"><span class="cls_006">b)</span></div>
<div style="position:absolute;left:264.03px;top:650.67px" class="cls_006"><span class="cls_006">‘‘division by zero’’ is given special treatment;</span></div>
<div style="position:absolute;left:228.03px;top:664.67px" class="cls_006"><span class="cls_006">c)</span></div>
<div style="position:absolute;left:264.03px;top:664.67px" class="cls_006"><span class="cls_006">too big to represent (‘‘overflow’’);</span></div>
<div style="position:absolute;left:228.03px;top:678.67px" class="cls_006"><span class="cls_006">d)</span></div>
<div style="position:absolute;left:264.03px;top:678.67px" class="cls_006"><span class="cls_006">so  small  that  its  representation  becomes  problematic  and</span></div>
<div style="position:absolute;left:264.03px;top:689.67px" class="cls_006"><span class="cls_006">precision is lost (‘‘underflow’’);</span></div>
<div style="position:absolute;left:228.03px;top:703.67px" class="cls_006"><span class="cls_006">e)</span></div>
<div style="position:absolute;left:264.03px;top:703.67px" class="cls_006"><span class="cls_006">not perfectly represented, like 1/3 (‘‘inexact’’). This is usually</span></div>
<div style="position:absolute;left:264.03px;top:714.67px" class="cls_006"><span class="cls_006">ignored.</span></div>
<div style="position:absolute;left:299.28px;top:754.68px" class="cls_002"><span class="cls_002">8-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:76992px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 8</span></div>
<div style="position:absolute;left:409.31px;top:28.00px" class="cls_002"><span class="cls_002">FLOATING POINT CO-PROCESSOR</span></div>
<div style="position:absolute;left:59.98px;top:50.67px" class="cls_006"><span class="cls_006">All these are bundled together and described as ‘‘exceptional’’.</span></div>
<div style="position:absolute;left:48.03px;top:64.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Action taken on IEEE exception</span><span class="cls_006">: for each exception class listed above</span></div>
<div style="position:absolute;left:59.97px;top:75.67px" class="cls_006"><span class="cls_006">the user can opt:</span></div>
<div style="position:absolute;left:48.02px;top:89.67px" class="cls_006"><span class="cls_006">a)</span></div>
<div style="position:absolute;left:84.02px;top:89.67px" class="cls_006"><span class="cls_006">To ignore the problem, in which case the standard lays down</span></div>
<div style="position:absolute;left:84.02px;top:100.67px" class="cls_006"><span class="cls_006">what value will be produced. Overflows and division by zero</span></div>
<div style="position:absolute;left:84.02px;top:111.67px" class="cls_006"><span class="cls_006">generate ‘‘infinity’’ (with a positive and negative type); invalid</span></div>
<div style="position:absolute;left:84.02px;top:122.67px" class="cls_006"><span class="cls_006">operations generate ‘‘NaN’’ (for Not a Number) in two flavors</span></div>
<div style="position:absolute;left:84.02px;top:133.67px" class="cls_006"><span class="cls_006">called ‘‘Quiet’’ and ‘‘Signalling’’.</span></div>
<div style="position:absolute;left:84.02px;top:147.67px" class="cls_006"><span class="cls_006">The standard defines the results when operations are carried out</span></div>
<div style="position:absolute;left:84.02px;top:158.67px" class="cls_006"><span class="cls_006">on exceptional values (most often a NaN). A Quiet Nan as</span></div>
<div style="position:absolute;left:84.02px;top:169.67px" class="cls_006"><span class="cls_006">operand will not cause another exception (though the result will</span></div>
<div style="position:absolute;left:84.02px;top:180.67px" class="cls_006"><span class="cls_006">be a NaN too). A Signalling NaN causes an exception whenever it</span></div>
<div style="position:absolute;left:84.02px;top:191.67px" class="cls_006"><span class="cls_006">is used.</span></div>
<div style="position:absolute;left:48.02px;top:205.67px" class="cls_006"><span class="cls_006">b)</span></div>
<div style="position:absolute;left:84.02px;top:205.67px" class="cls_006"><span class="cls_006">To have the computation interrupted, and the user program</span></div>
<div style="position:absolute;left:84.02px;top:216.67px" class="cls_006"><span class="cls_006">signalled in some OS- and language-dependent manner.</span></div>
<div style="position:absolute;left:59.97px;top:230.67px" class="cls_006"><span class="cls_006">Most programs leave all the IEEE exceptions off, but do rely on the</span></div>
<div style="position:absolute;left:59.97px;top:241.67px" class="cls_006"><span class="cls_006">system producing the right exceptional values.</span></div>
<div style="position:absolute;left:36.00px;top:264.00px" class="cls_015"><span class="cls_015">WHAT IS FLOATING POINT?</span></div>
<div style="position:absolute;left:48.02px;top:277.67px" class="cls_006"><span class="cls_006">This section describes the various components of the data (always using</span></div>
<div style="position:absolute;left:36.00px;top:288.67px" class="cls_006"><span class="cls_006">the same bit-arrangement as does the MIPS implementation) and what</span></div>
<div style="position:absolute;left:36.00px;top:299.67px" class="cls_006"><span class="cls_006">they mean. Many readers will feel familiar with these concepts already;</span></div>
<div style="position:absolute;left:36.00px;top:310.67px" class="cls_006"><span class="cls_006">however, this section can still prove useful in providing insight to the</span></div>
<div style="position:absolute;left:36.00px;top:321.67px" class="cls_006"><span class="cls_006">R3081 treatment of these concepts.</span></div>
<div style="position:absolute;left:48.02px;top:332.67px" class="cls_006"><span class="cls_006">Scientists wanting to write numbers which may be very large or very</span></div>
<div style="position:absolute;left:36.00px;top:343.67px" class="cls_006"><span class="cls_006">small are used to using exponential notation; so the distance from Earth</span></div>
<div style="position:absolute;left:36.00px;top:354.67px" class="cls_006"><span class="cls_006">to the Sun is:</span></div>
<div style="position:absolute;left:187.55px;top:373.00px" class="cls_035"><span class="cls_035">93</span></div>
<div style="position:absolute;left:198.80px;top:373.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:205.98px;top:372.23px" class="cls_035"><span class="cls_035">10</span><span class="cls_036"><sup>6</sup></span></div>
<div style="position:absolute;left:219.46px;top:373.00px" class="cls_035"><span class="cls_035">miles</span></div>
<div style="position:absolute;left:48.02px;top:392.67px" class="cls_006"><span class="cls_006">The number is defined by ‘‘93’’, the </span><span class="cls_008">mantissa</span><span class="cls_006">†, and ‘‘6’’, the </span><span class="cls_008">exponent</span><span class="cls_006">. Of</span></div>
<div style="position:absolute;left:36.00px;top:403.67px" class="cls_006"><span class="cls_006">course the same distance can be written:</span></div>
<div style="position:absolute;left:186.43px;top:421.99px" class="cls_035"><span class="cls_035">9.3</span></div>
<div style="position:absolute;left:199.93px;top:422.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:207.11px;top:421.23px" class="cls_035"><span class="cls_035">10</span><span class="cls_036"><sup>7</sup></span></div>
<div style="position:absolute;left:220.58px;top:422.00px" class="cls_035"><span class="cls_035">miles</span></div>
<div style="position:absolute;left:48.02px;top:441.67px" class="cls_006"><span class="cls_006">Numerical analysts like to use the second form; a decimal exponential</span></div>
<div style="position:absolute;left:36.00px;top:452.67px" class="cls_006"><span class="cls_006">with a mantissa between 1.0 and 9.999... is called </span><span class="cls_008">normalized</span><span class="cls_006">. The</span></div>
<div style="position:absolute;left:36.00px;top:463.67px" class="cls_006"><span class="cls_006">normalized form is useful for computer representation, since it doesn’t</span></div>
<div style="position:absolute;left:36.00px;top:474.67px" class="cls_006"><span class="cls_006">require separate information about the position of the decimal point.</span></div>
<div style="position:absolute;left:48.02px;top:485.67px" class="cls_006"><span class="cls_006">Floating point numbers are an exponential form, but base 2, not base</span></div>
<div style="position:absolute;left:36.00px;top:496.67px" class="cls_006"><span class="cls_006">10. Not only are the mantissa and exponent held as binary fields, but the</span></div>
<div style="position:absolute;left:36.00px;top:507.67px" class="cls_006"><span class="cls_006">number is formed differently. The distance quoted above is:</span></div>
<div style="position:absolute;left:146.43px;top:526.00px" class="cls_035"><span class="cls_035">1.3858079910278320312</span></div>
<div style="position:absolute;left:240.92px;top:526.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:248.11px;top:525.23px" class="cls_035"><span class="cls_035">2</span><span class="cls_036"><sup>26</sup></span></div>
<div style="position:absolute;left:260.58px;top:526.00px" class="cls_035"><span class="cls_035">miles</span></div>
<div style="position:absolute;left:48.02px;top:545.67px" class="cls_006"><span class="cls_006">The mantissa can be expressed as a binary ‘‘decimal’’, which is just like</span></div>
<div style="position:absolute;left:36.00px;top:556.67px" class="cls_006"><span class="cls_006">a real decimal:</span></div>
<div style="position:absolute;left:77.31px;top:574.99px" class="cls_035"><span class="cls_035">1.3858079910278320312 = 1 + 3</span><span class="cls_021"> ×</span><span class="cls_035"> 1</span><span class="cls_021"> ⁄</span><span class="cls_035"> 10 + 8</span><span class="cls_021"> ×</span><span class="cls_035"> 1</span><span class="cls_021"> ⁄</span><span class="cls_035"> 100 + 5</span><span class="cls_021"> ×</span><span class="cls_035"> 1</span><span class="cls_021"> ⁄</span><span class="cls_035"> 1000 +</span><span class="cls_021"> …</span></div>
<div style="position:absolute;left:48.02px;top:594.67px" class="cls_006"><span class="cls_006">is the same value as binary:</span></div>
<div style="position:absolute;left:97.56px;top:612.99px" class="cls_035"><span class="cls_035">1.0110001011000101 = 1 + 0</span><span class="cls_021"> ×</span><span class="cls_035"> 1</span><span class="cls_021"> ⁄</span><span class="cls_035"> 2 + 1</span><span class="cls_021"> ×</span><span class="cls_035"> 1</span><span class="cls_021"> ⁄</span><span class="cls_035"> 4 + 1</span><span class="cls_021"> ×</span><span class="cls_035"> 1</span><span class="cls_021"> ⁄</span><span class="cls_035"> 8 +</span><span class="cls_021"> …</span></div>
<div style="position:absolute;left:48.02px;top:632.67px" class="cls_006"><span class="cls_006">However, neither the mantissa nor the exponent are stored just like this</span></div>
<div style="position:absolute;left:36.00px;top:643.67px" class="cls_006"><span class="cls_006">in IEEE formats.</span></div>
<div style="position:absolute;left:54.00px;top:710.67px" class="cls_006"><span class="cls_006">† The mantissa may also be called ‘‘the fractional part’’ or</span></div>
<div style="position:absolute;left:54.00px;top:722.67px" class="cls_006"><span class="cls_006">‘‘fraction’’</span></div>
<div style="position:absolute;left:292.03px;top:755.33px" class="cls_002"><span class="cls_002">8-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:77794px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FLOATING POINT CO-PROCESSOR</span></div>
<div style="position:absolute;left:525.08px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 8</span></div>
<div style="position:absolute;left:216.00px;top:50.00px" class="cls_015"><span class="cls_015">IEEE exponent field and bias</span></div>
<div style="position:absolute;left:228.02px;top:63.67px" class="cls_006"><span class="cls_006">The exponent is not stored as a signed binary number, but </span><span class="cls_008">biased</span><span class="cls_006"> so</span></div>
<div style="position:absolute;left:216.00px;top:74.67px" class="cls_006"><span class="cls_006">that the exponent field remains positive for the most negative legitimate</span></div>
<div style="position:absolute;left:216.00px;top:85.67px" class="cls_006"><span class="cls_006">exponent value; for the 64-bit IEEE format the exponent field is 11 bits</span></div>
<div style="position:absolute;left:216.00px;top:96.67px" class="cls_006"><span class="cls_006">long, so the bias is:</span></div>
<div style="position:absolute;left:364.50px;top:114.24px" class="cls_035"><span class="cls_035">2</span><span class="cls_036"><sup>10</sup></span></div>
<div style="position:absolute;left:378.68px;top:115.00px" class="cls_035"><span class="cls_035">-</span></div>
<div style="position:absolute;left:385.43px;top:115.00px" class="cls_035"><span class="cls_035">1</span></div>
<div style="position:absolute;left:394.42px;top:115.00px" class="cls_035"><span class="cls_035">= 1023</span></div>
<div style="position:absolute;left:228.02px;top:134.67px" class="cls_006"><span class="cls_006">For a number</span></div>
<div style="position:absolute;left:362.87px;top:152.99px" class="cls_037"><span class="cls_037">mantissa</span></div>
<div style="position:absolute;left:400.71px;top:153.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:407.89px;top:152.24px" class="cls_035"><span class="cls_035">2</span><span class="cls_038"><sup>exp</sup></span></div>
<div style="position:absolute;left:228.02px;top:172.67px" class="cls_006"><span class="cls_006">the exponent field will contain:</span></div>
<div style="position:absolute;left:361.38px;top:190.99px" class="cls_037"><span class="cls_037">exponent</span><span class="cls_035"> + 1023</span></div>
<div style="position:absolute;left:228.02px;top:210.67px" class="cls_006"><span class="cls_006">The biased exponent (together with careful ordering of the fields) has the</span></div>
<div style="position:absolute;left:216.00px;top:221.67px" class="cls_006"><span class="cls_006">rather useful effect of ensuring that FP comparisons (equality, greater</span></div>
<div style="position:absolute;left:216.00px;top:232.67px" class="cls_006"><span class="cls_006">than, less than, etc.) have the same result as would be obtained from</span></div>
<div style="position:absolute;left:216.00px;top:243.67px" class="cls_006"><span class="cls_006">comparing two signed integers composed of the same bits. FP compare</span></div>
<div style="position:absolute;left:216.00px;top:254.67px" class="cls_006"><span class="cls_006">operations can therefore be provided by cheap, fast and familiar logic.</span></div>
<div style="position:absolute;left:228.02px;top:265.67px" class="cls_006"><span class="cls_006">Only exponents from 1 through 2046 represent ordinary numbers; the</span></div>
<div style="position:absolute;left:216.00px;top:276.67px" class="cls_006"><span class="cls_006">biggest and smallest exponent field values (all-zeroes and all ones) are</span></div>
<div style="position:absolute;left:216.00px;top:287.67px" class="cls_006"><span class="cls_006">reserved for special purposes, described later.</span></div>
<div style="position:absolute;left:216.00px;top:310.00px" class="cls_015"><span class="cls_015">IEEE mantissa and normalization</span></div>
<div style="position:absolute;left:228.02px;top:323.67px" class="cls_006"><span class="cls_006">The IEEE format defines a single sign bit separate from the mantissa, (0</span></div>
<div style="position:absolute;left:216.00px;top:334.67px" class="cls_006"><span class="cls_006">for positive, 1 for negative). So the stored mantissa only has to represent</span></div>
<div style="position:absolute;left:216.00px;top:345.67px" class="cls_006"><span class="cls_006">positive numbers. All properly-represented numbers in IEEE format are</span></div>
<div style="position:absolute;left:216.00px;top:356.67px" class="cls_006"><span class="cls_006">normalized, so</span></div>
<div style="position:absolute;left:361.51px;top:374.99px" class="cls_035"><span class="cls_035">1</span><span class="cls_021">≤</span><span class="cls_037">mantissa</span><span class="cls_021">&lt;</span><span class="cls_035">2</span></div>
<div style="position:absolute;left:228.02px;top:394.67px" class="cls_006"><span class="cls_006">This means that the most significant bit of the mantissa (the single</span></div>
<div style="position:absolute;left:216.00px;top:405.67px" class="cls_006"><span class="cls_006">binary digit before the point) is always a ‘‘1’’ - so it doesn’t actually need to</span></div>
<div style="position:absolute;left:216.00px;top:416.67px" class="cls_006"><span class="cls_006">be stored. The IEEE standard calls this the </span><span class="cls_008">hidden</span><span class="cls_006"> bit.</span></div>
<div style="position:absolute;left:228.02px;top:427.67px" class="cls_006"><span class="cls_006">So now the number 93,000,000, whose normalized representation has</span></div>
<div style="position:absolute;left:216.00px;top:438.67px" class="cls_006"><span class="cls_006">a binary mantissa of 1.01100010110001000101 and a binary exponent of</span></div>
<div style="position:absolute;left:216.00px;top:449.67px" class="cls_006"><span class="cls_006">26, is represented in IEEE 64-bit format by setting the fields:</span></div>
<div style="position:absolute;left:307.01px;top:467.99px" class="cls_037"><span class="cls_037">mantissafield</span><span class="cls_035"> = 011000101100010001010</span><span class="cls_021">…</span></div>
<div style="position:absolute;left:318.00px;top:505.99px" class="cls_037"><span class="cls_037">exponentfield</span><span class="cls_035"> = 1049 = 10000011001</span></div>
<div style="position:absolute;left:228.02px;top:525.67px" class="cls_006"><span class="cls_006">Looking at it the other way; a 64-bit IEEE number with an exponent field</span></div>
<div style="position:absolute;left:216.00px;top:536.67px" class="cls_006"><span class="cls_006">of </span><span class="cls_008">E</span><span class="cls_006"> and a mantissa field of </span><span class="cls_008">m</span><span class="cls_006"> represents the number </span><span class="cls_008">num</span><span class="cls_006"> where:</span></div>
<div style="position:absolute;left:351.22px;top:554.98px" class="cls_037"><span class="cls_037">num</span></div>
<div style="position:absolute;left:372.22px;top:555.00px" class="cls_035"><span class="cls_035">=</span></div>
<div style="position:absolute;left:381.78px;top:554.98px" class="cls_035"><span class="cls_035">1.</span><span class="cls_037">m</span></div>
<div style="position:absolute;left:397.79px;top:555.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:404.97px;top:554.23px" class="cls_035"><span class="cls_035">2</span><span class="cls_038">E</span><span class="cls_036">-1023</span></div>
<div style="position:absolute;left:228.02px;top:574.67px" class="cls_006"><span class="cls_006">(‘‘1.m’’ represents the binary fraction with 1 before the point and the</span></div>
<div style="position:absolute;left:216.01px;top:585.67px" class="cls_006"><span class="cls_006">mantissa field contents after it).</span></div>
<div style="position:absolute;left:216.00px;top:608.00px" class="cls_015"><span class="cls_015">Strange values use reserved exponent values</span></div>
<div style="position:absolute;left:228.02px;top:621.67px" class="cls_006"><span class="cls_006">The smallest and biggest exponent field values are used to represent</span></div>
<div style="position:absolute;left:216.00px;top:632.67px" class="cls_006"><span class="cls_006">otherwise-illegal quantities:</span></div>
<div style="position:absolute;left:228.02px;top:646.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> E</span></div>
<div style="position:absolute;left:254.68px;top:646.67px" class="cls_008"><span class="cls_008">==</span></div>
<div style="position:absolute;left:274.58px;top:646.67px" class="cls_008"><span class="cls_008">0</span><span class="cls_006">:  used  to  represent  zero</span></div>
<div style="position:absolute;left:425.96px;top:646.67px" class="cls_006"><span class="cls_006">(with  a  zero  mantissa)  and</span></div>
<div style="position:absolute;left:239.98px;top:657.67px" class="cls_006"><span class="cls_006">‘‘denormalized’’   forms,   where   the   number   is   too   small.   The</span></div>
<div style="position:absolute;left:239.98px;top:668.67px" class="cls_006"><span class="cls_006">denormalized number with E zero and mantissa </span><span class="cls_008">m</span><span class="cls_006"> represents </span><span class="cls_008">num</span></div>
<div style="position:absolute;left:239.98px;top:679.67px" class="cls_006"><span class="cls_006">where:</span></div>
<div style="position:absolute;left:355.04px;top:698.00px" class="cls_037"><span class="cls_037">num</span></div>
<div style="position:absolute;left:376.03px;top:698.00px" class="cls_035"><span class="cls_035">=</span></div>
<div style="position:absolute;left:385.60px;top:698.00px" class="cls_035"><span class="cls_035">0.</span><span class="cls_037">m</span></div>
<div style="position:absolute;left:401.60px;top:698.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:408.78px;top:697.23px" class="cls_035"><span class="cls_035">2</span><span class="cls_036"><sup>-1022</sup></span></div>
<div style="position:absolute;left:305.78px;top:755.33px" class="cls_002"><span class="cls_002">8-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:78596px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 8</span></div>
<div style="position:absolute;left:409.31px;top:28.00px" class="cls_002"><span class="cls_002">FLOATING POINT CO-PROCESSOR</span></div>
<div style="position:absolute;left:59.98px;top:50.67px" class="cls_006"><span class="cls_006">No R3000 series MIPS FPA is able to cope with either generating or</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">computing with denormalized numbers, and operations creating or</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">involving them will be punted to the software exception handler. The</span></div>
<div style="position:absolute;left:59.98px;top:83.67px" class="cls_006"><span class="cls_006">R4600 can be configured to replace denormalized results by zero and</span></div>
<div style="position:absolute;left:59.98px;top:94.67px" class="cls_006"><span class="cls_006">keep going.</span></div>
<div style="position:absolute;left:48.03px;top:108.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> E == 111...1</span><span class="cls_006">: (i.e. the binary representation of 2047 in the 11-bit field</span></div>
<div style="position:absolute;left:59.97px;top:119.67px" class="cls_006"><span class="cls_006">used for an IEEE double) is used to represent:</span></div>
<div style="position:absolute;left:48.02px;top:133.67px" class="cls_006"><span class="cls_006">a)</span></div>
<div style="position:absolute;left:84.02px;top:133.67px" class="cls_006"><span class="cls_006">with   the   mantissa   zero,   the</span></div>
<div style="position:absolute;left:257.22px;top:133.67px" class="cls_006"><span class="cls_006">‘‘illegal’’   values</span></div>
<div style="position:absolute;left:346.74px;top:133.67px" class="cls_006"><span class="cls_006">+inf,</span></div>
<div style="position:absolute;left:379.30px;top:133.67px" class="cls_006"><span class="cls_006">-inf</span></div>
<div style="position:absolute;left:84.02px;top:144.67px" class="cls_006"><span class="cls_006">(distinguished by the usual sign bit);</span></div>
<div style="position:absolute;left:48.02px;top:158.67px" class="cls_006"><span class="cls_006">b)</span></div>
<div style="position:absolute;left:84.02px;top:158.67px" class="cls_006"><span class="cls_006">with the mantissa non-zero, it is a NaN. For MIPS, the most</span></div>
<div style="position:absolute;left:84.02px;top:169.67px" class="cls_006"><span class="cls_006">significant bit of the mantissa determines whether the NaN is</span></div>
<div style="position:absolute;left:84.02px;top:180.67px" class="cls_006"><span class="cls_006">quiet (ms bit zero) or signalling (ms bit one).</span></div>
<div style="position:absolute;left:36.00px;top:203.00px" class="cls_015"><span class="cls_015">MIPS FP Data formats</span></div>
<div style="position:absolute;left:48.02px;top:216.67px" class="cls_006"><span class="cls_006">The MIPS architecture uses two FP formats recommended by IEEE754:</span></div>
<div style="position:absolute;left:48.02px;top:230.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Single precision</span><span class="cls_006">: fitted into 32 bits of storage. Compilers for MIPS use</span></div>
<div style="position:absolute;left:59.98px;top:241.67px" class="cls_006"><span class="cls_006">single precision for </span><span class="cls_008">float</span><span class="cls_006"> variables.</span></div>
<div style="position:absolute;left:48.02px;top:255.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Double precision</span><span class="cls_006">: uses 64 bits of storage. C compilers use double</span></div>
<div style="position:absolute;left:59.97px;top:266.67px" class="cls_006"><span class="cls_006">precision for C </span><span class="cls_008">double</span><span class="cls_006"> types.</span></div>
<div style="position:absolute;left:48.02px;top:277.67px" class="cls_006"><span class="cls_006">The memory and register layout is shown in Table 8.1, “Floating point</span></div>
<div style="position:absolute;left:36.00px;top:288.67px" class="cls_006"><span class="cls_006">data formats”, with some examples of how the data works out. Note that</span></div>
<div style="position:absolute;left:36.00px;top:299.67px" class="cls_006"><span class="cls_006">the </span><span class="cls_008">float</span><span class="cls_006"> representation can’t hold a number as big as 93,000,000 exactly.</span></div>
<div style="position:absolute;left:252.60px;top:320.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:281.46px;top:320.00px" class="cls_020"><span class="cls_020">30</span></div>
<div style="position:absolute;left:312.71px;top:320.00px" class="cls_020"><span class="cls_020">23</span></div>
<div style="position:absolute;left:343.96px;top:320.00px" class="cls_020"><span class="cls_020">22</span></div>
<div style="position:absolute;left:452.62px;top:320.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:40.00px;top:337.00px" class="cls_020"><span class="cls_020">single</span></div>
<div style="position:absolute;left:252.60px;top:337.00px" class="cls_020"><span class="cls_020">sign   exponent</span></div>
<div style="position:absolute;left:344.04px;top:337.00px" class="cls_020"><span class="cls_020">mantissa</span></div>
<div style="position:absolute;left:40.00px;top:354.00px" class="cls_020"><span class="cls_020">93000000</span></div>
<div style="position:absolute;left:252.79px;top:354.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:281.62px;top:354.00px" class="cls_020"><span class="cls_020">0001 1010</span></div>
<div style="position:absolute;left:344.20px;top:354.00px" class="cls_020"><span class="cls_020">101 1000 1011 0001 0001</span></div>
<div style="position:absolute;left:40.00px;top:371.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:252.63px;top:371.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:281.46px;top:371.00px" class="cls_020"><span class="cls_020">0000 0000</span></div>
<div style="position:absolute;left:344.04px;top:371.00px" class="cls_020"><span class="cls_020">000 0000 0000 0000 0000</span></div>
<div style="position:absolute;left:40.00px;top:388.00px" class="cls_020"><span class="cls_020">+infinity</span></div>
<div style="position:absolute;left:252.75px;top:388.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:281.59px;top:388.00px" class="cls_020"><span class="cls_020">1111 1111</span></div>
<div style="position:absolute;left:344.17px;top:388.00px" class="cls_020"><span class="cls_020">000 0000 0000 0000 0000</span></div>
<div style="position:absolute;left:40.00px;top:405.00px" class="cls_020"><span class="cls_020">-infinity</span></div>
<div style="position:absolute;left:252.74px;top:405.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:281.58px;top:405.00px" class="cls_020"><span class="cls_020">1111 1111</span></div>
<div style="position:absolute;left:344.16px;top:405.00px" class="cls_020"><span class="cls_020">000 0000 0000 0000 0000</span></div>
<div style="position:absolute;left:40.00px;top:422.01px" class="cls_020"><span class="cls_020">Quiet NaN</span></div>
<div style="position:absolute;left:252.79px;top:422.01px" class="cls_020"><span class="cls_020">x</span></div>
<div style="position:absolute;left:281.62px;top:422.01px" class="cls_020"><span class="cls_020">1111 1111</span></div>
<div style="position:absolute;left:344.20px;top:422.01px" class="cls_020"><span class="cls_020">0xx xxxx xxxx xxxx xxxx</span></div>
<div style="position:absolute;left:40.00px;top:439.01px" class="cls_020"><span class="cls_020">Signalling NaN</span></div>
<div style="position:absolute;left:252.87px;top:439.01px" class="cls_020"><span class="cls_020">x</span></div>
<div style="position:absolute;left:281.70px;top:439.01px" class="cls_020"><span class="cls_020">1111 1111</span></div>
<div style="position:absolute;left:344.28px;top:439.01px" class="cls_020"><span class="cls_020">1xx xxxx xxxx xxxx xxxx</span></div>
<div style="position:absolute;left:100.14px;top:456.01px" class="cls_020"><span class="cls_020">high-order word</span></div>
<div style="position:absolute;left:252.90px;top:456.01px" class="cls_020"><span class="cls_020">low-order word</span></div>
<div style="position:absolute;left:100.15px;top:476.01px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:129.17px;top:476.01px" class="cls_020"><span class="cls_020">30</span></div>
<div style="position:absolute;left:187.84px;top:476.01px" class="cls_020"><span class="cls_020">20</span></div>
<div style="position:absolute;left:207.01px;top:476.01px" class="cls_020"><span class="cls_020">19</span></div>
<div style="position:absolute;left:238.25px;top:476.01px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:252.86px;top:476.01px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:452.70px;top:476.01px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:40.00px;top:493.00px" class="cls_020"><span class="cls_020">double</span></div>
<div style="position:absolute;left:100.14px;top:493.00px" class="cls_020"><span class="cls_020">sign   exponent</span></div>
<div style="position:absolute;left:207.12px;top:493.00px" class="cls_020"><span class="cls_020">mantissa</span></div>
<div style="position:absolute;left:40.00px;top:510.00px" class="cls_020"><span class="cls_020">93000000</span></div>
<div style="position:absolute;left:100.32px;top:510.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:129.33px;top:510.00px" class="cls_020"><span class="cls_020">000 0001 1010</span></div>
<div style="position:absolute;left:207.35px;top:510.00px" class="cls_020"><span class="cls_020">1011 0001 0110 0010 0010 1000 0000</span></div>
<div style="position:absolute;left:40.00px;top:527.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:100.17px;top:527.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:129.18px;top:527.00px" class="cls_020"><span class="cls_020">000 0000 0000</span></div>
<div style="position:absolute;left:207.20px;top:527.00px" class="cls_020"><span class="cls_020">0000 0000 0000 0000 0000 0000</span></div>
<div style="position:absolute;left:40.00px;top:544.00px" class="cls_020"><span class="cls_020">+infinity</span></div>
<div style="position:absolute;left:100.30px;top:544.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:129.30px;top:544.00px" class="cls_020"><span class="cls_020">111 1111 1111</span></div>
<div style="position:absolute;left:207.33px;top:544.00px" class="cls_020"><span class="cls_020">0000 0000 0000 0000 0000 0000</span></div>
<div style="position:absolute;left:40.00px;top:561.00px" class="cls_020"><span class="cls_020">-infinity</span></div>
<div style="position:absolute;left:100.29px;top:561.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:129.30px;top:561.00px" class="cls_020"><span class="cls_020">111 1111 1111</span></div>
<div style="position:absolute;left:207.32px;top:561.00px" class="cls_020"><span class="cls_020">0000 0000 0000 0000 0000 0000</span></div>
<div style="position:absolute;left:40.00px;top:578.01px" class="cls_020"><span class="cls_020">Quiet NaN</span></div>
<div style="position:absolute;left:100.33px;top:578.01px" class="cls_020"><span class="cls_020">x</span></div>
<div style="position:absolute;left:129.34px;top:578.01px" class="cls_020"><span class="cls_020">111 1111 1111</span></div>
<div style="position:absolute;left:207.36px;top:578.01px" class="cls_020"><span class="cls_020">0xxx xxxx xxxx xxxx xxxx xxxx</span></div>
<div style="position:absolute;left:40.00px;top:595.01px" class="cls_020"><span class="cls_020">Signalling</span></div>
<div style="position:absolute;left:100.14px;top:595.01px" class="cls_020"><span class="cls_020">x</span></div>
<div style="position:absolute;left:129.14px;top:595.01px" class="cls_020"><span class="cls_020">111 1111 1111</span></div>
<div style="position:absolute;left:207.16px;top:595.01px" class="cls_020"><span class="cls_020">1xxx xxxx xxxx xxxx xxxx</span></div>
<div style="position:absolute;left:40.00px;top:605.01px" class="cls_020"><span class="cls_020">Nan</span></div>
<div style="position:absolute;left:161.42px;top:624.00px" class="cls_020"><span class="cls_020">Table 8.1.  Floating point data formats</span></div>
<div style="position:absolute;left:48.03px;top:639.67px" class="cls_006"><span class="cls_006">The way that the two words making up a double are ordered in memory</span></div>
<div style="position:absolute;left:36.01px;top:650.67px" class="cls_006"><span class="cls_006">depends on the CPU configuration; for ‘‘big-endian’’ configuration the high-</span></div>
<div style="position:absolute;left:36.01px;top:661.67px" class="cls_006"><span class="cls_006">order word is at the lowest, 8-byte aligned location; for little endian the</span></div>
<div style="position:absolute;left:36.01px;top:672.67px" class="cls_006"><span class="cls_006">low-order word is at the lower location.</span></div>
<div style="position:absolute;left:48.03px;top:683.67px" class="cls_006"><span class="cls_006">The following C structure types define the fields of the two FP types for</span></div>
<div style="position:absolute;left:36.01px;top:694.67px" class="cls_006"><span class="cls_006">a MIPS CPU.</span></div>
<div style="position:absolute;left:72.00px;top:716.00px" class="cls_028"><span class="cls_028">#if BYTE_ORDER == BIG_ENDIAN</span></div>
<div style="position:absolute;left:292.03px;top:755.33px" class="cls_002"><span class="cls_002">8-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:79398px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FLOATING POINT CO-PROCESSOR</span></div>
<div style="position:absolute;left:525.07px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 8</span></div>
<div style="position:absolute;left:252.00px;top:51.00px" class="cls_028"><span class="cls_028">struct ieee754dp_konst {</span></div>
<div style="position:absolute;left:257.40px;top:61.00px" class="cls_028"><span class="cls_028">unsigned</span></div>
<div style="position:absolute;left:324.21px;top:61.00px" class="cls_028"><span class="cls_028">sign:1;</span></div>
<div style="position:absolute;left:257.40px;top:71.00px" class="cls_028"><span class="cls_028">unsigned</span></div>
<div style="position:absolute;left:324.21px;top:71.00px" class="cls_028"><span class="cls_028">bexp:11;</span></div>
<div style="position:absolute;left:257.40px;top:81.00px" class="cls_028"><span class="cls_028">unsigned</span></div>
<div style="position:absolute;left:324.24px;top:81.00px" class="cls_028"><span class="cls_028">manthi:20; /* cannot get 52 bits into... */</span></div>
<div style="position:absolute;left:257.40px;top:91.00px" class="cls_028"><span class="cls_028">unsigned</span></div>
<div style="position:absolute;left:324.21px;top:91.00px" class="cls_028"><span class="cls_028">mantlo:32; /* .. a regular C bitfield */</span></div>
<div style="position:absolute;left:252.00px;top:101.00px" class="cls_028"><span class="cls_028">};</span></div>
<div style="position:absolute;left:252.00px;top:120.99px" class="cls_028"><span class="cls_028">struct ieee754sp_konst {</span></div>
<div style="position:absolute;left:257.40px;top:130.99px" class="cls_028"><span class="cls_028">unsigned</span></div>
<div style="position:absolute;left:324.21px;top:130.99px" class="cls_028"><span class="cls_028">sign:1;</span></div>
<div style="position:absolute;left:257.40px;top:140.99px" class="cls_028"><span class="cls_028">unsigned</span></div>
<div style="position:absolute;left:324.21px;top:140.99px" class="cls_028"><span class="cls_028">bexp:8;</span></div>
<div style="position:absolute;left:257.40px;top:150.99px" class="cls_028"><span class="cls_028">unsigned</span></div>
<div style="position:absolute;left:324.24px;top:150.99px" class="cls_028"><span class="cls_028">mant:23;</span></div>
<div style="position:absolute;left:252.00px;top:160.99px" class="cls_028"><span class="cls_028">};</span></div>
<div style="position:absolute;left:252.00px;top:180.99px" class="cls_028"><span class="cls_028">#else /* little-endian */</span></div>
<div style="position:absolute;left:252.00px;top:200.99px" class="cls_028"><span class="cls_028">struct ieee754dp_konst {</span></div>
<div style="position:absolute;left:257.40px;top:210.99px" class="cls_028"><span class="cls_028">unsigned</span></div>
<div style="position:absolute;left:324.21px;top:210.99px" class="cls_028"><span class="cls_028">mantlo:32;</span></div>
<div style="position:absolute;left:257.40px;top:220.99px" class="cls_028"><span class="cls_028">unsigned</span></div>
<div style="position:absolute;left:324.24px;top:220.99px" class="cls_028"><span class="cls_028">manthi:20;</span></div>
<div style="position:absolute;left:257.40px;top:230.98px" class="cls_028"><span class="cls_028">unsigned</span></div>
<div style="position:absolute;left:324.21px;top:230.98px" class="cls_028"><span class="cls_028">exp:11;</span></div>
<div style="position:absolute;left:257.40px;top:240.98px" class="cls_028"><span class="cls_028">unsigned</span></div>
<div style="position:absolute;left:324.21px;top:240.98px" class="cls_028"><span class="cls_028">sign:1;</span></div>
<div style="position:absolute;left:252.00px;top:250.98px" class="cls_028"><span class="cls_028">};</span></div>
<div style="position:absolute;left:252.00px;top:270.98px" class="cls_028"><span class="cls_028">struct ieee754sp_konst {</span></div>
<div style="position:absolute;left:257.40px;top:280.98px" class="cls_028"><span class="cls_028">unsigned</span></div>
<div style="position:absolute;left:324.24px;top:280.98px" class="cls_028"><span class="cls_028">mant:23;</span></div>
<div style="position:absolute;left:257.40px;top:290.98px" class="cls_028"><span class="cls_028">unsigned</span></div>
<div style="position:absolute;left:324.21px;top:290.98px" class="cls_028"><span class="cls_028">bexp:8;</span></div>
<div style="position:absolute;left:257.40px;top:300.98px" class="cls_028"><span class="cls_028">unsigned</span></div>
<div style="position:absolute;left:324.21px;top:300.98px" class="cls_028"><span class="cls_028">sign:1;</span></div>
<div style="position:absolute;left:252.00px;top:310.98px" class="cls_028"><span class="cls_028">};</span></div>
<div style="position:absolute;left:252.00px;top:330.97px" class="cls_028"><span class="cls_028">#endif</span></div>
<div style="position:absolute;left:216.00px;top:362.00px" class="cls_015"><span class="cls_015">MIPS IMPLEMENTATION OF IEEE754</span></div>
<div style="position:absolute;left:228.02px;top:375.67px" class="cls_006"><span class="cls_006">IEEE754 is quite demanding, and sets two major problems:</span></div>
<div style="position:absolute;left:228.02px;top:389.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Reporting exceptions makes pipelining harder</span><span class="cls_006">: If the user opts to be</span></div>
<div style="position:absolute;left:239.98px;top:400.67px" class="cls_006"><span class="cls_006">told when an IEEE exception happens, then to be useful this should</span></div>
<div style="position:absolute;left:239.98px;top:411.67px" class="cls_006"><span class="cls_006">happen synchronously†; after the trap, the user will want to see all</span></div>
<div style="position:absolute;left:239.98px;top:422.67px" class="cls_006"><span class="cls_006">previous instructions complete, all FP registers still in the pre-</span></div>
<div style="position:absolute;left:239.98px;top:433.67px" class="cls_006"><span class="cls_006">instruction state, and will want to be sure that no subsequent</span></div>
<div style="position:absolute;left:239.98px;top:444.67px" class="cls_006"><span class="cls_006">instruction has had any effect.</span></div>
<div style="position:absolute;left:239.98px;top:458.67px" class="cls_006"><span class="cls_006">In the MIPS architecture hardware traps (as noted in an earlier</span></div>
<div style="position:absolute;left:239.98px;top:469.67px" class="cls_006"><span class="cls_006">chapter) are always like this. This does limit the opportunities for</span></div>
<div style="position:absolute;left:239.98px;top:480.67px" class="cls_006"><span class="cls_006">pipelining  FP  operations,  because  the  CPU  cannot  commit  the</span></div>
<div style="position:absolute;left:239.98px;top:491.67px" class="cls_006"><span class="cls_006">following instruction until the hardware can be sure that the FP</span></div>
<div style="position:absolute;left:239.98px;top:502.67px" class="cls_006"><span class="cls_006">operation will not produce a trap. To avoid adding to the execution</span></div>
<div style="position:absolute;left:239.98px;top:513.67px" class="cls_006"><span class="cls_006">time, an FP operation must decide to trap or not in the first clock</span></div>
<div style="position:absolute;left:239.98px;top:524.67px" class="cls_006"><span class="cls_006">phase after the operands are fetched. This is possible for most kinds</span></div>
<div style="position:absolute;left:239.98px;top:535.67px" class="cls_006"><span class="cls_006">of exceptional result; but if the FPA is configured to trap on the IEEE</span></div>
<div style="position:absolute;left:239.98px;top:546.67px" class="cls_006"><span class="cls_006">‘‘inexact’’ exception all FP pipelining is inhibited, and everything slows</span></div>
<div style="position:absolute;left:239.98px;top:557.67px" class="cls_006"><span class="cls_006">down.</span></div>
<div style="position:absolute;left:228.03px;top:571.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Denormalized   numbers</span><span class="cls_006">:   The   representation   of   very   small</span></div>
<div style="position:absolute;left:239.98px;top:582.67px" class="cls_006"><span class="cls_006">(“denormalized’’) numbers and the exceptional values is too awkward</span></div>
<div style="position:absolute;left:239.98px;top:593.67px" class="cls_006"><span class="cls_006">for the FPA hardware to attempt, and they are instead passed on to</span></div>
<div style="position:absolute;left:239.98px;top:604.67px" class="cls_006"><span class="cls_006">the exception handler.</span></div>
<div style="position:absolute;left:228.03px;top:615.67px" class="cls_006"><span class="cls_006">Note  that </span><span class="cls_008"> the  MIPS  architecture  does  not  prescribe  exactly  what</span></div>
<div style="position:absolute;left:216.01px;top:626.67px" class="cls_008"><span class="cls_008">calculations will be performed without software intervention</span><span class="cls_006">. A complete</span></div>
<div style="position:absolute;left:216.00px;top:637.67px" class="cls_006"><span class="cls_006">software floating point emulator may be required for some systems.</span></div>
<div style="position:absolute;left:234.00px;top:686.67px" class="cls_006"><span class="cls_006">† Elsewhere in this manual and the MIPS documentation this will</span></div>
<div style="position:absolute;left:234.00px;top:698.67px" class="cls_006"><span class="cls_006">be referred to as a ‘‘precise exception’’. But since both ‘‘precise’’</span></div>
<div style="position:absolute;left:234.00px;top:710.67px" class="cls_006"><span class="cls_006">and ‘‘exception’’ are used to mean different things by the IEEE</span></div>
<div style="position:absolute;left:234.00px;top:722.67px" class="cls_006"><span class="cls_006">standard, this chapter will describe them as a ‘‘synchronous trap’’.</span></div>
<div style="position:absolute;left:305.78px;top:755.33px" class="cls_002"><span class="cls_002">8-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:80200px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 8</span></div>
<div style="position:absolute;left:409.31px;top:28.00px" class="cls_002"><span class="cls_002">FLOATING POINT CO-PROCESSOR</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">In practice, the FPA traps only on a very small proportion of the</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_006"><span class="cls_006">calculations which a program is likely to produce. Most systems are quite</span></div>
<div style="position:absolute;left:36.00px;top:72.67px" class="cls_006"><span class="cls_006">unlikely ever to produce anything that the hardware can’t handle.</span></div>
<div style="position:absolute;left:48.02px;top:83.67px" class="cls_006"><span class="cls_006">Existing R30xx family FPAs take the unimplemented trap whenever an</span></div>
<div style="position:absolute;left:36.00px;top:94.67px" class="cls_006"><span class="cls_006">operation should produce any IEEE exception or exceptional result other</span></div>
<div style="position:absolute;left:36.00px;top:105.67px" class="cls_006"><span class="cls_006">than ‘‘inexact’’ and ‘‘overflow’’. For overflow, the hardware will generate an</span></div>
<div style="position:absolute;left:36.00px;top:116.67px" class="cls_006"><span class="cls_006">infinity or a largest-possible value (depending on the current rounding</span></div>
<div style="position:absolute;left:36.00px;top:127.67px" class="cls_006"><span class="cls_006">mode).  The  FPA  hardware  will  not  accept  or  produce  denormalized</span></div>
<div style="position:absolute;left:36.00px;top:138.67px" class="cls_006"><span class="cls_006">numbers or NaNs.</span></div>
<div style="position:absolute;left:36.00px;top:161.00px" class="cls_015"><span class="cls_015">FLOATING POINT REGISTERS</span></div>
<div style="position:absolute;left:48.02px;top:174.67px" class="cls_006"><span class="cls_006">The MIPS architecture defines 16 FP registers, usually given even</span></div>
<div style="position:absolute;left:36.00px;top:185.67px" class="cls_006"><span class="cls_006">numbers </span><span class="cls_008">$f0</span><span class="cls_006"> - </span><span class="cls_008">$f30.</span><span class="cls_006"> There are also a set of 16 odd-numbered registers,</span></div>
<div style="position:absolute;left:36.00px;top:196.67px" class="cls_006"><span class="cls_006">each of which can take care of high-order bits of a 64-bit </span><span class="cls_008">double</span><span class="cls_006"> value</span></div>
<div style="position:absolute;left:36.00px;top:207.67px" class="cls_006"><span class="cls_006">stored in the preceding even-numbered register†. The odd-numbered</span></div>
<div style="position:absolute;left:36.00px;top:218.67px" class="cls_006"><span class="cls_006">registers can be accessed by move and load/store instructions; but the</span></div>
<div style="position:absolute;left:36.00px;top:229.67px" class="cls_006"><span class="cls_006">assembler provides synthetic ‘‘macro’’ instructions for move and load/</span></div>
<div style="position:absolute;left:36.00px;top:240.67px" class="cls_006"><span class="cls_006">store double, so the assembly programmer may never reference the odd-</span></div>
<div style="position:absolute;left:36.00px;top:251.67px" class="cls_006"><span class="cls_006">numbered registers when writing code.</span></div>
<div style="position:absolute;left:36.00px;top:274.00px" class="cls_015"><span class="cls_015">FLOATING POINT EXCEPTIONS/INTERRUPTS</span></div>
<div style="position:absolute;left:48.02px;top:287.67px" class="cls_006"><span class="cls_006">Floating point ‘‘exceptions’’ (enabled IEEE traps, or the ‘‘unimplemented</span></div>
<div style="position:absolute;left:36.00px;top:298.67px" class="cls_006"><span class="cls_006">operation’’ trap) are reported with an interrupt. In the R3081, one of the</span></div>
<div style="position:absolute;left:36.00px;top:309.67px" class="cls_006"><span class="cls_006">CPU interrupts will be dedicated to the FPA; the interrupt bit used is</span></div>
<div style="position:absolute;left:36.00px;top:320.67px" class="cls_006"><span class="cls_006">programmed in the R3081 Configuration register, defined in chapter 3. The</span></div>
<div style="position:absolute;left:36.00px;top:331.67px" class="cls_006"><span class="cls_006">default  is  to  use  the  fifth  interrupt  bit  in  the  CPU </span><span class="cls_008">Cause</span><span class="cls_006">  register,</span></div>
<div style="position:absolute;left:36.00px;top:342.67px" class="cls_006"><span class="cls_006">corresponding to hardware interrupt 3; however, the mapping is software-</span></div>
<div style="position:absolute;left:36.00px;top:353.67px" class="cls_006"><span class="cls_006">configurable, enabling a variety of priority schemes.</span></div>
<div style="position:absolute;left:48.02px;top:364.67px" class="cls_006"><span class="cls_006">Provided the corresponding interrupt-enable bit in the CPU status</span></div>
<div style="position:absolute;left:36.00px;top:375.67px" class="cls_006"><span class="cls_006">register </span><span class="cls_008">SR</span><span class="cls_006"> is set, a floating point exception will happen ‘‘immediately’’; no</span></div>
<div style="position:absolute;left:36.00px;top:386.67px" class="cls_006"><span class="cls_006">FP or integer operation following the FP instruction which caused the</span></div>
<div style="position:absolute;left:36.00px;top:397.67px" class="cls_006"><span class="cls_006">exception will have had any effect. At this point </span><span class="cls_008">epc</span><span class="cls_006"> will point to the correct</span></div>
<div style="position:absolute;left:36.00px;top:408.67px" class="cls_006"><span class="cls_006">place to restart the instruction. As described earlier, </span><span class="cls_008">epc</span><span class="cls_006"> will either point</span></div>
<div style="position:absolute;left:36.00px;top:419.67px" class="cls_006"><span class="cls_006">to the offending instruction, or to a branch instruction immediately</span></div>
<div style="position:absolute;left:36.00px;top:430.67px" class="cls_006"><span class="cls_006">preceding it. If it is the branch instruction, the BD bit will be set in the CPU</span></div>
<div style="position:absolute;left:36.00px;top:441.67px" class="cls_006"><span class="cls_006">status register </span><span class="cls_008">SR.</span></div>
<div style="position:absolute;left:48.02px;top:452.67px" class="cls_006"><span class="cls_006">If software performs FP operations with the FPA’s interrupt disabled the</span></div>
<div style="position:absolute;left:36.00px;top:463.67px" class="cls_006"><span class="cls_006">system cannot guarantee IEEE754 compliance; even with all the IEEE</span></div>
<div style="position:absolute;left:36.00px;top:474.67px" class="cls_006"><span class="cls_006">traps disabled, the hardware will still attempt to trap on some conditions</span></div>
<div style="position:absolute;left:36.00px;top:485.67px" class="cls_006"><span class="cls_006">and will not produce IEEE754-approved results.</span></div>
<div style="position:absolute;left:36.00px;top:508.00px" class="cls_015"><span class="cls_015">THE FLOATING POINT CONTROL/STATUS REGISTER</span></div>
<div style="position:absolute;left:48.02px;top:521.67px" class="cls_006"><span class="cls_006">The floating point control/status register (shown below) is coprocessor</span></div>
<div style="position:absolute;left:36.00px;top:532.67px" class="cls_006"><span class="cls_006">1 control register 31 (mnemonic FCR31) and is accessed by </span><span class="cls_008">mtc1</span><span class="cls_006">, </span><span class="cls_008">mfc1</span></div>
<div style="position:absolute;left:36.00px;top:543.67px" class="cls_006"><span class="cls_006">instructions.</span></div>
<div style="position:absolute;left:40.00px;top:564.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:66.35px;top:564.00px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:92.70px;top:564.00px" class="cls_020"><span class="cls_020">23</span></div>
<div style="position:absolute;left:119.06px;top:564.00px" class="cls_020"><span class="cls_020">22</span></div>
<div style="position:absolute;left:145.41px;top:564.00px" class="cls_020"><span class="cls_020">18</span></div>
<div style="position:absolute;left:171.76px;top:564.00px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:214.64px;top:564.00px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:240.99px;top:564.00px" class="cls_020"><span class="cls_020">12</span></div>
<div style="position:absolute;left:267.34px;top:564.00px" class="cls_020"><span class="cls_020">11</span></div>
<div style="position:absolute;left:294.32px;top:564.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:316.00px;top:564.00px" class="cls_020"><span class="cls_020">6</span></div>
<div style="position:absolute;left:337.18px;top:564.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:358.36px;top:564.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:379.53px;top:564.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:40.00px;top:581.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:92.62px;top:581.00px" class="cls_020"><span class="cls_020">C</span></div>
<div style="position:absolute;left:118.96px;top:581.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:171.58px;top:581.00px" class="cls_020"><span class="cls_020">UnImp</span></div>
<div style="position:absolute;left:214.54px;top:581.00px" class="cls_020"><span class="cls_020">Cause</span></div>
<div style="position:absolute;left:267.25px;top:581.00px" class="cls_020"><span class="cls_020">Enables</span></div>
<div style="position:absolute;left:315.98px;top:581.00px" class="cls_020"><span class="cls_020">Flags</span></div>
<div style="position:absolute;left:358.37px;top:581.00px" class="cls_020"><span class="cls_020">RM</span></div>
<div style="position:absolute;left:108.15px;top:600.00px" class="cls_020"><span class="cls_020">Figure 8.1.   FPA control/status register fields</span></div>
<div style="position:absolute;left:36.00px;top:615.67px" class="cls_006"><span class="cls_006">Notes on Figure 8.1, “FPA control/status register fields”</span></div>
<div style="position:absolute;left:48.02px;top:626.67px" class="cls_006"><span class="cls_006">Fields marked ‘‘0’’ will read, and must be written, as zero.</span></div>
<div style="position:absolute;left:48.02px;top:640.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> C</span><span class="cls_006">: condition bit. This is set only by FP compare operations and tested</span></div>
<div style="position:absolute;left:59.98px;top:651.67px" class="cls_006"><span class="cls_006">by conditional branches.</span></div>
<div style="position:absolute;left:54.00px;top:710.67px" class="cls_006"><span class="cls_006">† The role of the odd-numbered registers is not affected by the</span></div>
<div style="position:absolute;left:54.00px;top:722.67px" class="cls_006"><span class="cls_006">CPU’s ‘‘endianness’’.</span></div>
<div style="position:absolute;left:292.04px;top:755.33px" class="cls_002"><span class="cls_002">8-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:81002px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FLOATING POINT CO-PROCESSOR</span></div>
<div style="position:absolute;left:525.08px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 8</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> RM</span><span class="cls_006">: rounding mode, as required by IEEE754. The values are:</span></div>
<div style="position:absolute;left:228.69px;top:71.00px" class="cls_020"><span class="cls_020">RM</span></div>
<div style="position:absolute;left:261.60px;top:71.00px" class="cls_020"><span class="cls_020">Description</span></div>
<div style="position:absolute;left:228.69px;top:81.00px" class="cls_020"><span class="cls_020">Value</span></div>
<div style="position:absolute;left:228.69px;top:98.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:261.63px;top:98.00px" class="cls_020"><span class="cls_020">‘‘RN’’ (round to nearest). Round a result to the nearest representable</span></div>
<div style="position:absolute;left:261.60px;top:108.00px" class="cls_020"><span class="cls_020">value; if the result is exactly half way between two representable</span></div>
<div style="position:absolute;left:261.60px;top:118.00px" class="cls_020"><span class="cls_020">values, round to zero.</span></div>
<div style="position:absolute;left:228.69px;top:135.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:261.63px;top:135.00px" class="cls_020"><span class="cls_020">‘‘RZ’’ (round towards zero). Round a result to the closest</span></div>
<div style="position:absolute;left:261.60px;top:145.00px" class="cls_020"><span class="cls_020">representable value whose absolute value is less than or equal to the</span></div>
<div style="position:absolute;left:261.60px;top:155.00px" class="cls_020"><span class="cls_020">infinitely accurate result.</span></div>
<div style="position:absolute;left:228.69px;top:172.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:261.63px;top:172.00px" class="cls_020"><span class="cls_020">‘‘RP’’ (round up, or towards +infinity). Round a result to the next</span></div>
<div style="position:absolute;left:261.60px;top:182.00px" class="cls_020"><span class="cls_020">representable value up.</span></div>
<div style="position:absolute;left:228.69px;top:199.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:261.63px;top:199.00px" class="cls_020"><span class="cls_020">‘‘RN’’ (round down, or towards -infinity). Round a result to the next</span></div>
<div style="position:absolute;left:261.60px;top:209.00px" class="cls_020"><span class="cls_020">representable value down.</span></div>
<div style="position:absolute;left:241.67px;top:228.00px" class="cls_020"><span class="cls_020">Table 8.2.  Rounding modes encoded in FP control/status register</span></div>
<div style="position:absolute;left:239.98px;top:243.67px" class="cls_006"><span class="cls_006">Most systems define ‘‘RN’’ as the default behavior.</span></div>
<div style="position:absolute;left:228.03px;top:257.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> UnImp</span><span class="cls_006">: following an FPA trap, this bit will be set to mark an</span></div>
<div style="position:absolute;left:239.97px;top:268.67px" class="cls_006"><span class="cls_006">‘‘unimplemented instruction’’ exception†.</span></div>
<div style="position:absolute;left:239.97px;top:282.67px" class="cls_006"><span class="cls_006">This bit will be set and an interrupt raised whenever:</span></div>
<div style="position:absolute;left:228.02px;top:296.67px" class="cls_006"><span class="cls_006">a)</span></div>
<div style="position:absolute;left:264.02px;top:296.67px" class="cls_006"><span class="cls_006">there really is no instruction like this which the FPA will perform</span></div>
<div style="position:absolute;left:264.02px;top:307.67px" class="cls_006"><span class="cls_006">(but it is a ‘‘coprocessor 1’’ encoding); OR</span></div>
<div style="position:absolute;left:228.02px;top:321.67px" class="cls_006"><span class="cls_006">b)</span></div>
<div style="position:absolute;left:264.02px;top:321.67px" class="cls_006"><span class="cls_006">the FPA is not confident that it can produce IEEE754-correct</span></div>
<div style="position:absolute;left:264.02px;top:332.67px" class="cls_006"><span class="cls_006">result and/or exception signalling on this operation, with these</span></div>
<div style="position:absolute;left:264.02px;top:343.67px" class="cls_006"><span class="cls_006">operands.</span></div>
<div style="position:absolute;left:239.97px;top:357.67px" class="cls_006"><span class="cls_006">For whatever reason, when ‘‘UnImp’’ is set the offending instruction</span></div>
<div style="position:absolute;left:239.97px;top:368.67px" class="cls_006"><span class="cls_006">should be re-executed by a software emulator.</span></div>
<div style="position:absolute;left:239.97px;top:382.67px" class="cls_006"><span class="cls_006">If FP operations are run without the interrupt enabled, then any FPA</span></div>
<div style="position:absolute;left:239.97px;top:393.67px" class="cls_006"><span class="cls_006">operation which wants to take an exception will leave the destination</span></div>
<div style="position:absolute;left:239.97px;top:404.67px" class="cls_006"><span class="cls_006">register unaffected and the FP ‘‘Cause’’ bits undefined.</span></div>
<div style="position:absolute;left:228.02px;top:418.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Cause/Enables/Flags</span><span class="cls_006">: Each of these is a 5-bit field, one bit for each</span></div>
<div style="position:absolute;left:239.98px;top:429.67px" class="cls_006"><span class="cls_006">IEEE exception type:</span></div>
<div style="position:absolute;left:228.03px;top:443.67px" class="cls_006"><span class="cls_006">Bit4</span></div>
<div style="position:absolute;left:264.03px;top:443.67px" class="cls_006"><span class="cls_006">invalid operation.</span></div>
<div style="position:absolute;left:228.03px;top:457.67px" class="cls_006"><span class="cls_006">Bit3</span></div>
<div style="position:absolute;left:264.03px;top:457.67px" class="cls_006"><span class="cls_006">division by zero.</span></div>
<div style="position:absolute;left:228.03px;top:471.67px" class="cls_006"><span class="cls_006">Bit2</span></div>
<div style="position:absolute;left:264.03px;top:471.67px" class="cls_006"><span class="cls_006">overflow.</span></div>
<div style="position:absolute;left:228.03px;top:485.67px" class="cls_006"><span class="cls_006">Bit1</span></div>
<div style="position:absolute;left:264.03px;top:485.67px" class="cls_006"><span class="cls_006">underflow.</span></div>
<div style="position:absolute;left:228.03px;top:499.67px" class="cls_006"><span class="cls_006">Bit0</span></div>
<div style="position:absolute;left:264.03px;top:499.67px" class="cls_006"><span class="cls_006">inexact.</span></div>
<div style="position:absolute;left:239.98px;top:513.67px" class="cls_006"><span class="cls_006">The three different fields work like this:</span></div>
<div style="position:absolute;left:228.03px;top:527.67px" class="cls_006"><span class="cls_006">Cause bits are set (by hardware or emulation software) if and only if the</span></div>
<div style="position:absolute;left:264.03px;top:538.67px" class="cls_006"><span class="cls_006">last FP instruction executed resulted in that kind of exception.</span></div>
<div style="position:absolute;left:228.03px;top:552.67px" class="cls_006"><span class="cls_006">Flag    bits are ‘‘sticky’’ versions of the Cause bits, and are left set by any</span></div>
<div style="position:absolute;left:264.03px;top:563.67px" class="cls_006"><span class="cls_006">instruction encountering that exception. The Flag bits can only</span></div>
<div style="position:absolute;left:264.03px;top:574.67px" class="cls_006"><span class="cls_006">be zeroed again by writing </span><span class="cls_008">FPC31.</span></div>
<div style="position:absolute;left:228.02px;top:588.67px" class="cls_006"><span class="cls_006">Enable bits, when set, allow the corresponding ‘‘Cause’’ field bit to signal</span></div>
<div style="position:absolute;left:264.02px;top:599.67px" class="cls_006"><span class="cls_006">an interrupt.</span></div>
<div style="position:absolute;left:228.02px;top:610.67px" class="cls_006"><span class="cls_006">The architecture promises that if the FPA doesn’t set the ‘‘UnImp’’ bit</span></div>
<div style="position:absolute;left:216.00px;top:621.67px" class="cls_006"><span class="cls_006">but does set a ‘‘Cause’’ bit, then both the ‘‘Cause’’ bit setting and the result</span></div>
<div style="position:absolute;left:216.00px;top:632.67px" class="cls_006"><span class="cls_006">produced (if the corresponding ‘‘Enable’’ bit is off) are in accordance with</span></div>
<div style="position:absolute;left:216.00px;top:643.67px" class="cls_006"><span class="cls_006">the IEEE754 standard.</span></div>
<div style="position:absolute;left:228.02px;top:654.67px" class="cls_006"><span class="cls_006">The R3081 FPA will always rely on software emulation (i.e. uses the</span></div>
<div style="position:absolute;left:216.00px;top:665.67px" class="cls_006"><span class="cls_006">‘‘unimplemented’’ trap) for some things:</span></div>
<div style="position:absolute;left:234.00px;top:710.67px" class="cls_006"><span class="cls_006">† The MIPS documentation looks slightly different because it</span></div>
<div style="position:absolute;left:234.00px;top:722.67px" class="cls_006"><span class="cls_006">treats this as part of the ‘‘Cause’’ field.</span></div>
<div style="position:absolute;left:305.78px;top:755.33px" class="cls_002"><span class="cls_002">8-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:81804px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 8</span></div>
<div style="position:absolute;left:409.31px;top:28.00px" class="cls_002"><span class="cls_002">FLOATING POINT CO-PROCESSOR</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">• Any operation which is given a denormalized operand or ‘‘underflows’’</span></div>
<div style="position:absolute;left:59.97px;top:61.67px" class="cls_006"><span class="cls_006">(produces a denormalized result) will trap to the emulator. The</span></div>
<div style="position:absolute;left:59.97px;top:72.67px" class="cls_006"><span class="cls_006">emulator itself must test whether the ‘‘Enable underflow’’ bit is set,</span></div>
<div style="position:absolute;left:59.97px;top:83.67px" class="cls_006"><span class="cls_006">and either cause an IEEE-compliant exception or produce the correct</span></div>
<div style="position:absolute;left:59.97px;top:94.67px" class="cls_006"><span class="cls_006">result.</span></div>
<div style="position:absolute;left:48.02px;top:108.67px" class="cls_006"><span class="cls_006">• Operations which should produce the ‘‘invalid’’ trap are correctly</span></div>
<div style="position:absolute;left:59.97px;top:119.67px" class="cls_006"><span class="cls_006">identified; so if the trap is enabled the emulator must do nothing. But</span></div>
<div style="position:absolute;left:59.97px;top:130.67px" class="cls_006"><span class="cls_006">if the ‘‘invalid’’ bit is disabled the software emulator is invoked to</span></div>
<div style="position:absolute;left:59.97px;top:141.67px" class="cls_006"><span class="cls_006">generate the appropriate result (usually a Quiet NaN).</span></div>
<div style="position:absolute;left:59.97px;top:155.67px" class="cls_006"><span class="cls_006">Exactly the same is done with a Signalling NaN operand.</span></div>
<div style="position:absolute;left:48.02px;top:169.67px" class="cls_006"><span class="cls_006">• FP hardware can handle overflow on arithmetic (producing either the</span></div>
<div style="position:absolute;left:59.97px;top:180.67px" class="cls_006"><span class="cls_006">extreme finite value or a signed infinity, depending on the rounding</span></div>
<div style="position:absolute;left:59.97px;top:191.67px" class="cls_006"><span class="cls_006">mode). But the software emulator is needed to implement a convert to</span></div>
<div style="position:absolute;left:59.97px;top:202.67px" class="cls_006"><span class="cls_006">integer operation which overflows.</span></div>
<div style="position:absolute;left:48.02px;top:213.67px" class="cls_006"><span class="cls_006">The ‘‘Cause’’ bits are not reliable after an unimplemented exception.</span></div>
<div style="position:absolute;left:48.02px;top:224.67px" class="cls_006"><span class="cls_006">A full emulator (capable of delivering IEEE-compatible arithmetic on a</span></div>
<div style="position:absolute;left:36.00px;top:235.67px" class="cls_006"><span class="cls_006">CPU with no FPA fitted) to back up the FPA hardware may prove necessary</span></div>
<div style="position:absolute;left:36.00px;top:246.67px" class="cls_006"><span class="cls_006">in certain applications.</span></div>
<div style="position:absolute;left:48.02px;top:257.67px" class="cls_006"><span class="cls_006">FP Control instructions require care with the pipeline. See the appendix</span></div>
<div style="position:absolute;left:36.00px;top:268.67px" class="cls_006"><span class="cls_006">on pipeline hazards to see when the results are available to software.</span></div>
<div style="position:absolute;left:36.00px;top:291.00px" class="cls_015"><span class="cls_015">FLOATING POINT IMPLEMENTATION/REVISION</span></div>
<div style="position:absolute;left:36.00px;top:304.00px" class="cls_015"><span class="cls_015">REGISTER</span></div>
<div style="position:absolute;left:48.02px;top:317.67px" class="cls_006"><span class="cls_006">This   read-only   register’s   fields   are   shown   in   Figure</span></div>
<div style="position:absolute;left:344.94px;top:317.67px" class="cls_006"><span class="cls_006">8.2,</span></div>
<div style="position:absolute;left:372.73px;top:317.67px" class="cls_006"><span class="cls_006">“FPA</span></div>
<div style="position:absolute;left:36.00px;top:328.67px" class="cls_006"><span class="cls_006">implementation/revision register”.</span></div>
<div style="position:absolute;left:119.32px;top:349.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:156.58px;top:349.00px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:193.84px;top:349.00px" class="cls_020"><span class="cls_020">15</span></div>
<div style="position:absolute;left:231.10px;top:349.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:261.05px;top:349.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:291.01px;top:349.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:119.32px;top:366.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:193.77px;top:366.00px" class="cls_020"><span class="cls_020">Imp</span></div>
<div style="position:absolute;left:260.97px;top:366.00px" class="cls_020"><span class="cls_020">Rev</span></div>
<div style="position:absolute;left:97.40px;top:385.00px" class="cls_020"><span class="cls_020">Figure 8.2.   FPA implementation/revision register</span></div>
<div style="position:absolute;left:48.02px;top:400.67px" class="cls_006"><span class="cls_006">This register is co-processor 1 control register 0 (mnemonic FCR0), and</span></div>
<div style="position:absolute;left:36.00px;top:411.67px" class="cls_006"><span class="cls_006">is accessed by </span><span class="cls_008">mtc1</span><span class="cls_006"> and </span><span class="cls_008">mfc1</span><span class="cls_006"> instructions.</span></div>
<div style="position:absolute;left:48.03px;top:422.67px" class="cls_006"><span class="cls_006">Unlike the CPU’s field, the ‘‘Imp’’ field is useful. In the R30xx family it</span></div>
<div style="position:absolute;left:36.01px;top:433.67px" class="cls_006"><span class="cls_006">will contain one of two values:</span></div>
<div style="position:absolute;left:48.03px;top:447.67px" class="cls_006"><span class="cls_006">0</span></div>
<div style="position:absolute;left:84.03px;top:447.67px" class="cls_006"><span class="cls_006">No FPA is available. Reading this register is the recommended</span></div>
<div style="position:absolute;left:84.03px;top:458.67px" class="cls_006"><span class="cls_006">way of sensing the presence of an FPA. Note that software must</span></div>
<div style="position:absolute;left:84.03px;top:469.67px" class="cls_006"><span class="cls_006">enable ‘‘coprocessor 1’’ instructions before trying to read this</span></div>
<div style="position:absolute;left:84.03px;top:480.67px" class="cls_006"><span class="cls_006">register.</span></div>
<div style="position:absolute;left:48.03px;top:494.67px" class="cls_006"><span class="cls_006">3</span></div>
<div style="position:absolute;left:84.03px;top:494.67px" class="cls_006"><span class="cls_006">The FPA is compatible with that used for the R3000 CPU and its</span></div>
<div style="position:absolute;left:84.03px;top:505.67px" class="cls_006"><span class="cls_006">successors.</span></div>
<div style="position:absolute;left:48.03px;top:516.67px" class="cls_006"><span class="cls_006">The ‘‘Rev’’ field contains no relevant software data.</span></div>
<div style="position:absolute;left:36.00px;top:539.00px" class="cls_015"><span class="cls_015">GUIDE TO FP INSTRUCTIONS</span></div>
<div style="position:absolute;left:36.00px;top:564.00px" class="cls_015"><span class="cls_015">Load/store</span></div>
<div style="position:absolute;left:48.02px;top:577.67px" class="cls_006"><span class="cls_006">These operations load or store 32 bits of memory in or out of an FP</span></div>
<div style="position:absolute;left:36.00px;top:588.67px" class="cls_006"><span class="cls_006">register. General notes:</span></div>
<div style="position:absolute;left:48.02px;top:602.67px" class="cls_006"><span class="cls_006">• The data is unconverted and uninspected, so no exception can occur</span></div>
<div style="position:absolute;left:59.97px;top:613.67px" class="cls_006"><span class="cls_006">even if the data does not represent a valid FP value.</span></div>
<div style="position:absolute;left:48.02px;top:627.67px" class="cls_006"><span class="cls_006">• These operations can specify the odd-numbered FP registers.</span></div>
<div style="position:absolute;left:48.02px;top:641.67px" class="cls_006"><span class="cls_006">• The load operation has a delay of one clock, and (like loading to an</span></div>
<div style="position:absolute;left:59.97px;top:652.67px" class="cls_006"><span class="cls_006">integer  register)  this  is  not  interlocked.  The  compiler  and/or</span></div>
<div style="position:absolute;left:59.97px;top:663.67px" class="cls_006"><span class="cls_006">assembler will usually take care of this; but it is invalid for an FP load</span></div>
<div style="position:absolute;left:59.97px;top:674.67px" class="cls_006"><span class="cls_006">to be immediately followed by an instruction using the loaded value.</span></div>
<div style="position:absolute;left:292.03px;top:755.33px" class="cls_002"><span class="cls_002">8-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:82606px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FLOATING POINT CO-PROCESSOR</span></div>
<div style="position:absolute;left:525.07px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 8</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">• When writing in assembly, use the synthetic instructions. It is</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">permissible to use any addressing mode which the assembler can</span></div>
<div style="position:absolute;left:239.97px;top:72.67px" class="cls_006"><span class="cls_006">understand (as described below).</span></div>
<div style="position:absolute;left:264.51px;top:93.00px" class="cls_020"><span class="cls_020">Machine instructions (disp is signed 16-bit)</span></div>
<div style="position:absolute;left:264.51px;top:110.00px" class="cls_020"><span class="cls_020">lwc1 fd, disp(rs)</span></div>
<div style="position:absolute;left:352.89px;top:110.00px" class="cls_020"><span class="cls_020">fd &lt;- *</span><span class="cls_039">(rs + disp)</span></div>
<div style="position:absolute;left:264.51px;top:127.00px" class="cls_020"><span class="cls_020">swc1 fs, disp(rs)</span></div>
<div style="position:absolute;left:352.89px;top:127.00px" class="cls_020"><span class="cls_020">*</span><span class="cls_039">(rs + disp) &lt;- fs;</span></div>
<div style="position:absolute;left:264.51px;top:144.00px" class="cls_020"><span class="cls_020">Synthesized by assembler</span></div>
<div style="position:absolute;left:264.51px;top:161.00px" class="cls_020"><span class="cls_020">l.d fd, addr</span></div>
<div style="position:absolute;left:352.58px;top:161.33px" class="cls_040"><span class="cls_040">fd = (double)*addr;</span></div>
<div style="position:absolute;left:264.51px;top:178.00px" class="cls_020"><span class="cls_020">l.s fd, addr</span></div>
<div style="position:absolute;left:352.58px;top:178.33px" class="cls_040"><span class="cls_040">fd = (float)*addr;</span></div>
<div style="position:absolute;left:264.51px;top:195.00px" class="cls_020"><span class="cls_020">s.d fs, addr</span></div>
<div style="position:absolute;left:352.80px;top:195.00px" class="cls_020"><span class="cls_020">(double)*addr = fs;</span></div>
<div style="position:absolute;left:264.51px;top:212.00px" class="cls_020"><span class="cls_020">s.s fs, addr</span></div>
<div style="position:absolute;left:352.58px;top:214.00px" class="cls_020"><span class="cls_020">(float)*addr = fs;</span></div>
<div style="position:absolute;left:308.22px;top:234.00px" class="cls_020"><span class="cls_020">Table 8.3.  FP load/store instructions</span></div>
<div style="position:absolute;left:216.00px;top:255.00px" class="cls_015"><span class="cls_015">Move between registers</span></div>
<div style="position:absolute;left:228.02px;top:268.67px" class="cls_006"><span class="cls_006">No data conversion is done here (bit patterns are copied as-is) and no</span></div>
<div style="position:absolute;left:216.00px;top:279.67px" class="cls_006"><span class="cls_006">exception results from any value. These instructions can specify the odd-</span></div>
<div style="position:absolute;left:216.00px;top:290.67px" class="cls_006"><span class="cls_006">numbered FP registers.</span></div>
<div style="position:absolute;left:261.02px;top:311.00px" class="cls_020"><span class="cls_020">Between integer and FP registers</span></div>
<div style="position:absolute;left:349.79px;top:328.33px" class="cls_040"><span class="cls_040">/* 32-bits uninterpreted */</span></div>
<div style="position:absolute;left:261.02px;top:338.00px" class="cls_020"><span class="cls_020">mtc1 rs, fd</span></div>
<div style="position:absolute;left:349.79px;top:338.33px" class="cls_040"><span class="cls_040">fd = rs;</span></div>
<div style="position:absolute;left:261.03px;top:355.00px" class="cls_020"><span class="cls_020">mfc1 rd, fs</span></div>
<div style="position:absolute;left:349.80px;top:354.33px" class="cls_039"><span class="cls_039">rs = fd;</span></div>
<div style="position:absolute;left:261.03px;top:372.00px" class="cls_020"><span class="cls_020">Between FP registers</span></div>
<div style="position:absolute;left:261.03px;top:389.00px" class="cls_020"><span class="cls_020">mov.d fd,fs</span></div>
<div style="position:absolute;left:349.99px;top:389.00px" class="cls_020"><span class="cls_020">/* move 64-bits between reg pairs */</span></div>
<div style="position:absolute;left:349.80px;top:399.00px" class="cls_020"><span class="cls_020">fd = fs;</span></div>
<div style="position:absolute;left:261.03px;top:416.00px" class="cls_020"><span class="cls_020">mov.s fd,fs</span></div>
<div style="position:absolute;left:349.99px;top:416.00px" class="cls_020"><span class="cls_020">/* 32-bits between registers */</span></div>
<div style="position:absolute;left:349.79px;top:426.33px" class="cls_040"><span class="cls_040">fd = fs;</span></div>
<div style="position:absolute;left:319.92px;top:444.00px" class="cls_020"><span class="cls_020">Table 8.4.  FP move instructions</span></div>
<div style="position:absolute;left:216.00px;top:465.00px" class="cls_015"><span class="cls_015">3-operand arithmetic operations</span></div>
<div style="position:absolute;left:228.02px;top:481.67px" class="cls_006"><span class="cls_006">• All arithmetic operations can cause any IEEE exception type, and</span></div>
<div style="position:absolute;left:239.97px;top:492.67px" class="cls_006"><span class="cls_006">may result in an ‘‘unimplemented’’ trap if the hardware is not happy</span></div>
<div style="position:absolute;left:239.97px;top:503.67px" class="cls_006"><span class="cls_006">with the operands.</span></div>
<div style="position:absolute;left:228.02px;top:517.67px" class="cls_006"><span class="cls_006">• All these instructions come in single-precision (32-bit, C float) and</span></div>
<div style="position:absolute;left:239.97px;top:528.67px" class="cls_006"><span class="cls_006">double-precision</span></div>
<div style="position:absolute;left:328.53px;top:528.67px" class="cls_006"><span class="cls_006">(64-bit,  C  double)  format;  the  instructions  are</span></div>
<div style="position:absolute;left:239.97px;top:539.67px" class="cls_006"><span class="cls_006">distinguished by a ‘‘.s’’ or ‘‘.d’’ on the opcode.</span></div>
<div style="position:absolute;left:305.78px;top:755.34px" class="cls_002"><span class="cls_002">8-9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:83408px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 8</span></div>
<div style="position:absolute;left:409.31px;top:28.00px" class="cls_002"><span class="cls_002">FLOATING POINT CO-PROCESSOR</span></div>
<div style="position:absolute;left:59.98px;top:50.67px" class="cls_006"><span class="cls_006">Software can’t mix formats; both source values and the result will all</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">be either single or double. To mix singles and doubles use explicit</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">conversion operations.</span></div>
<div style="position:absolute;left:118.47px;top:93.00px" class="cls_020"><span class="cls_020">add.d fd,fs1,fs2</span></div>
<div style="position:absolute;left:227.49px;top:93.00px" class="cls_020"><span class="cls_020">fd = fs1 + fs2</span></div>
<div style="position:absolute;left:118.47px;top:110.00px" class="cls_020"><span class="cls_020">add.s fd,fs1,fs2</span></div>
<div style="position:absolute;left:118.47px;top:130.00px" class="cls_020"><span class="cls_020">div.d fd,fs1,fs2</span></div>
<div style="position:absolute;left:227.48px;top:130.00px" class="cls_020"><span class="cls_020">fd = fs1/fs2</span></div>
<div style="position:absolute;left:118.47px;top:147.00px" class="cls_020"><span class="cls_020">div.s fd,fs1,fs2</span></div>
<div style="position:absolute;left:118.47px;top:164.00px" class="cls_020"><span class="cls_020">mul.d fd,fs1,fs2</span></div>
<div style="position:absolute;left:227.49px;top:164.00px" class="cls_020"><span class="cls_020">fd = fs1 x fs2</span></div>
<div style="position:absolute;left:118.47px;top:181.00px" class="cls_020"><span class="cls_020">mul.s fd,fs1,fs2</span></div>
<div style="position:absolute;left:118.47px;top:198.00px" class="cls_020"><span class="cls_020">sub.d fd,fs1,fs2</span></div>
<div style="position:absolute;left:227.49px;top:198.00px" class="cls_020"><span class="cls_020">fd = fs1 - fs2</span></div>
<div style="position:absolute;left:118.47px;top:215.00px" class="cls_020"><span class="cls_020">sub.s fd,fs1,fs2</span></div>
<div style="position:absolute;left:129.82px;top:234.00px" class="cls_020"><span class="cls_020">Table 8.5.  FPA 3-operand arithmetic</span></div>
<div style="position:absolute;left:36.00px;top:255.00px" class="cls_015"><span class="cls_015">Unary (sign-changing) operations</span></div>
<div style="position:absolute;left:48.02px;top:268.67px" class="cls_006"><span class="cls_006">Although nominally arithmetic functions, these operations only change</span></div>
<div style="position:absolute;left:36.00px;top:279.67px" class="cls_006"><span class="cls_006">the sign bit and so can’t produce most IEEE exceptions. They can produce</span></div>
<div style="position:absolute;left:36.00px;top:290.67px" class="cls_006"><span class="cls_006">an ‘‘invalid’’ trap if fed with a Signalling NaN value.</span></div>
<div style="position:absolute;left:116.07px;top:311.01px" class="cls_020"><span class="cls_020">abs.d fd,fs</span></div>
<div style="position:absolute;left:227.74px;top:311.01px" class="cls_020"><span class="cls_020">fd = abs(fs)</span></div>
<div style="position:absolute;left:116.07px;top:328.01px" class="cls_020"><span class="cls_020">abs.s fd,fs</span></div>
<div style="position:absolute;left:116.07px;top:345.01px" class="cls_020"><span class="cls_020">neg.d fd,fs</span></div>
<div style="position:absolute;left:227.74px;top:345.01px" class="cls_020"><span class="cls_020">fd = -fs</span></div>
<div style="position:absolute;left:116.07px;top:362.01px" class="cls_020"><span class="cls_020">neg.s fd,fs</span></div>
<div style="position:absolute;left:123.46px;top:381.01px" class="cls_020"><span class="cls_020">Table 8.6.  FPA sign-changing operators</span></div>
<div style="position:absolute;left:36.00px;top:402.00px" class="cls_015"><span class="cls_015">Conversion operations</span></div>
<div style="position:absolute;left:48.02px;top:415.67px" class="cls_006"><span class="cls_006">Note that ‘‘convert from single to double’’ is written ‘‘cvt.d.s’’. All these</span></div>
<div style="position:absolute;left:36.00px;top:426.67px" class="cls_006"><span class="cls_006">use the current rounding mode, even when converting to and from</span></div>
<div style="position:absolute;left:36.00px;top:437.67px" class="cls_006"><span class="cls_006">integers. When converting data from CPU integer registers, the move from</span></div>
<div style="position:absolute;left:36.00px;top:448.67px" class="cls_006"><span class="cls_006">FP  to  CPU  registers  must  be  coded  separately  from  the  conversion</span></div>
<div style="position:absolute;left:36.00px;top:459.67px" class="cls_006"><span class="cls_006">operation.</span></div>
<div style="position:absolute;left:48.02px;top:470.67px" class="cls_006"><span class="cls_006">Conversion operations can result in any IEEE exception.</span></div>
<div style="position:absolute;left:78.41px;top:491.01px" class="cls_020"><span class="cls_020">cvt.d.s fd,fs</span></div>
<div style="position:absolute;left:171.51px;top:491.01px" class="cls_020"><span class="cls_020">fd = (double) fs;/* float -> double */</span></div>
<div style="position:absolute;left:78.41px;top:508.01px" class="cls_020"><span class="cls_020">cvt.d.w fd,fs</span></div>
<div style="position:absolute;left:171.52px;top:508.01px" class="cls_020"><span class="cls_020">fd = (double) fs;/* int -> double */</span></div>
<div style="position:absolute;left:78.41px;top:525.01px" class="cls_020"><span class="cls_020">cvt.s.d fd,fs</span></div>
<div style="position:absolute;left:171.51px;top:525.01px" class="cls_020"><span class="cls_020">fd = (float) fs;/* double -> float */</span></div>
<div style="position:absolute;left:78.41px;top:542.01px" class="cls_020"><span class="cls_020">cvt.s.w fd,fs</span></div>
<div style="position:absolute;left:171.51px;top:542.01px" class="cls_020"><span class="cls_020">fd = (float) fs;/* int -> float */</span></div>
<div style="position:absolute;left:78.41px;top:559.01px" class="cls_020"><span class="cls_020">cvt.w.s fd,fs</span></div>
<div style="position:absolute;left:171.51px;top:559.01px" class="cls_020"><span class="cls_020">fd = (int) fs;/* float -> int */</span></div>
<div style="position:absolute;left:78.41px;top:576.01px" class="cls_020"><span class="cls_020">cvt.w.s fd,fs</span></div>
<div style="position:absolute;left:171.51px;top:576.01px" class="cls_020"><span class="cls_020">fd = (int) fs;/* double -> int */</span></div>
<div style="position:absolute;left:116.02px;top:595.01px" class="cls_020"><span class="cls_020">Table 8.7.  FPA data conversion operations</span></div>
<div style="position:absolute;left:48.02px;top:610.67px" class="cls_006"><span class="cls_006">When converting from FP formats to 32-bit integer, the result produced</span></div>
<div style="position:absolute;left:36.00px;top:621.67px" class="cls_006"><span class="cls_006">depends on the current rounding mode.</span></div>
<div style="position:absolute;left:36.00px;top:644.00px" class="cls_015"><span class="cls_015">Conditional branch and test instructions</span></div>
<div style="position:absolute;left:48.02px;top:657.67px" class="cls_006"><span class="cls_006">The FP test and branch instructions are separate. A test instruction</span></div>
<div style="position:absolute;left:36.00px;top:668.67px" class="cls_006"><span class="cls_006">compares two FP values and set the FPA condition bit accordingly (C in the</span></div>
<div style="position:absolute;left:36.00px;top:679.67px" class="cls_006"><span class="cls_006">FP status register); the branch instructions branch on whether the bit is</span></div>
<div style="position:absolute;left:36.00px;top:690.67px" class="cls_006"><span class="cls_006">set or unset.</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">8-10</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:84210px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FLOATING POINT CO-PROCESSOR</span></div>
<div style="position:absolute;left:525.07px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 8</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">The branch instructions are:</span></div>
<div style="position:absolute;left:269.13px;top:71.00px" class="cls_020"><span class="cls_020">bc1f disp</span></div>
<div style="position:absolute;left:330.72px;top:71.33px" class="cls_040"><span class="cls_040">Branch if C bit ‘‘false’’ (zero)</span></div>
<div style="position:absolute;left:269.13px;top:88.00px" class="cls_020"><span class="cls_020">bc1t disp</span></div>
<div style="position:absolute;left:330.89px;top:88.00px" class="cls_020"><span class="cls_020">Branch if C bit ‘‘true’’ (one)</span></div>
<div style="position:absolute;left:228.02px;top:107.67px" class="cls_006"><span class="cls_006">Like the CPU’s other conditional branch instructions </span><span class="cls_008">disp</span><span class="cls_006"> is PC-relative,</span></div>
<div style="position:absolute;left:215.99px;top:118.67px" class="cls_006"><span class="cls_006">with a signed 16-bit field as a word displacement. </span><span class="cls_008">disp</span><span class="cls_006"> is usually coded as</span></div>
<div style="position:absolute;left:215.99px;top:129.67px" class="cls_006"><span class="cls_006">the name of a label, which is unlikely to end up more than 128Kbytes</span></div>
<div style="position:absolute;left:215.99px;top:140.67px" class="cls_006"><span class="cls_006">away.</span></div>
<div style="position:absolute;left:228.01px;top:151.67px" class="cls_006"><span class="cls_006">But  before  executing  the  branch,  the  condition  bit  must  be  set</span></div>
<div style="position:absolute;left:215.99px;top:162.67px" class="cls_006"><span class="cls_006">appropriately. The comparison operators are:</span></div>
<div style="position:absolute;left:261.69px;top:183.00px" class="cls_020"><span class="cls_020">c.&lt;cond>.d fs1,fs2</span></div>
<div style="position:absolute;left:391.52px;top:183.00px" class="cls_020"><span class="cls_020">Compare fs1 and fs2 and set C</span></div>
<div style="position:absolute;left:261.69px;top:200.01px" class="cls_020"><span class="cls_020">c.&lt;cond>.s fs1,fs2</span></div>
<div style="position:absolute;left:228.01px;top:219.67px" class="cls_006"><span class="cls_006">Where &lt;cond> is any of 16 conditions called: eq, f, le, lt, nge, ngl, ngle,</span></div>
<div style="position:absolute;left:215.99px;top:230.67px" class="cls_006"><span class="cls_006">ngt, ole, olt, seq, sf, ueq, ule, ult, un. Why so many? These test for any ‘‘OR’’</span></div>
<div style="position:absolute;left:215.99px;top:241.67px" class="cls_006"><span class="cls_006">combination of three mutually incompatible conditions:</span></div>
<div style="position:absolute;left:252.00px;top:263.00px" class="cls_039"><span class="cls_039">fs1 &lt;fs2</span></div>
<div style="position:absolute;left:252.00px;top:273.00px" class="cls_039"><span class="cls_039">fs1 == fs2</span></div>
<div style="position:absolute;left:252.00px;top:283.00px" class="cls_039"><span class="cls_039">unordered (fs1, fs2)</span></div>
<div style="position:absolute;left:228.02px;top:302.67px" class="cls_006"><span class="cls_006">The IEEE standard defines ‘‘unordered’’, and this relation is true for</span></div>
<div style="position:absolute;left:216.00px;top:313.67px" class="cls_006"><span class="cls_006">values such as infinities and NaN which do not compare meaningfully.</span></div>
<div style="position:absolute;left:228.02px;top:324.67px" class="cls_006"><span class="cls_006">To test for conditions like ‘‘greater than’’ and ‘‘not equal’’, invert the test</span></div>
<div style="position:absolute;left:216.00px;top:335.67px" class="cls_006"><span class="cls_006">and then use a </span><span class="cls_008">bc1f</span><span class="cls_006"> rather than a </span><span class="cls_008">bc1t</span><span class="cls_006"> branch.</span></div>
<div style="position:absolute;left:228.04px;top:346.67px" class="cls_006"><span class="cls_006">In addition to these combinations, each test comes in two flavors: one</span></div>
<div style="position:absolute;left:216.02px;top:357.67px" class="cls_006"><span class="cls_006">which takes an invalid trap if the operands are unordered, and one which</span></div>
<div style="position:absolute;left:216.02px;top:368.67px" class="cls_006"><span class="cls_006">never takes such a trap.</span></div>
<div style="position:absolute;left:246.05px;top:400.00px" class="cls_020"><span class="cls_020">C bit is set if</span></div>
<div style="position:absolute;left:497.76px;top:400.00px" class="cls_020"><span class="cls_020">Mnemonic</span></div>
<div style="position:absolute;left:497.46px;top:417.00px" class="cls_020"><span class="cls_020">trap   no</span></div>
<div style="position:absolute;left:524.17px;top:427.00px" class="cls_020"><span class="cls_020">trap</span></div>
<div style="position:absolute;left:246.05px;top:444.00px" class="cls_020"><span class="cls_020">always false</span></div>
<div style="position:absolute;left:497.69px;top:444.00px" class="cls_020"><span class="cls_020">f</span></div>
<div style="position:absolute;left:524.43px;top:444.00px" class="cls_020"><span class="cls_020">sf</span></div>
<div style="position:absolute;left:398.37px;top:461.01px" class="cls_020"><span class="cls_020">unordered(fs1,fs2)</span></div>
<div style="position:absolute;left:497.87px;top:461.01px" class="cls_020"><span class="cls_020">un</span></div>
<div style="position:absolute;left:524.65px;top:461.01px" class="cls_020"><span class="cls_020">ngle</span></div>
<div style="position:absolute;left:317.41px;top:478.01px" class="cls_020"><span class="cls_020">fs1 == fs2</span></div>
<div style="position:absolute;left:497.71px;top:478.01px" class="cls_020"><span class="cls_020">eq</span></div>
<div style="position:absolute;left:524.48px;top:478.01px" class="cls_020"><span class="cls_020">seq</span></div>
<div style="position:absolute;left:317.41px;top:495.01px" class="cls_020"><span class="cls_020">fs1 == fs2</span></div>
<div style="position:absolute;left:378.38px;top:495.01px" class="cls_020"><span class="cls_020">||   unordered(fs1,fs2)</span></div>
<div style="position:absolute;left:498.10px;top:495.01px" class="cls_020"><span class="cls_020">ueq</span></div>
<div style="position:absolute;left:524.89px;top:495.01px" class="cls_020"><span class="cls_020">ngl</span></div>
<div style="position:absolute;left:246.05px;top:512.01px" class="cls_020"><span class="cls_020">fs1 &lt;fs2</span></div>
<div style="position:absolute;left:497.67px;top:512.01px" class="cls_020"><span class="cls_020">olt</span></div>
<div style="position:absolute;left:524.45px;top:512.01px" class="cls_020"><span class="cls_020">lt</span></div>
<div style="position:absolute;left:246.05px;top:529.01px" class="cls_020"><span class="cls_020">fs1 &lt;fs2</span></div>
<div style="position:absolute;left:317.56px;top:529.01px" class="cls_020"><span class="cls_020">||</span></div>
<div style="position:absolute;left:398.56px;top:529.01px" class="cls_020"><span class="cls_020">unordered(fs1,fs2)</span></div>
<div style="position:absolute;left:498.06px;top:529.01px" class="cls_020"><span class="cls_020">ult</span></div>
<div style="position:absolute;left:524.84px;top:529.01px" class="cls_020"><span class="cls_020">nge</span></div>
<div style="position:absolute;left:246.05px;top:546.01px" class="cls_020"><span class="cls_020">fs1 &lt;fs2</span></div>
<div style="position:absolute;left:297.39px;top:546.01px" class="cls_020"><span class="cls_020">||   fs1 == fs2</span></div>
<div style="position:absolute;left:497.90px;top:546.01px" class="cls_020"><span class="cls_020">ole</span></div>
<div style="position:absolute;left:524.67px;top:546.01px" class="cls_020"><span class="cls_020">le</span></div>
<div style="position:absolute;left:246.05px;top:563.01px" class="cls_020"><span class="cls_020">fs1 &lt;fs2</span></div>
<div style="position:absolute;left:297.39px;top:563.01px" class="cls_020"><span class="cls_020">||   fs1 == fs2</span></div>
<div style="position:absolute;left:378.57px;top:563.01px" class="cls_020"><span class="cls_020">||   unordered(fs1,fs2)</span></div>
<div style="position:absolute;left:498.29px;top:563.01px" class="cls_020"><span class="cls_020">ule</span></div>
<div style="position:absolute;left:525.07px;top:563.01px" class="cls_020"><span class="cls_020">ngt</span></div>
<div style="position:absolute;left:323.42px;top:582.01px" class="cls_020"><span class="cls_020">Table 8.8.  FP test instructions</span></div>
<div style="position:absolute;left:228.04px;top:597.67px" class="cls_006"><span class="cls_006">The compare instruction produces its result too late for the branch</span></div>
<div style="position:absolute;left:216.02px;top:608.67px" class="cls_006"><span class="cls_006">instruction to be the immediately following instruction; a delay slot is</span></div>
<div style="position:absolute;left:216.02px;top:619.67px" class="cls_006"><span class="cls_006">required.</span></div>
<div style="position:absolute;left:228.04px;top:630.67px" class="cls_006"><span class="cls_006">For example:</span></div>
<div style="position:absolute;left:257.00px;top:653.00px" class="cls_040"><span class="cls_040">if (f0 &lt;= f2) goto foo;/* and don’t branch if unordered */</span></div>
<div style="position:absolute;left:288.00px;top:671.34px" class="cls_040"><span class="cls_040">c.le.d</span></div>
<div style="position:absolute;left:324.10px;top:671.34px" class="cls_040"><span class="cls_040">$f0, $f2</span></div>
<div style="position:absolute;left:288.00px;top:680.34px" class="cls_040"><span class="cls_040">nop</span></div>
<div style="position:absolute;left:396.04px;top:680.34px" class="cls_040"><span class="cls_040"># the assembler will do this</span></div>
<div style="position:absolute;left:288.00px;top:689.34px" class="cls_040"><span class="cls_040">bc1t</span></div>
<div style="position:absolute;left:324.06px;top:689.34px" class="cls_040"><span class="cls_040">foo</span></div>
<div style="position:absolute;left:256.47px;top:725.34px" class="cls_040"><span class="cls_040">if (f0 > f2) goto foo;/* and trap if unordered */</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">8-11</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:85012px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 8</span></div>
<div style="position:absolute;left:409.31px;top:28.00px" class="cls_002"><span class="cls_002">FLOATING POINT CO-PROCESSOR</span></div>
<div style="position:absolute;left:108.00px;top:60.33px" class="cls_040"><span class="cls_040">c.ole.d $f0, $f2</span></div>
<div style="position:absolute;left:108.00px;top:69.33px" class="cls_040"><span class="cls_040">nop</span></div>
<div style="position:absolute;left:216.04px;top:69.33px" class="cls_040"><span class="cls_040"># the assembler will do this...</span></div>
<div style="position:absolute;left:108.00px;top:78.33px" class="cls_040"><span class="cls_040">bc1f</span></div>
<div style="position:absolute;left:144.06px;top:78.33px" class="cls_040"><span class="cls_040">foo</span></div>
<div style="position:absolute;left:48.02px;top:96.67px" class="cls_006"><span class="cls_006">Fortunately, many assemblers recognize and manage this delay slot</span></div>
<div style="position:absolute;left:36.00px;top:107.67px" class="cls_006"><span class="cls_006">properly.</span></div>
<div style="position:absolute;left:36.00px;top:130.00px" class="cls_015"><span class="cls_015">INSTRUCTION TIMING REQUIREMENTS</span></div>
<div style="position:absolute;left:48.02px;top:143.67px" class="cls_006"><span class="cls_006">FP arithmetic instructions are interlocked (the instruction flow “stalls”</span></div>
<div style="position:absolute;left:36.00px;top:154.67px" class="cls_006"><span class="cls_006">automatically until results are available; the programmer does not need to</span></div>
<div style="position:absolute;left:36.00px;top:165.67px" class="cls_006"><span class="cls_006">be explicitly aware of execution times), and there is no need to interpose</span></div>
<div style="position:absolute;left:36.00px;top:176.67px" class="cls_006"><span class="cls_006">‘‘nops’’   or   to   reorganize   code   for   correctness.   However,   optimal</span></div>
<div style="position:absolute;left:36.00px;top:187.67px" class="cls_006"><span class="cls_006">performance will be achieved by code which lays out FP instructions to</span></div>
<div style="position:absolute;left:36.00px;top:198.67px" class="cls_006"><span class="cls_006">make the best use of overlapped execution of integer instructions, and the</span></div>
<div style="position:absolute;left:36.00px;top:209.67px" class="cls_006"><span class="cls_006">FP pipeline.</span></div>
<div style="position:absolute;left:48.02px;top:220.67px" class="cls_006"><span class="cls_006">However, the compiler, assembler or (in the end) the programmer must</span></div>
<div style="position:absolute;left:36.00px;top:231.67px" class="cls_006"><span class="cls_006">take care about the timing of:</span></div>
<div style="position:absolute;left:48.02px;top:245.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Operations on the FP control and status register</span><span class="cls_006">: moves between FP</span></div>
<div style="position:absolute;left:59.97px;top:256.67px" class="cls_006"><span class="cls_006">and integer registers complete late, and the resulting value cannot be</span></div>
<div style="position:absolute;left:59.97px;top:267.67px" class="cls_006"><span class="cls_006">used in the following instruction.</span></div>
<div style="position:absolute;left:48.02px;top:281.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> FP register loads</span><span class="cls_006">: like integer loads, take effect late. The value can’t be</span></div>
<div style="position:absolute;left:59.97px;top:292.67px" class="cls_006"><span class="cls_006">used in the following instruction.</span></div>
<div style="position:absolute;left:48.02px;top:306.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Test condition and branch</span><span class="cls_006">: the test of the FP condition bit using the</span></div>
<div style="position:absolute;left:59.97px;top:317.67px" class="cls_006"><span class="cls_006">bc1t,  bc1f  instructions  must  be  carefully  coded,  because  the</span></div>
<div style="position:absolute;left:59.97px;top:328.67px" class="cls_006"><span class="cls_006">condition bit is tested a clock earlier than might be expected. So the</span></div>
<div style="position:absolute;left:59.97px;top:339.67px" class="cls_006"><span class="cls_006">conditional branch cannot immediately follow a test instruction.</span></div>
<div style="position:absolute;left:36.00px;top:362.00px" class="cls_015"><span class="cls_015">INSTRUCTION TIMING FOR SPEED</span></div>
<div style="position:absolute;left:48.02px;top:375.67px" class="cls_006"><span class="cls_006">The R30xx family FPA takes more than one clock for most arithmetic</span></div>
<div style="position:absolute;left:36.00px;top:386.67px" class="cls_006"><span class="cls_006">instructions, and so the pipelining becomes visible. The pipeline can show</span></div>
<div style="position:absolute;left:36.00px;top:397.67px" class="cls_006"><span class="cls_006">up in three ways:</span></div>
<div style="position:absolute;left:48.02px;top:411.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Hazards</span><span class="cls_006">:  where  the  software  must  ensure  the  separation  of</span></div>
<div style="position:absolute;left:59.97px;top:422.67px" class="cls_006"><span class="cls_006">instructions to work correctly;</span></div>
<div style="position:absolute;left:48.02px;top:436.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Interlocks</span><span class="cls_006">: where the hardware will protect the software by delaying</span></div>
<div style="position:absolute;left:59.97px;top:447.67px" class="cls_006"><span class="cls_006">use of an operand until it is ready, but knowledgable re-arrangement</span></div>
<div style="position:absolute;left:59.97px;top:458.67px" class="cls_006"><span class="cls_006">of the code will improve performance;</span></div>
<div style="position:absolute;left:48.02px;top:472.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Overlapping</span><span class="cls_006">: where the hardware is prepared to start one operation</span></div>
<div style="position:absolute;left:59.97px;top:483.67px" class="cls_006"><span class="cls_006">before   another   has   completed,   provided   there   are   no   data</span></div>
<div style="position:absolute;left:59.97px;top:494.67px" class="cls_006"><span class="cls_006">dependencies. This is discussed later.</span></div>
<div style="position:absolute;left:48.02px;top:505.67px" class="cls_006"><span class="cls_006">Hazards and interlocks arise when instructions fail to stick to the</span></div>
<div style="position:absolute;left:36.00px;top:516.67px" class="cls_006"><span class="cls_006">general MIPS rule of taking exactly one clock period between needing</span></div>
<div style="position:absolute;left:36.00px;top:527.67px" class="cls_006"><span class="cls_006">operands  and  making  results  ready.  Some  instructions  either  need</span></div>
<div style="position:absolute;left:36.00px;top:538.67px" class="cls_006"><span class="cls_006">operands earlier (branches, particularly, do this), or produce results late</span></div>
<div style="position:absolute;left:36.00px;top:549.67px" class="cls_006"><span class="cls_006">(e.g. loads). All R30xx family instructions which can cause trouble are</span></div>
<div style="position:absolute;left:36.00px;top:560.67px" class="cls_006"><span class="cls_006">tabulated in an appendix of this manual.</span></div>
<div style="position:absolute;left:36.00px;top:583.00px" class="cls_015"><span class="cls_015">INITIALIZATION AND ENABLE ON DEMAND</span></div>
<div style="position:absolute;left:48.02px;top:596.67px" class="cls_006"><span class="cls_006">Reset processing will normally initialize the CPU’s </span><span class="cls_008">SR</span><span class="cls_006"> register to disable</span></div>
<div style="position:absolute;left:36.00px;top:607.67px" class="cls_006"><span class="cls_006">all optional co-processors, which includes the FPA (alias coprocessor 1).</span></div>
<div style="position:absolute;left:36.00px;top:618.67px" class="cls_006"><span class="cls_006">The </span><span class="cls_008">SR</span><span class="cls_006"> bit CU1 has to be set for the FPA to work.</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">8-12</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:85814px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FLOATING POINT CO-PROCESSOR</span></div>
<div style="position:absolute;left:525.07px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 8</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">To determine availability of a hardware FPA, software should read the</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">FPA implementation register; if it reads zero, no FP is fitted and software</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_006"><span class="cls_006">should run the system with CU1 off†. Once CU1 is enabled, software</span></div>
<div style="position:absolute;left:216.00px;top:83.67px" class="cls_006"><span class="cls_006">should setup the control/status register </span><span class="cls_008">FCR31</span><span class="cls_006"> with the system choice of</span></div>
<div style="position:absolute;left:216.00px;top:94.67px" class="cls_006"><span class="cls_006">rounding modes and trap enables.</span></div>
<div style="position:absolute;left:228.02px;top:105.67px" class="cls_006"><span class="cls_006">Once the FPA is operating, the FP registers should be saved and restored</span></div>
<div style="position:absolute;left:216.00px;top:116.67px" class="cls_006"><span class="cls_006">during interrupts and context switches. Since this is (relatively) time-</span></div>
<div style="position:absolute;left:216.00px;top:127.67px" class="cls_006"><span class="cls_006">consuming, software can optimize this:</span></div>
<div style="position:absolute;left:228.02px;top:141.67px" class="cls_006"><span class="cls_006">• Leave the FPA disabled by default when running a new task. Since the</span></div>
<div style="position:absolute;left:239.97px;top:152.67px" class="cls_006"><span class="cls_006">task cannot now access the FPA, the OS doesn’t have to save and</span></div>
<div style="position:absolute;left:239.97px;top:163.67px" class="cls_006"><span class="cls_006">restore registers.</span></div>
<div style="position:absolute;left:228.02px;top:177.67px" class="cls_006"><span class="cls_006">• On a FP instruction trap, mark the task as an FP user and enable the</span></div>
<div style="position:absolute;left:239.97px;top:188.67px" class="cls_006"><span class="cls_006">FP before returning to it.</span></div>
<div style="position:absolute;left:228.02px;top:202.67px" class="cls_006"><span class="cls_006">• Disable FP operations while in the kernel, or in any software called</span></div>
<div style="position:absolute;left:239.97px;top:213.67px" class="cls_006"><span class="cls_006">directly or indirectly from an interrupt routine. This avoids saving FP</span></div>
<div style="position:absolute;left:239.97px;top:224.67px" class="cls_006"><span class="cls_006">registers on an interrupt; instead FP registers need be saved only</span></div>
<div style="position:absolute;left:239.97px;top:235.67px" class="cls_006"><span class="cls_006">when context-switching to or from an FP using task.</span></div>
<div style="position:absolute;left:216.00px;top:258.00px" class="cls_015"><span class="cls_015">FLOATING POINT EMULATION</span></div>
<div style="position:absolute;left:228.02px;top:271.67px" class="cls_006"><span class="cls_006">The low-cost members of the R30xx family do not have a hardware FPA.</span></div>
<div style="position:absolute;left:216.00px;top:282.67px" class="cls_006"><span class="cls_006">Floating point functions for these processors are provided by software, and</span></div>
<div style="position:absolute;left:216.00px;top:293.67px" class="cls_006"><span class="cls_006">are slower than the hardware. Software FP is useful for systems where</span></div>
<div style="position:absolute;left:216.00px;top:304.67px" class="cls_006"><span class="cls_006">floating point is employed in some rarely-used routines.</span></div>
<div style="position:absolute;left:228.02px;top:315.67px" class="cls_006"><span class="cls_006">There are two approaches:</span></div>
<div style="position:absolute;left:228.02px;top:329.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Soft-float</span><span class="cls_006">: Some compilers can be requested to implement floating</span></div>
<div style="position:absolute;left:239.97px;top:340.67px" class="cls_006"><span class="cls_006">point operations with software. In such a system, the instruction</span></div>
<div style="position:absolute;left:239.97px;top:351.67px" class="cls_006"><span class="cls_006">stream does not contain actual floating point operations; instead,</span></div>
<div style="position:absolute;left:239.97px;top:362.67px" class="cls_006"><span class="cls_006">when the software requests floating point from the compiler, the</span></div>
<div style="position:absolute;left:239.97px;top:373.67px" class="cls_006"><span class="cls_006">compiler inserts a call to a dedicated floating point library. This</span></div>
<div style="position:absolute;left:239.97px;top:384.67px" class="cls_006"><span class="cls_006">eliminates the overhead of emulating a floating point register file, and</span></div>
<div style="position:absolute;left:239.97px;top:395.67px" class="cls_006"><span class="cls_006">also the overhead of decoding the requested operation.</span></div>
<div style="position:absolute;left:228.02px;top:409.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Run-time  emulation</span><span class="cls_006">:  The  compiler  can  produce  the  regular  FP</span></div>
<div style="position:absolute;left:239.97px;top:420.67px" class="cls_006"><span class="cls_006">instruction set. The CPU will then take a trap on each FP instruction,</span></div>
<div style="position:absolute;left:239.97px;top:431.67px" class="cls_006"><span class="cls_006">which is caught by the FP emulator. The emulator decodes the</span></div>
<div style="position:absolute;left:239.97px;top:442.67px" class="cls_006"><span class="cls_006">instruction and performs the requested operation in software.</span></div>
<div style="position:absolute;left:239.97px;top:456.67px" class="cls_006"><span class="cls_006">Part of the emulator’s job will be emulating the FP register set in</span></div>
<div style="position:absolute;left:239.97px;top:467.67px" class="cls_006"><span class="cls_006">memory.</span></div>
<div style="position:absolute;left:239.97px;top:481.67px" class="cls_006"><span class="cls_006">This technique is much slower than the soft-float technique; however,</span></div>
<div style="position:absolute;left:239.97px;top:492.67px" class="cls_006"><span class="cls_006">the binaries generated will automatically gain significant performance</span></div>
<div style="position:absolute;left:239.97px;top:503.67px" class="cls_006"><span class="cls_006">when executed by an R3081, simplifying system upgrades.</span></div>
<div style="position:absolute;left:228.02px;top:514.67px" class="cls_006"><span class="cls_006">As described above, a run-time emulator may also be required to back</span></div>
<div style="position:absolute;left:216.00px;top:525.67px" class="cls_006"><span class="cls_006">up FP hardware for very small operands or obscure operations; and, for</span></div>
<div style="position:absolute;left:216.00px;top:536.67px" class="cls_006"><span class="cls_006">maximal flexibility that emulator is usually complete. However, it will be</span></div>
<div style="position:absolute;left:216.00px;top:547.67px" class="cls_006"><span class="cls_006">written to ensure exact IEEE compatibility and is only expected to be called</span></div>
<div style="position:absolute;left:216.00px;top:558.67px" class="cls_006"><span class="cls_006">occasionally, so it will probably be coded for correctness rather than speed.</span></div>
<div style="position:absolute;left:228.02px;top:569.67px" class="cls_006"><span class="cls_006">Compiled-in floating point (soft-float) is much more efficient on integer</span></div>
<div style="position:absolute;left:216.00px;top:580.67px" class="cls_006"><span class="cls_006">only chips; the emulator has a high overhead on each instruction from the</span></div>
<div style="position:absolute;left:216.00px;top:591.67px" class="cls_006"><span class="cls_006">trap handler, instruction decoder, and emulated register file.</span></div>
<div style="position:absolute;left:234.00px;top:686.67px" class="cls_006"><span class="cls_006">† Some systems may still enable CP1, to use the BrCond(1) input</span></div>
<div style="position:absolute;left:234.00px;top:698.67px" class="cls_006"><span class="cls_006">pin as an input port. The software must then insure that no FPA</span></div>
<div style="position:absolute;left:234.00px;top:710.67px" class="cls_006"><span class="cls_006">operations are actually required, since the CPU will presume that</span></div>
<div style="position:absolute;left:234.00px;top:722.67px" class="cls_006"><span class="cls_006">they are actually executed.</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">8-13</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:86616px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">ASSEMBLER LANGUAGE</span></div>
<div style="position:absolute;left:491.33px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 9</span></div>
<div style="position:absolute;left:222.89px;top:56.33px" class="cls_005"><span class="cls_005">PROGRAMMING</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:228.02px;top:113.67px" class="cls_006"><span class="cls_006">This chapter details the techniques and conventions associated with</span></div>
<div style="position:absolute;left:216.00px;top:124.67px" class="cls_006"><span class="cls_006">writing and reading MIPS assembler code. This is different from just</span></div>
<div style="position:absolute;left:216.00px;top:135.67px" class="cls_006"><span class="cls_006">looking at the list of machine instructions because:</span></div>
<div style="position:absolute;left:228.02px;top:149.67px" class="cls_006"><span class="cls_006">1)</span></div>
<div style="position:absolute;left:264.02px;top:149.67px" class="cls_006"><span class="cls_006">MIPS  assemblers  provide  a  large  number  of  extra  ‘‘macro’’</span></div>
<div style="position:absolute;left:264.02px;top:160.67px" class="cls_006"><span class="cls_006">instructions which provide a richer instruction set than in fact</span></div>
<div style="position:absolute;left:264.02px;top:171.67px" class="cls_006"><span class="cls_006">exists at the machine level.</span></div>
<div style="position:absolute;left:228.02px;top:185.67px" class="cls_006"><span class="cls_006">2)</span></div>
<div style="position:absolute;left:264.02px;top:185.67px" class="cls_006"><span class="cls_006">Programmers need to know the exact syntax of directives to start</span></div>
<div style="position:absolute;left:264.02px;top:196.67px" class="cls_006"><span class="cls_006">and end functions, define data, control instruction ordering and</span></div>
<div style="position:absolute;left:264.02px;top:207.67px" class="cls_006"><span class="cls_006">optimization, etc.</span></div>
<div style="position:absolute;left:228.02px;top:218.67px" class="cls_006"><span class="cls_006">Before reading much further, it may be a good idea to go back and review</span></div>
<div style="position:absolute;left:216.00px;top:229.67px" class="cls_006"><span class="cls_006">Chapter</span></div>
<div style="position:absolute;left:263.79px;top:229.67px" class="cls_006"><span class="cls_006">2</span></div>
<div style="position:absolute;left:278.38px;top:229.67px" class="cls_006"><span class="cls_006">(MIPS  Architecture).  It  describes  the  low-level  machine</span></div>
<div style="position:absolute;left:216.00px;top:240.67px" class="cls_006"><span class="cls_006">instruction set, data types, addressing modes, and conventional register</span></div>
<div style="position:absolute;left:216.00px;top:251.67px" class="cls_006"><span class="cls_006">usage.</span></div>
<div style="position:absolute;left:216.00px;top:274.00px" class="cls_015"><span class="cls_015">SYNTAX OVERVIEW</span></div>
<div style="position:absolute;left:228.02px;top:287.67px" class="cls_006"><span class="cls_006">Appendix C of this manual contains the formal syntax for the original</span></div>
<div style="position:absolute;left:216.00px;top:298.67px" class="cls_006"><span class="cls_006">MIPS Corp. assembler; most assemblers from other vendors follow this</span></div>
<div style="position:absolute;left:216.00px;top:309.67px" class="cls_006"><span class="cls_006">closely, although they may differ in their support of certain directives.</span></div>
<div style="position:absolute;left:216.00px;top:320.67px" class="cls_006"><span class="cls_006">These directives and conventions are similar to those found in other</span></div>
<div style="position:absolute;left:216.00px;top:331.67px" class="cls_006"><span class="cls_006">assemblers, especially a UNIX† assembler.</span></div>
<div style="position:absolute;left:216.00px;top:354.00px" class="cls_015"><span class="cls_015">Key points to note</span></div>
<div style="position:absolute;left:228.02px;top:370.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:370.67px" class="cls_006"><span class="cls_006">The assembler allows more than one statement on each line, as long</span></div>
<div style="position:absolute;left:239.97px;top:381.67px" class="cls_006"><span class="cls_006">as they are separated by semi-colons.</span></div>
<div style="position:absolute;left:228.02px;top:395.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:395.67px" class="cls_006"><span class="cls_006">"White space" (tabs and spaces) is permitted between any symbols.</span></div>
<div style="position:absolute;left:228.02px;top:409.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:409.67px" class="cls_006"><span class="cls_006">All text from a ‘#’ to the end of the line is a comment and is ignored,</span></div>
<div style="position:absolute;left:239.97px;top:420.67px" class="cls_006"><span class="cls_006">but do not put a ‘#’ in column 1.</span></div>
<div style="position:absolute;left:228.02px;top:434.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:434.67px" class="cls_006"><span class="cls_006">Identifiers for labels, variables, etc. can be any combination of alpha-</span></div>
<div style="position:absolute;left:239.97px;top:445.67px" class="cls_006"><span class="cls_006">numeric characters plus ‘</span><span class="cls_029">$</span><span class="cls_006">’, ‘_’ and ‘.’, except for the first character</span></div>
<div style="position:absolute;left:239.97px;top:456.67px" class="cls_006"><span class="cls_006">which cannot be numeric:</span></div>
<div style="position:absolute;left:252.00px;top:478.00px" class="cls_028"><span class="cls_028">Good labels:</span></div>
<div style="position:absolute;left:252.00px;top:498.00px" class="cls_028"><span class="cls_028">AVeryLongIdentifier # lower case is different from upper case</span></div>
<div style="position:absolute;left:252.00px;top:507.99px" class="cls_028"><span class="cls_028">frog$spawn</span></div>
<div style="position:absolute;left:360.24px;top:507.99px" class="cls_028"><span class="cls_028"># dollars allowed in names</span></div>
<div style="position:absolute;left:252.00px;top:517.99px" class="cls_028"><span class="cls_028">frog.spawn</span></div>
<div style="position:absolute;left:360.24px;top:517.99px" class="cls_028"><span class="cls_028"># ’.’ is also valid</span></div>
<div style="position:absolute;left:252.00px;top:527.99px" class="cls_028"><span class="cls_028">__peculiar2</span></div>
<div style="position:absolute;left:360.26px;top:527.99px" class="cls_028"><span class="cls_028"># leading underscores often used to</span></div>
<div style="position:absolute;left:360.00px;top:537.99px" class="cls_028"><span class="cls_028"># avoid name clashes in C</span></div>
<div style="position:absolute;left:252.00px;top:558.00px" class="cls_028"><span class="cls_028">Bad labels:</span></div>
<div style="position:absolute;left:252.00px;top:578.00px" class="cls_028"><span class="cls_028">7down</span></div>
<div style="position:absolute;left:360.11px;top:578.00px" class="cls_028"><span class="cls_028"># leading decimal</span></div>
<div style="position:absolute;left:252.00px;top:588.00px" class="cls_028"><span class="cls_028">frog-spawn</span></div>
<div style="position:absolute;left:360.23px;top:588.00px" class="cls_028"><span class="cls_028"># "-" not allowed</span></div>
<div style="position:absolute;left:228.02px;top:610.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:610.67px" class="cls_006"><span class="cls_006">The assembler allows the use of numbers (decimal between 1-99) as</span></div>
<div style="position:absolute;left:239.97px;top:621.67px" class="cls_006"><span class="cls_006">a label. These are treated as ‘‘temporary’’, and are “re-usable”. In a</span></div>
<div style="position:absolute;left:239.97px;top:632.67px" class="cls_006"><span class="cls_006">branch instruction ‘‘1f’’ (forward) refers to the next ‘‘1:’’ label in the</span></div>
<div style="position:absolute;left:239.97px;top:643.67px" class="cls_006"><span class="cls_006">code, and ‘‘1b’’ (back) refers to the last-met ‘‘1:’’ label.</span></div>
<div style="position:absolute;left:239.97px;top:657.67px" class="cls_006"><span class="cls_006">This eliminates the need for inventing unique but meaningless names</span></div>
<div style="position:absolute;left:239.97px;top:668.67px" class="cls_006"><span class="cls_006">for little branches and loops. Many programmers reserve named</span></div>
<div style="position:absolute;left:239.97px;top:679.67px" class="cls_006"><span class="cls_006">labels for subroutine entry points.</span></div>
<div style="position:absolute;left:234.00px;top:722.67px" class="cls_006"><span class="cls_006">† UNIX is a trademark of Univel Inc.</span></div>
<div style="position:absolute;left:299.28px;top:754.68px" class="cls_002"><span class="cls_002">9–1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:87418px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:376.95px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:50.67px" class="cls_006"><span class="cls_006">The MIPS Corp. assembler, among others, provides the conventional</span></div>
<div style="position:absolute;left:59.97px;top:61.67px" class="cls_006"><span class="cls_006">register names (</span><span class="cls_008">a0, t5</span><span class="cls_006">, etc.) as C pre-processor macros; thus, the</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">programmer must pass the source through the C preprocessor and</span></div>
<div style="position:absolute;left:59.98px;top:83.67px" class="cls_006"><span class="cls_006">include the file &lt;</span><span class="cls_008">regdef.h</span><span class="cls_006">>†.</span></div>
<div style="position:absolute;left:48.02px;top:97.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:97.67px" class="cls_006"><span class="cls_006">If the C preprocessor is indeed used, then typically it is permitted to</span></div>
<div style="position:absolute;left:59.97px;top:108.67px" class="cls_006"><span class="cls_006">also use C-style /* comments */ and macros.</span></div>
<div style="position:absolute;left:48.02px;top:122.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:122.67px" class="cls_006"><span class="cls_006">Hexadecimal constants are numbers preceded by ‘‘</span><span class="cls_029">0x</span><span class="cls_006">’’ or ‘‘</span><span class="cls_029"> 0X</span><span class="cls_006">’’; octal</span></div>
<div style="position:absolute;left:59.97px;top:133.67px" class="cls_006"><span class="cls_006">constants must be preceded by ‘‘</span><span class="cls_029">0</span><span class="cls_006">’’; be careful not to put a redundant</span></div>
<div style="position:absolute;left:59.97px;top:144.67px" class="cls_006"><span class="cls_006">zero on the front of a decimal constant. Constants are:</span></div>
<div style="position:absolute;left:72.00px;top:166.00px" class="cls_028"><span class="cls_028">0</span></div>
<div style="position:absolute;left:144.02px;top:166.00px" class="cls_028"><span class="cls_028"># strictly octal zero, but who cares?</span></div>
<div style="position:absolute;left:72.00px;top:176.00px" class="cls_028"><span class="cls_028">0x80000000</span></div>
<div style="position:absolute;left:144.23px;top:176.00px" class="cls_028"><span class="cls_028"># the biggest negative integer</span></div>
<div style="position:absolute;left:72.00px;top:186.00px" class="cls_028"><span class="cls_028">0377</span></div>
<div style="position:absolute;left:144.09px;top:186.00px" class="cls_028"><span class="cls_028"># 255 decimal, probably what was meant</span></div>
<div style="position:absolute;left:72.00px;top:196.00px" class="cls_028"><span class="cls_028">08</span></div>
<div style="position:absolute;left:144.05px;top:196.00px" class="cls_028"><span class="cls_028"># illegal (0 implies octal)</span></div>
<div style="position:absolute;left:72.00px;top:206.00px" class="cls_028"><span class="cls_028">01024</span></div>
<div style="position:absolute;left:144.11px;top:206.00px" class="cls_028"><span class="cls_028"># octal for 528, probably not what was meant</span></div>
<div style="position:absolute;left:48.02px;top:228.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:228.67px" class="cls_006"><span class="cls_006">Pointer values can be used; in a word context, a label or relocatable</span></div>
<div style="position:absolute;left:59.97px;top:239.67px" class="cls_006"><span class="cls_006">symbol stands for its address as a 32-bit integer. The identifier ‘.’ (dot)</span></div>
<div style="position:absolute;left:59.97px;top:250.67px" class="cls_006"><span class="cls_006">represents the current location counter.</span></div>
<div style="position:absolute;left:59.97px;top:264.67px" class="cls_006"><span class="cls_006">Many assemblers even allow some limited arithmetic.</span></div>
<div style="position:absolute;left:48.03px;top:278.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:278.67px" class="cls_006"><span class="cls_006">Character constants and strings can contain the following special</span></div>
<div style="position:absolute;left:59.97px;top:289.67px" class="cls_006"><span class="cls_006">characters, introduced by the backslash ‘\’ escape character:</span></div>
<div style="position:absolute;left:155.75px;top:310.00px" class="cls_020"><span class="cls_020">character</span></div>
<div style="position:absolute;left:207.07px;top:310.00px" class="cls_020"><span class="cls_020">generated code</span></div>
<div style="position:absolute;left:155.75px;top:327.00px" class="cls_020"><span class="cls_020">\a</span></div>
<div style="position:absolute;left:206.95px;top:327.00px" class="cls_020"><span class="cls_020">alert (bell)</span></div>
<div style="position:absolute;left:155.75px;top:344.00px" class="cls_020"><span class="cls_020">\b</span></div>
<div style="position:absolute;left:206.95px;top:344.00px" class="cls_020"><span class="cls_020">backspace</span></div>
<div style="position:absolute;left:155.75px;top:361.00px" class="cls_020"><span class="cls_020">\e</span></div>
<div style="position:absolute;left:206.94px;top:361.00px" class="cls_020"><span class="cls_020">escape</span></div>
<div style="position:absolute;left:155.75px;top:378.00px" class="cls_020"><span class="cls_020">\f</span></div>
<div style="position:absolute;left:206.94px;top:378.00px" class="cls_020"><span class="cls_020">formfeed</span></div>
<div style="position:absolute;left:155.75px;top:395.01px" class="cls_020"><span class="cls_020">\n</span></div>
<div style="position:absolute;left:206.95px;top:395.01px" class="cls_020"><span class="cls_020">newline</span></div>
<div style="position:absolute;left:155.75px;top:412.01px" class="cls_020"><span class="cls_020">\r</span></div>
<div style="position:absolute;left:206.94px;top:412.01px" class="cls_020"><span class="cls_020">carriage return</span></div>
<div style="position:absolute;left:155.75px;top:429.01px" class="cls_020"><span class="cls_020">\t</span></div>
<div style="position:absolute;left:206.94px;top:429.01px" class="cls_020"><span class="cls_020">horizontal tab</span></div>
<div style="position:absolute;left:155.75px;top:446.01px" class="cls_020"><span class="cls_020">\v</span></div>
<div style="position:absolute;left:206.94px;top:446.01px" class="cls_020"><span class="cls_020">vertical tab</span></div>
<div style="position:absolute;left:155.75px;top:463.01px" class="cls_020"><span class="cls_020">\\</span></div>
<div style="position:absolute;left:206.95px;top:463.01px" class="cls_020"><span class="cls_020">backslash</span></div>
<div style="position:absolute;left:155.75px;top:480.01px" class="cls_020"><span class="cls_020">\’</span></div>
<div style="position:absolute;left:206.93px;top:480.01px" class="cls_020"><span class="cls_020">single quote</span></div>
<div style="position:absolute;left:155.75px;top:497.01px" class="cls_020"><span class="cls_020">\"</span></div>
<div style="position:absolute;left:206.94px;top:497.01px" class="cls_020"><span class="cls_020">double quote</span></div>
<div style="position:absolute;left:155.75px;top:514.01px" class="cls_020"><span class="cls_020">\0</span></div>
<div style="position:absolute;left:206.95px;top:514.01px" class="cls_020"><span class="cls_020">null (integer 0)</span></div>
<div style="position:absolute;left:59.97px;top:533.67px" class="cls_006"><span class="cls_006">A character can be represented as a one-, two-, or three-digit octal</span></div>
<div style="position:absolute;left:59.97px;top:544.67px" class="cls_006"><span class="cls_006">number (</span><span class="cls_029">\</span><span class="cls_006"> followed by octal digits), or as a one-, two-, or three-digit</span></div>
<div style="position:absolute;left:59.97px;top:555.67px" class="cls_006"><span class="cls_006">hexadecimal number (</span><span class="cls_029"> \x</span><span class="cls_006"> followed by hexadecimal digits).</span></div>
<div style="position:absolute;left:48.03px;top:569.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:569.67px" class="cls_006"><span class="cls_006">The   precedence   of   binary   and   unary   operations   in   constant</span></div>
<div style="position:absolute;left:59.98px;top:580.67px" class="cls_006"><span class="cls_006">expressions follows the C definition.</span></div>
<div style="position:absolute;left:36.00px;top:603.00px" class="cls_015"><span class="cls_015">REGISTER-TO-REGISTER INSTRUCTIONS</span></div>
<div style="position:absolute;left:48.02px;top:616.67px" class="cls_006"><span class="cls_006">Most MIPS machine instructions are three-register operations, i.e. they</span></div>
<div style="position:absolute;left:36.00px;top:627.67px" class="cls_006"><span class="cls_006">are arithmetic or logical functions with two inputs and one output, for</span></div>
<div style="position:absolute;left:36.00px;top:638.67px" class="cls_006"><span class="cls_006">example:</span></div>
<div style="position:absolute;left:54.00px;top:674.67px" class="cls_006"><span class="cls_006">† In IDT/c version 5.0 and later, the header files exist in the</span></div>
<div style="position:absolute;left:54.00px;top:686.67px" class="cls_006"><span class="cls_006">directory “/idtc”. The pre-processor is automatically invoked if the</span></div>
<div style="position:absolute;left:54.00px;top:698.67px" class="cls_006"><span class="cls_006">extension of the filename is anything other than “.s”. To force the</span></div>
<div style="position:absolute;left:54.00px;top:710.67px" class="cls_006"><span class="cls_006">pre-processor to be used with “.s” files, use the switch “-</span></div>
<div style="position:absolute;left:54.00px;top:722.67px" class="cls_006"><span class="cls_006">xassemble-with-cpp” in the command line.</span></div>
<div style="position:absolute;left:292.04px;top:755.33px" class="cls_002"><span class="cls_002">9–2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:88220px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:525.20px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:252.00px;top:51.00px" class="cls_028"><span class="cls_028">rd = rs + rt</span></div>
<div style="position:absolute;left:228.02px;top:73.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> rd</span><span class="cls_006">: is the </span><span class="cls_008">destination</span><span class="cls_006"> register, which receives the result of functions</span></div>
<div style="position:absolute;left:239.98px;top:84.67px" class="cls_008"><span class="cls_008">op</span><span class="cls_006">;</span></div>
<div style="position:absolute;left:228.02px;top:98.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> rs</span><span class="cls_006">: is a </span><span class="cls_008">source</span><span class="cls_006"> register (operand);</span></div>
<div style="position:absolute;left:228.02px;top:112.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> rt</span><span class="cls_006">: is a second </span><span class="cls_008">source</span><span class="cls_006"> register.</span></div>
<div style="position:absolute;left:228.02px;top:123.67px" class="cls_006"><span class="cls_006">In MIPS assembly language these type of instructions are written:</span></div>
<div style="position:absolute;left:252.00px;top:135.00px" class="cls_028"><span class="cls_028">opcode rd, rs, rt</span></div>
<div style="position:absolute;left:216.00px;top:156.00px" class="cls_020"><span class="cls_020">For example</span><span class="cls_039">:</span></div>
<div style="position:absolute;left:252.00px;top:176.00px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:288.10px;top:176.00px" class="cls_028"><span class="cls_028">$2, $4, $5</span></div>
<div style="position:absolute;left:468.33px;top:176.00px" class="cls_028"><span class="cls_028"># $2 = $4 + $5</span></div>
<div style="position:absolute;left:228.02px;top:195.67px" class="cls_006"><span class="cls_006">Of course any or all of the register operands may be identical. To</span></div>
<div style="position:absolute;left:216.00px;top:206.67px" class="cls_006"><span class="cls_006">produce a CISC-style, two-operand instruction just use the destination</span></div>
<div style="position:absolute;left:216.00px;top:217.67px" class="cls_006"><span class="cls_006">register as a source operands; the assembler will do this automatically if</span></div>
<div style="position:absolute;left:216.00px;top:228.67px" class="cls_008"><span class="cls_008">rs</span><span class="cls_006"> is omitted.</span></div>
<div style="position:absolute;left:252.00px;top:250.00px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:288.09px;top:250.00px" class="cls_028"><span class="cls_028">$4, $5</span></div>
<div style="position:absolute;left:360.00px;top:250.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     addu</span></div>
<div style="position:absolute;left:432.09px;top:250.00px" class="cls_028"><span class="cls_028">$4, $4, $5</span></div>
<div style="position:absolute;left:504.33px;top:250.00px" class="cls_028"><span class="cls_028"># $4 = $4 + $5</span></div>
<div style="position:absolute;left:228.02px;top:269.67px" class="cls_006"><span class="cls_006">Unary operations (e.g. neg, not) are always synthesized from one or</span></div>
<div style="position:absolute;left:216.00px;top:280.67px" class="cls_006"><span class="cls_006">more of the three-register instructions. The assembler expects maximum</span></div>
<div style="position:absolute;left:216.00px;top:291.67px" class="cls_006"><span class="cls_006">of two operands for these instructions (</span><span class="cls_008">dst</span><span class="cls_006"> and </span><span class="cls_008">src</span><span class="cls_006">):</span></div>
<div style="position:absolute;left:252.00px;top:313.00px" class="cls_028"><span class="cls_028">neg</span></div>
<div style="position:absolute;left:288.06px;top:313.00px" class="cls_028"><span class="cls_028">$2, $4</span></div>
<div style="position:absolute;left:360.00px;top:313.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     sub</span></div>
<div style="position:absolute;left:432.06px;top:313.00px" class="cls_028"><span class="cls_028">$2, $0, $4</span></div>
<div style="position:absolute;left:504.30px;top:313.00px" class="cls_028"><span class="cls_028"># $2 = -$4</span></div>
<div style="position:absolute;left:252.00px;top:323.00px" class="cls_028"><span class="cls_028">not</span></div>
<div style="position:absolute;left:288.06px;top:323.00px" class="cls_028"><span class="cls_028">$3</span></div>
<div style="position:absolute;left:360.00px;top:323.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     nor</span></div>
<div style="position:absolute;left:432.06px;top:323.00px" class="cls_028"><span class="cls_028">$3, $0, $3</span></div>
<div style="position:absolute;left:504.30px;top:323.00px" class="cls_028"><span class="cls_028"># $3 = ~$3</span></div>
<div style="position:absolute;left:228.02px;top:342.67px" class="cls_006"><span class="cls_006">Probably the most common register-to-register operation is move. This</span></div>
<div style="position:absolute;left:216.01px;top:353.67px" class="cls_006"><span class="cls_006">ubiquitous instruction is in fact implemented by an addu with the always</span></div>
<div style="position:absolute;left:216.00px;top:364.67px" class="cls_006"><span class="cls_006">zero-valued register </span><span class="cls_008">$0</span><span class="cls_006">:</span></div>
<div style="position:absolute;left:252.00px;top:386.00px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:288.09px;top:386.00px" class="cls_028"><span class="cls_028">$3, $5</span></div>
<div style="position:absolute;left:360.00px;top:386.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     addu</span></div>
<div style="position:absolute;left:432.09px;top:386.00px" class="cls_028"><span class="cls_028">$3, $5, $0</span></div>
<div style="position:absolute;left:504.32px;top:386.00px" class="cls_028"><span class="cls_028"># $3 = $5</span></div>
<div style="position:absolute;left:216.00px;top:417.00px" class="cls_015"><span class="cls_015">IMMEDIATE (CONSTANT) OPERANDS</span></div>
<div style="position:absolute;left:228.02px;top:430.67px" class="cls_006"><span class="cls_006">An immediate operand is the traditional term for a constant value found</span></div>
<div style="position:absolute;left:216.00px;top:441.67px" class="cls_006"><span class="cls_006">in a field of the instruction. Many of the MIPS arithmetic and logical</span></div>
<div style="position:absolute;left:216.00px;top:452.67px" class="cls_006"><span class="cls_006">operations have an alternative form which use a 16-bit immediate in place</span></div>
<div style="position:absolute;left:216.00px;top:463.67px" class="cls_006"><span class="cls_006">of </span><span class="cls_008">rt</span><span class="cls_006">. The immediate value is first sign-extended or zero-extended to 32-</span></div>
<div style="position:absolute;left:216.00px;top:474.67px" class="cls_006"><span class="cls_006">bits, for arithmetic or logical operations respectively.</span></div>
<div style="position:absolute;left:228.02px;top:485.67px" class="cls_006"><span class="cls_006">Although an immediate operand implies different low-level machine</span></div>
<div style="position:absolute;left:216.00px;top:496.67px" class="cls_006"><span class="cls_006">instruction from its three-register version (e.g. addi instead of add), there</span></div>
<div style="position:absolute;left:216.00px;top:507.67px" class="cls_006"><span class="cls_006">is no need for the programmer to write this explicitly. The assembler will</span></div>
<div style="position:absolute;left:216.00px;top:518.67px" class="cls_006"><span class="cls_006">spot the case when the final operand is an immediate, and use the correct</span></div>
<div style="position:absolute;left:216.00px;top:529.67px" class="cls_006"><span class="cls_006">machine instruction. For example:</span></div>
<div style="position:absolute;left:252.00px;top:551.00px" class="cls_028"><span class="cls_028">add</span></div>
<div style="position:absolute;left:288.07px;top:551.00px" class="cls_028"><span class="cls_028">$2, $4, 64</span></div>
<div style="position:absolute;left:360.00px;top:551.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     addi</span></div>
<div style="position:absolute;left:432.09px;top:551.00px" class="cls_028"><span class="cls_028">$2, $4, 64</span></div>
<div style="position:absolute;left:228.02px;top:570.67px" class="cls_006"><span class="cls_006">If an immediate value is too large to fit into the 16-bit field in the</span></div>
<div style="position:absolute;left:216.00px;top:581.67px" class="cls_006"><span class="cls_006">machine instruction, then the assembler helps out again. It automatically</span></div>
<div style="position:absolute;left:216.00px;top:592.67px" class="cls_006"><span class="cls_006">loads the constant into the </span><span class="cls_008">assembler temporary</span><span class="cls_006"> register </span><span class="cls_008">$at/$1</span><span class="cls_006"> and then</span></div>
<div style="position:absolute;left:216.00px;top:603.67px" class="cls_006"><span class="cls_006">performs the operation using that.</span></div>
<div style="position:absolute;left:252.00px;top:625.00px" class="cls_028"><span class="cls_028">add</span></div>
<div style="position:absolute;left:288.07px;top:625.00px" class="cls_028"><span class="cls_028">$4, 0x12345</span></div>
<div style="position:absolute;left:360.00px;top:625.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     li</span></div>
<div style="position:absolute;left:432.05px;top:625.00px" class="cls_028"><span class="cls_028">$at, 0x12345</span></div>
<div style="position:absolute;left:396.00px;top:635.00px" class="cls_028"><span class="cls_028">add</span></div>
<div style="position:absolute;left:432.07px;top:635.00px" class="cls_028"><span class="cls_028">$4, $4, $at</span></div>
<div style="position:absolute;left:228.02px;top:654.67px" class="cls_006"><span class="cls_006">Note the li (</span><span class="cls_008">load immediate</span><span class="cls_006">) instruction, which again isn’t found in the</span></div>
<div style="position:absolute;left:216.00px;top:665.67px" class="cls_006"><span class="cls_006">machine’s instruction set; li is a heavily-used macro instruction which</span></div>
<div style="position:absolute;left:216.00px;top:676.67px" class="cls_006"><span class="cls_006">loads a 32-bit integer value into a register, without the programmer having</span></div>
<div style="position:absolute;left:216.00px;top:687.67px" class="cls_006"><span class="cls_006">to worry about how it gets there:</span></div>
<div style="position:absolute;left:305.78px;top:755.33px" class="cls_002"><span class="cls_002">9–3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:89022px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:376.95px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">• When the 32-bit value lies between </span><span class="cls_003">±</span><span class="cls_006">32K it can use a single addiu</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">with $0; when bits 31-16 are all zero it can use ori; when the bits 15-</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">0 are all zero it will be lui; and when none of these is possible it will</span></div>
<div style="position:absolute;left:59.98px;top:83.67px" class="cls_006"><span class="cls_006">be a an lui/ori pair:</span></div>
<div style="position:absolute;left:72.00px;top:105.00px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:108.05px;top:105.00px" class="cls_028"><span class="cls_028">$3, -5</span></div>
<div style="position:absolute;left:180.00px;top:105.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     addiu  $3, $0, -5</span></div>
<div style="position:absolute;left:72.00px;top:125.00px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:108.05px;top:125.00px" class="cls_028"><span class="cls_028">$4, 0x8000</span></div>
<div style="position:absolute;left:180.00px;top:125.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     ori</span></div>
<div style="position:absolute;left:252.07px;top:125.00px" class="cls_028"><span class="cls_028">$4, $0, 0x8000</span></div>
<div style="position:absolute;left:72.00px;top:145.00px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:108.05px;top:145.00px" class="cls_028"><span class="cls_028">$5, 0x120000</span><span class="cls_021">→</span><span class="cls_028">lui</span></div>
<div style="position:absolute;left:216.07px;top:145.00px" class="cls_028"><span class="cls_028">$5, 0x12</span></div>
<div style="position:absolute;left:71.99px;top:165.00px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:108.04px;top:165.00px" class="cls_028"><span class="cls_028">$6, 0x12345</span><span class="cls_021">→</span><span class="cls_028"> lui</span></div>
<div style="position:absolute;left:216.06px;top:165.00px" class="cls_028"><span class="cls_028">$6, 0x1</span></div>
<div style="position:absolute;left:215.99px;top:174.99px" class="cls_028"><span class="cls_028">ori</span></div>
<div style="position:absolute;left:252.06px;top:174.99px" class="cls_028"><span class="cls_028">$6, $6, 0x2345</span></div>
<div style="position:absolute;left:36.00px;top:206.00px" class="cls_015"><span class="cls_015">MULTIPLY/DIVIDE</span></div>
<div style="position:absolute;left:48.02px;top:219.67px" class="cls_006"><span class="cls_006">The multiply and divide machine instructions are unusual:</span></div>
<div style="position:absolute;left:48.02px;top:233.67px" class="cls_006"><span class="cls_006">• they do not accept immediate operands;</span></div>
<div style="position:absolute;left:48.02px;top:247.67px" class="cls_006"><span class="cls_006">• they do not perform overflow or divide-by-zero tests;</span></div>
<div style="position:absolute;left:48.02px;top:261.67px" class="cls_006"><span class="cls_006">• they operate asynchronously - so other instructions can be executed</span></div>
<div style="position:absolute;left:59.97px;top:272.67px" class="cls_006"><span class="cls_006">while they do their work;</span></div>
<div style="position:absolute;left:48.02px;top:286.67px" class="cls_006"><span class="cls_006">• they store their results in two separate result registers (</span><span class="cls_008">hi</span><span class="cls_006"> and </span><span class="cls_008">lo</span><span class="cls_006">),</span></div>
<div style="position:absolute;left:59.97px;top:297.67px" class="cls_006"><span class="cls_006">which can only be read with the two special instructions mfhi and</span></div>
<div style="position:absolute;left:59.98px;top:308.67px" class="cls_006"><span class="cls_006">mflo;</span></div>
<div style="position:absolute;left:48.02px;top:322.67px" class="cls_006"><span class="cls_006">• the result registers are interlocked - they can be read at any time after</span></div>
<div style="position:absolute;left:59.97px;top:333.67px" class="cls_006"><span class="cls_006">the operation is started, and the processor will stall until the result is</span></div>
<div style="position:absolute;left:59.97px;top:344.67px" class="cls_006"><span class="cls_006">ready.</span></div>
<div style="position:absolute;left:48.02px;top:355.67px" class="cls_006"><span class="cls_006">However the conventional assembler multiply/divide instructions will</span></div>
<div style="position:absolute;left:36.00px;top:366.67px" class="cls_006"><span class="cls_006">hide this: they are complex macro instructions which simulate a three-</span></div>
<div style="position:absolute;left:36.00px;top:377.67px" class="cls_006"><span class="cls_006">operand instruction and perform overflow checking. A signed divide may</span></div>
<div style="position:absolute;left:36.00px;top:388.67px" class="cls_006"><span class="cls_006">generate about 13 instructions, but they execute in parallel with the</span></div>
<div style="position:absolute;left:36.00px;top:399.67px" class="cls_006"><span class="cls_006">hardware divider so that no time is wasted (the divide itself takes 35</span></div>
<div style="position:absolute;left:36.00px;top:410.67px" class="cls_006"><span class="cls_006">cycles).</span></div>
<div style="position:absolute;left:48.21px;top:431.00px" class="cls_020"><span class="cls_020">Instruction</span></div>
<div style="position:absolute;left:221.04px;top:431.00px" class="cls_020"><span class="cls_020">Description</span></div>
<div style="position:absolute;left:48.21px;top:448.00px" class="cls_020"><span class="cls_020">mul</span></div>
<div style="position:absolute;left:112.05px;top:448.00px" class="cls_020"><span class="cls_020">simple unsigned multiply, no checking</span></div>
<div style="position:absolute;left:48.21px;top:465.00px" class="cls_020"><span class="cls_020">mulo</span></div>
<div style="position:absolute;left:112.07px;top:465.00px" class="cls_020"><span class="cls_020">signed multiply, checks for overflow above 32-bits</span></div>
<div style="position:absolute;left:48.21px;top:482.00px" class="cls_020"><span class="cls_020">mulou</span></div>
<div style="position:absolute;left:112.10px;top:482.00px" class="cls_020"><span class="cls_020">unsigned multiply, checks for overflow above 32-bits</span></div>
<div style="position:absolute;left:48.21px;top:499.00px" class="cls_020"><span class="cls_020">div</span></div>
<div style="position:absolute;left:112.03px;top:499.00px" class="cls_020"><span class="cls_020">signed divide, checks for zero divisor or divisor of -1 with most</span></div>
<div style="position:absolute;left:111.96px;top:509.00px" class="cls_020"><span class="cls_020">negative dividend.</span></div>
<div style="position:absolute;left:48.21px;top:526.00px" class="cls_020"><span class="cls_020">divu</span></div>
<div style="position:absolute;left:112.06px;top:526.00px" class="cls_020"><span class="cls_020">unsigned divide, checks for zero divisor</span></div>
<div style="position:absolute;left:48.21px;top:543.01px" class="cls_020"><span class="cls_020">rem</span></div>
<div style="position:absolute;left:112.05px;top:543.01px" class="cls_020"><span class="cls_020">signed remainder, checks for zero divisor or divisor of -1 with</span></div>
<div style="position:absolute;left:111.96px;top:553.00px" class="cls_020"><span class="cls_020">most negative dividend.</span></div>
<div style="position:absolute;left:48.21px;top:570.01px" class="cls_020"><span class="cls_020">remu</span></div>
<div style="position:absolute;left:112.07px;top:570.01px" class="cls_020"><span class="cls_020">unsigned remainder, checks for zero divisor</span></div>
<div style="position:absolute;left:48.02px;top:589.67px" class="cls_006"><span class="cls_006">Some  MIPS  assemblers  will  convert  constant  multiplication,  and</span></div>
<div style="position:absolute;left:36.00px;top:600.67px" class="cls_006"><span class="cls_006">division/remainder by constant powers of two, into the appropriate shifts,</span></div>
<div style="position:absolute;left:36.00px;top:611.67px" class="cls_006"><span class="cls_006">masks, etc. Don’t rely on this though, as most toolchains expect the</span></div>
<div style="position:absolute;left:36.00px;top:622.67px" class="cls_006"><span class="cls_006">compiler   or   assembly-language   programmer   to   spot   this   sort   of</span></div>
<div style="position:absolute;left:36.00px;top:633.67px" class="cls_006"><span class="cls_006">optimization.</span></div>
<div style="position:absolute;left:48.02px;top:644.67px" class="cls_006"><span class="cls_006">To  explicitly  control  the  multiplication,  specify  a </span><span class="cls_008"> dst</span><span class="cls_006">  of</span></div>
<div style="position:absolute;left:354.92px;top:644.67px" class="cls_008"><span class="cls_008">$0</span><span class="cls_006">.  The</span></div>
<div style="position:absolute;left:36.00px;top:655.67px" class="cls_006"><span class="cls_006">assembler will issue the raw machine instruction to start the operation; it</span></div>
<div style="position:absolute;left:36.00px;top:666.67px" class="cls_006"><span class="cls_006">is then up to the programmer to fetch the result from </span><span class="cls_008">hi</span><span class="cls_006"> and/or </span><span class="cls_008">lo</span><span class="cls_006"> and, if</span></div>
<div style="position:absolute;left:36.00px;top:677.67px" class="cls_006"><span class="cls_006">required, perform overflow checking.</span></div>
<div style="position:absolute;left:292.03px;top:755.33px" class="cls_002"><span class="cls_002">9–4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:89824px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:525.20px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:216.00px;top:50.00px" class="cls_015"><span class="cls_015">LOAD/STORE INSTRUCTIONS</span></div>
<div style="position:absolute;left:228.02px;top:63.67px" class="cls_006"><span class="cls_006">The following table lists all the assembler’s load/store instructions. The</span></div>
<div style="position:absolute;left:216.00px;top:74.67px" class="cls_006"><span class="cls_006">signed load instructions sign-extend the memory data to 32-bits; the</span></div>
<div style="position:absolute;left:216.00px;top:85.67px" class="cls_006"><span class="cls_006">unsigned instructions zero-extend.</span></div>
<div style="position:absolute;left:247.15px;top:106.00px" class="cls_020"><span class="cls_020">Load</span></div>
<div style="position:absolute;left:338.74px;top:106.00px" class="cls_020"><span class="cls_020">Store</span></div>
<div style="position:absolute;left:390.17px;top:106.00px" class="cls_020"><span class="cls_020">Description</span></div>
<div style="position:absolute;left:247.15px;top:123.00px" class="cls_020"><span class="cls_020">Signed</span></div>
<div style="position:absolute;left:287.46px;top:123.00px" class="cls_020"><span class="cls_020">Unsigned</span></div>
<div style="position:absolute;left:247.15px;top:140.00px" class="cls_020"><span class="cls_020">lw</span></div>
<div style="position:absolute;left:338.70px;top:140.00px" class="cls_020"><span class="cls_020">sw</span></div>
<div style="position:absolute;left:390.08px;top:140.00px" class="cls_020"><span class="cls_020">word</span></div>
<div style="position:absolute;left:247.15px;top:157.00px" class="cls_020"><span class="cls_020">lh</span></div>
<div style="position:absolute;left:287.37px;top:157.00px" class="cls_020"><span class="cls_020">lhu</span></div>
<div style="position:absolute;left:338.76px;top:157.00px" class="cls_020"><span class="cls_020">sh</span></div>
<div style="position:absolute;left:390.14px;top:157.00px" class="cls_020"><span class="cls_020">halfword</span></div>
<div style="position:absolute;left:247.15px;top:174.00px" class="cls_020"><span class="cls_020">lb</span></div>
<div style="position:absolute;left:287.37px;top:174.00px" class="cls_020"><span class="cls_020">lbu</span></div>
<div style="position:absolute;left:338.76px;top:174.00px" class="cls_020"><span class="cls_020">sb</span></div>
<div style="position:absolute;left:390.13px;top:174.00px" class="cls_020"><span class="cls_020">byte</span></div>
<div style="position:absolute;left:247.15px;top:191.01px" class="cls_020"><span class="cls_020">ulw</span></div>
<div style="position:absolute;left:338.72px;top:191.01px" class="cls_020"><span class="cls_020">usw</span></div>
<div style="position:absolute;left:390.13px;top:191.01px" class="cls_020"><span class="cls_020">unaligned word</span></div>
<div style="position:absolute;left:247.15px;top:208.01px" class="cls_020"><span class="cls_020">ulh</span></div>
<div style="position:absolute;left:287.40px;top:208.01px" class="cls_020"><span class="cls_020">ulhu</span></div>
<div style="position:absolute;left:338.81px;top:208.01px" class="cls_020"><span class="cls_020">ush</span></div>
<div style="position:absolute;left:390.21px;top:208.01px" class="cls_020"><span class="cls_020">unaligned halfword</span></div>
<div style="position:absolute;left:247.15px;top:225.01px" class="cls_020"><span class="cls_020">lwl</span></div>
<div style="position:absolute;left:338.70px;top:225.01px" class="cls_020"><span class="cls_020">swl</span></div>
<div style="position:absolute;left:390.10px;top:225.01px" class="cls_020"><span class="cls_020">word left</span></div>
<div style="position:absolute;left:247.15px;top:242.01px" class="cls_020"><span class="cls_020">lwr</span></div>
<div style="position:absolute;left:338.71px;top:242.01px" class="cls_020"><span class="cls_020">swr</span></div>
<div style="position:absolute;left:390.11px;top:242.01px" class="cls_020"><span class="cls_020">word right</span></div>
<div style="position:absolute;left:247.15px;top:259.01px" class="cls_020"><span class="cls_020">l.d</span></div>
<div style="position:absolute;left:338.70px;top:259.01px" class="cls_020"><span class="cls_020">s.d</span></div>
<div style="position:absolute;left:390.10px;top:259.01px" class="cls_020"><span class="cls_020">double precision floating-point</span></div>
<div style="position:absolute;left:247.15px;top:276.01px" class="cls_020"><span class="cls_020">l.s</span></div>
<div style="position:absolute;left:338.70px;top:276.01px" class="cls_020"><span class="cls_020">s.s</span></div>
<div style="position:absolute;left:390.10px;top:276.01px" class="cls_020"><span class="cls_020">single precision floating-point (i.e.,</span></div>
<div style="position:absolute;left:389.96px;top:286.01px" class="cls_020"><span class="cls_020">coprocessor 1 register)</span></div>
<div style="position:absolute;left:247.15px;top:293.01px" class="cls_020"><span class="cls_020">lwc1</span></div>
<div style="position:absolute;left:338.74px;top:293.01px" class="cls_020"><span class="cls_020">swc1</span></div>
<div style="position:absolute;left:228.02px;top:312.67px" class="cls_006"><span class="cls_006">Don’t forget the architectural constraints of load/store instructions:</span></div>
<div style="position:absolute;left:228.02px;top:326.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Strict alignment</span><span class="cls_006">: addresses must be aligned correctly (i.e. a multiple</span></div>
<div style="position:absolute;left:239.97px;top:337.67px" class="cls_006"><span class="cls_006">of 4 for words, and 2 for halfwords), except for the special </span><span class="cls_008">left</span><span class="cls_006">, </span><span class="cls_008">right</span></div>
<div style="position:absolute;left:239.97px;top:348.67px" class="cls_006"><span class="cls_006">and </span><span class="cls_008">unaligned</span><span class="cls_006"> variants (described below), or else they will cause an</span></div>
<div style="position:absolute;left:239.98px;top:359.67px" class="cls_006"><span class="cls_006">exception.</span></div>
<div style="position:absolute;left:228.03px;top:373.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Load delay</span><span class="cls_006">: all load instructions require at least one other instruction</span></div>
<div style="position:absolute;left:239.98px;top:384.67px" class="cls_006"><span class="cls_006">between them and the instruction which uses their result - but most</span></div>
<div style="position:absolute;left:239.98px;top:395.67px" class="cls_006"><span class="cls_006">assemblers should guarantee this by inserting a nop if necessary.</span></div>
<div style="position:absolute;left:239.99px;top:406.67px" class="cls_006"><span class="cls_006">There is a special exception to this rule for lwl followed immediately</span></div>
<div style="position:absolute;left:239.99px;top:417.67px" class="cls_006"><span class="cls_006">by lwr to the same register, or </span><span class="cls_008">vice versa</span><span class="cls_006"> (the last instruction of the</span></div>
<div style="position:absolute;left:240.00px;top:428.67px" class="cls_006"><span class="cls_006">pair will still have the delay slot, but no delay slot is required between</span></div>
<div style="position:absolute;left:240.00px;top:439.67px" class="cls_006"><span class="cls_006">the instructions in the pair).</span></div>
<div style="position:absolute;left:216.00px;top:462.00px" class="cls_015"><span class="cls_015">Unaligned loads and store</span></div>
<div style="position:absolute;left:228.02px;top:475.67px" class="cls_006"><span class="cls_006">As noted above, normal load and store instructions must have a</span></div>
<div style="position:absolute;left:216.00px;top:486.67px" class="cls_006"><span class="cls_006">correctly aligned address. This can occasionally cause problems when</span></div>
<div style="position:absolute;left:216.00px;top:497.67px" class="cls_006"><span class="cls_006">porting   software   from   CISC   architectures   which   allow   unaligned</span></div>
<div style="position:absolute;left:216.00px;top:508.67px" class="cls_006"><span class="cls_006">addresses.</span></div>
<div style="position:absolute;left:228.02px;top:519.67px" class="cls_006"><span class="cls_006">All data structures that are declared as part of a standard C program</span></div>
<div style="position:absolute;left:216.00px;top:530.67px" class="cls_006"><span class="cls_006">will be aligned correctly. But addresses computed at run-time, or data</span></div>
<div style="position:absolute;left:216.00px;top:541.67px" class="cls_006"><span class="cls_006">structures  declared  using  a  non-standard  language  extension,  may</span></div>
<div style="position:absolute;left:216.00px;top:552.67px" class="cls_006"><span class="cls_006">require that software copes with unaligned addresses. While this can be</span></div>
<div style="position:absolute;left:216.00px;top:563.67px" class="cls_006"><span class="cls_006">done  by  a  combination  of  byte  loads,  shifts  and  adds,  the  MIPS</span></div>
<div style="position:absolute;left:216.00px;top:574.67px" class="cls_006"><span class="cls_006">architecture  provides  the  special  purpose  lwl,   lwr,   swl  and  swr</span></div>
<div style="position:absolute;left:215.99px;top:585.67px" class="cls_006"><span class="cls_006">instructions. An unaligned word can be accessed using just two of these</span></div>
<div style="position:absolute;left:215.99px;top:596.67px" class="cls_006"><span class="cls_006">special instructions as a pair, however they are not usually used directly,</span></div>
<div style="position:absolute;left:215.99px;top:607.67px" class="cls_006"><span class="cls_006">but are generated by the ulw (unaligned load word) and usw (unaligned</span></div>
<div style="position:absolute;left:215.99px;top:618.67px" class="cls_006"><span class="cls_006">store word) macro instructions.</span></div>
<div style="position:absolute;left:228.01px;top:629.67px" class="cls_006"><span class="cls_006">The ulh, ulhu, and ush unaligned halfword macro instructions do not</span></div>
<div style="position:absolute;left:216.00px;top:640.67px" class="cls_006"><span class="cls_006">use the special instructions. Unaligned halfwords loads generate two lb’s,</span></div>
<div style="position:absolute;left:216.01px;top:651.67px" class="cls_006"><span class="cls_006">a shl and an or (4 instructions); stores generate two sb’s and a shr (3</span></div>
<div style="position:absolute;left:216.02px;top:662.67px" class="cls_006"><span class="cls_006">instructions).</span></div>
<div style="position:absolute;left:305.78px;top:755.34px" class="cls_002"><span class="cls_002">9–5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:90626px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:376.95px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:36.00px;top:50.00px" class="cls_015"><span class="cls_015">ADDRESSING MODES</span></div>
<div style="position:absolute;left:48.02px;top:63.67px" class="cls_006"><span class="cls_006">As discussed above, the hardware supports only one addressing mode:</span></div>
<div style="position:absolute;left:36.00px;top:74.67px" class="cls_008"><span class="cls_008">base_reg+offset</span><span class="cls_006">, where </span><span class="cls_008">offset</span><span class="cls_006"> is in the range -32768 to 32767. However the</span></div>
<div style="position:absolute;left:36.00px;top:85.67px" class="cls_006"><span class="cls_006">assembler simulates </span><span class="cls_008">direct</span><span class="cls_006"> and </span><span class="cls_008">direct+index-reg</span><span class="cls_006"> addressing modes by</span></div>
<div style="position:absolute;left:36.00px;top:96.67px" class="cls_006"><span class="cls_006">using two or three machine instructions, and the assembler-temporary</span></div>
<div style="position:absolute;left:36.00px;top:107.67px" class="cls_006"><span class="cls_006">register.</span></div>
<div style="position:absolute;left:72.00px;top:129.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:108.05px;top:129.00px" class="cls_028"><span class="cls_028">$2, ($3)</span></div>
<div style="position:absolute;left:180.00px;top:129.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     lw</span></div>
<div style="position:absolute;left:252.05px;top:129.00px" class="cls_028"><span class="cls_028">$2, 0($3)</span></div>
<div style="position:absolute;left:72.00px;top:149.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:108.05px;top:149.00px" class="cls_028"><span class="cls_028">$2, 8+4($3)</span></div>
<div style="position:absolute;left:180.00px;top:149.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     lw</span></div>
<div style="position:absolute;left:252.05px;top:149.00px" class="cls_028"><span class="cls_028">$2, 12($3)</span></div>
<div style="position:absolute;left:72.00px;top:169.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:108.05px;top:169.00px" class="cls_028"><span class="cls_028">$2, addr</span></div>
<div style="position:absolute;left:180.00px;top:169.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     lui</span></div>
<div style="position:absolute;left:252.07px;top:169.00px" class="cls_028"><span class="cls_028">$at, %hi_addr</span></div>
<div style="position:absolute;left:216.00px;top:178.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:252.05px;top:178.99px" class="cls_028"><span class="cls_028">$2, %lo_addr($at)</span></div>
<div style="position:absolute;left:72.00px;top:198.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:108.05px;top:198.99px" class="cls_028"><span class="cls_028">$2, addr($3)</span></div>
<div style="position:absolute;left:180.00px;top:198.99px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     lui</span></div>
<div style="position:absolute;left:252.07px;top:198.99px" class="cls_028"><span class="cls_028">$at, %hi_addr</span></div>
<div style="position:absolute;left:216.00px;top:208.99px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:252.09px;top:208.99px" class="cls_028"><span class="cls_028">$at, $at, $3</span></div>
<div style="position:absolute;left:216.00px;top:218.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:252.05px;top:218.99px" class="cls_028"><span class="cls_028">$2, %lo_addr($at)</span></div>
<div style="position:absolute;left:48.02px;top:238.67px" class="cls_006"><span class="cls_006">The store instruction is written with the source register first and the</span></div>
<div style="position:absolute;left:36.00px;top:249.67px" class="cls_006"><span class="cls_006">address second, to look like a load; for other operations the destination is</span></div>
<div style="position:absolute;left:36.00px;top:260.67px" class="cls_006"><span class="cls_006">first.</span></div>
<div style="position:absolute;left:48.02px;top:271.67px" class="cls_006"><span class="cls_006">The symbol </span><span class="cls_008">addr</span><span class="cls_006"> in the above examples can be any of these things:</span></div>
<div style="position:absolute;left:48.02px;top:285.67px" class="cls_006"><span class="cls_006">• a </span><span class="cls_008">relocatable symbol</span><span class="cls_006"> - the name of a label or variable (whether in this</span></div>
<div style="position:absolute;left:59.97px;top:296.67px" class="cls_006"><span class="cls_006">module or elsewhere);</span></div>
<div style="position:absolute;left:48.02px;top:310.67px" class="cls_006"><span class="cls_006">• a relocatable symbol </span><span class="cls_003">±</span><span class="cls_006"> a constant expression;</span></div>
<div style="position:absolute;left:48.03px;top:324.67px" class="cls_006"><span class="cls_006">• a 32-bit constant expression (e.g. the absolute address of a device</span></div>
<div style="position:absolute;left:59.98px;top:335.67px" class="cls_006"><span class="cls_006">register).</span></div>
<div style="position:absolute;left:48.03px;top:346.67px" class="cls_006"><span class="cls_006">The constructs ‘‘%hi_’’ and ‘‘%lo_’’ do not actually exist in the assembler,</span></div>
<div style="position:absolute;left:36.01px;top:357.67px" class="cls_006"><span class="cls_006">but represent the high and low 16-bits of the address. This is not quite the</span></div>
<div style="position:absolute;left:36.01px;top:368.67px" class="cls_006"><span class="cls_006">straightforward division into low and high words that it looks, because the</span></div>
<div style="position:absolute;left:36.01px;top:379.67px" class="cls_006"><span class="cls_006">16-bit offset field of a lw is treated as signed. So if the ‘‘addr’’ value is such</span></div>
<div style="position:absolute;left:36.01px;top:390.67px" class="cls_006"><span class="cls_006">that bit 15 is a ‘‘1’’, then the </span><span class="cls_029">%lo_addr</span><span class="cls_006"> value will act as negative, and the</span></div>
<div style="position:absolute;left:36.01px;top:401.67px" class="cls_006"><span class="cls_006">assembler needs to increment </span><span class="cls_029">%hi_addr</span><span class="cls_006"> to compensate:</span></div>
<div style="position:absolute;left:135.56px;top:422.00px" class="cls_020"><span class="cls_020">addr</span></div>
<div style="position:absolute;left:202.97px;top:422.00px" class="cls_020"><span class="cls_020">%hi_addr</span></div>
<div style="position:absolute;left:254.29px;top:422.00px" class="cls_020"><span class="cls_020">%lo_addr</span></div>
<div style="position:absolute;left:135.56px;top:439.00px" class="cls_020"><span class="cls_020">0x12345678</span></div>
<div style="position:absolute;left:203.11px;top:439.00px" class="cls_020"><span class="cls_020">0x1234</span></div>
<div style="position:absolute;left:254.40px;top:439.00px" class="cls_020"><span class="cls_020">0x5678</span></div>
<div style="position:absolute;left:135.56px;top:456.00px" class="cls_020"><span class="cls_020">0x10008000</span></div>
<div style="position:absolute;left:203.11px;top:456.00px" class="cls_020"><span class="cls_020">0x1001</span></div>
<div style="position:absolute;left:254.40px;top:456.00px" class="cls_020"><span class="cls_020">0x8000</span></div>
<div style="position:absolute;left:48.03px;top:475.67px" class="cls_006"><span class="cls_006">The la (</span><span class="cls_008">load address</span><span class="cls_006">) macro instruction provides a similar service for</span></div>
<div style="position:absolute;left:36.01px;top:486.67px" class="cls_006"><span class="cls_006">addresses as the li instruction provides for integer constants:</span></div>
<div style="position:absolute;left:72.00px;top:508.00px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:108.05px;top:508.00px" class="cls_028"><span class="cls_028">$2, 4($3)</span></div>
<div style="position:absolute;left:180.00px;top:508.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     addiu  $2, $3, 4</span></div>
<div style="position:absolute;left:72.00px;top:528.00px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:108.05px;top:528.00px" class="cls_028"><span class="cls_028">$2, addr</span></div>
<div style="position:absolute;left:180.00px;top:528.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     lui</span></div>
<div style="position:absolute;left:252.07px;top:528.00px" class="cls_028"><span class="cls_028">$at, %hi_addr</span></div>
<div style="position:absolute;left:216.00px;top:538.00px" class="cls_028"><span class="cls_028">addiu</span></div>
<div style="position:absolute;left:252.11px;top:538.00px" class="cls_028"><span class="cls_028">$2, $at, %lo_addr</span></div>
<div style="position:absolute;left:72.00px;top:557.99px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:108.05px;top:557.99px" class="cls_028"><span class="cls_028">$2, addr($3)</span></div>
<div style="position:absolute;left:180.00px;top:557.99px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     lui</span></div>
<div style="position:absolute;left:252.07px;top:557.99px" class="cls_028"><span class="cls_028">$at, %hi_addr</span></div>
<div style="position:absolute;left:216.00px;top:567.99px" class="cls_028"><span class="cls_028">addiu</span></div>
<div style="position:absolute;left:252.11px;top:567.99px" class="cls_028"><span class="cls_028">$2, $at, %lo_addr</span></div>
<div style="position:absolute;left:216.00px;top:577.99px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:252.09px;top:577.99px" class="cls_028"><span class="cls_028">$2, $2, $3</span></div>
<div style="position:absolute;left:48.02px;top:597.67px" class="cls_006"><span class="cls_006">In principle, la could avoid apparently-negative ‘‘%lo_’’ values by using</span></div>
<div style="position:absolute;left:36.00px;top:608.67px" class="cls_006"><span class="cls_006">an ori instruction. But the linker has to be able to fix up addresses in the</span></div>
<div style="position:absolute;left:36.00px;top:619.67px" class="cls_006"><span class="cls_006">signed ‘‘%lo_’’ format found for load/store instructions - so la uses the add</span></div>
<div style="position:absolute;left:36.01px;top:630.67px" class="cls_006"><span class="cls_006">instruction so as to use the same kind of address fixup.</span></div>
<div style="position:absolute;left:36.00px;top:653.00px" class="cls_015"><span class="cls_015">Gp-relative addressing</span></div>
<div style="position:absolute;left:48.02px;top:666.67px" class="cls_006"><span class="cls_006">Loads and stores to global variables or constants usually require at least</span></div>
<div style="position:absolute;left:36.00px;top:677.67px" class="cls_006"><span class="cls_006">two instructions, e.g.:</span></div>
<div style="position:absolute;left:72.00px;top:699.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:108.05px;top:699.00px" class="cls_028"><span class="cls_028">$2, addr</span></div>
<div style="position:absolute;left:180.00px;top:699.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     lui</span></div>
<div style="position:absolute;left:252.07px;top:699.00px" class="cls_028"><span class="cls_028">$at, %hi_addr</span></div>
<div style="position:absolute;left:216.00px;top:709.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:252.05px;top:709.00px" class="cls_028"><span class="cls_028">$2, %lo_addr($at)</span></div>
<div style="position:absolute;left:292.03px;top:755.34px" class="cls_002"><span class="cls_002">9–6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:91428px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:525.20px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:252.00px;top:51.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:288.05px;top:51.00px" class="cls_028"><span class="cls_028">$2, addr($3)</span></div>
<div style="position:absolute;left:360.00px;top:51.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     lui</span></div>
<div style="position:absolute;left:432.07px;top:51.00px" class="cls_028"><span class="cls_028">$at, %hi_addr</span></div>
<div style="position:absolute;left:396.00px;top:61.00px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:432.09px;top:61.00px" class="cls_028"><span class="cls_028">$at, $at, $3</span></div>
<div style="position:absolute;left:396.00px;top:71.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:432.05px;top:71.00px" class="cls_028"><span class="cls_028">$2, %lo_addr($at)</span></div>
<div style="position:absolute;left:228.02px;top:90.67px" class="cls_006"><span class="cls_006">A common low-level optimization supported by many toolchains is to</span></div>
<div style="position:absolute;left:216.00px;top:101.67px" class="cls_006"><span class="cls_006">use </span><span class="cls_008">gp-relative addressing</span><span class="cls_006">. This technique requires the cooperation of the</span></div>
<div style="position:absolute;left:216.01px;top:112.67px" class="cls_006"><span class="cls_006">compiler, assembler, linker and run-time start-up code to pool all of the</span></div>
<div style="position:absolute;left:216.01px;top:123.67px" class="cls_006"><span class="cls_006">‘‘small’’ variables and constants into a single region of maximum size</span></div>
<div style="position:absolute;left:216.01px;top:134.67px" class="cls_006"><span class="cls_006">64Kb, and then set register </span><span class="cls_008">$28</span><span class="cls_006"> (known as the </span><span class="cls_008">global pointer</span><span class="cls_006"> or </span><span class="cls_008">gp</span><span class="cls_006"> register)</span></div>
<div style="position:absolute;left:216.01px;top:145.67px" class="cls_006"><span class="cls_006">to point to the middle of this region†. With this knowledge the assembler</span></div>
<div style="position:absolute;left:216.01px;top:156.67px" class="cls_006"><span class="cls_006">can reduce the number of instructions used to access any of these small</span></div>
<div style="position:absolute;left:216.01px;top:167.67px" class="cls_006"><span class="cls_006">variables, e.g.:</span></div>
<div style="position:absolute;left:252.00px;top:189.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:288.05px;top:189.00px" class="cls_028"><span class="cls_028">$2, addr</span></div>
<div style="position:absolute;left:360.00px;top:189.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     lw</span></div>
<div style="position:absolute;left:432.05px;top:189.00px" class="cls_028"><span class="cls_028">$2, addr - _gp($at)</span></div>
<div style="position:absolute;left:252.00px;top:209.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:288.05px;top:209.00px" class="cls_028"><span class="cls_028">$2, addr($3)</span></div>
<div style="position:absolute;left:360.00px;top:209.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     addu</span></div>
<div style="position:absolute;left:432.09px;top:209.00px" class="cls_028"><span class="cls_028">$at, $gp, $3</span></div>
<div style="position:absolute;left:396.00px;top:219.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:432.05px;top:219.00px" class="cls_028"><span class="cls_028">$2, addr - _gp($at)</span></div>
<div style="position:absolute;left:228.02px;top:238.67px" class="cls_006"><span class="cls_006">By default most toolchains consider objects less than or equal to 8 bytes</span></div>
<div style="position:absolute;left:216.00px;top:249.67px" class="cls_006"><span class="cls_006">in size to be ‘‘small’’. This limit can usually be controlled by the ‘</span><span class="cls_041">-G n</span><span class="cls_006">’</span></div>
<div style="position:absolute;left:216.00px;top:260.67px" class="cls_006"><span class="cls_006">compiler/assembler option; specifying ‘</span><span class="cls_041">-G 0</span><span class="cls_006">’ will switch this optimization</span></div>
<div style="position:absolute;left:216.00px;top:271.67px" class="cls_006"><span class="cls_006">off altogether.</span></div>
<div style="position:absolute;left:228.02px;top:282.67px" class="cls_006"><span class="cls_006">While it is a useful optimization, there are some pitfalls to beware of:</span></div>
<div style="position:absolute;left:228.02px;top:296.67px" class="cls_006"><span class="cls_006">• The programmer must take special care when writing assembler code</span></div>
<div style="position:absolute;left:239.97px;top:307.67px" class="cls_006"><span class="cls_006">to declare global data items correctly:</span></div>
<div style="position:absolute;left:228.02px;top:321.67px" class="cls_006"><span class="cls_006">a)</span></div>
<div style="position:absolute;left:264.02px;top:321.67px" class="cls_006"><span class="cls_006">Writable, initialized data of 8 bytes or less must be put explicitly</span></div>
<div style="position:absolute;left:264.02px;top:332.67px" class="cls_006"><span class="cls_006">into the </span><span class="cls_029">.sdata</span><span class="cls_006"> section.</span></div>
<div style="position:absolute;left:228.02px;top:346.67px" class="cls_006"><span class="cls_006">b)</span></div>
<div style="position:absolute;left:264.02px;top:346.67px" class="cls_006"><span class="cls_006">Global </span><span class="cls_008">common</span><span class="cls_006"> data must be declared with the correct size, e.g:</span></div>
<div style="position:absolute;left:252.00px;top:368.00px" class="cls_028"><span class="cls_028">.comm  smallobj, 4</span></div>
<div style="position:absolute;left:252.00px;top:378.00px" class="cls_028"><span class="cls_028">.comm  bigobj, 100</span></div>
<div style="position:absolute;left:228.02px;top:400.67px" class="cls_006"><span class="cls_006">c)</span></div>
<div style="position:absolute;left:264.02px;top:400.67px" class="cls_006"><span class="cls_006">Small external variables should also be explicitly declared, e.g:</span></div>
<div style="position:absolute;left:252.00px;top:422.00px" class="cls_028"><span class="cls_028">.externsmallext, 4</span></div>
<div style="position:absolute;left:228.02px;top:444.67px" class="cls_006"><span class="cls_006">d)</span></div>
<div style="position:absolute;left:264.02px;top:444.67px" class="cls_006"><span class="cls_006">Most assemblers are effectively one-pass, so make sure that the</span></div>
<div style="position:absolute;left:264.02px;top:455.67px" class="cls_006"><span class="cls_006">program declares data before using it in the code, to get the most</span></div>
<div style="position:absolute;left:264.02px;top:466.67px" class="cls_006"><span class="cls_006">out of the optimization.</span></div>
<div style="position:absolute;left:228.02px;top:480.67px" class="cls_006"><span class="cls_006">• In C, global variables must be declared correctly in all modules which</span></div>
<div style="position:absolute;left:239.97px;top:491.67px" class="cls_006"><span class="cls_006">use them. For external arrays either omit the size (e.g. </span><span class="cls_029">extern int</span></div>
<div style="position:absolute;left:239.97px;top:502.67px" class="cls_029"><span class="cls_029">extarray[]</span><span class="cls_006">), or give the correct size (e.g.</span><span class="cls_029">int cmnarray[NARRAY]</span><span class="cls_006">).</span></div>
<div style="position:absolute;left:239.98px;top:513.67px" class="cls_006"><span class="cls_006">Don’t just give a dummy size of 1.</span></div>
<div style="position:absolute;left:228.03px;top:527.67px" class="cls_006"><span class="cls_006">• A very large number of small data items or constants may cause the</span></div>
<div style="position:absolute;left:239.98px;top:538.67px" class="cls_006"><span class="cls_006">64Kb limit to be exceeded, causing strange relocation errors when</span></div>
<div style="position:absolute;left:239.98px;top:549.67px" class="cls_006"><span class="cls_006">linking. The simplest solution here is to completely disable gp-relative</span></div>
<div style="position:absolute;left:239.98px;top:560.67px" class="cls_006"><span class="cls_006">addressing (i.e. use </span><span class="cls_041">-G 0</span><span class="cls_006">).</span></div>
<div style="position:absolute;left:228.02px;top:574.67px" class="cls_006"><span class="cls_006">• Some real-time operating systems, and many PROM monitors, can be</span></div>
<div style="position:absolute;left:239.97px;top:585.67px" class="cls_006"><span class="cls_006">entered by direct subroutine calls, rather then via a single ‘‘system</span></div>
<div style="position:absolute;left:239.97px;top:596.67px" class="cls_006"><span class="cls_006">call’’ interface. This makes it impossible (or at least very difficult) to</span></div>
<div style="position:absolute;left:239.97px;top:607.67px" class="cls_006"><span class="cls_006">switch back and forth between the two different values of </span><span class="cls_008">gp</span><span class="cls_006"> that will</span></div>
<div style="position:absolute;left:239.98px;top:618.67px" class="cls_006"><span class="cls_006">be used by the application, and by the o/s or monitor. In this case</span></div>
<div style="position:absolute;left:239.98px;top:629.67px" class="cls_006"><span class="cls_006">either the applications or the o/s (but not necessarily both) must be</span></div>
<div style="position:absolute;left:239.98px;top:640.67px" class="cls_006"><span class="cls_006">built with </span><span class="cls_041">-G 0</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:228.02px;top:654.67px" class="cls_006"><span class="cls_006">• When the </span><span class="cls_041">-G 0</span><span class="cls_006"> option has been used for compilation of any set of</span></div>
<div style="position:absolute;left:239.97px;top:665.67px" class="cls_006"><span class="cls_006">modules, then it is usually essential that all libraries should also be</span></div>
<div style="position:absolute;left:239.97px;top:676.67px" class="cls_006"><span class="cls_006">compiled that way, to avoid relocation errors.</span></div>
<div style="position:absolute;left:234.00px;top:710.67px" class="cls_006"><span class="cls_006">† The actual handling may be toolchain dependent; this is the</span></div>
<div style="position:absolute;left:234.00px;top:722.67px" class="cls_006"><span class="cls_006">most common technique.</span></div>
<div style="position:absolute;left:305.78px;top:755.34px" class="cls_002"><span class="cls_002">9–7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:92230px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:376.95px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:36.00px;top:50.00px" class="cls_015"><span class="cls_015">JUMPS, SUBROUTINE CALLS AND BRANCHES</span></div>
<div style="position:absolute;left:48.02px;top:63.67px" class="cls_006"><span class="cls_006">The MIPS architecture follows Motorola nomenclature:</span></div>
<div style="position:absolute;left:48.02px;top:77.67px" class="cls_006"><span class="cls_006">• PC-relative instructions are called ‘‘branch’’, and absolute-addressed</span></div>
<div style="position:absolute;left:59.97px;top:88.67px" class="cls_006"><span class="cls_006">instructions ‘‘jump’’; the operation mnemonics begin with a b or j.</span></div>
<div style="position:absolute;left:48.01px;top:102.67px" class="cls_006"><span class="cls_006">• A subroutine call is ‘‘jump and link’’ or ‘‘branch and link’’, and the</span></div>
<div style="position:absolute;left:59.96px;top:113.67px" class="cls_006"><span class="cls_006">mnemonics end ..al.</span></div>
<div style="position:absolute;left:48.02px;top:127.67px" class="cls_006"><span class="cls_006">• All the branch instructions, even branch-and-link, are conditional,</span></div>
<div style="position:absolute;left:59.97px;top:138.67px" class="cls_006"><span class="cls_006">testing one or two registers. They are therefore described in the next</span></div>
<div style="position:absolute;left:59.97px;top:149.67px" class="cls_006"><span class="cls_006">section. However, unconditional versions can be readily synthesized,</span></div>
<div style="position:absolute;left:59.97px;top:160.67px" class="cls_006"><span class="cls_006">e.g.: beq $0, $0, label.</span></div>
<div style="position:absolute;left:48.02px;top:171.67px" class="cls_006"><span class="cls_006">Jump instructions are:</span></div>
<div style="position:absolute;left:48.02px;top:185.67px" class="cls_006"><span class="cls_006">• j: this instruction</span></div>
<div style="position:absolute;left:158.34px;top:185.67px" class="cls_006"><span class="cls_006">(</span><span class="cls_008">jump</span><span class="cls_006">) transfers control unconditionally to an</span></div>
<div style="position:absolute;left:59.97px;top:196.67px" class="cls_006"><span class="cls_006">absolute address. Actually, j doesn’t quite manage a 32-bit address;</span></div>
<div style="position:absolute;left:59.97px;top:207.67px" class="cls_006"><span class="cls_006">the top 4 address bits of the target are not defined by the instruction</span></div>
<div style="position:absolute;left:59.97px;top:218.67px" class="cls_006"><span class="cls_006">and the top 4 bits of the current ‘‘PC’’ value is used instead.</span></div>
<div style="position:absolute;left:59.97px;top:232.67px" class="cls_006"><span class="cls_006">Most of the time this doesn’t matter: 28-bits still gives a maximum</span></div>
<div style="position:absolute;left:59.97px;top:243.67px" class="cls_006"><span class="cls_006">code size of 256 Mb. It can be argued that it is useful in system</span></div>
<div style="position:absolute;left:59.97px;top:254.67px" class="cls_006"><span class="cls_006">software, because it avoids changing the top 3 address bits which</span></div>
<div style="position:absolute;left:59.97px;top:265.67px" class="cls_006"><span class="cls_006">select the address segment (described earlier in this manual).</span></div>
<div style="position:absolute;left:59.97px;top:279.67px" class="cls_006"><span class="cls_006">To  reach  a  really  long  way  away,  use  the jr</span></div>
<div style="position:absolute;left:308.56px;top:279.67px" class="cls_006"><span class="cls_006">(</span><span class="cls_008">jump to register</span><span class="cls_006">)</span></div>
<div style="position:absolute;left:59.98px;top:290.67px" class="cls_006"><span class="cls_006">instruction; which is also used for computed jumps.</span></div>
<div style="position:absolute;left:48.03px;top:304.67px" class="cls_006"><span class="cls_006">• jal,   jalr:   these   instructions   implement   a   direct   and   indirect</span></div>
<div style="position:absolute;left:59.98px;top:315.67px" class="cls_006"><span class="cls_006">subroutine call. As well as jumping to the specified address, they</span></div>
<div style="position:absolute;left:59.98px;top:326.67px" class="cls_006"><span class="cls_006">store the current </span><span class="cls_008">pc</span><span class="cls_006"> + 8 in register </span><span class="cls_008">$31</span><span class="cls_006"> (</span><span class="cls_008">ra</span><span class="cls_006">). Why add 8 to the program</span></div>
<div style="position:absolute;left:59.99px;top:337.67px" class="cls_006"><span class="cls_006">counter? Remember that jump instructions, like branches, always</span></div>
<div style="position:absolute;left:59.99px;top:348.67px" class="cls_006"><span class="cls_006">execute the following instruction (at </span><span class="cls_008">pc</span><span class="cls_006"> + 4), so the return address is</span></div>
<div style="position:absolute;left:59.99px;top:359.67px" class="cls_006"><span class="cls_006">the instruction </span><span class="cls_008">after</span><span class="cls_006"> the branch delay slot. Subroutine return is</span></div>
<div style="position:absolute;left:59.99px;top:370.67px" class="cls_006"><span class="cls_006">normally done with jr $31.</span></div>
<div style="position:absolute;left:59.99px;top:384.67px" class="cls_006"><span class="cls_006">Position independent subroutine calls can use the bal, bgezal and</span></div>
<div style="position:absolute;left:60.00px;top:395.67px" class="cls_006"><span class="cls_006">bltzal instructions.</span></div>
<div style="position:absolute;left:36.00px;top:418.00px" class="cls_015"><span class="cls_015">CONDITIONAL BRANCHES</span></div>
<div style="position:absolute;left:48.02px;top:431.67px" class="cls_006"><span class="cls_006">The MIPS architecture does not include a condition code register.</span></div>
<div style="position:absolute;left:36.00px;top:442.67px" class="cls_006"><span class="cls_006">Conditional branch machine instructions test one or two registers; and,</span></div>
<div style="position:absolute;left:36.00px;top:453.67px" class="cls_006"><span class="cls_006">together with a small group of compare-and-set instructions, are used to</span></div>
<div style="position:absolute;left:36.00px;top:464.67px" class="cls_006"><span class="cls_006">synthesize a complete set of arithmetic conditional branches.</span></div>
<div style="position:absolute;left:48.02px;top:475.67px" class="cls_006"><span class="cls_006">Conditional branches are always PC-relative.</span></div>
<div style="position:absolute;left:48.02px;top:486.67px" class="cls_006"><span class="cls_006">Branch instructions are listed below. Again there are architectural</span></div>
<div style="position:absolute;left:36.00px;top:497.67px" class="cls_006"><span class="cls_006">considerations:</span></div>
<div style="position:absolute;left:48.02px;top:511.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Limited branch offset for PC-relative branches</span><span class="cls_006">: the maximum branch</span></div>
<div style="position:absolute;left:59.97px;top:522.67px" class="cls_006"><span class="cls_006">displacement is </span><span class="cls_003">±</span><span class="cls_006">32768 instructions (</span><span class="cls_003">±</span><span class="cls_006">128K bytes), because a 16-bit</span></div>
<div style="position:absolute;left:59.98px;top:533.67px" class="cls_006"><span class="cls_006">field is used for the offset.</span></div>
<div style="position:absolute;left:48.03px;top:547.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Branch delay slot</span><span class="cls_006">: the instruction immediately after a branch (or a</span></div>
<div style="position:absolute;left:59.98px;top:558.67px" class="cls_006"><span class="cls_006">jump) is always executed, whether or not the branch is taken. Many</span></div>
<div style="position:absolute;left:59.98px;top:569.67px" class="cls_006"><span class="cls_006">assemblers will normally hide this from the programmer, and will try</span></div>
<div style="position:absolute;left:59.98px;top:580.67px" class="cls_006"><span class="cls_006">to fill the branch delay slot with a useful instruction, or a nop if this</span></div>
<div style="position:absolute;left:59.98px;top:591.67px" class="cls_006"><span class="cls_006">is not possible.</span></div>
<div style="position:absolute;left:48.03px;top:605.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> No carry flag</span><span class="cls_006">: due to the lack of condition codes; if software need to</span></div>
<div style="position:absolute;left:59.98px;top:616.67px" class="cls_006"><span class="cls_006">check for carry, then compare the operands and results to work out</span></div>
<div style="position:absolute;left:59.98px;top:627.67px" class="cls_006"><span class="cls_006">when it occurs (typically, this requires only one slt instruction).</span></div>
<div style="position:absolute;left:48.03px;top:641.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> No overflow flag</span><span class="cls_006">: though the add and subtract instructions are</span></div>
<div style="position:absolute;left:59.98px;top:652.67px" class="cls_006"><span class="cls_006">available in an optional form which causes a trap if the result</span></div>
<div style="position:absolute;left:59.98px;top:663.67px" class="cls_006"><span class="cls_006">overflows into the sign bit. C compilers typically won’t generate those</span></div>
<div style="position:absolute;left:59.98px;top:674.67px" class="cls_006"><span class="cls_006">instructions, but Fortran might.</span></div>
<div style="position:absolute;left:292.03px;top:755.34px" class="cls_002"><span class="cls_002">9–8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:93032px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:525.20px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:216.00px;top:50.00px" class="cls_015"><span class="cls_015">Co-processor conditional branches</span></div>
<div style="position:absolute;left:228.02px;top:63.67px" class="cls_006"><span class="cls_006">There are four pairs of branches, testing true/false on four ‘‘coprocessor</span></div>
<div style="position:absolute;left:216.00px;top:74.67px" class="cls_006"><span class="cls_006">condition’’ values CPCOND0-3. In the R3081, CPCOND1 is an internal flag</span></div>
<div style="position:absolute;left:216.00px;top:85.67px" class="cls_006"><span class="cls_006">which tests the floating point condition set by the FP compare instructions.</span></div>
<div style="position:absolute;left:216.00px;top:96.67px" class="cls_006"><span class="cls_006">Note that the coprocessor must be enabled for the branch instruction to be</span></div>
<div style="position:absolute;left:216.00px;top:107.67px" class="cls_006"><span class="cls_006">executed.</span></div>
<div style="position:absolute;left:216.00px;top:130.00px" class="cls_015"><span class="cls_015">COMPARE AND SET</span></div>
<div style="position:absolute;left:228.02px;top:143.67px" class="cls_006"><span class="cls_006">The compare-and-set instructions conform to the C standard; they set</span></div>
<div style="position:absolute;left:216.00px;top:154.67px" class="cls_006"><span class="cls_006">their destination to 1 if the condition is true, and zero otherwise. Their</span></div>
<div style="position:absolute;left:216.00px;top:165.67px" class="cls_006"><span class="cls_006">mnemonics start with an ‘‘s’’: so seq rd, rs, rt sets rd to a 1 or zero</span></div>
<div style="position:absolute;left:216.00px;top:176.67px" class="cls_006"><span class="cls_006">depending on whether rs is equal to rt. These instructions operate just like</span></div>
<div style="position:absolute;left:216.01px;top:187.67px" class="cls_006"><span class="cls_006">any 3-operand MIPS instruction.</span></div>
<div style="position:absolute;left:228.03px;top:198.67px" class="cls_006"><span class="cls_006">Floating point comparisons are done quite differently, and are described</span></div>
<div style="position:absolute;left:216.01px;top:209.67px" class="cls_006"><span class="cls_006">in the Floating-Point Accelerator chapter.</span></div>
<div style="position:absolute;left:216.00px;top:232.00px" class="cls_015"><span class="cls_015">COPROCESSOR TRANSFERS</span></div>
<div style="position:absolute;left:228.02px;top:245.67px" class="cls_006"><span class="cls_006">CPU control functions are provided by a set of registers, which the</span></div>
<div style="position:absolute;left:216.00px;top:256.67px" class="cls_006"><span class="cls_006">instruction set accesses as ‘‘co-processor 0’’ data registers. These registers</span></div>
<div style="position:absolute;left:216.00px;top:267.67px" class="cls_006"><span class="cls_006">deal with catching exceptions and interrupts, and accessing the memory</span></div>
<div style="position:absolute;left:216.00px;top:278.67px" class="cls_006"><span class="cls_006">management unit and caches. A R3051 family CPU has at least 12</span></div>
<div style="position:absolute;left:216.00px;top:289.67px" class="cls_006"><span class="cls_006">registers; some have more. There’s much more about this in earlier</span></div>
<div style="position:absolute;left:216.00px;top:300.67px" class="cls_006"><span class="cls_006">chapters.</span></div>
<div style="position:absolute;left:228.02px;top:311.67px" class="cls_006"><span class="cls_006">The floating point accelerator is ‘‘co-processor 1’’, and is described in an</span></div>
<div style="position:absolute;left:216.00px;top:322.67px" class="cls_006"><span class="cls_006">earlier chapter. It has</span></div>
<div style="position:absolute;left:337.68px;top:322.67px" class="cls_006"><span class="cls_006">16 64-bit registers to hold single- or double-</span></div>
<div style="position:absolute;left:216.00px;top:333.67px" class="cls_006"><span class="cls_006">precision FP values, which come apart into 32 32-bit registers when doing</span></div>
<div style="position:absolute;left:216.00px;top:344.67px" class="cls_006"><span class="cls_006">loads, stores and transfers to/from the integer registers. There are also two</span></div>
<div style="position:absolute;left:216.00px;top:355.67px" class="cls_006"><span class="cls_006">floating point control registers accessed with ctc1, cfc1 instructions.</span></div>
<div style="position:absolute;left:228.02px;top:366.67px" class="cls_006"><span class="cls_006">‘‘Co-processor’’ instructions are encoded in a standard way, and the</span></div>
<div style="position:absolute;left:216.00px;top:377.67px" class="cls_006"><span class="cls_006">assembler doesn’t have to know much about what they do.</span></div>
<div style="position:absolute;left:228.02px;top:388.67px" class="cls_006"><span class="cls_006">There are a range of instructions for moving data to and from the</span></div>
<div style="position:absolute;left:216.00px;top:399.67px" class="cls_006"><span class="cls_006">coprocessor data and control registers. The assembler expects numbers</span></div>
<div style="position:absolute;left:216.00px;top:410.67px" class="cls_006"><span class="cls_006">specified with ‘‘$’’ in front (except for floating point registers, which are</span></div>
<div style="position:absolute;left:216.00px;top:421.67px" class="cls_006"><span class="cls_006">called $f0 to $f31); but most toolchains provide a header file for the C pre-</span></div>
<div style="position:absolute;left:216.00px;top:432.67px" class="cls_006"><span class="cls_006">processor which provides meaningful names for the CPU control and FP</span></div>
<div style="position:absolute;left:216.00px;top:443.67px" class="cls_006"><span class="cls_006">control registers.</span></div>
<div style="position:absolute;left:228.02px;top:454.67px" class="cls_006"><span class="cls_006">The assembler syntax makes no special provisions for ‘‘co-processor’’</span></div>
<div style="position:absolute;left:216.00px;top:465.67px" class="cls_006"><span class="cls_006">registers; so if the program contains “obvious” mistakes (like reversing the</span></div>
<div style="position:absolute;left:216.00px;top:476.67px" class="cls_006"><span class="cls_006">CPU and special register names) the assembler will just silently do the</span></div>
<div style="position:absolute;left:216.00px;top:487.67px" class="cls_006"><span class="cls_006">wrong thing.</span></div>
<div style="position:absolute;left:237.58px;top:508.00px" class="cls_020"><span class="cls_020">Instruction</span></div>
<div style="position:absolute;left:329.48px;top:508.00px" class="cls_020"><span class="cls_020">Description</span></div>
<div style="position:absolute;left:237.58px;top:525.00px" class="cls_020"><span class="cls_020">mfc0 dst, dr</span></div>
<div style="position:absolute;left:329.44px;top:525.00px" class="cls_020"><span class="cls_020">move from CPU control register (to integer register)</span></div>
<div style="position:absolute;left:237.58px;top:542.00px" class="cls_020"><span class="cls_020">mtc0 src, dr</span></div>
<div style="position:absolute;left:329.44px;top:542.00px" class="cls_020"><span class="cls_020">move to CPU control register (from integer register)</span></div>
<div style="position:absolute;left:237.58px;top:559.00px" class="cls_020"><span class="cls_020">cfc1 dst, cr</span></div>
<div style="position:absolute;left:329.49px;top:559.00px" class="cls_020"><span class="cls_020">move from fpa control register (to integer register)</span></div>
<div style="position:absolute;left:237.58px;top:576.00px" class="cls_020"><span class="cls_020">ctc1 src, cr</span></div>
<div style="position:absolute;left:329.49px;top:576.00px" class="cls_020"><span class="cls_020">move to fpa control register (from integer register)</span></div>
<div style="position:absolute;left:237.58px;top:593.00px" class="cls_020"><span class="cls_020">mfc1 dst, dr</span></div>
<div style="position:absolute;left:329.50px;top:593.00px" class="cls_020"><span class="cls_020">move from FP register to integer register</span></div>
<div style="position:absolute;left:237.58px;top:610.01px" class="cls_020"><span class="cls_020">mtc1 src, dr</span></div>
<div style="position:absolute;left:329.50px;top:610.01px" class="cls_020"><span class="cls_020">move to FP register from integer register</span></div>
<div style="position:absolute;left:237.58px;top:627.01px" class="cls_020"><span class="cls_020">swc1 dr, offs(base)</span></div>
<div style="position:absolute;left:329.63px;top:627.01px" class="cls_020"><span class="cls_020">store FP register (to memory)</span></div>
<div style="position:absolute;left:237.58px;top:644.01px" class="cls_020"><span class="cls_020">lwc1 dr, offs(base)</span></div>
<div style="position:absolute;left:329.62px;top:644.01px" class="cls_020"><span class="cls_020">load FP register (from memory)</span></div>
<div style="position:absolute;left:228.02px;top:663.67px" class="cls_006"><span class="cls_006">Like  conventional  load  instructions,  there  must  always  be  one</span></div>
<div style="position:absolute;left:216.00px;top:674.67px" class="cls_006"><span class="cls_006">instruction after the move before the result can be used (the load-delay</span></div>
<div style="position:absolute;left:216.00px;top:685.67px" class="cls_006"><span class="cls_006">slot), whichever direction data is being moved.</span></div>
<div style="position:absolute;left:305.78px;top:755.34px" class="cls_002"><span class="cls_002">9–9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:93834px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:376.95px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:36.00px;top:50.00px" class="cls_015"><span class="cls_015">Coprocessor Hazards</span></div>
<div style="position:absolute;left:48.02px;top:63.67px" class="cls_006"><span class="cls_006">A pipeline hazard occurs when the architecture definition allows the</span></div>
<div style="position:absolute;left:36.00px;top:74.67px" class="cls_006"><span class="cls_006">internal pipelining to ‘‘show through’’ and affect the software: examples</span></div>
<div style="position:absolute;left:36.00px;top:85.67px" class="cls_006"><span class="cls_006">being the load and branch delay slots. Most MIPS assemblers will usually</span></div>
<div style="position:absolute;left:36.00px;top:96.67px" class="cls_006"><span class="cls_006">shield the programmer from hazards by moving instructions around or</span></div>
<div style="position:absolute;left:36.00px;top:107.67px" class="cls_006"><span class="cls_006">inserting NOP’s, to ensure that the code executes as written.</span></div>
<div style="position:absolute;left:48.02px;top:118.67px" class="cls_006"><span class="cls_006">However some CPU control register writes have side-effects which</span></div>
<div style="position:absolute;left:36.00px;top:129.67px" class="cls_006"><span class="cls_006">require   pipeline-aware   programming;   since   most   assemblers   don’t</span></div>
<div style="position:absolute;left:36.00px;top:140.67px" class="cls_006"><span class="cls_006">understand anything about what these instructions are doing, they may</span></div>
<div style="position:absolute;left:36.00px;top:151.67px" class="cls_006"><span class="cls_006">not help.</span></div>
<div style="position:absolute;left:48.02px;top:162.67px" class="cls_006"><span class="cls_006">One outstanding example is the use of interrupt control fields in the</span></div>
<div style="position:absolute;left:36.00px;top:173.67px" class="cls_008"><span class="cls_008">Status</span><span class="cls_006"> and </span><span class="cls_008">Cause</span><span class="cls_006"> registers. In these cases the programmer must account</span></div>
<div style="position:absolute;left:35.99px;top:184.67px" class="cls_006"><span class="cls_006">for any side-effects, and the fact that they are delayed for up to three</span></div>
<div style="position:absolute;left:35.99px;top:195.67px" class="cls_006"><span class="cls_006">instructions. For example, after an mtc0 to the </span><span class="cls_008">Status</span><span class="cls_006"> register which</span></div>
<div style="position:absolute;left:36.00px;top:206.67px" class="cls_006"><span class="cls_006">changes an interrupt mask bit, it will be two further instructions before the</span></div>
<div style="position:absolute;left:36.00px;top:217.67px" class="cls_006"><span class="cls_006">interrupt is actually enabled or disabled. The same is also true when</span></div>
<div style="position:absolute;left:36.00px;top:228.67px" class="cls_006"><span class="cls_006">enabling or disabling floating-point coprocessor instructions (i.e. changing</span></div>
<div style="position:absolute;left:36.00px;top:239.67px" class="cls_006"><span class="cls_006">the CU1 bit).</span></div>
<div style="position:absolute;left:48.02px;top:250.67px" class="cls_006"><span class="cls_006">To cope with these situations usually requires the programmer to take</span></div>
<div style="position:absolute;left:36.00px;top:261.67px" class="cls_006"><span class="cls_006">explicit action to prevent the assembler from scheduling inappropriate</span></div>
<div style="position:absolute;left:36.00px;top:272.67px" class="cls_006"><span class="cls_006">instructions after a dangerous mtc0. This is done by using the .set</span></div>
<div style="position:absolute;left:36.00px;top:283.67px" class="cls_006"><span class="cls_006">noreorder directive, discussed below.</span></div>
<div style="position:absolute;left:48.02px;top:294.67px" class="cls_006"><span class="cls_006">A comprehensive summary of pipeline hazards can be found later in this</span></div>
<div style="position:absolute;left:36.00px;top:305.67px" class="cls_006"><span class="cls_006">chapter.</span></div>
<div style="position:absolute;left:36.00px;top:328.00px" class="cls_015"><span class="cls_015">ASSEMBLER DIRECTIVES</span></div>
<div style="position:absolute;left:36.00px;top:353.00px" class="cls_015"><span class="cls_015">Sections</span></div>
<div style="position:absolute;left:48.02px;top:366.67px" class="cls_006"><span class="cls_006">The names of, and support for different code and data sections is likely</span></div>
<div style="position:absolute;left:36.00px;top:377.67px" class="cls_006"><span class="cls_006">to differ from one toolchain to another. Most will at least support the</span></div>
<div style="position:absolute;left:36.00px;top:388.67px" class="cls_006"><span class="cls_006">original MIPS conventions, which are illustrated (for ROMable programs)</span></div>
<div style="position:absolute;left:36.00px;top:399.67px" class="cls_006"><span class="cls_006">by Figure 9.1, “Program segments in memory”.</span></div>
<div style="position:absolute;left:48.02px;top:410.67px" class="cls_006"><span class="cls_006">Within an assembler program the sections are selected as shown in</span></div>
<div style="position:absolute;left:36.00px;top:421.67px" class="cls_006"><span class="cls_006">Figure 9.1, “Program segments in memory”.</span></div>
<div style="position:absolute;left:36.00px;top:442.67px" class="cls_006"><span class="cls_006">.text, .rdata, .data</span></div>
<div style="position:absolute;left:48.02px;top:453.67px" class="cls_006"><span class="cls_006">Simply put the appropriate section name before the data or instructions,</span></div>
<div style="position:absolute;left:36.00px;top:464.67px" class="cls_006"><span class="cls_006">for example:</span></div>
<div style="position:absolute;left:108.00px;top:486.00px" class="cls_028"><span class="cls_028">.rdata</span></div>
<div style="position:absolute;left:72.00px;top:496.00px" class="cls_028"><span class="cls_028">msg:</span></div>
<div style="position:absolute;left:108.09px;top:496.00px" class="cls_028"><span class="cls_028">.asciiz"Hello world!\n"</span></div>
<div style="position:absolute;left:108.00px;top:516.00px" class="cls_028"><span class="cls_028">.data</span></div>
<div style="position:absolute;left:72.00px;top:526.00px" class="cls_028"><span class="cls_028">table: .word</span></div>
<div style="position:absolute;left:144.25px;top:526.00px" class="cls_028"><span class="cls_028">1</span></div>
<div style="position:absolute;left:108.00px;top:535.99px" class="cls_028"><span class="cls_028">.word</span></div>
<div style="position:absolute;left:144.11px;top:535.99px" class="cls_028"><span class="cls_028">2</span></div>
<div style="position:absolute;left:108.00px;top:545.99px" class="cls_028"><span class="cls_028">.word</span></div>
<div style="position:absolute;left:144.11px;top:545.99px" class="cls_028"><span class="cls_028">3</span></div>
<div style="position:absolute;left:108.00px;top:565.99px" class="cls_028"><span class="cls_028">.text</span></div>
<div style="position:absolute;left:72.00px;top:575.99px" class="cls_028"><span class="cls_028">func:  sub</span></div>
<div style="position:absolute;left:144.18px;top:575.99px" class="cls_028"><span class="cls_028">sp, 64</span></div>
<div style="position:absolute;left:36.00px;top:615.67px" class="cls_006"><span class="cls_006">.lit4, .lit8</span></div>
<div style="position:absolute;left:48.02px;top:626.67px" class="cls_006"><span class="cls_006">These sections cannot be selected explicitly by the programmer. They</span></div>
<div style="position:absolute;left:36.00px;top:637.67px" class="cls_006"><span class="cls_006">are read-only data sections used implicitly by the assembler to hold</span></div>
<div style="position:absolute;left:36.00px;top:648.67px" class="cls_006"><span class="cls_006">floating-point constants which are given as arguments to the li.s or li.d</span></div>
<div style="position:absolute;left:36.00px;top:659.67px" class="cls_006"><span class="cls_006">macro instructions. Some assemblers and linkers will save space by</span></div>
<div style="position:absolute;left:36.00px;top:670.67px" class="cls_006"><span class="cls_006">combining identical constants.</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">9–10</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:94636px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:525.20px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:322.30px;top:55.00px" class="cls_020"><span class="cls_020">ROM</span></div>
<div style="position:absolute;left:488.48px;top:75.00px" class="cls_020"><span class="cls_020">etext</span></div>
<div style="position:absolute;left:322.30px;top:95.00px" class="cls_020"><span class="cls_020">.rdata</span></div>
<div style="position:absolute;left:322.30px;top:112.00px" class="cls_027"><span class="cls_027">read-only data</span></div>
<div style="position:absolute;left:322.30px;top:149.00px" class="cls_020"><span class="cls_020">.text</span></div>
<div style="position:absolute;left:265.77px;top:166.00px" class="cls_020"><span class="cls_020">1fc0000</span></div>
<div style="position:absolute;left:322.30px;top:166.00px" class="cls_027"><span class="cls_027">program code</span></div>
<div style="position:absolute;left:488.49px;top:166.00px" class="cls_020"><span class="cls_020">_ftext</span></div>
<div style="position:absolute;left:322.30px;top:203.00px" class="cls_020"><span class="cls_020">RAM</span></div>
<div style="position:absolute;left:265.77px;top:242.99px" class="cls_020"><span class="cls_020">????????</span></div>
<div style="position:absolute;left:322.30px;top:262.99px" class="cls_027"><span class="cls_027">stack</span></div>
<div style="position:absolute;left:322.30px;top:279.99px" class="cls_027"><span class="cls_027">grows down from top of memory</span></div>
<div style="position:absolute;left:322.30px;top:296.99px" class="cls_027"><span class="cls_027">heap</span></div>
<div style="position:absolute;left:322.30px;top:313.99px" class="cls_027"><span class="cls_027">grows up towards stack</span></div>
<div style="position:absolute;left:488.48px;top:330.99px" class="cls_020"><span class="cls_020">end</span></div>
<div style="position:absolute;left:322.30px;top:350.99px" class="cls_020"><span class="cls_020">.bss</span></div>
<div style="position:absolute;left:322.30px;top:367.99px" class="cls_027"><span class="cls_027">uninitialized writable data</span></div>
<div style="position:absolute;left:322.30px;top:384.99px" class="cls_020"><span class="cls_020">.sbss</span></div>
<div style="position:absolute;left:322.30px;top:401.99px" class="cls_027"><span class="cls_027">uninitialized writable small data</span></div>
<div style="position:absolute;left:488.50px;top:401.99px" class="cls_020"><span class="cls_020">_fbss</span></div>
<div style="position:absolute;left:488.48px;top:419.00px" class="cls_020"><span class="cls_020">edata</span></div>
<div style="position:absolute;left:322.30px;top:438.99px" class="cls_020"><span class="cls_020">.lit8</span></div>
<div style="position:absolute;left:322.30px;top:455.99px" class="cls_027"><span class="cls_027">64-bit floating point constants</span></div>
<div style="position:absolute;left:322.30px;top:492.99px" class="cls_020"><span class="cls_020">.lit4</span></div>
<div style="position:absolute;left:322.30px;top:509.99px" class="cls_027"><span class="cls_027">32-bit floating point constants</span></div>
<div style="position:absolute;left:322.30px;top:546.99px" class="cls_020"><span class="cls_020">.sdata</span></div>
<div style="position:absolute;left:322.30px;top:563.99px" class="cls_027"><span class="cls_027">writable small data</span></div>
<div style="position:absolute;left:322.30px;top:600.99px" class="cls_020"><span class="cls_020">.data</span></div>
<div style="position:absolute;left:265.77px;top:617.99px" class="cls_020"><span class="cls_020">00000200</span></div>
<div style="position:absolute;left:322.30px;top:617.99px" class="cls_027"><span class="cls_027">writable data</span></div>
<div style="position:absolute;left:488.49px;top:617.99px" class="cls_020"><span class="cls_020">_fdata</span></div>
<div style="position:absolute;left:322.30px;top:654.99px" class="cls_027"><span class="cls_027">exception vectors</span></div>
<div style="position:absolute;left:265.76px;top:671.99px" class="cls_020"><span class="cls_020">00000000</span></div>
<div style="position:absolute;left:299.17px;top:693.99px" class="cls_020"><span class="cls_020">Figure 9.1: Program segments in memory</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">9–11</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:95438px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:376.95px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:36.00px;top:50.67px" class="cls_006"><span class="cls_006">.bss</span></div>
<div style="position:absolute;left:48.02px;top:61.67px" class="cls_006"><span class="cls_006">This section is used to collect </span><span class="cls_008">uninitialized</span><span class="cls_006"> data, the equivalent of C and</span></div>
<div style="position:absolute;left:36.00px;top:72.67px" class="cls_006"><span class="cls_006">Fortran’s </span><span class="cls_008">common</span><span class="cls_006"> data. An uninitialized object is declared, together with</span></div>
<div style="position:absolute;left:36.00px;top:83.67px" class="cls_006"><span class="cls_006">its size. The linker then allocates space for it in the .bss section, using the</span></div>
<div style="position:absolute;left:35.99px;top:94.67px" class="cls_006"><span class="cls_006">maximum size from all those modules which declare it. If any module</span></div>
<div style="position:absolute;left:35.99px;top:105.67px" class="cls_006"><span class="cls_006">declares it in a real, </span><span class="cls_008">initialized</span><span class="cls_006"> data section, then all the sizes are ignored</span></div>
<div style="position:absolute;left:35.99px;top:116.67px" class="cls_006"><span class="cls_006">and that definition is used.</span></div>
<div style="position:absolute;left:72.00px;top:138.00px" class="cls_028"><span class="cls_028">.comm  dbgflag, 4</span></div>
<div style="position:absolute;left:180.35px;top:138.00px" class="cls_028"><span class="cls_028"># global common variable, 4 bytes</span></div>
<div style="position:absolute;left:72.00px;top:148.00px" class="cls_028"><span class="cls_028">.lcomm sum, 4</span></div>
<div style="position:absolute;left:180.30px;top:148.00px" class="cls_028"><span class="cls_028"># local common variable, 8 bytes</span></div>
<div style="position:absolute;left:72.00px;top:158.00px" class="cls_028"><span class="cls_028">.lcomm array, 100</span></div>
<div style="position:absolute;left:180.39px;top:158.00px" class="cls_028"><span class="cls_028"># local common variable, 100 bytes</span></div>
<div style="position:absolute;left:48.02px;top:177.67px" class="cls_006"><span class="cls_006">“Uninitialized” is actually a misnomer: although these sections occupy</span></div>
<div style="position:absolute;left:36.00px;top:188.67px" class="cls_006"><span class="cls_006">no space in the object file, the run-time start-up code or operating-system</span></div>
<div style="position:absolute;left:36.00px;top:199.67px" class="cls_006"><span class="cls_006">must clear the .bss area to zero before entering the program; most C</span></div>
<div style="position:absolute;left:36.00px;top:210.67px" class="cls_006"><span class="cls_006">programs will rely on this behavior. Many tool chains will accommodate</span></div>
<div style="position:absolute;left:36.00px;top:221.67px" class="cls_006"><span class="cls_006">this need through the start up file provided with the tool, to be linked with</span></div>
<div style="position:absolute;left:36.00px;top:232.67px" class="cls_006"><span class="cls_006">the user program†.</span></div>
<div style="position:absolute;left:36.00px;top:253.67px" class="cls_006"><span class="cls_006">.sdata, .sbss</span></div>
<div style="position:absolute;left:48.02px;top:264.67px" class="cls_006"><span class="cls_006">These sections are equivalent to the .data and .bss sections above, but</span></div>
<div style="position:absolute;left:35.99px;top:275.67px" class="cls_006"><span class="cls_006">are  used  in  some  toolchains  to  hold </span><span class="cls_008">small</span><span class="cls_006">‡  data  objects.  This  was</span></div>
<div style="position:absolute;left:35.99px;top:286.67px" class="cls_006"><span class="cls_006">described earlier in this chapter, when the use of the </span><span class="cls_008">gp</span><span class="cls_006"> was discussed.</span></div>
<div style="position:absolute;left:35.99px;top:307.67px" class="cls_006"><span class="cls_006">Stack and heap</span></div>
<div style="position:absolute;left:48.01px;top:318.67px" class="cls_006"><span class="cls_006">The </span><span class="cls_008">stack</span><span class="cls_006"> and </span><span class="cls_008">heap</span><span class="cls_006"> are not real sections that are recognized by the</span></div>
<div style="position:absolute;left:35.97px;top:329.67px" class="cls_006"><span class="cls_006">assembler or linker. Typically they are initialized and maintained by the</span></div>
<div style="position:absolute;left:35.97px;top:340.67px" class="cls_006"><span class="cls_006">run-time system by setting the </span><span class="cls_008">sp</span><span class="cls_006"> register to the top of physical memory</span></div>
<div style="position:absolute;left:35.97px;top:351.67px" class="cls_006"><span class="cls_006">(aligned to an 8-byte boundary), and setting the initial </span><span class="cls_008">heap</span><span class="cls_006"> pointer (used</span></div>
<div style="position:absolute;left:35.96px;top:362.67px" class="cls_006"><span class="cls_006">by the </span><span class="cls_008">malloc</span><span class="cls_006"> functions) to the address of the end symbol.</span></div>
<div style="position:absolute;left:35.96px;top:383.67px" class="cls_006"><span class="cls_006">Special symbols</span></div>
<div style="position:absolute;left:47.98px;top:394.67px" class="cls_006"><span class="cls_006">Figure 9.1, “Program segments in memory” also shows a number of</span></div>
<div style="position:absolute;left:35.96px;top:405.67px" class="cls_006"><span class="cls_006">special symbols which are automatically defined by the linker to allow</span></div>
<div style="position:absolute;left:35.96px;top:416.67px" class="cls_006"><span class="cls_006">programs to discover the start and end of their various sections. Some of</span></div>
<div style="position:absolute;left:35.96px;top:427.67px" class="cls_006"><span class="cls_006">these are part of the normal UNIX†† environment expected by many</span></div>
<div style="position:absolute;left:35.96px;top:438.67px" class="cls_006"><span class="cls_006">programs; others are specific to the MIPS environment.</span></div>
<div style="position:absolute;left:57.34px;top:459.00px" class="cls_020"><span class="cls_020">Symbol</span></div>
<div style="position:absolute;left:100.00px;top:459.00px" class="cls_020"><span class="cls_020">Standard?</span></div>
<div style="position:absolute;left:156.30px;top:459.00px" class="cls_020"><span class="cls_020">Value</span></div>
<div style="position:absolute;left:57.34px;top:476.00px" class="cls_020"><span class="cls_020">_ftext</span></div>
<div style="position:absolute;left:156.06px;top:476.00px" class="cls_020"><span class="cls_020">start of text (code) segment</span></div>
<div style="position:absolute;left:57.34px;top:496.00px" class="cls_020"><span class="cls_020">etext</span></div>
<div style="position:absolute;left:99.86px;top:496.00px" class="cls_021"><span class="cls_021">✓</span></div>
<div style="position:absolute;left:155.96px;top:496.00px" class="cls_020"><span class="cls_020">end of text (code) segment</span></div>
<div style="position:absolute;left:57.35px;top:513.00px" class="cls_020"><span class="cls_020">_fdata</span></div>
<div style="position:absolute;left:156.08px;top:513.00px" class="cls_020"><span class="cls_020">start of initialized data segment</span></div>
<div style="position:absolute;left:57.35px;top:533.00px" class="cls_020"><span class="cls_020">edata</span></div>
<div style="position:absolute;left:99.87px;top:533.00px" class="cls_021"><span class="cls_021">✓</span></div>
<div style="position:absolute;left:155.97px;top:533.00px" class="cls_020"><span class="cls_020">end of initialized data segment</span></div>
<div style="position:absolute;left:57.36px;top:550.00px" class="cls_020"><span class="cls_020">_fbss</span></div>
<div style="position:absolute;left:156.07px;top:550.00px" class="cls_020"><span class="cls_020">start of uninitialized data segment</span></div>
<div style="position:absolute;left:57.36px;top:570.00px" class="cls_020"><span class="cls_020">end</span></div>
<div style="position:absolute;left:99.88px;top:570.00px" class="cls_021"><span class="cls_021">✓</span></div>
<div style="position:absolute;left:155.98px;top:570.00px" class="cls_020"><span class="cls_020">end of uninitialized data segment</span></div>
<div style="position:absolute;left:36.00px;top:595.00px" class="cls_015"><span class="cls_015">Data definition and alignment</span></div>
<div style="position:absolute;left:48.02px;top:608.67px" class="cls_006"><span class="cls_006">Having selected the correct section, the data objects themselves are</span></div>
<div style="position:absolute;left:36.00px;top:619.67px" class="cls_006"><span class="cls_006">specified using the directives described in this section.</span></div>
<div style="position:absolute;left:54.00px;top:686.67px" class="cls_006"><span class="cls_006">† IDT/c provides this code in the file “/idtc/idt_csu.S”.</span></div>
<div style="position:absolute;left:54.00px;top:698.67px" class="cls_006"><span class="cls_006">‡ The default for “small” is 8 bytes. This number can be changed</span></div>
<div style="position:absolute;left:54.00px;top:710.67px" class="cls_006"><span class="cls_006">with the “-G” compiler/assembler switch.</span></div>
<div style="position:absolute;left:54.00px;top:722.67px" class="cls_006"><span class="cls_006">†† UNIX is a trademark of Univel Inc.</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">9–12</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:96240px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:525.20px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:216.00px;top:50.67px" class="cls_006"><span class="cls_006">.byte, .half, .word</span></div>
<div style="position:absolute;left:228.02px;top:61.67px" class="cls_006"><span class="cls_006">These directives output integers which are</span></div>
<div style="position:absolute;left:458.64px;top:61.67px" class="cls_006"><span class="cls_006">1,</span></div>
<div style="position:absolute;left:474.61px;top:61.67px" class="cls_006"><span class="cls_006">2, or</span></div>
<div style="position:absolute;left:507.15px;top:61.67px" class="cls_006"><span class="cls_006">4 bytes long,</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_006"><span class="cls_006">respectively. A list of values may be given, separated by commas. Each</span></div>
<div style="position:absolute;left:216.00px;top:83.67px" class="cls_006"><span class="cls_006">value may be repeated a number of times by following it with a colon and</span></div>
<div style="position:absolute;left:216.00px;top:94.67px" class="cls_006"><span class="cls_006">a repeat count. For example.</span></div>
<div style="position:absolute;left:252.00px;top:116.00px" class="cls_028"><span class="cls_028">.byte</span></div>
<div style="position:absolute;left:288.11px;top:116.00px" class="cls_028"><span class="cls_028">3</span></div>
<div style="position:absolute;left:360.13px;top:116.00px" class="cls_028"><span class="cls_028"># 1 byte:3</span></div>
<div style="position:absolute;left:252.00px;top:126.00px" class="cls_028"><span class="cls_028">.half</span></div>
<div style="position:absolute;left:288.11px;top:126.00px" class="cls_028"><span class="cls_028">1, 2, 3</span></div>
<div style="position:absolute;left:360.27px;top:126.00px" class="cls_028"><span class="cls_028"># 3 halfwords:1 2 3</span></div>
<div style="position:absolute;left:252.00px;top:136.00px" class="cls_028"><span class="cls_028">.word</span></div>
<div style="position:absolute;left:288.11px;top:136.00px" class="cls_028"><span class="cls_028">5 : 3, 6, 7</span></div>
<div style="position:absolute;left:360.37px;top:136.00px" class="cls_028"><span class="cls_028"># 5 words:5 5 5 6 7</span></div>
<div style="position:absolute;left:228.02px;top:155.67px" class="cls_006"><span class="cls_006">Note that the section’s location counter is automatically aligned to the</span></div>
<div style="position:absolute;left:216.00px;top:166.67px" class="cls_006"><span class="cls_006">appropriate  boundary  before  the  data  is  emitted.  To  actually  emit</span></div>
<div style="position:absolute;left:216.00px;top:177.67px" class="cls_006"><span class="cls_006">unaligned data, explicit action must be taken using the .align directive</span></div>
<div style="position:absolute;left:215.99px;top:188.67px" class="cls_006"><span class="cls_006">described below.</span></div>
<div style="position:absolute;left:215.99px;top:209.67px" class="cls_006"><span class="cls_006">.float, .double</span></div>
<div style="position:absolute;left:228.01px;top:220.67px" class="cls_006"><span class="cls_006">These   output   single   or   double   precision   floating-point   values,</span></div>
<div style="position:absolute;left:215.99px;top:231.67px" class="cls_006"><span class="cls_006">respectively. Multiple values and repeat counts may be used in the same</span></div>
<div style="position:absolute;left:215.99px;top:242.67px" class="cls_006"><span class="cls_006">way as the integer directives.</span></div>
<div style="position:absolute;left:252.00px;top:264.00px" class="cls_028"><span class="cls_028">.float 1.4142175</span></div>
<div style="position:absolute;left:396.35px;top:264.00px" class="cls_028"><span class="cls_028"># 1 single-precision value</span></div>
<div style="position:absolute;left:252.00px;top:274.00px" class="cls_028"><span class="cls_028">.double1e+10, 3.1415</span></div>
<div style="position:absolute;left:396.47px;top:274.00px" class="cls_028"><span class="cls_028"># 2 double-precision values</span></div>
<div style="position:absolute;left:216.00px;top:303.67px" class="cls_006"><span class="cls_006">.ascii, .asciiz</span></div>
<div style="position:absolute;left:228.02px;top:314.67px" class="cls_006"><span class="cls_006">These  directives  output  ASCII  strings,  either  without  or  with  a</span></div>
<div style="position:absolute;left:216.00px;top:325.67px" class="cls_006"><span class="cls_006">terminating null character respectively. The following example outputs two</span></div>
<div style="position:absolute;left:216.00px;top:336.67px" class="cls_006"><span class="cls_006">identical strings:</span></div>
<div style="position:absolute;left:252.00px;top:358.00px" class="cls_028"><span class="cls_028">.ascii "Hello\0"</span></div>
<div style="position:absolute;left:252.00px;top:368.00px" class="cls_028"><span class="cls_028">.asciiz"Hello"</span></div>
<div style="position:absolute;left:216.00px;top:397.67px" class="cls_006"><span class="cls_006">.align</span></div>
<div style="position:absolute;left:228.02px;top:408.67px" class="cls_006"><span class="cls_006">This directive allows the programmer to specify an alignment greater</span></div>
<div style="position:absolute;left:216.00px;top:419.67px" class="cls_006"><span class="cls_006">than that which would normally be required for the next data directive. The</span></div>
<div style="position:absolute;left:216.00px;top:430.67px" class="cls_006"><span class="cls_006">alignment is specified as a power of two, for example:</span></div>
<div style="position:absolute;left:288.00px;top:454.27px" class="cls_028"><span class="cls_028">.align 4</span></div>
<div style="position:absolute;left:360.16px;top:452.46px" class="cls_028"><span class="cls_028"># align to 16-byte boundary (2</span><span class="cls_042"><sup>4</sup></span><span class="cls_028">)</span></div>
<div style="position:absolute;left:252.00px;top:464.27px" class="cls_028"><span class="cls_028">var:</span></div>
<div style="position:absolute;left:288.10px;top:464.27px" class="cls_028"><span class="cls_028">.word</span></div>
<div style="position:absolute;left:324.21px;top:464.27px" class="cls_028"><span class="cls_028">0</span></div>
<div style="position:absolute;left:228.02px;top:483.93px" class="cls_006"><span class="cls_006">If a label (</span><span class="cls_029">var</span><span class="cls_006"> in this case) comes immediately before the .align , then the</span></div>
<div style="position:absolute;left:216.00px;top:494.93px" class="cls_006"><span class="cls_006">label will still be aligned correctly. For example, the following is exactly</span></div>
<div style="position:absolute;left:216.00px;top:505.93px" class="cls_006"><span class="cls_006">equivalent to the above:</span></div>
<div style="position:absolute;left:252.00px;top:529.53px" class="cls_028"><span class="cls_028">var:</span></div>
<div style="position:absolute;left:288.09px;top:529.53px" class="cls_028"><span class="cls_028">.align 4</span></div>
<div style="position:absolute;left:360.25px;top:527.73px" class="cls_028"><span class="cls_028"># align to 16-byte boundary (2</span><span class="cls_042"><sup>4</sup></span><span class="cls_028">)</span></div>
<div style="position:absolute;left:288.00px;top:539.53px" class="cls_028"><span class="cls_028">.word</span></div>
<div style="position:absolute;left:324.12px;top:539.53px" class="cls_028"><span class="cls_028">0</span></div>
<div style="position:absolute;left:228.02px;top:559.20px" class="cls_006"><span class="cls_006">For ‘‘packed’’ data structures this directive allows the programmer to</span></div>
<div style="position:absolute;left:216.00px;top:570.20px" class="cls_006"><span class="cls_006">override the automatic alignment feature of .half, .word, etc., by specifying</span></div>
<div style="position:absolute;left:215.99px;top:581.20px" class="cls_006"><span class="cls_006">a zero alignment. This will stay in effect until the next section change. For</span></div>
<div style="position:absolute;left:215.99px;top:592.20px" class="cls_006"><span class="cls_006">example:</span></div>
<div style="position:absolute;left:252.00px;top:613.53px" class="cls_028"><span class="cls_028">.half</span></div>
<div style="position:absolute;left:288.11px;top:613.53px" class="cls_028"><span class="cls_028">3</span></div>
<div style="position:absolute;left:360.13px;top:613.53px" class="cls_028"><span class="cls_028"># correctly aligned halfword</span></div>
<div style="position:absolute;left:252.00px;top:623.53px" class="cls_028"><span class="cls_028">.align 0</span></div>
<div style="position:absolute;left:360.16px;top:623.53px" class="cls_028"><span class="cls_028"># switch off auto-alignment</span></div>
<div style="position:absolute;left:252.00px;top:633.53px" class="cls_028"><span class="cls_028">.word</span></div>
<div style="position:absolute;left:288.11px;top:633.53px" class="cls_028"><span class="cls_028">100</span></div>
<div style="position:absolute;left:360.18px;top:633.53px" class="cls_028"><span class="cls_028"># word aligned on halfword boundary</span></div>
<div style="position:absolute;left:216.00px;top:663.20px" class="cls_006"><span class="cls_006">.comm, .lcomm</span></div>
<div style="position:absolute;left:228.02px;top:674.20px" class="cls_006"><span class="cls_006">These directives declare a </span><span class="cls_008">common</span><span class="cls_006">, or </span><span class="cls_008">uninitialized</span><span class="cls_006"> data object by</span></div>
<div style="position:absolute;left:216.00px;top:685.20px" class="cls_006"><span class="cls_006">specifying the object’s name and size.</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">9–13</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:97042px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:376.95px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">An object declared with .comm is shared between all modules which</span></div>
<div style="position:absolute;left:35.99px;top:61.67px" class="cls_006"><span class="cls_006">declare it: it is allocated space by the linker, which uses the largest</span></div>
<div style="position:absolute;left:35.99px;top:72.67px" class="cls_006"><span class="cls_006">declared size. If any module declares it in one of the initialized .data,</span></div>
<div style="position:absolute;left:35.99px;top:83.67px" class="cls_006"><span class="cls_006">.sdata or .rdata sections, then all the sizes are ignored and the initialized</span></div>
<div style="position:absolute;left:35.99px;top:94.67px" class="cls_006"><span class="cls_006">definition is used instead†.</span></div>
<div style="position:absolute;left:48.01px;top:105.67px" class="cls_006"><span class="cls_006">An object declared with .lcomm is local to the current module, and is</span></div>
<div style="position:absolute;left:35.98px;top:116.67px" class="cls_006"><span class="cls_006">allocated  space  in  the</span></div>
<div style="position:absolute;left:160.98px;top:116.67px" class="cls_006"><span class="cls_006">‘‘uninitialized’’  .bss</span></div>
<div style="position:absolute;left:264.61px;top:116.67px" class="cls_006"><span class="cls_006">(or  .sbss)  section  by  the</span></div>
<div style="position:absolute;left:35.97px;top:127.67px" class="cls_006"><span class="cls_006">assembler.</span></div>
<div style="position:absolute;left:72.00px;top:149.00px" class="cls_028"><span class="cls_028">.comm  dbgflag, 4</span></div>
<div style="position:absolute;left:180.35px;top:149.00px" class="cls_028"><span class="cls_028"># global common variable, 4 bytes</span></div>
<div style="position:absolute;left:72.00px;top:159.00px" class="cls_028"><span class="cls_028">.lcomm array, 100</span></div>
<div style="position:absolute;left:180.39px;top:159.00px" class="cls_028"><span class="cls_028"># local uninitialized object, 100 bytes</span></div>
<div style="position:absolute;left:36.00px;top:188.67px" class="cls_006"><span class="cls_006">.space</span></div>
<div style="position:absolute;left:48.02px;top:199.67px" class="cls_006"><span class="cls_006">The .space directive increments the current section’s location counter</span></div>
<div style="position:absolute;left:36.00px;top:210.67px" class="cls_006"><span class="cls_006">by a number of bytes, for example:</span></div>
<div style="position:absolute;left:72.00px;top:232.00px" class="cls_028"><span class="cls_028">struc: .word</span></div>
<div style="position:absolute;left:144.25px;top:232.00px" class="cls_028"><span class="cls_028">3</span></div>
<div style="position:absolute;left:108.00px;top:242.00px" class="cls_028"><span class="cls_028">.space 120</span></div>
<div style="position:absolute;left:180.21px;top:242.00px" class="cls_028"><span class="cls_028"># 120 byte gap</span></div>
<div style="position:absolute;left:108.00px;top:252.00px" class="cls_028"><span class="cls_028">.word</span></div>
<div style="position:absolute;left:144.11px;top:252.00px" class="cls_028"><span class="cls_028">-1</span></div>
<div style="position:absolute;left:48.02px;top:271.67px" class="cls_006"><span class="cls_006">For normal data and text sections it just emits that many zero bytes, but</span></div>
<div style="position:absolute;left:36.00px;top:282.67px" class="cls_006"><span class="cls_006">in assemblers which allow the programmer to declare new sections with</span></div>
<div style="position:absolute;left:36.00px;top:293.67px" class="cls_006"><span class="cls_006">labels but no real content (like .bss), it will just increment the location</span></div>
<div style="position:absolute;left:36.00px;top:304.67px" class="cls_006"><span class="cls_006">counter without emitting any data.</span></div>
<div style="position:absolute;left:36.00px;top:327.00px" class="cls_015"><span class="cls_015">Symbol binding attributes</span></div>
<div style="position:absolute;left:48.02px;top:340.67px" class="cls_006"><span class="cls_006">Symbols (i.e. labels in one of the code or data segments) can be made</span></div>
<div style="position:absolute;left:36.00px;top:351.67px" class="cls_006"><span class="cls_006">visible and used by the linker which joins separate modules into a single</span></div>
<div style="position:absolute;left:36.00px;top:362.67px" class="cls_006"><span class="cls_006">program. The linker </span><span class="cls_008">binds</span><span class="cls_006"> a symbol to an address and substitutes the</span></div>
<div style="position:absolute;left:35.99px;top:373.67px" class="cls_006"><span class="cls_006">address for assembler-language references to the symbol.</span></div>
<div style="position:absolute;left:48.01px;top:384.67px" class="cls_006"><span class="cls_006">Symbols can have three levels of visibility:</span></div>
<div style="position:absolute;left:48.01px;top:398.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Local</span><span class="cls_006">: invisible outside the module they are declared in, and unused</span></div>
<div style="position:absolute;left:59.96px;top:409.67px" class="cls_006"><span class="cls_006">by the linker. The programmer does not need to worry about whether</span></div>
<div style="position:absolute;left:59.96px;top:420.67px" class="cls_006"><span class="cls_006">the same local symbol name is used in another module.</span></div>
<div style="position:absolute;left:48.01px;top:434.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Global</span><span class="cls_006">: made public for use by the linker. Programs can refer to a</span></div>
<div style="position:absolute;left:59.96px;top:445.67px" class="cls_006"><span class="cls_006">global symbol in another module without defining any local space for</span></div>
<div style="position:absolute;left:59.96px;top:456.67px" class="cls_006"><span class="cls_006">it, using the .extern directive.</span></div>
<div style="position:absolute;left:48.01px;top:470.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Weak global</span><span class="cls_006">: obscure feature provided by some toolchains. This</span></div>
<div style="position:absolute;left:59.96px;top:481.67px" class="cls_006"><span class="cls_006">allows the programmer to arrange that a symbol nominally referring</span></div>
<div style="position:absolute;left:59.96px;top:492.67px" class="cls_006"><span class="cls_006">to a locally-defined space will actually refer to a global symbol, if the</span></div>
<div style="position:absolute;left:59.96px;top:503.67px" class="cls_006"><span class="cls_006">linker finds one. If the linked program has no global symbol with that</span></div>
<div style="position:absolute;left:59.96px;top:514.67px" class="cls_006"><span class="cls_006">name, the local version is used instead.</span></div>
<div style="position:absolute;left:59.96px;top:528.67px" class="cls_006"><span class="cls_006">The preferred programming practice is to use the .comm directive</span></div>
<div style="position:absolute;left:59.96px;top:539.67px" class="cls_006"><span class="cls_006">whenever possible.</span></div>
<div style="position:absolute;left:35.98px;top:560.67px" class="cls_006"><span class="cls_006">.globl</span></div>
<div style="position:absolute;left:48.00px;top:571.67px" class="cls_006"><span class="cls_006">Unlike C, where module-level data and functions are automatically</span></div>
<div style="position:absolute;left:35.98px;top:582.67px" class="cls_008"><span class="cls_008">global</span><span class="cls_006">  unless declared with the</span><span class="cls_029">static</span><span class="cls_006"> keyword, all assembler labels have</span></div>
<div style="position:absolute;left:35.98px;top:593.67px" class="cls_008"><span class="cls_008">local</span><span class="cls_006"> binding unless explicitly modified by the .globl directive.</span></div>
<div style="position:absolute;left:48.00px;top:604.67px" class="cls_006"><span class="cls_006">To define a label as having </span><span class="cls_008">global</span><span class="cls_006"> binding that is visible to other</span></div>
<div style="position:absolute;left:35.98px;top:615.67px" class="cls_006"><span class="cls_006">modules, use the directive as follows:</span></div>
<div style="position:absolute;left:108.00px;top:637.00px" class="cls_028"><span class="cls_028">.data</span></div>
<div style="position:absolute;left:108.00px;top:647.00px" class="cls_028"><span class="cls_028">.globl status</span></div>
<div style="position:absolute;left:216.28px;top:647.00px" class="cls_028"><span class="cls_028"># global variable</span></div>
<div style="position:absolute;left:72.00px;top:657.00px" class="cls_028"><span class="cls_028">status:.word</span></div>
<div style="position:absolute;left:144.28px;top:657.00px" class="cls_028"><span class="cls_028">0</span></div>
<div style="position:absolute;left:108.00px;top:676.99px" class="cls_028"><span class="cls_028">.text</span></div>
<div style="position:absolute;left:108.00px;top:686.99px" class="cls_028"><span class="cls_028">.globl set_status# global function</span></div>
<div style="position:absolute;left:54.00px;top:710.67px" class="cls_006"><span class="cls_006">† The actual handling may be toolchain dependent; this is the</span></div>
<div style="position:absolute;left:54.00px;top:722.67px" class="cls_006"><span class="cls_006">most common technique.</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">9–14</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:97844px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:525.20px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:252.00px;top:51.00px" class="cls_028"><span class="cls_028">set_status:</span></div>
<div style="position:absolute;left:288.00px;top:61.00px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:324.09px;top:61.00px" class="cls_028"><span class="cls_028">sp,24</span></div>
<div style="position:absolute;left:228.02px;top:90.67px" class="cls_006"><span class="cls_006">Note that .globl is not required for objects declared with the .comm</span></div>
<div style="position:absolute;left:216.00px;top:101.67px" class="cls_006"><span class="cls_006">directive; these automatically have global binding.</span></div>
<div style="position:absolute;left:216.00px;top:122.67px" class="cls_006"><span class="cls_006">.extern</span></div>
<div style="position:absolute;left:228.02px;top:133.67px" class="cls_006"><span class="cls_006">All references to labels which are not defined within the current module</span></div>
<div style="position:absolute;left:216.00px;top:144.67px" class="cls_006"><span class="cls_006">are automatically assumed to be references to globally-bound symbols in</span></div>
<div style="position:absolute;left:216.00px;top:155.67px" class="cls_006"><span class="cls_006">another module (i.e. </span><span class="cls_008">external</span><span class="cls_006"> symbols). In some cases the assembler can</span></div>
<div style="position:absolute;left:216.00px;top:166.67px" class="cls_006"><span class="cls_006">generate better code if it knows how big the referenced object is (e.g. the</span></div>
<div style="position:absolute;left:216.00px;top:177.67px" class="cls_006"><span class="cls_006">global pointer, described earlier). An external object’s size is specified</span></div>
<div style="position:absolute;left:216.00px;top:188.67px" class="cls_006"><span class="cls_006">using the .extern directive, as follows:</span></div>
<div style="position:absolute;left:252.00px;top:210.00px" class="cls_028"><span class="cls_028">.externindex, 4</span></div>
<div style="position:absolute;left:252.00px;top:220.00px" class="cls_028"><span class="cls_028">.externarray, 100</span></div>
<div style="position:absolute;left:252.00px;top:230.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:288.05px;top:230.00px" class="cls_028"><span class="cls_028">$3, index</span></div>
<div style="position:absolute;left:360.25px;top:230.00px" class="cls_028"><span class="cls_028"># load a 4 byte (1 word) external</span></div>
<div style="position:absolute;left:252.00px;top:240.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:288.05px;top:240.00px" class="cls_028"><span class="cls_028">$2, array($3) # load part of a 100 byte external</span></div>
<div style="position:absolute;left:252.00px;top:250.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:288.05px;top:250.00px" class="cls_028"><span class="cls_028">$2, value</span></div>
<div style="position:absolute;left:360.25px;top:250.00px" class="cls_028"><span class="cls_028"># store in an unknown size external</span></div>
<div style="position:absolute;left:216.00px;top:279.67px" class="cls_006"><span class="cls_006">.weakext</span></div>
<div style="position:absolute;left:228.02px;top:290.67px" class="cls_006"><span class="cls_006">Some assemblers and toolchains support the concept of </span><span class="cls_008">weak</span><span class="cls_006"> global</span></div>
<div style="position:absolute;left:215.99px;top:301.67px" class="cls_006"><span class="cls_006">binding. This allows the program to specify a provisional binding for a</span></div>
<div style="position:absolute;left:215.99px;top:312.67px" class="cls_006"><span class="cls_006">symbol, which may be overridden if a normal, or </span><span class="cls_008">strong</span><span class="cls_006"> global definition is</span></div>
<div style="position:absolute;left:216.00px;top:323.67px" class="cls_006"><span class="cls_006">encountered. For example:</span></div>
<div style="position:absolute;left:288.00px;top:345.00px" class="cls_028"><span class="cls_028">.data</span></div>
<div style="position:absolute;left:288.00px;top:355.00px" class="cls_028"><span class="cls_028">.weakext errno</span></div>
<div style="position:absolute;left:252.00px;top:365.00px" class="cls_028"><span class="cls_028">errno: .word</span></div>
<div style="position:absolute;left:324.25px;top:365.00px" class="cls_028"><span class="cls_028">0</span></div>
<div style="position:absolute;left:288.00px;top:385.00px" class="cls_028"><span class="cls_028">.text</span></div>
<div style="position:absolute;left:288.00px;top:394.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:394.99px" class="cls_028"><span class="cls_028">$2,errno</span></div>
<div style="position:absolute;left:396.23px;top:394.99px" class="cls_028"><span class="cls_028"># may use local or external</span></div>
<div style="position:absolute;left:396.00px;top:404.99px" class="cls_028"><span class="cls_028"># definition</span></div>
<div style="position:absolute;left:228.02px;top:424.67px" class="cls_006"><span class="cls_006">This module, and others which access </span><span class="cls_008">errno</span><span class="cls_006">, will use this local definition</span></div>
<div style="position:absolute;left:216.00px;top:435.67px" class="cls_006"><span class="cls_006">of </span><span class="cls_008">errno</span><span class="cls_006">, unless some other module also defines it with a .globl.</span></div>
<div style="position:absolute;left:228.02px;top:446.67px" class="cls_006"><span class="cls_006">It is also possible to declare a local variable with one name, but make it</span></div>
<div style="position:absolute;left:216.00px;top:457.67px" class="cls_006"><span class="cls_006">weakly global with a different name:</span></div>
<div style="position:absolute;left:288.00px;top:479.00px" class="cls_028"><span class="cls_028">.data</span></div>
<div style="position:absolute;left:252.00px;top:489.00px" class="cls_028"><span class="cls_028">myerrno: .word0</span></div>
<div style="position:absolute;left:288.00px;top:499.00px" class="cls_028"><span class="cls_028">.weakext errno, myerrno</span></div>
<div style="position:absolute;left:288.00px;top:519.00px" class="cls_028"><span class="cls_028">.text</span></div>
<div style="position:absolute;left:288.00px;top:528.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:528.99px" class="cls_028"><span class="cls_028">$2,myerrno</span></div>
<div style="position:absolute;left:396.28px;top:528.99px" class="cls_028"><span class="cls_028"># always use local definition</span></div>
<div style="position:absolute;left:288.00px;top:538.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:538.99px" class="cls_028"><span class="cls_028">$2,errno</span></div>
<div style="position:absolute;left:396.23px;top:538.99px" class="cls_028"><span class="cls_028"># may use local definition, or</span></div>
<div style="position:absolute;left:396.00px;top:548.99px" class="cls_028"><span class="cls_028"># other</span></div>
<div style="position:absolute;left:216.00px;top:580.00px" class="cls_015"><span class="cls_015">Function directives</span></div>
<div style="position:absolute;left:228.02px;top:593.67px" class="cls_006"><span class="cls_006">Some MIPS assemblers expect the programmer to mark the start and</span></div>
<div style="position:absolute;left:216.00px;top:604.67px" class="cls_006"><span class="cls_006">end of each function, and describe the stack frame which it uses. In some</span></div>
<div style="position:absolute;left:216.00px;top:615.67px" class="cls_006"><span class="cls_006">toolchains this information is used by the debugger to perform stack</span></div>
<div style="position:absolute;left:216.00px;top:626.67px" class="cls_006"><span class="cls_006">backtraces and the like.</span></div>
<div style="position:absolute;left:216.00px;top:647.67px" class="cls_006"><span class="cls_006">.ent, .end</span></div>
<div style="position:absolute;left:228.02px;top:658.67px" class="cls_006"><span class="cls_006">These directives mark the start and end of a function. A trivial </span><span class="cls_008">leaf</span></div>
<div style="position:absolute;left:215.99px;top:669.67px" class="cls_006"><span class="cls_006">function might look like this:</span></div>
<div style="position:absolute;left:288.00px;top:691.00px" class="cls_028"><span class="cls_028">.text</span></div>
<div style="position:absolute;left:288.00px;top:701.00px" class="cls_028"><span class="cls_028">.ent</span></div>
<div style="position:absolute;left:324.09px;top:701.00px" class="cls_028"><span class="cls_028">localfunc</span></div>
<div style="position:absolute;left:252.00px;top:711.00px" class="cls_028"><span class="cls_028">localfunc:</span></div>
<div style="position:absolute;left:288.00px;top:721.00px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:324.09px;top:721.00px" class="cls_028"><span class="cls_028">v0,a1,a2</span></div>
<div style="position:absolute;left:396.28px;top:721.00px" class="cls_028"><span class="cls_028"># return (arg1 + arg2)</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">9–15</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:98646px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:376.95px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:108.00px;top:51.00px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:51.00px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:108.00px;top:61.00px" class="cls_028"><span class="cls_028">.end</span></div>
<div style="position:absolute;left:144.09px;top:61.00px" class="cls_028"><span class="cls_028">localfunc</span></div>
<div style="position:absolute;left:48.02px;top:80.67px" class="cls_006"><span class="cls_006">The label name may be omitted from the .end directive, which then</span></div>
<div style="position:absolute;left:36.00px;top:91.67px" class="cls_006"><span class="cls_006">defaults to the name used in the last .ent. Specifying the name explicitly</span></div>
<div style="position:absolute;left:36.00px;top:102.67px" class="cls_006"><span class="cls_006">allows the assembler to check that the programmer did not miss earlier</span></div>
<div style="position:absolute;left:36.00px;top:113.67px" class="cls_006"><span class="cls_006">.ent or .end directives.</span></div>
<div style="position:absolute;left:36.00px;top:134.67px" class="cls_006"><span class="cls_006">.aent</span></div>
<div style="position:absolute;left:48.02px;top:145.67px" class="cls_006"><span class="cls_006">Some functions may provide multiple, alternative entry-points. The</span></div>
<div style="position:absolute;left:36.00px;top:156.67px" class="cls_006"><span class="cls_006">.aent directive identifies labels as such. For example:</span></div>
<div style="position:absolute;left:108.00px;top:178.00px" class="cls_028"><span class="cls_028">.text</span></div>
<div style="position:absolute;left:108.00px;top:188.00px" class="cls_028"><span class="cls_028">.globl memcpy</span></div>
<div style="position:absolute;left:108.00px;top:198.00px" class="cls_028"><span class="cls_028">.ent</span></div>
<div style="position:absolute;left:144.09px;top:198.00px" class="cls_028"><span class="cls_028">memcpy</span></div>
<div style="position:absolute;left:72.00px;top:208.00px" class="cls_028"><span class="cls_028">memcpy:move   t0,a0</span></div>
<div style="position:absolute;left:216.37px;top:208.00px" class="cls_028"><span class="cls_028"># swap first two arguments</span></div>
<div style="position:absolute;left:108.00px;top:218.00px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:218.00px" class="cls_028"><span class="cls_028">a0,a1</span></div>
<div style="position:absolute;left:108.00px;top:227.99px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:227.99px" class="cls_028"><span class="cls_028">a1,t0</span></div>
<div style="position:absolute;left:108.00px;top:247.99px" class="cls_028"><span class="cls_028">.globl bcopy</span></div>
<div style="position:absolute;left:108.00px;top:257.99px" class="cls_028"><span class="cls_028">.aent  bcopy</span></div>
<div style="position:absolute;left:72.00px;top:267.99px" class="cls_028"><span class="cls_028">bcopy: lb</span></div>
<div style="position:absolute;left:144.19px;top:267.99px" class="cls_028"><span class="cls_028">t0,0(a0)</span></div>
<div style="position:absolute;left:216.37px;top:267.99px" class="cls_028"><span class="cls_028"># very slow byte copy</span></div>
<div style="position:absolute;left:108.00px;top:277.99px" class="cls_028"><span class="cls_028">sb</span></div>
<div style="position:absolute;left:144.05px;top:277.99px" class="cls_028"><span class="cls_028">t0,0(a1)</span></div>
<div style="position:absolute;left:108.00px;top:287.99px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:144.09px;top:287.99px" class="cls_028"><span class="cls_028">a0,1</span></div>
<div style="position:absolute;left:108.00px;top:297.99px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:144.09px;top:297.99px" class="cls_028"><span class="cls_028">a1,1</span></div>
<div style="position:absolute;left:108.00px;top:307.99px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:144.09px;top:307.99px" class="cls_028"><span class="cls_028">a2,1</span></div>
<div style="position:absolute;left:108.00px;top:317.99px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:144.07px;top:317.99px" class="cls_028"><span class="cls_028">a2,zero,bcopy</span></div>
<div style="position:absolute;left:108.00px;top:327.98px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:327.98px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:108.00px;top:337.98px" class="cls_028"><span class="cls_028">.end</span></div>
<div style="position:absolute;left:144.09px;top:337.98px" class="cls_028"><span class="cls_028">memcpy</span></div>
<div style="position:absolute;left:36.00px;top:367.67px" class="cls_006"><span class="cls_006">.frame, .mask, .fmask</span></div>
<div style="position:absolute;left:48.02px;top:378.67px" class="cls_006"><span class="cls_006">Most functions need to allocate a stack frame in which to:</span></div>
<div style="position:absolute;left:48.02px;top:392.67px" class="cls_006"><span class="cls_006">• save the return address register (</span><span class="cls_008">$31</span><span class="cls_006">);</span></div>
<div style="position:absolute;left:48.03px;top:406.67px" class="cls_006"><span class="cls_006">• save any of the registers </span><span class="cls_008">s0</span><span class="cls_006"> - </span><span class="cls_008">s9</span><span class="cls_006"> and </span><span class="cls_008">$f20</span><span class="cls_006"> - </span><span class="cls_008">$f31</span><span class="cls_006"> which they modify</span></div>
<div style="position:absolute;left:59.99px;top:417.67px" class="cls_006"><span class="cls_006">(known as the </span><span class="cls_008">callee-saves</span><span class="cls_006"> registers);</span></div>
<div style="position:absolute;left:48.04px;top:431.67px" class="cls_006"><span class="cls_006">• store local variables and temporaries;</span></div>
<div style="position:absolute;left:48.04px;top:445.67px" class="cls_006"><span class="cls_006">• pass arguments to other functions.</span></div>
<div style="position:absolute;left:48.04px;top:456.67px" class="cls_006"><span class="cls_006">In some CISC architectures the stack frame allocation, and possibly</span></div>
<div style="position:absolute;left:36.02px;top:467.67px" class="cls_006"><span class="cls_006">register saving, is done by special purpose </span><span class="cls_008">enter</span><span class="cls_006"> and </span><span class="cls_008">leave</span><span class="cls_006"> instructions,</span></div>
<div style="position:absolute;left:36.02px;top:478.67px" class="cls_006"><span class="cls_006">but in the MIPS architecture it is coded by the compiler or assembly-</span></div>
<div style="position:absolute;left:36.02px;top:489.67px" class="cls_006"><span class="cls_006">language programmer. However debuggers need to know the layout of each</span></div>
<div style="position:absolute;left:36.02px;top:500.67px" class="cls_006"><span class="cls_006">stack frame to do stack backtraces and the like, and in the original MIPS</span></div>
<div style="position:absolute;left:36.02px;top:511.67px" class="cls_006"><span class="cls_006">Corp.  toolchain  these  directives  provided  this  information;  in  other</span></div>
<div style="position:absolute;left:36.02px;top:522.67px" class="cls_006"><span class="cls_006">toolchains they may be quietly ignored, and the stack layout determined</span></div>
<div style="position:absolute;left:36.02px;top:533.67px" class="cls_006"><span class="cls_006">at run-time by disassembling the function prologue. Putting them in the</span></div>
<div style="position:absolute;left:36.02px;top:544.67px" class="cls_006"><span class="cls_006">code is therefore not always essential, but does no harm and may make</span></div>
<div style="position:absolute;left:36.02px;top:555.67px" class="cls_006"><span class="cls_006">the code more portable. Many toolchains supply a header file &lt;</span><span class="cls_008">asm.h</span><span class="cls_006">>,</span></div>
<div style="position:absolute;left:36.02px;top:566.67px" class="cls_006"><span class="cls_006">which provides C-style macros to generate the appropriate directives, as</span></div>
<div style="position:absolute;left:36.02px;top:577.67px" class="cls_006"><span class="cls_006">required (the procedure call protocol, and stack usage, is described in a</span></div>
<div style="position:absolute;left:36.02px;top:588.67px" class="cls_006"><span class="cls_006">later chapter).</span></div>
<div style="position:absolute;left:48.04px;top:599.67px" class="cls_006"><span class="cls_006">The .frame directive takes 3 operands:</span></div>
<div style="position:absolute;left:48.03px;top:613.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> framereg</span><span class="cls_006">: the register used to access the local stack frame - usually</span></div>
<div style="position:absolute;left:59.98px;top:624.67px" class="cls_008"><span class="cls_008">$sp.</span></div>
<div style="position:absolute;left:48.02px;top:638.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> returnreg</span><span class="cls_006">: the register which holds the return address. Usually this is</span></div>
<div style="position:absolute;left:59.97px;top:649.67px" class="cls_008"><span class="cls_008">$0,</span><span class="cls_006"> which indicates that the return address is stored in the stack</span></div>
<div style="position:absolute;left:59.97px;top:660.67px" class="cls_006"><span class="cls_006">frame, or </span><span class="cls_008">$31</span><span class="cls_006"> if this is a </span><span class="cls_008">leaf</span><span class="cls_006"> function (i.e. it doesn’t call any other</span></div>
<div style="position:absolute;left:59.97px;top:671.67px" class="cls_006"><span class="cls_006">functions) and the return address is not saved.</span></div>
<div style="position:absolute;left:48.02px;top:685.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> framesize</span><span class="cls_006">: the total size of stack frame allocated by this function; it</span></div>
<div style="position:absolute;left:59.97px;top:696.67px" class="cls_006"><span class="cls_006">should always be the case that </span><span class="cls_008">$sp</span><span class="cls_006"> + </span><span class="cls_008">framesize</span><span class="cls_006"> = previous </span><span class="cls_008">$sp</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">9–16</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:99448px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:525.20px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:252.00px;top:61.00px" class="cls_028"><span class="cls_028">.frame framereg, framesize, returnreg</span></div>
<div style="position:absolute;left:228.02px;top:80.67px" class="cls_006"><span class="cls_006">The .mask directive indicates where the function saves general registers</span></div>
<div style="position:absolute;left:215.99px;top:91.67px" class="cls_006"><span class="cls_006">in the stack frame; .fmask does the same for floating-point registers. Their</span></div>
<div style="position:absolute;left:215.99px;top:102.67px" class="cls_006"><span class="cls_006">first argument is </span><span class="cls_008">regmask</span><span class="cls_006">, a bitmap of which registers are being saved (i.e.</span></div>
<div style="position:absolute;left:215.99px;top:113.67px" class="cls_006"><span class="cls_006">bit 1 set = </span><span class="cls_008">$1</span><span class="cls_006">, bit 2 set = </span><span class="cls_008">$2</span><span class="cls_006">, etc.); the second argument is </span><span class="cls_008">regoffset</span><span class="cls_006">, the</span></div>
<div style="position:absolute;left:215.99px;top:124.67px" class="cls_006"><span class="cls_006">distance from </span><span class="cls_008">framereg + framesize</span><span class="cls_006"> to the start of the register save area.</span></div>
<div style="position:absolute;left:252.00px;top:146.00px" class="cls_028"><span class="cls_028">.mask  regmask, regoffset</span></div>
<div style="position:absolute;left:252.00px;top:156.00px" class="cls_028"><span class="cls_028">.fmask fregmask, fregoffs</span></div>
<div style="position:absolute;left:228.02px;top:175.67px" class="cls_006"><span class="cls_006">How these directives relate to the stack frame layout, and examples of</span></div>
<div style="position:absolute;left:216.00px;top:186.67px" class="cls_006"><span class="cls_006">their use, can be found in the next chapter. Remember that the directives</span></div>
<div style="position:absolute;left:216.00px;top:197.67px" class="cls_006"><span class="cls_006">do not create the stack frame, they just describe its layout; that code still</span></div>
<div style="position:absolute;left:216.00px;top:208.67px" class="cls_006"><span class="cls_006">has  to  be  written  explicitly  by  the  compiler  or  assembly-language</span></div>
<div style="position:absolute;left:216.00px;top:219.67px" class="cls_006"><span class="cls_006">programmer.</span></div>
<div style="position:absolute;left:216.00px;top:242.00px" class="cls_015"><span class="cls_015">Assembler control (.set)</span></div>
<div style="position:absolute;left:228.02px;top:255.67px" class="cls_006"><span class="cls_006">The original MIPS Corp. assembler is an ambitious program which</span></div>
<div style="position:absolute;left:216.00px;top:266.67px" class="cls_006"><span class="cls_006">performs intelligent macro expansion of synthetic instructions, delay-slot</span></div>
<div style="position:absolute;left:216.00px;top:277.67px" class="cls_006"><span class="cls_006">filling, peephole optimization, and sophisticated instruction reordering, or</span></div>
<div style="position:absolute;left:216.00px;top:288.67px" class="cls_006"><span class="cls_006">scheduling, to minimize pipeline stalls. Many assemblers will be less</span></div>
<div style="position:absolute;left:216.00px;top:299.67px" class="cls_006"><span class="cls_006">complex: modern optimizing compilers usually prefer to do these sort of</span></div>
<div style="position:absolute;left:216.00px;top:310.67px" class="cls_006"><span class="cls_006">optimizations  themselves.  However  in  the  interests  of  source  code</span></div>
<div style="position:absolute;left:216.00px;top:321.67px" class="cls_006"><span class="cls_006">compatibility, and to make the programmer’s life easier, most MIPS</span></div>
<div style="position:absolute;left:216.00px;top:332.67px" class="cls_006"><span class="cls_006">assemblers perform macro expansion, insert extra nops as required to</span></div>
<div style="position:absolute;left:216.00px;top:343.67px" class="cls_006"><span class="cls_006">hide branch and load delay-slots, and prevent pipeline hazards in normal</span></div>
<div style="position:absolute;left:216.00px;top:354.67px" class="cls_006"><span class="cls_006">code (pipeline hazards are described in detail later).</span></div>
<div style="position:absolute;left:228.02px;top:365.67px" class="cls_006"><span class="cls_006">With a reordering assembler it is sometimes necessary to restrict the</span></div>
<div style="position:absolute;left:216.00px;top:376.67px" class="cls_006"><span class="cls_006">reordering, to guarantee correct timing, or to account for side-effects of</span></div>
<div style="position:absolute;left:216.00px;top:387.67px" class="cls_006"><span class="cls_006">instructions which the assembler cannot know about (e.g. enabling and</span></div>
<div style="position:absolute;left:216.00px;top:398.67px" class="cls_006"><span class="cls_006">disabling interrupts). The .set directives provide this control.</span></div>
<div style="position:absolute;left:216.00px;top:419.67px" class="cls_006"><span class="cls_006">.set noreorder/reorder</span></div>
<div style="position:absolute;left:228.02px;top:430.67px" class="cls_006"><span class="cls_006">By default most assemblers are in </span><span class="cls_008">reorder</span><span class="cls_006"> mode, which allow them to</span></div>
<div style="position:absolute;left:216.00px;top:441.67px" class="cls_006"><span class="cls_006">reorder instructions to avoid pipeline hazards and (perhaps) to achieve</span></div>
<div style="position:absolute;left:216.00px;top:452.67px" class="cls_006"><span class="cls_006">better performance; in this mode it will not allow the programmer to insert</span></div>
<div style="position:absolute;left:216.00px;top:463.67px" class="cls_006"><span class="cls_006">nops. Conversely, code that is an a </span><span class="cls_008">noreorder</span><span class="cls_006"> region will not be optimized</span></div>
<div style="position:absolute;left:216.00px;top:474.67px" class="cls_006"><span class="cls_006">or changed in any way. This means that the programmer can completely</span></div>
<div style="position:absolute;left:216.00px;top:485.67px" class="cls_006"><span class="cls_006">control the instruction order, but the downside is that the code must now</span></div>
<div style="position:absolute;left:216.00px;top:496.67px" class="cls_006"><span class="cls_006">be scheduled manually, and delay slots filled with useful instructions or</span></div>
<div style="position:absolute;left:216.00px;top:507.67px" class="cls_006"><span class="cls_006">nops. For example:</span></div>
<div style="position:absolute;left:252.00px;top:529.00px" class="cls_028"><span class="cls_028">.set noreorder</span></div>
<div style="position:absolute;left:252.00px;top:539.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:288.05px;top:539.00px" class="cls_028"><span class="cls_028">t0, 0(a0)</span></div>
<div style="position:absolute;left:252.00px;top:549.00px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:360.07px;top:549.00px" class="cls_028"><span class="cls_028"># LDSLOT</span></div>
<div style="position:absolute;left:252.00px;top:559.00px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:288.09px;top:559.00px" class="cls_028"><span class="cls_028">t0, 1</span></div>
<div style="position:absolute;left:252.00px;top:569.00px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:288.07px;top:569.00px" class="cls_028"><span class="cls_028">t0, zero, loop</span></div>
<div style="position:absolute;left:252.00px;top:578.99px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:360.07px;top:578.99px" class="cls_028"><span class="cls_028"># BDSLOT</span></div>
<div style="position:absolute;left:252.00px;top:588.99px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:288.09px;top:588.99px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:216.00px;top:618.67px" class="cls_006"><span class="cls_006">.set volatile/novolatile</span></div>
<div style="position:absolute;left:228.02px;top:629.67px" class="cls_006"><span class="cls_006">Any load or store instruction within a </span><span class="cls_008">volatile</span><span class="cls_006"> region will not be moved</span></div>
<div style="position:absolute;left:215.99px;top:640.67px" class="cls_006"><span class="cls_006">with respect to other loads and stores. This can be important for accesses</span></div>
<div style="position:absolute;left:215.99px;top:651.67px" class="cls_006"><span class="cls_006">to memory mapped device registers, where the order of reads and writes is</span></div>
<div style="position:absolute;left:215.99px;top:662.67px" class="cls_006"><span class="cls_006">important. For example, if the following code fragment did not use .set</span></div>
<div style="position:absolute;left:215.99px;top:673.67px" class="cls_006"><span class="cls_006">volatile, then the assembler might decide to move the second lw before the</span></div>
<div style="position:absolute;left:216.00px;top:684.67px" class="cls_006"><span class="cls_006">sw,  to  fill  the  first  load  delay-slot.  Hazard  avoidance  and  other</span></div>
<div style="position:absolute;left:216.00px;top:695.67px" class="cls_006"><span class="cls_006">optimizations are not affected by this option.</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">9–17</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:100250px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:376.95px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:72.00px;top:61.00px" class="cls_028"><span class="cls_028">.set volatile</span></div>
<div style="position:absolute;left:72.00px;top:71.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:108.05px;top:71.00px" class="cls_028"><span class="cls_028">t0,0(a0)</span></div>
<div style="position:absolute;left:72.00px;top:81.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:108.05px;top:81.00px" class="cls_028"><span class="cls_028">t0,0(a1)</span></div>
<div style="position:absolute;left:72.00px;top:91.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:108.05px;top:91.00px" class="cls_028"><span class="cls_028">t1,4(a0)</span></div>
<div style="position:absolute;left:72.00px;top:101.00px" class="cls_028"><span class="cls_028">.set novolatile</span></div>
<div style="position:absolute;left:36.00px;top:130.67px" class="cls_006"><span class="cls_006">.set noat/at</span></div>
<div style="position:absolute;left:48.02px;top:141.67px" class="cls_006"><span class="cls_006">The assembler reserves register </span><span class="cls_008">$1</span><span class="cls_006"> (known as the </span><span class="cls_008">assembler temporary</span><span class="cls_006">,</span></div>
<div style="position:absolute;left:36.00px;top:152.67px" class="cls_006"><span class="cls_006">or</span></div>
<div style="position:absolute;left:52.79px;top:152.67px" class="cls_008"><span class="cls_008">$at</span><span class="cls_006"> register) to hold intermediate values when performing macro</span></div>
<div style="position:absolute;left:36.01px;top:163.67px" class="cls_006"><span class="cls_006">expansions; if code attempts to use the register, a warning or error</span></div>
<div style="position:absolute;left:36.01px;top:174.67px" class="cls_006"><span class="cls_006">message will be sent. It is not always obvious when the assembler will use</span></div>
<div style="position:absolute;left:36.01px;top:185.67px" class="cls_008"><span class="cls_008">$at</span><span class="cls_006">, and there are certain circumstances when the programmer may need</span></div>
<div style="position:absolute;left:36.01px;top:196.67px" class="cls_006"><span class="cls_006">to ensure that it does not (for example in exception handlers before </span><span class="cls_008">$1</span><span class="cls_006"> has</span></div>
<div style="position:absolute;left:36.01px;top:207.67px" class="cls_006"><span class="cls_006">been saved). Switching on noat will make the assembler generate an error</span></div>
<div style="position:absolute;left:36.01px;top:218.67px" class="cls_006"><span class="cls_006">message if it needs to use </span><span class="cls_008">$1</span><span class="cls_006"> in a macro instruction, and allows the</span></div>
<div style="position:absolute;left:36.02px;top:229.67px" class="cls_006"><span class="cls_006">programmer to use it explicitly without receiving warnings. For example:</span></div>
<div style="position:absolute;left:72.00px;top:251.00px" class="cls_028"><span class="cls_028">xcptgen:</span></div>
<div style="position:absolute;left:108.00px;top:261.00px" class="cls_028"><span class="cls_028">.set noat</span></div>
<div style="position:absolute;left:108.00px;top:271.00px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:144.09px;top:271.00px" class="cls_028"><span class="cls_028">k0,sp,XCP_SIZE</span></div>
<div style="position:absolute;left:108.00px;top:281.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:281.00px" class="cls_028"><span class="cls_028">$at,XCP_AT(k0)</span></div>
<div style="position:absolute;left:108.00px;top:291.00px" class="cls_028"><span class="cls_028">.set at</span></div>
<div style="position:absolute;left:36.00px;top:320.67px" class="cls_006"><span class="cls_006">.set nomacro/macro</span></div>
<div style="position:absolute;left:48.02px;top:331.67px" class="cls_006"><span class="cls_006">Most of the time the programmer will not care whether an assembler</span></div>
<div style="position:absolute;left:36.00px;top:342.67px" class="cls_006"><span class="cls_006">statement generates more than one real machine instruction, but of course</span></div>
<div style="position:absolute;left:36.00px;top:353.67px" class="cls_006"><span class="cls_006">there are exceptions. For instance when manually filling a branch delay-</span></div>
<div style="position:absolute;left:36.00px;top:364.67px" class="cls_006"><span class="cls_006">slot in a </span><span class="cls_008">noreorder</span><span class="cls_006"> region, it would almost certainly be wrong to use a</span></div>
<div style="position:absolute;left:36.00px;top:375.67px" class="cls_006"><span class="cls_006">complex  macro  instruction;  if  the  branch  was  taken,  only  the  first</span></div>
<div style="position:absolute;left:36.00px;top:386.67px" class="cls_006"><span class="cls_006">instruction of the macro would be executed. Switching on nomacro will</span></div>
<div style="position:absolute;left:36.00px;top:397.67px" class="cls_006"><span class="cls_006">cause a warning if any statement expands to more than one machine</span></div>
<div style="position:absolute;left:36.00px;top:408.67px" class="cls_006"><span class="cls_006">instruction. For example, compare the following two code fragments:</span></div>
<div style="position:absolute;left:72.00px;top:430.00px" class="cls_028"><span class="cls_028">.set noreorder</span></div>
<div style="position:absolute;left:72.00px;top:440.00px" class="cls_028"><span class="cls_028">blt</span></div>
<div style="position:absolute;left:108.07px;top:440.00px" class="cls_028"><span class="cls_028">a1,a2,loop</span></div>
<div style="position:absolute;left:72.00px;top:450.00px" class="cls_028"><span class="cls_028">.set nomacro</span></div>
<div style="position:absolute;left:72.00px;top:460.00px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:108.05px;top:460.00px" class="cls_028"><span class="cls_028">a0,0x1234</span></div>
<div style="position:absolute;left:180.25px;top:460.00px" class="cls_028"><span class="cls_028"># BDSLOT</span></div>
<div style="position:absolute;left:72.00px;top:470.00px" class="cls_028"><span class="cls_028">.set macro</span></div>
<div style="position:absolute;left:72.00px;top:479.99px" class="cls_028"><span class="cls_028">.set reorder</span></div>
<div style="position:absolute;left:72.00px;top:509.99px" class="cls_028"><span class="cls_028">.set noreorder</span></div>
<div style="position:absolute;left:72.00px;top:519.99px" class="cls_028"><span class="cls_028">blt</span></div>
<div style="position:absolute;left:108.07px;top:519.99px" class="cls_028"><span class="cls_028">a1,a2,loop</span></div>
<div style="position:absolute;left:72.00px;top:529.99px" class="cls_028"><span class="cls_028">.set nomacro</span></div>
<div style="position:absolute;left:72.00px;top:539.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:108.05px;top:539.99px" class="cls_028"><span class="cls_028">a0,0x12345</span></div>
<div style="position:absolute;left:180.28px;top:539.99px" class="cls_028"><span class="cls_028"># BDSLOT</span></div>
<div style="position:absolute;left:72.00px;top:549.99px" class="cls_028"><span class="cls_028">.set macro</span></div>
<div style="position:absolute;left:72.00px;top:559.99px" class="cls_028"><span class="cls_028">.set reorder</span></div>
<div style="position:absolute;left:48.02px;top:579.67px" class="cls_006"><span class="cls_006">The first will assemble successfully, but the second will generate an</span></div>
<div style="position:absolute;left:36.00px;top:590.67px" class="cls_006"><span class="cls_006">assembler error message, because its li is expanded into two machine</span></div>
<div style="position:absolute;left:36.00px;top:601.67px" class="cls_006"><span class="cls_006">instructions</span></div>
<div style="position:absolute;left:102.19px;top:601.67px" class="cls_006"><span class="cls_006">(lui  and  ori).  Some  assemblers  will  catch  this  mistake</span></div>
<div style="position:absolute;left:36.01px;top:612.67px" class="cls_006"><span class="cls_006">automatically.</span></div>
<div style="position:absolute;left:36.01px;top:633.67px" class="cls_006"><span class="cls_006">.set nobopt/bopt</span></div>
<div style="position:absolute;left:48.03px;top:644.67px" class="cls_006"><span class="cls_006">Setting the nobopt control prevents the assembler from carrying out</span></div>
<div style="position:absolute;left:36.00px;top:655.67px" class="cls_006"><span class="cls_006">certain types of branch optimization. It is usually used only by compilers.</span></div>
<div style="position:absolute;left:36.00px;top:678.00px" class="cls_015"><span class="cls_015">THE COMPLETE GUIDE TO ASSEMBLER INSTRUCTIONS</span></div>
<div style="position:absolute;left:48.02px;top:691.67px" class="cls_006"><span class="cls_006">Table 9.2, “Assembler instructions” below shows, for </span><span class="cls_008">every</span><span class="cls_006"> mnemonic</span></div>
<div style="position:absolute;left:36.00px;top:702.67px" class="cls_006"><span class="cls_006">defined by the MIPS assemblers for the R3000 (MIPS 1) instruction set,</span></div>
<div style="position:absolute;left:36.00px;top:713.67px" class="cls_006"><span class="cls_006">how it is likely to be implemented, and what it does.</span></div>
<div style="position:absolute;left:48.02px;top:724.67px" class="cls_006"><span class="cls_006">Some naming conventions in the assembler may appear confusing:</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">9–18</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:101052px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:525.20px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Unsigned versions</span><span class="cls_006">: a ‘‘u’’ suffix on the assembler mnemonic is usually</span></div>
<div style="position:absolute;left:239.98px;top:61.67px" class="cls_006"><span class="cls_006">to be read as ‘‘unsigned’’. Usually this follows the conventional</span></div>
<div style="position:absolute;left:239.98px;top:72.67px" class="cls_006"><span class="cls_006">meaning; but the most common u-suffix instructions are addu and</span></div>
<div style="position:absolute;left:239.99px;top:83.67px" class="cls_006"><span class="cls_006">subu: and here the u means that overflow into the sign bit will not</span></div>
<div style="position:absolute;left:240.00px;top:94.67px" class="cls_006"><span class="cls_006">cause a trap. Regular add is never generated by C compilers.</span></div>
<div style="position:absolute;left:240.01px;top:108.67px" class="cls_006"><span class="cls_006">Many compilers, not expecting there to be a run-time system to</span></div>
<div style="position:absolute;left:240.01px;top:119.67px" class="cls_006"><span class="cls_006">handle overflow traps, will always use the ‘‘u’’ variant.</span></div>
<div style="position:absolute;left:240.01px;top:133.67px" class="cls_006"><span class="cls_006">However, because the integer multiply instructions mult and multu</span></div>
<div style="position:absolute;left:240.01px;top:144.67px" class="cls_006"><span class="cls_006">generate 64-bit results the signed and unsigned versions are really</span></div>
<div style="position:absolute;left:240.01px;top:155.67px" class="cls_006"><span class="cls_006">different - and neither of the machine instructions produce a trap</span></div>
<div style="position:absolute;left:240.01px;top:166.67px" class="cls_006"><span class="cls_006">under any circumstances.</span></div>
<div style="position:absolute;left:228.06px;top:180.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Immediate operands</span><span class="cls_006">: as mentioned above, the programmer can use</span></div>
<div style="position:absolute;left:240.01px;top:191.67px" class="cls_006"><span class="cls_006">immediate operands with most instructions (e.g. add rd, rs, 1); quite</span></div>
<div style="position:absolute;left:240.01px;top:202.67px" class="cls_006"><span class="cls_006">a  few  arithmetic/logic  instructions  really  do  have</span></div>
<div style="position:absolute;left:516.31px;top:202.67px" class="cls_006"><span class="cls_006">‘‘immediate’’</span></div>
<div style="position:absolute;left:240.01px;top:213.67px" class="cls_006"><span class="cls_006">versions</span></div>
<div style="position:absolute;left:287.27px;top:213.67px" class="cls_006"><span class="cls_006">(called  addi  etc.).  Most  assemblers  do  not  require  the</span></div>
<div style="position:absolute;left:240.01px;top:224.67px" class="cls_006"><span class="cls_006">programmer to explicitly know which machine instructions support</span></div>
<div style="position:absolute;left:240.01px;top:235.67px" class="cls_006"><span class="cls_006">immediate variants.</span></div>
<div style="position:absolute;left:228.06px;top:249.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Building addresses, %lo_ and %hi_</span><span class="cls_006">: synthesis of addressing modes</span></div>
<div style="position:absolute;left:240.01px;top:260.67px" class="cls_006"><span class="cls_006">was described earlier. The table typically will list only one address-</span></div>
<div style="position:absolute;left:240.01px;top:271.67px" class="cls_006"><span class="cls_006">mode variant for each instruction in the table.</span></div>
<div style="position:absolute;left:228.06px;top:285.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> What it does</span><span class="cls_006">: the function of each instruction is described using ‘‘C’’</span></div>
<div style="position:absolute;left:240.01px;top:296.67px" class="cls_006"><span class="cls_006">expression syntax; it is easy to get a rough idea, but a thorough</span></div>
<div style="position:absolute;left:240.01px;top:307.67px" class="cls_006"><span class="cls_006">knowledge of C allows the exact behavior to be understood.</span></div>
<div style="position:absolute;left:228.06px;top:318.67px" class="cls_006"><span class="cls_006">The assembler descriptions use the following conventions:</span></div>
<div style="position:absolute;left:253.16px;top:341.00px" class="cls_020"><span class="cls_020">Word</span></div>
<div style="position:absolute;left:423.09px;top:341.00px" class="cls_020"><span class="cls_020">Used for</span></div>
<div style="position:absolute;left:222.54px;top:360.00px" class="cls_020"><span class="cls_020">rs,rt</span></div>
<div style="position:absolute;left:314.93px;top:360.00px" class="cls_020"><span class="cls_020">CPU registers used as operands</span></div>
<div style="position:absolute;left:222.54px;top:377.00px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:314.89px;top:377.00px" class="cls_020"><span class="cls_020">CPU register which receives the result</span></div>
<div style="position:absolute;left:222.54px;top:394.00px" class="cls_020"><span class="cls_020">fs,ft</span></div>
<div style="position:absolute;left:314.92px;top:394.00px" class="cls_020"><span class="cls_020">floating point register operands</span></div>
<div style="position:absolute;left:222.54px;top:411.00px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:314.88px;top:411.00px" class="cls_020"><span class="cls_020">floating point register which receives the result</span></div>
<div style="position:absolute;left:222.54px;top:428.00px" class="cls_020"><span class="cls_020">imm</span></div>
<div style="position:absolute;left:314.93px;top:428.00px" class="cls_020"><span class="cls_020">16-bit ‘‘immediate’’ constant</span></div>
<div style="position:absolute;left:222.54px;top:445.00px" class="cls_020"><span class="cls_020">label</span></div>
<div style="position:absolute;left:314.94px;top:445.00px" class="cls_020"><span class="cls_020">the name of an entry point in the instruction stream</span></div>
<div style="position:absolute;left:222.54px;top:462.01px" class="cls_020"><span class="cls_020">addr</span></div>
<div style="position:absolute;left:314.93px;top:462.01px" class="cls_020"><span class="cls_020">one of a number of different address expressions</span></div>
<div style="position:absolute;left:222.54px;top:479.01px" class="cls_020"><span class="cls_020">%hi_addr</span></div>
<div style="position:absolute;left:315.02px;top:479.01px" class="cls_020"><span class="cls_020">where addr is a symbol defined in the data segment,</span></div>
<div style="position:absolute;left:314.84px;top:489.01px" class="cls_020"><span class="cls_020">‘‘%hi_addr’’ and ‘‘%lo_addr’’ are as described above; that</span></div>
<div style="position:absolute;left:222.54px;top:496.01px" class="cls_020"><span class="cls_020">%lo_addr</span></div>
<div style="position:absolute;left:314.84px;top:499.00px" class="cls_020"><span class="cls_020">is, they are the high and low parts of the value which can</span></div>
<div style="position:absolute;left:314.84px;top:509.00px" class="cls_020"><span class="cls_020">be used in an lui/addui sequence.</span></div>
<div style="position:absolute;left:222.54px;top:526.00px" class="cls_020"><span class="cls_020">%gpoff_addr</span></div>
<div style="position:absolute;left:315.08px;top:526.00px" class="cls_020"><span class="cls_020">the offset in the ‘‘small data’’ segment of an address</span></div>
<div style="position:absolute;left:222.54px;top:543.01px" class="cls_020"><span class="cls_020">$at</span></div>
<div style="position:absolute;left:314.92px;top:543.01px" class="cls_020"><span class="cls_020">register $1, the ‘‘assembler temporary’’ register</span></div>
<div style="position:absolute;left:222.54px;top:560.01px" class="cls_020"><span class="cls_020">$zero</span></div>
<div style="position:absolute;left:314.96px;top:560.01px" class="cls_020"><span class="cls_020">register $0, which always contains a zero value</span></div>
<div style="position:absolute;left:222.54px;top:577.01px" class="cls_020"><span class="cls_020">$ra</span></div>
<div style="position:absolute;left:314.92px;top:577.01px" class="cls_020"><span class="cls_020">the ‘‘return address’’ register $31</span></div>
<div style="position:absolute;left:222.54px;top:594.01px" class="cls_020"><span class="cls_020">RETURN</span></div>
<div style="position:absolute;left:315.01px;top:594.01px" class="cls_020"><span class="cls_020">the point to where control returns to after a subroutine</span></div>
<div style="position:absolute;left:314.85px;top:604.01px" class="cls_020"><span class="cls_020">call; this is the next instruction but one after the branch/</span></div>
<div style="position:absolute;left:314.85px;top:614.01px" class="cls_020"><span class="cls_020">jump to subroutine, and is normally loaded into $ra by</span></div>
<div style="position:absolute;left:314.85px;top:624.01px" class="cls_020"><span class="cls_020">the ‘‘.. and link’’ instructions.</span></div>
<div style="position:absolute;left:222.54px;top:641.01px" class="cls_020"><span class="cls_020">trap(CAUSE, code)</span></div>
<div style="position:absolute;left:315.20px;top:641.01px" class="cls_020"><span class="cls_020">Take a CPU trap; ‘‘CAUSE’’ determines the setting of the</span></div>
<div style="position:absolute;left:314.85px;top:651.01px" class="cls_020"><span class="cls_020">Cause register, and ‘‘code’’ is a value not interpreted by</span></div>
<div style="position:absolute;left:314.85px;top:661.00px" class="cls_020"><span class="cls_020">the hardware, but which system software can obtain by</span></div>
<div style="position:absolute;left:314.85px;top:671.00px" class="cls_020"><span class="cls_020">looking at the trap instruction.</span></div>
<div style="position:absolute;left:314.85px;top:681.00px" class="cls_020"><span class="cls_020">CAUSE values can be BREAK; FPINT (for floating point</span></div>
<div style="position:absolute;left:314.85px;top:691.00px" class="cls_020"><span class="cls_020">exception); SYSCALL.</span></div>
<div style="position:absolute;left:264.85px;top:710.00px" class="cls_020"><span class="cls_020">Table 9.1: Assembler register and identifier conventions</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">9–19</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:101854px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:376.95px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:73.17px;top:56.98px" class="cls_020"><span class="cls_020">Word</span></div>
<div style="position:absolute;left:243.10px;top:56.98px" class="cls_020"><span class="cls_020">Used for</span></div>
<div style="position:absolute;left:42.54px;top:76.00px" class="cls_020"><span class="cls_020">unordered(fs,ft)</span></div>
<div style="position:absolute;left:135.14px;top:76.00px" class="cls_020"><span class="cls_020">some exceptional floating point values cannot be sensibly</span></div>
<div style="position:absolute;left:134.84px;top:86.00px" class="cls_020"><span class="cls_020">compared; it is not sensible to ask whether one NaN is</span></div>
<div style="position:absolute;left:134.84px;top:96.00px" class="cls_020"><span class="cls_020">bigger than another (NaN, ‘‘not a number’’, is produced</span></div>
<div style="position:absolute;left:134.84px;top:106.00px" class="cls_020"><span class="cls_020">when the result of an operation is not defined). The</span></div>
<div style="position:absolute;left:134.84px;top:116.00px" class="cls_020"><span class="cls_020">IEEE754 standard requires that for such a pair that ‘‘fs</span></div>
<div style="position:absolute;left:134.84px;top:125.99px" class="cls_020"><span class="cls_020">&lt;ft’’, ‘‘fs == ft’’ and ‘‘fs > ft’’ shall all be false.</span></div>
<div style="position:absolute;left:134.84px;top:135.99px" class="cls_020"><span class="cls_020">‘‘unordered(fs,ft)’’ returns true for an unordered pair, false</span></div>
<div style="position:absolute;left:134.84px;top:145.99px" class="cls_020"><span class="cls_020">otherwise.</span></div>
<div style="position:absolute;left:42.54px;top:162.99px" class="cls_020"><span class="cls_020">fpcond</span></div>
<div style="position:absolute;left:134.98px;top:162.99px" class="cls_020"><span class="cls_020">the floating point ‘‘condition bit’’ found in the FP control/</span></div>
<div style="position:absolute;left:134.84px;top:172.99px" class="cls_020"><span class="cls_020">status register, and tested by the bc1f and bc0t</span></div>
<div style="position:absolute;left:134.84px;top:182.99px" class="cls_020"><span class="cls_020">instructions.</span></div>
<div style="position:absolute;left:84.85px;top:201.98px" class="cls_020"><span class="cls_020">Table 9.1: Assembler register and identifier conventions</span></div>
<div style="position:absolute;left:48.90px;top:238.99px" class="cls_020"><span class="cls_020">Assembler</span></div>
<div style="position:absolute;left:129.95px;top:238.99px" class="cls_020"><span class="cls_020">Expands To</span></div>
<div style="position:absolute;left:271.17px;top:238.99px" class="cls_020"><span class="cls_020">What it does</span></div>
<div style="position:absolute;left:40.00px;top:257.99px" class="cls_020"><span class="cls_020">move rd,rs</span></div>
<div style="position:absolute;left:113.70px;top:257.99px" class="cls_020"><span class="cls_020">addu rd,rs,$zero</span></div>
<div style="position:absolute;left:208.40px;top:257.99px" class="cls_020"><span class="cls_020">rd = rs;</span></div>
<div style="position:absolute;left:40.00px;top:274.99px" class="cls_020"><span class="cls_020">Branch (PC-relative, all conditional)</span></div>
<div style="position:absolute;left:40.00px;top:291.99px" class="cls_020"><span class="cls_020">b label</span></div>
<div style="position:absolute;left:113.63px;top:291.99px" class="cls_020"><span class="cls_020">beq</span></div>
<div style="position:absolute;left:207.87px;top:291.99px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:113.50px;top:301.99px" class="cls_020"><span class="cls_020">$zero,$zero,label</span></div>
<div style="position:absolute;left:40.00px;top:318.99px" class="cls_020"><span class="cls_020">beq rs,rt,label</span></div>
<div style="position:absolute;left:208.14px;top:318.99px" class="cls_020"><span class="cls_020">if (rs == rt) goto label;</span></div>
<div style="position:absolute;left:40.00px;top:335.99px" class="cls_020"><span class="cls_020">bge rs,rt,label</span></div>
<div style="position:absolute;left:113.76px;top:335.99px" class="cls_020"><span class="cls_020">slt $at,rs,rt</span></div>
<div style="position:absolute;left:207.87px;top:335.99px" class="cls_020"><span class="cls_020">if ((signed) rs >= (signed) rt)</span></div>
<div style="position:absolute;left:113.50px;top:345.99px" class="cls_020"><span class="cls_020">beq $at,$zero,label</span></div>
<div style="position:absolute;left:210.75px;top:345.99px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:40.00px;top:372.99px" class="cls_020"><span class="cls_020">bgeu</span></div>
<div style="position:absolute;left:113.50px;top:372.99px" class="cls_020"><span class="cls_020">sltu $at,rs,rt</span></div>
<div style="position:absolute;left:207.87px;top:372.99px" class="cls_020"><span class="cls_020">if ((unsigned) rs >= (unsigned) rt)</span></div>
<div style="position:absolute;left:40.00px;top:382.99px" class="cls_020"><span class="cls_020">rs,rt,label</span></div>
<div style="position:absolute;left:113.50px;top:382.99px" class="cls_020"><span class="cls_020">beq $at,$zero,label</span></div>
<div style="position:absolute;left:210.75px;top:382.99px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:40.00px;top:409.99px" class="cls_020"><span class="cls_020">bgt rs,rt,label</span></div>
<div style="position:absolute;left:113.76px;top:409.99px" class="cls_020"><span class="cls_020">slt $at,rt,rs</span></div>
<div style="position:absolute;left:207.87px;top:409.99px" class="cls_020"><span class="cls_020">if ((signed) rs > (signed) rt)</span></div>
<div style="position:absolute;left:113.50px;top:419.99px" class="cls_020"><span class="cls_020">bne $at,$zero,label</span></div>
<div style="position:absolute;left:210.75px;top:419.99px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:40.00px;top:446.99px" class="cls_020"><span class="cls_020">bgtu rs,rt,label</span></div>
<div style="position:absolute;left:113.79px;top:446.99px" class="cls_020"><span class="cls_020">slt $at,rt,rs</span></div>
<div style="position:absolute;left:207.87px;top:446.99px" class="cls_020"><span class="cls_020">if ((unsigned) rs > (unsigned) rt)</span></div>
<div style="position:absolute;left:113.50px;top:456.99px" class="cls_020"><span class="cls_020">beq $at,$zero,label</span></div>
<div style="position:absolute;left:210.75px;top:456.99px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:40.00px;top:483.99px" class="cls_020"><span class="cls_020">ble rs,rt,label</span></div>
<div style="position:absolute;left:113.76px;top:483.99px" class="cls_020"><span class="cls_020">sltu $at,rt,rs</span></div>
<div style="position:absolute;left:207.87px;top:483.99px" class="cls_020"><span class="cls_020">if ((signed) rs &lt;= (signed) rt)</span></div>
<div style="position:absolute;left:113.50px;top:493.99px" class="cls_020"><span class="cls_020">beq $at,$zero,label</span></div>
<div style="position:absolute;left:210.75px;top:493.99px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:40.00px;top:520.99px" class="cls_020"><span class="cls_020">bleu rs,rt,label</span></div>
<div style="position:absolute;left:113.79px;top:520.99px" class="cls_020"><span class="cls_020">sltu $at,rt,rs</span></div>
<div style="position:absolute;left:207.87px;top:520.99px" class="cls_020"><span class="cls_020">if ((unsigned) rs &lt;= (unsigned) rt)</span></div>
<div style="position:absolute;left:113.50px;top:530.99px" class="cls_020"><span class="cls_020">beq $at,$zero,label</span></div>
<div style="position:absolute;left:210.75px;top:530.99px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:40.00px;top:557.99px" class="cls_020"><span class="cls_020">blt rs,rt,label</span></div>
<div style="position:absolute;left:113.75px;top:557.99px" class="cls_020"><span class="cls_020">slt $at,rs,rt</span></div>
<div style="position:absolute;left:207.87px;top:557.99px" class="cls_020"><span class="cls_020">if ((signed) rs &lt;(signed) rt)</span></div>
<div style="position:absolute;left:113.50px;top:567.98px" class="cls_020"><span class="cls_020">bne $at,$zero,label</span></div>
<div style="position:absolute;left:210.75px;top:567.98px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:40.00px;top:594.98px" class="cls_020"><span class="cls_020">bltu rs,rt,label</span></div>
<div style="position:absolute;left:113.79px;top:594.98px" class="cls_020"><span class="cls_020">sltu $at,rs,rt</span></div>
<div style="position:absolute;left:207.87px;top:594.98px" class="cls_020"><span class="cls_020">if ((unsigned) rs &lt;(unsigned) rt)</span></div>
<div style="position:absolute;left:113.50px;top:604.98px" class="cls_020"><span class="cls_020">bne $at,$zero,label</span></div>
<div style="position:absolute;left:210.75px;top:604.98px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:40.00px;top:631.98px" class="cls_020"><span class="cls_020">bne rs,rt,label</span></div>
<div style="position:absolute;left:208.15px;top:631.98px" class="cls_020"><span class="cls_020">if (rs != rt) goto label;</span></div>
<div style="position:absolute;left:40.00px;top:648.98px" class="cls_020"><span class="cls_020">beqz rs,label</span></div>
<div style="position:absolute;left:113.74px;top:648.98px" class="cls_020"><span class="cls_020">beq rs,$zero,label</span></div>
<div style="position:absolute;left:208.45px;top:648.98px" class="cls_020"><span class="cls_020">if (rs == 0) goto label;</span></div>
<div style="position:absolute;left:40.00px;top:665.99px" class="cls_020"><span class="cls_020">bgez rs,label</span></div>
<div style="position:absolute;left:208.11px;top:665.99px" class="cls_020"><span class="cls_020">if ((signed) rs >= 0) goto label;</span></div>
<div style="position:absolute;left:40.00px;top:682.99px" class="cls_020"><span class="cls_020">bgtz rs,label</span></div>
<div style="position:absolute;left:208.11px;top:682.99px" class="cls_020"><span class="cls_020">if ((signed) rs > 0) goto label;</span></div>
<div style="position:absolute;left:40.00px;top:699.99px" class="cls_020"><span class="cls_020">blez rs,label</span></div>
<div style="position:absolute;left:208.10px;top:699.99px" class="cls_020"><span class="cls_020">if ((signed) rs &lt;= 0) goto label;</span></div>
<div style="position:absolute;left:137.69px;top:718.99px" class="cls_020"><span class="cls_020">Table 9.2: Assembler instructions</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">9–20</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:102656px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:525.20px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:228.90px;top:57.00px" class="cls_020"><span class="cls_020">Assembler</span></div>
<div style="position:absolute;left:309.95px;top:57.00px" class="cls_020"><span class="cls_020">Expands To</span></div>
<div style="position:absolute;left:451.17px;top:57.00px" class="cls_020"><span class="cls_020">What it does</span></div>
<div style="position:absolute;left:220.00px;top:76.00px" class="cls_020"><span class="cls_020">bltz rs,label</span></div>
<div style="position:absolute;left:388.10px;top:76.00px" class="cls_020"><span class="cls_020">if ((signed) rs &lt;0) goto label;</span></div>
<div style="position:absolute;left:220.00px;top:93.00px" class="cls_020"><span class="cls_020">bnez rs,label</span></div>
<div style="position:absolute;left:293.74px;top:93.00px" class="cls_020"><span class="cls_020">bne rs,$zero,label</span></div>
<div style="position:absolute;left:388.46px;top:93.00px" class="cls_020"><span class="cls_020">if (rs != 0) goto label;</span></div>
<div style="position:absolute;left:220.00px;top:110.00px" class="cls_020"><span class="cls_020">bal label</span></div>
<div style="position:absolute;left:293.67px;top:110.00px" class="cls_020"><span class="cls_020">bgezal $zero,label</span></div>
<div style="position:absolute;left:388.39px;top:110.00px" class="cls_020"><span class="cls_020">ra = RETURN;</span></div>
<div style="position:absolute;left:387.87px;top:120.00px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:220.00px;top:147.00px" class="cls_020"><span class="cls_020">bgezal rs,label</span></div>
<div style="position:absolute;left:388.15px;top:147.00px" class="cls_020"><span class="cls_020">if ((signed) rs >= 0) {</span></div>
<div style="position:absolute;left:390.75px;top:157.00px" class="cls_020"><span class="cls_020">ra = RETURN;</span></div>
<div style="position:absolute;left:390.75px;top:167.00px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:387.87px;top:177.00px" class="cls_020"><span class="cls_020">}</span></div>
<div style="position:absolute;left:220.00px;top:204.00px" class="cls_020"><span class="cls_020">bltzal rs,label</span></div>
<div style="position:absolute;left:388.13px;top:204.00px" class="cls_020"><span class="cls_020">if ((signed) rs &lt;0) {</span></div>
<div style="position:absolute;left:390.75px;top:214.00px" class="cls_020"><span class="cls_020">ra = RETURN;</span></div>
<div style="position:absolute;left:390.75px;top:224.00px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:387.87px;top:233.99px" class="cls_020"><span class="cls_020">}</span></div>
<div style="position:absolute;left:220.00px;top:260.99px" class="cls_020"><span class="cls_020">Unary arithmetic/logic instructions</span></div>
<div style="position:absolute;left:220.00px;top:278.00px" class="cls_020"><span class="cls_020">abs rd,rs</span></div>
<div style="position:absolute;left:293.67px;top:278.00px" class="cls_020"><span class="cls_020">sra $at,rs,31</span></div>
<div style="position:absolute;left:387.87px;top:278.00px" class="cls_020"><span class="cls_020">rd = rs &lt;0 ? -rs: rs;</span></div>
<div style="position:absolute;left:293.49px;top:287.99px" class="cls_020"><span class="cls_020">xor rd,rs,$at</span></div>
<div style="position:absolute;left:293.49px;top:297.99px" class="cls_020"><span class="cls_020">sub rd,rd,$at</span></div>
<div style="position:absolute;left:220.00px;top:324.99px" class="cls_020"><span class="cls_020">abs rd</span></div>
<div style="position:absolute;left:293.62px;top:324.99px" class="cls_020"><span class="cls_020">sra $at,rd,31</span></div>
<div style="position:absolute;left:387.87px;top:324.99px" class="cls_020"><span class="cls_020">rd = rd &lt;0 ? -rd: rd;</span></div>
<div style="position:absolute;left:293.49px;top:334.99px" class="cls_020"><span class="cls_020">xor rd,rd,$at</span></div>
<div style="position:absolute;left:293.49px;top:344.99px" class="cls_020"><span class="cls_020">sub rd,rd,$at</span></div>
<div style="position:absolute;left:220.00px;top:371.99px" class="cls_020"><span class="cls_020">neg rd,rs</span></div>
<div style="position:absolute;left:293.67px;top:371.99px" class="cls_020"><span class="cls_020">sub rd,$zero,rs</span></div>
<div style="position:absolute;left:388.35px;top:371.99px" class="cls_020"><span class="cls_020">rd = -rs; /* trap on overflow */</span></div>
<div style="position:absolute;left:220.00px;top:388.99px" class="cls_020"><span class="cls_020">neg rd</span></div>
<div style="position:absolute;left:293.62px;top:388.99px" class="cls_020"><span class="cls_020">sub rd,$zero,rd</span></div>
<div style="position:absolute;left:388.30px;top:388.99px" class="cls_020"><span class="cls_020">rd = -rd; /* trap on overflow */</span></div>
<div style="position:absolute;left:220.00px;top:405.99px" class="cls_020"><span class="cls_020">negu rd,rs</span></div>
<div style="position:absolute;left:293.69px;top:405.99px" class="cls_020"><span class="cls_020">subu rd,$zero,rs</span></div>
<div style="position:absolute;left:388.39px;top:405.99px" class="cls_020"><span class="cls_020">rd = -rs; /* no trap */</span></div>
<div style="position:absolute;left:220.00px;top:422.99px" class="cls_020"><span class="cls_020">negu rd</span></div>
<div style="position:absolute;left:293.65px;top:422.99px" class="cls_020"><span class="cls_020">subu rd,$zero,rd</span></div>
<div style="position:absolute;left:388.35px;top:422.99px" class="cls_020"><span class="cls_020">rd = -rd; /* no trap */</span></div>
<div style="position:absolute;left:220.00px;top:440.00px" class="cls_020"><span class="cls_020">not rd,rs</span></div>
<div style="position:absolute;left:293.67px;top:440.00px" class="cls_020"><span class="cls_020">nor rd,rs,$zero</span></div>
<div style="position:absolute;left:388.34px;top:440.00px" class="cls_020"><span class="cls_020">rd = ~rs;</span></div>
<div style="position:absolute;left:220.00px;top:457.00px" class="cls_020"><span class="cls_020">not rd</span></div>
<div style="position:absolute;left:293.62px;top:457.00px" class="cls_020"><span class="cls_020">nor rd,rd,$zero</span></div>
<div style="position:absolute;left:388.29px;top:457.00px" class="cls_020"><span class="cls_020">rd = ~rd;</span></div>
<div style="position:absolute;left:220.00px;top:474.00px" class="cls_020"><span class="cls_020">Binary arithmetic/logical operations</span></div>
<div style="position:absolute;left:220.00px;top:491.00px" class="cls_020"><span class="cls_020">add rd,rs,rt</span></div>
<div style="position:absolute;left:388.09px;top:491.00px" class="cls_020"><span class="cls_020">rd = rs + rt; /* trap on overflow */</span></div>
<div style="position:absolute;left:220.00px;top:508.00px" class="cls_020"><span class="cls_020">add rd,rs</span></div>
<div style="position:absolute;left:293.67px;top:508.00px" class="cls_020"><span class="cls_020">add rd,rd,rs</span></div>
<div style="position:absolute;left:388.29px;top:508.00px" class="cls_020"><span class="cls_020">rd += rs; /* trap on overflow */</span></div>
<div style="position:absolute;left:220.00px;top:525.00px" class="cls_020"><span class="cls_020">addu rd,rs,rt</span></div>
<div style="position:absolute;left:388.12px;top:525.00px" class="cls_020"><span class="cls_020">rd = rs + rt; /* no trap on overflow */</span></div>
<div style="position:absolute;left:220.00px;top:542.00px" class="cls_020"><span class="cls_020">addu rd,rs</span></div>
<div style="position:absolute;left:388.08px;top:542.00px" class="cls_020"><span class="cls_020">rd += rs; /* no trap on overflow */</span></div>
<div style="position:absolute;left:220.00px;top:559.00px" class="cls_020"><span class="cls_020">and rd,rs,rt</span></div>
<div style="position:absolute;left:388.09px;top:559.00px" class="cls_020"><span class="cls_020">rd = rs & rt;</span></div>
<div style="position:absolute;left:220.00px;top:576.00px" class="cls_020"><span class="cls_020">and rd,rs</span></div>
<div style="position:absolute;left:293.67px;top:576.00px" class="cls_020"><span class="cls_020">and rd,rd,rs</span></div>
<div style="position:absolute;left:388.29px;top:576.00px" class="cls_020"><span class="cls_020">rd &= rs;</span></div>
<div style="position:absolute;left:317.68px;top:595.00px" class="cls_020"><span class="cls_020">Table 9.2: Assembler instructions</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">9–21</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:103458px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:376.95px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:48.90px;top:56.96px" class="cls_020"><span class="cls_020">Assembler</span></div>
<div style="position:absolute;left:129.95px;top:56.96px" class="cls_020"><span class="cls_020">Expands To</span></div>
<div style="position:absolute;left:271.17px;top:56.96px" class="cls_020"><span class="cls_020">What it does</span></div>
<div style="position:absolute;left:40.00px;top:76.00px" class="cls_020"><span class="cls_020">div rd,rs,rt</span></div>
<div style="position:absolute;left:116.58px;top:76.00px" class="cls_020"><span class="cls_020">div rs,rt</span></div>
<div style="position:absolute;left:207.87px;top:75.99px" class="cls_020"><span class="cls_020">rd = rs/rt;</span></div>
<div style="position:absolute;left:116.37px;top:86.00px" class="cls_020"><span class="cls_020">bne rt,$zero,1f</span></div>
<div style="position:absolute;left:116.37px;top:96.00px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:116.37px;top:106.00px" class="cls_020"><span class="cls_020">break 7</span></div>
<div style="position:absolute;left:207.87px;top:105.99px" class="cls_020"><span class="cls_020">/* trap divide by zero */</span></div>
<div style="position:absolute;left:113.49px;top:116.00px" class="cls_020"><span class="cls_020">1:</span></div>
<div style="position:absolute;left:116.37px;top:125.99px" class="cls_020"><span class="cls_020">li $at,-1</span></div>
<div style="position:absolute;left:116.37px;top:135.99px" class="cls_020"><span class="cls_020">bne rt,$at,2f</span></div>
<div style="position:absolute;left:116.37px;top:145.99px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:116.37px;top:155.99px" class="cls_020"><span class="cls_020">lui $at,0x8000</span></div>
<div style="position:absolute;left:116.37px;top:165.99px" class="cls_020"><span class="cls_020">bne rs,$at,2f</span></div>
<div style="position:absolute;left:116.37px;top:175.99px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:116.37px;top:185.99px" class="cls_020"><span class="cls_020">break 6</span></div>
<div style="position:absolute;left:207.87px;top:185.98px" class="cls_020"><span class="cls_020">/* trap overflow conditions */</span></div>
<div style="position:absolute;left:113.49px;top:195.99px" class="cls_020"><span class="cls_020">2:</span></div>
<div style="position:absolute;left:116.37px;top:205.99px" class="cls_020"><span class="cls_020">mflo rd</span></div>
<div style="position:absolute;left:40.00px;top:232.98px" class="cls_020"><span class="cls_020">div rd,rs</span></div>
<div style="position:absolute;left:113.66px;top:232.98px" class="cls_020"><span class="cls_020">as above</span></div>
<div style="position:absolute;left:207.87px;top:232.98px" class="cls_020"><span class="cls_020">rd = rd/rt; /* trap on errors */</span></div>
<div style="position:absolute;left:40.00px;top:249.98px" class="cls_020"><span class="cls_020">divu rd,rs,rt</span></div>
<div style="position:absolute;left:116.61px;top:249.98px" class="cls_020"><span class="cls_020">divu rs,rt</span></div>
<div style="position:absolute;left:116.37px;top:259.98px" class="cls_020"><span class="cls_020">bne rt,$zero,1f</span></div>
<div style="position:absolute;left:207.87px;top:259.97px" class="cls_020"><span class="cls_020">rd = rs/rt;</span></div>
<div style="position:absolute;left:116.37px;top:269.98px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:116.37px;top:279.98px" class="cls_020"><span class="cls_020">break 7</span></div>
<div style="position:absolute;left:113.49px;top:289.98px" class="cls_020"><span class="cls_020">1:</span></div>
<div style="position:absolute;left:207.87px;top:289.97px" class="cls_020"><span class="cls_020">/* trap on divide by zero */</span></div>
<div style="position:absolute;left:116.37px;top:299.97px" class="cls_020"><span class="cls_020">mflo rd</span></div>
<div style="position:absolute;left:207.87px;top:309.96px" class="cls_020"><span class="cls_020">/* no check for overflow */</span></div>
<div style="position:absolute;left:40.00px;top:336.96px" class="cls_020"><span class="cls_020">or rd,rs,rt</span></div>
<div style="position:absolute;left:208.07px;top:336.96px" class="cls_020"><span class="cls_020">rd = rs | rt;</span></div>
<div style="position:absolute;left:40.00px;top:353.96px" class="cls_020"><span class="cls_020">mul rd,rs,rt</span></div>
<div style="position:absolute;left:113.72px;top:353.96px" class="cls_020"><span class="cls_020">multu rs,rt</span></div>
<div style="position:absolute;left:207.87px;top:353.96px" class="cls_020"><span class="cls_020">rd = rs*rt; /* no checks */</span></div>
<div style="position:absolute;left:113.49px;top:363.96px" class="cls_020"><span class="cls_020">mflo rd</span></div>
<div style="position:absolute;left:40.00px;top:390.96px" class="cls_020"><span class="cls_020">mulo rd,rs,rt</span></div>
<div style="position:absolute;left:116.62px;top:390.96px" class="cls_020"><span class="cls_020">mult rs,rt</span></div>
<div style="position:absolute;left:207.87px;top:390.95px" class="cls_020"><span class="cls_020">rd = rs * rt; /* signed */</span></div>
<div style="position:absolute;left:116.37px;top:400.96px" class="cls_020"><span class="cls_020">mfhi rd</span></div>
<div style="position:absolute;left:116.37px;top:410.96px" class="cls_020"><span class="cls_020">sra rd,rd,31</span></div>
<div style="position:absolute;left:116.37px;top:420.96px" class="cls_020"><span class="cls_020">mflo $at</span></div>
<div style="position:absolute;left:116.37px;top:430.96px" class="cls_020"><span class="cls_020">beq rd,$at,1f</span></div>
<div style="position:absolute;left:116.37px;top:440.96px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:116.37px;top:450.96px" class="cls_020"><span class="cls_020">break 6</span></div>
<div style="position:absolute;left:207.87px;top:450.96px" class="cls_020"><span class="cls_020">/* trap on overflow */</span></div>
<div style="position:absolute;left:113.49px;top:460.96px" class="cls_020"><span class="cls_020">1:</span></div>
<div style="position:absolute;left:116.37px;top:470.96px" class="cls_020"><span class="cls_020">mflo rd</span></div>
<div style="position:absolute;left:40.00px;top:487.96px" class="cls_020"><span class="cls_020">mulou rd,rs,rt</span></div>
<div style="position:absolute;left:116.64px;top:487.96px" class="cls_020"><span class="cls_020">multu rs,rt</span></div>
<div style="position:absolute;left:207.87px;top:487.95px" class="cls_020"><span class="cls_020">rd = (unsigned) rs * rt;</span></div>
<div style="position:absolute;left:116.37px;top:497.96px" class="cls_020"><span class="cls_020">mfhi $at</span></div>
<div style="position:absolute;left:116.37px;top:507.96px" class="cls_020"><span class="cls_020">mflo rd</span></div>
<div style="position:absolute;left:116.37px;top:517.95px" class="cls_020"><span class="cls_020">beq $at,$zero,1f</span></div>
<div style="position:absolute;left:116.37px;top:527.95px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:116.37px;top:537.95px" class="cls_020"><span class="cls_020">break 6</span></div>
<div style="position:absolute;left:207.87px;top:537.95px" class="cls_020"><span class="cls_020">/* trap on overflow */</span></div>
<div style="position:absolute;left:113.49px;top:547.95px" class="cls_020"><span class="cls_020">1:</span></div>
<div style="position:absolute;left:40.00px;top:564.95px" class="cls_020"><span class="cls_020">nor rd,rs,rt</span></div>
<div style="position:absolute;left:208.08px;top:564.95px" class="cls_020"><span class="cls_020">rd = ~(rs | rt);</span></div>
<div style="position:absolute;left:137.68px;top:583.96px" class="cls_020"><span class="cls_020">Table 9.2: Assembler instructions</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">9–22</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:104260px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:525.20px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:228.90px;top:56.96px" class="cls_020"><span class="cls_020">Assembler</span></div>
<div style="position:absolute;left:309.95px;top:56.96px" class="cls_020"><span class="cls_020">Expands To</span></div>
<div style="position:absolute;left:451.17px;top:56.96px" class="cls_020"><span class="cls_020">What it does</span></div>
<div style="position:absolute;left:220.00px;top:76.00px" class="cls_020"><span class="cls_020">rem rd,rs,rt</span></div>
<div style="position:absolute;left:296.60px;top:76.00px" class="cls_020"><span class="cls_020">div rs,rt</span></div>
<div style="position:absolute;left:387.87px;top:75.99px" class="cls_020"><span class="cls_020">rd = rs%rt;</span></div>
<div style="position:absolute;left:296.37px;top:86.00px" class="cls_020"><span class="cls_020">bne rt,$zero,1f</span></div>
<div style="position:absolute;left:296.37px;top:96.00px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:296.37px;top:106.00px" class="cls_020"><span class="cls_020">break 7</span></div>
<div style="position:absolute;left:387.87px;top:105.99px" class="cls_020"><span class="cls_020">/* trap if rt == 0 */</span></div>
<div style="position:absolute;left:293.49px;top:116.00px" class="cls_020"><span class="cls_020">1:</span></div>
<div style="position:absolute;left:296.37px;top:125.99px" class="cls_020"><span class="cls_020">li $at,-1</span></div>
<div style="position:absolute;left:296.37px;top:135.99px" class="cls_020"><span class="cls_020">bne rt,$at,2f</span></div>
<div style="position:absolute;left:296.37px;top:145.99px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:296.37px;top:155.99px" class="cls_020"><span class="cls_020">lui $at,0x8000</span></div>
<div style="position:absolute;left:296.37px;top:165.99px" class="cls_020"><span class="cls_020">bne rs,$at,2f</span></div>
<div style="position:absolute;left:296.37px;top:175.99px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:296.37px;top:185.99px" class="cls_020"><span class="cls_020">break 6</span></div>
<div style="position:absolute;left:387.87px;top:185.99px" class="cls_020"><span class="cls_020">/* trap if it will overflow */</span></div>
<div style="position:absolute;left:293.49px;top:195.99px" class="cls_020"><span class="cls_020">2:</span></div>
<div style="position:absolute;left:296.37px;top:205.99px" class="cls_020"><span class="cls_020">mfhi rd</span></div>
<div style="position:absolute;left:220.00px;top:232.99px" class="cls_020"><span class="cls_020">remu rd,rs,rt</span></div>
<div style="position:absolute;left:296.63px;top:232.99px" class="cls_020"><span class="cls_020">divu rs,rt</span></div>
<div style="position:absolute;left:387.87px;top:232.98px" class="cls_020"><span class="cls_020">/* unsigned operation, ignore overflow */</span></div>
<div style="position:absolute;left:296.37px;top:242.99px" class="cls_020"><span class="cls_020">bne rt,$zero,1f</span></div>
<div style="position:absolute;left:387.87px;top:242.98px" class="cls_020"><span class="cls_020">rd = rs%rt;</span></div>
<div style="position:absolute;left:296.37px;top:252.98px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:296.37px;top:262.98px" class="cls_020"><span class="cls_020">break 7</span></div>
<div style="position:absolute;left:387.87px;top:262.98px" class="cls_020"><span class="cls_020">/* trap if rt == 0 */</span></div>
<div style="position:absolute;left:293.49px;top:272.98px" class="cls_020"><span class="cls_020">1:</span></div>
<div style="position:absolute;left:296.37px;top:282.98px" class="cls_020"><span class="cls_020">mfhi rd</span></div>
<div style="position:absolute;left:220.00px;top:309.97px" class="cls_020"><span class="cls_020">rol rd,rs,rt</span></div>
<div style="position:absolute;left:296.58px;top:309.97px" class="cls_020"><span class="cls_020">negu $at,rt</span></div>
<div style="position:absolute;left:387.87px;top:309.97px" class="cls_020"><span class="cls_020">/* rd = rs rotated left by rt */</span></div>
<div style="position:absolute;left:296.37px;top:319.97px" class="cls_020"><span class="cls_020">srlv $at,rs,$at</span></div>
<div style="position:absolute;left:296.37px;top:329.97px" class="cls_020"><span class="cls_020">sllv rd,rs,rt</span></div>
<div style="position:absolute;left:296.37px;top:339.97px" class="cls_020"><span class="cls_020">or rd,rd,$at</span></div>
<div style="position:absolute;left:220.00px;top:366.97px" class="cls_020"><span class="cls_020">ror rd,rs,rt</span></div>
<div style="position:absolute;left:296.58px;top:366.97px" class="cls_020"><span class="cls_020">negu $at,rt</span></div>
<div style="position:absolute;left:387.87px;top:366.97px" class="cls_020"><span class="cls_020">/* rd = rs rotated right by rt */</span></div>
<div style="position:absolute;left:296.37px;top:376.97px" class="cls_020"><span class="cls_020">sllv $at,rs,$at</span></div>
<div style="position:absolute;left:296.37px;top:386.97px" class="cls_020"><span class="cls_020">srlv rd,rs,rt</span></div>
<div style="position:absolute;left:296.37px;top:396.97px" class="cls_020"><span class="cls_020">or rd,rd,$at</span></div>
<div style="position:absolute;left:220.00px;top:423.97px" class="cls_020"><span class="cls_020">seq rd,rs,rt</span></div>
<div style="position:absolute;left:296.59px;top:423.97px" class="cls_020"><span class="cls_020">xor rd,rs,rt</span></div>
<div style="position:absolute;left:387.87px;top:423.97px" class="cls_020"><span class="cls_020">rd = (rs == rt) ? 1: 0;</span></div>
<div style="position:absolute;left:296.37px;top:433.97px" class="cls_020"><span class="cls_020">sltiu rd,rd,1</span></div>
<div style="position:absolute;left:220.00px;top:460.97px" class="cls_020"><span class="cls_020">sge rd,rs,rt</span></div>
<div style="position:absolute;left:296.59px;top:460.97px" class="cls_020"><span class="cls_020">slt rd,rs,rt</span></div>
<div style="position:absolute;left:387.87px;top:460.97px" class="cls_020"><span class="cls_020">rd = ((signed)rs >= (signed)rt) ? 1: 0;</span></div>
<div style="position:absolute;left:296.37px;top:470.96px" class="cls_020"><span class="cls_020">xori rd,rd,1</span></div>
<div style="position:absolute;left:220.00px;top:497.96px" class="cls_020"><span class="cls_020">sgeu rd,rs,rt</span></div>
<div style="position:absolute;left:296.62px;top:497.96px" class="cls_020"><span class="cls_020">sltu rd,rs,rt</span></div>
<div style="position:absolute;left:387.87px;top:497.96px" class="cls_020"><span class="cls_020">rd = ((unsigned)rs >= (unsigned)rt) ? 1: 0;</span></div>
<div style="position:absolute;left:296.37px;top:507.96px" class="cls_020"><span class="cls_020">xori rd,rd,1</span></div>
<div style="position:absolute;left:220.00px;top:534.96px" class="cls_020"><span class="cls_020">sgt rd,rs,rt</span></div>
<div style="position:absolute;left:296.58px;top:534.96px" class="cls_020"><span class="cls_020">slt rd,rt,rs</span></div>
<div style="position:absolute;left:388.30px;top:534.96px" class="cls_020"><span class="cls_020">rd = ((signed)rs > (signed)rt) ? 1: 0;</span></div>
<div style="position:absolute;left:220.00px;top:551.97px" class="cls_020"><span class="cls_020">sgtu rd,rs,rt</span></div>
<div style="position:absolute;left:296.61px;top:551.97px" class="cls_020"><span class="cls_020">sltu rd,rt,rs</span></div>
<div style="position:absolute;left:388.35px;top:551.97px" class="cls_020"><span class="cls_020">rd = ((unsigned)rs > (unsigned)rt) ? 1: 0;</span></div>
<div style="position:absolute;left:220.00px;top:568.97px" class="cls_020"><span class="cls_020">sle rd,rs,rt</span></div>
<div style="position:absolute;left:296.58px;top:568.97px" class="cls_020"><span class="cls_020">slt rd,rt,rs</span></div>
<div style="position:absolute;left:387.87px;top:568.97px" class="cls_020"><span class="cls_020">rd = ((signed)rs &lt;= (signed)rt) ? 1: 0;</span></div>
<div style="position:absolute;left:296.37px;top:578.97px" class="cls_020"><span class="cls_020">xori rd,rd,1</span></div>
<div style="position:absolute;left:220.00px;top:605.97px" class="cls_020"><span class="cls_020">sleu rd,rs,rt</span></div>
<div style="position:absolute;left:296.61px;top:605.97px" class="cls_020"><span class="cls_020">sltu rd,rt,rs</span></div>
<div style="position:absolute;left:387.87px;top:605.97px" class="cls_020"><span class="cls_020">rd = ((unsigned)rs &lt;= (unsigned)rt) ? 1: 0;</span></div>
<div style="position:absolute;left:296.37px;top:615.96px" class="cls_020"><span class="cls_020">xori rd,rd,1</span></div>
<div style="position:absolute;left:220.00px;top:642.96px" class="cls_020"><span class="cls_020">slt rd,rs,rt</span></div>
<div style="position:absolute;left:388.08px;top:642.96px" class="cls_020"><span class="cls_020">rd = ((signed)rs &lt;(signed)rt) ? 1: 0;</span></div>
<div style="position:absolute;left:220.00px;top:659.97px" class="cls_020"><span class="cls_020">sltu rd,rs,rt</span></div>
<div style="position:absolute;left:296.60px;top:659.97px" class="cls_020"><span class="cls_020">sltu rd,rs,rt</span></div>
<div style="position:absolute;left:387.87px;top:659.97px" class="cls_020"><span class="cls_020">rd = ((unsigned)rs &lt;(unsigned)rt) ? 1: 0;</span></div>
<div style="position:absolute;left:296.37px;top:669.96px" class="cls_020"><span class="cls_020">xor rd,rs,rt</span></div>
<div style="position:absolute;left:220.00px;top:696.96px" class="cls_020"><span class="cls_020">sne rd,rs,rt</span></div>
<div style="position:absolute;left:296.59px;top:696.96px" class="cls_020"><span class="cls_020">sltu rd,$zero,rd</span></div>
<div style="position:absolute;left:388.41px;top:696.96px" class="cls_020"><span class="cls_020">rd = (rs == rt) ? 1: 0;</span></div>
<div style="position:absolute;left:317.68px;top:715.96px" class="cls_020"><span class="cls_020">Table 9.2: Assembler instructions</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">9–23</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:105062px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:376.95px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:48.90px;top:56.99px" class="cls_020"><span class="cls_020">Assembler</span></div>
<div style="position:absolute;left:129.95px;top:56.99px" class="cls_020"><span class="cls_020">Expands To</span></div>
<div style="position:absolute;left:271.17px;top:56.99px" class="cls_020"><span class="cls_020">What it does</span></div>
<div style="position:absolute;left:40.00px;top:76.00px" class="cls_020"><span class="cls_020">sll rd,rs,rt</span></div>
<div style="position:absolute;left:116.57px;top:76.00px" class="cls_020"><span class="cls_020">sllv rd,rs,rt</span></div>
<div style="position:absolute;left:208.31px;top:76.00px" class="cls_020"><span class="cls_020">rd = rs &lt;&lt;rt;</span></div>
<div style="position:absolute;left:40.00px;top:93.00px" class="cls_020"><span class="cls_020">sra rd,rs,rt</span></div>
<div style="position:absolute;left:116.59px;top:93.00px" class="cls_020"><span class="cls_020">srav rd,rs,rt</span></div>
<div style="position:absolute;left:208.34px;top:93.00px" class="cls_020"><span class="cls_020">rd = ((signed) rs) >> rt;</span></div>
<div style="position:absolute;left:40.00px;top:110.00px" class="cls_020"><span class="cls_020">srl rd,rs,rt</span></div>
<div style="position:absolute;left:116.58px;top:110.00px" class="cls_020"><span class="cls_020">srlv rd,rs,rt</span></div>
<div style="position:absolute;left:208.32px;top:110.00px" class="cls_020"><span class="cls_020">rd = ((unsigned) rs) >> rt;</span></div>
<div style="position:absolute;left:40.00px;top:127.00px" class="cls_020"><span class="cls_020">sub rd,rs,rt</span></div>
<div style="position:absolute;left:116.60px;top:127.00px" class="cls_020"><span class="cls_020">sub rd,rs,rt</span></div>
<div style="position:absolute;left:208.34px;top:127.00px" class="cls_020"><span class="cls_020">rd = rs - rt; /* trap on overflow */</span></div>
<div style="position:absolute;left:40.00px;top:144.00px" class="cls_020"><span class="cls_020">subu rd,rs,rt</span></div>
<div style="position:absolute;left:116.62px;top:144.00px" class="cls_020"><span class="cls_020">subu rd,rs,rt</span></div>
<div style="position:absolute;left:208.38px;top:144.00px" class="cls_020"><span class="cls_020">rd = rs - rt; /* no trap on overflow */</span></div>
<div style="position:absolute;left:40.00px;top:161.01px" class="cls_020"><span class="cls_020">xor rd,rs,rt</span></div>
<div style="position:absolute;left:116.59px;top:161.01px" class="cls_020"><span class="cls_020">xor rd,rs,rt</span></div>
<div style="position:absolute;left:208.32px;top:161.01px" class="cls_020"><span class="cls_020">rd = rs ^ rt;</span></div>
<div style="position:absolute;left:40.00px;top:178.01px" class="cls_020"><span class="cls_020">Binary instructions with one constant operand (‘‘immediate’’)</span></div>
<div style="position:absolute;left:40.00px;top:188.01px" class="cls_020"><span class="cls_020">addi opcode is legal but unnecessary</span></div>
<div style="position:absolute;left:40.00px;top:205.01px" class="cls_020"><span class="cls_020">add rd,rs,imm</span></div>
<div style="position:absolute;left:113.76px;top:205.01px" class="cls_020"><span class="cls_020">addi rd,rs,imm</span></div>
<div style="position:absolute;left:208.43px;top:205.01px" class="cls_020"><span class="cls_020">/* “add” traps on overflow */</span></div>
<div style="position:absolute;left:207.87px;top:215.01px" class="cls_020"><span class="cls_020">/* when -32768 &lt;= imm &lt;32768 */</span></div>
<div style="position:absolute;left:207.87px;top:225.00px" class="cls_020"><span class="cls_020">rd = rs + (signed) imm;</span></div>
<div style="position:absolute;left:207.87px;top:242.01px" class="cls_020"><span class="cls_020">/* for big values add and ALL signed ops</span></div>
<div style="position:absolute;left:210.75px;top:252.00px" class="cls_020"><span class="cls_020">* expand like this */</span></div>
<div style="position:absolute;left:113.49px;top:262.00px" class="cls_020"><span class="cls_020">lui rd,hi_imm</span></div>
<div style="position:absolute;left:207.87px;top:262.00px" class="cls_020"><span class="cls_020">rd = imm & 0xFFFF0000;</span></div>
<div style="position:absolute;left:113.49px;top:272.00px" class="cls_020"><span class="cls_020">ori rd,rd,lo_imm</span></div>
<div style="position:absolute;left:207.87px;top:272.00px" class="cls_020"><span class="cls_020">rd |= imm & 0xFFFF;</span></div>
<div style="position:absolute;left:113.49px;top:282.00px" class="cls_020"><span class="cls_020">add rd,rs,rd</span></div>
<div style="position:absolute;left:207.87px;top:282.00px" class="cls_020"><span class="cls_020">rd = rs + rd;</span></div>
<div style="position:absolute;left:40.00px;top:299.00px" class="cls_020"><span class="cls_020">addu</span></div>
<div style="position:absolute;left:113.49px;top:299.00px" class="cls_020"><span class="cls_020">addiu rd,rs,imm</span></div>
<div style="position:absolute;left:208.18px;top:299.00px" class="cls_020"><span class="cls_020">/* “addu” won’t trap on overflow */</span></div>
<div style="position:absolute;left:40.00px;top:309.00px" class="cls_020"><span class="cls_020">rd,rs,imm</span></div>
<div style="position:absolute;left:207.87px;top:309.00px" class="cls_020"><span class="cls_020">/* will expand if imm bigger than 16 bit */</span></div>
<div style="position:absolute;left:207.87px;top:319.00px" class="cls_020"><span class="cls_020">rd = rs + (signed) imm;</span></div>
<div style="position:absolute;left:40.00px;top:336.00px" class="cls_020"><span class="cls_020">sub rd,rs,imm</span></div>
<div style="position:absolute;left:113.76px;top:336.00px" class="cls_020"><span class="cls_020">addi rd,rs,-imm</span></div>
<div style="position:absolute;left:208.44px;top:336.00px" class="cls_020"><span class="cls_020">/* trap on overflow */</span></div>
<div style="position:absolute;left:207.87px;top:346.00px" class="cls_020"><span class="cls_020">/* will expand if imm bigger than 16 bit */</span></div>
<div style="position:absolute;left:207.87px;top:356.00px" class="cls_020"><span class="cls_020">rd = rs - (signed) imm;</span></div>
<div style="position:absolute;left:40.00px;top:373.00px" class="cls_020"><span class="cls_020">subu</span></div>
<div style="position:absolute;left:113.49px;top:373.00px" class="cls_020"><span class="cls_020">addiu rd,rs,-imm</span></div>
<div style="position:absolute;left:208.20px;top:373.00px" class="cls_020"><span class="cls_020">/* no trap on overflow */</span></div>
<div style="position:absolute;left:40.00px;top:383.00px" class="cls_020"><span class="cls_020">rd,rs,imm</span></div>
<div style="position:absolute;left:207.87px;top:383.00px" class="cls_020"><span class="cls_020">/* will expand if imm bigger than 16 bit */</span></div>
<div style="position:absolute;left:207.87px;top:393.00px" class="cls_020"><span class="cls_020">rd = rs - (signed) imm;</span></div>
<div style="position:absolute;left:40.00px;top:410.00px" class="cls_020"><span class="cls_020">and rd,rs,imm</span></div>
<div style="position:absolute;left:113.77px;top:410.00px" class="cls_020"><span class="cls_020">andi rd,rs,imm</span></div>
<div style="position:absolute;left:208.44px;top:410.00px" class="cls_020"><span class="cls_020">rd = rs & imm; /* 0 &lt;= imm &lt;65535 */</span></div>
<div style="position:absolute;left:207.87px;top:427.00px" class="cls_020"><span class="cls_020">/* for big values add and ALL unsigned</span></div>
<div style="position:absolute;left:207.87px;top:437.00px" class="cls_020"><span class="cls_020">ops</span></div>
<div style="position:absolute;left:113.49px;top:447.00px" class="cls_020"><span class="cls_020">lui rd,hi_imm</span></div>
<div style="position:absolute;left:210.75px;top:447.00px" class="cls_020"><span class="cls_020">* expand like this */</span></div>
<div style="position:absolute;left:113.49px;top:457.00px" class="cls_020"><span class="cls_020">ori rd,rd,lo_imm</span></div>
<div style="position:absolute;left:207.87px;top:457.00px" class="cls_020"><span class="cls_020">rd = imm & 0xFFFF0000;</span></div>
<div style="position:absolute;left:113.49px;top:467.00px" class="cls_020"><span class="cls_020">and rd,rs,rd</span></div>
<div style="position:absolute;left:207.87px;top:467.00px" class="cls_020"><span class="cls_020">rd |= imm & 0xFFFF;</span></div>
<div style="position:absolute;left:207.87px;top:476.99px" class="cls_020"><span class="cls_020">rd = rs & rd;</span></div>
<div style="position:absolute;left:40.00px;top:494.00px" class="cls_020"><span class="cls_020">or rd,rs,imm</span></div>
<div style="position:absolute;left:113.74px;top:494.00px" class="cls_020"><span class="cls_020">ori rd,rs,imm</span></div>
<div style="position:absolute;left:208.37px;top:494.00px" class="cls_020"><span class="cls_020">rd = rs | imm;  /* 0 &lt;= imm &lt;65535 */</span></div>
<div style="position:absolute;left:40.00px;top:511.00px" class="cls_020"><span class="cls_020">slt rd,rs,imm</span></div>
<div style="position:absolute;left:113.75px;top:511.00px" class="cls_020"><span class="cls_020">slti rd,rs,imm</span></div>
<div style="position:absolute;left:208.39px;top:511.00px" class="cls_020"><span class="cls_020">/* -32768 &lt;= imm &lt;32768 */</span></div>
<div style="position:absolute;left:207.87px;top:521.00px" class="cls_020"><span class="cls_020">rd = ((signed) rs &lt;(signed) imm) ? 1: 0;</span></div>
<div style="position:absolute;left:207.87px;top:530.99px" class="cls_020"><span class="cls_020">/* expanded as for add if imm big */</span></div>
<div style="position:absolute;left:40.00px;top:548.00px" class="cls_020"><span class="cls_020">sltu rd,rs,imm</span></div>
<div style="position:absolute;left:116.65px;top:548.00px" class="cls_020"><span class="cls_020">sltiu rd,rs,imm</span></div>
<div style="position:absolute;left:208.45px;top:548.00px" class="cls_020"><span class="cls_020">rd = ((unsigned) rs &lt;(unsigned) imm) ? 1:</span></div>
<div style="position:absolute;left:207.87px;top:557.99px" class="cls_020"><span class="cls_020">0;</span></div>
<div style="position:absolute;left:207.87px;top:567.99px" class="cls_020"><span class="cls_020">/* expanded as for “and”if imm big */</span></div>
<div style="position:absolute;left:40.00px;top:594.99px" class="cls_020"><span class="cls_020">xor rd,rs,imm</span></div>
<div style="position:absolute;left:113.75px;top:594.99px" class="cls_020"><span class="cls_020">xori rd,rs,imm</span></div>
<div style="position:absolute;left:208.41px;top:594.99px" class="cls_020"><span class="cls_020">rd = rs ^ imm;</span></div>
<div style="position:absolute;left:40.00px;top:611.99px" class="cls_020"><span class="cls_020">li rd,imm</span></div>
<div style="position:absolute;left:113.67px;top:611.99px" class="cls_020"><span class="cls_020">ori rd,$zero,imm</span></div>
<div style="position:absolute;left:208.37px;top:611.99px" class="cls_020"><span class="cls_020">rd = (unsigned) imm; /* imm &lt;= 65335 */</span></div>
<div style="position:absolute;left:207.87px;top:629.00px" class="cls_020"><span class="cls_020">/* for big imm value expand to... */</span></div>
<div style="position:absolute;left:113.49px;top:638.99px" class="cls_020"><span class="cls_020">lui rd,hi_imm</span></div>
<div style="position:absolute;left:207.87px;top:638.99px" class="cls_020"><span class="cls_020">rd = imm & 0xFFFF0000;</span></div>
<div style="position:absolute;left:113.49px;top:648.99px" class="cls_020"><span class="cls_020">ori rd,$zero,lo_imm</span></div>
<div style="position:absolute;left:207.87px;top:648.99px" class="cls_020"><span class="cls_020">rd |= imm & 0xFFFF;</span></div>
<div style="position:absolute;left:40.00px;top:665.99px" class="cls_020"><span class="cls_020">lui rd,imm</span></div>
<div style="position:absolute;left:208.07px;top:665.99px" class="cls_020"><span class="cls_020">rd = imm &lt;&lt; 32;</span></div>
<div style="position:absolute;left:40.00px;top:683.00px" class="cls_020"><span class="cls_020">Multiply/divide unit machine instructions</span></div>
<div style="position:absolute;left:137.68px;top:701.99px" class="cls_020"><span class="cls_020">Table 9.2: Assembler instructions</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">9–24</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:105864px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:525.20px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:228.90px;top:57.00px" class="cls_020"><span class="cls_020">Assembler</span></div>
<div style="position:absolute;left:309.95px;top:57.00px" class="cls_020"><span class="cls_020">Expands To</span></div>
<div style="position:absolute;left:451.17px;top:57.00px" class="cls_020"><span class="cls_020">What it does</span></div>
<div style="position:absolute;left:220.00px;top:76.00px" class="cls_020"><span class="cls_020">mult rs,rt</span></div>
<div style="position:absolute;left:388.06px;top:76.00px" class="cls_020"><span class="cls_020">/* Start signed multiply of rs and rd.</span></div>
<div style="position:absolute;left:390.75px;top:86.00px" class="cls_020"><span class="cls_020">* Result can be retrieved, in a while,</span></div>
<div style="position:absolute;left:390.75px;top:96.00px" class="cls_020"><span class="cls_020">* using mfhi/mflo</span></div>
<div style="position:absolute;left:390.75px;top:106.00px" class="cls_020"><span class="cls_020">*/</span></div>
<div style="position:absolute;left:220.00px;top:123.00px" class="cls_020"><span class="cls_020">multu rs,rt</span></div>
<div style="position:absolute;left:388.06px;top:123.00px" class="cls_020"><span class="cls_020">/* start unsigned multiply of rs and rd */</span></div>
<div style="position:absolute;left:220.00px;top:140.00px" class="cls_020"><span class="cls_020">divd rs,rt</span></div>
<div style="position:absolute;left:388.05px;top:140.00px" class="cls_020"><span class="cls_020">/* start signed divide rs/rd */</span></div>
<div style="position:absolute;left:220.00px;top:157.00px" class="cls_020"><span class="cls_020">divdu rs,rt</span></div>
<div style="position:absolute;left:388.08px;top:157.00px" class="cls_020"><span class="cls_020">/* start unsigned divide rs/rd */</span></div>
<div style="position:absolute;left:220.00px;top:174.00px" class="cls_020"><span class="cls_020">mfhi rd</span></div>
<div style="position:absolute;left:388.02px;top:174.00px" class="cls_020"><span class="cls_020">/* retrieve remainder from divide or high-</span></div>
<div style="position:absolute;left:390.75px;top:184.00px" class="cls_020"><span class="cls_020">* order word of result of multiply */</span></div>
<div style="position:absolute;left:220.00px;top:201.00px" class="cls_020"><span class="cls_020">mflo rd</span></div>
<div style="position:absolute;left:388.01px;top:201.00px" class="cls_020"><span class="cls_020">/* retrieve result of divide or low-order</span></div>
<div style="position:absolute;left:390.75px;top:211.00px" class="cls_020"><span class="cls_020">* word of result of multiply */</span></div>
<div style="position:absolute;left:220.00px;top:228.00px" class="cls_020"><span class="cls_020">mthi rs</span></div>
<div style="position:absolute;left:388.01px;top:228.00px" class="cls_020"><span class="cls_020">/* load multiply unit ‘‘hi’’ register */</span></div>
<div style="position:absolute;left:220.00px;top:245.00px" class="cls_020"><span class="cls_020">mtlo rs</span></div>
<div style="position:absolute;left:388.01px;top:245.00px" class="cls_020"><span class="cls_020">/* load multiply unit ‘‘lo’’ register */</span></div>
<div style="position:absolute;left:220.00px;top:262.00px" class="cls_020"><span class="cls_020">Unconditional (absolute) branch and call</span></div>
<div style="position:absolute;left:220.00px;top:279.00px" class="cls_020"><span class="cls_020">jal label</span></div>
<div style="position:absolute;left:388.03px;top:279.00px" class="cls_020"><span class="cls_020">ra = RETURN;</span></div>
<div style="position:absolute;left:387.87px;top:289.00px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:220.00px;top:306.00px" class="cls_020"><span class="cls_020">jalr rd,rs</span></div>
<div style="position:absolute;left:388.05px;top:306.00px" class="cls_020"><span class="cls_020">rd = RETURN;</span></div>
<div style="position:absolute;left:387.87px;top:316.00px" class="cls_020"><span class="cls_020">goto *rs;</span></div>
<div style="position:absolute;left:220.00px;top:333.00px" class="cls_020"><span class="cls_020">jalr rs</span></div>
<div style="position:absolute;left:293.61px;top:333.00px" class="cls_020"><span class="cls_020">jalr rs,$ra</span></div>
<div style="position:absolute;left:388.18px;top:333.00px" class="cls_020"><span class="cls_020">ra = RETURN;</span></div>
<div style="position:absolute;left:387.87px;top:343.00px" class="cls_020"><span class="cls_020">goto *rs;</span></div>
<div style="position:absolute;left:220.00px;top:360.00px" class="cls_020"><span class="cls_020">jal rd,addr</span></div>
<div style="position:absolute;left:293.70px;top:360.00px" class="cls_020"><span class="cls_020">lui $at,%hi_addr</span></div>
<div style="position:absolute;left:387.87px;top:360.00px" class="cls_020"><span class="cls_020">rs = RETURN;</span></div>
<div style="position:absolute;left:293.49px;top:370.00px" class="cls_020"><span class="cls_020">addiu</span></div>
<div style="position:absolute;left:387.87px;top:370.00px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:293.49px;top:380.00px" class="cls_020"><span class="cls_020">$at,$at,%lo_addr</span></div>
<div style="position:absolute;left:387.87px;top:380.00px" class="cls_020"><span class="cls_020">goto *at;</span></div>
<div style="position:absolute;left:293.49px;top:390.00px" class="cls_020"><span class="cls_020">jalr rd,$at</span></div>
<div style="position:absolute;left:220.00px;top:407.00px" class="cls_020"><span class="cls_020">j label</span></div>
<div style="position:absolute;left:387.99px;top:407.00px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:220.00px;top:424.00px" class="cls_020"><span class="cls_020">jr rs</span></div>
<div style="position:absolute;left:387.96px;top:424.00px" class="cls_020"><span class="cls_020">goto *rs;</span></div>
<div style="position:absolute;left:220.00px;top:441.00px" class="cls_020"><span class="cls_020">No-op</span></div>
<div style="position:absolute;left:220.00px;top:458.01px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:293.58px;top:458.01px" class="cls_020"><span class="cls_020">sll</span></div>
<div style="position:absolute;left:387.87px;top:458.01px" class="cls_020"><span class="cls_020">/* no-op, instruction code == 0 */</span></div>
<div style="position:absolute;left:293.49px;top:468.00px" class="cls_020"><span class="cls_020">$zero,$zero,$zero</span></div>
<div style="position:absolute;left:220.00px;top:485.01px" class="cls_020"><span class="cls_020">Load address</span></div>
<div style="position:absolute;left:220.00px;top:502.01px" class="cls_020"><span class="cls_020">la rd,label</span></div>
<div style="position:absolute;left:293.69px;top:502.01px" class="cls_020"><span class="cls_020">lui rd,%hi_label</span></div>
<div style="position:absolute;left:387.87px;top:502.01px" class="cls_020"><span class="cls_020">rd = %hi_addr &lt;&lt;32</span></div>
<div style="position:absolute;left:293.49px;top:512.01px" class="cls_020"><span class="cls_020">addiu</span></div>
<div style="position:absolute;left:387.87px;top:512.01px" class="cls_020"><span class="cls_020">rd += (signed) %lo_label;</span></div>
<div style="position:absolute;left:293.49px;top:522.00px" class="cls_020"><span class="cls_020">rd,rd,%lo_label</span></div>
<div style="position:absolute;left:220.00px;top:539.01px" class="cls_020"><span class="cls_020">Address mode implementation for load/store</span></div>
<div style="position:absolute;left:220.00px;top:556.01px" class="cls_020"><span class="cls_020">lw rd,label</span></div>
<div style="position:absolute;left:293.70px;top:556.01px" class="cls_020"><span class="cls_020">lui rd,%hi_label</span></div>
<div style="position:absolute;left:387.87px;top:556.01px" class="cls_020"><span class="cls_020">/* link-time determined location */</span></div>
<div style="position:absolute;left:293.49px;top:566.01px" class="cls_020"><span class="cls_020">lw rd,%lo_label(rd)</span></div>
<div style="position:absolute;left:387.87px;top:566.01px" class="cls_020"><span class="cls_020">/* note can use rd or $at for lw */</span></div>
<div style="position:absolute;left:293.49px;top:583.01px" class="cls_020"><span class="cls_020">lw</span></div>
<div style="position:absolute;left:387.87px;top:583.01px" class="cls_020"><span class="cls_020">/* link-time location, in gp segment */</span></div>
<div style="position:absolute;left:293.49px;top:593.01px" class="cls_020"><span class="cls_020">rd,%gpoff_addr($gp</span></div>
<div style="position:absolute;left:293.49px;top:603.00px" class="cls_020"><span class="cls_020">)</span></div>
<div style="position:absolute;left:220.00px;top:620.01px" class="cls_020"><span class="cls_020">lw rd,offset(rs)</span></div>
<div style="position:absolute;left:293.81px;top:620.01px" class="cls_020"><span class="cls_020">lw rd,offset(rsO)</span></div>
<div style="position:absolute;left:388.50px;top:620.01px" class="cls_020"><span class="cls_020">/* single instruction if offset fits</span></div>
<div style="position:absolute;left:390.75px;top:630.00px" class="cls_020"><span class="cls_020">* in 16 bits */</span></div>
<div style="position:absolute;left:293.49px;top:647.01px" class="cls_020"><span class="cls_020">lui rd,%hi_offset</span></div>
<div style="position:absolute;left:387.87px;top:647.01px" class="cls_020"><span class="cls_020">/* sequence for big offset */</span></div>
<div style="position:absolute;left:293.49px;top:657.00px" class="cls_020"><span class="cls_020">addu rd,rd,rs</span></div>
<div style="position:absolute;left:293.49px;top:667.00px" class="cls_020"><span class="cls_020">lw rd,%lo_offset(rd)</span></div>
<div style="position:absolute;left:220.00px;top:684.00px" class="cls_020"><span class="cls_020">Load and store instructions</span></div>
<div style="position:absolute;left:317.68px;top:703.00px" class="cls_020"><span class="cls_020">Table 9.2: Assembler instructions</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">9–25</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:106666px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:376.95px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:48.90px;top:56.98px" class="cls_020"><span class="cls_020">Assembler</span></div>
<div style="position:absolute;left:129.95px;top:56.98px" class="cls_020"><span class="cls_020">Expands To</span></div>
<div style="position:absolute;left:271.17px;top:56.98px" class="cls_020"><span class="cls_020">What it does</span></div>
<div style="position:absolute;left:40.00px;top:76.00px" class="cls_020"><span class="cls_020">lw rd,addr</span></div>
<div style="position:absolute;left:208.07px;top:76.00px" class="cls_020"><span class="cls_020">/* load word */</span></div>
<div style="position:absolute;left:207.87px;top:86.00px" class="cls_020"><span class="cls_020">rd = *((int *) addr);</span></div>
<div style="position:absolute;left:40.00px;top:103.00px" class="cls_020"><span class="cls_020">lh rd,addr</span></div>
<div style="position:absolute;left:208.07px;top:103.00px" class="cls_020"><span class="cls_020">/* load half-word,sign-extend */</span></div>
<div style="position:absolute;left:207.87px;top:113.00px" class="cls_020"><span class="cls_020">rd = *((short *) addr);</span></div>
<div style="position:absolute;left:40.00px;top:130.00px" class="cls_020"><span class="cls_020">lhu rd,addr</span></div>
<div style="position:absolute;left:208.09px;top:130.00px" class="cls_020"><span class="cls_020">/* load half-word,zero-extend */</span></div>
<div style="position:absolute;left:207.87px;top:140.00px" class="cls_020"><span class="cls_020">rd = *((unsigned short *) addr);</span></div>
<div style="position:absolute;left:40.00px;top:157.00px" class="cls_020"><span class="cls_020">lb rd,addr</span></div>
<div style="position:absolute;left:208.07px;top:157.00px" class="cls_020"><span class="cls_020">/* load byte, sign-extend */</span></div>
<div style="position:absolute;left:207.87px;top:167.00px" class="cls_020"><span class="cls_020">rd = *((signed char *) addr);</span></div>
<div style="position:absolute;left:40.00px;top:184.00px" class="cls_020"><span class="cls_020">lbu rd,addr</span></div>
<div style="position:absolute;left:208.09px;top:184.00px" class="cls_020"><span class="cls_020">/* load byte, sign-extend */</span></div>
<div style="position:absolute;left:207.87px;top:194.00px" class="cls_020"><span class="cls_020">rd = *((unsigned char *) addr);</span></div>
<div style="position:absolute;left:40.00px;top:211.00px" class="cls_020"><span class="cls_020">ld $t2,addr</span></div>
<div style="position:absolute;left:113.71px;top:211.00px" class="cls_020"><span class="cls_020">lui $at,%hi_addr</span></div>
<div style="position:absolute;left:207.87px;top:211.00px" class="cls_020"><span class="cls_020">/* load 64-bit integer into pair of regs */</span></div>
<div style="position:absolute;left:113.49px;top:221.00px" class="cls_020"><span class="cls_020">addiu</span></div>
<div style="position:absolute;left:113.49px;top:231.00px" class="cls_020"><span class="cls_020">$at,$at,%lo_addr</span></div>
<div style="position:absolute;left:113.49px;top:241.00px" class="cls_020"><span class="cls_020">lw $t2,0($at)</span></div>
<div style="position:absolute;left:113.49px;top:251.00px" class="cls_020"><span class="cls_020">lw $t3,4($at)</span></div>
<div style="position:absolute;left:40.00px;top:268.00px" class="cls_020"><span class="cls_020">sw rs,addr</span></div>
<div style="position:absolute;left:208.07px;top:268.00px" class="cls_020"><span class="cls_020">/* store word */</span></div>
<div style="position:absolute;left:207.87px;top:278.00px" class="cls_020"><span class="cls_020">*((int *) addr) = rs;</span></div>
<div style="position:absolute;left:40.00px;top:295.00px" class="cls_020"><span class="cls_020">sh rs,addr</span></div>
<div style="position:absolute;left:208.07px;top:295.00px" class="cls_020"><span class="cls_020">/* store half-word */</span></div>
<div style="position:absolute;left:207.87px;top:305.00px" class="cls_020"><span class="cls_020">*((short *) addr) = rs;</span></div>
<div style="position:absolute;left:40.00px;top:322.00px" class="cls_020"><span class="cls_020">sb rs,addr</span></div>
<div style="position:absolute;left:208.07px;top:322.00px" class="cls_020"><span class="cls_020">/* store byte */</span></div>
<div style="position:absolute;left:207.87px;top:332.00px" class="cls_020"><span class="cls_020">*((char *) addr) = rs;</span></div>
<div style="position:absolute;left:40.00px;top:349.00px" class="cls_020"><span class="cls_020">sd $t2,addr</span></div>
<div style="position:absolute;left:113.72px;top:349.00px" class="cls_020"><span class="cls_020">lui $at,%hi_addr</span></div>
<div style="position:absolute;left:207.87px;top:349.00px" class="cls_020"><span class="cls_020">/* store 64-bit integer */</span></div>
<div style="position:absolute;left:113.49px;top:359.00px" class="cls_020"><span class="cls_020">addiu</span></div>
<div style="position:absolute;left:113.49px;top:368.99px" class="cls_020"><span class="cls_020">$at,$at,%lo_addr</span></div>
<div style="position:absolute;left:113.49px;top:378.99px" class="cls_020"><span class="cls_020">sw $t2,0($at)</span></div>
<div style="position:absolute;left:113.49px;top:388.99px" class="cls_020"><span class="cls_020">sw $t3,4($at)</span></div>
<div style="position:absolute;left:40.00px;top:405.99px" class="cls_020"><span class="cls_020">ulw rd,addr</span></div>
<div style="position:absolute;left:113.72px;top:405.99px" class="cls_020"><span class="cls_020">lui $at,%hi_addr</span></div>
<div style="position:absolute;left:207.87px;top:405.99px" class="cls_020"><span class="cls_020">/* load word unaligned */</span></div>
<div style="position:absolute;left:113.49px;top:415.99px" class="cls_020"><span class="cls_020">addiu</span></div>
<div style="position:absolute;left:113.49px;top:425.99px" class="cls_020"><span class="cls_020">$at,$at,%lo_addr</span></div>
<div style="position:absolute;left:207.87px;top:425.99px" class="cls_020"><span class="cls_020">/* if addr is aligned, does same load</span></div>
<div style="position:absolute;left:113.49px;top:435.99px" class="cls_020"><span class="cls_020">lwl rd,0($at)</span></div>
<div style="position:absolute;left:210.75px;top:435.99px" class="cls_020"><span class="cls_020">* twice */</span></div>
<div style="position:absolute;left:113.49px;top:445.99px" class="cls_020"><span class="cls_020">lwr rd,3($at)</span></div>
<div style="position:absolute;left:40.00px;top:462.99px" class="cls_020"><span class="cls_020">usw rs,addr</span></div>
<div style="position:absolute;left:113.72px;top:462.99px" class="cls_020"><span class="cls_020">lui $at,%hi_addr</span></div>
<div style="position:absolute;left:207.87px;top:462.99px" class="cls_020"><span class="cls_020">/* store word unaligned */</span></div>
<div style="position:absolute;left:113.49px;top:472.99px" class="cls_020"><span class="cls_020">addiu</span></div>
<div style="position:absolute;left:113.49px;top:482.99px" class="cls_020"><span class="cls_020">$at,$at,%lo_addr</span></div>
<div style="position:absolute;left:207.87px;top:482.99px" class="cls_020"><span class="cls_020">/* if addr is aligned, does same store</span></div>
<div style="position:absolute;left:113.49px;top:492.99px" class="cls_020"><span class="cls_020">swl rs,0($at)</span></div>
<div style="position:absolute;left:210.75px;top:492.99px" class="cls_020"><span class="cls_020">* twice */</span></div>
<div style="position:absolute;left:113.49px;top:502.99px" class="cls_020"><span class="cls_020">swr rs,3($at)</span></div>
<div style="position:absolute;left:40.00px;top:519.99px" class="cls_020"><span class="cls_020">lwl rd,addr</span></div>
<div style="position:absolute;left:208.08px;top:519.99px" class="cls_020"><span class="cls_020">load/store word left/right, see “Unaligned</span></div>
<div style="position:absolute;left:207.87px;top:529.99px" class="cls_020"><span class="cls_020">loads and store” on page 1-5</span></div>
<div style="position:absolute;left:40.00px;top:536.99px" class="cls_020"><span class="cls_020">lwr rd,addr</span></div>
<div style="position:absolute;left:40.00px;top:553.99px" class="cls_020"><span class="cls_020">swl rs,addr</span></div>
<div style="position:absolute;left:40.00px;top:570.99px" class="cls_020"><span class="cls_020">swr rs,addr</span></div>
<div style="position:absolute;left:40.00px;top:587.99px" class="cls_020"><span class="cls_020">l.s fd,addr</span></div>
<div style="position:absolute;left:113.69px;top:587.99px" class="cls_020"><span class="cls_020">lui $at,%hi_addr</span></div>
<div style="position:absolute;left:207.87px;top:587.99px" class="cls_020"><span class="cls_020">/* load FP single */</span></div>
<div style="position:absolute;left:113.49px;top:597.99px" class="cls_020"><span class="cls_020">lwc1</span></div>
<div style="position:absolute;left:207.87px;top:597.99px" class="cls_020"><span class="cls_020">fd = *((float *) addr);</span></div>
<div style="position:absolute;left:113.49px;top:607.99px" class="cls_020"><span class="cls_020">fd,%lo_addr($at)</span></div>
<div style="position:absolute;left:40.00px;top:624.99px" class="cls_020"><span class="cls_020">l.d $f6,addr</span></div>
<div style="position:absolute;left:113.72px;top:624.99px" class="cls_020"><span class="cls_020">lui $at,%hi_addr</span></div>
<div style="position:absolute;left:207.87px;top:624.99px" class="cls_020"><span class="cls_020">/* load FP double into reg pair */</span></div>
<div style="position:absolute;left:113.49px;top:634.99px" class="cls_020"><span class="cls_020">addiu</span></div>
<div style="position:absolute;left:207.87px;top:634.99px" class="cls_020"><span class="cls_020">fd = *((double *) addr);</span></div>
<div style="position:absolute;left:113.49px;top:644.99px" class="cls_020"><span class="cls_020">$at,$at,%lo_addr</span></div>
<div style="position:absolute;left:113.49px;top:654.99px" class="cls_020"><span class="cls_020">lwc1</span></div>
<div style="position:absolute;left:136.35px;top:654.99px" class="cls_020"><span class="cls_020">$f7,0($at)</span></div>
<div style="position:absolute;left:113.49px;top:664.99px" class="cls_020"><span class="cls_020">lwc1</span></div>
<div style="position:absolute;left:136.35px;top:664.99px" class="cls_020"><span class="cls_020">$f6,4($at)</span></div>
<div style="position:absolute;left:40.00px;top:681.99px" class="cls_020"><span class="cls_020">s.s fs,addr</span></div>
<div style="position:absolute;left:113.70px;top:681.99px" class="cls_020"><span class="cls_020">swc1 fs,addr</span></div>
<div style="position:absolute;left:208.33px;top:681.99px" class="cls_020"><span class="cls_020">/* store FP single */</span></div>
<div style="position:absolute;left:207.87px;top:691.99px" class="cls_020"><span class="cls_020">*((float *) addr) = fs;</span></div>
<div style="position:absolute;left:137.68px;top:710.99px" class="cls_020"><span class="cls_020">Table 9.2: Assembler instructions</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">9–26</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:107468px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:525.20px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:228.90px;top:56.98px" class="cls_020"><span class="cls_020">Assembler</span></div>
<div style="position:absolute;left:309.95px;top:56.98px" class="cls_020"><span class="cls_020">Expands To</span></div>
<div style="position:absolute;left:451.17px;top:56.98px" class="cls_020"><span class="cls_020">What it does</span></div>
<div style="position:absolute;left:220.00px;top:76.00px" class="cls_020"><span class="cls_020">s.d $f2,addr</span></div>
<div style="position:absolute;left:293.73px;top:76.00px" class="cls_020"><span class="cls_020">lui $at,%hi_addr</span></div>
<div style="position:absolute;left:387.87px;top:76.00px" class="cls_020"><span class="cls_020">/* store FP double from reg pair */</span></div>
<div style="position:absolute;left:293.49px;top:86.00px" class="cls_020"><span class="cls_020">addiu</span></div>
<div style="position:absolute;left:387.87px;top:86.00px" class="cls_020"><span class="cls_020">*((double *) addr) = fs;</span></div>
<div style="position:absolute;left:293.49px;top:96.00px" class="cls_020"><span class="cls_020">$at,$at,%lo_addr</span></div>
<div style="position:absolute;left:293.49px;top:106.00px" class="cls_020"><span class="cls_020">swc1</span></div>
<div style="position:absolute;left:318.33px;top:106.00px" class="cls_020"><span class="cls_020">$f3,0($at)</span></div>
<div style="position:absolute;left:293.49px;top:116.00px" class="cls_020"><span class="cls_020">swc1</span></div>
<div style="position:absolute;left:318.33px;top:116.00px" class="cls_020"><span class="cls_020">$f2,4($at)</span></div>
<div style="position:absolute;left:220.00px;top:133.00px" class="cls_020"><span class="cls_020">Co-processor ‘‘condition’’ tests</span></div>
<div style="position:absolute;left:220.00px;top:150.00px" class="cls_020"><span class="cls_020">bc0t label</span></div>
<div style="position:absolute;left:387.87px;top:150.00px" class="cls_020"><span class="cls_020">/* goto label if corresponding BrCond</span></div>
<div style="position:absolute;left:220.00px;top:160.00px" class="cls_020"><span class="cls_020">bc2t label</span></div>
<div style="position:absolute;left:390.75px;top:160.00px" class="cls_020"><span class="cls_020">* input is active */</span></div>
<div style="position:absolute;left:220.00px;top:170.00px" class="cls_020"><span class="cls_020">bc3t label</span></div>
<div style="position:absolute;left:220.00px;top:187.00px" class="cls_020"><span class="cls_020">bc0f label</span></div>
<div style="position:absolute;left:387.87px;top:187.00px" class="cls_020"><span class="cls_020">/* goto label if corresponding BrCond</span></div>
<div style="position:absolute;left:220.00px;top:197.00px" class="cls_020"><span class="cls_020">bc2f label</span></div>
<div style="position:absolute;left:390.75px;top:197.00px" class="cls_020"><span class="cls_020">* input is inactive */</span></div>
<div style="position:absolute;left:220.00px;top:206.99px" class="cls_020"><span class="cls_020">bc3f label</span></div>
<div style="position:absolute;left:220.00px;top:224.00px" class="cls_020"><span class="cls_020">Trap instructions</span></div>
<div style="position:absolute;left:220.00px;top:241.00px" class="cls_020"><span class="cls_020">break code</span></div>
<div style="position:absolute;left:388.08px;top:241.00px" class="cls_020"><span class="cls_020">trap(BREAK, code);</span></div>
<div style="position:absolute;left:220.00px;top:258.00px" class="cls_020"><span class="cls_020">syscall</span></div>
<div style="position:absolute;left:388.01px;top:258.00px" class="cls_020"><span class="cls_020">trap(SYSCALL, 0)</span></div>
<div style="position:absolute;left:220.00px;top:275.00px" class="cls_020"><span class="cls_020">teq rs,rt,code</span></div>
<div style="position:absolute;left:296.63px;top:275.00px" class="cls_020"><span class="cls_020">bne rs,rt,1f</span></div>
<div style="position:absolute;left:387.87px;top:275.00px" class="cls_020"><span class="cls_020">/* R4000 compatibility instruction */</span></div>
<div style="position:absolute;left:296.37px;top:285.00px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:387.87px;top:285.00px" class="cls_020"><span class="cls_020">if (rs == rt)</span></div>
<div style="position:absolute;left:296.37px;top:295.00px" class="cls_020"><span class="cls_020">break code</span></div>
<div style="position:absolute;left:390.75px;top:295.00px" class="cls_020"><span class="cls_020">trap(BREAK, code);</span></div>
<div style="position:absolute;left:293.49px;top:305.00px" class="cls_020"><span class="cls_020">1:</span></div>
<div style="position:absolute;left:220.00px;top:322.00px" class="cls_020"><span class="cls_020">tge rs,rt,code</span></div>
<div style="position:absolute;left:296.63px;top:322.00px" class="cls_020"><span class="cls_020">slt $at,rs,rt</span></div>
<div style="position:absolute;left:387.87px;top:322.00px" class="cls_020"><span class="cls_020">if ((signed)rs >= (signed)rt)</span></div>
<div style="position:absolute;left:296.37px;top:332.00px" class="cls_020"><span class="cls_020">bne $at,$zero,1f</span></div>
<div style="position:absolute;left:390.75px;top:332.00px" class="cls_020"><span class="cls_020">trap(BREAK, code);</span></div>
<div style="position:absolute;left:296.37px;top:341.99px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:296.37px;top:351.99px" class="cls_020"><span class="cls_020">break code</span></div>
<div style="position:absolute;left:293.49px;top:361.99px" class="cls_020"><span class="cls_020">1:</span></div>
<div style="position:absolute;left:220.00px;top:378.99px" class="cls_020"><span class="cls_020">tgeu rs,rt,code</span></div>
<div style="position:absolute;left:296.66px;top:378.99px" class="cls_020"><span class="cls_020">sltu $at,rs,rt</span></div>
<div style="position:absolute;left:387.87px;top:378.99px" class="cls_020"><span class="cls_020">if ((unsigned)rs >= (unsigned)rt)</span></div>
<div style="position:absolute;left:296.37px;top:388.99px" class="cls_020"><span class="cls_020">bne $at,$zero,1f</span></div>
<div style="position:absolute;left:390.75px;top:388.99px" class="cls_020"><span class="cls_020">trap(BREAK, code);</span></div>
<div style="position:absolute;left:296.37px;top:398.99px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:296.37px;top:408.99px" class="cls_020"><span class="cls_020">break code</span></div>
<div style="position:absolute;left:293.49px;top:418.99px" class="cls_020"><span class="cls_020">1:</span></div>
<div style="position:absolute;left:220.00px;top:435.99px" class="cls_020"><span class="cls_020">tlt rs,rt,code</span></div>
<div style="position:absolute;left:296.62px;top:435.99px" class="cls_020"><span class="cls_020">slt $at,rs,rt</span></div>
<div style="position:absolute;left:387.87px;top:435.99px" class="cls_020"><span class="cls_020">if ((signed)rs &lt;(signed)rt)</span></div>
<div style="position:absolute;left:296.37px;top:445.99px" class="cls_020"><span class="cls_020">beq $at,$zero,1f</span></div>
<div style="position:absolute;left:390.75px;top:445.99px" class="cls_020"><span class="cls_020">trap(BREAK, code);</span></div>
<div style="position:absolute;left:296.37px;top:455.99px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:296.37px;top:465.99px" class="cls_020"><span class="cls_020">break code</span></div>
<div style="position:absolute;left:293.49px;top:475.99px" class="cls_020"><span class="cls_020">1:</span></div>
<div style="position:absolute;left:220.00px;top:492.99px" class="cls_020"><span class="cls_020">tltu rs,rt,code</span></div>
<div style="position:absolute;left:296.64px;top:492.99px" class="cls_020"><span class="cls_020">sltu $at,rs,rt</span></div>
<div style="position:absolute;left:387.87px;top:492.99px" class="cls_020"><span class="cls_020">if ((unsigned)rs &lt;(unsigned)rt)</span></div>
<div style="position:absolute;left:296.37px;top:502.99px" class="cls_020"><span class="cls_020">beq $at,$zero,1f</span></div>
<div style="position:absolute;left:390.75px;top:502.99px" class="cls_020"><span class="cls_020">trap(BREAK, code);</span></div>
<div style="position:absolute;left:296.37px;top:512.99px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:296.37px;top:522.98px" class="cls_020"><span class="cls_020">break code</span></div>
<div style="position:absolute;left:293.49px;top:532.98px" class="cls_020"><span class="cls_020">1:</span></div>
<div style="position:absolute;left:220.00px;top:549.98px" class="cls_020"><span class="cls_020">tne rs,rt,code</span></div>
<div style="position:absolute;left:296.64px;top:549.98px" class="cls_020"><span class="cls_020">beq rs,rt,1f</span></div>
<div style="position:absolute;left:387.87px;top:549.98px" class="cls_020"><span class="cls_020">if (rs != rt)</span></div>
<div style="position:absolute;left:296.37px;top:559.98px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:390.75px;top:559.98px" class="cls_020"><span class="cls_020">trap(BREAK, code);</span></div>
<div style="position:absolute;left:296.37px;top:569.98px" class="cls_020"><span class="cls_020">break code</span></div>
<div style="position:absolute;left:293.49px;top:579.98px" class="cls_020"><span class="cls_020">1:</span></div>
<div style="position:absolute;left:220.00px;top:596.98px" class="cls_020"><span class="cls_020">Floating point instructions.</span></div>
<div style="position:absolute;left:220.00px;top:606.98px" class="cls_020"><span class="cls_020">All come in both ‘‘.d’’ (64-bit) and ‘‘.s’’ (32-bit) forms</span></div>
<div style="position:absolute;left:220.00px;top:616.98px" class="cls_020"><span class="cls_020">Only ‘‘.d’’ listed.</span></div>
<div style="position:absolute;left:220.00px;top:633.98px" class="cls_020"><span class="cls_020">Test and set condition flag instructions</span></div>
<div style="position:absolute;left:220.00px;top:650.98px" class="cls_020"><span class="cls_020">c.f.d</span></div>
<div style="position:absolute;left:387.97px;top:650.98px" class="cls_020"><span class="cls_020">if (unordered(fs,ft))</span></div>
<div style="position:absolute;left:390.75px;top:660.98px" class="cls_020"><span class="cls_020">trap(FPINT);</span></div>
<div style="position:absolute;left:387.87px;top:670.98px" class="cls_020"><span class="cls_020">fpcond = 0;</span></div>
<div style="position:absolute;left:220.00px;top:687.98px" class="cls_020"><span class="cls_020">c.sf.d</span></div>
<div style="position:absolute;left:387.98px;top:687.98px" class="cls_020"><span class="cls_020">fpcond = 0;</span></div>
<div style="position:absolute;left:317.68px;top:706.98px" class="cls_020"><span class="cls_020">Table 9.2: Assembler instructions</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">9–27</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:108270px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:376.95px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:48.90px;top:57.01px" class="cls_020"><span class="cls_020">Assembler</span></div>
<div style="position:absolute;left:129.95px;top:57.01px" class="cls_020"><span class="cls_020">Expands To</span></div>
<div style="position:absolute;left:271.17px;top:57.01px" class="cls_020"><span class="cls_020">What it does</span></div>
<div style="position:absolute;left:40.00px;top:76.00px" class="cls_020"><span class="cls_020">c.un.d</span></div>
<div style="position:absolute;left:207.99px;top:76.00px" class="cls_020"><span class="cls_020">if (unordered(fs,ft))</span></div>
<div style="position:absolute;left:210.75px;top:86.00px" class="cls_020"><span class="cls_020">trap(FPINT);</span></div>
<div style="position:absolute;left:207.87px;top:96.00px" class="cls_020"><span class="cls_020">fpcond = unordered(fs,ft);</span></div>
<div style="position:absolute;left:40.00px;top:113.00px" class="cls_020"><span class="cls_020">c.ngle.d</span></div>
<div style="position:absolute;left:208.03px;top:113.00px" class="cls_020"><span class="cls_020">fpcond = unordered(fs,ft);</span></div>
<div style="position:absolute;left:40.00px;top:130.00px" class="cls_020"><span class="cls_020">c.eq.d</span></div>
<div style="position:absolute;left:207.99px;top:130.00px" class="cls_020"><span class="cls_020">if (unordered(fs,ft))</span></div>
<div style="position:absolute;left:210.75px;top:140.00px" class="cls_020"><span class="cls_020">trap(FPINT);</span></div>
<div style="position:absolute;left:207.87px;top:150.00px" class="cls_020"><span class="cls_020">fpcond = (fs == ft);</span></div>
<div style="position:absolute;left:40.00px;top:167.00px" class="cls_020"><span class="cls_020">c.seq.d</span></div>
<div style="position:absolute;left:208.01px;top:167.00px" class="cls_020"><span class="cls_020">fpcond = (fs == ft);</span></div>
<div style="position:absolute;left:40.00px;top:184.00px" class="cls_020"><span class="cls_020">c.ueq.d</span></div>
<div style="position:absolute;left:208.01px;top:184.00px" class="cls_020"><span class="cls_020">if (unordered(fs,ft))</span></div>
<div style="position:absolute;left:207.87px;top:194.00px" class="cls_020"><span class="cls_020">fpcond = (fs == ft) || unordered(fs,ft);</span></div>
<div style="position:absolute;left:40.00px;top:211.00px" class="cls_020"><span class="cls_020">c.ngl.d</span></div>
<div style="position:absolute;left:208.00px;top:211.00px" class="cls_020"><span class="cls_020">fpcond = (fs == ft) || unordered(fs,ft);</span></div>
<div style="position:absolute;left:40.00px;top:228.00px" class="cls_020"><span class="cls_020">c.olt.d</span></div>
<div style="position:absolute;left:207.99px;top:228.00px" class="cls_020"><span class="cls_020">if (unordered(fs,ft))</span></div>
<div style="position:absolute;left:210.75px;top:238.00px" class="cls_020"><span class="cls_020">trap(FPINT);</span></div>
<div style="position:absolute;left:207.87px;top:248.00px" class="cls_020"><span class="cls_020">fpcond = (fs &lt;ft);</span></div>
<div style="position:absolute;left:40.00px;top:265.00px" class="cls_020"><span class="cls_020">c.lt.d</span></div>
<div style="position:absolute;left:207.98px;top:265.00px" class="cls_020"><span class="cls_020">fpcond = (fs &lt;ft);</span></div>
<div style="position:absolute;left:40.00px;top:282.00px" class="cls_020"><span class="cls_020">c.ult.d</span></div>
<div style="position:absolute;left:208.00px;top:282.00px" class="cls_020"><span class="cls_020">if (unordered(fs,ft))</span></div>
<div style="position:absolute;left:210.75px;top:292.00px" class="cls_020"><span class="cls_020">trap(FPINT);</span></div>
<div style="position:absolute;left:207.87px;top:302.00px" class="cls_020"><span class="cls_020">fpcond = (fs &lt;ft) || unordered(fs,ft);</span></div>
<div style="position:absolute;left:40.00px;top:319.00px" class="cls_020"><span class="cls_020">c.nge.d</span></div>
<div style="position:absolute;left:208.01px;top:319.00px" class="cls_020"><span class="cls_020">fpcond = (fs &lt;ft) || unordered(fs,ft);</span></div>
<div style="position:absolute;left:40.00px;top:336.00px" class="cls_020"><span class="cls_020">c.ole.d</span></div>
<div style="position:absolute;left:208.00px;top:336.00px" class="cls_020"><span class="cls_020">if (unordered(fs,ft))</span></div>
<div style="position:absolute;left:210.75px;top:346.00px" class="cls_020"><span class="cls_020">trap(FPINT);</span></div>
<div style="position:absolute;left:207.87px;top:356.00px" class="cls_020"><span class="cls_020">fpcond = (fs &lt;= ft);</span></div>
<div style="position:absolute;left:40.00px;top:373.00px" class="cls_020"><span class="cls_020">c.le.d</span></div>
<div style="position:absolute;left:207.99px;top:373.00px" class="cls_020"><span class="cls_020">fpcond = (fs &lt;= ft);</span></div>
<div style="position:absolute;left:40.00px;top:390.00px" class="cls_020"><span class="cls_020">c.ule.d</span></div>
<div style="position:absolute;left:208.00px;top:390.00px" class="cls_020"><span class="cls_020">if (unordered(fs,ft))</span></div>
<div style="position:absolute;left:210.75px;top:400.00px" class="cls_020"><span class="cls_020">trap(FPINT);</span></div>
<div style="position:absolute;left:207.87px;top:410.00px" class="cls_020"><span class="cls_020">fpcond = (fs &lt;= ft) || unordered(fs,ft);</span></div>
<div style="position:absolute;left:40.00px;top:427.00px" class="cls_020"><span class="cls_020">c.ngt.d</span></div>
<div style="position:absolute;left:208.01px;top:427.00px" class="cls_020"><span class="cls_020">fpcond = (fs &lt;= ft) || unordered(fs,ft);</span></div>
<div style="position:absolute;left:40.00px;top:444.00px" class="cls_020"><span class="cls_020">FP move</span></div>
<div style="position:absolute;left:40.00px;top:461.00px" class="cls_020"><span class="cls_020">mov.d fd,fs</span></div>
<div style="position:absolute;left:208.08px;top:461.00px" class="cls_020"><span class="cls_020">fd = fs;</span></div>
<div style="position:absolute;left:40.00px;top:478.00px" class="cls_020"><span class="cls_020">Unary arithmetic. These operations are implemented by</span></div>
<div style="position:absolute;left:40.00px;top:488.00px" class="cls_020"><span class="cls_020">operating only on the sign bit, so never worry about invalid</span></div>
<div style="position:absolute;left:40.00px;top:498.00px" class="cls_020"><span class="cls_020">values, and they never trap.</span></div>
<div style="position:absolute;left:40.00px;top:515.00px" class="cls_020"><span class="cls_020">abs.d fd,fs</span></div>
<div style="position:absolute;left:208.07px;top:515.00px" class="cls_020"><span class="cls_020">fd = (fs > 0) ? fs: -fs;</span></div>
<div style="position:absolute;left:40.00px;top:532.00px" class="cls_020"><span class="cls_020">abs.d fd</span></div>
<div style="position:absolute;left:113.66px;top:532.00px" class="cls_020"><span class="cls_020">abs.d fd,fd</span></div>
<div style="position:absolute;left:208.25px;top:532.00px" class="cls_020"><span class="cls_020">fd = (fd > 0) ? fd: -fd;</span></div>
<div style="position:absolute;left:40.00px;top:549.00px" class="cls_020"><span class="cls_020">neg.d fd,fs</span></div>
<div style="position:absolute;left:208.07px;top:549.00px" class="cls_020"><span class="cls_020">fd = -fs;</span></div>
<div style="position:absolute;left:40.00px;top:566.01px" class="cls_020"><span class="cls_020">neg.d fd</span></div>
<div style="position:absolute;left:113.66px;top:566.01px" class="cls_020"><span class="cls_020">neg.d fd,fd</span></div>
<div style="position:absolute;left:208.25px;top:566.01px" class="cls_020"><span class="cls_020">fd = -fd;</span></div>
<div style="position:absolute;left:40.00px;top:583.01px" class="cls_020"><span class="cls_020">Convert between formats</span></div>
<div style="position:absolute;left:40.00px;top:593.01px" class="cls_020"><span class="cls_020">cvt.X.Y should be read “convert TO X FROM Y”</span></div>
<div style="position:absolute;left:40.00px;top:610.01px" class="cls_020"><span class="cls_020">cvt.d.s fd,fs</span></div>
<div style="position:absolute;left:208.10px;top:610.01px" class="cls_020"><span class="cls_020">fd = (double) ((float) fs);</span></div>
<div style="position:absolute;left:40.00px;top:627.01px" class="cls_020"><span class="cls_020">cvt.d.s fd</span></div>
<div style="position:absolute;left:113.67px;top:627.01px" class="cls_020"><span class="cls_020">cvt.d.s fd,fd</span></div>
<div style="position:absolute;left:208.28px;top:627.01px" class="cls_020"><span class="cls_020">fd = (double) ((float) fd);</span></div>
<div style="position:absolute;left:40.00px;top:644.01px" class="cls_020"><span class="cls_020">cvt.d.w fd,fs</span></div>
<div style="position:absolute;left:208.11px;top:644.01px" class="cls_020"><span class="cls_020">fd = (double) ((int) fs);</span></div>
<div style="position:absolute;left:40.00px;top:661.01px" class="cls_020"><span class="cls_020">cvt.d.w fd</span></div>
<div style="position:absolute;left:113.68px;top:661.01px" class="cls_020"><span class="cls_020">cvt.d. fd,fs</span></div>
<div style="position:absolute;left:208.27px;top:661.01px" class="cls_020"><span class="cls_020">fd = (double) ((int) fd);</span></div>
<div style="position:absolute;left:40.00px;top:678.01px" class="cls_020"><span class="cls_020">cvt.s.d fd,fs</span></div>
<div style="position:absolute;left:208.10px;top:678.01px" class="cls_020"><span class="cls_020">fd = (float) ((double) fs);</span></div>
<div style="position:absolute;left:40.00px;top:695.01px" class="cls_020"><span class="cls_020">cvt.s.d fd</span></div>
<div style="position:absolute;left:113.67px;top:695.01px" class="cls_020"><span class="cls_020">cvt.s.d fd,fd</span></div>
<div style="position:absolute;left:208.28px;top:695.01px" class="cls_020"><span class="cls_020">fd = (float) ((double) fd);</span></div>
<div style="position:absolute;left:137.68px;top:714.01px" class="cls_020"><span class="cls_020">Table 9.2: Assembler instructions</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">9–28</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:109072px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:525.20px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:228.90px;top:56.98px" class="cls_020"><span class="cls_020">Assembler</span></div>
<div style="position:absolute;left:309.95px;top:56.98px" class="cls_020"><span class="cls_020">Expands To</span></div>
<div style="position:absolute;left:451.17px;top:56.98px" class="cls_020"><span class="cls_020">What it does</span></div>
<div style="position:absolute;left:220.00px;top:76.00px" class="cls_020"><span class="cls_020">cvt.s.w fd,fs</span></div>
<div style="position:absolute;left:388.10px;top:76.00px" class="cls_020"><span class="cls_020">fd = (float)((int) fs);</span></div>
<div style="position:absolute;left:220.00px;top:93.00px" class="cls_020"><span class="cls_020">cvt.s.w fd</span></div>
<div style="position:absolute;left:293.68px;top:93.00px" class="cls_020"><span class="cls_020">cvt.s.w fd,fd</span></div>
<div style="position:absolute;left:388.30px;top:93.00px" class="cls_020"><span class="cls_020">fd = (float)((int) fd);</span></div>
<div style="position:absolute;left:220.00px;top:110.00px" class="cls_020"><span class="cls_020">cvt.w.d fd,fs</span></div>
<div style="position:absolute;left:388.11px;top:110.00px" class="cls_020"><span class="cls_020">/* note integer value is chosen</span></div>
<div style="position:absolute;left:390.75px;top:120.00px" class="cls_020"><span class="cls_020">* according to rounding mode */</span></div>
<div style="position:absolute;left:387.87px;top:130.00px" class="cls_020"><span class="cls_020">fd = (int)((double) fs);</span></div>
<div style="position:absolute;left:220.00px;top:147.00px" class="cls_020"><span class="cls_020">cvt.w.d fd</span></div>
<div style="position:absolute;left:293.68px;top:147.00px" class="cls_020"><span class="cls_020">cvt.w.d fd,fd</span></div>
<div style="position:absolute;left:388.30px;top:147.00px" class="cls_020"><span class="cls_020">fd = (int)((double) fd);</span></div>
<div style="position:absolute;left:220.00px;top:164.00px" class="cls_020"><span class="cls_020">cvt.w.s fd,fs</span></div>
<div style="position:absolute;left:388.10px;top:164.00px" class="cls_020"><span class="cls_020">fd = (int)((float) fs);</span></div>
<div style="position:absolute;left:220.00px;top:181.00px" class="cls_020"><span class="cls_020">cvt.w.s fd</span></div>
<div style="position:absolute;left:293.68px;top:181.00px" class="cls_020"><span class="cls_020">cvt.w.s fd,fd</span></div>
<div style="position:absolute;left:388.30px;top:181.00px" class="cls_020"><span class="cls_020">fd = (int)((float) fd);</span></div>
<div style="position:absolute;left:220.00px;top:198.00px" class="cls_020"><span class="cls_020">Convert from floating-point to integer</span></div>
<div style="position:absolute;left:220.00px;top:208.00px" class="cls_020"><span class="cls_020">using an explicit rounding mode.</span></div>
<div style="position:absolute;left:220.00px;top:218.00px" class="cls_027"><span class="cls_027">Note: rt is used as a temporary.</span></div>
<div style="position:absolute;left:220.00px;top:235.00px" class="cls_020"><span class="cls_020">ceil.w.d fd,fs,rt</span></div>
<div style="position:absolute;left:293.81px;top:235.00px" class="cls_020"><span class="cls_020">cfc1 rt,$31</span></div>
<div style="position:absolute;left:387.87px;top:234.99px" class="cls_020"><span class="cls_020">fd = ceil((double) fd);</span></div>
<div style="position:absolute;left:293.49px;top:245.00px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:293.49px;top:255.00px" class="cls_020"><span class="cls_020">ori $at,rt,3</span></div>
<div style="position:absolute;left:293.49px;top:265.00px" class="cls_020"><span class="cls_020">xori $at,$at,1</span></div>
<div style="position:absolute;left:293.49px;top:275.00px" class="cls_020"><span class="cls_020">ctc1</span></div>
<div style="position:absolute;left:314.73px;top:275.00px" class="cls_020"><span class="cls_020">$at,$31</span></div>
<div style="position:absolute;left:293.49px;top:285.00px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:293.49px;top:295.00px" class="cls_020"><span class="cls_020">cvt.w.d fd,fs</span></div>
<div style="position:absolute;left:293.49px;top:305.00px" class="cls_020"><span class="cls_020">ctc1 rt,$31</span></div>
<div style="position:absolute;left:220.00px;top:322.00px" class="cls_020"><span class="cls_020">floor.w.d</span></div>
<div style="position:absolute;left:293.49px;top:322.00px" class="cls_020"><span class="cls_020">cfc1 rt,$31</span></div>
<div style="position:absolute;left:387.87px;top:321.99px" class="cls_020"><span class="cls_020">fd = floor((double) fd);</span></div>
<div style="position:absolute;left:220.00px;top:332.00px" class="cls_020"><span class="cls_020">fd,fs,rt</span></div>
<div style="position:absolute;left:293.49px;top:332.00px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:293.49px;top:341.99px" class="cls_020"><span class="cls_020">ori $at,rt,3</span></div>
<div style="position:absolute;left:293.49px;top:351.99px" class="cls_020"><span class="cls_020">xori $at,$at,0</span></div>
<div style="position:absolute;left:293.49px;top:361.99px" class="cls_020"><span class="cls_020">ctc1</span></div>
<div style="position:absolute;left:314.73px;top:361.99px" class="cls_020"><span class="cls_020">$at,$31</span></div>
<div style="position:absolute;left:293.49px;top:371.99px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:293.49px;top:381.99px" class="cls_020"><span class="cls_020">cvt.w.d fd,fs</span></div>
<div style="position:absolute;left:293.49px;top:391.99px" class="cls_020"><span class="cls_020">ctc1 rt,$31</span></div>
<div style="position:absolute;left:220.00px;top:408.99px" class="cls_020"><span class="cls_020">round.w.d</span></div>
<div style="position:absolute;left:293.49px;top:408.99px" class="cls_020"><span class="cls_020">cfc1 rt,$31</span></div>
<div style="position:absolute;left:387.87px;top:408.98px" class="cls_020"><span class="cls_020">fd = round((double) fd);</span></div>
<div style="position:absolute;left:220.00px;top:418.99px" class="cls_020"><span class="cls_020">fd,fs,rt</span></div>
<div style="position:absolute;left:293.49px;top:418.99px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:293.49px;top:428.99px" class="cls_020"><span class="cls_020">ori $at,rt,3</span></div>
<div style="position:absolute;left:293.49px;top:438.99px" class="cls_020"><span class="cls_020">xori $at,$at,2</span></div>
<div style="position:absolute;left:293.49px;top:448.99px" class="cls_020"><span class="cls_020">ctc1</span></div>
<div style="position:absolute;left:314.73px;top:448.99px" class="cls_020"><span class="cls_020">$at,$31</span></div>
<div style="position:absolute;left:293.49px;top:458.99px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:293.49px;top:468.98px" class="cls_020"><span class="cls_020">cvt.w.d fd,fs</span></div>
<div style="position:absolute;left:293.49px;top:478.98px" class="cls_020"><span class="cls_020">ctc1 rt,$31</span></div>
<div style="position:absolute;left:220.00px;top:495.98px" class="cls_020"><span class="cls_020">trunc.w.d</span></div>
<div style="position:absolute;left:293.49px;top:495.98px" class="cls_020"><span class="cls_020">cfc1 rt,$31</span></div>
<div style="position:absolute;left:387.87px;top:495.98px" class="cls_020"><span class="cls_020">fd = (int) ((double) fd);</span></div>
<div style="position:absolute;left:220.00px;top:505.98px" class="cls_020"><span class="cls_020">fd,fs,rt</span></div>
<div style="position:absolute;left:293.49px;top:505.98px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:293.49px;top:515.98px" class="cls_020"><span class="cls_020">ori $at,rt,3</span></div>
<div style="position:absolute;left:293.49px;top:525.98px" class="cls_020"><span class="cls_020">xori $at,$at,2</span></div>
<div style="position:absolute;left:293.49px;top:535.98px" class="cls_020"><span class="cls_020">ctc1</span></div>
<div style="position:absolute;left:314.73px;top:535.98px" class="cls_020"><span class="cls_020">$at,$31</span></div>
<div style="position:absolute;left:293.49px;top:545.98px" class="cls_020"><span class="cls_020">nop</span></div>
<div style="position:absolute;left:293.49px;top:555.98px" class="cls_020"><span class="cls_020">cvt.w.d fd,fs</span></div>
<div style="position:absolute;left:293.49px;top:565.98px" class="cls_020"><span class="cls_020">ctc1 rt,$31</span></div>
<div style="position:absolute;left:220.00px;top:582.98px" class="cls_020"><span class="cls_020">ceil.w.s fd,fs,rt</span></div>
<div style="position:absolute;left:293.49px;top:582.98px" class="cls_027"><span class="cls_027">see above</span></div>
<div style="position:absolute;left:387.89px;top:582.98px" class="cls_020"><span class="cls_020">fd = ceil((float) fd);</span></div>
<div style="position:absolute;left:220.00px;top:599.98px" class="cls_020"><span class="cls_020">floor.w.s</span></div>
<div style="position:absolute;left:293.49px;top:599.98px" class="cls_027"><span class="cls_027">see above</span></div>
<div style="position:absolute;left:387.89px;top:599.98px" class="cls_020"><span class="cls_020">fd = floor((float) fd);</span></div>
<div style="position:absolute;left:220.00px;top:609.98px" class="cls_020"><span class="cls_020">fd,fs,rt</span></div>
<div style="position:absolute;left:220.00px;top:626.98px" class="cls_020"><span class="cls_020">round.w.s</span></div>
<div style="position:absolute;left:293.49px;top:626.98px" class="cls_027"><span class="cls_027">see above</span></div>
<div style="position:absolute;left:387.89px;top:626.98px" class="cls_020"><span class="cls_020">fd = round((float) fd);</span></div>
<div style="position:absolute;left:220.00px;top:636.98px" class="cls_020"><span class="cls_020">fd,fs,rt</span></div>
<div style="position:absolute;left:220.00px;top:653.98px" class="cls_020"><span class="cls_020">trunc.w.s</span></div>
<div style="position:absolute;left:293.49px;top:653.98px" class="cls_027"><span class="cls_027">see above</span></div>
<div style="position:absolute;left:387.89px;top:653.98px" class="cls_020"><span class="cls_020">fd = (int) ((float) fd);</span></div>
<div style="position:absolute;left:220.00px;top:663.98px" class="cls_020"><span class="cls_020">fd,fs,rt</span></div>
<div style="position:absolute;left:220.00px;top:680.98px" class="cls_020"><span class="cls_020">Arithmetic operations</span></div>
<div style="position:absolute;left:220.00px;top:690.98px" class="cls_020"><span class="cls_020">all can trap under some circumstances</span></div>
<div style="position:absolute;left:317.68px;top:709.99px" class="cls_020"><span class="cls_020">Table 9.2: Assembler instructions</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">9–29</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:109874px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:376.95px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:48.90px;top:57.01px" class="cls_020"><span class="cls_020">Assembler</span></div>
<div style="position:absolute;left:129.95px;top:57.01px" class="cls_020"><span class="cls_020">Expands To</span></div>
<div style="position:absolute;left:271.17px;top:57.01px" class="cls_020"><span class="cls_020">What it does</span></div>
<div style="position:absolute;left:40.00px;top:76.00px" class="cls_020"><span class="cls_020">add.d fd,fs,ft</span></div>
<div style="position:absolute;left:208.12px;top:76.00px" class="cls_020"><span class="cls_020">fd = fs + ft;</span></div>
<div style="position:absolute;left:40.00px;top:93.00px" class="cls_020"><span class="cls_020">add.d fd,fs</span></div>
<div style="position:absolute;left:113.70px;top:93.00px" class="cls_020"><span class="cls_020">add.d fd,fd,fs</span></div>
<div style="position:absolute;left:208.34px;top:93.00px" class="cls_020"><span class="cls_020">fd += fs;</span></div>
<div style="position:absolute;left:40.00px;top:110.00px" class="cls_020"><span class="cls_020">div.d fd,fs,ft</span></div>
<div style="position:absolute;left:208.11px;top:110.00px" class="cls_020"><span class="cls_020">fd = fs/ft;</span></div>
<div style="position:absolute;left:40.00px;top:127.00px" class="cls_020"><span class="cls_020">div.d fd,fs</span></div>
<div style="position:absolute;left:113.69px;top:127.00px" class="cls_020"><span class="cls_020">div.d fd,fd,,fs</span></div>
<div style="position:absolute;left:208.33px;top:127.00px" class="cls_020"><span class="cls_020">fd /= fs;</span></div>
<div style="position:absolute;left:40.00px;top:144.00px" class="cls_020"><span class="cls_020">mul.d fd,fs,ft</span></div>
<div style="position:absolute;left:208.12px;top:144.00px" class="cls_020"><span class="cls_020">fd = fs*ft;</span></div>
<div style="position:absolute;left:40.00px;top:161.01px" class="cls_020"><span class="cls_020">mul.d fd,fs</span></div>
<div style="position:absolute;left:113.70px;top:161.01px" class="cls_020"><span class="cls_020">mul.d fd,fd,fs</span></div>
<div style="position:absolute;left:208.35px;top:161.01px" class="cls_020"><span class="cls_020">fd *= fs;</span></div>
<div style="position:absolute;left:40.00px;top:178.01px" class="cls_020"><span class="cls_020">sub.d fd,fs,ft</span></div>
<div style="position:absolute;left:208.12px;top:178.01px" class="cls_020"><span class="cls_020">fd = fs - ft;</span></div>
<div style="position:absolute;left:40.00px;top:195.01px" class="cls_020"><span class="cls_020">sub.d fd,fs</span></div>
<div style="position:absolute;left:113.70px;top:195.01px" class="cls_020"><span class="cls_020">sub.d fd,fd,fs</span></div>
<div style="position:absolute;left:208.34px;top:195.01px" class="cls_020"><span class="cls_020">fd -= fs;</span></div>
<div style="position:absolute;left:40.00px;top:212.01px" class="cls_020"><span class="cls_020">Conditional branch following test</span></div>
<div style="position:absolute;left:40.00px;top:229.01px" class="cls_020"><span class="cls_020">bc1f label</span></div>
<div style="position:absolute;left:208.07px;top:229.01px" class="cls_020"><span class="cls_020">if (!fpcond)</span></div>
<div style="position:absolute;left:210.75px;top:239.01px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:40.00px;top:256.01px" class="cls_020"><span class="cls_020">bc1t label</span></div>
<div style="position:absolute;left:208.07px;top:256.01px" class="cls_020"><span class="cls_020">if (fpcond)</span></div>
<div style="position:absolute;left:210.75px;top:266.01px" class="cls_020"><span class="cls_020">goto label;</span></div>
<div style="position:absolute;left:40.00px;top:283.01px" class="cls_020"><span class="cls_020">Move data between FP and integer register</span></div>
<div style="position:absolute;left:40.00px;top:300.01px" class="cls_020"><span class="cls_020">mfc1 rd,fs</span></div>
<div style="position:absolute;left:208.07px;top:300.01px" class="cls_020"><span class="cls_020">/* no format conversion done, just copies</span></div>
<div style="position:absolute;left:210.75px;top:310.01px" class="cls_020"><span class="cls_020">* bits. Can use odd-numbered fp</span></div>
<div style="position:absolute;left:207.87px;top:320.01px" class="cls_020"><span class="cls_020">registers</span></div>
<div style="position:absolute;left:251.31px;top:320.01px" class="cls_020"><span class="cls_020">*/</span></div>
<div style="position:absolute;left:207.87px;top:330.01px" class="cls_020"><span class="cls_020">rd = fs;</span></div>
<div style="position:absolute;left:40.00px;top:347.01px" class="cls_020"><span class="cls_020">mtc1 rs,fd</span></div>
<div style="position:absolute;left:208.07px;top:347.01px" class="cls_020"><span class="cls_020">/* no format conversion done, just copies</span></div>
<div style="position:absolute;left:210.75px;top:357.01px" class="cls_020"><span class="cls_020">* bits. Can use odd-numbered fp</span></div>
<div style="position:absolute;left:207.87px;top:367.01px" class="cls_020"><span class="cls_020">registers</span></div>
<div style="position:absolute;left:251.31px;top:367.01px" class="cls_020"><span class="cls_020">*/</span></div>
<div style="position:absolute;left:207.87px;top:377.01px" class="cls_020"><span class="cls_020">fd = rs;</span></div>
<div style="position:absolute;left:40.00px;top:394.01px" class="cls_020"><span class="cls_020">mfc1.d $t2,$f2</span></div>
<div style="position:absolute;left:113.78px;top:394.01px" class="cls_020"><span class="cls_020">mfc1</span></div>
<div style="position:absolute;left:138.26px;top:394.01px" class="cls_020"><span class="cls_020">$t2,$f3</span></div>
<div style="position:absolute;left:208.41px;top:394.01px" class="cls_020"><span class="cls_020">/* move a double value (just bits, no</span></div>
<div style="position:absolute;left:210.75px;top:404.01px" class="cls_020"><span class="cls_020">* conversion) from integer register pair</span></div>
<div style="position:absolute;left:113.49px;top:411.01px" class="cls_020"><span class="cls_020">mfc1</span></div>
<div style="position:absolute;left:137.97px;top:411.01px" class="cls_020"><span class="cls_020">$t3,$f2</span></div>
<div style="position:absolute;left:210.75px;top:414.00px" class="cls_020"><span class="cls_020">*to FP reg pair */</span></div>
<div style="position:absolute;left:40.00px;top:431.01px" class="cls_020"><span class="cls_020">mtc1.d $t2,$f2</span></div>
<div style="position:absolute;left:113.78px;top:431.01px" class="cls_020"><span class="cls_020">mtc1</span></div>
<div style="position:absolute;left:138.80px;top:431.01px" class="cls_020"><span class="cls_020">$t2,$f3</span></div>
<div style="position:absolute;left:208.41px;top:431.01px" class="cls_020"><span class="cls_020">/* move a double value (just bits, no</span></div>
<div style="position:absolute;left:210.75px;top:441.00px" class="cls_020"><span class="cls_020">* conversion)from integer register pair</span></div>
<div style="position:absolute;left:113.49px;top:448.01px" class="cls_020"><span class="cls_020">mtc1</span></div>
<div style="position:absolute;left:138.51px;top:448.01px" class="cls_020"><span class="cls_020">$t3,$f2</span></div>
<div style="position:absolute;left:210.75px;top:451.00px" class="cls_020"><span class="cls_020">*to FP reg pair */</span></div>
<div style="position:absolute;left:40.00px;top:468.00px" class="cls_020"><span class="cls_020">CPU control instructions (privileged mode only)</span></div>
<div style="position:absolute;left:40.00px;top:485.01px" class="cls_020"><span class="cls_020">mfc0 rd, nn</span></div>
<div style="position:absolute;left:208.09px;top:485.01px" class="cls_020"><span class="cls_020">rd = (contents of CPU control reg nn);</span></div>
<div style="position:absolute;left:40.00px;top:502.01px" class="cls_020"><span class="cls_020">mtc0 rs, nn</span></div>
<div style="position:absolute;left:208.09px;top:502.01px" class="cls_020"><span class="cls_020">(CPU control reg nn) = rs;</span></div>
<div style="position:absolute;left:40.00px;top:519.01px" class="cls_020"><span class="cls_020">tlbr</span></div>
<div style="position:absolute;left:207.95px;top:519.01px" class="cls_020"><span class="cls_020">These instructions are used to setup the</span></div>
<div style="position:absolute;left:207.87px;top:529.01px" class="cls_020"><span class="cls_020">TLB (memory management hardware) and</span></div>
<div style="position:absolute;left:40.00px;top:536.01px" class="cls_020"><span class="cls_020">tlbwi</span></div>
<div style="position:absolute;left:207.87px;top:539.01px" class="cls_020"><span class="cls_020">are described in Chapters 2 & 3.</span></div>
<div style="position:absolute;left:40.00px;top:553.01px" class="cls_020"><span class="cls_020">tlbwr</span></div>
<div style="position:absolute;left:40.00px;top:570.01px" class="cls_020"><span class="cls_020">tlbpr</span></div>
<div style="position:absolute;left:40.00px;top:587.01px" class="cls_020"><span class="cls_020">rfe</span></div>
<div style="position:absolute;left:207.93px;top:587.01px" class="cls_020"><span class="cls_020">Used at the end of an exception routine</span></div>
<div style="position:absolute;left:207.87px;top:597.01px" class="cls_020"><span class="cls_020">Restores kernel-mode and global</span></div>
<div style="position:absolute;left:207.87px;top:607.01px" class="cls_020"><span class="cls_020">interrupt enable bits from the 3-level</span></div>
<div style="position:absolute;left:207.87px;top:617.01px" class="cls_020"><span class="cls_020">“stack” in the status register SR. See</span></div>
<div style="position:absolute;left:207.87px;top:627.01px" class="cls_020"><span class="cls_020">chapter 3.</span></div>
<div style="position:absolute;left:137.68px;top:646.01px" class="cls_020"><span class="cls_020">Table 9.2: Assembler instructions</span></div>
<div style="position:absolute;left:36.00px;top:666.00px" class="cls_015"><span class="cls_015">ALPHABETIC LIST OF ASSEMBLER INSTRUCTIONS</span></div>
<div style="position:absolute;left:48.02px;top:679.67px" class="cls_006"><span class="cls_006">In this list real hardware instructions are marked with a dagger.</span></div>
<div style="position:absolute;left:36.00px;top:701.67px" class="cls_041"><span class="cls_041">abs rd,rs</span><span class="cls_029">: integer absolute value</span></div>
<div style="position:absolute;left:36.00px;top:712.67px" class="cls_041"><span class="cls_041">abs.d fd,fs</span><span class="cls_029">†: FP double precision absolute value</span></div>
<div style="position:absolute;left:36.00px;top:723.67px" class="cls_041"><span class="cls_041">abs.s fd,fs</span><span class="cls_029">†: FP single precision absolute value</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">9–30</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:110676px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:525.20px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:216.00px;top:50.67px" class="cls_041"><span class="cls_041">add rd,rs,rt_imm</span><span class="cls_029">†: add, trap on overflow</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_041"><span class="cls_041">add.d fd,fs,ft</span><span class="cls_029">†: FP double precision add</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_041"><span class="cls_041">add.s fd,fs1,fs2</span><span class="cls_029">†: FP single precision add</span></div>
<div style="position:absolute;left:216.00px;top:83.67px" class="cls_041"><span class="cls_041">addi rd,rs,imm</span><span class="cls_029">†: add immediate, trap on overflow</span></div>
<div style="position:absolute;left:216.00px;top:94.67px" class="cls_041"><span class="cls_041">addiu rd,rs,imm</span><span class="cls_029">†: add immediate, never trap</span></div>
<div style="position:absolute;left:216.00px;top:105.67px" class="cls_041"><span class="cls_041">addu rd,rs,rt_imm</span><span class="cls_029">†: add, never trap</span></div>
<div style="position:absolute;left:216.00px;top:116.67px" class="cls_041"><span class="cls_041">and rd,rs,rt_imm</span><span class="cls_029">†: logical AND</span></div>
<div style="position:absolute;left:216.00px;top:127.67px" class="cls_041"><span class="cls_041">andi rd,rs,imm</span><span class="cls_029">†: logical AND immediate</span></div>
<div style="position:absolute;left:216.00px;top:138.67px" class="cls_041"><span class="cls_041">bal label</span><span class="cls_029">: PC-relative subroutine call</span></div>
<div style="position:absolute;left:216.00px;top:149.67px" class="cls_041"><span class="cls_041">bc0f offset</span><span class="cls_029">†: branch if CPCOND input signal inactive</span></div>
<div style="position:absolute;left:216.00px;top:160.67px" class="cls_041"><span class="cls_041">bc0t offset</span><span class="cls_029">†: branch if CPCOND input signal active</span></div>
<div style="position:absolute;left:216.00px;top:171.67px" class="cls_041"><span class="cls_041">bc1f label</span><span class="cls_029">†: branch if FP condition bit clear</span></div>
<div style="position:absolute;left:216.00px;top:182.67px" class="cls_041"><span class="cls_041">bc1t label</span><span class="cls_029">†: branch if FP condition bit set</span></div>
<div style="position:absolute;left:216.00px;top:193.67px" class="cls_041"><span class="cls_041">beq rs,rt,label</span><span class="cls_029">†: branch if rs == rt</span></div>
<div style="position:absolute;left:216.00px;top:204.67px" class="cls_041"><span class="cls_041">beqz rs,label</span><span class="cls_029">: branch if rs is zero</span></div>
<div style="position:absolute;left:216.00px;top:215.67px" class="cls_041"><span class="cls_041">bge rs,rt,label</span><span class="cls_029">: branch if rs </span><span class="cls_003">≥</span><span class="cls_029"> rt (signed compare)</span></div>
<div style="position:absolute;left:216.00px;top:226.67px" class="cls_041"><span class="cls_041">bgeu rs,rt,label</span><span class="cls_029">: branch if rs </span><span class="cls_003">≥</span><span class="cls_029"> rt (unsigned compare)</span></div>
<div style="position:absolute;left:216.00px;top:237.67px" class="cls_041"><span class="cls_041">bgez rs,label</span><span class="cls_029">†: branch if rs </span><span class="cls_003">≥</span><span class="cls_029"> 0 (signed)</span></div>
<div style="position:absolute;left:216.00px;top:248.67px" class="cls_041"><span class="cls_041">bgezal rs,label</span><span class="cls_029">†: branch to subroutine if rs == 0</span></div>
<div style="position:absolute;left:216.00px;top:259.67px" class="cls_041"><span class="cls_041">bgt rs,rt,label</span><span class="cls_029">: branch if rs > rt (signed)</span></div>
<div style="position:absolute;left:216.00px;top:270.67px" class="cls_041"><span class="cls_041">bgtu rs,rt,label</span><span class="cls_029">: branch if rs > rt (unsigned)</span></div>
<div style="position:absolute;left:216.00px;top:281.67px" class="cls_041"><span class="cls_041">bgtz rs,label</span><span class="cls_029">†: branch if rs > 0 (signed)</span></div>
<div style="position:absolute;left:216.00px;top:292.67px" class="cls_041"><span class="cls_041">ble rs,rt,label</span><span class="cls_029">: branch if rs </span><span class="cls_003">≤</span><span class="cls_029"> rt (signed)</span></div>
<div style="position:absolute;left:216.00px;top:303.67px" class="cls_041"><span class="cls_041">bleu rs,rt,label</span><span class="cls_029">: branch if rs </span><span class="cls_003">≤</span><span class="cls_029"> rt (unsigned)</span></div>
<div style="position:absolute;left:216.00px;top:314.67px" class="cls_041"><span class="cls_041">blez rs,label</span><span class="cls_029">†: branch if rs </span><span class="cls_003">≤</span><span class="cls_029"> 0 (signed)</span></div>
<div style="position:absolute;left:216.00px;top:325.67px" class="cls_041"><span class="cls_041">blt rs,rt,label</span><span class="cls_029">: branch rs &lt;rt (signed)</span></div>
<div style="position:absolute;left:216.00px;top:336.67px" class="cls_041"><span class="cls_041">bltu rs,rt,label</span><span class="cls_029">: branch rs &lt;rt (unsigned)</span></div>
<div style="position:absolute;left:216.00px;top:347.67px" class="cls_041"><span class="cls_041">bltz rs,label</span><span class="cls_029">†: branch if rs &lt;0 (signed)</span></div>
<div style="position:absolute;left:216.00px;top:358.67px" class="cls_041"><span class="cls_041">bltzal rs,label</span><span class="cls_029">†: branch to subroutine if rs &lt;0 (signed)</span></div>
<div style="position:absolute;left:216.00px;top:369.67px" class="cls_041"><span class="cls_041">bne rs,rt,label</span><span class="cls_029">†: branch if rs not equal to rt</span></div>
<div style="position:absolute;left:216.00px;top:380.67px" class="cls_041"><span class="cls_041">bnez rs,label</span><span class="cls_029">: branch if rs not zero</span></div>
<div style="position:absolute;left:216.00px;top:391.67px" class="cls_041"><span class="cls_041">break</span><span class="cls_029">†: trap with ‘‘breakpoint’’ Cause field</span></div>
<div style="position:absolute;left:216.00px;top:402.67px" class="cls_041"><span class="cls_041">c.XXX</span><span class="cls_029">.d fs1,fs2†: FP compare, set FP condition</span></div>
<div style="position:absolute;left:522.05px;top:402.67px" class="cls_029"><span class="cls_029">(double).</span></div>
<div style="position:absolute;left:216.00px;top:413.67px" class="cls_041"><span class="cls_041">c.XXX</span><span class="cls_029">.s fs1,fs2†: FP compare, set FP condition (single)</span></div>
<div style="position:absolute;left:216.00px;top:424.67px" class="cls_041"><span class="cls_041">cfc1 rd, crs</span><span class="cls_029">†: move FP control register ‘‘crs’’ contents to rd</span></div>
<div style="position:absolute;left:216.00px;top:435.67px" class="cls_041"><span class="cls_041">ctc1 rs, crd</span><span class="cls_029">†: move rs contents to FP control register ‘‘crs’’</span></div>
<div style="position:absolute;left:216.00px;top:446.67px" class="cls_041"><span class="cls_041">cvt.X.Y</span><span class="cls_029"> fd,fs†: FP convert from format Y to X. Y and X can be</span></div>
<div style="position:absolute;left:216.00px;top:457.67px" class="cls_029"><span class="cls_029">‘‘d’’ for double-precision, ‘‘s’’ for single-precision, and</span></div>
<div style="position:absolute;left:216.00px;top:468.67px" class="cls_029"><span class="cls_029">‘‘w’’ for 32-bit signed integer value held in an FP register.</span></div>
<div style="position:absolute;left:216.00px;top:479.67px" class="cls_041"><span class="cls_041">div rd,rs,rt</span><span class="cls_029">†: rd = rs/rt, trap division by zero or overflow</span></div>
<div style="position:absolute;left:216.00px;top:490.67px" class="cls_041"><span class="cls_041">div.d fd,fs,ft</span><span class="cls_029">†: FP double precision divide</span></div>
<div style="position:absolute;left:216.00px;top:501.67px" class="cls_041"><span class="cls_041">div.s fd,fs1,fs2</span><span class="cls_029">†: FP single precision divide</span></div>
<div style="position:absolute;left:216.00px;top:512.67px" class="cls_041"><span class="cls_041">divu rd,rs,rt</span><span class="cls_029">†: rd</span></div>
<div style="position:absolute;left:339.01px;top:512.67px" class="cls_029"><span class="cls_029">= rs/rt; trap divide by zero but not</span></div>
<div style="position:absolute;left:216.00px;top:523.67px" class="cls_029"><span class="cls_029">overflow</span></div>
<div style="position:absolute;left:216.00px;top:534.67px" class="cls_041"><span class="cls_041">j label</span><span class="cls_029">†: jump to label</span></div>
<div style="position:absolute;left:216.00px;top:545.67px" class="cls_041"><span class="cls_041">jal label</span><span class="cls_029">†: call subroutine at label (return address in ra/</span></div>
<div style="position:absolute;left:216.00px;top:556.67px" class="cls_029"><span class="cls_029">$31)</span></div>
<div style="position:absolute;left:216.00px;top:567.67px" class="cls_041"><span class="cls_041">jal rd,label</span><span class="cls_029">: call subroutine but put return address in rd</span></div>
<div style="position:absolute;left:216.00px;top:578.67px" class="cls_041"><span class="cls_041">jalr rs</span><span class="cls_029">†: call subroutine who’s address is in rs (return in</span></div>
<div style="position:absolute;left:216.00px;top:589.67px" class="cls_029"><span class="cls_029">ra/$31)</span></div>
<div style="position:absolute;left:216.00px;top:600.67px" class="cls_041"><span class="cls_041">jalr rd,rs</span><span class="cls_029">†: call subroutine at rs but put return address in</span></div>
<div style="position:absolute;left:216.00px;top:611.67px" class="cls_029"><span class="cls_029">rd</span></div>
<div style="position:absolute;left:216.00px;top:622.67px" class="cls_041"><span class="cls_041">jr rs</span><span class="cls_029">†: indirect jump to address stored in rs</span></div>
<div style="position:absolute;left:216.00px;top:633.67px" class="cls_041"><span class="cls_041">l.d fd, offset(rs): </span><span class="cls_029">load 64 bits to FP register</span></div>
<div style="position:absolute;left:216.00px;top:644.67px" class="cls_041"><span class="cls_041">l.s fd, offset(rs): </span><span class="cls_029">load 32 bits to FP register</span></div>
<div style="position:absolute;left:216.00px;top:655.67px" class="cls_041"><span class="cls_041">la rd,label</span><span class="cls_029">: load rd with address of label</span></div>
<div style="position:absolute;left:216.00px;top:666.67px" class="cls_041"><span class="cls_041">lb rd,offset(rs)</span><span class="cls_029">†: load byte from memory and sign-extend</span></div>
<div style="position:absolute;left:216.00px;top:677.67px" class="cls_041"><span class="cls_041">lbu rd,offset(rs)</span><span class="cls_029">†: load byte from memory and zero-extend</span></div>
<div style="position:absolute;left:216.00px;top:688.67px" class="cls_041"><span class="cls_041">lh rd,offset(rs)</span><span class="cls_029">†: load half-word</span></div>
<div style="position:absolute;left:426.86px;top:688.67px" class="cls_029"><span class="cls_029">(16bits) from memory and</span></div>
<div style="position:absolute;left:216.00px;top:699.67px" class="cls_029"><span class="cls_029">sign-extend</span></div>
<div style="position:absolute;left:216.00px;top:710.67px" class="cls_041"><span class="cls_041">lhu rd,offset(rs)</span><span class="cls_029">†: load half-word (16bits) from memory and</span></div>
<div style="position:absolute;left:216.00px;top:721.67px" class="cls_029"><span class="cls_029">sign-extend</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">9–31</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:111478px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:376.95px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:36.00px;top:50.67px" class="cls_041"><span class="cls_041">li rd,imm</span><span class="cls_029">: load constant value ‘‘imm’’ into rd</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_041"><span class="cls_041">lui rd,imm</span><span class="cls_029">†: load ‘‘imm’’ into the high bits of rd, zeroing</span></div>
<div style="position:absolute;left:36.00px;top:72.67px" class="cls_029"><span class="cls_029">low bits</span></div>
<div style="position:absolute;left:36.00px;top:83.67px" class="cls_041"><span class="cls_041">lw rd,offset(rs)</span><span class="cls_029">†: load word (32bits) into register</span></div>
<div style="position:absolute;left:36.00px;top:94.67px" class="cls_041"><span class="cls_041">lwc1 fd,offset(rs)</span><span class="cls_029">†: load 32-bits from memory to FP register</span></div>
<div style="position:absolute;left:36.00px;top:105.67px" class="cls_041"><span class="cls_041">lwl rd,offset(rs)</span><span class="cls_029">†: load word left, used for unaligned loads.</span></div>
<div style="position:absolute;left:36.00px;top:116.67px" class="cls_041"><span class="cls_041">lwr rd,offset(rs)</span><span class="cls_029">†: load word right, used for unaligned loads.</span></div>
<div style="position:absolute;left:36.00px;top:127.67px" class="cls_041"><span class="cls_041">mfc0 rd, crs</span><span class="cls_029">†: move contents of CPU control register crs to rd</span></div>
<div style="position:absolute;left:36.00px;top:138.67px" class="cls_041"><span class="cls_041">mfc1 rd,fs</span><span class="cls_029">†: move contents of FP register fs to rd</span></div>
<div style="position:absolute;left:36.00px;top:149.67px" class="cls_041"><span class="cls_041">mfc1.d rd,fs</span><span class="cls_029">: move contents of FP register pair fs to rd and</span></div>
<div style="position:absolute;left:36.00px;top:160.67px" class="cls_029"><span class="cls_029">next reg</span></div>
<div style="position:absolute;left:36.00px;top:171.67px" class="cls_041"><span class="cls_041">mfhi rd</span><span class="cls_029">†: put multiply result high word or divide’s remainder</span></div>
<div style="position:absolute;left:36.00px;top:182.67px" class="cls_029"><span class="cls_029">in rd</span></div>
<div style="position:absolute;left:36.00px;top:193.67px" class="cls_041"><span class="cls_041">mflo rd</span><span class="cls_029">†: put multiply result low word or divide result in rd</span></div>
<div style="position:absolute;left:36.00px;top:204.67px" class="cls_041"><span class="cls_041">mov.d fd,fs</span><span class="cls_029">†: move FP double from fs to fd</span></div>
<div style="position:absolute;left:36.00px;top:215.67px" class="cls_041"><span class="cls_041">mov.s fd,fs</span><span class="cls_029">†: move FP single from fs to fd</span></div>
<div style="position:absolute;left:36.00px;top:226.67px" class="cls_041"><span class="cls_041">move rd,rs</span><span class="cls_029">: move data from register rs to rd</span></div>
<div style="position:absolute;left:36.00px;top:237.67px" class="cls_041"><span class="cls_041">mtc0 rs, crd</span><span class="cls_029">†: put contents of rs into CPU control register</span></div>
<div style="position:absolute;left:36.00px;top:248.67px" class="cls_029"><span class="cls_029">crd</span></div>
<div style="position:absolute;left:36.00px;top:259.67px" class="cls_041"><span class="cls_041">mtc1 rs,fd</span><span class="cls_029">†: put bits from rs into FP register</span></div>
<div style="position:absolute;left:36.00px;top:270.67px" class="cls_041"><span class="cls_041">mtc1.d $t2,$f2</span><span class="cls_029">: put 64 bits from register pair starting at rs</span></div>
<div style="position:absolute;left:36.00px;top:281.67px" class="cls_029"><span class="cls_029">to FP register</span></div>
<div style="position:absolute;left:36.00px;top:292.67px" class="cls_041"><span class="cls_041">mthi  rs</span><span class="cls_029">†:  put  contents  of  rs  into  multiply  unit</span></div>
<div style="position:absolute;left:360.04px;top:292.67px" class="cls_029"><span class="cls_029">‘‘hi’’</span></div>
<div style="position:absolute;left:36.00px;top:303.67px" class="cls_029"><span class="cls_029">register</span></div>
<div style="position:absolute;left:36.00px;top:314.67px" class="cls_041"><span class="cls_041">mtlo  rs</span><span class="cls_029">†:  put  contents  of  rs  into  multiply  unit</span></div>
<div style="position:absolute;left:360.04px;top:314.67px" class="cls_029"><span class="cls_029">‘‘lo’’</span></div>
<div style="position:absolute;left:36.00px;top:325.67px" class="cls_029"><span class="cls_029">register</span></div>
<div style="position:absolute;left:36.00px;top:336.67px" class="cls_041"><span class="cls_041">mul rd,rs,rt</span><span class="cls_029">: rd = rs*rt, signed multiply, no overflow trap</span></div>
<div style="position:absolute;left:36.00px;top:347.67px" class="cls_041"><span class="cls_041">mul.d fd,fs,ft</span><span class="cls_029">†: FP double precision multiply</span></div>
<div style="position:absolute;left:36.00px;top:358.67px" class="cls_041"><span class="cls_041">mul.s fd,fs1,fs2</span><span class="cls_029">†: FP single precision multiply</span></div>
<div style="position:absolute;left:36.00px;top:369.67px" class="cls_041"><span class="cls_041">mulo rd,rs,rt</span><span class="cls_029">: rd = rs*rt, signed, will trap if overflows</span></div>
<div style="position:absolute;left:36.00px;top:380.67px" class="cls_041"><span class="cls_041">mulou rd,rs,rt</span><span class="cls_029">: rd = rs*rt unsigned, will trap if overflows</span></div>
<div style="position:absolute;left:36.00px;top:391.67px" class="cls_041"><span class="cls_041">mult rs,rt</span><span class="cls_029">†: start multiplying rs*rt as signed values</span></div>
<div style="position:absolute;left:36.00px;top:402.67px" class="cls_041"><span class="cls_041">multu rs1, rs2</span><span class="cls_029">†: start multiplying rs*rt as unsigned values</span></div>
<div style="position:absolute;left:36.00px;top:413.67px" class="cls_041"><span class="cls_041">neg rd,rs</span><span class="cls_029">: rd = -rs, trap on overflow</span></div>
<div style="position:absolute;left:36.00px;top:424.67px" class="cls_041"><span class="cls_041">neg.d fd,fs</span><span class="cls_029">†: fd = -fs, double FP, never traps</span></div>
<div style="position:absolute;left:36.00px;top:435.67px" class="cls_041"><span class="cls_041">neg.s fd,fs</span><span class="cls_029">†: fd = -fs, single FP, never traps</span></div>
<div style="position:absolute;left:36.00px;top:446.67px" class="cls_041"><span class="cls_041">negu rd,rs</span><span class="cls_029">: rd = -rs, no overflow check</span></div>
<div style="position:absolute;left:36.00px;top:457.67px" class="cls_041"><span class="cls_041">nor rd,rs,rt</span><span class="cls_029">†: rd = logical NOR of rs and rt</span></div>
<div style="position:absolute;left:36.00px;top:468.67px" class="cls_041"><span class="cls_041">not rd,rs</span><span class="cls_029">: rd = ~rs, logical NOT</span></div>
<div style="position:absolute;left:36.00px;top:479.67px" class="cls_041"><span class="cls_041">or rd,rs,rt_imm</span><span class="cls_029">†: rd = rs | rt, logical OR</span></div>
<div style="position:absolute;left:36.00px;top:490.67px" class="cls_041"><span class="cls_041">ori rd,rs,imm</span><span class="cls_029">†: logical OR, immediate form (don’t need to code</span></div>
<div style="position:absolute;left:36.00px;top:501.67px" class="cls_029"><span class="cls_029">this)</span></div>
<div style="position:absolute;left:36.00px;top:512.67px" class="cls_041"><span class="cls_041">rem rd,rs,rt</span><span class="cls_029">: rd = remainder of rs/rt, signed, trap divide by</span></div>
<div style="position:absolute;left:36.00px;top:523.67px" class="cls_029"><span class="cls_029">zero and overflow</span></div>
<div style="position:absolute;left:36.00px;top:534.67px" class="cls_041"><span class="cls_041">remu rd,rs,rt</span><span class="cls_029">: rd = remainder of rs/rt, unsigned, trap divide</span></div>
<div style="position:absolute;left:36.00px;top:545.67px" class="cls_029"><span class="cls_029">by zero</span></div>
<div style="position:absolute;left:36.00px;top:556.67px" class="cls_041"><span class="cls_041">rfe</span><span class="cls_029">†:  restores  CPU  status  register  at  end  of  exception</span></div>
<div style="position:absolute;left:36.00px;top:567.67px" class="cls_029"><span class="cls_029">processing</span></div>
<div style="position:absolute;left:36.00px;top:578.67px" class="cls_041"><span class="cls_041">rol rd,rs,rt</span><span class="cls_029">: rd = rs rotated left by rt</span></div>
<div style="position:absolute;left:36.00px;top:589.67px" class="cls_041"><span class="cls_041">ror rd,rs,rt</span><span class="cls_029">: rd = rs rotated right by rt</span></div>
<div style="position:absolute;left:36.00px;top:600.67px" class="cls_041"><span class="cls_041">s.d fs,offset(rs)</span><span class="cls_029">: store 64 bits from FP register</span></div>
<div style="position:absolute;left:36.00px;top:611.67px" class="cls_041"><span class="cls_041">s.s fs,offset(rs)</span><span class="cls_029">: store 32 bits from FP register</span></div>
<div style="position:absolute;left:36.00px;top:622.67px" class="cls_041"><span class="cls_041">sb rs2,offset(rs1)</span><span class="cls_029">†: store byte to memory</span></div>
<div style="position:absolute;left:36.00px;top:633.67px" class="cls_041"><span class="cls_041">seq rd,rs,rt</span><span class="cls_029">: set rd to 1 if rs == rt, 0 otherwise</span></div>
<div style="position:absolute;left:36.00px;top:644.67px" class="cls_041"><span class="cls_041">sge rd,rs,rt</span><span class="cls_029">: set rd to 1 if rs </span><span class="cls_003">≥</span><span class="cls_029"> rt (signed), 0 otherwise</span></div>
<div style="position:absolute;left:36.00px;top:655.67px" class="cls_041"><span class="cls_041">sgeu rd,rs,rt</span><span class="cls_029">: set rd to 1 if rs </span><span class="cls_003">≥</span><span class="cls_029"> rt (unsigned), 0 otherwise</span></div>
<div style="position:absolute;left:36.01px;top:666.67px" class="cls_041"><span class="cls_041">sgt rd,rs,rt</span><span class="cls_029">: set rd to 1 if rs > rt (signed), 0 otherwise</span></div>
<div style="position:absolute;left:36.01px;top:677.67px" class="cls_041"><span class="cls_041">sgtu rd,rs,rt</span><span class="cls_029">: set rd to 1 if rs > rt (unsigned), 0 otherwise</span></div>
<div style="position:absolute;left:36.01px;top:688.67px" class="cls_041"><span class="cls_041">sh rs2,offset(rs1)</span><span class="cls_029">†: store half-word (16bits) to memory</span></div>
<div style="position:absolute;left:36.01px;top:699.67px" class="cls_041"><span class="cls_041">sle rd,rs,rt</span><span class="cls_029">: set rd to 1 if rs </span><span class="cls_003">≤</span><span class="cls_029"> rt (signed), 0 otherwise</span></div>
<div style="position:absolute;left:36.01px;top:710.67px" class="cls_041"><span class="cls_041">sleu rd,rs,rt</span><span class="cls_029">: set rd to 1 if rs </span><span class="cls_003">≤</span><span class="cls_029"> rt (unsigned), 0 otherwise</span></div>
<div style="position:absolute;left:36.02px;top:721.67px" class="cls_041"><span class="cls_041">sll rd,rs,rt</span><span class="cls_029">†: rd = rs shifted left (bigger) by rt (max 31)</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">9–32</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:112280px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE PROGRAMMING</span></div>
<div style="position:absolute;left:525.20px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 9</span></div>
<div style="position:absolute;left:216.00px;top:50.67px" class="cls_041"><span class="cls_041">sllv rd,rs1,rs2</span><span class="cls_029">†: rd = rs shifted left (bigger) by rt (max 31)</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_041"><span class="cls_041">slt rd,rs,rt_imm</span><span class="cls_029">†: set rd to 1 if rs &lt;rt_imm (unsigned), 0</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_029"><span class="cls_029">otherwise</span></div>
<div style="position:absolute;left:216.00px;top:83.67px" class="cls_041"><span class="cls_041">slti rd,rs,imm</span><span class="cls_029">†: set rd to 1 if rs &lt;imm (signed), 0 otherwise</span></div>
<div style="position:absolute;left:216.00px;top:94.67px" class="cls_041"><span class="cls_041">sltiu  rd,rs,imm</span><span class="cls_029">†:  set rd  to</span></div>
<div style="position:absolute;left:402.01px;top:94.67px" class="cls_029"><span class="cls_029">1  if  rs</span></div>
<div style="position:absolute;left:460.82px;top:94.67px" class="cls_029"><span class="cls_029">&lt;imm</span></div>
<div style="position:absolute;left:494.43px;top:94.67px" class="cls_029"><span class="cls_029">(unsigned),</span></div>
<div style="position:absolute;left:570.04px;top:94.67px" class="cls_029"><span class="cls_029">0</span></div>
<div style="position:absolute;left:216.00px;top:105.67px" class="cls_029"><span class="cls_029">otherwise</span></div>
<div style="position:absolute;left:216.00px;top:116.67px" class="cls_041"><span class="cls_041">sltu rd,rs,rt_imm</span><span class="cls_029">†: set rd to 1 if rs &lt;rt_imm (unsigned), 0</span></div>
<div style="position:absolute;left:216.00px;top:127.67px" class="cls_029"><span class="cls_029">otherwise</span></div>
<div style="position:absolute;left:216.00px;top:138.67px" class="cls_041"><span class="cls_041">sne rd,rs,rt</span><span class="cls_029">: set rd to 1 if rs not equal to rt, 0 otherwise</span></div>
<div style="position:absolute;left:216.00px;top:149.67px" class="cls_041"><span class="cls_041">sra  rd,rs,rt</span><span class="cls_029">†:  rd</span></div>
<div style="position:absolute;left:338.41px;top:149.67px" class="cls_029"><span class="cls_029">=  rs  shifted  right  by  rt,  sign  bit</span></div>
<div style="position:absolute;left:216.00px;top:160.67px" class="cls_029"><span class="cls_029">propagates down</span></div>
<div style="position:absolute;left:216.00px;top:171.67px" class="cls_041"><span class="cls_041">srav  rd,rs,rt</span><span class="cls_029">†:  rd</span></div>
<div style="position:absolute;left:342.61px;top:171.67px" class="cls_029"><span class="cls_029">=  rs  shifted  right  by  rt,  sign  bit</span></div>
<div style="position:absolute;left:216.00px;top:182.67px" class="cls_029"><span class="cls_029">propagates down</span></div>
<div style="position:absolute;left:216.00px;top:193.67px" class="cls_041"><span class="cls_041">srl rd,rs,rt</span><span class="cls_029">†: rd = rs shifted right by rt, zeroes from top</span></div>
<div style="position:absolute;left:216.00px;top:204.67px" class="cls_041"><span class="cls_041">srlv rd,rs,rt</span><span class="cls_029">†: rd = rs shifted right by rt, zeroes from top</span></div>
<div style="position:absolute;left:216.00px;top:215.67px" class="cls_041"><span class="cls_041">sub rd,rs,rt_imm</span><span class="cls_029">†: rd = rs - rt_imm, trap if overflows</span></div>
<div style="position:absolute;left:216.00px;top:226.67px" class="cls_041"><span class="cls_041">sub.d fd,fs,ft</span><span class="cls_029">†: FP double precision subtract</span></div>
<div style="position:absolute;left:216.00px;top:237.67px" class="cls_041"><span class="cls_041">sub.s fd,fs1,fs2</span><span class="cls_029">†: FP single precision subtract</span></div>
<div style="position:absolute;left:216.00px;top:248.67px" class="cls_041"><span class="cls_041">subu rd,rs,rt</span><span class="cls_029">†: rd = rs - rt, no trap on overflow</span></div>
<div style="position:absolute;left:216.00px;top:259.67px" class="cls_041"><span class="cls_041">sw rs2,offset(rs1)</span><span class="cls_029">†: store word (32 bits) to memory</span></div>
<div style="position:absolute;left:216.00px;top:270.67px" class="cls_041"><span class="cls_041">swc1 fs, offset(rs)</span><span class="cls_029">†: store FP register value to memory</span></div>
<div style="position:absolute;left:216.00px;top:281.67px" class="cls_041"><span class="cls_041">swl rs2,offset(rs1)</span><span class="cls_029">†: store word left, used for unaligned</span></div>
<div style="position:absolute;left:216.00px;top:292.67px" class="cls_029"><span class="cls_029">stores</span></div>
<div style="position:absolute;left:216.00px;top:303.67px" class="cls_041"><span class="cls_041">swr rs2,offset(rs1)</span><span class="cls_029">†: store word right, used for unaligned</span></div>
<div style="position:absolute;left:216.00px;top:314.67px" class="cls_029"><span class="cls_029">stores</span></div>
<div style="position:absolute;left:216.00px;top:325.67px" class="cls_041"><span class="cls_041">syscall</span><span class="cls_029">†: trap with a ‘‘syscall’’ cause value</span></div>
<div style="position:absolute;left:216.00px;top:336.67px" class="cls_041"><span class="cls_041">tlbp</span><span class="cls_029">†: TLB (memory management unit) maintenance instruction</span></div>
<div style="position:absolute;left:216.00px;top:347.67px" class="cls_041"><span class="cls_041">tlbr</span><span class="cls_029">†: TLB (memory management unit) maintenance instruction</span></div>
<div style="position:absolute;left:216.00px;top:358.67px" class="cls_041"><span class="cls_041">tlbwi</span><span class="cls_029">†: TLB (memory management unit) maintenance instruction</span></div>
<div style="position:absolute;left:216.00px;top:369.67px" class="cls_041"><span class="cls_041">tlbwr</span><span class="cls_029">†: TLB (memory management unit) maintenance instruction</span></div>
<div style="position:absolute;left:216.00px;top:380.67px" class="cls_041"><span class="cls_041">xor rd,rs,rt_imm</span><span class="cls_029">†: rd = bitwise exclusive-OR of rs and rt_imm</span></div>
<div style="position:absolute;left:216.00px;top:391.67px" class="cls_041"><span class="cls_041">xori rd,rs,</span><span class="cls_029">imm†: explicit immediate form of ‘‘xor’’</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">9–33</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:113082px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">C PROGRAMMING</span></div>
<div style="position:absolute;left:459.00px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 10</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:228.02px;top:113.67px" class="cls_006"><span class="cls_006">An efficient C run-time environment relies on conventions (enforced by</span></div>
<div style="position:absolute;left:216.00px;top:124.67px" class="cls_006"><span class="cls_006">compilers and assembly language programmers) about register usage</span></div>
<div style="position:absolute;left:216.00px;top:135.67px" class="cls_006"><span class="cls_006">within C-compatible functions.</span></div>
<div style="position:absolute;left:216.00px;top:158.00px" class="cls_015"><span class="cls_015">THE STACK, SUBROUTINE LINKAGE, PARAMETER</span></div>
<div style="position:absolute;left:216.00px;top:171.00px" class="cls_015"><span class="cls_015">PASSING</span></div>
<div style="position:absolute;left:228.02px;top:184.67px" class="cls_006"><span class="cls_006">Many MIPS programs are written in mixed languages - for embedded</span></div>
<div style="position:absolute;left:216.00px;top:195.67px" class="cls_006"><span class="cls_006">systems programmers, this is most likely to be a mix of C (maybe C++) and</span></div>
<div style="position:absolute;left:216.00px;top:206.67px" class="cls_006"><span class="cls_006">assembler.</span></div>
<div style="position:absolute;left:228.02px;top:217.67px" class="cls_006"><span class="cls_006">From the very start MIPS Corporation established a set of conventions</span></div>
<div style="position:absolute;left:216.00px;top:228.67px" class="cls_006"><span class="cls_006">about   how   to   pass   arguments   to   functions</span></div>
<div style="position:absolute;left:467.70px;top:228.67px" class="cls_006"><span class="cls_006">(pass   parameters   to</span></div>
<div style="position:absolute;left:216.00px;top:239.67px" class="cls_006"><span class="cls_006">subroutines’), and how to return values from functions.</span></div>
<div style="position:absolute;left:228.02px;top:250.67px" class="cls_006"><span class="cls_006">These complex conventions start off quite simply: all arguments are</span></div>
<div style="position:absolute;left:216.00px;top:261.67px" class="cls_006"><span class="cls_006">allocated space in a data structure on the stack, but the first few</span></div>
<div style="position:absolute;left:216.00px;top:272.67px" class="cls_006"><span class="cls_006">arguments  are  placed  in  CPU  registers  and  the  stack  contents  left</span></div>
<div style="position:absolute;left:216.00px;top:283.67px" class="cls_006"><span class="cls_006">undefined. In practice, this optimization means that for most function calls</span></div>
<div style="position:absolute;left:216.00px;top:294.67px" class="cls_006"><span class="cls_006">the arguments are all passed in registers; but the stack data structure is</span></div>
<div style="position:absolute;left:216.00px;top:305.67px" class="cls_006"><span class="cls_006">the best starting point for understanding the process.</span></div>
<div style="position:absolute;left:216.00px;top:328.00px" class="cls_015"><span class="cls_015">Stack Argument structure</span></div>
<div style="position:absolute;left:228.02px;top:341.67px" class="cls_006"><span class="cls_006">The MIPS hardware does not directly support a stack, but the calling</span></div>
<div style="position:absolute;left:216.00px;top:352.67px" class="cls_006"><span class="cls_006">convention requires one. The stack is grown downwards and the current</span></div>
<div style="position:absolute;left:216.00px;top:363.67px" class="cls_006"><span class="cls_006">stack bottom is kept in register </span><span class="cls_008">sp</span><span class="cls_006"> (alias $29). Any OS which is providing</span></div>
<div style="position:absolute;left:216.00px;top:374.67px" class="cls_006"><span class="cls_006">protection and security will make no assumptions about the user’s stack,</span></div>
<div style="position:absolute;left:216.00px;top:385.67px" class="cls_006"><span class="cls_006">and the value of </span><span class="cls_008">sp</span><span class="cls_006"> doesn’t really matter except at the point where a</span></div>
<div style="position:absolute;left:216.00px;top:396.67px" class="cls_006"><span class="cls_006">function is called. But it is conventional to keep </span><span class="cls_008">sp</span><span class="cls_006"> at or below the lowest</span></div>
<div style="position:absolute;left:216.00px;top:407.67px" class="cls_006"><span class="cls_006">stack location your function has used.</span></div>
<div style="position:absolute;left:228.02px;top:418.67px" class="cls_006"><span class="cls_006">At the point where a function is called </span><span class="cls_008">sp</span><span class="cls_006"> must be 8-byte aligned (not</span></div>
<div style="position:absolute;left:216.00px;top:429.67px" class="cls_006"><span class="cls_006">required  by  R3000  CPU  hardware,  but  defined  to  simplify  future</span></div>
<div style="position:absolute;left:216.00px;top:440.67px" class="cls_006"><span class="cls_006">compatibility and part of the rules).</span></div>
<div style="position:absolute;left:228.02px;top:451.67px" class="cls_006"><span class="cls_006">So, to call a subroutine according to the MIPS standard, the caller</span></div>
<div style="position:absolute;left:216.00px;top:462.67px" class="cls_006"><span class="cls_006">creates a data structure on the stack to hold the arguments and sets </span><span class="cls_008">sp</span><span class="cls_006"> to</span></div>
<div style="position:absolute;left:216.00px;top:473.67px" class="cls_006"><span class="cls_006">point to it. The first argument (left-most in the C source) is lowest in</span></div>
<div style="position:absolute;left:216.00px;top:484.67px" class="cls_006"><span class="cls_006">memory. Each argument is expanded to at least 1 word (32 bits); </span><span class="cls_008">double</span></div>
<div style="position:absolute;left:216.00px;top:495.67px" class="cls_006"><span class="cls_006">(double-precision, 64-bit, floating point) values are aligned on an 8-byte</span></div>
<div style="position:absolute;left:216.00px;top:506.67px" class="cls_006"><span class="cls_006">boundary (as are data structures which contain a </span><span class="cls_008">double</span><span class="cls_006"> field).</span></div>
<div style="position:absolute;left:228.02px;top:517.67px" class="cls_006"><span class="cls_006">The argument structure really does look like a C </span><span class="cls_008">struct</span><span class="cls_006">, but there are two</span></div>
<div style="position:absolute;left:215.99px;top:528.67px" class="cls_006"><span class="cls_006">differences:</span></div>
<div style="position:absolute;left:228.01px;top:542.67px" class="cls_006"><span class="cls_006">• There are always at least 16 bytes of the structure, even if the</span></div>
<div style="position:absolute;left:239.96px;top:553.67px" class="cls_006"><span class="cls_006">arguments would fit in less;</span></div>
<div style="position:absolute;left:228.01px;top:567.67px" class="cls_006"><span class="cls_006">• each partial word (</span><span class="cls_008">char</span><span class="cls_006"> or </span><span class="cls_008">short</span><span class="cls_006">) argument appears in the structure</span></div>
<div style="position:absolute;left:239.98px;top:578.67px" class="cls_006"><span class="cls_006">as what is effectively an </span><span class="cls_008">int</span><span class="cls_006"> in memory. This does not apply to partial-</span></div>
<div style="position:absolute;left:239.98px;top:589.67px" class="cls_006"><span class="cls_006">word fields inside a </span><span class="cls_008">struct</span><span class="cls_006"> argument.</span></div>
<div style="position:absolute;left:216.00px;top:612.00px" class="cls_015"><span class="cls_015">Which arguments go in what registers</span></div>
<div style="position:absolute;left:228.02px;top:625.67px" class="cls_006"><span class="cls_006">Arguments assigned in the first 16 bytes (4 words) of the argument</span></div>
<div style="position:absolute;left:216.00px;top:636.67px" class="cls_006"><span class="cls_006">structure are passed in registers, and the caller can and does leave the first</span></div>
<div style="position:absolute;left:216.00px;top:647.67px" class="cls_006"><span class="cls_006">16 bytes of the structure undefined. The called function can save the</span></div>
<div style="position:absolute;left:216.00px;top:658.67px" class="cls_006"><span class="cls_006">values back in memory if it needs to reconstruct memory-held arguments.</span></div>
<div style="position:absolute;left:228.02px;top:669.67px" class="cls_006"><span class="cls_006">The four words of register argument values go in </span><span class="cls_008">a0</span><span class="cls_006"> through </span><span class="cls_008">a3</span></div>
<div style="position:absolute;left:216.00px;top:680.67px" class="cls_006"><span class="cls_006">respectively ($4 through $7), except where the caller can be sure that the</span></div>
<div style="position:absolute;left:216.00px;top:691.67px" class="cls_006"><span class="cls_006">data would be better loaded into floating point (FP) registers. The criteria</span></div>
<div style="position:absolute;left:216.00px;top:702.67px" class="cls_006"><span class="cls_006">for using FP registers can seem mystifying, but the rules are actually</span></div>
<div style="position:absolute;left:216.00px;top:713.67px" class="cls_006"><span class="cls_006">straight-forward:</span></div>
<div style="position:absolute;left:297.04px;top:754.68px" class="cls_002"><span class="cls_002">10-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:113884px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 10</span></div>
<div style="position:absolute;left:479.82px;top:28.00px" class="cls_002"><span class="cls_002">C PROGRAMMING</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> First value must be FP</span><span class="cls_006">: unless the first argument takes a FP value, the</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">FP registers are not used. This ensures that traditional functions like</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_008"><span class="cls_008">printf</span><span class="cls_006"> still work, although the number and type of arguments are</span></div>
<div style="position:absolute;left:59.98px;top:83.67px" class="cls_006"><span class="cls_006">variable. Moreover, it is relatively harmless: the majority of simple FP</span></div>
<div style="position:absolute;left:59.98px;top:94.67px" class="cls_006"><span class="cls_006">routines take only FP arguments.</span></div>
<div style="position:absolute;left:48.03px;top:108.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Only two FP values may be passed in registers</span><span class="cls_006">: and will be in FP</span></div>
<div style="position:absolute;left:59.98px;top:119.67px" class="cls_006"><span class="cls_006">registers $f12 and $f14 (implicitly using $f13 and $f15 for double-</span></div>
<div style="position:absolute;left:59.98px;top:130.67px" class="cls_006"><span class="cls_006">precision values).</span></div>
<div style="position:absolute;left:59.98px;top:144.67px" class="cls_006"><span class="cls_006">Two </span><span class="cls_008">doubles</span><span class="cls_006"> occupy 16 bytes, which is all the data anyone expected</span></div>
<div style="position:absolute;left:59.98px;top:155.67px" class="cls_006"><span class="cls_006">to be in registers. Historically, functions with lots of single-precision</span></div>
<div style="position:absolute;left:59.98px;top:166.67px" class="cls_006"><span class="cls_006">arguments are not frequent enough to make another rule.</span></div>
<div style="position:absolute;left:48.03px;top:177.67px" class="cls_006"><span class="cls_006">Just one more consideration: if a function returns a structure type, then</span></div>
<div style="position:absolute;left:36.01px;top:188.67px" class="cls_006"><span class="cls_006">the return-value convention involves the invention of a pointer as the</span></div>
<div style="position:absolute;left:36.01px;top:199.67px" class="cls_006"><span class="cls_006">implicit first argument before the first (visible) argument; this is described</span></div>
<div style="position:absolute;left:36.01px;top:210.67px" class="cls_006"><span class="cls_006">in detail below.</span></div>
<div style="position:absolute;left:36.00px;top:233.00px" class="cls_015"><span class="cls_015">Examples from the C library</span></div>
<div style="position:absolute;left:72.00px;top:257.00px" class="cls_028"><span class="cls_028">thesame = strncmp("bear", "bearer", 4);</span></div>
<div style="position:absolute;left:48.02px;top:276.67px" class="cls_006"><span class="cls_006">Leads to an argument structure whose fields are allocated as:</span></div>
<div style="position:absolute;left:122.71px;top:297.00px" class="cls_020"><span class="cls_020">Location   Contents</span></div>
<div style="position:absolute;left:263.57px;top:297.00px" class="cls_020"><span class="cls_020">In register</span></div>
<div style="position:absolute;left:122.71px;top:314.00px" class="cls_020"><span class="cls_020">sp+12</span></div>
<div style="position:absolute;left:169.49px;top:314.00px" class="cls_020"><span class="cls_020">&lt;undefined></span></div>
<div style="position:absolute;left:263.59px;top:314.00px" class="cls_020"><span class="cls_020">-</span></div>
<div style="position:absolute;left:122.71px;top:331.00px" class="cls_020"><span class="cls_020">sp+8</span></div>
<div style="position:absolute;left:169.46px;top:331.00px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:263.36px;top:331.00px" class="cls_020"><span class="cls_020">a2</span></div>
<div style="position:absolute;left:122.71px;top:348.00px" class="cls_020"><span class="cls_020">sp+4</span></div>
<div style="position:absolute;left:169.46px;top:348.00px" class="cls_020"><span class="cls_020">address of "bearer"</span></div>
<div style="position:absolute;left:263.69px;top:348.00px" class="cls_020"><span class="cls_020">a1</span></div>
<div style="position:absolute;left:122.71px;top:365.00px" class="cls_020"><span class="cls_020">sp+0</span></div>
<div style="position:absolute;left:169.46px;top:365.00px" class="cls_020"><span class="cls_020">address of "bear"</span></div>
<div style="position:absolute;left:263.65px;top:365.00px" class="cls_020"><span class="cls_020">a0</span></div>
<div style="position:absolute;left:48.02px;top:384.67px" class="cls_006"><span class="cls_006">There are less than 16 bytes of arguments, so they all fit in registers.</span></div>
<div style="position:absolute;left:48.02px;top:395.67px" class="cls_006"><span class="cls_006">That seems like a complex way of deciding to put three arguments into</span></div>
<div style="position:absolute;left:36.00px;top:406.67px" class="cls_006"><span class="cls_006">the usual registers. However, its value is clearer in the case of something</span></div>
<div style="position:absolute;left:36.00px;top:417.67px" class="cls_006"><span class="cls_006">a bit more tricky from the math library:</span></div>
<div style="position:absolute;left:72.00px;top:439.00px" class="cls_028"><span class="cls_028">double ldexp (double, int);</span></div>
<div style="position:absolute;left:72.00px;top:459.00px" class="cls_028"><span class="cls_028">y = ldexp(x, 23); /* y = x * (2**23) */</span></div>
<div style="position:absolute;left:48.02px;top:478.67px" class="cls_006"><span class="cls_006">The arguments come out as</span></div>
<div style="position:absolute;left:136.10px;top:499.01px" class="cls_020"><span class="cls_020">Location   Contents</span></div>
<div style="position:absolute;left:248.79px;top:499.01px" class="cls_020"><span class="cls_020">In register</span></div>
<div style="position:absolute;left:136.10px;top:516.01px" class="cls_020"><span class="cls_020">sp+12</span></div>
<div style="position:absolute;left:182.87px;top:516.01px" class="cls_020"><span class="cls_020">&lt;undefined></span></div>
<div style="position:absolute;left:248.81px;top:516.01px" class="cls_020"><span class="cls_020">-</span></div>
<div style="position:absolute;left:136.10px;top:533.01px" class="cls_020"><span class="cls_020">sp+8</span></div>
<div style="position:absolute;left:182.84px;top:533.01px" class="cls_020"><span class="cls_020">23</span></div>
<div style="position:absolute;left:248.60px;top:533.01px" class="cls_020"><span class="cls_020">a2</span></div>
<div style="position:absolute;left:136.10px;top:550.01px" class="cls_020"><span class="cls_020">sp+4</span></div>
<div style="position:absolute;left:182.84px;top:550.01px" class="cls_020"><span class="cls_020">(double) x</span></div>
<div style="position:absolute;left:248.74px;top:550.01px" class="cls_020"><span class="cls_020">$f12/$f13</span></div>
<div style="position:absolute;left:136.10px;top:567.01px" class="cls_020"><span class="cls_020">sp+0</span></div>
<div style="position:absolute;left:36.00px;top:592.00px" class="cls_015"><span class="cls_015">Exotic example; passing structures</span></div>
<div style="position:absolute;left:48.02px;top:605.67px" class="cls_006"><span class="cls_006">C allows the programmer to use structure types as arguments (it is</span></div>
<div style="position:absolute;left:36.00px;top:616.67px" class="cls_006"><span class="cls_006">much more common practice to pass pointers to structures instead, but</span></div>
<div style="position:absolute;left:36.00px;top:627.67px" class="cls_006"><span class="cls_006">the language supports both). In MIPS the structure forms part of the</span></div>
<div style="position:absolute;left:36.00px;top:638.67px" class="cls_006"><span class="cls_006">‘‘argument structure’’. In the following example:</span></div>
<div style="position:absolute;left:72.00px;top:660.00px" class="cls_028"><span class="cls_028">struct thing {</span></div>
<div style="position:absolute;left:108.00px;top:669.99px" class="cls_028"><span class="cls_028">char letter;</span></div>
<div style="position:absolute;left:108.00px;top:679.99px" class="cls_028"><span class="cls_028">short count;</span></div>
<div style="position:absolute;left:108.00px;top:689.99px" class="cls_028"><span class="cls_028">int value;</span></div>
<div style="position:absolute;left:72.00px;top:699.99px" class="cls_028"><span class="cls_028">} = {"z", 46, 100000};</span></div>
<div style="position:absolute;left:289.79px;top:755.33px" class="cls_002"><span class="cls_002">10-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:114686px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">C PROGRAMMING</span></div>
<div style="position:absolute;left:520.31px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 10</span></div>
<div style="position:absolute;left:252.00px;top:61.00px" class="cls_028"><span class="cls_028">(void) processthing (thing);</span></div>
<div style="position:absolute;left:308.08px;top:101.00px" class="cls_020"><span class="cls_020">Location   Contents</span></div>
<div style="position:absolute;left:438.21px;top:101.00px" class="cls_020"><span class="cls_020">In register</span></div>
<div style="position:absolute;left:308.08px;top:118.00px" class="cls_020"><span class="cls_020">sp+4</span></div>
<div style="position:absolute;left:354.82px;top:118.00px" class="cls_020"><span class="cls_020">100000</span></div>
<div style="position:absolute;left:438.11px;top:118.00px" class="cls_020"><span class="cls_020">a1</span></div>
<div style="position:absolute;left:308.08px;top:135.00px" class="cls_020"><span class="cls_020">sp+0</span></div>
<div style="position:absolute;left:354.82px;top:135.00px" class="cls_020"><span class="cls_020">‘‘z’’</span></div>
<div style="position:absolute;left:378.00px;top:135.00px" class="cls_020"><span class="cls_020">&lt;pad></span></div>
<div style="position:absolute;left:416.11px;top:135.00px" class="cls_020"><span class="cls_020">46</span></div>
<div style="position:absolute;left:438.21px;top:135.00px" class="cls_020"><span class="cls_020">a0</span></div>
<div style="position:absolute;left:228.02px;top:154.67px" class="cls_006"><span class="cls_006">In a big-endian CPU, the result of this is that the </span><span class="cls_008">char</span><span class="cls_006"> value in the</span></div>
<div style="position:absolute;left:216.00px;top:165.67px" class="cls_006"><span class="cls_006">structure should end up in the most-significant 8 bits of the argument</span></div>
<div style="position:absolute;left:216.00px;top:176.67px" class="cls_006"><span class="cls_006">register, but packed together with the </span><span class="cls_008">short</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:216.00px;top:199.00px" class="cls_015"><span class="cls_015">How printf() and varargs work</span></div>
<div style="position:absolute;left:228.02px;top:212.67px" class="cls_006"><span class="cls_006">Consider this example:</span></div>
<div style="position:absolute;left:252.00px;top:234.00px" class="cls_028"><span class="cls_028">printf ("length = %f, width = %f, num = %dn", 1.414, 1.0, 12);</span></div>
<div style="position:absolute;left:286.09px;top:274.00px" class="cls_020"><span class="cls_020">Location   Contents</span></div>
<div style="position:absolute;left:447.06px;top:274.00px" class="cls_020"><span class="cls_020">In register</span></div>
<div style="position:absolute;left:286.09px;top:291.00px" class="cls_020"><span class="cls_020">sp+24</span></div>
<div style="position:absolute;left:332.86px;top:291.00px" class="cls_020"><span class="cls_020">12</span></div>
<div style="position:absolute;left:446.89px;top:291.00px" class="cls_020"><span class="cls_020">&lt;value here></span></div>
<div style="position:absolute;left:286.09px;top:308.00px" class="cls_020"><span class="cls_020">sp+20</span></div>
<div style="position:absolute;left:332.86px;top:308.00px" class="cls_020"><span class="cls_020">(double) 1.0</span></div>
<div style="position:absolute;left:447.07px;top:308.00px" class="cls_020"><span class="cls_020">&lt;value here></span></div>
<div style="position:absolute;left:286.09px;top:325.00px" class="cls_020"><span class="cls_020">sp+16</span></div>
<div style="position:absolute;left:286.09px;top:342.00px" class="cls_020"><span class="cls_020">sp+12</span></div>
<div style="position:absolute;left:332.86px;top:342.00px" class="cls_020"><span class="cls_020">(double) 1.414</span></div>
<div style="position:absolute;left:447.11px;top:342.00px" class="cls_020"><span class="cls_020">a3</span></div>
<div style="position:absolute;left:286.09px;top:359.00px" class="cls_020"><span class="cls_020">sp+8</span></div>
<div style="position:absolute;left:446.81px;top:359.00px" class="cls_020"><span class="cls_020">a2</span></div>
<div style="position:absolute;left:286.09px;top:376.00px" class="cls_020"><span class="cls_020">sp+4</span></div>
<div style="position:absolute;left:332.84px;top:376.00px" class="cls_020"><span class="cls_020">&lt;padding></span></div>
<div style="position:absolute;left:447.01px;top:376.00px" class="cls_020"><span class="cls_020">-</span></div>
<div style="position:absolute;left:286.09px;top:393.01px" class="cls_020"><span class="cls_020">sp+0</span></div>
<div style="position:absolute;left:332.84px;top:393.01px" class="cls_020"><span class="cls_020">pointer to format string</span></div>
<div style="position:absolute;left:447.25px;top:393.01px" class="cls_020"><span class="cls_020">a0</span></div>
<div style="position:absolute;left:228.02px;top:412.67px" class="cls_006"><span class="cls_006">Note:</span></div>
<div style="position:absolute;left:228.02px;top:426.67px" class="cls_006"><span class="cls_006">• The padding at </span><span class="cls_008">sp</span><span class="cls_006"> +4 is required to get correct alignment of the </span><span class="cls_008">double</span></div>
<div style="position:absolute;left:239.98px;top:437.67px" class="cls_006"><span class="cls_006">values (the C rule is that floating point arguments are always passed</span></div>
<div style="position:absolute;left:239.98px;top:448.67px" class="cls_006"><span class="cls_006">as double unless the programmer explicitly asks otherwise with a</span></div>
<div style="position:absolute;left:239.98px;top:459.67px" class="cls_006"><span class="cls_006">typecast or function prototype).</span></div>
<div style="position:absolute;left:228.03px;top:473.67px" class="cls_006"><span class="cls_006">• Because the first argument is not a floating point value, the compiler</span></div>
<div style="position:absolute;left:239.98px;top:484.67px" class="cls_006"><span class="cls_006">doesn’t use an FP register for the second argument either. The data</span></div>
<div style="position:absolute;left:239.98px;top:495.67px" class="cls_006"><span class="cls_006">will instead be loaded into the two registers </span><span class="cls_008">a2</span><span class="cls_006"> and </span><span class="cls_008">a3.</span></div>
<div style="position:absolute;left:228.02px;top:506.67px" class="cls_006"><span class="cls_006">This turns out to be very useful.</span></div>
<div style="position:absolute;left:228.02px;top:517.67px" class="cls_006"><span class="cls_006">The </span><span class="cls_008">printf</span><span class="cls_006">() subroutine is defined with the ‘‘stdarg’’ or ‘‘varargs’’ macro</span></div>
<div style="position:absolute;left:216.00px;top:528.67px" class="cls_006"><span class="cls_006">package, which provides a portable cover for the register and stack</span></div>
<div style="position:absolute;left:216.00px;top:539.67px" class="cls_006"><span class="cls_006">manipulation involved. The </span><span class="cls_008">printf</span><span class="cls_006"> routine picks off the arguments by</span></div>
<div style="position:absolute;left:216.00px;top:550.67px" class="cls_006"><span class="cls_006">taking the address of the first or second argument, and then can advance</span></div>
<div style="position:absolute;left:216.00px;top:561.67px" class="cls_006"><span class="cls_006">up the argument structure to find further arguments.</span></div>
<div style="position:absolute;left:228.02px;top:572.67px" class="cls_006"><span class="cls_006">However, the macro package also has to persuade the C compiler to copy</span></div>
<div style="position:absolute;left:216.00px;top:583.67px" class="cls_008"><span class="cls_008">a0</span><span class="cls_006"> through </span><span class="cls_008">a3</span><span class="cls_006"> into their ‘‘shadow’’ locations in the argument structure.</span></div>
<div style="position:absolute;left:216.00px;top:594.67px" class="cls_006"><span class="cls_006">Some compilers will detect the use of the address of an argument and take</span></div>
<div style="position:absolute;left:216.00px;top:605.67px" class="cls_006"><span class="cls_006">the hint; ANSI C compilers should react to ‘‘...’’ in the function definition;</span></div>
<div style="position:absolute;left:216.00px;top:616.67px" class="cls_006"><span class="cls_006">others may need a ‘‘pragma’’.</span></div>
<div style="position:absolute;left:228.02px;top:627.67px" class="cls_006"><span class="cls_006">This should clarify the value of placing the </span><span class="cls_008">double</span><span class="cls_006"> value into the integer</span></div>
<div style="position:absolute;left:216.00px;top:638.67px" class="cls_006"><span class="cls_006">registers; that way ‘‘stdarg’’ and the compiler can just store the registers</span></div>
<div style="position:absolute;left:216.00px;top:649.67px" class="cls_008"><span class="cls_008">a0-</span><span class="cls_006"> </span><span class="cls_008">a3</span><span class="cls_006"> into the first 16 bytes of the argument structure, regardless of the</span></div>
<div style="position:absolute;left:216.00px;top:660.67px" class="cls_006"><span class="cls_006">type or number of the arguments.</span></div>
<div style="position:absolute;left:303.54px;top:755.33px" class="cls_002"><span class="cls_002">10-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:115488px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 10</span></div>
<div style="position:absolute;left:479.82px;top:28.00px" class="cls_002"><span class="cls_002">C PROGRAMMING</span></div>
<div style="position:absolute;left:36.00px;top:50.00px" class="cls_015"><span class="cls_015">Returning value from a function</span></div>
<div style="position:absolute;left:48.02px;top:63.67px" class="cls_006"><span class="cls_006">An integer or pointer return value will be in register </span><span class="cls_008">v0</span><span class="cls_006"> ($2). Register </span><span class="cls_008">v1</span></div>
<div style="position:absolute;left:36.00px;top:74.67px" class="cls_006"><span class="cls_006">($3) is reserved by the MIPS ABI but many compilers don’t use it. However,</span></div>
<div style="position:absolute;left:36.00px;top:85.67px" class="cls_006"><span class="cls_006">expect it to be used for returning 64-bit integer values in certain compilers</span></div>
<div style="position:absolute;left:36.00px;top:96.67px" class="cls_006"><span class="cls_006">(probably as a </span><span class="cls_008">long long</span><span class="cls_006"> data type).</span></div>
<div style="position:absolute;left:48.02px;top:107.67px" class="cls_006"><span class="cls_006">Any floating point result comes back in register </span><span class="cls_008">$f0</span><span class="cls_006"> (implicitly using </span><span class="cls_008">$f1</span></div>
<div style="position:absolute;left:36.00px;top:118.67px" class="cls_006"><span class="cls_006">if the value is double precision).</span></div>
<div style="position:absolute;left:48.02px;top:129.67px" class="cls_006"><span class="cls_006">If a function is declared in C as returning a structure value, that value</span></div>
<div style="position:absolute;left:36.00px;top:140.67px" class="cls_006"><span class="cls_006">is not returned in registers. Instead an additional implicit argument, a</span></div>
<div style="position:absolute;left:36.00px;top:151.67px" class="cls_006"><span class="cls_006">pointer to a caller-supplied structure template, is prepended to the explicit</span></div>
<div style="position:absolute;left:36.00px;top:162.67px" class="cls_006"><span class="cls_006">arguments; and the called function copies its return value to the template.</span></div>
<div style="position:absolute;left:36.00px;top:173.67px" class="cls_006"><span class="cls_006">Following the normal rules for arguments the ‘‘implicit’’ first argument will</span></div>
<div style="position:absolute;left:36.00px;top:184.67px" class="cls_006"><span class="cls_006">be in register </span><span class="cls_008">a0</span><span class="cls_006"> when the function is called. On return </span><span class="cls_008">v0</span><span class="cls_006"> points to the</span></div>
<div style="position:absolute;left:36.00px;top:195.67px" class="cls_006"><span class="cls_006">returned structure, too.</span></div>
<div style="position:absolute;left:36.00px;top:218.00px" class="cls_015"><span class="cls_015">Macros for prologues and epilogues</span></div>
<div style="position:absolute;left:48.02px;top:231.67px" class="cls_006"><span class="cls_006">Most assemblers seem to provide a partial prologue macro, which at</span></div>
<div style="position:absolute;left:36.00px;top:242.67px" class="cls_006"><span class="cls_006">least hides the pseudo-ops required to define a function and to record, in</span></div>
<div style="position:absolute;left:36.00px;top:253.67px" class="cls_006"><span class="cls_006">the object file, information for debuggers to use when conversing about</span></div>
<div style="position:absolute;left:36.00px;top:264.67px" class="cls_006"><span class="cls_006">your function.</span></div>
<div style="position:absolute;left:36.00px;top:287.00px" class="cls_015"><span class="cls_015">Stack-frame allocation</span></div>
<div style="position:absolute;left:48.02px;top:300.67px" class="cls_006"><span class="cls_006">Provided that a function (written in any language) adheres to the calling</span></div>
<div style="position:absolute;left:36.00px;top:311.67px" class="cls_006"><span class="cls_006">conventions, it can do anything it likes with the stack. There are some</span></div>
<div style="position:absolute;left:36.00px;top:322.67px" class="cls_006"><span class="cls_006">additional conventions which, if adhered to, can ease the task of a</span></div>
<div style="position:absolute;left:36.00px;top:333.67px" class="cls_006"><span class="cls_006">debugger  while  doing  a  stack  backtrace.  These  conventions  are  not</span></div>
<div style="position:absolute;left:36.00px;top:344.67px" class="cls_006"><span class="cls_006">described here; use of the recommended function prologue and epilogue</span></div>
<div style="position:absolute;left:36.00px;top:355.67px" class="cls_006"><span class="cls_006">macros enables code to support them.</span></div>
<div style="position:absolute;left:48.02px;top:366.67px" class="cls_006"><span class="cls_006">Functions can be divided into three classes; three different approaches</span></div>
<div style="position:absolute;left:36.00px;top:377.67px" class="cls_006"><span class="cls_006">satisfy most programming needs.</span></div>
<div style="position:absolute;left:36.00px;top:398.67px" class="cls_006"><span class="cls_006">Leaf functions</span></div>
<div style="position:absolute;left:48.02px;top:409.67px" class="cls_006"><span class="cls_006">Functions which contain no calls to other functions are called </span><span class="cls_008">leaf</span></div>
<div style="position:absolute;left:36.00px;top:420.67px" class="cls_006"><span class="cls_006">functions. Because of this they don’t have to worry about setting up</span></div>
<div style="position:absolute;left:36.00px;top:431.67px" class="cls_006"><span class="cls_006">argument structures and can safely maintain data in the non-preserved</span></div>
<div style="position:absolute;left:36.00px;top:442.67px" class="cls_006"><span class="cls_006">registers </span><span class="cls_008">t0</span><span class="cls_006"> - </span><span class="cls_008">t7,</span><span class="cls_006"> </span><span class="cls_008">a0</span><span class="cls_006"> - </span><span class="cls_008">a3</span><span class="cls_006"> and </span><span class="cls_008">v0</span><span class="cls_006"> - </span><span class="cls_008">v1,</span><span class="cls_006"> and may use the stack for storage if</span></div>
<div style="position:absolute;left:36.00px;top:453.67px" class="cls_006"><span class="cls_006">required. They can leave the return address in register </span><span class="cls_008">ra</span><span class="cls_006"> and return</span></div>
<div style="position:absolute;left:36.00px;top:464.67px" class="cls_006"><span class="cls_006">directly to it.</span></div>
<div style="position:absolute;left:48.02px;top:475.67px" class="cls_006"><span class="cls_006">Most  functions  written  in  assembler  for  tuning  reasons,  or  as</span></div>
<div style="position:absolute;left:36.00px;top:486.67px" class="cls_006"><span class="cls_006">convenience functions for accessing features not visible in C, will be leaf</span></div>
<div style="position:absolute;left:36.00px;top:497.67px" class="cls_006"><span class="cls_006">functions. The declaration of such a function is very simple, e.g.:</span></div>
<div style="position:absolute;left:72.00px;top:519.00px" class="cls_028"><span class="cls_028">#include &lt;idtc/asm.h></span></div>
<div style="position:absolute;left:72.00px;top:529.00px" class="cls_028"><span class="cls_028">#include &lt;idtc/regdef.h></span></div>
<div style="position:absolute;left:72.00px;top:549.00px" class="cls_028"><span class="cls_028">LEAF(myleaf)</span></div>
<div style="position:absolute;left:108.00px;top:569.00px" class="cls_028"><span class="cls_028">&lt;system specific code goes here></span></div>
<div style="position:absolute;left:108.00px;top:588.99px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:588.99px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:72.00px;top:598.99px" class="cls_028"><span class="cls_028">END(myleaf)</span></div>
<div style="position:absolute;left:48.02px;top:618.67px" class="cls_006"><span class="cls_006">Most toolchains can pass assembler source code through the C macro</span></div>
<div style="position:absolute;left:36.00px;top:629.67px" class="cls_006"><span class="cls_006">pre-processor before assembling it. The files &lt;</span><span class="cls_008">idtc/asm.h</span><span class="cls_006">> and &lt;</span><span class="cls_008">idtc/</span></div>
<div style="position:absolute;left:36.00px;top:640.67px" class="cls_008"><span class="cls_008">regdef.h</span><span class="cls_006"> > include useful macros (like </span><span class="cls_029">LEAF</span><span class="cls_006"> and </span><span class="cls_029">END</span><span class="cls_006">, above) for declaring</span></div>
<div style="position:absolute;left:36.00px;top:651.67px" class="cls_006"><span class="cls_006">global functions and data; they also allow the use of software register</span></div>
<div style="position:absolute;left:36.00px;top:662.67px" class="cls_006"><span class="cls_006">names, e.g. </span><span class="cls_008">a0</span><span class="cls_006"> instead of </span><span class="cls_008">$4.</span><span class="cls_006"> If using the MIPS Corp. toolchain, for</span></div>
<div style="position:absolute;left:36.00px;top:673.67px" class="cls_006"><span class="cls_006">example, the above fragment would be expanded to:</span></div>
<div style="position:absolute;left:108.00px;top:695.00px" class="cls_028"><span class="cls_028">.globl myleaf</span></div>
<div style="position:absolute;left:108.00px;top:705.00px" class="cls_028"><span class="cls_028">.ent</span></div>
<div style="position:absolute;left:144.09px;top:705.00px" class="cls_028"><span class="cls_028">myleaf,0</span></div>
<div style="position:absolute;left:108.00px;top:724.99px" class="cls_028"><span class="cls_028">&lt;system specific code goes here></span></div>
<div style="position:absolute;left:289.80px;top:755.33px" class="cls_002"><span class="cls_002">10-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:116290px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">C PROGRAMMING</span></div>
<div style="position:absolute;left:520.30px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 10</span></div>
<div style="position:absolute;left:288.00px;top:61.00px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.02px;top:61.00px" class="cls_028"><span class="cls_028">$31</span></div>
<div style="position:absolute;left:288.00px;top:71.00px" class="cls_028"><span class="cls_028">.end</span></div>
<div style="position:absolute;left:324.10px;top:71.00px" class="cls_028"><span class="cls_028">myleaf</span></div>
<div style="position:absolute;left:228.02px;top:90.67px" class="cls_006"><span class="cls_006">Other toolchains may have different definitions for these macros, as</span></div>
<div style="position:absolute;left:216.00px;top:101.67px" class="cls_006"><span class="cls_006">appropriate to their needs.</span></div>
<div style="position:absolute;left:216.00px;top:122.67px" class="cls_006"><span class="cls_006">Non-leaf functions</span></div>
<div style="position:absolute;left:228.02px;top:133.67px" class="cls_006"><span class="cls_006">Non-leaf functions are those which contain calls to other functions.</span></div>
<div style="position:absolute;left:216.00px;top:144.67px" class="cls_006"><span class="cls_006">Normally the function starts with code (the ‘‘function prologue’’) to reset </span><span class="cls_008">sp</span></div>
<div style="position:absolute;left:216.00px;top:155.67px" class="cls_006"><span class="cls_006">to the low-water mark of argument structures for any functions which may</span></div>
<div style="position:absolute;left:216.00px;top:166.67px" class="cls_006"><span class="cls_006">be called, and to save the incoming values of any of the registers </span><span class="cls_008">s0</span><span class="cls_006"> - </span><span class="cls_008">s8</span></div>
<div style="position:absolute;left:216.00px;top:177.67px" class="cls_006"><span class="cls_006">which the function uses. Stack locations must also be reserved for </span><span class="cls_008">ra,</span></div>
<div style="position:absolute;left:216.00px;top:188.67px" class="cls_006"><span class="cls_006">automatic (i.e. stack-based local) variables, and any further registers</span></div>
<div style="position:absolute;left:216.00px;top:199.67px" class="cls_006"><span class="cls_006">whose value this function needs preserved over its own calls (if the values</span></div>
<div style="position:absolute;left:216.00px;top:210.67px" class="cls_006"><span class="cls_006">of the argument registers </span><span class="cls_008">a0</span><span class="cls_006"> - </span><span class="cls_008">a3</span><span class="cls_006"> need to be preserved, they can be saved</span></div>
<div style="position:absolute;left:216.01px;top:221.67px" class="cls_006"><span class="cls_006">into their standard positions on the ‘‘argument structure’’).</span></div>
<div style="position:absolute;left:228.02px;top:232.67px" class="cls_006"><span class="cls_006">Note that, since </span><span class="cls_008">sp</span><span class="cls_006"> is set only once (in the function prologue) all stack-</span></div>
<div style="position:absolute;left:216.00px;top:243.67px" class="cls_006"><span class="cls_006">held locations can be referenced by fixed offsets from </span><span class="cls_008">sp.</span></div>
<div style="position:absolute;left:228.02px;top:254.67px" class="cls_006"><span class="cls_006">This is illustrated in the non-leaf function listed below, in conjunction</span></div>
<div style="position:absolute;left:216.00px;top:265.67px" class="cls_006"><span class="cls_006">with the picture of the stackframe in Figure 10.1, “Stackframe for a non-</span></div>
<div style="position:absolute;left:216.00px;top:276.67px" class="cls_006"><span class="cls_006">leaf function”.</span></div>
<div style="position:absolute;left:389.11px;top:330.71px" class="cls_043"><span class="cls_043">more arguments</span></div>
<div style="position:absolute;left:379.39px;top:339.89px" class="cls_043"><span class="cls_043">(if won’t fit in 16 bytes)</span></div>
<div style="position:absolute;left:391.00px;top:358.00px" class="cls_043"><span class="cls_043">space for arg 4</span></div>
<div style="position:absolute;left:391.00px;top:370.96px" class="cls_043"><span class="cls_043">space for arg 3</span></div>
<div style="position:absolute;left:391.00px;top:383.92px" class="cls_043"><span class="cls_043">space for arg 2</span></div>
<div style="position:absolute;left:289.76px;top:398.78px" class="cls_043"><span class="cls_043">sp on</span></div>
<div style="position:absolute;left:391.00px;top:396.89px" class="cls_043"><span class="cls_043">space for arg 1</span></div>
<div style="position:absolute;left:290.57px;top:407.97px" class="cls_043"><span class="cls_043">entry</span></div>
<div style="position:absolute;left:371.02px;top:416.34px" class="cls_043"><span class="cls_043">automatic (local) variables</span></div>
<div style="position:absolute;left:371.29px;top:442.81px" class="cls_043"><span class="cls_043">integer register save area</span></div>
<div style="position:absolute;left:378.85px;top:467.66px" class="cls_043"><span class="cls_043">f.p. register save area</span></div>
<div style="position:absolute;left:386.68px;top:489.54px" class="cls_043"><span class="cls_043">space for building</span></div>
<div style="position:absolute;left:371.29px;top:498.72px" class="cls_043"><span class="cls_043">arguments for nested calls</span></div>
<div style="position:absolute;left:280.04px;top:508.45px" class="cls_043"><span class="cls_043">sp while</span></div>
<div style="position:absolute;left:394.51px;top:508.18px" class="cls_044"><span class="cls_044">(>= 16 bytes)</span></div>
<div style="position:absolute;left:280.85px;top:517.63px" class="cls_043"><span class="cls_043">running</span></div>
<div style="position:absolute;left:282.58px;top:572.00px" class="cls_020"><span class="cls_020">Figure 10.1.   Stackframe for a non-leaf function</span></div>
<div style="position:absolute;left:252.00px;top:593.00px" class="cls_028"><span class="cls_028">#include &lt;idtc/asm.h></span></div>
<div style="position:absolute;left:252.00px;top:603.00px" class="cls_028"><span class="cls_028">#include &lt;idtc/regdef.h></span></div>
<div style="position:absolute;left:252.00px;top:622.99px" class="cls_028"><span class="cls_028">#</span></div>
<div style="position:absolute;left:252.00px;top:632.99px" class="cls_028"><span class="cls_028"># myfunc (arg1, arg2, arg3, arg4, arg5)</span></div>
<div style="position:absolute;left:252.00px;top:642.99px" class="cls_028"><span class="cls_028">#</span></div>
<div style="position:absolute;left:252.00px;top:662.99px" class="cls_028"><span class="cls_028"># framesize = locals + regsave (ra,s0) + pad + fregsave (f20/21)</span></div>
<div style="position:absolute;left:252.00px;top:672.99px" class="cls_028"><span class="cls_028">+ args + pad</span></div>
<div style="position:absolute;left:252.00px;top:682.99px" class="cls_028"><span class="cls_028">myfunc_frmsz= 4 + 8 + 4 + 8 + (5 * 4) + 4</span></div>
<div style="position:absolute;left:252.00px;top:702.99px" class="cls_028"><span class="cls_028">NESTED(myfunc, myfunc_frmsz, zero)</span></div>
<div style="position:absolute;left:288.00px;top:712.98px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:324.10px;top:712.98px" class="cls_028"><span class="cls_028">sp,myfunc_frmsz</span></div>
<div style="position:absolute;left:288.00px;top:722.98px" class="cls_028"><span class="cls_028">.mask</span></div>
<div style="position:absolute;left:324.11px;top:722.98px" class="cls_028"><span class="cls_028">0x80010000, -4</span></div>
<div style="position:absolute;left:303.54px;top:755.33px" class="cls_002"><span class="cls_002">10-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:117092px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 10</span></div>
<div style="position:absolute;left:479.82px;top:28.00px" class="cls_002"><span class="cls_002">C PROGRAMMING</span></div>
<div style="position:absolute;left:108.00px;top:51.00px" class="cls_028"><span class="cls_028">sw ra,myfunc_frmsz-8(sp)</span></div>
<div style="position:absolute;left:108.00px;top:61.00px" class="cls_028"><span class="cls_028">sw s0,myfunc_frmsz-12(sp)</span></div>
<div style="position:absolute;left:108.00px;top:71.00px" class="cls_028"><span class="cls_028">.fmask 0x00300000, -16</span></div>
<div style="position:absolute;left:108.00px;top:81.00px" class="cls_028"><span class="cls_028">s.d</span></div>
<div style="position:absolute;left:144.10px;top:81.00px" class="cls_028"><span class="cls_028">$f20,myfunc_frmsz-24(sp)</span></div>
<div style="position:absolute;left:108.00px;top:101.00px" class="cls_028"><span class="cls_028">&lt;your code goes here, e.g></span></div>
<div style="position:absolute;left:108.00px;top:111.00px" class="cls_028"><span class="cls_028"># local = otherfunc (arg5, arg2, arg3, arg4, arg1)</span></div>
<div style="position:absolute;left:108.00px;top:120.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:120.99px" class="cls_028"><span class="cls_028">a0,16(sp)</span></div>
<div style="position:absolute;left:252.26px;top:120.99px" class="cls_028"><span class="cls_028"># arg5 (out) = arg1 (in)</span></div>
<div style="position:absolute;left:108.00px;top:130.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:130.99px" class="cls_028"><span class="cls_028">a0,myfunc_frmsz+16(sp)# arg1 (out) = arg5 (in)</span></div>
<div style="position:absolute;left:108.00px;top:140.99px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:144.07px;top:140.99px" class="cls_028"><span class="cls_028">otherfunc</span></div>
<div style="position:absolute;left:108.00px;top:150.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:150.99px" class="cls_028"><span class="cls_028">v0,myfunc_frmsz-4(sp)# local = result</span></div>
<div style="position:absolute;left:108.00px;top:170.99px" class="cls_028"><span class="cls_028">l.d $f20,myfunc_frmsz-24(sp)</span></div>
<div style="position:absolute;left:108.00px;top:180.99px" class="cls_028"><span class="cls_028">lw s0,myfunc_frmsz-12(sp)</span></div>
<div style="position:absolute;left:108.00px;top:190.99px" class="cls_028"><span class="cls_028">lw ra,myfunc_frmsz-8(sp)</span></div>
<div style="position:absolute;left:108.00px;top:200.99px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:144.10px;top:200.99px" class="cls_028"><span class="cls_028">sp,myfunc_frmsz</span></div>
<div style="position:absolute;left:108.00px;top:210.99px" class="cls_028"><span class="cls_028">jr ra</span></div>
<div style="position:absolute;left:72.00px;top:220.99px" class="cls_028"><span class="cls_028">END(myfunc)</span></div>
<div style="position:absolute;left:48.02px;top:240.67px" class="cls_006"><span class="cls_006">Analyzing the above example, one step at a time:</span></div>
<div style="position:absolute;left:72.00px;top:262.00px" class="cls_028"><span class="cls_028">#</span></div>
<div style="position:absolute;left:72.00px;top:272.00px" class="cls_028"><span class="cls_028"># myfunc (arg1, arg2, arg3, arg4, arg5)</span></div>
<div style="position:absolute;left:72.00px;top:282.00px" class="cls_028"><span class="cls_028">#</span></div>
<div style="position:absolute;left:48.02px;top:301.67px" class="cls_006"><span class="cls_006">The function </span><span class="cls_029">myfunc</span><span class="cls_006"> expects five arguments: on entry the first four of</span></div>
<div style="position:absolute;left:36.00px;top:312.67px" class="cls_006"><span class="cls_006">these will be in registers </span><span class="cls_008">a0</span><span class="cls_006"> - </span><span class="cls_008">a3,</span><span class="cls_006"> and the fifth will be at </span><span class="cls_008">sp+16.</span></div>
<div style="position:absolute;left:72.00px;top:334.00px" class="cls_028"><span class="cls_028"># framesize = locals + regsave (ra,s0) + pad + fregsave (f20/21)</span></div>
<div style="position:absolute;left:72.00px;top:344.00px" class="cls_028"><span class="cls_028">+ args + pad</span></div>
<div style="position:absolute;left:72.00px;top:354.00px" class="cls_028"><span class="cls_028">myfunc_frmsz= 4 + 8 + 4 + 8 + 20 + 4</span></div>
<div style="position:absolute;left:48.02px;top:373.67px" class="cls_006"><span class="cls_006">The total frame size is calculated as follows:</span></div>
<div style="position:absolute;left:48.02px;top:387.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> locals (4 bytes)</span><span class="cls_006">: keep one local variable on the stack, rather than in a</span></div>
<div style="position:absolute;left:59.97px;top:398.67px" class="cls_006"><span class="cls_006">register; the example may need to pass the address of the variable to</span></div>
<div style="position:absolute;left:59.97px;top:409.67px" class="cls_006"><span class="cls_006">another function.</span></div>
<div style="position:absolute;left:48.02px;top:423.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> regsave (8 bytes)</span><span class="cls_006">: save the return address register </span><span class="cls_008">ra,</span><span class="cls_006"> because this</span></div>
<div style="position:absolute;left:59.97px;top:434.67px" class="cls_006"><span class="cls_006">function calls another function; this function also plans to use the</span></div>
<div style="position:absolute;left:59.97px;top:445.67px" class="cls_008"><span class="cls_008">callee-saved</span><span class="cls_006"> register </span><span class="cls_008">s0.</span></div>
<div style="position:absolute;left:48.01px;top:459.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> pad (4 bytes)</span><span class="cls_006">: the rules say that double precision floating-point must</span></div>
<div style="position:absolute;left:59.96px;top:470.67px" class="cls_006"><span class="cls_006">by 8-byte aligned, so add one word of padding to align the stack.</span></div>
<div style="position:absolute;left:48.01px;top:484.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> fregsave (8 bytes)</span><span class="cls_006">: the function plans to use </span><span class="cls_008">$f20,</span><span class="cls_006"> which is one of the</span></div>
<div style="position:absolute;left:59.96px;top:495.67px" class="cls_008"><span class="cls_008">callee-saved</span><span class="cls_006"> floating-point registers.</span></div>
<div style="position:absolute;left:48.01px;top:509.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> argsize (20 bytes)</span><span class="cls_006">: this function is going to call another function</span></div>
<div style="position:absolute;left:59.96px;top:520.67px" class="cls_006"><span class="cls_006">which needs five argument words; this size must never be less than</span></div>
<div style="position:absolute;left:59.96px;top:531.67px" class="cls_006"><span class="cls_006">16 bytes if a nested function is called, even if it takes no arguments.</span></div>
<div style="position:absolute;left:48.01px;top:545.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> pad (4 bytes)</span><span class="cls_006">: the rules say that the stack pointer must always be 8-</span></div>
<div style="position:absolute;left:59.96px;top:556.67px" class="cls_006"><span class="cls_006">byte aligned, so add another word of padding to align it.</span></div>
<div style="position:absolute;left:72.00px;top:578.00px" class="cls_028"><span class="cls_028">NESTED(myfunc, myfunc_frmsz, zero)</span></div>
<div style="position:absolute;left:108.00px;top:588.00px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:144.09px;top:588.00px" class="cls_028"><span class="cls_028">sp,myfunc_frmsz</span></div>
<div style="position:absolute;left:48.02px;top:607.67px" class="cls_006"><span class="cls_006">In the MIPS Corp. toolchain this would be expanded to:</span></div>
<div style="position:absolute;left:108.00px;top:629.00px" class="cls_028"><span class="cls_028">.globl myfunc</span></div>
<div style="position:absolute;left:108.00px;top:639.00px" class="cls_028"><span class="cls_028">.ent</span></div>
<div style="position:absolute;left:144.09px;top:639.00px" class="cls_028"><span class="cls_028">myfunc,0</span></div>
<div style="position:absolute;left:108.00px;top:649.00px" class="cls_028"><span class="cls_028">.frame $29,myfunc_frmsz,$0</span></div>
<div style="position:absolute;left:108.00px;top:659.00px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:144.09px;top:659.00px" class="cls_028"><span class="cls_028">$29,myfunc_frmsz</span></div>
<div style="position:absolute;left:48.02px;top:678.67px" class="cls_006"><span class="cls_006">This declares the start of the function, and makes it globally accessible.</span></div>
<div style="position:absolute;left:36.00px;top:689.67px" class="cls_006"><span class="cls_006">The .frame function tells the debugger the size of stack frame to be</span></div>
<div style="position:absolute;left:35.99px;top:700.67px" class="cls_006"><span class="cls_006">created, and finally the subu instruction creates the stack frame itself.</span></div>
<div style="position:absolute;left:289.79px;top:755.33px" class="cls_002"><span class="cls_002">10-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:117894px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">C PROGRAMMING</span></div>
<div style="position:absolute;left:520.30px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 10</span></div>
<div style="position:absolute;left:288.00px;top:61.00px" class="cls_028"><span class="cls_028">.mask</span></div>
<div style="position:absolute;left:324.11px;top:61.00px" class="cls_028"><span class="cls_028">0x80010000, -4</span></div>
<div style="position:absolute;left:288.00px;top:71.00px" class="cls_028"><span class="cls_028">sw ra,myfunc_frmsz-8(sp)</span></div>
<div style="position:absolute;left:288.00px;top:81.00px" class="cls_028"><span class="cls_028">sw s0,myfunc_frmsz-12(sp)</span></div>
<div style="position:absolute;left:228.02px;top:100.67px" class="cls_006"><span class="cls_006">The function must save the return address and any </span><span class="cls_008">callee-saved</span><span class="cls_006"> integer</span></div>
<div style="position:absolute;left:216.00px;top:111.67px" class="cls_006"><span class="cls_006">registers used, in the stack frame. The .mask directive tells the debugger</span></div>
<div style="position:absolute;left:216.00px;top:122.67px" class="cls_006"><span class="cls_006">which registers will be saved</span><span class="cls_008">($31</span><span class="cls_006"> and </span><span class="cls_008">$20),</span><span class="cls_006"> and the offset from the top of</span></div>
<div style="position:absolute;left:216.00px;top:133.67px" class="cls_006"><span class="cls_006">the stack frame to the top of the save area: this corresponds to </span><span class="cls_008">regoffs</span><span class="cls_006">. The</span></div>
<div style="position:absolute;left:216.00px;top:144.67px" class="cls_006"><span class="cls_006">sw instructions then save the registers: the higher the register number, the</span></div>
<div style="position:absolute;left:216.00px;top:155.67px" class="cls_006"><span class="cls_006">higher up the stack it is placed (i.e. the registers are saved in order).</span></div>
<div style="position:absolute;left:288.00px;top:177.00px" class="cls_028"><span class="cls_028">.fmask 0x00300000, -16</span></div>
<div style="position:absolute;left:288.00px;top:187.00px" class="cls_028"><span class="cls_028">s.d</span></div>
<div style="position:absolute;left:324.09px;top:187.00px" class="cls_028"><span class="cls_028">$f20,myfunc_frmsz-24(sp)</span></div>
<div style="position:absolute;left:228.02px;top:206.67px" class="cls_006"><span class="cls_006">The code then does the same thing for the </span><span class="cls_008">callee-saved</span><span class="cls_006"> floating-point</span></div>
<div style="position:absolute;left:216.00px;top:217.67px" class="cls_006"><span class="cls_006">registers</span></div>
<div style="position:absolute;left:263.73px;top:217.67px" class="cls_008"><span class="cls_008">$f20</span><span class="cls_006"> and (implicitly)</span></div>
<div style="position:absolute;left:373.13px;top:217.67px" class="cls_008"><span class="cls_008">$f21.</span><span class="cls_006"> The .fmask offset corresponds to</span></div>
<div style="position:absolute;left:215.99px;top:228.67px" class="cls_008"><span class="cls_008">fregoffs</span><span class="cls_006">, i.e. local variable area + integer register save area + padding word.</span></div>
<div style="position:absolute;left:288.00px;top:250.00px" class="cls_028"><span class="cls_028"># local = otherfunc (arg5, arg2, arg3, arg4, arg1)</span></div>
<div style="position:absolute;left:288.00px;top:260.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:260.00px" class="cls_028"><span class="cls_028">a0,16(sp)</span></div>
<div style="position:absolute;left:432.25px;top:260.00px" class="cls_028"><span class="cls_028"># arg5 (out) = arg1 (in)</span></div>
<div style="position:absolute;left:288.00px;top:270.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:270.00px" class="cls_028"><span class="cls_028">a0,myfunc_frmsz+16(sp)# arg1 (out) = arg5 (in)</span></div>
<div style="position:absolute;left:288.00px;top:280.00px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:280.00px" class="cls_028"><span class="cls_028">otherfunc</span></div>
<div style="position:absolute;left:228.02px;top:299.67px" class="cls_006"><span class="cls_006">This program calls the function </span><span class="cls_029">otherfunc</span><span class="cls_006">. Its arguments 2 to 4 are the</span></div>
<div style="position:absolute;left:216.00px;top:310.67px" class="cls_006"><span class="cls_006">same as this programs’ arguments 2 to 4, so these can pass straight</span></div>
<div style="position:absolute;left:216.00px;top:321.67px" class="cls_006"><span class="cls_006">through without being moved. However, the code must swap argument 5</span></div>
<div style="position:absolute;left:216.00px;top:332.67px" class="cls_006"><span class="cls_006">and argument 1, so it copies:</span></div>
<div style="position:absolute;left:228.02px;top:346.67px" class="cls_006"><span class="cls_006">• its input arg1 (in register </span><span class="cls_008">a0)</span><span class="cls_006"> to the arg5 position in the outgoing</span></div>
<div style="position:absolute;left:239.97px;top:357.67px" class="cls_006"><span class="cls_006">argument build area (new </span><span class="cls_008">sp</span><span class="cls_006"> + 16).</span></div>
<div style="position:absolute;left:228.02px;top:371.67px" class="cls_006"><span class="cls_006">• its input arg5 (at old </span><span class="cls_008">sp</span><span class="cls_006"> + 16) to outgoing argument 1 (register </span><span class="cls_008">a0).</span></div>
<div style="position:absolute;left:288.00px;top:393.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:393.00px" class="cls_028"><span class="cls_028">v0,myfunc_frmsz-4(sp)# local = result</span></div>
<div style="position:absolute;left:228.02px;top:412.67px" class="cls_006"><span class="cls_006">The return value from </span><span class="cls_029">otherfunc</span><span class="cls_006"> is stored in the local (automatic)</span></div>
<div style="position:absolute;left:216.00px;top:423.67px" class="cls_006"><span class="cls_006">variable, allocated the top 4 bytes of the stack frame.</span></div>
<div style="position:absolute;left:288.00px;top:445.00px" class="cls_039"><span class="cls_039">l.d $f20,myfunc_frmsz-24(sp)</span></div>
<div style="position:absolute;left:288.00px;top:455.00px" class="cls_039"><span class="cls_039">lw s0,myfunc_frmsz-12(sp)</span></div>
<div style="position:absolute;left:288.00px;top:465.00px" class="cls_039"><span class="cls_039">lw ra,myfunc_frmsz-8(sp)</span></div>
<div style="position:absolute;left:288.00px;top:475.00px" class="cls_039"><span class="cls_039">addu</span></div>
<div style="position:absolute;left:324.07px;top:475.00px" class="cls_039"><span class="cls_039">sp,myfunc_frmsz</span></div>
<div style="position:absolute;left:288.00px;top:485.00px" class="cls_039"><span class="cls_039">jr ra</span></div>
<div style="position:absolute;left:252.00px;top:494.99px" class="cls_039"><span class="cls_039">END(myfunc)</span></div>
<div style="position:absolute;left:228.02px;top:514.67px" class="cls_006"><span class="cls_006">Finally the function epilogue reverses the prologue operations: restores</span></div>
<div style="position:absolute;left:216.00px;top:525.67px" class="cls_006"><span class="cls_006">the floating-point, integer and return address registers; pops the stack</span></div>
<div style="position:absolute;left:216.00px;top:536.67px" class="cls_006"><span class="cls_006">frame; and returns.</span></div>
<div style="position:absolute;left:216.00px;top:557.67px" class="cls_006"><span class="cls_006">Functions needing run-time computed stack locations</span></div>
<div style="position:absolute;left:228.02px;top:568.67px" class="cls_006"><span class="cls_006">In some languages dynamic variables can be created whose size varies</span></div>
<div style="position:absolute;left:216.00px;top:579.67px" class="cls_006"><span class="cls_006">at run-time. Some C compilers support this, by using the useful library</span></div>
<div style="position:absolute;left:216.00px;top:590.67px" class="cls_006"><span class="cls_006">function </span><span class="cls_008">alloca</span><span class="cls_006">. This means that </span><span class="cls_008">sp</span><span class="cls_006"> has been lowered by an amount</span></div>
<div style="position:absolute;left:216.00px;top:601.67px" class="cls_006"><span class="cls_006">unknown at compile time, so the compiler can’t use it to reach stack</span></div>
<div style="position:absolute;left:216.00px;top:612.67px" class="cls_006"><span class="cls_006">locations.</span></div>
<div style="position:absolute;left:228.02px;top:623.67px" class="cls_006"><span class="cls_006">In this case the function prologue grabs another register, </span><span class="cls_008">s8,</span><span class="cls_006"> also known</span></div>
<div style="position:absolute;left:216.00px;top:634.67px" class="cls_006"><span class="cls_006">as </span><span class="cls_008">fp,</span><span class="cls_006"> and points it to the post-prologue value of </span><span class="cls_008">sp.</span></div>
<div style="position:absolute;left:228.03px;top:645.67px" class="cls_006"><span class="cls_006">Since </span><span class="cls_008">fp</span><span class="cls_006"> is one of the saved registers, the prologue must also save its old</span></div>
<div style="position:absolute;left:216.00px;top:656.67px" class="cls_006"><span class="cls_006">value. In the function body, all stack location references to automatic</span></div>
<div style="position:absolute;left:216.00px;top:667.67px" class="cls_006"><span class="cls_006">variables, and saved-register positions are made via </span><span class="cls_008">fp.</span><span class="cls_006"> But when calling</span></div>
<div style="position:absolute;left:216.00px;top:678.67px" class="cls_006"><span class="cls_006">other functions, and putting data into the argument structure, that will be</span></div>
<div style="position:absolute;left:216.00px;top:689.67px" class="cls_006"><span class="cls_006">done with relation to </span><span class="cls_008">sp.</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">10-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:118696px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 10</span></div>
<div style="position:absolute;left:479.82px;top:28.00px" class="cls_002"><span class="cls_002">C PROGRAMMING</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">Assembler buffs may enjoy the observation that, when creating space</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_006"><span class="cls_006">with </span><span class="cls_008">alloca</span><span class="cls_006"> the address returned is actually a bit higher than </span><span class="cls_008">sp,</span><span class="cls_006"> since the</span></div>
<div style="position:absolute;left:35.99px;top:72.67px" class="cls_006"><span class="cls_006">compiler has still reserved space for the largest argument structure</span></div>
<div style="position:absolute;left:35.99px;top:83.67px" class="cls_006"><span class="cls_006">required by any function call.</span></div>
<div style="position:absolute;left:48.01px;top:94.67px" class="cls_006"><span class="cls_006">This example is a slightly modified version of the function used in the</span></div>
<div style="position:absolute;left:35.99px;top:105.67px" class="cls_006"><span class="cls_006">last section, with the addition of a ‘‘call’’ to </span><span class="cls_008">alloca</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:72.00px;top:127.00px" class="cls_028"><span class="cls_028">#include &lt;idtc/asm.h></span></div>
<div style="position:absolute;left:72.00px;top:137.00px" class="cls_028"><span class="cls_028">#include &lt;idtc/regdef.h></span></div>
<div style="position:absolute;left:72.00px;top:157.00px" class="cls_028"><span class="cls_028">#</span></div>
<div style="position:absolute;left:72.00px;top:167.00px" class="cls_028"><span class="cls_028"># myfunc (arg1, arg2, arg3, arg4, arg5)</span></div>
<div style="position:absolute;left:72.00px;top:176.99px" class="cls_028"><span class="cls_028">#</span></div>
<div style="position:absolute;left:72.00px;top:196.99px" class="cls_028"><span class="cls_028"># framesize = locals + regsave (ra,s8,s0) + fregsave (f20/21) +</span></div>
<div style="position:absolute;left:72.00px;top:206.99px" class="cls_028"><span class="cls_028">args + pad</span></div>
<div style="position:absolute;left:72.00px;top:216.99px" class="cls_028"><span class="cls_028">myfunc_frmsz= 4 + 12 + 8 + (5 * 4) + 4</span></div>
<div style="position:absolute;left:108.00px;top:236.99px" class="cls_028"><span class="cls_028">.globl myfunc</span></div>
<div style="position:absolute;left:108.00px;top:246.99px" class="cls_028"><span class="cls_028">.ent</span></div>
<div style="position:absolute;left:144.09px;top:246.99px" class="cls_028"><span class="cls_028">myfunc,0</span></div>
<div style="position:absolute;left:108.00px;top:256.99px" class="cls_028"><span class="cls_028">.frame fp,myfunc_frmsz,$0</span></div>
<div style="position:absolute;left:108.00px;top:276.98px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:144.09px;top:276.98px" class="cls_028"><span class="cls_028">sp,myfunc_frmsz</span></div>
<div style="position:absolute;left:108.00px;top:286.98px" class="cls_028"><span class="cls_028">.mask</span></div>
<div style="position:absolute;left:144.11px;top:286.98px" class="cls_028"><span class="cls_028">0xc0010000, -4</span></div>
<div style="position:absolute;left:108.00px;top:296.98px" class="cls_028"><span class="cls_028">sw ra,myfunc_frmsz-8(sp)</span></div>
<div style="position:absolute;left:108.00px;top:306.98px" class="cls_028"><span class="cls_028">sw fp,myfunc_frmsz-12(sp)</span></div>
<div style="position:absolute;left:108.00px;top:316.98px" class="cls_028"><span class="cls_028">sw s0,myfunc_frmsz-16(sp)</span></div>
<div style="position:absolute;left:108.00px;top:326.98px" class="cls_028"><span class="cls_028">.fmask 0x00300000, -16</span></div>
<div style="position:absolute;left:108.00px;top:336.98px" class="cls_028"><span class="cls_028">s.d</span></div>
<div style="position:absolute;left:144.09px;top:336.98px" class="cls_028"><span class="cls_028">$f20,myfunc_frmsz-24(sp)</span></div>
<div style="position:absolute;left:108.00px;top:346.98px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:346.98px" class="cls_028"><span class="cls_028">fp,sp</span></div>
<div style="position:absolute;left:288.21px;top:346.98px" class="cls_028"><span class="cls_028"># save bottom of fixed</span></div>
<div style="position:absolute;left:71.99px;top:356.98px" class="cls_028"><span class="cls_028">frame</span></div>
<div style="position:absolute;left:107.99px;top:376.98px" class="cls_028"><span class="cls_028"># t6 = alloca (t5)</span></div>
<div style="position:absolute;left:107.99px;top:386.97px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:144.08px;top:386.97px" class="cls_028"><span class="cls_028">t5,7</span></div>
<div style="position:absolute;left:288.18px;top:386.97px" class="cls_028"><span class="cls_028"># make sure that size</span></div>
<div style="position:absolute;left:107.99px;top:396.97px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.06px;top:396.97px" class="cls_028"><span class="cls_028">t5,~7</span></div>
<div style="position:absolute;left:288.17px;top:396.97px" class="cls_028"><span class="cls_028"># is multiple of 8</span></div>
<div style="position:absolute;left:107.99px;top:406.97px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:144.08px;top:406.97px" class="cls_028"><span class="cls_028">sp,t5</span></div>
<div style="position:absolute;left:288.20px;top:406.97px" class="cls_028"><span class="cls_028"># allocate stack</span></div>
<div style="position:absolute;left:107.99px;top:416.97px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:144.08px;top:416.97px" class="cls_028"><span class="cls_028">t6,sp,20</span></div>
<div style="position:absolute;left:288.27px;top:416.97px" class="cls_028"><span class="cls_028"># leave room for args</span></div>
<div style="position:absolute;left:107.99px;top:436.97px" class="cls_028"><span class="cls_028">&lt;your code goes here, e.g></span></div>
<div style="position:absolute;left:107.99px;top:446.97px" class="cls_028"><span class="cls_028"># local = otherfunc (arg5, arg2, arg3, arg4, arg1)</span></div>
<div style="position:absolute;left:107.99px;top:456.97px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.04px;top:456.97px" class="cls_028"><span class="cls_028">a0,16(sp)</span></div>
<div style="position:absolute;left:252.24px;top:456.97px" class="cls_028"><span class="cls_028"># arg5 (out) = arg1 (in)</span></div>
<div style="position:absolute;left:107.99px;top:466.97px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.04px;top:466.97px" class="cls_028"><span class="cls_028">a0,myfunc_frmsz+16(fp)# arg1 (out) = arg5 (in)</span></div>
<div style="position:absolute;left:107.99px;top:476.96px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:144.06px;top:476.96px" class="cls_028"><span class="cls_028">otherfunc</span></div>
<div style="position:absolute;left:107.99px;top:486.96px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.04px;top:486.96px" class="cls_028"><span class="cls_028">v0,myfunc_frmsz-4(fp)# local = result</span></div>
<div style="position:absolute;left:107.99px;top:506.96px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.08px;top:506.96px" class="cls_028"><span class="cls_028">sp,fp</span></div>
<div style="position:absolute;left:288.20px;top:506.96px" class="cls_028"><span class="cls_028"># restore stack</span></div>
<div style="position:absolute;left:71.99px;top:516.96px" class="cls_028"><span class="cls_028">pointer</span></div>
<div style="position:absolute;left:107.99px;top:526.96px" class="cls_028"><span class="cls_028">l.d $f20,myfunc_frmsz-24(sp)</span></div>
<div style="position:absolute;left:107.99px;top:536.96px" class="cls_028"><span class="cls_028">lw s0,myfunc_frmsz-16(sp)</span></div>
<div style="position:absolute;left:107.99px;top:546.96px" class="cls_028"><span class="cls_028">lw fp,myfunc_frmsz-12(sp)</span></div>
<div style="position:absolute;left:107.99px;top:556.96px" class="cls_028"><span class="cls_028">lw ra,myfunc_frmsz-8(sp)</span></div>
<div style="position:absolute;left:107.99px;top:566.96px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:144.08px;top:566.96px" class="cls_028"><span class="cls_028">sp,myfunc_frmsz</span></div>
<div style="position:absolute;left:107.99px;top:576.96px" class="cls_028"><span class="cls_028">jr ra</span></div>
<div style="position:absolute;left:71.99px;top:586.95px" class="cls_028"><span class="cls_028">END(myfunc)</span></div>
<div style="position:absolute;left:48.02px;top:606.67px" class="cls_006"><span class="cls_006">There are a few notable differences from the previous example:</span></div>
<div style="position:absolute;left:108.00px;top:628.00px" class="cls_028"><span class="cls_028">.globl myfunc</span></div>
<div style="position:absolute;left:108.00px;top:638.00px" class="cls_028"><span class="cls_028">.ent</span></div>
<div style="position:absolute;left:144.09px;top:638.00px" class="cls_028"><span class="cls_028">myfunc,0</span></div>
<div style="position:absolute;left:108.00px;top:648.00px" class="cls_028"><span class="cls_028">.frame fp,myfunc_frmsz,$0</span></div>
<div style="position:absolute;left:48.02px;top:667.67px" class="cls_006"><span class="cls_006">The function can’t use the </span><span class="cls_029">NESTED</span><span class="cls_006"> macro any more, since it is using a</span></div>
<div style="position:absolute;left:36.00px;top:678.67px" class="cls_006"><span class="cls_006">separate frame pointer which must be explicitly declared using the .frame</span></div>
<div style="position:absolute;left:36.00px;top:689.67px" class="cls_006"><span class="cls_006">directive.</span></div>
<div style="position:absolute;left:108.00px;top:711.00px" class="cls_028"><span class="cls_028">.mask</span></div>
<div style="position:absolute;left:144.11px;top:711.00px" class="cls_028"><span class="cls_028">0xc0010000, -4</span></div>
<div style="position:absolute;left:108.00px;top:721.00px" class="cls_028"><span class="cls_028">sw ra,myfunc_frmsz-8(sp)</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">10-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:119498px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">C PROGRAMMING</span></div>
<div style="position:absolute;left:520.30px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 10</span></div>
<div style="position:absolute;left:288.00px;top:51.00px" class="cls_028"><span class="cls_028">sw fp,myfunc_frmsz-12(sp)</span></div>
<div style="position:absolute;left:288.00px;top:61.00px" class="cls_028"><span class="cls_028">sw s0,myfunc_frmsz-16(sp)</span></div>
<div style="position:absolute;left:228.02px;top:80.67px" class="cls_006"><span class="cls_006">Since the program will modify </span><span class="cls_008">fp</span><span class="cls_006"> (= </span><span class="cls_008">s8</span><span class="cls_006"> = </span><span class="cls_008">$30),</span><span class="cls_006"> it must save it in the</span></div>
<div style="position:absolute;left:216.00px;top:91.67px" class="cls_006"><span class="cls_006">stackframe too.</span></div>
<div style="position:absolute;left:288.00px;top:113.00px" class="cls_028"><span class="cls_028"># t6 = alloca (t5)</span></div>
<div style="position:absolute;left:288.00px;top:123.00px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:324.09px;top:123.00px" class="cls_028"><span class="cls_028">t5,7</span></div>
<div style="position:absolute;left:432.19px;top:123.00px" class="cls_028"><span class="cls_028"># make sure that size</span></div>
<div style="position:absolute;left:288.00px;top:133.00px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:324.07px;top:133.00px" class="cls_028"><span class="cls_028">t5,~7</span></div>
<div style="position:absolute;left:432.18px;top:133.00px" class="cls_028"><span class="cls_028"># is multiple of 8</span></div>
<div style="position:absolute;left:288.00px;top:143.00px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:324.09px;top:143.00px" class="cls_028"><span class="cls_028">sp,t5</span></div>
<div style="position:absolute;left:432.21px;top:143.00px" class="cls_028"><span class="cls_028"># allocate stack</span></div>
<div style="position:absolute;left:288.00px;top:153.00px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:324.09px;top:153.00px" class="cls_028"><span class="cls_028">t6,sp,20</span></div>
<div style="position:absolute;left:432.28px;top:153.00px" class="cls_028"><span class="cls_028"># leave room for args</span></div>
<div style="position:absolute;left:228.02px;top:172.67px" class="cls_006"><span class="cls_006">This sequence allocates a variable number of bytes on the stack, and</span></div>
<div style="position:absolute;left:216.00px;top:183.67px" class="cls_006"><span class="cls_006">sets a register </span><span class="cls_008">(t6)</span><span class="cls_006"> to point to it. The program must make sure that the size</span></div>
<div style="position:absolute;left:216.00px;top:194.67px" class="cls_006"><span class="cls_006">is rounded up to a multiple of 8, so that the stack stays correctly aligned.</span></div>
<div style="position:absolute;left:216.00px;top:205.67px" class="cls_006"><span class="cls_006">In addition, it must add 20 to the stack pointer, to leave room for the five</span></div>
<div style="position:absolute;left:216.00px;top:216.67px" class="cls_006"><span class="cls_006">argument words that will be used in future calls.</span></div>
<div style="position:absolute;left:288.00px;top:238.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:238.00px" class="cls_028"><span class="cls_028">a0,16(sp)</span></div>
<div style="position:absolute;left:432.25px;top:238.00px" class="cls_028"><span class="cls_028"># arg5 (out) = arg1 (in)</span></div>
<div style="position:absolute;left:288.00px;top:248.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:248.00px" class="cls_028"><span class="cls_028">a0,myfunc_frmsz+16(fp)# arg1 (out) = arg5 (in)</span></div>
<div style="position:absolute;left:288.00px;top:258.00px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:258.00px" class="cls_028"><span class="cls_028">otherfunc</span></div>
<div style="position:absolute;left:288.00px;top:268.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:268.00px" class="cls_028"><span class="cls_028">v0,myfunc_frmsz-4(fp)# local = result</span></div>
<div style="position:absolute;left:228.02px;top:287.67px" class="cls_006"><span class="cls_006">When building another function’s arguments, use the </span><span class="cls_008">sp</span><span class="cls_006"> register; but</span></div>
<div style="position:absolute;left:216.00px;top:298.67px" class="cls_006"><span class="cls_006">when accessing input arguments or local variables the program must use</span></div>
<div style="position:absolute;left:216.00px;top:309.67px" class="cls_006"><span class="cls_006">the </span><span class="cls_008">fp</span><span class="cls_006"> register.</span></div>
<div style="position:absolute;left:288.00px;top:331.00px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.09px;top:331.00px" class="cls_028"><span class="cls_028">sp,fp</span></div>
<div style="position:absolute;left:468.21px;top:331.00px" class="cls_028"><span class="cls_028"># restore stack</span></div>
<div style="position:absolute;left:252.00px;top:341.00px" class="cls_028"><span class="cls_028">pointer</span></div>
<div style="position:absolute;left:288.00px;top:351.00px" class="cls_028"><span class="cls_028">l.d $f20,myfunc_frmsz-24(sp)</span></div>
<div style="position:absolute;left:288.00px;top:361.00px" class="cls_028"><span class="cls_028">lw s0,myfunc_frmsz-16(sp)</span></div>
<div style="position:absolute;left:288.00px;top:371.00px" class="cls_028"><span class="cls_028">lw fp,myfunc_frmsz-12(sp)</span></div>
<div style="position:absolute;left:228.02px;top:390.67px" class="cls_006"><span class="cls_006">Finally, at the start of the function epilogue, restore the stack pointer to</span></div>
<div style="position:absolute;left:216.00px;top:401.67px" class="cls_006"><span class="cls_006">its post-prologue position, and then restore the registers (not forgetting to</span></div>
<div style="position:absolute;left:216.00px;top:412.67px" class="cls_006"><span class="cls_006">restore the old value of </span><span class="cls_008">fp,</span><span class="cls_006"> of course).</span></div>
<div style="position:absolute;left:216.00px;top:435.00px" class="cls_015"><span class="cls_015">SHARED AND NON-SHARED LIBRARIES</span></div>
<div style="position:absolute;left:228.02px;top:448.67px" class="cls_006"><span class="cls_006">A C object library is a collection of pre-compiled modules, which are</span></div>
<div style="position:absolute;left:216.00px;top:459.67px" class="cls_006"><span class="cls_006">automatically linked into a program’s binary when it refers to a function or</span></div>
<div style="position:absolute;left:216.00px;top:470.67px" class="cls_006"><span class="cls_006">variable whose name is defined in the module. Many standard C functions</span></div>
<div style="position:absolute;left:216.00px;top:481.67px" class="cls_006"><span class="cls_006">like </span><span class="cls_029">printf</span><span class="cls_006"> are defined in libraries.</span></div>
<div style="position:absolute;left:228.02px;top:492.67px" class="cls_006"><span class="cls_006">Libraries provide a simple and powerful way of extending the language;</span></div>
<div style="position:absolute;left:216.00px;top:503.67px" class="cls_006"><span class="cls_006">but in a multi-tasking OS every program will carry its own copy of the</span></div>
<div style="position:absolute;left:216.00px;top:514.67px" class="cls_006"><span class="cls_006">library function. Modern library functions may be huge; for example the</span></div>
<div style="position:absolute;left:216.00px;top:525.67px" class="cls_006"><span class="cls_006">graphics interface libraries to the widely-used X window system add about</span></div>
<div style="position:absolute;left:216.00px;top:536.67px" class="cls_006"><span class="cls_006">300Kbytes to the size of a MIPS object, dwarfing the application code of</span></div>
<div style="position:absolute;left:216.00px;top:547.67px" class="cls_006"><span class="cls_006">many simpler programs.</span></div>
<div style="position:absolute;left:228.02px;top:558.67px" class="cls_006"><span class="cls_006">In response to this problem most modern OS’ provide some way in which</span></div>
<div style="position:absolute;left:216.00px;top:569.67px" class="cls_006"><span class="cls_006">library code may be shared between different applications. There are</span></div>
<div style="position:absolute;left:216.00px;top:580.67px" class="cls_006"><span class="cls_006">different approaches:</span></div>
<div style="position:absolute;left:216.00px;top:603.00px" class="cls_015"><span class="cls_015">Sharing code in single-address space systems</span></div>
<div style="position:absolute;left:228.02px;top:616.67px" class="cls_006"><span class="cls_006">In a single address-space OS like VxWorks†, programs can be linked to</span></div>
<div style="position:absolute;left:216.00px;top:627.67px" class="cls_006"><span class="cls_006">library functions by deferring the link operation (which actually fixes up</span></div>
<div style="position:absolute;left:216.00px;top:638.67px" class="cls_006"><span class="cls_006">the program code) until the program is loaded into system memory. In this</span></div>
<div style="position:absolute;left:216.00px;top:649.67px" class="cls_006"><span class="cls_006">kind of system the library function becomes part of a single large program.</span></div>
<div style="position:absolute;left:216.00px;top:660.67px" class="cls_006"><span class="cls_006">But:</span></div>
<div style="position:absolute;left:228.02px;top:674.67px" class="cls_006"><span class="cls_006">• The libraries must be written to be ‘‘re-entrant’’; they may be used by</span></div>
<div style="position:absolute;left:239.97px;top:685.67px" class="cls_006"><span class="cls_006">different tasks, and one task may be suspended in the middle of a</span></div>
<div style="position:absolute;left:239.97px;top:696.67px" class="cls_006"><span class="cls_006">library function and that function re-used by another.</span></div>
<div style="position:absolute;left:234.00px;top:722.67px" class="cls_006"><span class="cls_006">† VxWorks is a trademark of Wind River Systems, Inc.</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">10-9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:120300px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 10</span></div>
<div style="position:absolute;left:479.82px;top:28.00px" class="cls_002"><span class="cls_002">C PROGRAMMING</span></div>
<div style="position:absolute;left:59.98px;top:50.67px" class="cls_006"><span class="cls_006">For simple operations, re-entrancy is easily achieved by avoiding any</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">use of static modifiable data (so that all computation is done on the</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">stack and in machine registers). However, where library functions</span></div>
<div style="position:absolute;left:59.98px;top:83.67px" class="cls_006"><span class="cls_006">must  maintain  internal  data  life  gets  much  more  complicated;</span></div>
<div style="position:absolute;left:59.98px;top:94.67px" class="cls_006"><span class="cls_006">accesses to shared variables must use the programming technique of</span></div>
<div style="position:absolute;left:59.98px;top:105.67px" class="cls_006"><span class="cls_006">critical regions protected by semaphores.</span></div>
<div style="position:absolute;left:59.98px;top:119.67px" class="cls_006"><span class="cls_006">This does mean that library programmers must respect these rules,</span></div>
<div style="position:absolute;left:59.98px;top:130.67px" class="cls_006"><span class="cls_006">and   can’t   just   recompile   existing   code   into   libraries   without</span></div>
<div style="position:absolute;left:59.98px;top:141.67px" class="cls_006"><span class="cls_006">modification.</span></div>
<div style="position:absolute;left:48.03px;top:155.67px" class="cls_006"><span class="cls_006">• The run-time system must maintain a symbol table for loading.</span></div>
<div style="position:absolute;left:59.98px;top:166.67px" class="cls_006"><span class="cls_006">System utilities such as the debugger also need access to the symbol</span></div>
<div style="position:absolute;left:59.98px;top:177.67px" class="cls_006"><span class="cls_006">table and relocation information.</span></div>
<div style="position:absolute;left:48.03px;top:188.67px" class="cls_006"><span class="cls_006">In such a system a little extra work at load time allows a single copy of</span></div>
<div style="position:absolute;left:36.01px;top:199.67px" class="cls_006"><span class="cls_006">a library function to be freely used by the OS kernel, drivers and any</span></div>
<div style="position:absolute;left:36.01px;top:210.67px" class="cls_006"><span class="cls_006">number of application tasks. Simple functions suffer very little run-time</span></div>
<div style="position:absolute;left:36.01px;top:221.67px" class="cls_006"><span class="cls_006">overhead (the convenient gp-relative addressing optimization, described in</span></div>
<div style="position:absolute;left:36.01px;top:232.67px" class="cls_006"><span class="cls_006">the last chapter, cannot be used); the critical region overhead for shared</span></div>
<div style="position:absolute;left:36.01px;top:243.67px" class="cls_006"><span class="cls_006">data is unavoidable.</span></div>
<div style="position:absolute;left:36.00px;top:266.00px" class="cls_015"><span class="cls_015">Sharing code across address spaces</span></div>
<div style="position:absolute;left:48.02px;top:279.67px" class="cls_006"><span class="cls_006">In a ‘‘protected’’ OS where separate applications run in separate virtual</span></div>
<div style="position:absolute;left:36.00px;top:290.67px" class="cls_006"><span class="cls_006">address spaces, the problems are quite different. This section will outline</span></div>
<div style="position:absolute;left:36.00px;top:301.67px" class="cls_006"><span class="cls_006">the way in which Unix-like systems conforming to the MIPS/ABI standard</span></div>
<div style="position:absolute;left:36.00px;top:312.67px" class="cls_006"><span class="cls_006">provide libraries which can be shared between different applications, with</span></div>
<div style="position:absolute;left:36.00px;top:323.67px" class="cls_006"><span class="cls_006">no restriction on how the libraries and applications can be programmed.</span></div>
<div style="position:absolute;left:48.02px;top:334.67px" class="cls_006"><span class="cls_006">Every MIPS/ABI application runs in its own virtual address space. The</span></div>
<div style="position:absolute;left:36.00px;top:345.67px" class="cls_006"><span class="cls_006">application code is fixed to particular locations in this address space when</span></div>
<div style="position:absolute;left:36.00px;top:356.67px" class="cls_006"><span class="cls_006">it is linked. Library code is not built in; the application carries a table of</span></div>
<div style="position:absolute;left:36.00px;top:367.67px" class="cls_006"><span class="cls_006">the names of library functions and variables which are used, but not yet</span></div>
<div style="position:absolute;left:36.00px;top:378.67px" class="cls_006"><span class="cls_006">included. In addition, the application’s symbol table defines public items</span></div>
<div style="position:absolute;left:36.00px;top:389.67px" class="cls_006"><span class="cls_006">which may be called from the library; under MIPS/ABI, library routines</span></div>
<div style="position:absolute;left:36.00px;top:400.67px" class="cls_006"><span class="cls_006">may freely refer to public data, or call public functions, in application</span></div>
<div style="position:absolute;left:36.00px;top:411.67px" class="cls_006"><span class="cls_006">code†.</span></div>
<div style="position:absolute;left:48.02px;top:422.67px" class="cls_006"><span class="cls_006">In  the  MIPS/ABI  model  the  binary  application  code  must  not  be</span></div>
<div style="position:absolute;left:36.00px;top:433.67px" class="cls_006"><span class="cls_006">modified; it may itself be shared by multiple invocations of the application</span></div>
<div style="position:absolute;left:36.00px;top:444.67px" class="cls_006"><span class="cls_006">by multiple users.</span></div>
<div style="position:absolute;left:48.02px;top:455.67px" class="cls_006"><span class="cls_006">It is not possible to predefine the actual virtual addresses at which a</span></div>
<div style="position:absolute;left:36.00px;top:466.67px" class="cls_006"><span class="cls_006">library’s code and data will be located, but the offset from the start of its</span></div>
<div style="position:absolute;left:36.00px;top:477.67px" class="cls_006"><span class="cls_006">code to the start of its data is fixed, and this permits a number of tricks to</span></div>
<div style="position:absolute;left:36.00px;top:488.67px" class="cls_006"><span class="cls_006">be used.</span></div>
<div style="position:absolute;left:48.02px;top:502.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Position-independent  code</span><span class="cls_006">:   the   compiler   and   assembler</span></div>
<div style="position:absolute;left:366.49px;top:502.67px" class="cls_006"><span class="cls_006">(by   a</span></div>
<div style="position:absolute;left:59.97px;top:513.67px" class="cls_006"><span class="cls_006">command line option, used for library functions) can generate fully</span></div>
<div style="position:absolute;left:59.97px;top:524.67px" class="cls_006"><span class="cls_006">‘‘position independent code’’ (PIC). All MIPS branch instructions are</span></div>
<div style="position:absolute;left:59.97px;top:535.67px" class="cls_006"><span class="cls_006">PC-relative; somewhat more complex sequences must be used to load</span></div>
<div style="position:absolute;left:59.97px;top:546.67px" class="cls_006"><span class="cls_006">a PC-relative address into a register, but if necessary it can be done:</span></div>
<div style="position:absolute;left:72.00px;top:568.00px" class="cls_028"><span class="cls_028">la rd, label</span></div>
<div style="position:absolute;left:144.28px;top:568.00px" class="cls_028"><span class="cls_028">-></span></div>
<div style="position:absolute;left:180.33px;top:568.00px" class="cls_028"><span class="cls_028">bgezal $zero, 1f</span></div>
<div style="position:absolute;left:180.00px;top:578.00px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:149.40px;top:588.00px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:180.07px;top:588.00px" class="cls_028"><span class="cls_028">addu rd, $31, label - 1b</span></div>
<div style="position:absolute;left:48.02px;top:610.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Indirection and the Global offset table</span><span class="cls_006">: PIC is suitable for references to</span></div>
<div style="position:absolute;left:59.97px;top:621.67px" class="cls_006"><span class="cls_006">code within a single module of a library (because the module’s code is</span></div>
<div style="position:absolute;left:59.97px;top:632.67px" class="cls_006"><span class="cls_006">loaded as a single entity into consecutive virtual addresses). Data, or</span></div>
<div style="position:absolute;left:59.97px;top:643.67px" class="cls_006"><span class="cls_006">external functions, will be at locations which cannot be determined</span></div>
<div style="position:absolute;left:59.97px;top:654.67px" class="cls_006"><span class="cls_006">until the application and library are loaded, and so their addresses</span></div>
<div style="position:absolute;left:59.97px;top:665.67px" class="cls_006"><span class="cls_006">cannot be embedded in the program text.</span></div>
<div style="position:absolute;left:54.00px;top:722.67px" class="cls_006"><span class="cls_006">† Though this may not be good programming practice.</span></div>
<div style="position:absolute;left:287.55px;top:755.34px" class="cls_002"><span class="cls_002">10-10</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:121102px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">C PROGRAMMING</span></div>
<div style="position:absolute;left:520.30px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 10</span></div>
<div style="position:absolute;left:239.98px;top:50.67px" class="cls_006"><span class="cls_006">Such addresses are held in a table built in the each library’s per-</span></div>
<div style="position:absolute;left:239.98px;top:61.67px" class="cls_006"><span class="cls_006">process data space, the ‘‘global offset table’’ (GOT). Since the data</span></div>
<div style="position:absolute;left:239.98px;top:72.67px" class="cls_006"><span class="cls_006">space is not shared and is writable, the table can be built as the</span></div>
<div style="position:absolute;left:239.98px;top:83.67px" class="cls_006"><span class="cls_006">application and its libraries are loaded.</span></div>
<div style="position:absolute;left:239.98px;top:97.67px" class="cls_006"><span class="cls_006">A library function refers to a variable or external function through the</span></div>
<div style="position:absolute;left:239.98px;top:108.67px" class="cls_006"><span class="cls_006">GOT at a table index fixed when the library was compiled and linked.</span></div>
<div style="position:absolute;left:239.98px;top:119.67px" class="cls_006"><span class="cls_006">A load of the external integer type ‘‘errno’’ will come out as:</span></div>
<div style="position:absolute;left:252.00px;top:141.00px" class="cls_028"><span class="cls_028">lw rd, errno</span></div>
<div style="position:absolute;left:324.00px;top:141.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     la gp, ThisLibsGOTBase</span></div>
<div style="position:absolute;left:360.00px;top:151.00px" class="cls_028"><span class="cls_028">lw rd, errno_offset(gp)</span></div>
<div style="position:absolute;left:360.00px;top:161.00px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:360.00px;top:171.00px" class="cls_028"><span class="cls_028">lw rd, 0(rd)</span></div>
<div style="position:absolute;left:239.98px;top:193.67px" class="cls_006"><span class="cls_006">Similarly, invocation of the shared-library function </span><span class="cls_029">exit()</span><span class="cls_006"> would</span></div>
<div style="position:absolute;left:239.98px;top:204.67px" class="cls_006"><span class="cls_006">look like this:</span></div>
<div style="position:absolute;left:252.00px;top:226.00px" class="cls_028"><span class="cls_028">/* setup argument */</span></div>
<div style="position:absolute;left:252.00px;top:236.00px" class="cls_028"><span class="cls_028">jal exit</span></div>
<div style="position:absolute;left:324.00px;top:236.00px" class="cls_021"><span class="cls_021">→</span><span class="cls_028">     la gp, ThisLibsGOTBase</span></div>
<div style="position:absolute;left:360.00px;top:246.00px" class="cls_028"><span class="cls_028">lw t9, exit_offset(gp)</span></div>
<div style="position:absolute;left:360.00px;top:256.00px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:360.00px;top:266.00px" class="cls_028"><span class="cls_028">jalr t9</span></div>
<div style="position:absolute;left:239.98px;top:288.67px" class="cls_006"><span class="cls_006">The register </span><span class="cls_008">gp</span><span class="cls_006"> (or </span><span class="cls_008">$28</span><span class="cls_006"> ) is a good choice for the table base. Because</span></div>
<div style="position:absolute;left:239.99px;top:299.67px" class="cls_006"><span class="cls_006">of its role in providing fast access to short variables it is not modified</span></div>
<div style="position:absolute;left:239.99px;top:310.67px" class="cls_006"><span class="cls_006">by standard functions. As an optimization it is calculated only once</span></div>
<div style="position:absolute;left:239.99px;top:321.67px" class="cls_006"><span class="cls_006">per function, in the function prologue. The calculation uses the fact</span></div>
<div style="position:absolute;left:239.99px;top:332.67px" class="cls_006"><span class="cls_006">that the function’s actual virtual address will be in </span><span class="cls_008">t9</span><span class="cls_006"> (see previous</span></div>
<div style="position:absolute;left:240.00px;top:343.67px" class="cls_006"><span class="cls_006">example), and that the library’s GOT is at a fixed offset from its code.</span></div>
<div style="position:absolute;left:240.00px;top:354.67px" class="cls_006"><span class="cls_006">So a position-independent function prologue might start like this:</span></div>
<div style="position:absolute;left:252.00px;top:376.00px" class="cls_028"><span class="cls_028">func:</span></div>
<div style="position:absolute;left:288.00px;top:386.00px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:324.05px;top:386.00px" class="cls_028"><span class="cls_028">gp, _gp_disp</span></div>
<div style="position:absolute;left:288.00px;top:396.00px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:324.09px;top:396.00px" class="cls_028"><span class="cls_028">gp, gp, t9</span></div>
<div style="position:absolute;left:288.00px;top:406.00px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:324.09px;top:406.00px" class="cls_028"><span class="cls_028">sp, sp, framesize</span></div>
<div style="position:absolute;left:288.00px;top:416.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:416.00px" class="cls_028"><span class="cls_028">gp, 32(sp)</span></div>
<div style="position:absolute;left:239.98px;top:438.67px" class="cls_006"><span class="cls_006">In  the  above  example,</span></div>
<div style="position:absolute;left:366.99px;top:438.67px" class="cls_029"><span class="cls_029">_gp_disp</span><span class="cls_006">  is  a  magic  symbol  which  is</span></div>
<div style="position:absolute;left:239.98px;top:449.67px" class="cls_006"><span class="cls_006">recognized by the linker when building a shared library: it’s value will</span></div>
<div style="position:absolute;left:239.98px;top:460.67px" class="cls_006"><span class="cls_006">be the offset between the instruction and the GOT. The calculated</span></div>
<div style="position:absolute;left:239.98px;top:471.67px" class="cls_006"><span class="cls_006">value is saved on the stack, and must be restored from there after a</span></div>
<div style="position:absolute;left:239.98px;top:482.67px" class="cls_006"><span class="cls_006">call to an external function, since that function may itself have</span></div>
<div style="position:absolute;left:239.98px;top:493.67px" class="cls_006"><span class="cls_006">modified </span><span class="cls_008">gp.</span></div>
<div style="position:absolute;left:228.03px;top:504.67px" class="cls_006"><span class="cls_006">There is much more that could be said about the way in which the</span></div>
<div style="position:absolute;left:216.01px;top:515.67px" class="cls_006"><span class="cls_006">MIPS/ABI implementation is optimized. For example, no attempt is made</span></div>
<div style="position:absolute;left:216.01px;top:526.67px" class="cls_006"><span class="cls_006">to link in libraries when an application is first loaded into memory; dummy</span></div>
<div style="position:absolute;left:216.01px;top:537.67px" class="cls_006"><span class="cls_006">GOT entries are used instead. When and if the application uses a library</span></div>
<div style="position:absolute;left:216.01px;top:548.67px" class="cls_006"><span class="cls_006">module, the reference is caught and fixed up in much the same way as a</span></div>
<div style="position:absolute;left:216.01px;top:559.67px" class="cls_006"><span class="cls_006">virtual-memory system incrementally pages-in a program image.</span></div>
<div style="position:absolute;left:216.00px;top:582.00px" class="cls_015"><span class="cls_015">AN INTRODUCTION TO OPTIMIZATION</span></div>
<div style="position:absolute;left:228.02px;top:595.67px" class="cls_006"><span class="cls_006">The compiler writer’s first responsibility is to ensure that the generated</span></div>
<div style="position:absolute;left:216.00px;top:606.67px" class="cls_006"><span class="cls_006">code does precisely what the language semantics say it should; and that is</span></div>
<div style="position:absolute;left:216.00px;top:617.67px" class="cls_006"><span class="cls_006">hard  enough.  In  modern  compilers,  the  optimizer  has  a  secondary</span></div>
<div style="position:absolute;left:216.00px;top:628.67px" class="cls_006"><span class="cls_006">purpose, which is to allow the compiler’s basic code generator to be simple</span></div>
<div style="position:absolute;left:216.00px;top:639.67px" class="cls_006"><span class="cls_006">(and therefore easier to implement correctly).</span></div>
<div style="position:absolute;left:216.00px;top:662.00px" class="cls_015"><span class="cls_015">Common optimizations</span></div>
<div style="position:absolute;left:228.02px;top:675.67px" class="cls_006"><span class="cls_006">Most compilers will do all of the following. Occasionally the assembler</span></div>
<div style="position:absolute;left:216.00px;top:686.67px" class="cls_006"><span class="cls_006">may get in on some of them too.</span></div>
<div style="position:absolute;left:301.30px;top:755.34px" class="cls_002"><span class="cls_002">10-11</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:121904px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 10</span></div>
<div style="position:absolute;left:479.82px;top:28.00px" class="cls_002"><span class="cls_002">C PROGRAMMING</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Common sub-expression elimination (CSE)</span><span class="cls_006">: this detects when the code</span></div>
<div style="position:absolute;left:59.97px;top:61.67px" class="cls_006"><span class="cls_006">is doing the same work twice. At first sight this looks like it is just</span></div>
<div style="position:absolute;left:59.97px;top:72.67px" class="cls_006"><span class="cls_006">making up for dumb programming; but in fact CSE is critically</span></div>
<div style="position:absolute;left:59.97px;top:83.67px" class="cls_006"><span class="cls_006">important, and tends to be run many times to tidy up after other</span></div>
<div style="position:absolute;left:59.97px;top:94.67px" class="cls_006"><span class="cls_006">stages:</span></div>
<div style="position:absolute;left:48.02px;top:108.67px" class="cls_006"><span class="cls_006">a)</span></div>
<div style="position:absolute;left:84.02px;top:108.67px" class="cls_006"><span class="cls_006">It is CSE which gives the compiler the ability to optimize across</span></div>
<div style="position:absolute;left:84.02px;top:119.67px" class="cls_006"><span class="cls_006">the  function.  The  basic  code  generator  works  through  the</span></div>
<div style="position:absolute;left:84.02px;top:130.67px" class="cls_006"><span class="cls_006">program expression-by-expression; even for well-written source-</span></div>
<div style="position:absolute;left:84.02px;top:141.67px" class="cls_006"><span class="cls_006">code, the expansion of simple C statements into multiple MIPS</span></div>
<div style="position:absolute;left:84.02px;top:152.67px" class="cls_006"><span class="cls_006">instructions will lead to a lot of duplicated effort. The very first</span></div>
<div style="position:absolute;left:84.02px;top:163.67px" class="cls_006"><span class="cls_006">CSE pass factors out the duplication and clears the way for</span></div>
<div style="position:absolute;left:84.02px;top:174.67px" class="cls_006"><span class="cls_006">register allocation.</span></div>
<div style="position:absolute;left:48.02px;top:188.67px" class="cls_006"><span class="cls_006">b)</span></div>
<div style="position:absolute;left:84.02px;top:188.67px" class="cls_006"><span class="cls_006">Most memory-reference optimization is actually done by CSE -</span></div>
<div style="position:absolute;left:84.02px;top:199.67px" class="cls_006"><span class="cls_006">the code which fetches a variable from memory is itself a sub-</span></div>
<div style="position:absolute;left:84.02px;top:210.67px" class="cls_006"><span class="cls_006">expression.</span></div>
<div style="position:absolute;left:84.02px;top:224.67px" class="cls_006"><span class="cls_006">The  enemy  of  CSE  is  unpredictable  flow  of  control:  the</span></div>
<div style="position:absolute;left:84.02px;top:235.67px" class="cls_006"><span class="cls_006">conditional branch. Once code turns into spaghetti, the compiler</span></div>
<div style="position:absolute;left:84.02px;top:246.67px" class="cls_006"><span class="cls_006">finds it difficult to know what computation has run before which;</span></div>
<div style="position:absolute;left:84.02px;top:257.67px" class="cls_006"><span class="cls_006">with  some  straightforward  exceptions,  CSE  can  really  only</span></div>
<div style="position:absolute;left:84.02px;top:268.67px" class="cls_006"><span class="cls_006">operate inside </span><span class="cls_008">basic blocks</span><span class="cls_006"> (a piece of code delimited by, but not</span></div>
<div style="position:absolute;left:84.02px;top:279.67px" class="cls_006"><span class="cls_006">containing, either an entry point or a conditional branch). CSE</span></div>
<div style="position:absolute;left:84.02px;top:290.67px" class="cls_006"><span class="cls_006">markedly   improves   both   code   density   and   run-time</span></div>
<div style="position:absolute;left:84.02px;top:301.67px" class="cls_006"><span class="cls_006">performance.</span></div>
<div style="position:absolute;left:72.00px;top:315.67px" class="cls_006"><span class="cls_006">Similar to CSE are the optimizations of constant folding, constant</span></div>
<div style="position:absolute;left:72.00px;top:326.67px" class="cls_006"><span class="cls_006">propagation  and  arithmetic  simplification.  These  pre-compute</span></div>
<div style="position:absolute;left:72.00px;top:337.67px" class="cls_006"><span class="cls_006">arithmetic performed on constants, and modify other expressions</span></div>
<div style="position:absolute;left:72.00px;top:348.67px" class="cls_006"><span class="cls_006">using standard algebraic rules so as to permit further constant</span></div>
<div style="position:absolute;left:72.00px;top:359.67px" class="cls_006"><span class="cls_006">folding and better CSE.</span></div>
<div style="position:absolute;left:48.02px;top:373.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:373.67px" class="cls_008"><span class="cls_008">Jump  optimization</span><span class="cls_006">:  removes  redundant  tests  and  jumps.  Code</span></div>
<div style="position:absolute;left:59.97px;top:384.67px" class="cls_006"><span class="cls_006">produced by earlier compiler stages often contains jumps to jumps,</span></div>
<div style="position:absolute;left:59.97px;top:395.67px" class="cls_006"><span class="cls_006">jumps around unreachable code, redundant conditional jumps, and</span></div>
<div style="position:absolute;left:59.97px;top:406.67px" class="cls_006"><span class="cls_006">so on. These optimizations will remove this redundancy.</span></div>
<div style="position:absolute;left:48.02px;top:420.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:420.67px" class="cls_008"><span class="cls_008">Strength  reduction</span><span class="cls_006">:  means  the  replacement  of  computationally</span></div>
<div style="position:absolute;left:59.97px;top:431.67px" class="cls_006"><span class="cls_006">expensive operations by cheaper ones. For example; multiplication by</span></div>
<div style="position:absolute;left:59.97px;top:442.67px" class="cls_006"><span class="cls_006">a constant value can be replaced by a series of shifts and adds. This</span></div>
<div style="position:absolute;left:59.97px;top:453.67px" class="cls_006"><span class="cls_006">actually tends to increase the code size while reducing run-time.</span></div>
<div style="position:absolute;left:48.02px;top:467.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:467.67px" class="cls_008"><span class="cls_008">Loop optimization</span><span class="cls_006">: studies loops in the code, starting with the inner</span></div>
<div style="position:absolute;left:59.97px;top:478.67px" class="cls_006"><span class="cls_006">ones (which, the compiler guesses, will be where most time is spent).</span></div>
<div style="position:absolute;left:59.97px;top:489.67px" class="cls_006"><span class="cls_006">There are a number of useful things which can be done:</span></div>
<div style="position:absolute;left:59.97px;top:503.67px" class="cls_006"><span class="cls_006">a) Sub-expressions which depend on variables which don’t change</span></div>
<div style="position:absolute;left:71.99px;top:514.67px" class="cls_006"><span class="cls_006">inside the loop can be pre-computed before the loop starts.</span></div>
<div style="position:absolute;left:59.97px;top:528.67px" class="cls_006"><span class="cls_006">b) Expressions which depend in some simple way on a loop variable</span></div>
<div style="position:absolute;left:71.99px;top:539.67px" class="cls_006"><span class="cls_006">can be simplified. For example, in:</span></div>
<div style="position:absolute;left:72.00px;top:561.00px" class="cls_028"><span class="cls_028">int i, x[NX];</span></div>
<div style="position:absolute;left:72.00px;top:581.00px" class="cls_028"><span class="cls_028">for (i = 0; i &lt;NX; i++)</span></div>
<div style="position:absolute;left:108.00px;top:591.00px" class="cls_028"><span class="cls_028">x[i]++;</span></div>
<div style="position:absolute;left:72.00px;top:613.67px" class="cls_006"><span class="cls_006">the array index (which would normally involve a multiplication and</span></div>
<div style="position:absolute;left:72.00px;top:624.67px" class="cls_006"><span class="cls_006">addition) can be replaced by an incrementing pointer.</span></div>
<div style="position:absolute;left:72.00px;top:638.67px" class="cls_006"><span class="cls_006">This kind of optimization will usually recognize only a particular set</span></div>
<div style="position:absolute;left:72.00px;top:649.67px" class="cls_006"><span class="cls_006">of stylized opportunities.</span></div>
<div style="position:absolute;left:59.98px;top:663.67px" class="cls_006"><span class="cls_006">c) Loops can be ‘‘unrolled’’, allowing the work of 2 to a few iterations</span></div>
<div style="position:absolute;left:72.00px;top:674.67px" class="cls_006"><span class="cls_006">of the loop to be performed in line. On some processors where</span></div>
<div style="position:absolute;left:72.00px;top:685.67px" class="cls_006"><span class="cls_006">branches are inherently slow, this is inherently effective; but this</span></div>
<div style="position:absolute;left:72.00px;top:696.67px" class="cls_006"><span class="cls_006">isn’t true for the R30xx family.</span></div>
<div style="position:absolute;left:287.55px;top:755.34px" class="cls_002"><span class="cls_002">10-12</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:122706px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">C PROGRAMMING</span></div>
<div style="position:absolute;left:520.30px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 10</span></div>
<div style="position:absolute;left:252.00px;top:50.67px" class="cls_006"><span class="cls_006">But the unrolled loop offers much better opportunity for other</span></div>
<div style="position:absolute;left:252.00px;top:61.67px" class="cls_006"><span class="cls_006">optimizations</span></div>
<div style="position:absolute;left:327.04px;top:61.67px" class="cls_006"><span class="cls_006">(CSE   and   register   allocation   being   the   main</span></div>
<div style="position:absolute;left:252.00px;top:72.67px" class="cls_006"><span class="cls_006">beneficiaries).</span></div>
<div style="position:absolute;left:252.00px;top:86.67px" class="cls_006"><span class="cls_006">Loop unrolling may significantly increase the size of the compiled</span></div>
<div style="position:absolute;left:252.00px;top:97.67px" class="cls_006"><span class="cls_006">program, and usually must be requested as a specific compiler</span></div>
<div style="position:absolute;left:252.00px;top:108.67px" class="cls_006"><span class="cls_006">option.</span></div>
<div style="position:absolute;left:228.02px;top:122.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:122.67px" class="cls_008"><span class="cls_008">Function inlining</span><span class="cls_006">: the compiler may guess that some small functions</span></div>
<div style="position:absolute;left:239.97px;top:133.67px" class="cls_006"><span class="cls_006">can be expanded in-line, like a macro, rather than calling them. This</span></div>
<div style="position:absolute;left:239.97px;top:144.67px" class="cls_006"><span class="cls_006">is another optimization which increases the size of the program to give</span></div>
<div style="position:absolute;left:239.97px;top:155.67px" class="cls_006"><span class="cls_006">better performance, and usually requires an explicit compiler option.</span></div>
<div style="position:absolute;left:239.97px;top:166.67px" class="cls_006"><span class="cls_006">Some compilers may recognize the </span><span class="cls_029">inline</span><span class="cls_006"> keyword used in C++ to</span></div>
<div style="position:absolute;left:239.97px;top:177.67px" class="cls_006"><span class="cls_006">allow the programmer to specify which functions should be ‘‘inlined’’.</span></div>
<div style="position:absolute;left:228.02px;top:191.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:191.67px" class="cls_008"><span class="cls_008">Minimize Register allocation</span><span class="cls_006">: by far the most important optimization</span></div>
<div style="position:absolute;left:239.97px;top:202.67px" class="cls_006"><span class="cls_006">stage is to make the best possible use of the 32 general purpose</span></div>
<div style="position:absolute;left:239.97px;top:213.67px" class="cls_006"><span class="cls_006">registers, to make code faster and smaller. The compiler identifies</span></div>
<div style="position:absolute;left:239.97px;top:224.67px" class="cls_006"><span class="cls_006">global  variables</span></div>
<div style="position:absolute;left:329.81px;top:224.67px" class="cls_006"><span class="cls_006">(static  and  external  data  stored  in  memory);</span></div>
<div style="position:absolute;left:239.97px;top:235.67px" class="cls_006"><span class="cls_006">automatic variables (defined within a function, and notionally stored</span></div>
<div style="position:absolute;left:239.97px;top:246.67px" class="cls_006"><span class="cls_006">on the stack); and intermediate products of expression evaluation.</span></div>
<div style="position:absolute;left:239.97px;top:260.67px" class="cls_006"><span class="cls_006">Any variable must eventually be assigned to a machine register, and</span></div>
<div style="position:absolute;left:239.97px;top:271.67px" class="cls_006"><span class="cls_006">input data copied to that register, before the CPU can do anything</span></div>
<div style="position:absolute;left:239.97px;top:282.67px" class="cls_006"><span class="cls_006">useful with it. The register allocator’s job is to minimize the amount</span></div>
<div style="position:absolute;left:239.97px;top:293.67px" class="cls_006"><span class="cls_006">of work done in shuffling data in and out of registers; it does this by</span></div>
<div style="position:absolute;left:239.97px;top:304.67px" class="cls_006"><span class="cls_006">maintaining some variables in registers for all or part of a function’s</span></div>
<div style="position:absolute;left:239.97px;top:315.67px" class="cls_006"><span class="cls_006">run-time.</span></div>
<div style="position:absolute;left:239.97px;top:329.67px" class="cls_006"><span class="cls_006">Note:</span></div>
<div style="position:absolute;left:239.97px;top:343.67px" class="cls_006"><span class="cls_006">a) This  process  usually  entirely  ignores  the  old-fashioned</span></div>
<div style="position:absolute;left:559.86px;top:343.67px" class="cls_006"><span class="cls_006">‘‘C’’</span></div>
<div style="position:absolute;left:251.99px;top:354.67px" class="cls_029"><span class="cls_029">register</span><span class="cls_006"> attribute. It might be used as a hint; but most compilers</span></div>
<div style="position:absolute;left:251.99px;top:365.67px" class="cls_006"><span class="cls_006">figure out for themselves which variables are best kept in registers,</span></div>
<div style="position:absolute;left:251.99px;top:376.67px" class="cls_006"><span class="cls_006">and when.</span></div>
<div style="position:absolute;left:239.97px;top:390.67px" class="cls_006"><span class="cls_006">b) The MIPS convention provides the compiler with 9 registers </span><span class="cls_008">s0-s8</span></div>
<div style="position:absolute;left:251.99px;top:401.67px" class="cls_006"><span class="cls_006">which can be freely used as automatic variables. Any function</span></div>
<div style="position:absolute;left:251.99px;top:412.67px" class="cls_006"><span class="cls_006">using one of these must save its value on entry, and restore it on</span></div>
<div style="position:absolute;left:251.99px;top:423.67px" class="cls_006"><span class="cls_006">exit. These registers tend to be suitable for long-term storage of</span></div>
<div style="position:absolute;left:251.99px;top:434.67px" class="cls_006"><span class="cls_006">user variables.</span></div>
<div style="position:absolute;left:251.99px;top:448.67px" class="cls_006"><span class="cls_006">It also has a set of 10 ‘‘temporary’’ registers </span><span class="cls_008">t0-t9</span><span class="cls_006"> which are typically</span></div>
<div style="position:absolute;left:251.99px;top:459.67px" class="cls_006"><span class="cls_006">used  for  intermediate  values  in  expression  evaluation.  The</span></div>
<div style="position:absolute;left:251.99px;top:470.67px" class="cls_006"><span class="cls_006">‘‘argument’’ registers </span><span class="cls_008">a0-a3</span><span class="cls_006"> and ‘‘result’’ registers </span><span class="cls_008">v0-v1</span><span class="cls_006"> can be</span></div>
<div style="position:absolute;left:251.98px;top:481.67px" class="cls_006"><span class="cls_006">freely used too. However, these values don’t survive a function call;</span></div>
<div style="position:absolute;left:251.98px;top:492.67px" class="cls_006"><span class="cls_006">if data is to be kept past a function call it is more efficient to use</span></div>
<div style="position:absolute;left:251.98px;top:503.67px" class="cls_006"><span class="cls_006">one of the ‘‘callee saved’’ registers </span><span class="cls_008">s0-s8,</span><span class="cls_006"> because then the work of</span></div>
<div style="position:absolute;left:251.98px;top:514.67px" class="cls_006"><span class="cls_006">saving and restoring the value will be done only if a called function</span></div>
<div style="position:absolute;left:251.98px;top:525.67px" class="cls_006"><span class="cls_006">really wants to use that register.</span></div>
<div style="position:absolute;left:239.96px;top:539.67px" class="cls_006"><span class="cls_006">c) C’s  semantics  mean  that  any  write  through  a  pointer  could</span></div>
<div style="position:absolute;left:251.98px;top:550.67px" class="cls_006"><span class="cls_006">potentially alter almost any memory location; so a compiler’s ability</span></div>
<div style="position:absolute;left:251.98px;top:561.67px" class="cls_006"><span class="cls_006">to maintain a user-defined variable in a register is strictly limited.</span></div>
<div style="position:absolute;left:251.98px;top:572.67px" class="cls_006"><span class="cls_006">It is safe to do so for any function variable (automatic variable)</span></div>
<div style="position:absolute;left:251.98px;top:583.67px" class="cls_006"><span class="cls_006">which is nowhere subject to the ‘‘address-of’’ operator ‘‘</span><span class="cls_029"> &</span><span class="cls_006">’’. It may</span></div>
<div style="position:absolute;left:251.98px;top:594.67px" class="cls_006"><span class="cls_006">be able to do this for a variable inside a loop where there is neither</span></div>
<div style="position:absolute;left:251.98px;top:605.67px" class="cls_006"><span class="cls_006">a store-through-pointer operation nor a function call.</span></div>
<div style="position:absolute;left:228.00px;top:619.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.95px;top:619.67px" class="cls_008"><span class="cls_008">Pipeline-specific code re-scheduling</span><span class="cls_006">: the compiler or assembler can</span></div>
<div style="position:absolute;left:239.95px;top:630.67px" class="cls_006"><span class="cls_006">sometimes move the logical instruction flow around so as to make</span></div>
<div style="position:absolute;left:239.95px;top:641.67px" class="cls_006"><span class="cls_006">good use of the branch and load ‘‘delay slots’’. In practice, the delay</span></div>
<div style="position:absolute;left:239.95px;top:652.67px" class="cls_006"><span class="cls_006">slots are fine grain and tied to specific machine instructions; and this</span></div>
<div style="position:absolute;left:239.95px;top:663.67px" class="cls_006"><span class="cls_006">can only be done late in the compilation process.</span></div>
<div style="position:absolute;left:239.95px;top:677.67px" class="cls_006"><span class="cls_006">The most obvious techniques are:</span></div>
<div style="position:absolute;left:239.95px;top:691.67px" class="cls_006"><span class="cls_006">a) If the instruction succeeding a load doesn’t depend on the loaded</span></div>
<div style="position:absolute;left:251.97px;top:702.67px" class="cls_006"><span class="cls_006">value, just leave out the nop which would have been placed in the</span></div>
<div style="position:absolute;left:251.97px;top:713.67px" class="cls_006"><span class="cls_006">delay slot.</span></div>
<div style="position:absolute;left:301.30px;top:755.34px" class="cls_002"><span class="cls_002">10-13</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:123508px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 10</span></div>
<div style="position:absolute;left:479.82px;top:28.00px" class="cls_002"><span class="cls_002">C PROGRAMMING</span></div>
<div style="position:absolute;left:59.98px;top:50.67px" class="cls_006"><span class="cls_006">b) Move the logically-preceding instruction into the delay slot. The</span></div>
<div style="position:absolute;left:72.00px;top:61.67px" class="cls_006"><span class="cls_006">optimizer may be able to find an instruction a few positions</span></div>
<div style="position:absolute;left:72.00px;top:72.67px" class="cls_006"><span class="cls_006">preceding the branch or load, provided there are no intervening</span></div>
<div style="position:absolute;left:72.00px;top:83.67px" class="cls_006"><span class="cls_006">entry points.</span></div>
<div style="position:absolute;left:72.00px;top:97.67px" class="cls_006"><span class="cls_006">The register-register architecture makes it fairly simple to pick out</span></div>
<div style="position:absolute;left:72.00px;top:108.67px" class="cls_006"><span class="cls_006">instructions  which  depend  on  each  other  and  cannot  be  re-</span></div>
<div style="position:absolute;left:72.00px;top:119.67px" class="cls_006"><span class="cls_006">sequenced.</span></div>
<div style="position:absolute;left:59.98px;top:133.67px" class="cls_006"><span class="cls_006">c) For a load, the optimizer may be able to find an instruction in the</span></div>
<div style="position:absolute;left:72.00px;top:144.67px" class="cls_006"><span class="cls_006">code after the load which is independent of the load value and is</span></div>
<div style="position:absolute;left:72.00px;top:155.67px" class="cls_006"><span class="cls_006">able to be moved into the delay slot.</span></div>
<div style="position:absolute;left:59.98px;top:169.67px" class="cls_006"><span class="cls_006">d) Moving the instruction just before a branch into the branch delay</span></div>
<div style="position:absolute;left:72.00px;top:180.67px" class="cls_006"><span class="cls_006">slot.</span></div>
<div style="position:absolute;left:59.98px;top:194.67px" class="cls_006"><span class="cls_006">e) Duplicating the instruction at a branch target into the branch delay</span></div>
<div style="position:absolute;left:72.00px;top:205.67px" class="cls_006"><span class="cls_006">slot, and fixing up the branch to go one more instruction forward.</span></div>
<div style="position:absolute;left:72.00px;top:219.67px" class="cls_006"><span class="cls_006">This is particularly effective with loop-closing instructions. If the</span></div>
<div style="position:absolute;left:72.00px;top:230.67px" class="cls_006"><span class="cls_006">branch is conditional, though, the compiler can only do it if the</span></div>
<div style="position:absolute;left:72.00px;top:241.67px" class="cls_006"><span class="cls_006">inserted instruction can be seen to be harmless when the branch</span></div>
<div style="position:absolute;left:72.00px;top:252.67px" class="cls_006"><span class="cls_006">is not taken.</span></div>
<div style="position:absolute;left:36.00px;top:275.00px" class="cls_015"><span class="cls_015">How to prevent unwanted effects from optimization</span></div>
<div style="position:absolute;left:48.02px;top:288.67px" class="cls_006"><span class="cls_006">Some  code  may  rely  on  system  effects  invisible  to  the  compiler.</span></div>
<div style="position:absolute;left:36.00px;top:299.67px" class="cls_006"><span class="cls_006">Examples include software intended to poll the status register of a serial</span></div>
<div style="position:absolute;left:36.00px;top:310.67px" class="cls_006"><span class="cls_006">port and send a character when it’s ready:</span></div>
<div style="position:absolute;left:72.00px;top:332.00px" class="cls_028"><span class="cls_028">unsigned char *usart_sr = (unsigned char *) 0xBFF00000;</span></div>
<div style="position:absolute;left:72.00px;top:342.00px" class="cls_028"><span class="cls_028">unsigned char *usart_data = (unsigned char *) 0xBFF20000;</span></div>
<div style="position:absolute;left:72.00px;top:352.00px" class="cls_028"><span class="cls_028">#defined TX_RDY 0x40</span></div>
<div style="position:absolute;left:72.00px;top:372.00px" class="cls_028"><span class="cls_028">void putc (ch)</span></div>
<div style="position:absolute;left:72.00px;top:381.99px" class="cls_028"><span class="cls_028">char ch;</span></div>
<div style="position:absolute;left:72.00px;top:391.99px" class="cls_028"><span class="cls_028">{</span></div>
<div style="position:absolute;left:77.40px;top:401.99px" class="cls_028"><span class="cls_028">while ((*usart_sr & TX_RDY) == 0)</span></div>
<div style="position:absolute;left:108.00px;top:411.99px" class="cls_028"><span class="cls_028">;</span></div>
<div style="position:absolute;left:77.40px;top:431.99px" class="cls_028"><span class="cls_028">*usart_data = ch;</span></div>
<div style="position:absolute;left:72.00px;top:441.99px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:48.02px;top:461.67px" class="cls_006"><span class="cls_006">A compiler, left to optimize this as for any other program, may send 2</span></div>
<div style="position:absolute;left:36.00px;top:472.67px" class="cls_006"><span class="cls_006">characters and then enter an infinite loop. The compiler sees the memory</span></div>
<div style="position:absolute;left:36.00px;top:483.67px" class="cls_006"><span class="cls_006">reference implied by </span><span class="cls_029">*usart_sr</span><span class="cls_006"> as a loop-invariant fetch; there are no</span></div>
<div style="position:absolute;left:36.00px;top:494.67px" class="cls_006"><span class="cls_006">stores in the ‘‘while’’ loop so this seems a safe optimization. The compiler</span></div>
<div style="position:absolute;left:36.00px;top:505.67px" class="cls_006"><span class="cls_006">has actually coded for:</span></div>
<div style="position:absolute;left:72.00px;top:527.00px" class="cls_028"><span class="cls_028">void putc (ch)</span></div>
<div style="position:absolute;left:72.00px;top:537.00px" class="cls_028"><span class="cls_028">char ch;</span></div>
<div style="position:absolute;left:72.00px;top:547.00px" class="cls_028"><span class="cls_028">{</span></div>
<div style="position:absolute;left:77.40px;top:557.00px" class="cls_028"><span class="cls_028">tmp = (*usart_sr & TX_RDY);</span></div>
<div style="position:absolute;left:77.40px;top:576.99px" class="cls_028"><span class="cls_028">while (tmp)</span></div>
<div style="position:absolute;left:108.00px;top:586.99px" class="cls_028"><span class="cls_028">;</span></div>
<div style="position:absolute;left:77.40px;top:606.99px" class="cls_028"><span class="cls_028">*usart_data = ch;</span></div>
<div style="position:absolute;left:72.00px;top:616.99px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:48.02px;top:636.67px" class="cls_006"><span class="cls_006">With most compilers, this particular problem is prevented by defining</span></div>
<div style="position:absolute;left:36.00px;top:647.67px" class="cls_006"><span class="cls_006">registers carefully:</span></div>
<div style="position:absolute;left:72.00px;top:669.00px" class="cls_028"><span class="cls_028">volatile unsigned char</span></div>
<div style="position:absolute;left:108.00px;top:679.00px" class="cls_028"><span class="cls_028">*usart_sr = (unsigned char *) 0xBFF00000;</span></div>
<div style="position:absolute;left:72.00px;top:689.00px" class="cls_028"><span class="cls_028">volatile unsigned char</span></div>
<div style="position:absolute;left:108.00px;top:699.00px" class="cls_028"><span class="cls_028">*usart_data = (unsigned char *) 0xBFF20000;</span></div>
<div style="position:absolute;left:287.55px;top:755.34px" class="cls_002"><span class="cls_002">10-14</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:124310px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">C PROGRAMMING</span></div>
<div style="position:absolute;left:520.30px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 10</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">A similar situation can exist if software must examine a variable that is</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">modified by an interrupt or other exception handler. Again, declaring the</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_006"><span class="cls_006">variable as ‘‘volatile’’ should fix the problem.</span></div>
<div style="position:absolute;left:228.02px;top:83.67px" class="cls_006"><span class="cls_006">Although   the   C   rules   describe   the   operation   of</span></div>
<div style="position:absolute;left:511.66px;top:83.67px" class="cls_006"><span class="cls_006">‘‘volatile’’   as</span></div>
<div style="position:absolute;left:216.00px;top:94.67px" class="cls_006"><span class="cls_006">implementation dependent, most compilers which ignore the ‘‘volatile’’</span></div>
<div style="position:absolute;left:216.00px;top:105.67px" class="cls_006"><span class="cls_006">keyword are expected to play safe.</span></div>
<div style="position:absolute;left:228.02px;top:116.67px" class="cls_006"><span class="cls_006">There are other, more subtle, ways in which optimizations can break a</span></div>
<div style="position:absolute;left:216.00px;top:127.67px" class="cls_006"><span class="cls_006">program. For example, it may change the order in which some loads and</span></div>
<div style="position:absolute;left:216.00px;top:138.67px" class="cls_006"><span class="cls_006">stores occur. It may be easier to write and maintain hardware driver code</span></div>
<div style="position:absolute;left:216.00px;top:149.67px" class="cls_006"><span class="cls_006">in C than in assembler, but it’s the programmer’s responsibility to know</span></div>
<div style="position:absolute;left:216.00px;top:160.67px" class="cls_006"><span class="cls_006">exactly what the compiler did, and to make sure it’s what was wanted.</span></div>
<div style="position:absolute;left:216.00px;top:183.00px" class="cls_015"><span class="cls_015">Optimizer-unfriendly code and how to avoid it</span></div>
<div style="position:absolute;left:228.02px;top:196.67px" class="cls_006"><span class="cls_006">Certain kinds of C programs will cause problems for a MIPS CPU and its</span></div>
<div style="position:absolute;left:216.00px;top:207.67px" class="cls_006"><span class="cls_006">optimizing compiler, and will cause unnecessary loss of performance.</span></div>
<div style="position:absolute;left:216.00px;top:218.67px" class="cls_006"><span class="cls_006">Some things to avoid are:</span></div>
<div style="position:absolute;left:228.02px;top:232.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Sub-word arithmetic</span><span class="cls_006"> : use of </span><span class="cls_029">short</span><span class="cls_006"> or </span><span class="cls_029">char</span><span class="cls_006"> variables in arithmetic</span></div>
<div style="position:absolute;left:239.98px;top:243.67px" class="cls_006"><span class="cls_006">operations is less efficient than using full word arithmetic. The MIPS</span></div>
<div style="position:absolute;left:239.98px;top:254.67px" class="cls_006"><span class="cls_006">CPU lacks sub-word arithmetic functions and will have to do extra</span></div>
<div style="position:absolute;left:239.98px;top:265.67px" class="cls_006"><span class="cls_006">work to make sure that expressions overflow and wrap around when</span></div>
<div style="position:absolute;left:239.98px;top:276.67px" class="cls_006"><span class="cls_006">they should. The </span><span class="cls_029">int</span><span class="cls_006"> data type represents the optimum arithmetic</span></div>
<div style="position:absolute;left:239.98px;top:287.67px" class="cls_006"><span class="cls_006">type for the R30xx family; most of the time </span><span class="cls_029">short</span><span class="cls_006"> and </span><span class="cls_029">char</span><span class="cls_006"> values can</span></div>
<div style="position:absolute;left:239.98px;top:298.67px" class="cls_006"><span class="cls_006">be correctly manipulated by </span><span class="cls_029">int</span><span class="cls_006"> automatic variables.</span></div>
<div style="position:absolute;left:228.03px;top:312.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Taking the address of a local variable</span><span class="cls_006">: the compiler will now have to</span></div>
<div style="position:absolute;left:239.98px;top:323.67px" class="cls_006"><span class="cls_006">consider the possibility that any function call or write through a</span></div>
<div style="position:absolute;left:239.98px;top:334.67px" class="cls_006"><span class="cls_006">pointer might have changed the variable’s value; so it won’t live long</span></div>
<div style="position:absolute;left:239.98px;top:345.67px" class="cls_006"><span class="cls_006">in a machine register.</span></div>
<div style="position:absolute;left:239.98px;top:359.67px" class="cls_006"><span class="cls_006">Perhaps the best way of seeing this is that defining a variable local to</span></div>
<div style="position:absolute;left:239.98px;top:370.67px" class="cls_006"><span class="cls_006">a function (and whose address is not taken) is essentially free. It will</span></div>
<div style="position:absolute;left:239.98px;top:381.67px" class="cls_006"><span class="cls_006">be assigned to a register, which would have been needed in any case</span></div>
<div style="position:absolute;left:239.98px;top:392.67px" class="cls_006"><span class="cls_006">for the intermediate result.</span></div>
<div style="position:absolute;left:228.03px;top:406.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Nested Function calls</span><span class="cls_006">: in the MIPS architecture the direct overhead of</span></div>
<div style="position:absolute;left:239.98px;top:417.67px" class="cls_006"><span class="cls_006">a function call is very small (2-3 clocks). But the function call makes</span></div>
<div style="position:absolute;left:239.98px;top:428.67px" class="cls_006"><span class="cls_006">it difficult for the compiler to make good use of registers, so may be</span></div>
<div style="position:absolute;left:239.98px;top:439.67px" class="cls_006"><span class="cls_006">much more costly in terms of lost optimization opportunity. Inside a</span></div>
<div style="position:absolute;left:239.98px;top:450.67px" class="cls_006"><span class="cls_006">function with a fairly complex set of local variables a nested call could</span></div>
<div style="position:absolute;left:239.98px;top:461.67px" class="cls_006"><span class="cls_006">be as slow as a typical CISC function call, and add a lot of code.</span></div>
<div style="position:absolute;left:301.30px;top:755.34px" class="cls_002"><span class="cls_002">10-15</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:125112px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">PORTABILITY</span></div>
<div style="position:absolute;left:459.00px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 11</span></div>
<div style="position:absolute;left:222.89px;top:56.33px" class="cls_005"><span class="cls_005">CONSIDERATIONS</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:228.02px;top:124.67px" class="cls_006"><span class="cls_006">This  chapter  discusses  three  distinct  facets  of  portability  to  be</span></div>
<div style="position:absolute;left:216.00px;top:135.67px" class="cls_006"><span class="cls_006">concerned about:</span></div>
<div style="position:absolute;left:228.02px;top:149.67px" class="cls_006"><span class="cls_006">• Migrating existing software from another CPU architecture to the</span></div>
<div style="position:absolute;left:239.97px;top:160.67px" class="cls_006"><span class="cls_006">R30xx family.</span></div>
<div style="position:absolute;left:228.02px;top:174.67px" class="cls_006"><span class="cls_006">• Writing code that can readily be used on multiple R30xx family</span></div>
<div style="position:absolute;left:239.97px;top:185.67px" class="cls_006"><span class="cls_006">members.</span></div>
<div style="position:absolute;left:228.02px;top:199.67px" class="cls_006"><span class="cls_006">• Writing code that will be easily portable to future family members.</span></div>
<div style="position:absolute;left:228.02px;top:221.67px" class="cls_006"><span class="cls_006">Techniques such as modular programming can be used to facilitate</span></div>
<div style="position:absolute;left:216.00px;top:232.67px" class="cls_006"><span class="cls_006">virtually all of these areas, but are beyond the scope of this manual.</span></div>
<div style="position:absolute;left:216.00px;top:243.67px" class="cls_006"><span class="cls_006">Instead, this manual will focus in on the architecture-specific portability</span></div>
<div style="position:absolute;left:216.00px;top:254.67px" class="cls_006"><span class="cls_006">issues.</span></div>
<div style="position:absolute;left:228.02px;top:265.67px" class="cls_006"><span class="cls_006">Since most modern embedded programming uses the “C” programming</span></div>
<div style="position:absolute;left:216.00px;top:276.67px" class="cls_006"><span class="cls_006">language, this chapter will begin with a review of the portability concerns</span></div>
<div style="position:absolute;left:216.00px;top:287.67px" class="cls_006"><span class="cls_006">associated with this programming language.</span></div>
<div style="position:absolute;left:228.02px;top:298.67px" class="cls_006"><span class="cls_006">Additionally, this chapter will review some of the historical obstacles to</span></div>
<div style="position:absolute;left:216.00px;top:309.67px" class="cls_006"><span class="cls_006">program portability: byte ordering conventions, word sizes, alignment</span></div>
<div style="position:absolute;left:216.00px;top:320.67px" class="cls_006"><span class="cls_006">constraints, and so on; and will discuss the manner in which the MIPS</span></div>
<div style="position:absolute;left:216.00px;top:331.67px" class="cls_006"><span class="cls_006">architecture deals with these issues. This review is intended to discuss the</span></div>
<div style="position:absolute;left:216.00px;top:342.67px" class="cls_006"><span class="cls_006">issues which complicate porting existing code, developed for execution on</span></div>
<div style="position:absolute;left:216.00px;top:353.67px" class="cls_006"><span class="cls_006">other architectures, to the R30xx family.</span></div>
<div style="position:absolute;left:228.02px;top:364.67px" class="cls_006"><span class="cls_006">Finally, this chapter will discuss generating an environment to support</span></div>
<div style="position:absolute;left:216.00px;top:375.67px" class="cls_006"><span class="cls_006">multiple family members, both existing and possible future members, to</span></div>
<div style="position:absolute;left:216.00px;top:386.67px" class="cls_006"><span class="cls_006">enable the investment in porting to be applied to a wide variety of system</span></div>
<div style="position:absolute;left:216.00px;top:397.67px" class="cls_006"><span class="cls_006">cost-performance points.</span></div>
<div style="position:absolute;left:216.00px;top:420.00px" class="cls_015"><span class="cls_015">WRITING PORTABLE C</span></div>
<div style="position:absolute;left:228.02px;top:433.67px" class="cls_006"><span class="cls_006">‘‘C’’ is one of a class of languages which originally aimed to abstract the</span></div>
<div style="position:absolute;left:216.00px;top:444.67px" class="cls_006"><span class="cls_006">abilities of a class of simple minicomputers, to add some terse and</span></div>
<div style="position:absolute;left:216.00px;top:455.67px" class="cls_006"><span class="cls_006">powerful syntax for flow of control, and to provide simple but adequate</span></div>
<div style="position:absolute;left:216.00px;top:466.67px" class="cls_006"><span class="cls_006">mechanisms for data structuring.</span></div>
<div style="position:absolute;left:228.02px;top:477.67px" class="cls_006"><span class="cls_006">A language standard such as Pascal or Ada sets out to make portability</span></div>
<div style="position:absolute;left:216.00px;top:488.67px" class="cls_006"><span class="cls_006">compulsory; the language attempts to make it impossible for program</span></div>
<div style="position:absolute;left:216.00px;top:499.67px" class="cls_006"><span class="cls_006">behavior to be dependent on what kind of CPU is being used. C lets the</span></div>
<div style="position:absolute;left:216.00px;top:510.67px" class="cls_006"><span class="cls_006">underlying implementation show through; it is possible to write portable C</span></div>
<div style="position:absolute;left:216.00px;top:521.67px" class="cls_006"><span class="cls_006">by programming discipline, but it doesn’t happen automatically.</span></div>
<div style="position:absolute;left:228.02px;top:532.67px" class="cls_006"><span class="cls_006">C’s low-level origins contribute to its power and efficiency, but make it</span></div>
<div style="position:absolute;left:216.00px;top:543.67px" class="cls_006"><span class="cls_006">inherently prone to non-portability. Good examples are the following:</span></div>
<div style="position:absolute;left:228.02px;top:557.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Basic data types</span><span class="cls_006">: change in their size (i.e. the number of bits of</span></div>
<div style="position:absolute;left:239.98px;top:568.67px" class="cls_006"><span class="cls_006">precision) between different implementations.</span></div>
<div style="position:absolute;left:228.02px;top:582.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Pointers</span><span class="cls_006">: (inevitably implemented as real machine pointers) expose</span></div>
<div style="position:absolute;left:239.98px;top:593.67px" class="cls_006"><span class="cls_006">the memory layout of data, which is implementation-dependent.</span></div>
<div style="position:absolute;left:228.03px;top:604.67px" class="cls_006"><span class="cls_006">Some things have got easier with time; early C implementations had to</span></div>
<div style="position:absolute;left:216.01px;top:615.67px" class="cls_006"><span class="cls_006">target machines with 7-, 8- and 9-bit </span><span class="cls_008">char</span><span class="cls_006"> types, and with 36-bit machine</span></div>
<div style="position:absolute;left:216.00px;top:626.67px" class="cls_006"><span class="cls_006">words. It is now entirely reasonable to assume that targets will have an 8-</span></div>
<div style="position:absolute;left:216.00px;top:637.67px" class="cls_006"><span class="cls_006">bit </span><span class="cls_008">char</span><span class="cls_006"> which is the smallest addressable unit of memory, and other basic</span></div>
<div style="position:absolute;left:216.00px;top:648.67px" class="cls_006"><span class="cls_006">types will be 16-, 32- or 64-bits in size.</span></div>
<div style="position:absolute;left:216.00px;top:669.67px" class="cls_006"><span class="cls_006">C Language Standards</span></div>
<div style="position:absolute;left:228.02px;top:680.67px" class="cls_006"><span class="cls_006">C has evolved continuously since its early days. It has definitely gone</span></div>
<div style="position:absolute;left:216.00px;top:691.67px" class="cls_006"><span class="cls_006">up-level; most changes have tended to increase the amount of abstraction</span></div>
<div style="position:absolute;left:216.00px;top:702.67px" class="cls_006"><span class="cls_006">and checking. To date, there are three main “variants”, or standards, for</span></div>
<div style="position:absolute;left:216.00px;top:713.67px" class="cls_006"><span class="cls_006">the C language.</span></div>
<div style="position:absolute;left:297.04px;top:754.68px" class="cls_002"><span class="cls_002">11-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:125914px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 11</span></div>
<div style="position:absolute;left:414.55px;top:28.00px" class="cls_002"><span class="cls_002">PORTABILITY CONSIDERATIONS</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> K&R</span><span class="cls_006">: named after the C Programming Manual by Kernighan and</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">Richie, this reflects the standard used for the first few years of Unix</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">life. It has little type-checking, many defaults, and the compilers</span></div>
<div style="position:absolute;left:59.98px;top:83.67px" class="cls_006"><span class="cls_006">rarely complain. However, it provides a useful </span><span class="cls_008">lingua franca</span><span class="cls_006">: most</span></div>
<div style="position:absolute;left:59.98px;top:94.67px" class="cls_006"><span class="cls_006">compilers will (sometimes unwillingly and with warnings) correctly</span></div>
<div style="position:absolute;left:59.98px;top:105.67px" class="cls_006"><span class="cls_006">translate programs written to K&R.</span></div>
<div style="position:absolute;left:59.98px;top:119.67px" class="cls_006"><span class="cls_006">In practice the language was, during this period, defined by a single</span></div>
<div style="position:absolute;left:59.98px;top:130.67px" class="cls_006"><span class="cls_006">implementation: AT&T Bell Lab’s Portable C compiler.</span></div>
<div style="position:absolute;left:48.03px;top:144.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> ANSI</span><span class="cls_006">: the ANSI standard collects together ‘‘improvements’’ made over</span></div>
<div style="position:absolute;left:59.98px;top:155.67px" class="cls_006"><span class="cls_006">the years and regulates them. ANSI defines syntax allowing the</span></div>
<div style="position:absolute;left:59.98px;top:166.67px" class="cls_006"><span class="cls_006">programmer to make far more well-defined declarations of functions,</span></div>
<div style="position:absolute;left:59.98px;top:177.67px" class="cls_006"><span class="cls_006">and then checks programmer usage against them. ANSI compilers</span></div>
<div style="position:absolute;left:59.98px;top:188.67px" class="cls_006"><span class="cls_006">tend  to  produce  more  warning  messages  than  K&R  compilers,</span></div>
<div style="position:absolute;left:59.98px;top:199.67px" class="cls_006"><span class="cls_006">reflecting the greater amounts of type-checking performed.</span></div>
<div style="position:absolute;left:59.98px;top:213.67px" class="cls_006"><span class="cls_006">A number of compilers use “compliance test suites” to “guarantee”</span></div>
<div style="position:absolute;left:59.98px;top:224.67px" class="cls_006"><span class="cls_006">ANSI compliance. A common test suite is the “Plum-Hall” test suite,</span></div>
<div style="position:absolute;left:59.98px;top:235.67px" class="cls_006"><span class="cls_006">which  includes  modules  to  test  a  compiler</span></div>
<div style="position:absolute;left:303.26px;top:235.67px" class="cls_006"><span class="cls_006">(and  its  libraries)</span></div>
<div style="position:absolute;left:59.98px;top:246.67px" class="cls_006"><span class="cls_006">compliance  to  the  ANSI  rules.  The  IDT/C  compiler  uses  this</span></div>
<div style="position:absolute;left:59.98px;top:257.67px" class="cls_006"><span class="cls_006">compliance suite to validate its ANSI compliance.</span></div>
<div style="position:absolute;left:48.03px;top:271.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> GNU</span><span class="cls_006">: the Free Software Foundation’s GNU compiler is set to restore</span></div>
<div style="position:absolute;left:59.98px;top:282.67px" class="cls_006"><span class="cls_006">the dominance of a single implementation of the compiler, and thus</span></div>
<div style="position:absolute;left:59.98px;top:293.67px" class="cls_006"><span class="cls_006">permit the emergence of a new dialect†. Note that the GNU compiler</span></div>
<div style="position:absolute;left:59.98px;top:304.67px" class="cls_006"><span class="cls_006">does support ANSI compliance; it is just that, as an “experimental”</span></div>
<div style="position:absolute;left:59.98px;top:315.67px" class="cls_006"><span class="cls_006">toolchain, it may also support more “cutting edge” extensions to ANSI</span></div>
<div style="position:absolute;left:59.98px;top:326.67px" class="cls_006"><span class="cls_006">than are currently supported by the standards body.</span></div>
<div style="position:absolute;left:59.98px;top:340.67px" class="cls_006"><span class="cls_006">GNU also adds a number of very valuable features; including function</span></div>
<div style="position:absolute;left:59.98px;top:351.67px" class="cls_006"><span class="cls_006">inlining, a robust ‘‘asm’’ statement, </span><span class="cls_008">alloca()</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:48.02px;top:362.67px" class="cls_006"><span class="cls_006">GNU provides the benefit of being available across multiple hosts and</span></div>
<div style="position:absolute;left:36.00px;top:373.67px" class="cls_006"><span class="cls_006">target architectures. Thus, porting applications developed using the GNU</span></div>
<div style="position:absolute;left:36.00px;top:384.67px" class="cls_006"><span class="cls_006">toolchain from some other architecture to the R30xx will avoid the porting</span></div>
<div style="position:absolute;left:36.00px;top:395.67px" class="cls_006"><span class="cls_006">problems associated with compiler PRAGMAs, compiler directives, and the</span></div>
<div style="position:absolute;left:36.00px;top:406.67px" class="cls_006"><span class="cls_006">like.</span></div>
<div style="position:absolute;left:48.02px;top:417.67px" class="cls_006"><span class="cls_006">Similarly, porting ANSI compliant code from a different architecture</span></div>
<div style="position:absolute;left:36.00px;top:428.67px" class="cls_006"><span class="cls_006">should be relatively straight-forward. However, differences in supported</span></div>
<div style="position:absolute;left:36.00px;top:439.67px" class="cls_006"><span class="cls_006">PRAGMAs, and other environmental differences, may cause a higher level</span></div>
<div style="position:absolute;left:36.00px;top:450.67px" class="cls_006"><span class="cls_006">of porting activity.</span></div>
<div style="position:absolute;left:36.00px;top:471.67px" class="cls_006"><span class="cls_006">C Library Functions and POSIX</span></div>
<div style="position:absolute;left:48.02px;top:482.67px" class="cls_006"><span class="cls_006">C supports separate compilation of modules, allowing the resulting</span></div>
<div style="position:absolute;left:36.00px;top:493.67px" class="cls_006"><span class="cls_006">object code files to be linked together without recourse to the source. C</span></div>
<div style="position:absolute;left:36.00px;top:504.67px" class="cls_006"><span class="cls_006">libraries  are  bunches  of  pre-compiled  object  code  defining  common</span></div>
<div style="position:absolute;left:36.00px;top:515.67px" class="cls_006"><span class="cls_006">functions. The ‘‘standard’’ C library of everyday functions is to all intents</span></div>
<div style="position:absolute;left:36.00px;top:526.67px" class="cls_006"><span class="cls_006">and purposes part of the language.</span></div>
<div style="position:absolute;left:48.02px;top:537.67px" class="cls_006"><span class="cls_006">The ANSI standard addresses a subset of common library functions and</span></div>
<div style="position:absolute;left:36.00px;top:548.67px" class="cls_006"><span class="cls_006">lays  down  their  function.  But  this  deliberately  steers  clear  of</span></div>
<div style="position:absolute;left:373.10px;top:548.67px" class="cls_006"><span class="cls_006">‘‘OS-</span></div>
<div style="position:absolute;left:36.00px;top:559.67px" class="cls_006"><span class="cls_006">dependent’’  functions;  and  these  include  the  simplest  input/output</span></div>
<div style="position:absolute;left:36.00px;top:570.67px" class="cls_006"><span class="cls_006">routines.</span></div>
<div style="position:absolute;left:48.02px;top:581.67px" class="cls_006"><span class="cls_006">The POSIX (IEEE1003.4) standard is probably the best candidate,</span></div>
<div style="position:absolute;left:36.00px;top:592.67px" class="cls_006"><span class="cls_006">defining a standard C language interface to a workable IO system. POSIX</span></div>
<div style="position:absolute;left:36.00px;top:603.67px" class="cls_006"><span class="cls_006">has its problems:</span></div>
<div style="position:absolute;left:48.02px;top:617.67px" class="cls_006"><span class="cls_006">• it does not yet cover all OS features (and probably shouldn’t);</span></div>
<div style="position:absolute;left:54.00px;top:674.67px" class="cls_006"><span class="cls_006">† GNU C is also an extraordinary experiment; a major piece of</span></div>
<div style="position:absolute;left:54.00px;top:686.67px" class="cls_006"><span class="cls_006">ingenuity and intellectual work being maintained and continually</span></div>
<div style="position:absolute;left:54.00px;top:698.67px" class="cls_006"><span class="cls_006">developed by a large, loose-knit, worldwide community of workers,</span></div>
<div style="position:absolute;left:54.00px;top:710.67px" class="cls_006"><span class="cls_006">many of them volunteers. No other piece of free software has</span></div>
<div style="position:absolute;left:54.00px;top:722.67px" class="cls_006"><span class="cls_006">filtered quite so far into the body of the computer industry.</span></div>
<div style="position:absolute;left:289.79px;top:755.33px" class="cls_002"><span class="cls_002">11-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:126716px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">PORTABILITY CONSIDERATIONS</span></div>
<div style="position:absolute;left:520.56px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 11</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">• its definers occasionally felt obliged to standardize an ‘‘improvement’’</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">of current practice, so POSIX compliance is still hard to find even in</span></div>
<div style="position:absolute;left:239.97px;top:72.67px" class="cls_006"><span class="cls_006">big OS’es.</span></div>
<div style="position:absolute;left:228.02px;top:83.67px" class="cls_006"><span class="cls_006">But it is a huge improvement on earlier single-camp standards and will</span></div>
<div style="position:absolute;left:216.00px;top:94.67px" class="cls_006"><span class="cls_006">undoubtedly become important. Programs adhering to POSIX should be</span></div>
<div style="position:absolute;left:216.00px;top:105.67px" class="cls_006"><span class="cls_006">able to be rebuilt on a large range of OS, including Desktop OS’es (such as</span></div>
<div style="position:absolute;left:216.00px;top:116.67px" class="cls_006"><span class="cls_006">UNIX) and RTOS environments. Using POSIX compliant library functions</span></div>
<div style="position:absolute;left:216.00px;top:127.67px" class="cls_006"><span class="cls_006">will further enhance portability across toolchains and architectures.</span></div>
<div style="position:absolute;left:216.00px;top:150.00px" class="cls_015"><span class="cls_015">DATA REPRESENTATIONS AND ALIGNMENT</span></div>
<div style="position:absolute;left:228.02px;top:163.67px" class="cls_006"><span class="cls_006">The  MIPS  architecture  can  only  load  multi-byte  data  which  is</span></div>
<div style="position:absolute;left:216.00px;top:174.67px" class="cls_006"><span class="cls_006">‘‘naturally’’ aligned - a 4-byte quantity only from a 4-byte boundary, etc.</span></div>
<div style="position:absolute;left:216.00px;top:185.67px" class="cls_006"><span class="cls_006">Many CISC architectures don’t have this restriction (although many RISC</span></div>
<div style="position:absolute;left:216.00px;top:196.67px" class="cls_006"><span class="cls_006">architectures do follow this restriction, and in fact may offer less support</span></div>
<div style="position:absolute;left:216.00px;top:207.67px" class="cls_006"><span class="cls_006">than the MIPS machine code does for this situation). The compiler is</span></div>
<div style="position:absolute;left:216.00px;top:218.67px" class="cls_006"><span class="cls_006">designed to ensure that data lands up in the right place; and this requires</span></div>
<div style="position:absolute;left:216.00px;top:229.67px" class="cls_006"><span class="cls_006">far-reaching (and not always obvious) behaviors. These include:</span></div>
<div style="position:absolute;left:228.02px;top:243.67px" class="cls_006"><span class="cls_006">• Padding between fields of data structures.</span></div>
<div style="position:absolute;left:228.02px;top:257.67px" class="cls_006"><span class="cls_006">• Defensive alignment; base addresses of structures, or stack frames,</span></div>
<div style="position:absolute;left:239.97px;top:268.67px" class="cls_006"><span class="cls_006">are aligned to the largest unit to which the architecture is sensitive (4</span></div>
<div style="position:absolute;left:239.97px;top:279.67px" class="cls_006"><span class="cls_006">or 8 bytes in the MIPS architecture).</span></div>
<div style="position:absolute;left:228.02px;top:290.67px" class="cls_006"><span class="cls_006">The toolchain used for previous development, targeted to a different CPU</span></div>
<div style="position:absolute;left:216.00px;top:301.67px" class="cls_006"><span class="cls_006">architecture, may do this differently.</span></div>
<div style="position:absolute;left:228.02px;top:312.67px" class="cls_006"><span class="cls_006">Consider the following examples:</span></div>
<div style="position:absolute;left:252.00px;top:334.00px" class="cls_028"><span class="cls_028">struct foo {</span></div>
<div style="position:absolute;left:288.00px;top:344.00px" class="cls_028"><span class="cls_028">char small;</span></div>
<div style="position:absolute;left:288.00px;top:354.00px" class="cls_028"><span class="cls_028">short medium;</span></div>
<div style="position:absolute;left:288.00px;top:363.99px" class="cls_028"><span class="cls_028">char again;</span></div>
<div style="position:absolute;left:288.00px;top:373.99px" class="cls_028"><span class="cls_028">int big;</span></div>
<div style="position:absolute;left:252.00px;top:383.99px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:228.02px;top:403.67px" class="cls_006"><span class="cls_006">This will be laid out in memory as shown in Figure 11.1, “Structure</span></div>
<div style="position:absolute;left:216.00px;top:414.67px" class="cls_006"><span class="cls_006">layout and padding in memory”:</span></div>
<div style="position:absolute;left:238.10px;top:435.00px" class="cls_020"><span class="cls_020">offset (bytes)</span></div>
<div style="position:absolute;left:314.87px;top:435.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:349.51px;top:435.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:370.67px;top:435.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:400.01px;top:435.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:417.57px;top:435.00px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:452.39px;top:435.00px" class="cls_020"><span class="cls_020">5</span></div>
<div style="position:absolute;left:468.88px;top:435.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:485.36px;top:435.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:518.35px;top:435.00px" class="cls_020"><span class="cls_020">11</span></div>
<div style="position:absolute;left:314.62px;top:452.00px" class="cls_020"><span class="cls_020">small</span></div>
<div style="position:absolute;left:349.22px;top:452.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:370.36px;top:452.00px" class="cls_020"><span class="cls_020">medium</span></div>
<div style="position:absolute;left:417.35px;top:452.00px" class="cls_020"><span class="cls_020">again</span></div>
<div style="position:absolute;left:451.95px;top:452.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:484.86px;top:452.00px" class="cls_020"><span class="cls_020">big</span></div>
<div style="position:absolute;left:267.74px;top:471.00px" class="cls_020"><span class="cls_020">Figure 11.1.   Structure layout and padding in memory</span></div>
<div style="position:absolute;left:216.00px;top:492.00px" class="cls_015"><span class="cls_015">Notes on structure layout and padding</span></div>
<div style="position:absolute;left:228.02px;top:505.67px" class="cls_006"><span class="cls_006">These notes should be taken as typical of what a good compiler will do.</span></div>
<div style="position:absolute;left:216.00px;top:516.67px" class="cls_006"><span class="cls_006">They are required by, for example, a MIPS/ABI compliant compiler; but</span></div>
<div style="position:absolute;left:216.00px;top:527.67px" class="cls_006"><span class="cls_006">beware - a compiler </span><span class="cls_008">could</span><span class="cls_006"> still be fully compliant with C standards and use</span></div>
<div style="position:absolute;left:216.00px;top:538.67px" class="cls_006"><span class="cls_006">wholly counterintuitive data representations</span></div>
<div style="position:absolute;left:448.48px;top:538.67px" class="cls_006"><span class="cls_006">- so long as these were</span></div>
<div style="position:absolute;left:216.00px;top:549.67px" class="cls_006"><span class="cls_006">internally consistent.</span></div>
<div style="position:absolute;left:228.02px;top:563.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Alignment of structure base address</span><span class="cls_006">: the data structure itself will</span></div>
<div style="position:absolute;left:239.98px;top:574.67px" class="cls_006"><span class="cls_006">always be placed on a 4-byte boundary; a structure’s alignment is</span></div>
<div style="position:absolute;left:239.98px;top:585.67px" class="cls_006"><span class="cls_006">that of its most demanding subfield. </span><span class="cls_029">struct foo</span><span class="cls_006"> contains an </span><span class="cls_029">int</span></div>
<div style="position:absolute;left:239.98px;top:596.67px" class="cls_006"><span class="cls_006">requiring 4-byte alignment, so the structure itself will be 4-byte</span></div>
<div style="position:absolute;left:239.98px;top:607.67px" class="cls_006"><span class="cls_006">aligned.</span></div>
<div style="position:absolute;left:239.98px;top:621.67px" class="cls_006"><span class="cls_006">Dynamic memory allocation, either on the stack or by software</span></div>
<div style="position:absolute;left:239.98px;top:632.67px" class="cls_006"><span class="cls_006">routines such as </span><span class="cls_008">malloc</span><span class="cls_006">() could give rise to alignment problems; so</span></div>
<div style="position:absolute;left:239.98px;top:643.67px" class="cls_006"><span class="cls_006">they are specified to return pointers aligned to the largest size which</span></div>
<div style="position:absolute;left:239.98px;top:654.67px" class="cls_006"><span class="cls_006">the architecture cares about. In the case of the R30xx family this need</span></div>
<div style="position:absolute;left:239.98px;top:665.67px" class="cls_006"><span class="cls_006">only be 4 bytes, but in fact is usually 8 bytes: a gesture towards</span></div>
<div style="position:absolute;left:239.98px;top:676.67px" class="cls_006"><span class="cls_006">compatibility with future 64-bit implementations.</span></div>
<div style="position:absolute;left:228.03px;top:690.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Memory order</span><span class="cls_006">: fields within structures are stored into memory in the</span></div>
<div style="position:absolute;left:239.98px;top:701.67px" class="cls_006"><span class="cls_006">order declared.</span></div>
<div style="position:absolute;left:303.54px;top:755.33px" class="cls_002"><span class="cls_002">11-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:127518px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 11</span></div>
<div style="position:absolute;left:414.55px;top:28.00px" class="cls_002"><span class="cls_002">PORTABILITY CONSIDERATIONS</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Padding</span><span class="cls_006">: is generated whenever the next field would otherwise have</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">the ‘‘wrong’’ alignment with respect to the structure’s base address.</span></div>
<div style="position:absolute;left:48.03px;top:75.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Endianness</span><span class="cls_006">: has no effect on the picture shown by Figure 11.2, “Data</span></div>
<div style="position:absolute;left:59.97px;top:86.67px" class="cls_006"><span class="cls_006">representation with #pragma pack(1)”. Endianness determines how</span></div>
<div style="position:absolute;left:59.97px;top:97.67px" class="cls_006"><span class="cls_006">an integer value is related to the values of its constituent bytes (when</span></div>
<div style="position:absolute;left:59.97px;top:108.67px" class="cls_006"><span class="cls_006">they are considered separately); it does not affect the relative byte</span></div>
<div style="position:absolute;left:59.97px;top:119.67px" class="cls_006"><span class="cls_006">locations used for storing those values.</span></div>
<div style="position:absolute;left:59.97px;top:133.67px" class="cls_006"><span class="cls_006">Endianness does have some effect on C bitfields, which are discussed</span></div>
<div style="position:absolute;left:59.97px;top:144.67px" class="cls_006"><span class="cls_006">below.</span></div>
<div style="position:absolute;left:48.02px;top:155.67px" class="cls_006"><span class="cls_006">There’s an irrefutable, pure and correct position on data structures and</span></div>
<div style="position:absolute;left:36.00px;top:166.67px" class="cls_006"><span class="cls_006">portability; the memory representation of data is compiler dependent, and</span></div>
<div style="position:absolute;left:36.00px;top:177.67px" class="cls_006"><span class="cls_006">the programmer should not expect it to be in any way portable - even</span></div>
<div style="position:absolute;left:36.00px;top:188.67px" class="cls_006"><span class="cls_006">between two different compilers for the same architecture. In general, it is</span></div>
<div style="position:absolute;left:36.00px;top:199.67px" class="cls_006"><span class="cls_006">reasonable to expect to be able to exchange a sequence or consecutive</span></div>
<div style="position:absolute;left:36.00px;top:210.67px" class="cls_006"><span class="cls_006">array of </span><span class="cls_008">char</span><span class="cls_006">s (each taking a value between 0 and 255), but not more. But</span></div>
<div style="position:absolute;left:35.99px;top:221.67px" class="cls_006"><span class="cls_006">in the real world it would be inefficient to make sure that all data ever</span></div>
<div style="position:absolute;left:35.99px;top:232.67px" class="cls_006"><span class="cls_006">exchanged or published by programs was in the form of byte strings.</span></div>
<div style="position:absolute;left:48.01px;top:243.67px" class="cls_006"><span class="cls_006">ANSI compilers may support an option using the ‘‘pack’’ PRAGMA:</span></div>
<div style="position:absolute;left:72.00px;top:265.00px" class="cls_028"><span class="cls_028">#pragma pack(1)</span></div>
<div style="position:absolute;left:72.00px;top:275.00px" class="cls_028"><span class="cls_028">struct foo {</span></div>
<div style="position:absolute;left:108.00px;top:285.00px" class="cls_028"><span class="cls_028">char small;</span></div>
<div style="position:absolute;left:108.00px;top:295.00px" class="cls_028"><span class="cls_028">short medium;</span></div>
<div style="position:absolute;left:108.00px;top:305.00px" class="cls_028"><span class="cls_028">char again;</span></div>
<div style="position:absolute;left:108.00px;top:315.00px" class="cls_028"><span class="cls_028">int big;</span></div>
<div style="position:absolute;left:72.00px;top:325.00px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:36.00px;top:345.67px" class="cls_006"><span class="cls_006">has the effect of causing the compiler to omit all padding, producing the</span></div>
<div style="position:absolute;left:36.00px;top:356.67px" class="cls_006"><span class="cls_006">layout shown in Figure 11.2, “Data representation with #pragma pack(1)”:</span></div>
<div style="position:absolute;left:112.68px;top:377.00px" class="cls_020"><span class="cls_020">offset (bytes)</span></div>
<div style="position:absolute;left:178.47px;top:377.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:213.11px;top:377.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:236.56px;top:377.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:260.00px;top:377.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:294.82px;top:377.00px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:311.31px;top:377.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:178.21px;top:394.00px" class="cls_020"><span class="cls_020">small</span></div>
<div style="position:absolute;left:212.93px;top:394.00px" class="cls_020"><span class="cls_020">medium</span></div>
<div style="position:absolute;left:259.89px;top:394.00px" class="cls_020"><span class="cls_020">again</span></div>
<div style="position:absolute;left:294.80px;top:394.00px" class="cls_020"><span class="cls_020">big</span></div>
<div style="position:absolute;left:84.74px;top:413.00px" class="cls_020"><span class="cls_020">Figure 11.2.   Data representation with #pragma pack(1)</span></div>
<div style="position:absolute;left:48.02px;top:428.67px" class="cls_006"><span class="cls_006">A structure packed like this has no inherent alignment, so in addition</span></div>
<div style="position:absolute;left:36.00px;top:439.67px" class="cls_006"><span class="cls_006">to the lack of any padding, the structure base address may also be</span></div>
<div style="position:absolute;left:36.00px;top:450.67px" class="cls_006"><span class="cls_006">unaligned. The compiler will always generate load and store sequences to</span></div>
<div style="position:absolute;left:36.00px;top:461.67px" class="cls_006"><span class="cls_006">its fields which are alignment independent (and therefore to some extent</span></div>
<div style="position:absolute;left:36.00px;top:472.67px" class="cls_006"><span class="cls_006">inefficient) - even though, in this particular case, the </span><span class="cls_029">big</span><span class="cls_006"> field happens to</span></div>
<div style="position:absolute;left:36.00px;top:483.67px" class="cls_006"><span class="cls_006">have the correct 4-byte alignment from the structure base.</span></div>
<div style="position:absolute;left:48.02px;top:494.67px" class="cls_006"><span class="cls_006">Structure packing is most frequently used when storing large files of a</span></div>
<div style="position:absolute;left:36.00px;top:505.67px" class="cls_006"><span class="cls_006">particular   structure   in   memory;   for   example,   when   storing   the</span></div>
<div style="position:absolute;left:36.00px;top:516.67px" class="cls_006"><span class="cls_006">“description” of a font in the ROMs of a printer. By eliminating padding,</span></div>
<div style="position:absolute;left:36.00px;top:527.67px" class="cls_006"><span class="cls_006">more font structures can be saved in a smaller amount of memory; the cost</span></div>
<div style="position:absolute;left:36.00px;top:538.67px" class="cls_006"><span class="cls_006">of doing this occurs at run-time, when more conservative code sequences</span></div>
<div style="position:absolute;left:36.00px;top:549.67px" class="cls_006"><span class="cls_006">must be used to read fields from the structure.</span></div>
<div style="position:absolute;left:48.02px;top:560.67px" class="cls_006"><span class="cls_006">The ‘‘1’’ in </span><span class="cls_029">pack(1)</span><span class="cls_006"> refers to the maximum alignment which must be</span></div>
<div style="position:absolute;left:36.01px;top:571.67px" class="cls_006"><span class="cls_006">respected, so ‘‘pack(2)’’ means align only to 2-byte boundaries:</span></div>
<div style="position:absolute;left:72.00px;top:593.00px" class="cls_028"><span class="cls_028">#pragma pack(2)</span></div>
<div style="position:absolute;left:72.00px;top:603.00px" class="cls_028"><span class="cls_028">struct foo {</span></div>
<div style="position:absolute;left:108.00px;top:613.00px" class="cls_028"><span class="cls_028">char small;</span></div>
<div style="position:absolute;left:108.00px;top:623.00px" class="cls_028"><span class="cls_028">short medium;</span></div>
<div style="position:absolute;left:108.00px;top:633.00px" class="cls_028"><span class="cls_028">char again;</span></div>
<div style="position:absolute;left:108.00px;top:642.99px" class="cls_028"><span class="cls_028">int big;</span></div>
<div style="position:absolute;left:72.00px;top:652.99px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:289.79px;top:755.33px" class="cls_002"><span class="cls_002">11-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:128320px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">PORTABILITY CONSIDERATIONS</span></div>
<div style="position:absolute;left:520.57px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 11</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">The preceding code fragment has the effect of causing the compiler to</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">pad items of 2 bytes or larger to 2-byte boundaries, producing the layout</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_006"><span class="cls_006">shown in Figure 11.3, “Data representation with #pragma pack(2)”:</span></div>
<div style="position:absolute;left:276.23px;top:93.00px" class="cls_020"><span class="cls_020">offset (bytes)</span></div>
<div style="position:absolute;left:342.02px;top:93.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:376.66px;top:93.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:393.15px;top:93.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:416.60px;top:93.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:440.04px;top:93.00px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:474.86px;top:93.00px" class="cls_020"><span class="cls_020">5</span></div>
<div style="position:absolute;left:491.35px;top:93.00px" class="cls_020"><span class="cls_020">6</span></div>
<div style="position:absolute;left:507.84px;top:93.00px" class="cls_020"><span class="cls_020">9</span></div>
<div style="position:absolute;left:341.76px;top:110.00px" class="cls_020"><span class="cls_020">small</span></div>
<div style="position:absolute;left:376.37px;top:110.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:392.82px;top:110.00px" class="cls_020"><span class="cls_020">medium</span></div>
<div style="position:absolute;left:439.81px;top:110.00px" class="cls_020"><span class="cls_020">again</span></div>
<div style="position:absolute;left:474.42px;top:110.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:490.88px;top:110.00px" class="cls_020"><span class="cls_020">big</span></div>
<div style="position:absolute;left:264.74px;top:129.00px" class="cls_020"><span class="cls_020">Figure 11.3.   Data representation with #pragma pack(2)</span></div>
<div style="position:absolute;left:228.02px;top:144.67px" class="cls_006"><span class="cls_006">The </span><span class="cls_029">#pragma  pack</span><span class="cls_006"> feature is not the only potential source of data</span></div>
<div style="position:absolute;left:216.00px;top:155.67px" class="cls_006"><span class="cls_006">representation incompatibility; endianness, discussed below, can also</span></div>
<div style="position:absolute;left:216.00px;top:166.67px" class="cls_006"><span class="cls_006">pose a significant portability issue. Nonetheless, used with care this</span></div>
<div style="position:absolute;left:216.00px;top:177.67px" class="cls_006"><span class="cls_006">feature can reduce the amount of difference between sources for two</span></div>
<div style="position:absolute;left:216.00px;top:188.67px" class="cls_006"><span class="cls_006">different architectures.</span></div>
<div style="position:absolute;left:216.00px;top:211.00px" class="cls_015"><span class="cls_015">ISOLATING SYSTEM DEPENDENCIES</span></div>
<div style="position:absolute;left:228.02px;top:224.67px" class="cls_006"><span class="cls_006">It is unlikely that the source code to be ported is literally the complete</span></div>
<div style="position:absolute;left:216.00px;top:235.67px" class="cls_006"><span class="cls_006">system.  Most  programs  depend  on  an  environment  implemented  by</span></div>
<div style="position:absolute;left:216.00px;top:246.67px" class="cls_006"><span class="cls_006">underlying independent software (perhaps from a 3rd party); this may be</span></div>
<div style="position:absolute;left:216.00px;top:257.67px" class="cls_006"><span class="cls_006">bound in at run time (an operating system or system monitor), or at link</span></div>
<div style="position:absolute;left:216.00px;top:268.67px" class="cls_006"><span class="cls_006">time (library functions, “include” files). Quite often, sources may not be</span></div>
<div style="position:absolute;left:216.00px;top:279.67px" class="cls_006"><span class="cls_006">available; sometimes they will just be more trouble to port than to</span></div>
<div style="position:absolute;left:216.00px;top:290.67px" class="cls_006"><span class="cls_006">reproduce.</span></div>
<div style="position:absolute;left:228.02px;top:301.67px" class="cls_006"><span class="cls_006">This is the point at which the programmer will appreciate the purpose</span></div>
<div style="position:absolute;left:216.00px;top:312.67px" class="cls_006"><span class="cls_006">of attempts to standardize a C runtime library. If only the boundary</span></div>
<div style="position:absolute;left:216.00px;top:323.67px" class="cls_006"><span class="cls_006">between the “application” program and its environment consisted of well-</span></div>
<div style="position:absolute;left:216.00px;top:334.67px" class="cls_006"><span class="cls_006">defined standard calls and include files, the job would be trivial. It isn’t,</span></div>
<div style="position:absolute;left:216.00px;top:345.67px" class="cls_006"><span class="cls_006">usually.</span></div>
<div style="position:absolute;left:216.00px;top:368.00px" class="cls_015"><span class="cls_015">Locating system dependencies</span></div>
<div style="position:absolute;left:228.02px;top:381.67px" class="cls_006"><span class="cls_006">In general, the “core application” consists of the code which does NOT</span></div>
<div style="position:absolute;left:216.00px;top:392.67px" class="cls_006"><span class="cls_006">meet the following criteria:</span></div>
<div style="position:absolute;left:228.02px;top:406.67px" class="cls_006"><span class="cls_006">• Supplied as part of an OS the new system won’t be using;</span></div>
<div style="position:absolute;left:228.02px;top:420.67px" class="cls_006"><span class="cls_006">• A library function which is not available (with </span><span class="cls_008">exactly</span><span class="cls_006"> the same</span></div>
<div style="position:absolute;left:239.98px;top:431.67px" class="cls_006"><span class="cls_006">semantics) in the target compilation system;</span></div>
<div style="position:absolute;left:228.03px;top:445.67px" class="cls_006"><span class="cls_006">• Not licensed for use on the new target system.</span></div>
<div style="position:absolute;left:228.03px;top:456.67px" class="cls_006"><span class="cls_006">There are two ‘‘concentric’’ boundaries which can be drawn, and in a</span></div>
<div style="position:absolute;left:216.01px;top:467.67px" class="cls_006"><span class="cls_006">sense they divide the original code up into three parts:</span></div>
<div style="position:absolute;left:228.03px;top:481.67px" class="cls_006"><span class="cls_006">• The inner part is the application to be ported. The new system may</span></div>
<div style="position:absolute;left:239.98px;top:492.67px" class="cls_006"><span class="cls_006">carry   this   code   through   unchanged</span></div>
<div style="position:absolute;left:444.53px;top:492.67px" class="cls_006"><span class="cls_006">(except   where   portability</span></div>
<div style="position:absolute;left:239.98px;top:503.67px" class="cls_006"><span class="cls_006">problems mean the code needs to be changed); so usually, after</span></div>
<div style="position:absolute;left:239.98px;top:514.67px" class="cls_006"><span class="cls_006">porting, this code should still be usable on the original system.</span></div>
<div style="position:absolute;left:228.03px;top:528.67px" class="cls_006"><span class="cls_006">• System dependent code, libraries, OS etc. which are clearly not going</span></div>
<div style="position:absolute;left:239.98px;top:539.67px" class="cls_006"><span class="cls_006">to be taken to the new system. Porting should not be an issue for</span></div>
<div style="position:absolute;left:239.98px;top:550.67px" class="cls_006"><span class="cls_006">these.</span></div>
<div style="position:absolute;left:228.03px;top:564.67px" class="cls_006"><span class="cls_006">• Glue functions and data which join the two up. These will have to be</span></div>
<div style="position:absolute;left:239.98px;top:575.67px" class="cls_006"><span class="cls_006">modified, or sometimes re-implemented, to adapt the application to</span></div>
<div style="position:absolute;left:239.98px;top:586.67px" class="cls_006"><span class="cls_006">the new environment.</span></div>
<div style="position:absolute;left:228.03px;top:597.67px" class="cls_006"><span class="cls_006">The glue probably represents 10% of the code; but requires 90% of the</span></div>
<div style="position:absolute;left:216.01px;top:608.67px" class="cls_006"><span class="cls_006">work. In a program which has been ported often, the glue will be neatly</span></div>
<div style="position:absolute;left:216.01px;top:619.67px" class="cls_006"><span class="cls_006">separated; in a program which evolved in a single system, the glue may be</span></div>
<div style="position:absolute;left:216.01px;top:630.67px" class="cls_006"><span class="cls_006">rather deeply mixed with the application.</span></div>
<div style="position:absolute;left:216.00px;top:653.00px" class="cls_015"><span class="cls_015">Fixing up dependencies</span></div>
<div style="position:absolute;left:228.02px;top:666.67px" class="cls_006"><span class="cls_006">To remove these dependencies, the programmer must first of all, try to</span></div>
<div style="position:absolute;left:216.00px;top:677.67px" class="cls_006"><span class="cls_006">find the best boundaries and divide the code into application, glue and</span></div>
<div style="position:absolute;left:216.00px;top:688.67px" class="cls_006"><span class="cls_006">environment. Since there will be a new “environment” on the new system,</span></div>
<div style="position:absolute;left:216.00px;top:699.67px" class="cls_006"><span class="cls_006">the latter code is more or less irrelevant (and is likely written in assembler,</span></div>
<div style="position:absolute;left:216.00px;top:710.67px" class="cls_006"><span class="cls_006">to a great extent).</span></div>
<div style="position:absolute;left:303.54px;top:755.33px" class="cls_002"><span class="cls_002">11-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:129122px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 11</span></div>
<div style="position:absolute;left:414.55px;top:28.00px" class="cls_002"><span class="cls_002">PORTABILITY CONSIDERATIONS</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">This is art as well as science; there is no single right way to do it. The</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_006"><span class="cls_006">objective will be to minimize the scope for introducing new errors, while</span></div>
<div style="position:absolute;left:36.00px;top:72.67px" class="cls_006"><span class="cls_006">minimizing the amount of work done.</span></div>
<div style="position:absolute;left:48.02px;top:83.67px" class="cls_006"><span class="cls_006">The ‘‘application’’ part should be recompilable on the new system,</span></div>
<div style="position:absolute;left:36.00px;top:94.67px" class="cls_006"><span class="cls_006">generating a list of unresolved definitions which need to be patched up.</span></div>
<div style="position:absolute;left:36.00px;top:105.67px" class="cls_006"><span class="cls_006">Some of these, when investigated, will turn out to be used in code which</span></div>
<div style="position:absolute;left:36.00px;top:116.67px" class="cls_006"><span class="cls_006">really belonged in the ‘‘glue’’; move the boundary and iterate until the list</span></div>
<div style="position:absolute;left:36.00px;top:127.67px" class="cls_006"><span class="cls_006">of unresolved names makes sense.</span></div>
<div style="position:absolute;left:48.02px;top:138.67px" class="cls_006"><span class="cls_006">The glue now needs to be re-implemented for the new environment. The</span></div>
<div style="position:absolute;left:36.00px;top:149.67px" class="cls_006"><span class="cls_006">programmer has two choices for each function:</span></div>
<div style="position:absolute;left:48.02px;top:163.67px" class="cls_006"><span class="cls_006">• Recompile  the  function,  using  some</span></div>
<div style="position:absolute;left:260.77px;top:163.67px" class="cls_006"><span class="cls_006">‘‘underglue’’  definitions  or</span></div>
<div style="position:absolute;left:59.97px;top:174.67px" class="cls_006"><span class="cls_006">functions to mimic the behavior of the old environment using the new</span></div>
<div style="position:absolute;left:59.97px;top:185.67px" class="cls_006"><span class="cls_006">one. In a sense, the programmer is pragmatically deciding that what</span></div>
<div style="position:absolute;left:59.97px;top:196.67px" class="cls_006"><span class="cls_006">was seen as glue is now application.</span></div>
<div style="position:absolute;left:48.02px;top:210.67px" class="cls_006"><span class="cls_006">• Reimplement the function (using the old one for inspiration and as a</span></div>
<div style="position:absolute;left:59.97px;top:221.67px" class="cls_006"><span class="cls_006">source for cut-and-paste), aiming to mimic the function as a ‘‘black</span></div>
<div style="position:absolute;left:59.97px;top:232.67px" class="cls_006"><span class="cls_006">box’’.</span></div>
<div style="position:absolute;left:48.02px;top:243.67px" class="cls_006"><span class="cls_006">For each function or module, choose one of these strategies. It is nearly</span></div>
<div style="position:absolute;left:36.00px;top:254.67px" class="cls_006"><span class="cls_006">always a bad idea to mix strategies in the same module.</span></div>
<div style="position:absolute;left:36.00px;top:275.67px" class="cls_006"><span class="cls_006">Isolating Non-Portable Code</span></div>
<div style="position:absolute;left:48.02px;top:286.67px" class="cls_006"><span class="cls_006">In general, it is difficult to write a</span></div>
<div style="position:absolute;left:239.74px;top:286.67px" class="cls_006"><span class="cls_006">“stand-alone” program entirely</span></div>
<div style="position:absolute;left:36.00px;top:297.67px" class="cls_006"><span class="cls_006">portably. In the desktop environment, programmers write programs to an</span></div>
<div style="position:absolute;left:36.00px;top:308.67px" class="cls_006"><span class="cls_006">OS standard; thus, porting a program to a new system is limited to porting</span></div>
<div style="position:absolute;left:36.00px;top:319.67px" class="cls_006"><span class="cls_006">that OS. This is the model for UNIX and even for many RTOS-based</span></div>
<div style="position:absolute;left:36.00px;top:330.67px" class="cls_006"><span class="cls_006">systems.</span></div>
<div style="position:absolute;left:48.02px;top:341.67px" class="cls_006"><span class="cls_006">As examples, it is easy to write a portable routine to calculate prime</span></div>
<div style="position:absolute;left:36.00px;top:352.67px" class="cls_006"><span class="cls_006">numbers; it is much harder to write a portable routine to accept typed</span></div>
<div style="position:absolute;left:36.00px;top:363.67px" class="cls_006"><span class="cls_006">input, providing line editing and simple argument parsing (are characters</span></div>
<div style="position:absolute;left:36.00px;top:374.67px" class="cls_006"><span class="cls_006">7- or</span></div>
<div style="position:absolute;left:69.14px;top:374.67px" class="cls_006"><span class="cls_006">8-bit? Is the language English? What accented characters are</span></div>
<div style="position:absolute;left:36.00px;top:385.67px" class="cls_006"><span class="cls_006">acceptable? How does the display device implement backspace?)</span></div>
<div style="position:absolute;left:48.02px;top:396.67px" class="cls_006"><span class="cls_006">The best programs hide the nonportable parts of code in modules, whose</span></div>
<div style="position:absolute;left:36.00px;top:407.67px" class="cls_006"><span class="cls_006">interfaces  consist  of  stable  data  declarations  and  functions  whose</span></div>
<div style="position:absolute;left:36.00px;top:418.67px" class="cls_006"><span class="cls_006">operation can be expressed succinctly and clearly.</span></div>
<div style="position:absolute;left:36.00px;top:441.00px" class="cls_015"><span class="cls_015">Using assembler</span></div>
<div style="position:absolute;left:48.02px;top:454.67px" class="cls_006"><span class="cls_006">There are three reasons for using assembler:</span></div>
<div style="position:absolute;left:48.02px;top:468.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Efficient implementation of critical functions</span><span class="cls_006">: getting the last clock</span></div>
<div style="position:absolute;left:59.98px;top:479.67px" class="cls_006"><span class="cls_006">cycle out of </span><span class="cls_008">strcpy</span><span class="cls_006"> may well be worthwhile.</span></div>
<div style="position:absolute;left:48.03px;top:493.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Access to instructions not supported by the compiler</span><span class="cls_006">: e.g. access to</span></div>
<div style="position:absolute;left:59.98px;top:504.67px" class="cls_006"><span class="cls_006">control registers. These can sometimes be replaced by using ‘‘tiny’’</span></div>
<div style="position:absolute;left:59.98px;top:515.67px" class="cls_006"><span class="cls_006">subroutines; and sometimes by C</span><span class="cls_029">asm</span><span class="cls_006"> statements. Tiny subroutines</span></div>
<div style="position:absolute;left:59.98px;top:526.67px" class="cls_006"><span class="cls_006">are  particularly  apt  when,  although  the  implementation  will  be</span></div>
<div style="position:absolute;left:59.98px;top:537.67px" class="cls_006"><span class="cls_006">completely  machine  dependent  the  desired  effect  is  machine-</span></div>
<div style="position:absolute;left:59.98px;top:548.67px" class="cls_006"><span class="cls_006">independent - prefer a ‘‘disable interrupts’’ function to a ‘‘set status</span></div>
<div style="position:absolute;left:59.98px;top:559.67px" class="cls_006"><span class="cls_006">register bits’’ function.</span></div>
<div style="position:absolute;left:48.03px;top:573.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Some critical environmental deficiency</span><span class="cls_006">: (most commonly) inability to</span></div>
<div style="position:absolute;left:59.98px;top:584.67px" class="cls_006"><span class="cls_006">provide the free use of CPU registers and the stack which the compiler</span></div>
<div style="position:absolute;left:59.98px;top:595.67px" class="cls_006"><span class="cls_006">relies on. Classic examples are interrupt handlers. To maximize ease</span></div>
<div style="position:absolute;left:59.98px;top:606.67px" class="cls_006"><span class="cls_006">of portability, the programmer can at least make it a priority, in these</span></div>
<div style="position:absolute;left:59.98px;top:617.67px" class="cls_006"><span class="cls_006">routines, to build an environment from which software can call C</span></div>
<div style="position:absolute;left:59.98px;top:628.67px" class="cls_006"><span class="cls_006">functions.</span></div>
<div style="position:absolute;left:289.79px;top:755.33px" class="cls_002"><span class="cls_002">11-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:129924px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">PORTABILITY CONSIDERATIONS</span></div>
<div style="position:absolute;left:520.57px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 11</span></div>
<div style="position:absolute;left:216.00px;top:50.00px" class="cls_015"><span class="cls_015">ENDIANNESS</span></div>
<div style="position:absolute;left:228.02px;top:63.67px" class="cls_006"><span class="cls_006">The word ‘‘endianness’’ was introduced by a famous short paper† in the</span></div>
<div style="position:absolute;left:216.00px;top:74.67px" class="cls_006"><span class="cls_006">Journal of the ACM, in the early 1980’s. The author observed that</span></div>
<div style="position:absolute;left:216.00px;top:85.67px" class="cls_006"><span class="cls_006">computer architectures had divided up into two camps, based on an</span></div>
<div style="position:absolute;left:216.00px;top:96.67px" class="cls_006"><span class="cls_006">“arbitrary” choice of the way in which byte and word addressing are</span></div>
<div style="position:absolute;left:216.00px;top:107.67px" class="cls_006"><span class="cls_006">related. In ‘‘Gulliver’s Travels’’ the little-endians and big-endians fought a</span></div>
<div style="position:absolute;left:216.00px;top:118.67px" class="cls_006"><span class="cls_006">war over the correct end at which to start eating a boiled egg; a war notable</span></div>
<div style="position:absolute;left:216.00px;top:129.67px" class="cls_006"><span class="cls_006">for the inability of the protagonists to comprehend the arbitrary nature of</span></div>
<div style="position:absolute;left:216.00px;top:140.67px" class="cls_006"><span class="cls_006">their difference. The joke was appreciated, and the name has stuck.</span></div>
<div style="position:absolute;left:228.02px;top:151.67px" class="cls_006"><span class="cls_006">The problem comes up in both software and hardware fields - but</span></div>
<div style="position:absolute;left:216.00px;top:162.67px" class="cls_006"><span class="cls_006">slightly differently:</span></div>
<div style="position:absolute;left:228.02px;top:176.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:176.67px" class="cls_008"><span class="cls_008">Endianness  -  the  hardware  problem</span><span class="cls_006">:  this  arises  when  a  byte-</span></div>
<div style="position:absolute;left:239.97px;top:187.67px" class="cls_006"><span class="cls_006">addressed system is wired up with buses which are multiple-bytes</span></div>
<div style="position:absolute;left:239.97px;top:198.67px" class="cls_006"><span class="cls_006">wide. When the system transfers a multi-byte datum across the bus,</span></div>
<div style="position:absolute;left:239.97px;top:209.67px" class="cls_006"><span class="cls_006">each byte of that datum has its own, individual address. So:</span></div>
<div style="position:absolute;left:264.02px;top:223.67px" class="cls_006"><span class="cls_006">If the lowest-addressed byte in the datum travels on the 8 bus</span></div>
<div style="position:absolute;left:264.02px;top:234.67px" class="cls_006"><span class="cls_006">lines (‘‘byte lane’’) with the lowest bit-numbers, the bus is </span><span class="cls_008">little-</span></div>
<div style="position:absolute;left:264.02px;top:245.67px" class="cls_008"><span class="cls_008">endian</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:264.02px;top:259.67px" class="cls_006"><span class="cls_006">If the lowest-addressed byte in the datum travels on the byte</span></div>
<div style="position:absolute;left:264.02px;top:270.67px" class="cls_006"><span class="cls_006">lane with the </span><span class="cls_008">highest</span><span class="cls_006"> bit-numbers, the bus is </span><span class="cls_008">big-endian</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:239.98px;top:284.67px" class="cls_006"><span class="cls_006">Note that there is no longer any dispute in the industry as to how bit</span></div>
<div style="position:absolute;left:239.98px;top:295.67px" class="cls_006"><span class="cls_006">numbers relate to arithmetic significance; high bit numbers are</span></div>
<div style="position:absolute;left:239.98px;top:306.67px" class="cls_006"><span class="cls_006">always most significant. In particular this means that bits-within-</span></div>
<div style="position:absolute;left:239.98px;top:317.67px" class="cls_006"><span class="cls_006">byte have an unambiguous meaning.</span></div>
<div style="position:absolute;left:239.98px;top:331.67px" class="cls_006"><span class="cls_006">All byte addressable CPUs announce themselves as either big- or</span></div>
<div style="position:absolute;left:239.98px;top:342.67px" class="cls_006"><span class="cls_006">little-endian every time they transfer data. Intel and DEC CPUs are in</span></div>
<div style="position:absolute;left:239.98px;top:353.67px" class="cls_006"><span class="cls_006">general little-endian; Motorola, Sun SPARC and most IBM CPUs are</span></div>
<div style="position:absolute;left:239.98px;top:364.67px" class="cls_006"><span class="cls_006">big-endian. MIPS CPUs can be either, as configured from power-up.</span></div>
<div style="position:absolute;left:239.98px;top:378.67px" class="cls_006"><span class="cls_006">For a hardware engineer, endianness only matters when a system</span></div>
<div style="position:absolute;left:239.98px;top:389.67px" class="cls_006"><span class="cls_006">includes  buses,  CPUs  or  peripherals  whose  endianness  doesn’t</span></div>
<div style="position:absolute;left:239.98px;top:400.67px" class="cls_006"><span class="cls_006">match.</span></div>
<div style="position:absolute;left:239.98px;top:414.67px" class="cls_006"><span class="cls_006">The choice facing the hardware engineer is not a happy one; if two</span></div>
<div style="position:absolute;left:239.98px;top:425.67px" class="cls_006"><span class="cls_006">components or buses don’t match, the system designer must choose</span></div>
<div style="position:absolute;left:239.98px;top:436.67px" class="cls_006"><span class="cls_006">one of two undesirable situations:</span></div>
<div style="position:absolute;left:239.98px;top:450.67px" class="cls_006"><span class="cls_006">a)    If the data buses are connected to preserve byte address, then bit</span></div>
<div style="position:absolute;left:264.03px;top:461.67px" class="cls_006"><span class="cls_006">numbering for multi-byte data moving through the system will</span></div>
<div style="position:absolute;left:264.03px;top:472.67px" class="cls_006"><span class="cls_006">be  inconsistent;  so  multi-byte  data  is  likely  to  require  re-</span></div>
<div style="position:absolute;left:264.03px;top:483.67px" class="cls_006"><span class="cls_006">interpretation by software.</span></div>
<div style="position:absolute;left:239.98px;top:497.67px" class="cls_006"><span class="cls_006">b)   If the data buses are connected with matching bit numbers, then</span></div>
<div style="position:absolute;left:264.03px;top:508.67px" class="cls_006"><span class="cls_006">the  two  sides  will  see  the  sequence  of  bytes  in  memory</span></div>
<div style="position:absolute;left:264.03px;top:519.67px" class="cls_006"><span class="cls_006">differently. This problem can be managed by keeping all data</span></div>
<div style="position:absolute;left:264.03px;top:530.67px" class="cls_006"><span class="cls_006">strictly  word-aligned,  and</span></div>
<div style="position:absolute;left:406.26px;top:530.67px" class="cls_006"><span class="cls_006">‘‘byteswapping’’  before  and  after</span></div>
<div style="position:absolute;left:264.03px;top:541.67px" class="cls_006"><span class="cls_006">transfer.</span></div>
<div style="position:absolute;left:264.03px;top:555.67px" class="cls_006"><span class="cls_006">Where a system includes a MIPS CPU which can be configured</span></div>
<div style="position:absolute;left:264.03px;top:566.67px" class="cls_006"><span class="cls_006">with either endianness with no external hardware provided,</span></div>
<div style="position:absolute;left:264.03px;top:577.67px" class="cls_006"><span class="cls_006">option (b) is what happens whenever the CPU configuration is</span></div>
<div style="position:absolute;left:264.03px;top:588.67px" class="cls_006"><span class="cls_006">changed to mismatch the rest of the system.</span></div>
<div style="position:absolute;left:228.03px;top:602.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:602.67px" class="cls_008"><span class="cls_008">Endianness - software visibility</span><span class="cls_006">: software engineers writing in a high</span></div>
<div style="position:absolute;left:239.98px;top:613.67px" class="cls_006"><span class="cls_006">level language apparently have no need to number bits, so might</span></div>
<div style="position:absolute;left:239.98px;top:624.67px" class="cls_006"><span class="cls_006">believe  themselves  immune  from  this  problem.  But  on  closer</span></div>
<div style="position:absolute;left:239.98px;top:635.67px" class="cls_006"><span class="cls_006">inspection,  it  turns  out  that  normal  binary  numbers</span></div>
<div style="position:absolute;left:535.38px;top:635.67px" class="cls_006"><span class="cls_006">(i.e.</span></div>
<div style="position:absolute;left:560.72px;top:635.67px" class="cls_006"><span class="cls_006">2-s</span></div>
<div style="position:absolute;left:239.98px;top:646.67px" class="cls_006"><span class="cls_006">complement integers) bigger than 8 bits implicitly define an ordering</span></div>
<div style="position:absolute;left:239.98px;top:657.67px" class="cls_006"><span class="cls_006">- some bits are arithmetically more significant.</span></div>
<div style="position:absolute;left:239.98px;top:671.67px" class="cls_006"><span class="cls_006">In software:</span></div>
<div style="position:absolute;left:234.00px;top:710.67px" class="cls_006"><span class="cls_006">† “On holy wars and a plea for peace”, Danny Cohen, IEEE</span></div>
<div style="position:absolute;left:234.00px;top:722.67px" class="cls_006"><span class="cls_006">Computer, October 1981 pp. 48-54</span></div>
<div style="position:absolute;left:303.54px;top:755.33px" class="cls_002"><span class="cls_002">11-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:130726px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 11</span></div>
<div style="position:absolute;left:414.55px;top:28.00px" class="cls_002"><span class="cls_002">PORTABILITY CONSIDERATIONS</span></div>
<div style="position:absolute;left:84.02px;top:50.67px" class="cls_006"><span class="cls_006">An architecture where the lowest addressed byte of a multi-byte</span></div>
<div style="position:absolute;left:84.02px;top:61.67px" class="cls_006"><span class="cls_006">integer holds the least-significant bits is called little-endian.</span></div>
<div style="position:absolute;left:84.02px;top:75.67px" class="cls_006"><span class="cls_006">An architecture where the lowest addressed byte of a multi-byte</span></div>
<div style="position:absolute;left:84.02px;top:86.67px" class="cls_006"><span class="cls_006">integer holds the most significant bits is called big-endian.</span></div>
<div style="position:absolute;left:59.97px;top:100.67px" class="cls_006"><span class="cls_006">Software  problems  occur  on  any  system  afflicted  by  hardware</span></div>
<div style="position:absolute;left:59.97px;top:111.67px" class="cls_006"><span class="cls_006">incompatibility;  but  the  software  problem  also  emerges  when  a</span></div>
<div style="position:absolute;left:59.97px;top:122.67px" class="cls_006"><span class="cls_006">program deals with ‘‘foreign’’ data originating from a system using the</span></div>
<div style="position:absolute;left:59.97px;top:133.67px" class="cls_006"><span class="cls_006">opposite convention. The data may arrive on a communications link,</span></div>
<div style="position:absolute;left:59.97px;top:144.67px" class="cls_006"><span class="cls_006">on a tape or floppy disk.</span></div>
<div style="position:absolute;left:48.02px;top:158.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Why is it so confusing?</span><span class="cls_006">: it is difficult even to describe the problem</span></div>
<div style="position:absolute;left:59.98px;top:169.67px" class="cls_006"><span class="cls_006">without taking a side. The origin of the two types lies in two different</span></div>
<div style="position:absolute;left:59.98px;top:180.67px" class="cls_006"><span class="cls_006">ways of drawing the pictures and describing the data; both natural in</span></div>
<div style="position:absolute;left:59.98px;top:191.67px" class="cls_006"><span class="cls_006">different contexts.</span></div>
<div style="position:absolute;left:59.98px;top:205.67px" class="cls_006"><span class="cls_006">Big-endians typically draw their pictures organized around words (32</span></div>
<div style="position:absolute;left:59.98px;top:216.67px" class="cls_006"><span class="cls_006">bits  in  a  MIPS  system),  like  Figure</span></div>
<div style="position:absolute;left:260.20px;top:216.67px" class="cls_006"><span class="cls_006">11.4,</span></div>
<div style="position:absolute;left:292.66px;top:216.67px" class="cls_006"><span class="cls_006">“Typical  big-endians</span></div>
<div style="position:absolute;left:59.98px;top:227.67px" class="cls_006"><span class="cls_006">picture'”. What’s more, big-endians see words as a sort of number, so</span></div>
<div style="position:absolute;left:59.98px;top:238.67px" class="cls_006"><span class="cls_006">they put the highest bit number (most significant) on the left, like our</span></div>
<div style="position:absolute;left:59.98px;top:249.67px" class="cls_006"><span class="cls_006">familiar Arabic numbers. And a big endian sees memory extending up</span></div>
<div style="position:absolute;left:59.98px;top:260.67px" class="cls_006"><span class="cls_006">and down the page from the picture in Figure 11.4, “Typical big-</span></div>
<div style="position:absolute;left:59.98px;top:271.67px" class="cls_006"><span class="cls_006">endians picture'”.</span></div>
<div style="position:absolute;left:72.00px;top:293.00px" class="cls_028"><span class="cls_028">union either {</span></div>
<div style="position:absolute;left:108.00px;top:303.00px" class="cls_028"><span class="cls_028">int as_int;</span></div>
<div style="position:absolute;left:108.00px;top:313.00px" class="cls_028"><span class="cls_028">short as_short[2];</span></div>
<div style="position:absolute;left:108.00px;top:323.00px" class="cls_028"><span class="cls_028">char as_char[4];</span></div>
<div style="position:absolute;left:72.00px;top:333.00px" class="cls_028"><span class="cls_028">}</span><span class="cls_039">;</span></div>
<div style="position:absolute;left:55.11px;top:362.00px" class="cls_020"><span class="cls_020">bit no</span></div>
<div style="position:absolute;left:110.87px;top:362.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:144.59px;top:362.00px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:178.30px;top:362.00px" class="cls_020"><span class="cls_020">23</span></div>
<div style="position:absolute;left:212.01px;top:362.00px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:245.73px;top:362.00px" class="cls_020"><span class="cls_020">15</span></div>
<div style="position:absolute;left:284.32px;top:362.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:318.02px;top:362.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:351.71px;top:362.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:110.75px;top:379.00px" class="cls_020"><span class="cls_020">as_int</span></div>
<div style="position:absolute;left:110.75px;top:396.00px" class="cls_020"><span class="cls_020">as_short[0]</span></div>
<div style="position:absolute;left:245.59px;top:396.00px" class="cls_020"><span class="cls_020">as_short[1]</span></div>
<div style="position:absolute;left:110.75px;top:413.00px" class="cls_020"><span class="cls_020">as_char[0]</span></div>
<div style="position:absolute;left:178.26px;top:413.00px" class="cls_020"><span class="cls_020">as_char[1]</span></div>
<div style="position:absolute;left:245.78px;top:413.00px" class="cls_020"><span class="cls_020">as_char[2]</span></div>
<div style="position:absolute;left:318.18px;top:413.00px" class="cls_020"><span class="cls_020">as_char[3]</span></div>
<div style="position:absolute;left:55.11px;top:430.00px" class="cls_020"><span class="cls_020">byte offset</span></div>
<div style="position:absolute;left:110.97px;top:430.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:178.33px;top:430.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:245.68px;top:430.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:317.91px;top:430.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:118.57px;top:449.00px" class="cls_020"><span class="cls_020">Figure 11.4.   Typical big-endians picture'</span></div>
<div style="position:absolute;left:59.98px;top:478.67px" class="cls_006"><span class="cls_006">Little-endians </span><span class="cls_008">are</span><span class="cls_006"> little-endians because they think in bytes, so the</span></div>
<div style="position:absolute;left:59.97px;top:489.67px" class="cls_006"><span class="cls_006">same data structure looks like Figure 11.5, “Little endians picture'”.</span></div>
<div style="position:absolute;left:59.97px;top:500.67px" class="cls_006"><span class="cls_006">Little-endians don’t think of computer data as primarily numeric, so</span></div>
<div style="position:absolute;left:59.97px;top:511.67px" class="cls_006"><span class="cls_006">they tend to put all the low numbers (bits, bytes, whatever) on the left.</span></div>
<div style="position:absolute;left:59.97px;top:522.67px" class="cls_006"><span class="cls_006">A little endian sees memory extending off to the left and right of the</span></div>
<div style="position:absolute;left:59.97px;top:533.67px" class="cls_006"><span class="cls_006">picture...</span></div>
<div style="position:absolute;left:58.04px;top:554.00px" class="cls_020"><span class="cls_020">byte</span></div>
<div style="position:absolute;left:98.07px;top:554.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:170.29px;top:554.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:237.65px;top:554.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:309.88px;top:554.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:58.04px;top:564.00px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:98.07px;top:581.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:131.76px;top:581.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:170.33px;top:581.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:199.15px;top:581.00px" class="cls_020"><span class="cls_020">15</span></div>
<div style="position:absolute;left:237.74px;top:581.00px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:271.45px;top:581.00px" class="cls_020"><span class="cls_020">23</span></div>
<div style="position:absolute;left:310.05px;top:581.00px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:343.76px;top:581.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:98.07px;top:598.00px" class="cls_020"><span class="cls_020">as_int</span></div>
<div style="position:absolute;left:98.07px;top:615.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:131.76px;top:615.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:170.33px;top:615.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:199.15px;top:615.00px" class="cls_020"><span class="cls_020">15</span></div>
<div style="position:absolute;left:237.74px;top:615.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:271.44px;top:615.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:310.00px;top:615.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:343.70px;top:615.00px" class="cls_020"><span class="cls_020">15</span></div>
<div style="position:absolute;left:98.07px;top:632.00px" class="cls_020"><span class="cls_020">as_short[0]</span></div>
<div style="position:absolute;left:237.79px;top:632.00px" class="cls_020"><span class="cls_020">as_short[1]</span></div>
<div style="position:absolute;left:98.07px;top:649.00px" class="cls_020"><span class="cls_020">as_char[0]</span></div>
<div style="position:absolute;left:170.46px;top:649.00px" class="cls_020"><span class="cls_020">as_char[1]</span></div>
<div style="position:absolute;left:237.98px;top:649.00px" class="cls_020"><span class="cls_020">as_char[2]</span></div>
<div style="position:absolute;left:310.38px;top:649.00px" class="cls_020"><span class="cls_020">as_char[3]</span></div>
<div style="position:absolute;left:131.48px;top:668.00px" class="cls_020"><span class="cls_020">Figure 11.5.   Little endians picture'</span></div>
<div style="position:absolute;left:36.00px;top:689.00px" class="cls_015"><span class="cls_015">What it means to the programmer</span></div>
<div style="position:absolute;left:48.02px;top:702.67px" class="cls_006"><span class="cls_006">Software can very easily find out if it is executing as a big-endian, or</span></div>
<div style="position:absolute;left:36.00px;top:713.67px" class="cls_006"><span class="cls_006">little-endian, CPU - by a piece of deliberately non-portable code:</span></div>
<div style="position:absolute;left:289.79px;top:755.33px" class="cls_002"><span class="cls_002">11-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:131528px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">PORTABILITY CONSIDERATIONS</span></div>
<div style="position:absolute;left:520.56px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 11</span></div>
<div style="position:absolute;left:252.00px;top:61.00px" class="cls_028"><span class="cls_028">union either {</span></div>
<div style="position:absolute;left:288.00px;top:71.00px" class="cls_028"><span class="cls_028">int as_int;</span></div>
<div style="position:absolute;left:288.00px;top:81.00px" class="cls_028"><span class="cls_028">short as_short[2];</span></div>
<div style="position:absolute;left:288.00px;top:91.00px" class="cls_028"><span class="cls_028">char as_char[4];</span></div>
<div style="position:absolute;left:252.00px;top:101.00px" class="cls_028"><span class="cls_028">};</span></div>
<div style="position:absolute;left:252.00px;top:120.99px" class="cls_028"><span class="cls_028">either.as_int = 0x12345678;</span></div>
<div style="position:absolute;left:252.00px;top:140.99px" class="cls_028"><span class="cls_028">if (sizeof(int) == 4 && either.as_char[0] == 0x78) {</span></div>
<div style="position:absolute;left:288.00px;top:150.99px" class="cls_028"><span class="cls_028">printf ("Little endian\n");</span></div>
<div style="position:absolute;left:252.00px;top:160.99px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:252.00px;top:170.99px" class="cls_028"><span class="cls_028">else if (sizeof(int) == 4 && either.as_char[0] == 0x12 {</span></div>
<div style="position:absolute;left:288.00px;top:180.99px" class="cls_028"><span class="cls_028">printf ("Big endian\n");</span></div>
<div style="position:absolute;left:252.00px;top:190.99px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:252.00px;top:200.99px" class="cls_028"><span class="cls_028">else {</span></div>
<div style="position:absolute;left:288.00px;top:210.99px" class="cls_028"><span class="cls_028">printf ("Probably not MIPS architecture\n");</span></div>
<div style="position:absolute;left:252.00px;top:220.99px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:228.02px;top:240.67px" class="cls_006"><span class="cls_006">In application software, so long as software doesn’t carelessly access the</span></div>
<div style="position:absolute;left:216.00px;top:251.67px" class="cls_006"><span class="cls_006">same piece of data as two different integer types, endianness should create</span></div>
<div style="position:absolute;left:216.00px;top:262.67px" class="cls_006"><span class="cls_006">no problems. But as soon as the program needs to know how data is stored</span></div>
<div style="position:absolute;left:216.00px;top:273.67px" class="cls_006"><span class="cls_006">in memory, it is very important.</span></div>
<div style="position:absolute;left:216.00px;top:294.67px" class="cls_006"><span class="cls_006">Bitfield layout and endianness</span></div>
<div style="position:absolute;left:228.02px;top:305.67px" class="cls_006"><span class="cls_006">C permits programs to define bitfields in structures; as an example, the</span></div>
<div style="position:absolute;left:216.00px;top:316.67px" class="cls_006"><span class="cls_006">chapter on floating point used a bitfield structure to map the fields of an</span></div>
<div style="position:absolute;left:216.00px;top:327.67px" class="cls_006"><span class="cls_006">IEEE floating point value stored in memory. An FP single value is multi-</span></div>
<div style="position:absolute;left:216.00px;top:338.67px" class="cls_006"><span class="cls_006">byte, so this definition is expected to be endianness-dependent. It looked</span></div>
<div style="position:absolute;left:216.00px;top:349.67px" class="cls_006"><span class="cls_006">like this:</span></div>
<div style="position:absolute;left:252.00px;top:371.00px" class="cls_028"><span class="cls_028">struct ieee754sp_konst {</span></div>
<div style="position:absolute;left:257.40px;top:381.00px" class="cls_028"><span class="cls_028">unsignedsign:1;</span></div>
<div style="position:absolute;left:257.40px;top:390.99px" class="cls_028"><span class="cls_028">unsignedbexp:8;</span></div>
<div style="position:absolute;left:257.40px;top:400.99px" class="cls_028"><span class="cls_028">unsigned mant:23;</span></div>
<div style="position:absolute;left:252.00px;top:410.99px" class="cls_028"><span class="cls_028">};</span></div>
<div style="position:absolute;left:228.02px;top:430.67px" class="cls_006"><span class="cls_006">C bitfields are always packed, and the fields are therefore not padded</span></div>
<div style="position:absolute;left:216.00px;top:441.67px" class="cls_006"><span class="cls_006">out to yield any particular alignment. But bitfields may not, in fact, span</span></div>
<div style="position:absolute;left:216.00px;top:452.67px" class="cls_006"><span class="cls_006">‘‘word’’ boundaries (usually corresponding to the size of a </span><span class="cls_029">long</span><span class="cls_006">: 32 bits for</span></div>
<div style="position:absolute;left:216.00px;top:463.67px" class="cls_006"><span class="cls_006">the R30xx family). The structure and mapping for a big-endian CPU is</span></div>
<div style="position:absolute;left:216.00px;top:474.67px" class="cls_006"><span class="cls_006">shown in Figure 11.6, “Bitfields and big-endian” (using a typical big-</span></div>
<div style="position:absolute;left:216.00px;top:485.67px" class="cls_006"><span class="cls_006">endian’s picture); for a little-endian version it is shown in Figure 11.7,</span></div>
<div style="position:absolute;left:216.00px;top:496.67px" class="cls_006"><span class="cls_006">“Bitfields and little-endian”.</span></div>
<div style="position:absolute;left:220.00px;top:517.00px" class="cls_020"><span class="cls_020">bit no</span></div>
<div style="position:absolute;left:275.76px;top:517.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:319.58px;top:517.00px" class="cls_020"><span class="cls_020">30</span></div>
<div style="position:absolute;left:347.19px;top:517.00px" class="cls_020"><span class="cls_020">23</span></div>
<div style="position:absolute;left:409.59px;top:517.00px" class="cls_020"><span class="cls_020">22</span></div>
<div style="position:absolute;left:482.01px;top:517.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:275.64px;top:534.00px" class="cls_020"><span class="cls_020">sign</span></div>
<div style="position:absolute;left:319.48px;top:534.00px" class="cls_020"><span class="cls_020">bexp</span></div>
<div style="position:absolute;left:409.48px;top:534.00px" class="cls_020"><span class="cls_020">mant</span></div>
<div style="position:absolute;left:220.00px;top:551.00px" class="cls_020"><span class="cls_020">byte offset</span></div>
<div style="position:absolute;left:275.87px;top:551.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:347.21px;top:551.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:419.61px;top:551.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:481.99px;top:551.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:289.76px;top:570.00px" class="cls_020"><span class="cls_020">Figure 11.6.   Bitfields and big-endian</span></div>
<div style="position:absolute;left:228.02px;top:585.67px" class="cls_006"><span class="cls_006">The little-endian version of the structure defines the fields in the other</span></div>
<div style="position:absolute;left:216.00px;top:596.67px" class="cls_006"><span class="cls_006">direction; the C compiler insists that, even for bitfields, items declared first</span></div>
<div style="position:absolute;left:216.00px;top:607.67px" class="cls_006"><span class="cls_006">in the structure occupy lower addresses:</span></div>
<div style="position:absolute;left:228.02px;top:618.67px" class="cls_006"><span class="cls_006">To make that work, as shown in Figure 11.7, “Bitfields and little-endian”</span></div>
<div style="position:absolute;left:216.00px;top:629.67px" class="cls_006"><span class="cls_006">that in little-endian mode the compiler packs bits into structures starting</span></div>
<div style="position:absolute;left:216.00px;top:640.67px" class="cls_006"><span class="cls_006">from low-numbered bits.</span></div>
<div style="position:absolute;left:252.00px;top:662.00px" class="cls_028"><span class="cls_028">struct ieee754sp_konst {</span></div>
<div style="position:absolute;left:257.40px;top:672.00px" class="cls_028"><span class="cls_028">unsigned mant:23;</span></div>
<div style="position:absolute;left:257.40px;top:682.00px" class="cls_028"><span class="cls_028">unsignedbexp:8;</span></div>
<div style="position:absolute;left:257.40px;top:692.00px" class="cls_028"><span class="cls_028">unsignedsign:1;</span></div>
<div style="position:absolute;left:252.00px;top:702.00px" class="cls_028"><span class="cls_028">}</span><span class="cls_039">;</span></div>
<div style="position:absolute;left:303.54px;top:755.33px" class="cls_002"><span class="cls_002">11-9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:132330px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 11</span></div>
<div style="position:absolute;left:414.55px;top:28.00px" class="cls_002"><span class="cls_002">PORTABILITY CONSIDERATIONS</span></div>
<div style="position:absolute;left:40.00px;top:82.00px" class="cls_020"><span class="cls_020">byte offset</span></div>
<div style="position:absolute;left:95.86px;top:82.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:162.37px;top:82.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:228.88px;top:82.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:298.73px;top:82.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:95.64px;top:99.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:228.61px;top:99.00px" class="cls_020"><span class="cls_020">22</span></div>
<div style="position:absolute;left:267.59px;top:99.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:298.52px;top:99.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:95.64px;top:119.00px" class="cls_020"><span class="cls_020">mant</span></div>
<div style="position:absolute;left:267.60px;top:119.00px" class="cls_020"><span class="cls_020">bexp</span></div>
<div style="position:absolute;left:320.47px;top:119.00px" class="cls_020"><span class="cls_020">sign</span></div>
<div style="position:absolute;left:105.28px;top:138.00px" class="cls_020"><span class="cls_020">Figure 11.7.   Bitfields and little-endian</span></div>
<div style="position:absolute;left:36.00px;top:159.00px" class="cls_015"><span class="cls_015">Changing the endianness of a MIPS CPU</span></div>
<div style="position:absolute;left:48.02px;top:172.67px" class="cls_006"><span class="cls_006">Programming a board which can be configured with either byte ordering</span></div>
<div style="position:absolute;left:36.00px;top:183.67px" class="cls_006"><span class="cls_006">is tricky, but possible.</span></div>
<div style="position:absolute;left:48.02px;top:194.67px" class="cls_006"><span class="cls_006">The MIPS CPU doesn’t have to do too much to change endianness. The</span></div>
<div style="position:absolute;left:36.00px;top:205.67px" class="cls_006"><span class="cls_006">only parts of the instruction set which recognize objects smaller than 32</span></div>
<div style="position:absolute;left:36.00px;top:216.67px" class="cls_006"><span class="cls_006">bits are partial-word loads and stores. The instruction:</span></div>
<div style="position:absolute;left:108.00px;top:238.00px" class="cls_028"><span class="cls_028">lbu $t0, 1($zero)</span></div>
<div style="position:absolute;left:36.00px;top:258.67px" class="cls_006"><span class="cls_006">takes the byte at byte program address 1, loads it into the least-significant</span></div>
<div style="position:absolute;left:36.00px;top:269.67px" class="cls_006"><span class="cls_006">bits (0 through 7) of register </span><span class="cls_008">$t0,</span><span class="cls_006"> and fills the rest of the register with zero</span></div>
<div style="position:absolute;left:36.00px;top:280.67px" class="cls_006"><span class="cls_006">bits.</span></div>
<div style="position:absolute;left:48.02px;top:291.67px" class="cls_006"><span class="cls_006">This </span><span class="cls_008">description</span><span class="cls_006"> is endianness-independent; and the signals produced</span></div>
<div style="position:absolute;left:36.00px;top:302.67px" class="cls_006"><span class="cls_006">by the CPU are identical in the two cases - the address will be the</span></div>
<div style="position:absolute;left:36.00px;top:313.67px" class="cls_006"><span class="cls_006">appropriate translation of the program address ‘‘1’’, and the transfer-width</span></div>
<div style="position:absolute;left:36.00px;top:324.67px" class="cls_006"><span class="cls_006">code will indicate 1 byte. But: </span><span class="cls_008">in big-endian mode the data loaded into the</span></div>
<div style="position:absolute;left:36.00px;top:335.67px" class="cls_008"><span class="cls_008">register will be taken from bits 23-16 of the CPU data bus; in little-endian</span></div>
<div style="position:absolute;left:36.00px;top:346.67px" class="cls_008"><span class="cls_008">mode the byte is loaded from bits 8-15 of the CPU data bus.</span></div>
<div style="position:absolute;left:48.02px;top:357.67px" class="cls_006"><span class="cls_006">It is exactly this shift of byte-lane associated with a particular byte</span></div>
<div style="position:absolute;left:36.00px;top:368.67px" class="cls_006"><span class="cls_006">address, no more or less, which implements the endianness switch.</span></div>
<div style="position:absolute;left:48.02px;top:379.67px" class="cls_006"><span class="cls_006">The  default  effect  of  this  switch  on  a  system  built  for  the  other</span></div>
<div style="position:absolute;left:36.00px;top:390.67px" class="cls_006"><span class="cls_006">endianness is that the CPU’s view of byte addressing becomes scrambled</span></div>
<div style="position:absolute;left:36.00px;top:401.67px" class="cls_006"><span class="cls_006">with respect to the rest of the system; </span><span class="cls_008">but the CPU’s view of bit numbering</span></div>
<div style="position:absolute;left:36.01px;top:412.67px" class="cls_008"><span class="cls_008">within aligned 32-bit words continues to match the rest of the system. </span><span class="cls_006">This</span></div>
<div style="position:absolute;left:36.00px;top:423.67px" class="cls_006"><span class="cls_006">is the case described in (b) above; and it has some advantages.</span></div>
<div style="position:absolute;left:48.02px;top:434.67px" class="cls_006"><span class="cls_006">Complementing  the  chip’s  ability  to  reconfigure  itself,  most  MIPS</span></div>
<div style="position:absolute;left:36.00px;top:445.67px" class="cls_006"><span class="cls_006">compilers can produce code of either byte-ordering convention.</span></div>
<div style="position:absolute;left:36.00px;top:468.00px" class="cls_015"><span class="cls_015">Designing and specifying for configurable endianness</span></div>
<div style="position:absolute;left:48.02px;top:481.67px" class="cls_006"><span class="cls_006">Some hard thinking and good advice before the design is committed,</span></div>
<div style="position:absolute;left:36.00px;top:492.67px" class="cls_006"><span class="cls_006">may help a great deal. To summarize:</span></div>
<div style="position:absolute;left:48.02px;top:506.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Read-only instruction memory</span><span class="cls_006">: should be connected to the CPU with</span></div>
<div style="position:absolute;left:59.97px;top:517.67px" class="cls_006"><span class="cls_006">bit-number-preserving connections, regardless of configuration. Even</span></div>
<div style="position:absolute;left:59.97px;top:528.67px" class="cls_006"><span class="cls_006">if the ROM is less than 32 bits wide, the way in which ROM data is</span></div>
<div style="position:absolute;left:59.97px;top:539.67px" class="cls_006"><span class="cls_006">built into words should also be independent of the CPU configuration.</span></div>
<div style="position:absolute;left:48.02px;top:553.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> IO system or external world connection</span><span class="cls_006">: if the system makes any</span></div>
<div style="position:absolute;left:59.97px;top:564.67px" class="cls_006"><span class="cls_006">connection to a standard bus, or connects to a memory which gets</span></div>
<div style="position:absolute;left:59.97px;top:575.67px" class="cls_006"><span class="cls_006">filled by an agent other than the CPU, or uses a multibyte-wide DMA</span></div>
<div style="position:absolute;left:59.97px;top:586.67px" class="cls_006"><span class="cls_006">controller, then it may be appropriate to include a configurable byte-</span></div>
<div style="position:absolute;left:59.97px;top:597.67px" class="cls_006"><span class="cls_006">lane swapper between the CPU and IO.</span></div>
<div style="position:absolute;left:48.03px;top:611.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Local writable memory</span><span class="cls_006">: normally it is best to let this attach in a simple</span></div>
<div style="position:absolute;left:59.97px;top:622.67px" class="cls_006"><span class="cls_006">bit-number-preserving way to the CPU bus. If there is a byte-lane</span></div>
<div style="position:absolute;left:59.97px;top:633.67px" class="cls_006"><span class="cls_006">swapper in the system, it should also swap lanes between the IO</span></div>
<div style="position:absolute;left:59.97px;top:644.67px" class="cls_006"><span class="cls_006">system and the local memory.</span></div>
<div style="position:absolute;left:36.00px;top:665.67px" class="cls_006"><span class="cls_006">Read-only instruction memory</span></div>
<div style="position:absolute;left:48.02px;top:676.67px" class="cls_006"><span class="cls_006">All MIPS instructions are aligned 32-bit words. If a read-only program</span></div>
<div style="position:absolute;left:36.00px;top:687.67px" class="cls_006"><span class="cls_006">memory is attached to the CPU by bit-number-preserving connections</span></div>
<div style="position:absolute;left:36.00px;top:698.67px" class="cls_006"><span class="cls_006">which are unaltered between modes, then big-endian and little-endian</span></div>
<div style="position:absolute;left:36.00px;top:709.67px" class="cls_006"><span class="cls_006">CPUs run the same instruction set, bit for bit.</span></div>
<div style="position:absolute;left:287.55px;top:755.33px" class="cls_002"><span class="cls_002">11-10</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:133132px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">PORTABILITY CONSIDERATIONS</span></div>
<div style="position:absolute;left:520.56px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 11</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">The endianness mode shows up only when the CPU attempts a partial-</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">word operation; so a program written without partial-word operations will</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_006"><span class="cls_006">run the same in either mode. It is reasonably straightforward to build a</span></div>
<div style="position:absolute;left:216.00px;top:83.67px" class="cls_006"><span class="cls_006">PROM which could bootstrap the system in either mode.</span></div>
<div style="position:absolute;left:228.02px;top:94.67px" class="cls_006"><span class="cls_006">Algorithmics have used this to build enough ‘‘bi-directional’’ code to at</span></div>
<div style="position:absolute;left:216.00px;top:105.67px" class="cls_006"><span class="cls_006">least display an error message when the rest of the PROM program</span></div>
<div style="position:absolute;left:216.00px;top:116.67px" class="cls_006"><span class="cls_006">discovers that it mismatches the CPU configuration:</span></div>
<div style="position:absolute;left:288.00px;top:138.00px" class="cls_039"><span class="cls_039">.align 4</span></div>
<div style="position:absolute;left:288.00px;top:148.00px" class="cls_039"><span class="cls_039">.ascii "remEcneg\000\000\000y"</span></div>
<div style="position:absolute;left:216.00px;top:168.67px" class="cls_006"><span class="cls_006">that’s what the string "Emergency" (with its standard C terminating null</span></div>
<div style="position:absolute;left:216.00px;top:179.67px" class="cls_006"><span class="cls_006">and two bytes of essential padding) looks like when viewed with the wrong</span></div>
<div style="position:absolute;left:216.00px;top:190.67px" class="cls_006"><span class="cls_006">endianness. It would be even worse if it didn’t start on a 4-byte aligned</span></div>
<div style="position:absolute;left:216.00px;top:201.67px" class="cls_006"><span class="cls_006">location. Figure 11.8, “Garbled string storage when mixing modes” (drawn</span></div>
<div style="position:absolute;left:216.00px;top:212.67px" class="cls_006"><span class="cls_006">from the bit-orientated point of view of a confirmed big-endian) shows what</span></div>
<div style="position:absolute;left:216.00px;top:223.67px" class="cls_006"><span class="cls_006">is going on.</span></div>
<div style="position:absolute;left:383.03px;top:244.00px" class="cls_020"><span class="cls_020">31</span></div>
<div style="position:absolute;left:405.11px;top:244.00px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:427.18px;top:244.00px" class="cls_020"><span class="cls_020">23</span></div>
<div style="position:absolute;left:449.26px;top:244.00px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:471.34px;top:244.00px" class="cls_020"><span class="cls_020">15</span></div>
<div style="position:absolute;left:493.42px;top:244.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:509.91px;top:244.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:526.41px;top:244.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:383.03px;top:261.00px" class="cls_020"><span class="cls_020">’r’</span></div>
<div style="position:absolute;left:427.11px;top:261.00px" class="cls_020"><span class="cls_020">’e’</span></div>
<div style="position:absolute;left:471.20px;top:261.00px" class="cls_020"><span class="cls_020">’m’</span></div>
<div style="position:absolute;left:509.73px;top:261.00px" class="cls_020"><span class="cls_020">’E’</span></div>
<div style="position:absolute;left:257.52px;top:278.00px" class="cls_020"><span class="cls_020">byte address from BE CPU</span></div>
<div style="position:absolute;left:383.62px;top:278.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:427.69px;top:278.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:471.76px;top:278.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:510.26px;top:278.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:257.52px;top:295.00px" class="cls_020"><span class="cls_020">byte address from LE CPU</span></div>
<div style="position:absolute;left:383.58px;top:295.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:427.65px;top:295.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:471.73px;top:295.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:510.23px;top:295.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:383.03px;top:332.00px" class="cls_020"><span class="cls_020">’c’</span></div>
<div style="position:absolute;left:427.12px;top:332.00px" class="cls_020"><span class="cls_020">’n’</span></div>
<div style="position:absolute;left:471.21px;top:332.00px" class="cls_020"><span class="cls_020">’e’</span></div>
<div style="position:absolute;left:509.73px;top:332.00px" class="cls_020"><span class="cls_020">’g’</span></div>
<div style="position:absolute;left:257.52px;top:349.00px" class="cls_020"><span class="cls_020">byte address from BE CPU</span></div>
<div style="position:absolute;left:383.62px;top:349.00px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:427.69px;top:349.00px" class="cls_020"><span class="cls_020">5</span></div>
<div style="position:absolute;left:471.76px;top:349.00px" class="cls_020"><span class="cls_020">6</span></div>
<div style="position:absolute;left:510.26px;top:349.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:257.52px;top:366.00px" class="cls_020"><span class="cls_020">byte address from LE CPU</span></div>
<div style="position:absolute;left:383.58px;top:366.00px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:427.65px;top:366.00px" class="cls_020"><span class="cls_020">6</span></div>
<div style="position:absolute;left:471.73px;top:366.00px" class="cls_020"><span class="cls_020">5</span></div>
<div style="position:absolute;left:510.23px;top:366.00px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:383.03px;top:403.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:427.08px;top:403.00px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:471.13px;top:403.00px" class="cls_020"><span class="cls_020">’\000’</span></div>
<div style="position:absolute;left:509.72px;top:403.00px" class="cls_020"><span class="cls_020">’y’</span></div>
<div style="position:absolute;left:257.53px;top:420.00px" class="cls_020"><span class="cls_020">byte address from BE CPU</span></div>
<div style="position:absolute;left:383.63px;top:420.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:427.70px;top:420.00px" class="cls_020"><span class="cls_020">9</span></div>
<div style="position:absolute;left:471.77px;top:420.00px" class="cls_020"><span class="cls_020">10</span></div>
<div style="position:absolute;left:510.30px;top:420.00px" class="cls_020"><span class="cls_020">11</span></div>
<div style="position:absolute;left:257.53px;top:437.01px" class="cls_020"><span class="cls_020">byte address from LE CPU</span></div>
<div style="position:absolute;left:383.59px;top:437.01px" class="cls_020"><span class="cls_020">11</span></div>
<div style="position:absolute;left:427.69px;top:437.01px" class="cls_020"><span class="cls_020">10</span></div>
<div style="position:absolute;left:471.79px;top:437.01px" class="cls_020"><span class="cls_020">9</span></div>
<div style="position:absolute;left:510.29px;top:437.01px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:263.58px;top:456.00px" class="cls_020"><span class="cls_020">Figure 11.8.   Garbled string storage when mixing modes</span></div>
<div style="position:absolute;left:216.00px;top:475.67px" class="cls_006"><span class="cls_006">Writable (volatile) memory</span></div>
<div style="position:absolute;left:228.02px;top:486.67px" class="cls_006"><span class="cls_006">The above applies to any program memory; but the system may want to</span></div>
<div style="position:absolute;left:216.00px;top:497.67px" class="cls_006"><span class="cls_006">treat volatile program memory differently. Why?</span></div>
<div style="position:absolute;left:228.02px;top:508.67px" class="cls_006"><span class="cls_006">Volatile program memory must be loaded at run-time. Most loading</span></div>
<div style="position:absolute;left:216.00px;top:519.67px" class="cls_006"><span class="cls_006">processes ultimately involve fetching instructions from a file, and most</span></div>
<div style="position:absolute;left:216.00px;top:530.67px" class="cls_006"><span class="cls_006">files are defined as byte sequences. Thus the 32-bit instruction words</span></div>
<div style="position:absolute;left:216.00px;top:541.67px" class="cls_006"><span class="cls_006">must be constructed (one way or the other) from byte sequences. The</span></div>
<div style="position:absolute;left:216.00px;top:552.67px" class="cls_006"><span class="cls_006">standard way of storing code in files </span><span class="cls_008">does</span><span class="cls_006"> change between the two options:</span></div>
<div style="position:absolute;left:215.99px;top:563.67px" class="cls_006"><span class="cls_006">big-endian code is stored with the most significant byte of each instruction</span></div>
<div style="position:absolute;left:215.99px;top:574.67px" class="cls_006"><span class="cls_006">first, and little endian code with the least significant byte first.</span></div>
<div style="position:absolute;left:215.99px;top:595.67px" class="cls_006"><span class="cls_006">Byte-lane swapping</span></div>
<div style="position:absolute;left:228.01px;top:606.67px" class="cls_006"><span class="cls_006">It may happen that somewhere in the system there is a bus or device</span></div>
<div style="position:absolute;left:215.99px;top:617.67px" class="cls_006"><span class="cls_006">whose byte-order doesn’t change when the CPU’s does. The best solution</span></div>
<div style="position:absolute;left:215.99px;top:628.67px" class="cls_006"><span class="cls_006">(from a software engineer’s perspective), is to persuade the hardware</span></div>
<div style="position:absolute;left:215.99px;top:639.67px" class="cls_006"><span class="cls_006">designer to put a programmable byte-lane swapper between the CPU and</span></div>
<div style="position:absolute;left:215.99px;top:650.67px" class="cls_006"><span class="cls_006">the IO system. The way this works is shown diagrammatically in Figure</span></div>
<div style="position:absolute;left:215.99px;top:661.67px" class="cls_006"><span class="cls_006">11.9, “Byte-lane swapper”.</span></div>
<div style="position:absolute;left:228.01px;top:672.67px" class="cls_006"><span class="cls_006">This is referred to as a byte-lane swapper, not a byte-swapper, to</span></div>
<div style="position:absolute;left:215.99px;top:683.67px" class="cls_006"><span class="cls_006">emphasize that it does not discriminate on a per-transfer basis, and in</span></div>
<div style="position:absolute;left:215.99px;top:694.67px" class="cls_006"><span class="cls_006">particular it is not switched on and off for transfers of different sizes. Such</span></div>
<div style="position:absolute;left:215.99px;top:705.67px" class="cls_006"><span class="cls_006">discrimination  would  be  futile;  the  hardware  transfer  size  does  not</span></div>
<div style="position:absolute;left:301.30px;top:755.34px" class="cls_002"><span class="cls_002">11-11</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:133934px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 11</span></div>
<div style="position:absolute;left:414.55px;top:28.00px" class="cls_002"><span class="cls_002">PORTABILITY CONSIDERATIONS</span></div>
<div style="position:absolute;left:36.00px;top:50.67px" class="cls_006"><span class="cls_006">consistently reflect the way in which software is interpreting data (for</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_006"><span class="cls_006">example, cache-line refills may contain byte values). </span><span class="cls_008">There is no external</span></div>
<div style="position:absolute;left:36.00px;top:72.67px" class="cls_008"><span class="cls_008">hardware mechanism which can hide endianness problems.</span></div>
<div style="position:absolute;left:48.02px;top:83.67px" class="cls_006"><span class="cls_006">What a byte-lane swapper </span><span class="cls_008">does</span><span class="cls_006"> achieve is to ensure that, when the CPU</span></div>
<div style="position:absolute;left:35.99px;top:94.67px" class="cls_006"><span class="cls_006">configuration is changed, the relationship between the CPU and the now</span></div>
<div style="position:absolute;left:35.99px;top:105.67px" class="cls_006"><span class="cls_006">non-matching external bus or device is one where byte sequence is</span></div>
<div style="position:absolute;left:35.99px;top:116.67px" class="cls_006"><span class="cls_006">preserved.</span></div>
<div style="position:absolute;left:93.98px;top:142.97px" class="cls_045"><span class="cls_045">MIPS CPU</span></div>
<div style="position:absolute;left:290.22px;top:142.97px" class="cls_045"><span class="cls_045">MIPS CPU</span></div>
<div style="position:absolute;left:84.97px;top:154.32px" class="cls_045"><span class="cls_045">(little -endian)</span></div>
<div style="position:absolute;left:285.21px;top:154.32px" class="cls_045"><span class="cls_045">(big-endian)</span></div>
<div style="position:absolute;left:62.18px;top:170.00px" class="cls_045"><span class="cls_045">"U"    "N"</span></div>
<div style="position:absolute;left:128.72px;top:170.00px" class="cls_045"><span class="cls_045">"I"</span></div>
<div style="position:absolute;left:159.15px;top:170.00px" class="cls_045"><span class="cls_045">"X"</span></div>
<div style="position:absolute;left:254.42px;top:170.00px" class="cls_045"><span class="cls_045">"X"</span></div>
<div style="position:absolute;left:288.19px;top:170.00px" class="cls_045"><span class="cls_045">"I"</span></div>
<div style="position:absolute;left:317.95px;top:170.00px" class="cls_045"><span class="cls_045">"N"    "U"</span></div>
<div style="position:absolute;left:61.93px;top:189.36px" class="cls_046"><span class="cls_046">0-7</span></div>
<div style="position:absolute;left:91.30px;top:189.36px" class="cls_046"><span class="cls_046">8-15</span></div>
<div style="position:absolute;left:120.67px;top:189.36px" class="cls_046"><span class="cls_046">16-23</span></div>
<div style="position:absolute;left:152.71px;top:189.36px" class="cls_046"><span class="cls_046">24-31</span></div>
<div style="position:absolute;left:254.18px;top:189.36px" class="cls_046"><span class="cls_046">0-7</span></div>
<div style="position:absolute;left:283.55px;top:189.36px" class="cls_046"><span class="cls_046">8-15</span></div>
<div style="position:absolute;left:312.92px;top:189.36px" class="cls_046"><span class="cls_046">16-23</span></div>
<div style="position:absolute;left:344.96px;top:189.36px" class="cls_046"><span class="cls_046">24-31</span></div>
<div style="position:absolute;left:164.43px;top:360.26px" class="cls_046"><span class="cls_046">0</span></div>
<div style="position:absolute;left:196.53px;top:360.26px" class="cls_046"><span class="cls_046">1</span></div>
<div style="position:absolute;left:228.63px;top:360.26px" class="cls_046"><span class="cls_046">2</span></div>
<div style="position:absolute;left:260.73px;top:360.26px" class="cls_046"><span class="cls_046">3</span></div>
<div style="position:absolute;left:142.37px;top:378.29px" class="cls_046"><span class="cls_046">0</span></div>
<div style="position:absolute;left:158.75px;top:378.28px" class="cls_045"><span class="cls_045">"U"</span></div>
<div style="position:absolute;left:190.86px;top:378.28px" class="cls_045"><span class="cls_045">"N"</span></div>
<div style="position:absolute;left:225.30px;top:378.28px" class="cls_045"><span class="cls_045">"I"</span></div>
<div style="position:absolute;left:255.72px;top:378.28px" class="cls_045"><span class="cls_045">"X"</span></div>
<div style="position:absolute;left:142.37px;top:402.32px" class="cls_046"><span class="cls_046">4</span></div>
<div style="position:absolute;left:142.37px;top:434.37px" class="cls_046"><span class="cls_046">8</span></div>
<div style="position:absolute;left:140.67px;top:465.25px" class="cls_020"><span class="cls_020">Figure 11.9.   Byte-lane swapper</span></div>
<div style="position:absolute;left:48.02px;top:475.92px" class="cls_006"><span class="cls_006">When the system includes a byte-lane swapper between the CPU and</span></div>
<div style="position:absolute;left:36.00px;top:486.92px" class="cls_006"><span class="cls_006">some memory, it is probably not viable to swap it when using cached</span></div>
<div style="position:absolute;left:36.00px;top:497.92px" class="cls_006"><span class="cls_006">memory. It really can be used only:</span></div>
<div style="position:absolute;left:59.98px;top:511.91px" class="cls_006"><span class="cls_006">a)    at system configuration time;</span></div>
<div style="position:absolute;left:59.98px;top:525.91px" class="cls_006"><span class="cls_006">b)   when talking to uncached, IO system locations. The system</span></div>
<div style="position:absolute;left:84.03px;top:536.91px" class="cls_006"><span class="cls_006">could discriminate (to swap or not to swap) based on the address</span></div>
<div style="position:absolute;left:84.03px;top:547.91px" class="cls_006"><span class="cls_006">regions which select various sub-buses or sub-devices.</span></div>
<div style="position:absolute;left:48.03px;top:558.91px" class="cls_006"><span class="cls_006">The system doesn’t normally need to put the byte-lane swapper between</span></div>
<div style="position:absolute;left:36.01px;top:569.91px" class="cls_006"><span class="cls_006">the CPU and its local memory; avoiding the use of one in this path is</span></div>
<div style="position:absolute;left:36.01px;top:580.91px" class="cls_006"><span class="cls_006">desirable, because the CPU/local memory connection is fast and wide, so</span></div>
<div style="position:absolute;left:36.01px;top:591.91px" class="cls_006"><span class="cls_006">the  swapper  will  be  expensive.  Since  the  swapper  configuration  is</span></div>
<div style="position:absolute;left:36.01px;top:602.91px" class="cls_006"><span class="cls_006">determined at reset time, and the memory is then completely undefined,</span></div>
<div style="position:absolute;left:36.01px;top:613.91px" class="cls_006"><span class="cls_006">the system can treat the CPU/local memory as a unit; the swapper is</span></div>
<div style="position:absolute;left:36.01px;top:624.91px" class="cls_006"><span class="cls_006">installed between the CPU/memory unit and the rest of the system. In this</span></div>
<div style="position:absolute;left:36.01px;top:635.91px" class="cls_006"><span class="cls_006">case the relationship between bit number and byte order in the local</span></div>
<div style="position:absolute;left:36.01px;top:646.91px" class="cls_006"><span class="cls_006">memory changes with the CPU, but this fact is concealed from the rest of</span></div>
<div style="position:absolute;left:36.01px;top:657.91px" class="cls_006"><span class="cls_006">the world.</span></div>
<div style="position:absolute;left:36.01px;top:678.91px" class="cls_006"><span class="cls_006">Configurable IO controllers</span></div>
<div style="position:absolute;left:48.03px;top:689.91px" class="cls_006"><span class="cls_006">Some newer IO controllers can themselves be configured into big-endian</span></div>
<div style="position:absolute;left:36.01px;top:700.91px" class="cls_006"><span class="cls_006">and little-endian modes. Use of such devices must be done carefully,</span></div>
<div style="position:absolute;left:36.01px;top:711.91px" class="cls_006"><span class="cls_006">particularly when using it not as a static (design-time) option but rather a</span></div>
<div style="position:absolute;left:36.01px;top:722.91px" class="cls_006"><span class="cls_006">jumper (reset-time) option.</span></div>
<div style="position:absolute;left:287.55px;top:755.34px" class="cls_002"><span class="cls_002">11-12</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:134736px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">PORTABILITY CONSIDERATIONS</span></div>
<div style="position:absolute;left:520.56px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 11</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">It is quite common for such a feature to affect only data transfers,</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">leaving the programmer to handle other endianness issues, such as access</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_006"><span class="cls_006">to bit-coded device registers.</span></div>
<div style="position:absolute;left:216.00px;top:95.00px" class="cls_015"><span class="cls_015">Portability and endianness-independent code</span></div>
<div style="position:absolute;left:228.02px;top:108.67px" class="cls_006"><span class="cls_006">Any code which exposes data to two different views will be endianness-</span></div>
<div style="position:absolute;left:216.00px;top:119.67px" class="cls_006"><span class="cls_006">dependent (and likely to be architecture- and compiler-dependent too).</span></div>
<div style="position:absolute;left:216.00px;top:130.67px" class="cls_006"><span class="cls_006">Many MIPS compilers define the symbol ‘‘BYTE_ORDER’’ so programmers</span></div>
<div style="position:absolute;left:216.00px;top:141.67px" class="cls_006"><span class="cls_006">can include endianness dependent code, such as:</span></div>
<div style="position:absolute;left:252.00px;top:163.00px" class="cls_028"><span class="cls_028">#if BYTE_ORDER == BIG_ENDIAN</span></div>
<div style="position:absolute;left:252.00px;top:173.00px" class="cls_028"><span class="cls_028">/* big-endian version... /</span></div>
<div style="position:absolute;left:252.00px;top:183.00px" class="cls_028"><span class="cls_028">#else</span></div>
<div style="position:absolute;left:252.00px;top:193.00px" class="cls_028"><span class="cls_028">/* little-endian version... */</span></div>
<div style="position:absolute;left:252.00px;top:203.00px" class="cls_028"><span class="cls_028">#endif</span></div>
<div style="position:absolute;left:228.02px;top:222.67px" class="cls_006"><span class="cls_006">With ingenuity and patience the programmer can probably represent the</span></div>
<div style="position:absolute;left:216.00px;top:233.67px" class="cls_006"><span class="cls_006">difference with common code but conditional data declarations; that</span></div>
<div style="position:absolute;left:216.00px;top:244.67px" class="cls_006"><span class="cls_006">should be more maintainable. However, endianness-independent code</span></div>
<div style="position:absolute;left:216.00px;top:255.67px" class="cls_006"><span class="cls_006">should be used wherever possible.</span></div>
<div style="position:absolute;left:216.00px;top:276.67px" class="cls_006"><span class="cls_006">Endianness-independent code</span></div>
<div style="position:absolute;left:228.02px;top:287.67px" class="cls_006"><span class="cls_006">All data references which pick up data from an ‘‘external’’ source or</span></div>
<div style="position:absolute;left:216.00px;top:298.67px" class="cls_006"><span class="cls_006">device are potentially endianness-dependent. But according to how the</span></div>
<div style="position:absolute;left:216.00px;top:309.67px" class="cls_006"><span class="cls_006">system is wired, software may be able to work both ways:</span></div>
<div style="position:absolute;left:228.02px;top:323.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> If  the  device  is  byte-sequence  compatible</span><span class="cls_006">:   then   it   should   be</span></div>
<div style="position:absolute;left:239.97px;top:334.67px" class="cls_006"><span class="cls_006">programmed strictly with byte operations.</span></div>
<div style="position:absolute;left:239.97px;top:348.67px" class="cls_006"><span class="cls_006">If ever, for reasons of efficiency or necessity, the system must transfer</span></div>
<div style="position:absolute;left:239.97px;top:359.67px" class="cls_006"><span class="cls_006">more than one byte at a time, the programmer must figure out how</span></div>
<div style="position:absolute;left:239.97px;top:370.67px" class="cls_006"><span class="cls_006">those bytes should pack in to a machine word. This code will be</span></div>
<div style="position:absolute;left:239.97px;top:381.67px" class="cls_006"><span class="cls_006">explicitly endianness-dependent, and can be made conditional.</span></div>
<div style="position:absolute;left:228.02px;top:395.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> If the device is bit-number compatible</span><span class="cls_006">: then program it strictly with</span></div>
<div style="position:absolute;left:239.97px;top:406.67px" class="cls_006"><span class="cls_006">word (32-bit) operations. This may well mean that device data comes</span></div>
<div style="position:absolute;left:239.97px;top:417.67px" class="cls_006"><span class="cls_006">and goes into slightly inconvenient parts of a CPU register; 8-bit</span></div>
<div style="position:absolute;left:239.97px;top:428.67px" class="cls_006"><span class="cls_006">registers in system originally conceived as big-endian are commonly</span></div>
<div style="position:absolute;left:239.97px;top:439.67px" class="cls_006"><span class="cls_006">wired via bits 31-24. So software may need to shift them up and down</span></div>
<div style="position:absolute;left:239.97px;top:450.67px" class="cls_006"><span class="cls_006">appropriately.</span></div>
<div style="position:absolute;left:216.00px;top:473.00px" class="cls_015"><span class="cls_015">COMPATIBILITY WITHIN THE R30XX FAMILY</span></div>
<div style="position:absolute;left:228.02px;top:486.67px" class="cls_006"><span class="cls_006">It  should  be  relatively  straightforward  to  make  R30xx  programs</span></div>
<div style="position:absolute;left:216.00px;top:497.67px" class="cls_006"><span class="cls_006">compatible across the entire R30xx family. The device user’s manuals</span></div>
<div style="position:absolute;left:216.00px;top:508.67px" class="cls_006"><span class="cls_006">detail potential areas of incompatibility, most of which can easily be</span></div>
<div style="position:absolute;left:216.00px;top:519.67px" class="cls_006"><span class="cls_006">accommodated by software†. The software-visible differences in these</span></div>
<div style="position:absolute;left:216.00px;top:530.67px" class="cls_006"><span class="cls_006">CPUs are as follows:</span></div>
<div style="position:absolute;left:228.02px;top:544.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Cache size</span><span class="cls_006">: all CPUs have separate I- and D-caches each of between</span></div>
<div style="position:absolute;left:239.97px;top:555.67px" class="cls_006"><span class="cls_006">512 bytes and 16Kbytes. All D-caches are write-through, so the only</span></div>
<div style="position:absolute;left:239.97px;top:566.67px" class="cls_006"><span class="cls_006">cache maintenance operation required is that of invalidating an entry.</span></div>
<div style="position:absolute;left:239.97px;top:577.67px" class="cls_006"><span class="cls_006">The cache management software uses the same basic code sequences</span></div>
<div style="position:absolute;left:239.97px;top:588.67px" class="cls_006"><span class="cls_006">for all family members (which follows the original R3000), using</span></div>
<div style="position:absolute;left:239.97px;top:599.67px" class="cls_006"><span class="cls_006">status-register control bits to ‘‘isolate’’ and ‘‘swap’’ the caches.</span></div>
<div style="position:absolute;left:239.97px;top:613.67px" class="cls_006"><span class="cls_006">To maximize portability, system software should measure the cache</span></div>
<div style="position:absolute;left:239.97px;top:624.67px" class="cls_006"><span class="cls_006">size at system initialization, as described earlier. Do not rely on the</span></div>
<div style="position:absolute;left:239.97px;top:635.67px" class="cls_006"><span class="cls_006">CPU type and revision fields in the ID register.</span></div>
<div style="position:absolute;left:234.00px;top:686.67px" class="cls_006"><span class="cls_006">† Perhaps the most notable exception has to do with the TLB.</span></div>
<div style="position:absolute;left:234.00px;top:698.67px" class="cls_006"><span class="cls_006">Software environments which utilize kuseg and/or kseg2 will</span></div>
<div style="position:absolute;left:234.00px;top:710.67px" class="cls_006"><span class="cls_006">probably not be able to substitute “E” and base-versions for each</span></div>
<div style="position:absolute;left:234.00px;top:722.67px" class="cls_006"><span class="cls_006">other.</span></div>
<div style="position:absolute;left:301.30px;top:755.34px" class="cls_002"><span class="cls_002">11-13</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:135538px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 11</span></div>
<div style="position:absolute;left:414.55px;top:28.00px" class="cls_002"><span class="cls_002">PORTABILITY CONSIDERATIONS</span></div>
<div style="position:absolute;left:59.98px;top:50.67px" class="cls_006"><span class="cls_006">To simplify porting to other MIPS devices, such as the IDT R4600,</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">software should probably structure cache invalidation software as</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">using a single entry point. Thus, when porting to these upscale</span></div>
<div style="position:absolute;left:59.98px;top:83.67px" class="cls_006"><span class="cls_006">devices, the amount of software to change is minimized.</span></div>
<div style="position:absolute;left:48.03px;top:97.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:97.67px" class="cls_008"><span class="cls_008">Cache line size</span><span class="cls_006">: All caches are direct mapped. The D-cache always has</span></div>
<div style="position:absolute;left:59.98px;top:108.67px" class="cls_006"><span class="cls_006">a line size of one word, and all I-caches have a 4-word line size. The</span></div>
<div style="position:absolute;left:59.98px;top:119.67px" class="cls_006"><span class="cls_006">4-word  line  size  does  offer  the  potential  for  a  faster  I-cache</span></div>
<div style="position:absolute;left:59.98px;top:130.67px" class="cls_006"><span class="cls_006">invalidation routine; but invalidating each word of a region still works</span></div>
<div style="position:absolute;left:59.98px;top:141.67px" class="cls_006"><span class="cls_006">correctly with a 4-word line.</span></div>
<div style="position:absolute;left:48.03px;top:155.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:155.67px" class="cls_008"><span class="cls_008">Cache-hit write policy</span><span class="cls_006">: All of these CPU’s will use a read-modify-write</span></div>
<div style="position:absolute;left:59.98px;top:166.67px" class="cls_006"><span class="cls_006">sequence when performing a partial-word write to a location already</span></div>
<div style="position:absolute;left:59.98px;top:177.67px" class="cls_006"><span class="cls_006">present in the D-cache. This can lead to some curious problems if</span></div>
<div style="position:absolute;left:59.98px;top:188.67px" class="cls_006"><span class="cls_006">another memory master is simultaneously accessing the same word;</span></div>
<div style="position:absolute;left:59.98px;top:199.67px" class="cls_006"><span class="cls_006">all software should assume that the read-modify-write sequence</span></div>
<div style="position:absolute;left:59.98px;top:210.67px" class="cls_006"><span class="cls_006">might occur.</span></div>
<div style="position:absolute;left:48.03px;top:224.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:224.67px" class="cls_008"><span class="cls_008">Write buffer differences and </span><span class="cls_029">wbflush()</span><span class="cls_006">: To make the write-through</span></div>
<div style="position:absolute;left:59.97px;top:235.67px" class="cls_006"><span class="cls_006">cache efficient, all R30xx CPUs have a four deep write buffer, which</span></div>
<div style="position:absolute;left:59.97px;top:246.67px" class="cls_006"><span class="cls_006">holds the address/data of a write while the CPU runs on. The</span></div>
<div style="position:absolute;left:59.97px;top:257.67px" class="cls_006"><span class="cls_006">operation of the write buffer should be invisible when writing and</span></div>
<div style="position:absolute;left:59.97px;top:268.67px" class="cls_006"><span class="cls_006">reading regular, side-effect free memory; but it can have effects when</span></div>
<div style="position:absolute;left:59.97px;top:279.67px" class="cls_006"><span class="cls_006">accessing IO buffers.</span></div>
<div style="position:absolute;left:59.97px;top:293.67px" class="cls_006"><span class="cls_006">The programmer only needs an implementation of </span><span class="cls_029">  wbflush()</span><span class="cls_006">; a</span></div>
<div style="position:absolute;left:59.97px;top:304.67px" class="cls_006"><span class="cls_006">routine defined to hold the CPU in a loop until all pending writes have</span></div>
<div style="position:absolute;left:59.97px;top:315.67px" class="cls_006"><span class="cls_006">been completed. In the R30xx family, wbflush() can be implemented</span></div>
<div style="position:absolute;left:59.97px;top:326.67px" class="cls_006"><span class="cls_006">by performing an uncached read (for example, to the reset exception</span></div>
<div style="position:absolute;left:59.97px;top:337.67px" class="cls_006"><span class="cls_006">vector location, since the programmer is assured that the system will</span></div>
<div style="position:absolute;left:59.97px;top:348.67px" class="cls_006"><span class="cls_006">provide uncached memory at that location).</span></div>
<div style="position:absolute;left:59.97px;top:362.67px" class="cls_006"><span class="cls_006">In other devices, such as the R4600, a different wbflush() may be</span></div>
<div style="position:absolute;left:59.97px;top:373.67px" class="cls_006"><span class="cls_006">required. However, by isolating this code into a single routine, porting</span></div>
<div style="position:absolute;left:59.97px;top:384.67px" class="cls_006"><span class="cls_006">to the R4600 is simplified.</span></div>
<div style="position:absolute;left:48.02px;top:398.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:398.67px" class="cls_008"><span class="cls_008">FP hardware</span><span class="cls_006">: Currently, only the R3081 integrates the hardware FPA</span></div>
<div style="position:absolute;left:59.97px;top:409.67px" class="cls_006"><span class="cls_006">on-chip. For occasional FP instruction trap-based software emulators</span></div>
<div style="position:absolute;left:59.97px;top:420.67px" class="cls_006"><span class="cls_006">may be appropriate; the use of the emulator can be completely</span></div>
<div style="position:absolute;left:59.97px;top:431.67px" class="cls_006"><span class="cls_006">software-transparent. But for any serious use the emulator will be far</span></div>
<div style="position:absolute;left:59.97px;top:442.67px" class="cls_006"><span class="cls_006">too slow.</span></div>
<div style="position:absolute;left:48.02px;top:456.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:456.67px" class="cls_008"><span class="cls_008">MMU hardware</span><span class="cls_006">: If present, it is always the same software-refilled TLB</span></div>
<div style="position:absolute;left:59.97px;top:467.67px" class="cls_006"><span class="cls_006">and control set, as described above. Base versions provide consistent</span></div>
<div style="position:absolute;left:59.97px;top:478.67px" class="cls_006"><span class="cls_006">mappings for kuseg and kseg2; however, maximum portability is</span></div>
<div style="position:absolute;left:59.97px;top:489.67px" class="cls_006"><span class="cls_006">achieved when programs only use the </span><span class="cls_008">kseg0</span><span class="cls_006">, </span><span class="cls_008">kseg1</span><span class="cls_006"> regions which are</span></div>
<div style="position:absolute;left:59.97px;top:500.67px" class="cls_006"><span class="cls_006">supported by all processors (including the R4600).</span></div>
<div style="position:absolute;left:48.02px;top:514.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:514.67px" class="cls_008"><span class="cls_008">Integrated IO devices</span><span class="cls_006">: Some future CPUs may integrate timers, DRAM</span></div>
<div style="position:absolute;left:59.97px;top:525.67px" class="cls_006"><span class="cls_006">controllers,  DMA  and  other  memory-mapped  peripherals.  If  the</span></div>
<div style="position:absolute;left:59.97px;top:536.67px" class="cls_006"><span class="cls_006">programmer isolates such code into ‘‘driver’’ modules for existing</span></div>
<div style="position:absolute;left:59.97px;top:547.67px" class="cls_006"><span class="cls_006">systems, porting to these devices will be simplified.</span></div>
<div style="position:absolute;left:48.02px;top:561.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:561.67px" class="cls_008"><span class="cls_008">Perform device-type identification at boot-time</span><span class="cls_006">:  The  reset  chapter</span></div>
<div style="position:absolute;left:59.97px;top:572.67px" class="cls_006"><span class="cls_006">discussed how to identify the particular CPU being used at reset time.</span></div>
<div style="position:absolute;left:59.97px;top:583.67px" class="cls_006"><span class="cls_006">Performing device identification allows the software to then branch to</span></div>
<div style="position:absolute;left:59.97px;top:594.67px" class="cls_006"><span class="cls_006">the appropriate device specific initialization code (e.g. to initialize the</span></div>
<div style="position:absolute;left:59.97px;top:605.67px" class="cls_006"><span class="cls_006">R3041 control registers, or CP1 usability for the R3081). Providing</span></div>
<div style="position:absolute;left:59.97px;top:616.67px" class="cls_006"><span class="cls_006">this basic structure as part of reset only enables software to be</span></div>
<div style="position:absolute;left:59.97px;top:627.67px" class="cls_006"><span class="cls_006">quickly adapted to support other family members.</span></div>
<div style="position:absolute;left:48.02px;top:641.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.97px;top:641.67px" class="cls_008"><span class="cls_008">Isolate CP0 code from applications code.</span><span class="cls_006"> The MIPS architecture allows</span></div>
<div style="position:absolute;left:59.97px;top:652.67px" class="cls_006"><span class="cls_006">CP0 to vary by implementation. By writing the code modularly, so that</span></div>
<div style="position:absolute;left:59.97px;top:663.67px" class="cls_006"><span class="cls_006">system and exception management functions are modularized out of</span></div>
<div style="position:absolute;left:59.97px;top:674.67px" class="cls_006"><span class="cls_006">the application code, porting to new generations of processors is</span></div>
<div style="position:absolute;left:59.97px;top:685.67px" class="cls_006"><span class="cls_006">simplified (e.g. the R4600, which uses a slightly different exception</span></div>
<div style="position:absolute;left:59.97px;top:696.67px" class="cls_006"><span class="cls_006">state management mechanism and slightly different vectors, but is</span></div>
<div style="position:absolute;left:59.97px;top:707.67px" class="cls_006"><span class="cls_006">otherwise very familiar to an R30xx programmer).</span></div>
<div style="position:absolute;left:287.55px;top:755.34px" class="cls_002"><span class="cls_002">11-14</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:136340px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">PORTABILITY CONSIDERATIONS</span></div>
<div style="position:absolute;left:520.56px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 11</span></div>
<div style="position:absolute;left:216.00px;top:50.00px" class="cls_015"><span class="cls_015">PORTING TO MIPS: FREQUENTLY ENCOUNTERED ISSUES</span></div>
<div style="position:absolute;left:228.02px;top:63.67px" class="cls_006"><span class="cls_006">The following issues have come up fairly frequently:</span></div>
<div style="position:absolute;left:228.02px;top:77.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:77.67px" class="cls_008"><span class="cls_008">Moving from 16-bit int</span><span class="cls_006">: a significant number of programs are being</span></div>
<div style="position:absolute;left:239.97px;top:88.67px" class="cls_006"><span class="cls_006">moved up from x86 or other CPUs whose standard mode is 16-bit, so</span></div>
<div style="position:absolute;left:239.97px;top:99.67px" class="cls_006"><span class="cls_006">that the C </span><span class="cls_008">int</span><span class="cls_006"> is a 16-bit value. Such programs may rely, very subtly,</span></div>
<div style="position:absolute;left:239.96px;top:110.67px" class="cls_006"><span class="cls_006">on the limited size and overflow characteristics of 16-bit values. While</span></div>
<div style="position:absolute;left:239.96px;top:121.67px" class="cls_006"><span class="cls_006">the programmer can get correct operation by translating such types</span></div>
<div style="position:absolute;left:239.96px;top:132.67px" class="cls_006"><span class="cls_006">into </span><span class="cls_029">short</span><span class="cls_006">, this may be very inefficient. Take particular care with</span></div>
<div style="position:absolute;left:239.96px;top:143.67px" class="cls_006"><span class="cls_006">signed comparisons.</span></div>
<div style="position:absolute;left:228.01px;top:157.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.96px;top:157.67px" class="cls_008"><span class="cls_008">Negative pointers</span><span class="cls_006">: when running in unmapped mode on a MIPS CPU</span></div>
<div style="position:absolute;left:239.96px;top:168.67px" class="cls_006"><span class="cls_006">all pointers are in the </span><span class="cls_008">kseg0</span><span class="cls_006"> or </span><span class="cls_008">kseg1</span><span class="cls_006"> areas; and both use pointers</span></div>
<div style="position:absolute;left:239.96px;top:179.67px" class="cls_006"><span class="cls_006">whose 32-bit value has the top bit set. It is therefore extremely</span></div>
<div style="position:absolute;left:239.96px;top:190.67px" class="cls_006"><span class="cls_006">important that any implicit aliasing of integer and pointer types (quite</span></div>
<div style="position:absolute;left:239.96px;top:201.67px" class="cls_006"><span class="cls_006">common  in  C)  specify  an  unsigned  integer  type</span></div>
<div style="position:absolute;left:504.44px;top:201.67px" class="cls_006"><span class="cls_006">(preferably  an</span></div>
<div style="position:absolute;left:239.96px;top:212.67px" class="cls_008"><span class="cls_008">unsigned long</span><span class="cls_006">).</span></div>
<div style="position:absolute;left:239.96px;top:226.67px" class="cls_006"><span class="cls_006">Unmapped  programs  on  certain  other  architectures  deal  with</span></div>
<div style="position:absolute;left:239.96px;top:237.67px" class="cls_006"><span class="cls_006">physical addresses, which are invariably a lot smaller than 2GB.</span></div>
<div style="position:absolute;left:228.01px;top:251.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.96px;top:251.67px" class="cls_008"><span class="cls_008">Signed vs. unsigned characters</span><span class="cls_006">: K&R C made the default </span><span class="cls_008">char</span><span class="cls_006"> type</span></div>
<div style="position:absolute;left:239.97px;top:262.67px" class="cls_006"><span class="cls_006">(used for strings, and so on)</span><span class="cls_029">signed char</span><span class="cls_006">; this is consistent with the</span></div>
<div style="position:absolute;left:239.97px;top:273.67px" class="cls_006"><span class="cls_006">convention   for   larger   integer   values.   However,   as   soon   as</span></div>
<div style="position:absolute;left:239.97px;top:284.67px" class="cls_006"><span class="cls_006">programmers have to deal with character encodings using more than</span></div>
<div style="position:absolute;left:239.97px;top:295.67px" class="cls_006"><span class="cls_006">7-bit values, this is dangerous when converting or comparing. So the</span></div>
<div style="position:absolute;left:239.97px;top:306.67px" class="cls_006"><span class="cls_006">ANSI standard determines that </span><span class="cls_008">char</span><span class="cls_006"> declarations should, by default,</span></div>
<div style="position:absolute;left:239.97px;top:317.67px" class="cls_006"><span class="cls_006">be </span><span class="cls_008">unsigned char</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:239.96px;top:331.67px" class="cls_006"><span class="cls_006">If the old program may depend on the default sign-extension of </span><span class="cls_029">char</span></div>
<div style="position:absolute;left:239.96px;top:342.67px" class="cls_006"><span class="cls_006">types, there is often a compiler option to restore the traditional</span></div>
<div style="position:absolute;left:239.96px;top:353.67px" class="cls_006"><span class="cls_006">convention.</span></div>
<div style="position:absolute;left:228.01px;top:367.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.96px;top:367.67px" class="cls_008"><span class="cls_008">Data alignment and memory layout</span><span class="cls_006">: if a program makes assumptions</span></div>
<div style="position:absolute;left:239.96px;top:378.67px" class="cls_006"><span class="cls_006">about memory layout (such as using C</span><span class="cls_029">struct</span><span class="cls_006"> declarations to map</span></div>
<div style="position:absolute;left:239.96px;top:389.67px" class="cls_006"><span class="cls_006">input files, or the results of data communications) the programmer</span></div>
<div style="position:absolute;left:239.96px;top:400.67px" class="cls_006"><span class="cls_006">should review and check the structure declarations. It will often not</span></div>
<div style="position:absolute;left:239.96px;top:411.67px" class="cls_006"><span class="cls_006">be possible to interpret such data without a conversion routine (for</span></div>
<div style="position:absolute;left:239.96px;top:422.67px" class="cls_006"><span class="cls_006">example, to convert little-endian format integers to big-endian).</span></div>
<div style="position:absolute;left:239.96px;top:436.67px" class="cls_006"><span class="cls_006">It is probably better to remove such dependencies; but it may be</span></div>
<div style="position:absolute;left:239.96px;top:447.67px" class="cls_006"><span class="cls_006">possible to work around them. By setting up the R30xx system to</span></div>
<div style="position:absolute;left:239.96px;top:458.67px" class="cls_006"><span class="cls_006">match the software’s assumptions about endianness, and judicious</span></div>
<div style="position:absolute;left:239.96px;top:469.67px" class="cls_006"><span class="cls_006">use of the</span><span class="cls_029">#pragma pack(xx)</span><span class="cls_006"> feature, the problem may be avoided.</span></div>
<div style="position:absolute;left:228.01px;top:483.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.96px;top:483.67px" class="cls_008"><span class="cls_008">Stack issues - varargs/alloca</span><span class="cls_006">: as pointed out above, the MIPS CPU</span></div>
<div style="position:absolute;left:239.96px;top:494.67px" class="cls_006"><span class="cls_006">doesn’t have much in the way of a stack. The C stack is synthesized</span></div>
<div style="position:absolute;left:239.96px;top:505.67px" class="cls_006"><span class="cls_006">using standard register/register instructions to form a single stack</span></div>
<div style="position:absolute;left:239.96px;top:516.67px" class="cls_006"><span class="cls_006">containing both return addresses and local variables; but the stack</span></div>
<div style="position:absolute;left:239.96px;top:527.67px" class="cls_006"><span class="cls_006">frame may not be generated in functions which don’t need it.</span></div>
<div style="position:absolute;left:239.96px;top:541.67px" class="cls_006"><span class="cls_006">If the C code thinks it knows something about the stack, it may not</span></div>
<div style="position:absolute;left:239.96px;top:552.67px" class="cls_006"><span class="cls_006">work.</span></div>
<div style="position:absolute;left:239.96px;top:566.67px" class="cls_006"><span class="cls_006">However, two respectable and standards-conformant macro/library</span></div>
<div style="position:absolute;left:239.96px;top:577.67px" class="cls_006"><span class="cls_006">operations are available:</span></div>
<div style="position:absolute;left:239.96px;top:591.67px" class="cls_006"><span class="cls_006">a)</span><span class="cls_008">    varargs</span><span class="cls_006">: use this include file based macro package to implement</span></div>
<div style="position:absolute;left:264.01px;top:602.67px" class="cls_006"><span class="cls_006">routines with a variable number of parameters. C code should</span></div>
<div style="position:absolute;left:264.01px;top:613.67px" class="cls_006"><span class="cls_006">make no other assumptions about the calling stack.</span></div>
<div style="position:absolute;left:239.96px;top:627.67px" class="cls_006"><span class="cls_006">b)</span><span class="cls_008">   alloca</span><span class="cls_006">: use this ‘‘library function’’ (it is implemented as a built-in</span></div>
<div style="position:absolute;left:264.01px;top:638.67px" class="cls_006"><span class="cls_006">by many compilers) to allocate memory at run-time, which is ‘‘on</span></div>
<div style="position:absolute;left:264.01px;top:649.67px" class="cls_006"><span class="cls_006">the stack’’ in the sense that it will be automatically freed when</span></div>
<div style="position:absolute;left:264.01px;top:660.67px" class="cls_006"><span class="cls_006">the function allocating the memory returns. Don’t assume that</span></div>
<div style="position:absolute;left:264.01px;top:671.67px" class="cls_006"><span class="cls_006">such memory is actually at an address with some connection</span></div>
<div style="position:absolute;left:264.01px;top:682.67px" class="cls_006"><span class="cls_006">with the stack.</span></div>
<div style="position:absolute;left:301.30px;top:755.34px" class="cls_002"><span class="cls_002">11-15</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:137142px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 11</span></div>
<div style="position:absolute;left:414.55px;top:28.00px" class="cls_002"><span class="cls_002">PORTABILITY CONSIDERATIONS</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Argument passing - autoconversions</span><span class="cls_006">: arguments passed to a function,</span></div>
<div style="position:absolute;left:59.97px;top:61.67px" class="cls_006"><span class="cls_006">and  not  explicitly  defined  by  a  function  prototype,  are  often</span></div>
<div style="position:absolute;left:59.97px;top:72.67px" class="cls_006"><span class="cls_006">‘‘promoted’’; typically to an </span><span class="cls_008">int</span><span class="cls_006"> type, for sub-word integers. This can</span></div>
<div style="position:absolute;left:59.98px;top:83.67px" class="cls_006"><span class="cls_006">cause surprises, particularly when promoting data unexpectedly</span></div>
<div style="position:absolute;left:59.98px;top:94.67px" class="cls_006"><span class="cls_006">interpreted as signed.</span></div>
<div style="position:absolute;left:48.03px;top:108.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Endianness</span><span class="cls_006">: the system architect may be able to configure the R30xx</span></div>
<div style="position:absolute;left:59.98px;top:119.67px" class="cls_006"><span class="cls_006">system to match the endianness of the existing system, to save the</span></div>
<div style="position:absolute;left:59.98px;top:130.67px" class="cls_006"><span class="cls_006">many trials described above.</span></div>
<div style="position:absolute;left:48.03px;top:144.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Ambiguous behavior of library functions</span><span class="cls_006">: library functions may behave</span></div>
<div style="position:absolute;left:59.98px;top:155.67px" class="cls_006"><span class="cls_006">unexpectedly  at  the  margins</span></div>
<div style="position:absolute;left:218.22px;top:155.67px" class="cls_006"><span class="cls_006">-  a  classic  example  is  using  the</span></div>
<div style="position:absolute;left:59.98px;top:166.67px" class="cls_029"><span class="cls_029">memcpy()</span><span class="cls_006"> routine (defined in many C environments) to copy bytes,</span></div>
<div style="position:absolute;left:59.98px;top:177.67px" class="cls_006"><span class="cls_006">and accidentally feeding it a source and destination area which</span></div>
<div style="position:absolute;left:59.98px;top:188.67px" class="cls_006"><span class="cls_006">overlap.</span></div>
<div style="position:absolute;left:48.03px;top:202.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Include file usage</span><span class="cls_006">: this is closer to a system dependency; but the</span></div>
<div style="position:absolute;left:59.98px;top:213.67px" class="cls_006"><span class="cls_006">programmer can spend hours trying to untangle an incompatible</span></div>
<div style="position:absolute;left:59.98px;top:224.67px" class="cls_006"><span class="cls_006">forest of ‘‘.h’’ files. Moral: if a program is supposed to be largely OS-</span></div>
<div style="position:absolute;left:59.98px;top:235.67px" class="cls_006"><span class="cls_006">independent, try not to use the OS’ standard include files.</span></div>
<div style="position:absolute;left:36.00px;top:258.00px" class="cls_015"><span class="cls_015">CONSIDERATIONS FOR PORTABILITY TO FUTURE</span></div>
<div style="position:absolute;left:36.00px;top:271.00px" class="cls_015"><span class="cls_015">DEVICES</span></div>
<div style="position:absolute;left:48.02px;top:284.67px" class="cls_006"><span class="cls_006">In general, it is difficult to perfectly plan for future, unknown devices.</span></div>
<div style="position:absolute;left:36.00px;top:295.67px" class="cls_006"><span class="cls_006">However, the techniques described above should minimize the effort</span></div>
<div style="position:absolute;left:36.00px;top:306.67px" class="cls_006"><span class="cls_006">required to take advantage of changing technology:</span></div>
<div style="position:absolute;left:48.02px;top:320.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> develop code portable across existing family members. </span><span class="cls_006">Future family</span></div>
<div style="position:absolute;left:59.97px;top:331.67px" class="cls_006"><span class="cls_006">members may continue to vary cache sizes, TLB structures, inclusion</span></div>
<div style="position:absolute;left:59.97px;top:342.67px" class="cls_006"><span class="cls_006">of FPA, etc. However, many of them can be expected to be compatible</span></div>
<div style="position:absolute;left:59.97px;top:353.67px" class="cls_006"><span class="cls_006">with the basic CP0 mechanisms described in the earlier chapters.</span></div>
<div style="position:absolute;left:59.97px;top:364.67px" class="cls_006"><span class="cls_006">Code which is independent of cache size, resides in kseg0 and kseg1,</span></div>
<div style="position:absolute;left:59.97px;top:375.67px" class="cls_006"><span class="cls_006">and which allows the inclusion of new/additional device drivers is</span></div>
<div style="position:absolute;left:59.97px;top:386.67px" class="cls_006"><span class="cls_006">likely to be readily portable to newer family members.</span></div>
<div style="position:absolute;left:48.02px;top:400.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Use modular programming.</span><span class="cls_006"> Specifically, map device specific functions</span></div>
<div style="position:absolute;left:59.97px;top:411.67px" class="cls_006"><span class="cls_006">such as cache invalidation, device initialization exception decoding</span></div>
<div style="position:absolute;left:59.97px;top:422.67px" class="cls_006"><span class="cls_006">and exception service dispatch, to independent modules (rather than</span></div>
<div style="position:absolute;left:59.97px;top:433.67px" class="cls_006"><span class="cls_006">intertwine  these  functions  throughout  the  program).  This  will</span></div>
<div style="position:absolute;left:59.97px;top:444.67px" class="cls_006"><span class="cls_006">facilitate the porting to family members such as the R4600, which</span></div>
<div style="position:absolute;left:59.97px;top:455.67px" class="cls_006"><span class="cls_006">offer different CP0 architectures.</span></div>
<div style="position:absolute;left:48.02px;top:469.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Isolate the key algorithms to be device independent.</span><span class="cls_006"> For example,</span></div>
<div style="position:absolute;left:59.97px;top:480.67px" class="cls_006"><span class="cls_006">image rasterization of routing table look-up should be implemented in</span></div>
<div style="position:absolute;left:59.97px;top:491.67px" class="cls_006"><span class="cls_006">code which is device independent (but may rely on underlying,</span></div>
<div style="position:absolute;left:59.97px;top:502.67px" class="cls_006"><span class="cls_006">independent exception or cache structures).</span></div>
<div style="position:absolute;left:287.55px;top:755.34px" class="cls_002"><span class="cls_002">11-16</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:137944px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">WRITING POWER-ON</span></div>
<div style="position:absolute;left:483.41px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 12</span></div>
<div style="position:absolute;left:222.89px;top:56.33px" class="cls_005"><span class="cls_005">DIAGNOSTICS</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:228.02px;top:124.67px" class="cls_006"><span class="cls_006">Large  companies  with  established  product  lines  will  already  have</span></div>
<div style="position:absolute;left:216.00px;top:135.67px" class="cls_006"><span class="cls_006">guidelines for systems diagnostics; programmers may find this chapter</span></div>
<div style="position:absolute;left:216.00px;top:146.67px" class="cls_006"><span class="cls_006">useful for particular information about the MIPS architecture and how its</span></div>
<div style="position:absolute;left:216.00px;top:157.67px" class="cls_006"><span class="cls_006">features can be employed.</span></div>
<div style="position:absolute;left:228.02px;top:168.67px" class="cls_006"><span class="cls_006">However, a large number of engineers will be dealing not just with a new</span></div>
<div style="position:absolute;left:216.00px;top:179.67px" class="cls_006"><span class="cls_006">CPU architecture, but also with a new level of system complexity. For</span></div>
<div style="position:absolute;left:216.00px;top:190.67px" class="cls_006"><span class="cls_006">those, this chapter is a pragmatic, hands-on guide to producing usable</span></div>
<div style="position:absolute;left:216.00px;top:201.67px" class="cls_006"><span class="cls_006">diagnostics. There is much academic literature about the efficiency and</span></div>
<div style="position:absolute;left:216.00px;top:212.67px" class="cls_006"><span class="cls_006">thoroughness  of  tests</span></div>
<div style="position:absolute;left:340.92px;top:212.67px" class="cls_006"><span class="cls_006">(particularly  memory  tests)  which  won’t  be</span></div>
<div style="position:absolute;left:216.00px;top:223.67px" class="cls_006"><span class="cls_006">addressed in this manual.</span></div>
<div style="position:absolute;left:216.00px;top:246.00px" class="cls_015"><span class="cls_015">GOLDEN RULES FOR DIAGNOSTICS PROGRAMMING</span></div>
<div style="position:absolute;left:228.02px;top:262.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:262.67px" class="cls_008"><span class="cls_008">Test only the minimum required at each stage</span><span class="cls_006">: tests which run very</span></div>
<div style="position:absolute;left:239.98px;top:273.67px" class="cls_006"><span class="cls_006">early   must   be   written   in   an   environment   which   makes   the</span></div>
<div style="position:absolute;left:239.98px;top:284.67px" class="cls_006"><span class="cls_006">programmers’ life difficult. Whole chunks of the hardware cannot be</span></div>
<div style="position:absolute;left:239.98px;top:295.67px" class="cls_006"><span class="cls_006">trusted, the CPU may not be able to run at full speed, and it may be</span></div>
<div style="position:absolute;left:239.98px;top:306.67px" class="cls_006"><span class="cls_006">impossible to use high level languages.</span></div>
<div style="position:absolute;left:239.98px;top:320.67px" class="cls_006"><span class="cls_006">The structure of the early tests is therefore pretty much unaffected by</span></div>
<div style="position:absolute;left:239.98px;top:331.67px" class="cls_006"><span class="cls_006">the hardware specification; they are focussed on getting enough</span></div>
<div style="position:absolute;left:239.98px;top:342.67px" class="cls_006"><span class="cls_006">confidence in the CPU, program memory and writable memory (and,</span></div>
<div style="position:absolute;left:239.98px;top:353.67px" class="cls_006"><span class="cls_006">more importantly, the interconnects between them) to make it safe to</span></div>
<div style="position:absolute;left:239.98px;top:364.67px" class="cls_006"><span class="cls_006">use high-level language routines.</span></div>
<div style="position:absolute;left:228.03px;top:378.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:378.67px" class="cls_008"><span class="cls_008">Keep it simple</span><span class="cls_006">: diagnostic routines are particularly hard to prove,</span></div>
<div style="position:absolute;left:239.97px;top:389.67px" class="cls_006"><span class="cls_006">since the only way to check them is to simulate hardware faults.</span></div>
<div style="position:absolute;left:239.97px;top:400.67px" class="cls_006"><span class="cls_006">When the hardware really does go wrong, the diagnostics are quite</span></div>
<div style="position:absolute;left:239.97px;top:411.67px" class="cls_006"><span class="cls_006">likely to crash silently; a computer going wrong frequently goes so</span></div>
<div style="position:absolute;left:239.97px;top:422.67px" class="cls_006"><span class="cls_006">badly wrong that not even the most paranoid test will get running.</span></div>
<div style="position:absolute;left:239.97px;top:436.67px" class="cls_006"><span class="cls_006">Routines so simple that they are almost certain to be correct by</span></div>
<div style="position:absolute;left:239.97px;top:447.67px" class="cls_006"><span class="cls_006">inspection will probably be robust when needed; and the programmer</span></div>
<div style="position:absolute;left:239.97px;top:458.67px" class="cls_006"><span class="cls_006">will be more confident in pointing the finger at the hardware.</span></div>
<div style="position:absolute;left:228.02px;top:472.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:472.67px" class="cls_008"><span class="cls_008">Find some way to communicate</span><span class="cls_006">: the worst thing any diagnostic can do</span></div>
<div style="position:absolute;left:239.98px;top:483.67px" class="cls_006"><span class="cls_006">in the face of an error is to say nothing. But since most faults are</span></div>
<div style="position:absolute;left:239.98px;top:494.67px" class="cls_006"><span class="cls_006">near-catastrophic, this worst case happens often. The diagnostics</span></div>
<div style="position:absolute;left:239.98px;top:505.67px" class="cls_006"><span class="cls_006">programmer will therefore do everything possible to get diagnostic</span></div>
<div style="position:absolute;left:239.98px;top:516.67px" class="cls_006"><span class="cls_006">routines to do something visible with the absolute minimum of</span></div>
<div style="position:absolute;left:239.98px;top:527.67px" class="cls_006"><span class="cls_006">hardware.</span></div>
<div style="position:absolute;left:239.98px;top:541.67px" class="cls_006"><span class="cls_006">Many hardware products are fitted with some kind of write-only</span></div>
<div style="position:absolute;left:239.98px;top:552.67px" class="cls_006"><span class="cls_006">output device with diagnostics in mind - perhaps an LED, a 7-</span></div>
<div style="position:absolute;left:239.98px;top:563.67px" class="cls_006"><span class="cls_006">segment display or (if the designer could afford its space and cost) a</span></div>
<div style="position:absolute;left:239.98px;top:574.67px" class="cls_006"><span class="cls_006">miniature alphanumeric LED or liquid crystal display showing 4 or</span></div>
<div style="position:absolute;left:239.98px;top:585.67px" class="cls_006"><span class="cls_006">more characters. This device should be wired up so that, provided the</span></div>
<div style="position:absolute;left:239.98px;top:596.67px" class="cls_006"><span class="cls_006">CPU and ROM memory are functional, the minimal amount of further</span></div>
<div style="position:absolute;left:239.98px;top:607.67px" class="cls_006"><span class="cls_006">hardware has to work for the display to show something.</span></div>
<div style="position:absolute;left:239.98px;top:621.67px" class="cls_006"><span class="cls_006">Don’t forget that even where software can’t flash an LED, it can make</span></div>
<div style="position:absolute;left:239.98px;top:632.67px" class="cls_006"><span class="cls_006">software’s activity visible to a simple piece of test equipment—a</span></div>
<div style="position:absolute;left:239.98px;top:643.67px" class="cls_006"><span class="cls_006">voltmeter,  oscilloscope  or  logic  analyzer.  For  example,  the  IDT</span></div>
<div style="position:absolute;left:239.98px;top:654.67px" class="cls_006"><span class="cls_006">Micromonitor will perform a software loop at an “error address”; a</span></div>
<div style="position:absolute;left:239.98px;top:665.67px" class="cls_006"><span class="cls_006">logic analyzer can then trigger on this address to see the sequence of</span></div>
<div style="position:absolute;left:239.98px;top:676.67px" class="cls_006"><span class="cls_006">events immediately prior to the error.</span></div>
<div style="position:absolute;left:297.04px;top:754.68px" class="cls_002"><span class="cls_002">12-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:138746px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 12</span></div>
<div style="position:absolute;left:401.86px;top:28.00px" class="cls_002"><span class="cls_002">WRITING POWER-ON DIAGNOSTICS</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:50.67px" class="cls_008"><span class="cls_008">Never poll anything forever</span><span class="cls_006">: of course, it is common practice in simple</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">device drivers to code a loop which is exited when some status bit</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">changes. But when dealing with unproven subsystems, it is best to</span></div>
<div style="position:absolute;left:59.98px;top:83.67px" class="cls_006"><span class="cls_006">keep some track of real time so that the code can recognize that the</span></div>
<div style="position:absolute;left:59.98px;top:94.67px" class="cls_006"><span class="cls_006">status bit is not going to change, and report it.</span></div>
<div style="position:absolute;left:48.03px;top:108.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:108.67px" class="cls_008"><span class="cls_008">Good diagnostics are fast</span><span class="cls_006">: some fault conditions are dynamic or</span></div>
<div style="position:absolute;left:59.98px;top:119.67px" class="cls_006"><span class="cls_006">pattern-sensitive, and careful, slow diagnostics won’t ever find them.</span></div>
<div style="position:absolute;left:48.03px;top:133.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:133.67px" class="cls_008"><span class="cls_008">Fighting past programmable hardware</span><span class="cls_006">: one major problem for the</span></div>
<div style="position:absolute;left:59.98px;top:144.67px" class="cls_006"><span class="cls_006">diagnostics   programmer   is   the   use   of   software-configurable</span></div>
<div style="position:absolute;left:59.98px;top:155.67px" class="cls_006"><span class="cls_006">hardware.   For   example,   Algorithmics’   SL-3000   single-board</span></div>
<div style="position:absolute;left:59.98px;top:166.67px" class="cls_006"><span class="cls_006">computer uses a VLSI component (VAC068) for the external bus</span></div>
<div style="position:absolute;left:59.98px;top:177.67px" class="cls_006"><span class="cls_006">address path. This component integrates a programmable address</span></div>
<div style="position:absolute;left:59.98px;top:188.67px" class="cls_006"><span class="cls_006">decoder and wait-state generator. This is convenient and saves a lot</span></div>
<div style="position:absolute;left:59.98px;top:199.67px" class="cls_006"><span class="cls_006">of random logic; BUT this means that even the simplest operations</span></div>
<div style="position:absolute;left:59.98px;top:210.67px" class="cls_006"><span class="cls_006">(e.g. access to a UART register) won’t work until the VAC068 has been</span></div>
<div style="position:absolute;left:59.98px;top:221.67px" class="cls_006"><span class="cls_006">configured.</span></div>
<div style="position:absolute;left:59.98px;top:235.67px" class="cls_006"><span class="cls_006">The hardware engineer should have been talking with the systems</span></div>
<div style="position:absolute;left:59.98px;top:246.67px" class="cls_006"><span class="cls_006">programmers about this as the system was designed, since it is quite</span></div>
<div style="position:absolute;left:59.98px;top:257.67px" class="cls_006"><span class="cls_006">possible to build a system which cannot be bootstrapped.</span></div>
<div style="position:absolute;left:48.03px;top:271.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:271.67px" class="cls_008"><span class="cls_008">Work with (not for) the user</span><span class="cls_006">: good diagnostic tests may well be able to</span></div>
<div style="position:absolute;left:59.97px;top:282.67px" class="cls_006"><span class="cls_006">give quite a clear indication of where a problem lies. But never forget</span></div>
<div style="position:absolute;left:59.97px;top:293.67px" class="cls_006"><span class="cls_006">that diagnostics are meant to be run and watched by an intelligent,</span></div>
<div style="position:absolute;left:59.97px;top:304.67px" class="cls_006"><span class="cls_006">knowledgable person. So give the user’s intelligence a chance by being</span></div>
<div style="position:absolute;left:59.97px;top:315.67px" class="cls_006"><span class="cls_006">informative about what is happening. If a test prints out ‘‘Trying</span></div>
<div style="position:absolute;left:59.97px;top:326.67px" class="cls_006"><span class="cls_006">master access from Ethernet chip’’ and then nothing more, it is much</span></div>
<div style="position:absolute;left:59.97px;top:337.67px" class="cls_006"><span class="cls_006">more helpful than silently sticking in an infinite loop trying to figure</span></div>
<div style="position:absolute;left:59.97px;top:348.67px" class="cls_006"><span class="cls_006">out something more specific to say.</span></div>
<div style="position:absolute;left:36.00px;top:371.00px" class="cls_015"><span class="cls_015">WHAT SHOULD TESTS DO?</span></div>
<div style="position:absolute;left:48.02px;top:387.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:387.67px" class="cls_008"><span class="cls_008">Diagnostics versus go/no-go</span><span class="cls_006">: a major conceptual difference; is the test</span></div>
<div style="position:absolute;left:59.98px;top:398.67px" class="cls_006"><span class="cls_006">intended to direct service or repair effort to a particular subsystem, or</span></div>
<div style="position:absolute;left:59.98px;top:409.67px" class="cls_006"><span class="cls_006">is it merely intended to come up with a ‘‘yes/no’’ answer?</span></div>
<div style="position:absolute;left:59.98px;top:423.67px" class="cls_006"><span class="cls_006">In practice most test software seems to be expected to do both. This</span></div>
<div style="position:absolute;left:59.98px;top:434.67px" class="cls_006"><span class="cls_006">is not a major problem in terms of what is tested and how, but there</span></div>
<div style="position:absolute;left:59.98px;top:445.67px" class="cls_006"><span class="cls_006">is one big difference - time. A power-on ‘‘yes/no’’ test needs to be</span></div>
<div style="position:absolute;left:59.98px;top:456.67px" class="cls_006"><span class="cls_006">completed before it exhausts the patience of the person operating the</span></div>
<div style="position:absolute;left:59.98px;top:467.67px" class="cls_006"><span class="cls_006">power switch (empirically, 20 or 30 seconds seems about the limit).</span></div>
<div style="position:absolute;left:59.98px;top:481.67px" class="cls_006"><span class="cls_006">A diagnostic test can run for much longer. To address both needs with</span></div>
<div style="position:absolute;left:59.98px;top:492.67px" class="cls_006"><span class="cls_006">one test, find some way of configuring the test so that it can be asked</span></div>
<div style="position:absolute;left:59.98px;top:503.67px" class="cls_006"><span class="cls_006">to be more thorough at the cost of taking longer.</span></div>
<div style="position:absolute;left:48.03px;top:517.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:517.67px" class="cls_008"><span class="cls_008">Black boxes and internals</span><span class="cls_006">: in theory each subsystem can be treated</span></div>
<div style="position:absolute;left:59.97px;top:528.67px" class="cls_006"><span class="cls_006">as a ‘‘black box’’, purely in terms of its logical functions, and tested at</span></div>
<div style="position:absolute;left:59.97px;top:539.67px" class="cls_006"><span class="cls_006">that level without regard for its implementation. However, perfect</span></div>
<div style="position:absolute;left:59.97px;top:550.67px" class="cls_006"><span class="cls_006">tests usually require too long to run, and thus shortcuts are needed;</span></div>
<div style="position:absolute;left:59.97px;top:561.67px" class="cls_006"><span class="cls_006">knowing what shortcuts will be sensible is usually based on the</span></div>
<div style="position:absolute;left:59.97px;top:572.67px" class="cls_006"><span class="cls_006">internal design.</span></div>
<div style="position:absolute;left:59.97px;top:586.67px" class="cls_006"><span class="cls_006">Build a simple logical block diagram of complex subsystems, working</span></div>
<div style="position:absolute;left:59.97px;top:597.67px" class="cls_006"><span class="cls_006">with the hardware designer, and refer to it when figuring out a test</span></div>
<div style="position:absolute;left:59.97px;top:608.67px" class="cls_006"><span class="cls_006">sequence.</span></div>
<div style="position:absolute;left:59.97px;top:622.67px" class="cls_006"><span class="cls_006">Bear in mind that malfunctioning hardware can behave in ways</span></div>
<div style="position:absolute;left:59.97px;top:633.67px" class="cls_006"><span class="cls_006">which have no relation to its correct function. Note that this can cause</span></div>
<div style="position:absolute;left:59.97px;top:644.67px" class="cls_006"><span class="cls_006">‘‘false positives’’; for example when a write/read-back test returns</span></div>
<div style="position:absolute;left:59.97px;top:655.67px" class="cls_006"><span class="cls_006">correct data which has been retained by stray capacitance on a set of</span></div>
<div style="position:absolute;left:59.97px;top:666.67px" class="cls_006"><span class="cls_006">undriven signal wires (this is a fairly common occurrence in tests</span></div>
<div style="position:absolute;left:59.97px;top:677.67px" class="cls_006"><span class="cls_006">designed to determine the amount of system RAM available).</span></div>
<div style="position:absolute;left:59.97px;top:691.67px" class="cls_006"><span class="cls_006">Hardware engineers will have some feel for what may happen inside a</span></div>
<div style="position:absolute;left:59.97px;top:702.67px" class="cls_006"><span class="cls_006">component when it is abused; for example, it is useful to know that</span></div>
<div style="position:absolute;left:59.97px;top:713.67px" class="cls_006"><span class="cls_006">certain kinds of timing violation will cause the loss of data in a whole</span></div>
<div style="position:absolute;left:59.97px;top:724.67px" class="cls_006"><span class="cls_006">‘‘row’’ of cells inside a dynamic RAM chip.</span></div>
<div style="position:absolute;left:289.79px;top:755.33px" class="cls_002"><span class="cls_002">12-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:139548px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">WRITING POWER-ON DIAGNOSTICS</span></div>
<div style="position:absolute;left:520.62px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 12</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Connections are more unreliable than components</span><span class="cls_006">: probably 10-50</span></div>
<div style="position:absolute;left:239.98px;top:61.67px" class="cls_006"><span class="cls_006">times  more  unreliable.  Short-circuits  between  signals  are  fairly</span></div>
<div style="position:absolute;left:239.98px;top:72.67px" class="cls_006"><span class="cls_006">common (very common on boards which have not been auto-tested)</span></div>
<div style="position:absolute;left:239.98px;top:83.67px" class="cls_006"><span class="cls_006">and can produce subtle and peculiar behavior.</span></div>
<div style="position:absolute;left:228.03px;top:97.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Microcontrollers and other smart hardware</span><span class="cls_006">: any independently-acting</span></div>
<div style="position:absolute;left:239.98px;top:108.67px" class="cls_006"><span class="cls_006">programmable subsystem causes testing problems; this is probably</span></div>
<div style="position:absolute;left:239.98px;top:119.67px" class="cls_006"><span class="cls_006">the best reason for keeping subsystems dumb whenever possible. The</span></div>
<div style="position:absolute;left:239.98px;top:130.67px" class="cls_006"><span class="cls_006">same principles apply to test software executing on an intelligent</span></div>
<div style="position:absolute;left:239.98px;top:141.67px" class="cls_006"><span class="cls_006">subsystem, as to the whole test software. But communicating results</span></div>
<div style="position:absolute;left:239.98px;top:152.67px" class="cls_006"><span class="cls_006">to the user is often even more difficult.</span></div>
<div style="position:absolute;left:228.03px;top:166.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Testing internals of components</span><span class="cls_006">: few systems really need to do this, or</span></div>
<div style="position:absolute;left:239.97px;top:177.67px" class="cls_006"><span class="cls_006">can do a good job of it. The diagnostics programmer can’t find out how</span></div>
<div style="position:absolute;left:239.97px;top:188.67px" class="cls_006"><span class="cls_006">VLSI components are really built, so any tests beyond the simplest</span></div>
<div style="position:absolute;left:239.97px;top:199.67px" class="cls_006"><span class="cls_006">and most obvious are unlikely to be useful. What is possible is to set</span></div>
<div style="position:absolute;left:239.97px;top:210.67px" class="cls_006"><span class="cls_006">out to exercise components up from the most primitive operations</span></div>
<div style="position:absolute;left:239.97px;top:221.67px" class="cls_006"><span class="cls_006">they perform as ‘‘black boxes’’, with a view to proving the whole</span></div>
<div style="position:absolute;left:239.97px;top:232.67px" class="cls_006"><span class="cls_006">interface between the device and the rest of the system.</span></div>
<div style="position:absolute;left:228.02px;top:246.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Specifying tests</span><span class="cls_006">: an art form, like any specification. DO agree in</span></div>
<div style="position:absolute;left:239.97px;top:257.67px" class="cls_006"><span class="cls_006">advance on how to signal information (LED flash codes, signal levels,</span></div>
<div style="position:absolute;left:239.97px;top:268.67px" class="cls_006"><span class="cls_006">logic analyzers); DON’T bother to agree in advance what algorithm to</span></div>
<div style="position:absolute;left:239.97px;top:279.67px" class="cls_006"><span class="cls_006">use for memory tests.</span></div>
<div style="position:absolute;left:216.00px;top:302.00px" class="cls_015"><span class="cls_015">HOW TO TEST THE DIAGNOSTIC TESTS?</span></div>
<div style="position:absolute;left:228.02px;top:315.67px" class="cls_006"><span class="cls_006">Verifying the tests can be extremely difficult; the diagnostics engineer</span></div>
<div style="position:absolute;left:216.00px;top:326.67px" class="cls_006"><span class="cls_006">would ideally like to take the tests down all possible paths (e.g. the memory</span></div>
<div style="position:absolute;left:216.00px;top:337.67px" class="cls_006"><span class="cls_006">is good vs. the memory is bad). Doing so requires a method to make the</span></div>
<div style="position:absolute;left:216.00px;top:348.67px" class="cls_006"><span class="cls_006">test find faults in what may be an actual, good system. There are two</span></div>
<div style="position:absolute;left:216.00px;top:359.67px" class="cls_006"><span class="cls_006">primary techniques for doing this:</span></div>
<div style="position:absolute;left:228.02px;top:373.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Software test harnesses</span><span class="cls_006">: these use some kind of simulator, which can</span></div>
<div style="position:absolute;left:239.97px;top:384.67px" class="cls_006"><span class="cls_006">be programmed to be defective.</span></div>
<div style="position:absolute;left:228.02px;top:398.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Hardware test harnesses</span><span class="cls_006">: with this technique, hardware faults can be</span></div>
<div style="position:absolute;left:239.98px;top:409.67px" class="cls_006"><span class="cls_006">very tricky.</span></div>
<div style="position:absolute;left:228.03px;top:420.67px" class="cls_006"><span class="cls_006">Do make sure that software is exposed to some basic tests. Many a</span></div>
<div style="position:absolute;left:216.01px;top:431.67px" class="cls_006"><span class="cls_006">highly-sophisticated   memory   test   has   continued   running   without</span></div>
<div style="position:absolute;left:216.01px;top:442.67px" class="cls_006"><span class="cls_006">reporting any faults despite a screwdriver shorting out RAM pins.</span></div>
<div style="position:absolute;left:216.00px;top:465.00px" class="cls_015"><span class="cls_015">OVERVIEW OF ALGORITHMICS’ POWER-ON SELFTEST</span></div>
<div style="position:absolute;left:228.02px;top:478.67px" class="cls_006"><span class="cls_006">This section describes the functions and construction of a set of ROM-</span></div>
<div style="position:absolute;left:216.00px;top:489.67px" class="cls_006"><span class="cls_006">resident test routines designed for Algorithmics’ SL-3000 VMEbus single-</span></div>
<div style="position:absolute;left:216.00px;top:500.67px" class="cls_006"><span class="cls_006">board computer, which is based on an IDT R3081-40 CPU.</span></div>
<div style="position:absolute;left:228.02px;top:511.67px" class="cls_006"><span class="cls_006">The primary purpose of the tests is as power-up confidence tests, which</span></div>
<div style="position:absolute;left:216.00px;top:522.67px" class="cls_006"><span class="cls_006">must run in a short period of time; but they can be configured (using</span></div>
<div style="position:absolute;left:216.00px;top:533.67px" class="cls_006"><span class="cls_006">information held in a small nonvolatile writable store) to run slowly and</span></div>
<div style="position:absolute;left:216.00px;top:544.67px" class="cls_006"><span class="cls_006">carefully. They are useful as diagnostics, particularly for units which are</span></div>
<div style="position:absolute;left:216.00px;top:555.67px" class="cls_006"><span class="cls_006">too faulty to load more sophisticated routines.</span></div>
<div style="position:absolute;left:216.00px;top:578.00px" class="cls_015"><span class="cls_015">Starting points</span></div>
<div style="position:absolute;left:228.02px;top:591.67px" class="cls_006"><span class="cls_006">Unless a reasonable amount of logic is working correctly the SL-3000</span></div>
<div style="position:absolute;left:216.00px;top:602.67px" class="cls_006"><span class="cls_006">will be unable to run test code. The minimum requirements are:</span></div>
<div style="position:absolute;left:228.02px;top:616.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> PROM</span><span class="cls_006">: is correctly readable.</span></div>
<div style="position:absolute;left:228.02px;top:630.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Onboard data and address interconnects</span><span class="cls_006">: are fault-free, at least</span></div>
<div style="position:absolute;left:239.98px;top:641.67px" class="cls_006"><span class="cls_006">between the PROM and CPU (at least when all possible subunits are</span></div>
<div style="position:absolute;left:239.98px;top:652.67px" class="cls_006"><span class="cls_006">held in reset.)</span></div>
<div style="position:absolute;left:228.03px;top:666.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> CPU</span><span class="cls_006">: capable of executing code correctly.</span></div>
<div style="position:absolute;left:239.98px;top:680.67px" class="cls_006"><span class="cls_006">The tests do not have to assume correct operation of the on-chip</span></div>
<div style="position:absolute;left:239.98px;top:691.67px" class="cls_006"><span class="cls_006">caches (they are tested), the FPA (the tests merely look to see whether</span></div>
<div style="position:absolute;left:239.98px;top:702.67px" class="cls_006"><span class="cls_006">there is one there, and the test software does not need it to work), and</span></div>
<div style="position:absolute;left:239.98px;top:713.67px" class="cls_006"><span class="cls_006">the TLB (memory-management hardware, described earlier.)</span></div>
<div style="position:absolute;left:303.54px;top:755.33px" class="cls_002"><span class="cls_002">12-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:140350px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 12</span></div>
<div style="position:absolute;left:401.86px;top:28.00px" class="cls_002"><span class="cls_002">WRITING POWER-ON DIAGNOSTICS</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Error Reporting</span><span class="cls_006">: the SL-3000 has a front-panel 7-segment ‘‘hex’’ LED</span></div>
<div style="position:absolute;left:59.97px;top:61.67px" class="cls_006"><span class="cls_006">display provided mainly for this purpose. Where the console serial</span></div>
<div style="position:absolute;left:59.97px;top:72.67px" class="cls_006"><span class="cls_006">port is available, connected and functional it is used to provide fuller</span></div>
<div style="position:absolute;left:59.97px;top:83.67px" class="cls_006"><span class="cls_006">information.</span></div>
<div style="position:absolute;left:59.97px;top:97.67px" class="cls_006"><span class="cls_006">In  some  circumstances  the  diagnostics  will  also  leave  warning</span></div>
<div style="position:absolute;left:59.97px;top:108.67px" class="cls_006"><span class="cls_006">messages and codes in the nonvolatile memory, for higher-level</span></div>
<div style="position:absolute;left:59.97px;top:119.67px" class="cls_006"><span class="cls_006">software to find.</span></div>
<div style="position:absolute;left:59.97px;top:133.67px" class="cls_006"><span class="cls_006">Under serious failure conditions the tests make a last-ditch attempt</span></div>
<div style="position:absolute;left:59.97px;top:144.67px" class="cls_006"><span class="cls_006">to pass back information by a series of writes to PROM space;</span></div>
<div style="position:absolute;left:59.97px;top:155.67px" class="cls_006"><span class="cls_006">information is encoded in the store target addresses. The writes have</span></div>
<div style="position:absolute;left:59.97px;top:166.67px" class="cls_006"><span class="cls_006">no effect on the hardware†, but can be monitored with test equipment</span></div>
<div style="position:absolute;left:59.97px;top:177.67px" class="cls_006"><span class="cls_006">in laboratory conditions.</span></div>
<div style="position:absolute;left:48.02px;top:191.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Underlying  hardware</span><span class="cls_006">:  the</span></div>
<div style="position:absolute;left:202.59px;top:191.67px" class="cls_006"><span class="cls_006">‘‘minimal’’  functions  described  above</span></div>
<div style="position:absolute;left:59.97px;top:202.67px" class="cls_006"><span class="cls_006">implicitly require the use of other logic on the board. In particular, the</span></div>
<div style="position:absolute;left:59.97px;top:213.67px" class="cls_006"><span class="cls_006">VMEbus interface components (VIC068 and VAC068) integrate a</span></div>
<div style="position:absolute;left:59.97px;top:224.67px" class="cls_006"><span class="cls_006">variety of local bus control functions, and code will be impossible to</span></div>
<div style="position:absolute;left:59.97px;top:235.67px" class="cls_006"><span class="cls_006">run if these are faulty.</span></div>
<div style="position:absolute;left:36.00px;top:258.00px" class="cls_015"><span class="cls_015">Control and Environment variables</span></div>
<div style="position:absolute;left:48.02px;top:271.67px" class="cls_006"><span class="cls_006">The nonvolatile RAM provides configuration and other information</span></div>
<div style="position:absolute;left:36.00px;top:282.67px" class="cls_006"><span class="cls_006">shared between several different levels of software. Rather than attempting</span></div>
<div style="position:absolute;left:36.00px;top:293.67px" class="cls_006"><span class="cls_006">to legislate for a rigid fixed-field map, the bulk of the NVRAM storage is</span></div>
<div style="position:absolute;left:36.00px;top:304.67px" class="cls_006"><span class="cls_006">organized as an ‘‘environment’’ modelled after the UNIX facility. This</span></div>
<div style="position:absolute;left:36.00px;top:315.67px" class="cls_006"><span class="cls_006">provides a set of key/value pairs, all of which are ASCII strings.</span></div>
<div style="position:absolute;left:48.02px;top:326.67px" class="cls_006"><span class="cls_006">The environment is used both to set up options for the power-on tests</span></div>
<div style="position:absolute;left:36.00px;top:337.67px" class="cls_006"><span class="cls_006">(e.g. whether to spend time on thorough DRAM tests), and to return</span></div>
<div style="position:absolute;left:36.00px;top:348.67px" class="cls_006"><span class="cls_006">information discovered by those tests (e.g. to report the size of the caches).</span></div>
<div style="position:absolute;left:48.02px;top:359.67px" class="cls_006"><span class="cls_006">The integrity of the environment store is protected by a checksum. If the</span></div>
<div style="position:absolute;left:36.00px;top:370.67px" class="cls_006"><span class="cls_006">power-on test detects a corrupted NVRAM, it will ignore the NVRAM</span></div>
<div style="position:absolute;left:36.00px;top:381.67px" class="cls_006"><span class="cls_006">contents and use a set of default values for the environment variables.</span></div>
<div style="position:absolute;left:48.02px;top:392.67px" class="cls_006"><span class="cls_006">Users   have   to   have   some   way   of   inspecting   and   altering   the</span></div>
<div style="position:absolute;left:36.00px;top:403.67px" class="cls_006"><span class="cls_006">environment. Normally this will be provided as </span><span class="cls_008">setenv</span><span class="cls_006">, </span><span class="cls_008">getenv</span><span class="cls_006"> commands</span></div>
<div style="position:absolute;left:36.00px;top:414.67px" class="cls_006"><span class="cls_006">implemented by an interactive ROM monitor. The power-on self-test code</span></div>
<div style="position:absolute;left:36.00px;top:425.67px" class="cls_006"><span class="cls_006">includes subroutines accessing the environment, but is designed to work</span></div>
<div style="position:absolute;left:36.00px;top:436.67px" class="cls_006"><span class="cls_006">with a variety of monitors.</span></div>
<div style="position:absolute;left:48.02px;top:447.67px" class="cls_006"><span class="cls_006">A few NVRAM locations are predefined and strictly reserved for some</span></div>
<div style="position:absolute;left:36.00px;top:458.67px" class="cls_006"><span class="cls_006">other piece of software. They are ignored by the power-on tests.</span></div>
<div style="position:absolute;left:36.00px;top:481.00px" class="cls_015"><span class="cls_015">Reporting</span></div>
<div style="position:absolute;left:48.02px;top:494.67px" class="cls_006"><span class="cls_006">Progress through the tests is shown as a sequence of numbers displayed</span></div>
<div style="position:absolute;left:36.00px;top:505.67px" class="cls_006"><span class="cls_006">on the front-panel LED. Failure is shown by a (possibly multi-digit) code</span></div>
<div style="position:absolute;left:36.00px;top:516.67px" class="cls_006"><span class="cls_006">flashed on the display.</span></div>
<div style="position:absolute;left:48.02px;top:527.67px" class="cls_006"><span class="cls_006">Total collapse of the hardware under test is inferred by failure to keep</span></div>
<div style="position:absolute;left:36.00px;top:538.67px" class="cls_006"><span class="cls_006">incrementing the count, so the tests make sure that the display is changed</span></div>
<div style="position:absolute;left:36.00px;top:549.67px" class="cls_006"><span class="cls_006">every few seconds (exception: when the user has deliberately set an option</span></div>
<div style="position:absolute;left:36.00px;top:560.67px" class="cls_006"><span class="cls_006">variable to request the exhaustive version of a test, the user is expected to</span></div>
<div style="position:absolute;left:36.00px;top:571.67px" class="cls_006"><span class="cls_006">be patient).</span></div>
<div style="position:absolute;left:48.02px;top:582.67px" class="cls_006"><span class="cls_006">Usually test progress and results are also reported to the console</span></div>
<div style="position:absolute;left:36.00px;top:593.67px" class="cls_006"><span class="cls_006">(always to serial port 0, always at 9600 baud); but most console output can</span></div>
<div style="position:absolute;left:36.00px;top:604.67px" class="cls_006"><span class="cls_006">be suppressed by setting an appropriate environment variable, in case</span></div>
<div style="position:absolute;left:36.00px;top:615.67px" class="cls_006"><span class="cls_006">some systems have some other equipment permanently attached to the</span></div>
<div style="position:absolute;left:36.00px;top:626.67px" class="cls_006"><span class="cls_006">console port. However, fatal error messages will be reported to the console</span></div>
<div style="position:absolute;left:36.00px;top:637.67px" class="cls_006"><span class="cls_006">regardless of the environment state.</span></div>
<div style="position:absolute;left:54.00px;top:674.67px" class="cls_006"><span class="cls_006">† Such a methodology may not be compatible with the use of a</span></div>
<div style="position:absolute;left:54.00px;top:686.67px" class="cls_006"><span class="cls_006">ROM emulator; instead, it may be appropriate to define an “error</span></div>
<div style="position:absolute;left:54.00px;top:698.67px" class="cls_006"><span class="cls_006">reporting space” in the address map, which performs the</span></div>
<div style="position:absolute;left:54.00px;top:710.67px" class="cls_006"><span class="cls_006">appropriate handshake back to the CPU, but which does not</span></div>
<div style="position:absolute;left:54.00px;top:722.67px" class="cls_006"><span class="cls_006">decode into any actual memory devices.</span></div>
<div style="position:absolute;left:289.79px;top:755.33px" class="cls_002"><span class="cls_002">12-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:141152px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">WRITING POWER-ON DIAGNOSTICS</span></div>
<div style="position:absolute;left:520.62px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 12</span></div>
<div style="position:absolute;left:216.00px;top:50.00px" class="cls_015"><span class="cls_015">Unexpected exceptions during test sequence</span></div>
<div style="position:absolute;left:228.02px;top:63.67px" class="cls_006"><span class="cls_006">If something is really wrong with the machine, the CPU will usually get</span></div>
<div style="position:absolute;left:216.00px;top:74.67px" class="cls_006"><span class="cls_006">some kind of exception (illegal instruction, illegal or unmapped address).</span></div>
<div style="position:absolute;left:216.00px;top:85.67px" class="cls_006"><span class="cls_006">These conditions are usually to be regarded as fatal. They are usually a</span></div>
<div style="position:absolute;left:216.00px;top:96.67px" class="cls_006"><span class="cls_006">sign of something very seriously wrong, so the priority is to make the code</span></div>
<div style="position:absolute;left:216.00px;top:107.67px" class="cls_006"><span class="cls_006">robust enough that something will get reported.</span></div>
<div style="position:absolute;left:228.02px;top:118.67px" class="cls_006"><span class="cls_006">Exception reporting to the hex display should be done with the most</span></div>
<div style="position:absolute;left:216.00px;top:129.67px" class="cls_006"><span class="cls_006">pessimistic assumptions about the state of the machine; i.e. without using</span></div>
<div style="position:absolute;left:216.00px;top:140.67px" class="cls_006"><span class="cls_006">memory or the console. Once a minimal report has been made this way, it</span></div>
<div style="position:absolute;left:216.00px;top:151.67px" class="cls_006"><span class="cls_006">is permissible to assume memory is working in order to produce a better</span></div>
<div style="position:absolute;left:216.00px;top:162.67px" class="cls_006"><span class="cls_006">report to the console.</span></div>
<div style="position:absolute;left:228.02px;top:173.67px" class="cls_006"><span class="cls_006">The boot test sequence will always use the ‘‘bootstrap exception vector’’,</span></div>
<div style="position:absolute;left:216.00px;top:184.67px" class="cls_006"><span class="cls_006">described earlier in this manual, so that exceptions are trapped into PROM</span></div>
<div style="position:absolute;left:216.00px;top:195.67px" class="cls_006"><span class="cls_006">space  with  the  instruction  cache  not  used.  Since  the  CPU  can  be</span></div>
<div style="position:absolute;left:216.00px;top:206.67px" class="cls_006"><span class="cls_006">reconfigured to vector exceptions through cached low memory, the test</span></div>
<div style="position:absolute;left:216.00px;top:217.67px" class="cls_006"><span class="cls_006">code does not have to provide any software mechanisms for intercepting its</span></div>
<div style="position:absolute;left:216.00px;top:228.67px" class="cls_006"><span class="cls_006">own exceptions.</span></div>
<div style="position:absolute;left:216.00px;top:251.00px" class="cls_015"><span class="cls_015">Driving test output devices</span></div>
<div style="position:absolute;left:228.02px;top:264.67px" class="cls_006"><span class="cls_006">Test device software is pessimistic about the status of the hardware it</span></div>
<div style="position:absolute;left:216.00px;top:275.67px" class="cls_006"><span class="cls_006">talks to, to ensure that tests cannot be hung-up by malfunctioning</span></div>
<div style="position:absolute;left:216.00px;top:286.67px" class="cls_006"><span class="cls_006">outputs. For example, the serial port routines do not wait forever for</span></div>
<div style="position:absolute;left:216.00px;top:297.67px" class="cls_006"><span class="cls_006">characters to be transmitted.</span></div>
<div style="position:absolute;left:216.00px;top:320.00px" class="cls_015"><span class="cls_015">Restarting the system</span></div>
<div style="position:absolute;left:228.02px;top:333.67px" class="cls_006"><span class="cls_006">System restart (as far as possible equivalent to a hardware reset) will</span></div>
<div style="position:absolute;left:216.00px;top:344.67px" class="cls_006"><span class="cls_006">occur if software jumps to the reset location </span><span class="cls_029">0xbfc00000</span><span class="cls_006">. No ‘‘warm</span></div>
<div style="position:absolute;left:216.00px;top:355.67px" class="cls_006"><span class="cls_006">restart’’ is provided for by this code; it is assumed that anyone wanting to</span></div>
<div style="position:absolute;left:216.00px;top:366.67px" class="cls_006"><span class="cls_006">preserve machine state will not want to run the test sequence.</span></div>
<div style="position:absolute;left:216.00px;top:389.00px" class="cls_015"><span class="cls_015">Standard test sequence</span></div>
<div style="position:absolute;left:228.02px;top:402.67px" class="cls_006"><span class="cls_006">The tests are summarized in Table 12.1, “Test Sequence in brief”:</span></div>
<div style="position:absolute;left:222.49px;top:425.00px" class="cls_020"><span class="cls_020">Mnemonic</span></div>
<div style="position:absolute;left:393.87px;top:425.00px" class="cls_020"><span class="cls_020">Test summary</span></div>
<div style="position:absolute;left:220.00px;top:444.00px" class="cls_020"><span class="cls_020">init</span></div>
<div style="position:absolute;left:281.82px;top:444.00px" class="cls_020"><span class="cls_020">setup CPU and system (from a cold start)</span></div>
<div style="position:absolute;left:220.00px;top:461.00px" class="cls_020"><span class="cls_020">vac-reg</span></div>
<div style="position:absolute;left:281.89px;top:461.00px" class="cls_020"><span class="cls_020">register access tests on VAC068</span></div>
<div style="position:absolute;left:220.00px;top:478.00px" class="cls_020"><span class="cls_020">led</span></div>
<div style="position:absolute;left:281.81px;top:478.00px" class="cls_020"><span class="cls_020">display "8" then "0"</span></div>
<div style="position:absolute;left:220.00px;top:495.00px" class="cls_020"><span class="cls_020">endian</span></div>
<div style="position:absolute;left:281.88px;top:495.00px" class="cls_020"><span class="cls_020">check consistency of bigend jumpers and ROM, stop on error</span></div>
<div style="position:absolute;left:220.00px;top:512.00px" class="cls_027"><span class="cls_027">can use byte variables now</span></div>
<div style="position:absolute;left:220.00px;top:529.00px" class="cls_020"><span class="cls_020">mem-conf     check memory size and that configuration is OK (there is a jumper</span></div>
<div style="position:absolute;left:281.75px;top:539.00px" class="cls_020"><span class="cls_020">which needs to match the type of DRAM chips used)</span></div>
<div style="position:absolute;left:220.00px;top:556.00px" class="cls_020"><span class="cls_020">mem-min     uncached write/read address test on PROM data area</span></div>
<div style="position:absolute;left:220.00px;top:573.00px" class="cls_027"><span class="cls_027">in C from here on...</span></div>
<div style="position:absolute;left:220.00px;top:590.00px" class="cls_020"><span class="cls_020">prom</span></div>
<div style="position:absolute;left:281.86px;top:590.00px" class="cls_020"><span class="cls_020">checksum PROM sections and warn</span></div>
<div style="position:absolute;left:220.00px;top:607.00px" class="cls_020"><span class="cls_020">nvram</span></div>
<div style="position:absolute;left:281.88px;top:607.00px" class="cls_020"><span class="cls_020">checksum environment region, use defaults if wrong</span></div>
<div style="position:absolute;left:220.00px;top:624.00px" class="cls_027"><span class="cls_027">can use environment variables from here on...</span></div>
<div style="position:absolute;left:220.00px;top:641.00px" class="cls_020"><span class="cls_020">cache</span></div>
<div style="position:absolute;left:281.87px;top:641.00px" class="cls_020"><span class="cls_020">sizes caches and then performs internal write/read test (address</span></div>
<div style="position:absolute;left:281.75px;top:651.00px" class="cls_020"><span class="cls_020">in address)</span></div>
<div style="position:absolute;left:220.00px;top:668.00px" class="cls_020"><span class="cls_020">refill</span></div>
<div style="position:absolute;left:281.84px;top:668.00px" class="cls_020"><span class="cls_020">d-cache from PROM, then d-cache from main memory</span></div>
<div style="position:absolute;left:220.00px;top:685.00px" class="cls_020"><span class="cls_020">vac-timer</span></div>
<div style="position:absolute;left:281.93px;top:685.00px" class="cls_020"><span class="cls_020">check that programmable timers run, and that interrupt signals</span></div>
<div style="position:absolute;left:281.75px;top:695.00px" class="cls_020"><span class="cls_020">are reaching the VAC</span></div>
<div style="position:absolute;left:315.04px;top:714.00px" class="cls_020"><span class="cls_020">Table 12.1.  Test Sequence in brief</span></div>
<div style="position:absolute;left:303.54px;top:755.33px" class="cls_002"><span class="cls_002">12-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:141954px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 12</span></div>
<div style="position:absolute;left:401.86px;top:28.00px" class="cls_002"><span class="cls_002">WRITING POWER-ON DIAGNOSTICS</span></div>
<div style="position:absolute;left:42.49px;top:57.00px" class="cls_020"><span class="cls_020">Mnemonic</span></div>
<div style="position:absolute;left:213.87px;top:57.00px" class="cls_020"><span class="cls_020">Test summary</span></div>
<div style="position:absolute;left:40.00px;top:76.00px" class="cls_020"><span class="cls_020">fpa</span></div>
<div style="position:absolute;left:101.81px;top:76.00px" class="cls_020"><span class="cls_020">test for presence, interrupt wiring</span></div>
<div style="position:absolute;left:40.00px;top:93.00px" class="cls_020"><span class="cls_020">nvram-rtc</span></div>
<div style="position:absolute;left:101.94px;top:93.00px" class="cls_020"><span class="cls_020">check clock (built in with nonvolatile RAM module) for reasonable</span></div>
<div style="position:absolute;left:101.75px;top:103.00px" class="cls_020"><span class="cls_020">value, warn if it lost power.</span></div>
<div style="position:absolute;left:40.00px;top:120.00px" class="cls_020"><span class="cls_020">vic-reg</span></div>
<div style="position:absolute;left:101.88px;top:120.00px" class="cls_020"><span class="cls_020">register access tests on VIC068</span></div>
<div style="position:absolute;left:40.00px;top:137.00px" class="cls_020"><span class="cls_020">vic-timeout</span></div>
<div style="position:absolute;left:101.96px;top:137.00px" class="cls_020"><span class="cls_020">check local bus timeout</span></div>
<div style="position:absolute;left:40.00px;top:154.00px" class="cls_020"><span class="cls_020">vic-timer</span></div>
<div style="position:absolute;left:101.92px;top:154.00px" class="cls_020"><span class="cls_020">confirm timer working</span></div>
<div style="position:absolute;left:40.00px;top:171.00px" class="cls_020"><span class="cls_020">vic-int</span></div>
<div style="position:absolute;left:101.88px;top:171.00px" class="cls_020"><span class="cls_020">check that VIC interrupts are getting through to the CPU, and that</span></div>
<div style="position:absolute;left:101.75px;top:181.00px" class="cls_020"><span class="cls_020">the interrupt acknowledge mechanism works.</span></div>
<div style="position:absolute;left:40.00px;top:198.00px" class="cls_020"><span class="cls_020">vic-scon</span></div>
<div style="position:absolute;left:101.91px;top:198.00px" class="cls_020"><span class="cls_020">Is this system a VMEbus controller? set env variable</span></div>
<div style="position:absolute;left:40.00px;top:215.01px" class="cls_020"><span class="cls_020">mem-best</span></div>
<div style="position:absolute;left:101.94px;top:215.01px" class="cls_020"><span class="cls_020">fast address-based confidence check</span></div>
<div style="position:absolute;left:40.00px;top:232.01px" class="cls_020"><span class="cls_020">mem-parity</span></div>
<div style="position:absolute;left:101.96px;top:232.01px" class="cls_020"><span class="cls_020">check out that the parity check logic is accepting good and</span></div>
<div style="position:absolute;left:101.75px;top:242.01px" class="cls_020"><span class="cls_020">detecting bad parity</span></div>
<div style="position:absolute;left:40.00px;top:259.01px" class="cls_020"><span class="cls_020">mem-soak</span></div>
<div style="position:absolute;left:101.95px;top:259.01px" class="cls_020"><span class="cls_020">sequence of ‘‘thorough’’ memory tests</span></div>
<div style="position:absolute;left:40.00px;top:276.01px" class="cls_020"><span class="cls_020">uart-reg</span></div>
<div style="position:absolute;left:101.91px;top:276.01px" class="cls_020"><span class="cls_020">register write/read tests on 72001 (UART)</span></div>
<div style="position:absolute;left:40.00px;top:293.01px" class="cls_020"><span class="cls_020">uart-init</span></div>
<div style="position:absolute;left:101.91px;top:293.01px" class="cls_020"><span class="cls_020">initialize 72001 (suspiciously) and send a character</span></div>
<div style="position:absolute;left:40.00px;top:310.01px" class="cls_020"><span class="cls_020">eth-reg</span></div>
<div style="position:absolute;left:101.89px;top:310.01px" class="cls_020"><span class="cls_020">register access tests on SONIC</span></div>
<div style="position:absolute;left:40.00px;top:327.01px" class="cls_020"><span class="cls_020">eth-read</span></div>
<div style="position:absolute;left:101.91px;top:327.01px" class="cls_020"><span class="cls_020">get SONIC to read memory and check (also detects interrupt)</span></div>
<div style="position:absolute;left:40.00px;top:344.01px" class="cls_020"><span class="cls_020">eth-write</span></div>
<div style="position:absolute;left:101.92px;top:344.01px" class="cls_020"><span class="cls_020">get SONIC to write (or copy) memory and check</span></div>
<div style="position:absolute;left:40.00px;top:361.01px" class="cls_020"><span class="cls_020">scsi-reg</span></div>
<div style="position:absolute;left:101.90px;top:361.01px" class="cls_020"><span class="cls_020">register access tests on 53C710. Also check out the byte-swapper</span></div>
<div style="position:absolute;left:101.75px;top:371.01px" class="cls_020"><span class="cls_020">which is available for little-endian mode if required.</span></div>
<div style="position:absolute;left:40.00px;top:388.01px" class="cls_020"><span class="cls_020">scsi-read</span></div>
<div style="position:absolute;left:101.93px;top:388.01px" class="cls_020"><span class="cls_020">get 53C710 to read memory and check (and check its interrupt)</span></div>
<div style="position:absolute;left:40.00px;top:405.01px" class="cls_020"><span class="cls_020">scsi-write</span></div>
<div style="position:absolute;left:101.94px;top:405.01px" class="cls_020"><span class="cls_020">get 53C710 to write (or copy) memory and check</span></div>
<div style="position:absolute;left:135.04px;top:424.00px" class="cls_020"><span class="cls_020">Table 12.1.  Test Sequence in brief</span></div>
<div style="position:absolute;left:36.00px;top:444.00px" class="cls_015"><span class="cls_015">Notes on the test sequence</span></div>
<div style="position:absolute;left:48.02px;top:460.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> From Reset</span><span class="cls_006">: The CPU restarts at the usual PROM location, running</span></div>
<div style="position:absolute;left:59.98px;top:471.67px" class="cls_006"><span class="cls_006">uncached.  This  PROM  is  intended  to  restart  in  the  same  way</span></div>
<div style="position:absolute;left:59.98px;top:482.67px" class="cls_006"><span class="cls_006">regardless of whether the starting location was reached by a hardware</span></div>
<div style="position:absolute;left:59.98px;top:493.67px" class="cls_006"><span class="cls_006">reset or a software jump; so everything which can be is reset.</span></div>
<div style="position:absolute;left:59.98px;top:507.67px" class="cls_006"><span class="cls_006">The sequence is complex and goes like this:</span></div>
<div style="position:absolute;left:48.03px;top:521.67px" class="cls_006"><span class="cls_006">1.</span></div>
<div style="position:absolute;left:84.03px;top:521.67px" class="cls_006"><span class="cls_006">There is a branch instruction at the boot location. A failure to</span></div>
<div style="position:absolute;left:84.03px;top:532.67px" class="cls_006"><span class="cls_006">read the ROM correctly will lead to the CPU getting an immediate</span></div>
<div style="position:absolute;left:84.03px;top:543.67px" class="cls_006"><span class="cls_006">exception, failing to branch, or branching to the wrong address.</span></div>
<div style="position:absolute;left:84.03px;top:554.67px" class="cls_006"><span class="cls_006">All are pretty obvious to an engineer watching addresses on a</span></div>
<div style="position:absolute;left:84.03px;top:565.67px" class="cls_006"><span class="cls_006">logic analyzer.</span></div>
<div style="position:absolute;left:48.03px;top:579.67px" class="cls_006"><span class="cls_006">2.</span></div>
<div style="position:absolute;left:84.03px;top:579.67px" class="cls_006"><span class="cls_006">Initialize the status register to place the CPU in a reasonable</span></div>
<div style="position:absolute;left:84.03px;top:590.67px" class="cls_006"><span class="cls_006">mode. Software preserves the prior-to-reset values of </span><span class="cls_008">ra</span><span class="cls_006"> and </span><span class="cls_008">epc.</span></div>
<div style="position:absolute;left:84.02px;top:601.67px" class="cls_006"><span class="cls_006">They have to be put into general purpose registers, since at this</span></div>
<div style="position:absolute;left:84.02px;top:612.67px" class="cls_006"><span class="cls_006">stage the memory can not be trusted.</span></div>
<div style="position:absolute;left:48.02px;top:626.67px" class="cls_006"><span class="cls_006">3.</span></div>
<div style="position:absolute;left:84.02px;top:626.67px" class="cls_006"><span class="cls_006">The part of the ROM containing the test code is now check-</span></div>
<div style="position:absolute;left:84.02px;top:637.67px" class="cls_006"><span class="cls_006">summed. If this passes, ROM code should be able to be correctly</span></div>
<div style="position:absolute;left:84.02px;top:648.67px" class="cls_006"><span class="cls_006">read and executed. This is a reasonable piece of confidence</span></div>
<div style="position:absolute;left:84.02px;top:659.67px" class="cls_006"><span class="cls_006">testing, but in fact if the PROM doesn’t work perfectly software</span></div>
<div style="position:absolute;left:84.02px;top:670.67px" class="cls_006"><span class="cls_006">would probably never have got here.</span></div>
<div style="position:absolute;left:84.02px;top:684.67px" class="cls_006"><span class="cls_006">Now perform IO system initialization.</span></div>
<div style="position:absolute;left:48.02px;top:698.67px" class="cls_006"><span class="cls_006">4.</span></div>
<div style="position:absolute;left:84.02px;top:698.67px" class="cls_006"><span class="cls_006">Write to PROM space (required by the VAC068 chip to drop it out</span></div>
<div style="position:absolute;left:84.02px;top:709.67px" class="cls_006"><span class="cls_006">of ‘‘reset mode’’ - where ALL cycles are decoded as for ROM).</span></div>
<div style="position:absolute;left:289.79px;top:755.33px" class="cls_002"><span class="cls_002">12-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:142756px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">WRITING POWER-ON DIAGNOSTICS</span></div>
<div style="position:absolute;left:520.62px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 12</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">5.</span></div>
<div style="position:absolute;left:264.02px;top:50.67px" class="cls_006"><span class="cls_006">Initialize the VIC and VAC chips (which control onboard IO</span></div>
<div style="position:absolute;left:264.02px;top:61.67px" class="cls_006"><span class="cls_006">cycles) with a series of register writes. The register addresses,</span></div>
<div style="position:absolute;left:264.02px;top:72.67px" class="cls_006"><span class="cls_006">and the data to be written to them, are defined in a table - which,</span></div>
<div style="position:absolute;left:264.02px;top:83.67px" class="cls_006"><span class="cls_006">as it consists only of constant data, can be defined in a C</span></div>
<div style="position:absolute;left:264.02px;top:94.67px" class="cls_006"><span class="cls_006">module.</span></div>
<div style="position:absolute;left:228.02px;top:108.67px" class="cls_006"><span class="cls_006">6.</span></div>
<div style="position:absolute;left:264.02px;top:108.67px" class="cls_006"><span class="cls_006">The SL-3000 is equipped with a board control register whose</span></div>
<div style="position:absolute;left:264.02px;top:119.67px" class="cls_006"><span class="cls_006">outputs hold various subsystems in reset; program it to reset</span></div>
<div style="position:absolute;left:264.02px;top:130.67px" class="cls_006"><span class="cls_006">everything which can be.</span></div>
<div style="position:absolute;left:228.02px;top:144.67px" class="cls_006"><span class="cls_006">7.</span></div>
<div style="position:absolute;left:264.02px;top:144.67px" class="cls_006"><span class="cls_006">Program the serial ports. They can now be used for reporting any</span></div>
<div style="position:absolute;left:264.02px;top:155.67px" class="cls_006"><span class="cls_006">problem (although they cannot yet be trusted to work).</span></div>
<div style="position:absolute;left:228.02px;top:169.67px" class="cls_006"><span class="cls_006">8.</span></div>
<div style="position:absolute;left:264.02px;top:169.67px" class="cls_006"><span class="cls_006">Wait 1 second while the user takes in the existing state of the</span></div>
<div style="position:absolute;left:264.02px;top:180.67px" class="cls_006"><span class="cls_006">LED (just in case it might be important).</span></div>
<div style="position:absolute;left:228.02px;top:194.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:194.67px" class="cls_008"><span class="cls_008">vac-reg</span><span class="cls_006">: a typical first test on an intelligent controller; pick a register</span></div>
<div style="position:absolute;left:239.98px;top:205.67px" class="cls_006"><span class="cls_006">which can be written with any 16-bit value, and read back, and which</span></div>
<div style="position:absolute;left:239.98px;top:216.67px" class="cls_006"><span class="cls_006">has no harmful side effects. This proves out the basic address paths</span></div>
<div style="position:absolute;left:239.98px;top:227.67px" class="cls_006"><span class="cls_006">in the IO system, and (half of) the data bus; and the system will</span></div>
<div style="position:absolute;left:239.98px;top:238.67px" class="cls_006"><span class="cls_006">shortly need to program the VAC device before many other parts of the</span></div>
<div style="position:absolute;left:239.98px;top:249.67px" class="cls_006"><span class="cls_006">system will work.</span></div>
<div style="position:absolute;left:228.03px;top:263.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:263.67px" class="cls_008"><span class="cls_008">led</span><span class="cls_006">: enable hex display and flash it from ‘‘0’’ to ‘‘8’’. From now on</span></div>
<div style="position:absolute;left:239.97px;top:274.67px" class="cls_006"><span class="cls_006">software will go on flashing the display to demonstrate progress.</span></div>
<div style="position:absolute;left:228.02px;top:288.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:288.67px" class="cls_008"><span class="cls_008">endian</span><span class="cls_006">: check that the PROM endianness makes sense (up to this</span></div>
<div style="position:absolute;left:239.98px;top:299.67px" class="cls_006"><span class="cls_006">point all the code is</span></div>
<div style="position:absolute;left:353.73px;top:299.67px" class="cls_006"><span class="cls_006">‘‘bi-directional’’, which involves avoiding all</span></div>
<div style="position:absolute;left:239.98px;top:310.67px" class="cls_006"><span class="cls_006">partial-word loads and stores). If the board’s configuration jumper</span></div>
<div style="position:absolute;left:239.98px;top:321.67px" class="cls_006"><span class="cls_006">and the PROM type are mismatched, flash/print an error message</span></div>
<div style="position:absolute;left:239.98px;top:332.67px" class="cls_006"><span class="cls_006">and stop.</span></div>
<div style="position:absolute;left:228.03px;top:346.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:346.67px" class="cls_008"><span class="cls_008">mem-conf</span><span class="cls_006">: check that the board is not equipped with small DRAMs</span></div>
<div style="position:absolute;left:239.98px;top:357.67px" class="cls_006"><span class="cls_006">but configured for big ones (this state leaves holes in the memory).</span></div>
<div style="position:absolute;left:228.03px;top:371.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:371.67px" class="cls_008"><span class="cls_008">mem-min</span><span class="cls_006">:  perform  minimal  memory  test.  In  the  event  of  any</span></div>
<div style="position:absolute;left:239.98px;top:382.67px" class="cls_006"><span class="cls_006">problems, report and carry on (no good can be accomplished by</span></div>
<div style="position:absolute;left:239.98px;top:393.67px" class="cls_006"><span class="cls_006">stopping).</span></div>
<div style="position:absolute;left:239.98px;top:407.67px" class="cls_006"><span class="cls_006">These tests need only cover uncached accesses to memory made while</span></div>
<div style="position:absolute;left:239.98px;top:418.67px" class="cls_006"><span class="cls_006">running uncached from PROM, and can be restricted to that portion</span></div>
<div style="position:absolute;left:239.98px;top:429.67px" class="cls_006"><span class="cls_006">of the memory used by the PROM software. They need to be restricted</span></div>
<div style="position:absolute;left:239.98px;top:440.67px" class="cls_006"><span class="cls_006">too; since the system is still running uncached, a test of the whole of</span></div>
<div style="position:absolute;left:239.98px;top:451.67px" class="cls_006"><span class="cls_006">memory would take too long.</span></div>
<div style="position:absolute;left:239.98px;top:465.67px" class="cls_006"><span class="cls_006">Once this has passed, the system is capable of supporting compiled</span></div>
<div style="position:absolute;left:239.98px;top:476.67px" class="cls_006"><span class="cls_006">test code.</span></div>
<div style="position:absolute;left:228.03px;top:490.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:490.67px" class="cls_008"><span class="cls_008">prom</span><span class="cls_006">: compute and compare a simple 32-bit add/carry checksum on</span></div>
<div style="position:absolute;left:239.97px;top:501.67px" class="cls_006"><span class="cls_006">each ‘‘package’’ in the PROM, intended to detect single-bit dropout</span></div>
<div style="position:absolute;left:239.97px;top:512.67px" class="cls_006"><span class="cls_006">and mis-programming. A zero stored checksum (an impossible result</span></div>
<div style="position:absolute;left:239.97px;top:523.67px" class="cls_006"><span class="cls_006">with add/carry) suppresses the check for those who can’t be bothered</span></div>
<div style="position:absolute;left:239.97px;top:534.67px" class="cls_006"><span class="cls_006">to maintain the checksum during PROM development.</span></div>
<div style="position:absolute;left:228.02px;top:548.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:548.67px" class="cls_008"><span class="cls_008">nvram</span><span class="cls_006">: verify checksum on NVRAM environment area. If it is wrong,</span></div>
<div style="position:absolute;left:239.97px;top:559.67px" class="cls_006"><span class="cls_006">use default environment settings. The default settings will cause tests</span></div>
<div style="position:absolute;left:239.97px;top:570.67px" class="cls_006"><span class="cls_006">to be more verbose and more thorough.</span></div>
<div style="position:absolute;left:239.97px;top:584.67px" class="cls_006"><span class="cls_006">If environment does not suppress console output, print a console</span></div>
<div style="position:absolute;left:239.97px;top:595.67px" class="cls_006"><span class="cls_006">sign-on message.</span></div>
<div style="position:absolute;left:228.02px;top:609.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:609.67px" class="cls_008"><span class="cls_008">cache</span><span class="cls_006">: figure out the size of the I- and D-caches, using the diagnostic</span></div>
<div style="position:absolute;left:239.97px;top:620.67px" class="cls_006"><span class="cls_006">isolate/swap cache features (see the chapter on cache management).</span></div>
<div style="position:absolute;left:239.97px;top:631.67px" class="cls_006"><span class="cls_006">The cache size is left in an environment variable, because system</span></div>
<div style="position:absolute;left:239.97px;top:642.67px" class="cls_006"><span class="cls_006">software will want to know it later.</span></div>
<div style="position:absolute;left:239.97px;top:656.67px" class="cls_006"><span class="cls_006">Now do simple memory tests in the caches, using an address-in-data</span></div>
<div style="position:absolute;left:239.97px;top:667.67px" class="cls_006"><span class="cls_006">test to produce different patterns. The test is coded in C and run</span></div>
<div style="position:absolute;left:239.97px;top:678.67px" class="cls_006"><span class="cls_006">uncached, using a tiny assembler subroutine to read/write a single</span></div>
<div style="position:absolute;left:239.97px;top:689.67px" class="cls_006"><span class="cls_006">word in the cache; the emphasis is on making the code as obvious as</span></div>
<div style="position:absolute;left:239.97px;top:700.67px" class="cls_006"><span class="cls_006">possible. This module cannot be tested except by chance (since all</span></div>
<div style="position:absolute;left:239.97px;top:711.67px" class="cls_006"><span class="cls_006">R30xx family CPUs work and the caches are internal) - so it had</span></div>
<div style="position:absolute;left:239.97px;top:722.67px" class="cls_006"><span class="cls_006">better be right by design.</span></div>
<div style="position:absolute;left:303.54px;top:755.33px" class="cls_002"><span class="cls_002">12-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:143558px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 12</span></div>
<div style="position:absolute;left:401.86px;top:28.00px" class="cls_002"><span class="cls_002">WRITING POWER-ON DIAGNOSTICS</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:50.67px" class="cls_008"><span class="cls_008">Refill from ROM</span><span class="cls_006">: check out cache refill from PROM. This exercises</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">some logic which puts together ROM cycles into (slow) bursts on</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">request, to allow ROM code to be run cached.</span></div>
<div style="position:absolute;left:48.03px;top:86.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:86.67px" class="cls_008"><span class="cls_008">Refill from main memory</span><span class="cls_006">: the main memory logic provides real high-</span></div>
<div style="position:absolute;left:59.98px;top:97.67px" class="cls_006"><span class="cls_006">speed bursts of data. Check that at least a pattern (which is designed</span></div>
<div style="position:absolute;left:59.98px;top:108.67px" class="cls_006"><span class="cls_006">to cause each data bit to change as much as possible) can be read.</span></div>
<div style="position:absolute;left:59.98px;top:122.67px" class="cls_006"><span class="cls_006">If all cache tests pass, further test software can be run cached where</span></div>
<div style="position:absolute;left:59.98px;top:133.67px" class="cls_006"><span class="cls_006">necessary. This is really needed - it is impracticable to run a thorough</span></div>
<div style="position:absolute;left:59.98px;top:144.67px" class="cls_006"><span class="cls_006">memory test in a reasonable period of time unless the caches are</span></div>
<div style="position:absolute;left:59.98px;top:155.67px" class="cls_006"><span class="cls_006">enabled.</span></div>
<div style="position:absolute;left:48.03px;top:169.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:169.67px" class="cls_008"><span class="cls_008">vac-timer</span><span class="cls_006">: see whether the VAC timers will run.</span></div>
<div style="position:absolute;left:48.03px;top:183.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:183.67px" class="cls_008"><span class="cls_008">fpa</span><span class="cls_006">: check for presence and consistent interrupt configuration, but do</span></div>
<div style="position:absolute;left:59.97px;top:194.67px" class="cls_006"><span class="cls_006">not expect to perform a functional test.</span></div>
<div style="position:absolute;left:48.03px;top:208.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:208.67px" class="cls_008"><span class="cls_008">nvram-rtc</span><span class="cls_006">: check for a plausible value in the real time clock registers</span></div>
<div style="position:absolute;left:59.98px;top:219.67px" class="cls_006"><span class="cls_006">and record it.</span></div>
<div style="position:absolute;left:48.03px;top:233.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:233.67px" class="cls_008"><span class="cls_008">vic-reg</span><span class="cls_006">: write/read test on VIC068 registers.</span></div>
<div style="position:absolute;left:48.03px;top:247.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:247.67px" class="cls_008"><span class="cls_008">vic-timeout</span><span class="cls_006">: the VIC068 is used to timeout local bus accesses to</span></div>
<div style="position:absolute;left:59.98px;top:258.67px" class="cls_006"><span class="cls_006">nonexistent locations. Make sure this works and causes a bus error</span></div>
<div style="position:absolute;left:59.98px;top:269.67px" class="cls_006"><span class="cls_006">(involves catching the exception).</span></div>
<div style="position:absolute;left:48.03px;top:283.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:283.67px" class="cls_008"><span class="cls_008">vic-timer</span><span class="cls_006">: check that the VIC068 interval timer is giving periodic</span></div>
<div style="position:absolute;left:59.97px;top:294.67px" class="cls_006"><span class="cls_006">interrupts.</span></div>
<div style="position:absolute;left:48.03px;top:308.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:308.67px" class="cls_008"><span class="cls_008">vic-int</span><span class="cls_006">: check that VIC interrupts are getting through to the CPU, and</span></div>
<div style="position:absolute;left:59.98px;top:319.67px" class="cls_006"><span class="cls_006">that the interrupt acknowledge mechanism works.</span></div>
<div style="position:absolute;left:48.03px;top:333.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:333.67px" class="cls_008"><span class="cls_008">vic-scon</span><span class="cls_006">:   obtain   whatever   detail   is   available   on   the   VMEbus</span></div>
<div style="position:absolute;left:59.98px;top:344.67px" class="cls_006"><span class="cls_006">environment without doing anything. This includes reporting on</span></div>
<div style="position:absolute;left:59.98px;top:355.67px" class="cls_006"><span class="cls_006">whether the board is configured as system controller, and the state of</span></div>
<div style="position:absolute;left:59.98px;top:366.67px" class="cls_006"><span class="cls_006">the backplane SYSRESET* and ACFAIL* lines.</span></div>
<div style="position:absolute;left:48.03px;top:380.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:380.67px" class="cls_008"><span class="cls_008">mem-best</span><span class="cls_006">: ‘‘best-efforts’’ is necessarily relative to the amount of time</span></div>
<div style="position:absolute;left:59.98px;top:391.67px" class="cls_006"><span class="cls_006">allowed for testing memory (Algorithmics believes something around</span></div>
<div style="position:absolute;left:59.98px;top:402.67px" class="cls_006"><span class="cls_006">10s is sensible). This small amount of time allows nothing more</span></div>
<div style="position:absolute;left:59.98px;top:413.67px" class="cls_006"><span class="cls_006">complex than an address-in-address test. Speed is probably more</span></div>
<div style="position:absolute;left:59.98px;top:424.67px" class="cls_006"><span class="cls_006">useful than theoretical thoroughness.</span></div>
<div style="position:absolute;left:59.98px;top:438.67px" class="cls_006"><span class="cls_006">The diagnostic will report the memory size into an environment</span></div>
<div style="position:absolute;left:59.98px;top:449.67px" class="cls_006"><span class="cls_006">variable.</span></div>
<div style="position:absolute;left:48.03px;top:463.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:463.67px" class="cls_008"><span class="cls_008">mem-parity</span><span class="cls_006">: use the diagnostic area to write bad parity to a memory</span></div>
<div style="position:absolute;left:59.97px;top:474.67px" class="cls_006"><span class="cls_006">location, and then test that it is detected and reported.</span></div>
<div style="position:absolute;left:48.02px;top:488.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:488.67px" class="cls_008"><span class="cls_008">mem-soak</span><span class="cls_006">: optionally (enabled by an NVRAM environment entry) run</span></div>
<div style="position:absolute;left:59.98px;top:499.67px" class="cls_006"><span class="cls_006">a much more complete memory test. Parity checking can be used to</span></div>
<div style="position:absolute;left:59.98px;top:510.67px" class="cls_006"><span class="cls_006">detect errors.</span></div>
<div style="position:absolute;left:48.03px;top:524.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:524.67px" class="cls_008"><span class="cls_008">uart-reg</span><span class="cls_006">: check out 72001 UART connections by write/read registers.</span></div>
<div style="position:absolute;left:48.03px;top:538.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:538.67px" class="cls_008"><span class="cls_008">uart-init</span><span class="cls_006">: check out that serial ports are responding (to the extent</span></div>
<div style="position:absolute;left:59.97px;top:549.67px" class="cls_006"><span class="cls_006">possible without writing characters to any but the console).</span></div>
<div style="position:absolute;left:48.03px;top:563.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:563.67px" class="cls_008"><span class="cls_008">eth-reg</span><span class="cls_006">: write and read-back test of register bits. Program up the</span></div>
<div style="position:absolute;left:59.98px;top:574.67px" class="cls_006"><span class="cls_006">controller and look for plausible status.</span></div>
<div style="position:absolute;left:59.98px;top:588.67px" class="cls_006"><span class="cls_006">Note that no test is made for the presence of a transceiver or a</span></div>
<div style="position:absolute;left:59.98px;top:599.67px" class="cls_006"><span class="cls_006">network connection. Higher level bootstrap software should take care</span></div>
<div style="position:absolute;left:59.98px;top:610.67px" class="cls_006"><span class="cls_006">to report such conditions.</span></div>
<div style="position:absolute;left:48.03px;top:624.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:624.67px" class="cls_008"><span class="cls_008">eth-read/eth-int</span><span class="cls_006">: persuade the SONIC to read memory as master, by</span></div>
<div style="position:absolute;left:59.97px;top:635.67px" class="cls_006"><span class="cls_006">issuing a ‘‘load CAM’’ command.</span></div>
<div style="position:absolute;left:59.97px;top:649.67px" class="cls_006"><span class="cls_006">Completion of the load will cause an interrupt; track this through the</span></div>
<div style="position:absolute;left:59.97px;top:660.67px" class="cls_006"><span class="cls_006">VIC and to the CPU pin. Note that it is quite legitimate to do this with</span></div>
<div style="position:absolute;left:59.97px;top:671.67px" class="cls_006"><span class="cls_006">interrupts disabled in the CPU; the CPU can see the state of its pins.</span></div>
<div style="position:absolute;left:48.02px;top:685.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:685.67px" class="cls_008"><span class="cls_008">eth-write</span><span class="cls_006">: persuade the ethernet to write something to memory and</span></div>
<div style="position:absolute;left:59.97px;top:696.67px" class="cls_006"><span class="cls_006">check it. This may involve an internal loopback command, but</span></div>
<div style="position:absolute;left:59.97px;top:707.67px" class="cls_006"><span class="cls_006">anything which writes memory will do.</span></div>
<div style="position:absolute;left:59.97px;top:721.67px" class="cls_006"><span class="cls_006">After the test the ethernet controller will be reset.</span></div>
<div style="position:absolute;left:289.79px;top:755.33px" class="cls_002"><span class="cls_002">12-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:144360px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:49.99px;top:28.00px" class="cls_002"><span class="cls_002">WRITING POWER-ON DIAGNOSTICS</span></div>
<div style="position:absolute;left:520.61px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 12</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> scsi-reg</span><span class="cls_006">: register write/read of 53C710 controller.</span></div>
<div style="position:absolute;left:239.98px;top:64.67px" class="cls_006"><span class="cls_006">The way the SCSI controller is wired -up allows diagnostic software to</span></div>
<div style="position:absolute;left:239.98px;top:75.67px" class="cls_006"><span class="cls_006">check that the IO bus byte swapper is configured as expected by the</span></div>
<div style="position:absolute;left:239.98px;top:86.67px" class="cls_006"><span class="cls_006">PROM. This is particularly important because the byte-swapper is</span></div>
<div style="position:absolute;left:239.98px;top:97.67px" class="cls_006"><span class="cls_006">mainly used for network and SCSI data, and corruption to these won’t</span></div>
<div style="position:absolute;left:239.98px;top:108.67px" class="cls_006"><span class="cls_006">be noticed until an embarrassingly long way into bootstrapping.</span></div>
<div style="position:absolute;left:239.98px;top:119.67px" class="cls_006"><span class="cls_006">Software records the actual CPU and IO endianness in environment</span></div>
<div style="position:absolute;left:239.98px;top:130.67px" class="cls_006"><span class="cls_006">variables.</span></div>
<div style="position:absolute;left:228.03px;top:144.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> scsi-read</span><span class="cls_006">: persuade the 53C710 to read memory (by persuading it to</span></div>
<div style="position:absolute;left:239.98px;top:155.67px" class="cls_006"><span class="cls_006">read a very simple SCRIPT) and check. This causes an interrupt,</span></div>
<div style="position:absolute;left:239.98px;top:166.67px" class="cls_006"><span class="cls_006">which the diagnostic checks can be delivered all the way to the CPU</span></div>
<div style="position:absolute;left:239.98px;top:177.67px" class="cls_006"><span class="cls_006">pins.</span></div>
<div style="position:absolute;left:228.03px;top:191.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> scsi-write</span><span class="cls_006">: get the 53C710 to write to memory and check it.</span></div>
<div style="position:absolute;left:239.97px;top:205.67px" class="cls_006"><span class="cls_006">Leave the SCSI controller reset after the test.</span></div>
<div style="position:absolute;left:216.00px;top:228.00px" class="cls_015"><span class="cls_015">Annotated examples from the test code</span></div>
<div style="position:absolute;left:228.02px;top:241.67px" class="cls_006"><span class="cls_006">These examples concentrate on the first, low-level code which has to be</span></div>
<div style="position:absolute;left:216.00px;top:252.67px" class="cls_006"><span class="cls_006">in assembler (since writable memory is not yet trusted, and C code can’t</span></div>
<div style="position:absolute;left:216.00px;top:263.67px" class="cls_006"><span class="cls_006">be used without some memory for a stack).</span></div>
<div style="position:absolute;left:228.02px;top:277.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:277.67px" class="cls_008"><span class="cls_008">Starting Up</span><span class="cls_006">: the PROM is linked with its first module starting like this</span></div>
<div style="position:absolute;left:239.98px;top:288.67px" class="cls_006"><span class="cls_006">(observe that the ‘‘li’’ which identifies this as an absolute reset is</span></div>
<div style="position:absolute;left:239.98px;top:299.67px" class="cls_006"><span class="cls_006">explicitly placed in the branch delay slot of the jump):</span></div>
<div style="position:absolute;left:288.00px;top:321.00px" class="cls_028"><span class="cls_028">.text</span></div>
<div style="position:absolute;left:288.00px;top:331.00px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.10px;top:331.00px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:252.00px;top:341.00px" class="cls_028"><span class="cls_028">_stext:</span></div>
<div style="position:absolute;left:252.00px;top:351.00px" class="cls_028"><span class="cls_028">bt_rvec:</span></div>
<div style="position:absolute;left:288.00px;top:361.00px" class="cls_028"><span class="cls_028">j bt_bootpkg; li a0, 7</span></div>
<div style="position:absolute;left:288.00px;top:381.00px" class="cls_028"><span class="cls_028">/* a lot later is the exception vector, 0x180 bytes</span></div>
<div style="position:absolute;left:293.40px;top:390.99px" class="cls_028"><span class="cls_028">* up</span></div>
<div style="position:absolute;left:293.40px;top:400.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:288.00px;top:420.99px" class="cls_028"><span class="cls_028">j it_bevgen; nop</span></div>
<div style="position:absolute;left:239.98px;top:443.67px" class="cls_006"><span class="cls_006">This jumps to start off the real code, which in this case is designed for</span></div>
<div style="position:absolute;left:239.98px;top:454.67px" class="cls_006"><span class="cls_006">a  PROM  space  broken  up  into  ‘‘packages’’  each  of  which  is  a</span></div>
<div style="position:absolute;left:239.98px;top:465.67px" class="cls_006"><span class="cls_006">separately-linked program. But the first few instructions are likely to</span></div>
<div style="position:absolute;left:239.98px;top:476.67px" class="cls_006"><span class="cls_006">be required on pretty much any start-up PROM.</span></div>
<div style="position:absolute;left:239.98px;top:490.67px" class="cls_006"><span class="cls_006">Zero is placed into </span><span class="cls_008">k0</span><span class="cls_006"> because the exception routine uses this as a flag</span></div>
<div style="position:absolute;left:239.97px;top:501.67px" class="cls_006"><span class="cls_006">- a nonzero value in </span><span class="cls_008">k0</span><span class="cls_006"> will be taken as the address of a user-installed</span></div>
<div style="position:absolute;left:239.98px;top:512.67px" class="cls_006"><span class="cls_006">exception routine.</span></div>
<div style="position:absolute;left:252.00px;top:534.00px" class="cls_028"><span class="cls_028">LEAF(bt_bootpkg)</span></div>
<div style="position:absolute;left:288.00px;top:553.99px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.10px;top:553.99px" class="cls_028"><span class="cls_028">k0,zero</span></div>
<div style="position:absolute;left:288.00px;top:573.99px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:324.10px;top:573.99px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:288.00px;top:593.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:593.99px" class="cls_028"><span class="cls_028">s1,SR_BEV</span></div>
<div style="position:absolute;left:396.26px;top:593.99px" class="cls_028"><span class="cls_028">/* complete SR initialization:-} */</span></div>
<div style="position:absolute;left:288.00px;top:603.99px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:324.10px;top:603.99px" class="cls_028"><span class="cls_028">s1,sr</span></div>
<div style="position:absolute;left:288.00px;top:613.99px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:288.00px;top:623.99px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:239.98px;top:646.67px" class="cls_006"><span class="cls_006">After two ‘‘nop’’s the new status register has taken effect and the CPU</span></div>
<div style="position:absolute;left:239.98px;top:657.67px" class="cls_006"><span class="cls_006">can be trusted. Software can now save the </span><span class="cls_008">epc</span><span class="cls_006"> and </span><span class="cls_008">ra</span><span class="cls_006"> registers, which</span></div>
<div style="position:absolute;left:239.98px;top:668.67px" class="cls_006"><span class="cls_006">are potentially useful in telling users what was happening before</span></div>
<div style="position:absolute;left:239.98px;top:679.67px" class="cls_006"><span class="cls_006">reset:</span></div>
<div style="position:absolute;left:288.00px;top:701.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:292.86px;top:711.00px" class="cls_028"><span class="cls_028">* save epc & ra so that they can be passed to package</span></div>
<div style="position:absolute;left:293.40px;top:721.00px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:303.53px;top:755.33px" class="cls_002"><span class="cls_002">12-9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:145162px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 12</span></div>
<div style="position:absolute;left:401.86px;top:28.00px" class="cls_002"><span class="cls_002">WRITING POWER-ON DIAGNOSTICS</span></div>
<div style="position:absolute;left:108.00px;top:51.00px" class="cls_028"><span class="cls_028">mfc0</span></div>
<div style="position:absolute;left:144.09px;top:51.00px" class="cls_028"><span class="cls_028">s1,epc</span></div>
<div style="position:absolute;left:108.00px;top:61.00px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:61.00px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:108.00px;top:71.00px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:71.00px" class="cls_028"><span class="cls_028">s2,ra</span></div>
<div style="position:absolute;left:59.98px;top:93.67px" class="cls_006"><span class="cls_006">Now read the ‘‘package’’ record, which is a little bit of PROM space at</span></div>
<div style="position:absolute;left:59.98px;top:104.67px" class="cls_006"><span class="cls_006">a well known address (1024 bytes above the start of the PROM). Each</span></div>
<div style="position:absolute;left:59.98px;top:115.67px" class="cls_006"><span class="cls_006">of</span></div>
<div style="position:absolute;left:75.23px;top:115.67px" class="cls_006"><span class="cls_006">8 possible records contains 4 words of information: a magic</span></div>
<div style="position:absolute;left:59.98px;top:126.67px" class="cls_006"><span class="cls_006">number, the start address, end address, a checksum, and a start</span></div>
<div style="position:absolute;left:59.98px;top:137.67px" class="cls_006"><span class="cls_006">location.</span></div>
<div style="position:absolute;left:59.98px;top:151.67px" class="cls_006"><span class="cls_006">The register </span><span class="cls_008">a0</span><span class="cls_006"> (conventionally used for the first argument of a</span></div>
<div style="position:absolute;left:59.98px;top:162.67px" class="cls_006"><span class="cls_006">subroutine) is used to pick one of 8 packages to run, and the 7th</span></div>
<div style="position:absolute;left:59.98px;top:173.67px" class="cls_006"><span class="cls_006">points to the start of the power-on tests:</span></div>
<div style="position:absolute;left:108.00px;top:195.00px" class="cls_028"><span class="cls_028">bltu</span></div>
<div style="position:absolute;left:144.09px;top:195.00px" class="cls_028"><span class="cls_028">a0,NPKG,1f</span></div>
<div style="position:absolute;left:216.33px;top:195.00px" class="cls_028"><span class="cls_028"># make sure package is in range</span></div>
<div style="position:absolute;left:108.00px;top:205.00px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:205.00px" class="cls_028"><span class="cls_028">a0,NPKG-1</span></div>
<div style="position:absolute;left:72.00px;top:215.00px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:108.00px;top:225.00px" class="cls_028"><span class="cls_028">/* get pointer to package info */</span></div>
<div style="position:absolute;left:108.00px;top:235.00px" class="cls_028"><span class="cls_028">sll</span></div>
<div style="position:absolute;left:144.07px;top:235.00px" class="cls_028"><span class="cls_028">a0,PKGSHIFT+2</span></div>
<div style="position:absolute;left:108.00px;top:244.99px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:144.05px;top:244.99px" class="cls_028"><span class="cls_028">s0,bt_pkginfo</span></div>
<div style="position:absolute;left:108.00px;top:254.99px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:144.09px;top:254.99px" class="cls_028"><span class="cls_028">s0,a0</span></div>
<div style="position:absolute;left:108.00px;top:274.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:274.99px" class="cls_028"><span class="cls_028">t0,oMAGIC(s0) # get magic number</span></div>
<div style="position:absolute;left:108.00px;top:284.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:284.99px" class="cls_028"><span class="cls_028">a0,BT_BADPKG</span></div>
<div style="position:absolute;left:108.00px;top:294.99px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:144.07px;top:294.99px" class="cls_028"><span class="cls_028">t0,+BTMAGIC,bt_fail# must be same as us</span></div>
<div style="position:absolute;left:59.98px;top:317.67px" class="cls_006"><span class="cls_006">Now the diagnostic will calculate a checksum for all the PROM</span></div>
<div style="position:absolute;left:59.98px;top:328.67px" class="cls_006"><span class="cls_006">locations for the code and constant data of the power-on test code.</span></div>
<div style="position:absolute;left:59.98px;top:339.67px" class="cls_006"><span class="cls_006">Note that, even without a stack, software can call a subroutine; recall</span></div>
<div style="position:absolute;left:59.98px;top:350.67px" class="cls_006"><span class="cls_006">that the MIPS hardware implements no stack functions, and the</span></div>
<div style="position:absolute;left:59.98px;top:361.67px" class="cls_006"><span class="cls_006">subroutine call instruction (‘‘jal’’ for jump-and-link) puts the return</span></div>
<div style="position:absolute;left:59.98px;top:372.67px" class="cls_006"><span class="cls_006">address into register </span><span class="cls_008">ra.</span></div>
<div style="position:absolute;left:108.00px;top:394.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:394.00px" class="cls_028"><span class="cls_028">a0,oSTART(s0)</span></div>
<div style="position:absolute;left:108.00px;top:404.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:404.00px" class="cls_028"><span class="cls_028">a1,oEND(s0)</span></div>
<div style="position:absolute;left:108.00px;top:414.00px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:144.07px;top:414.00px" class="cls_028"><span class="cls_028">bt_chksum</span></div>
<div style="position:absolute;left:108.00px;top:434.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:434.00px" class="cls_028"><span class="cls_028">t0,oSUM(s0)</span></div>
<div style="position:absolute;left:108.00px;top:443.99px" class="cls_028"><span class="cls_028">beq</span></div>
<div style="position:absolute;left:144.07px;top:443.99px" class="cls_028"><span class="cls_028">t0,v0,1f</span></div>
<div style="position:absolute;left:216.25px;top:443.99px" class="cls_028"><span class="cls_028"># good checksum?</span></div>
<div style="position:absolute;left:72.00px;top:463.99px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:108.00px;top:473.99px" class="cls_028"><span class="cls_028">/* jump at selected code */</span></div>
<div style="position:absolute;left:108.00px;top:483.99px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:483.99px" class="cls_028"><span class="cls_028">a0,s1</span></div>
<div style="position:absolute;left:108.00px;top:493.99px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:493.99px" class="cls_028"><span class="cls_028">a1,s2</span></div>
<div style="position:absolute;left:108.00px;top:503.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:503.99px" class="cls_028"><span class="cls_028">t0,oENTRY(s0)</span></div>
<div style="position:absolute;left:108.00px;top:513.99px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:513.99px" class="cls_028"><span class="cls_028">t0</span></div>
<div style="position:absolute;left:72.00px;top:523.99px" class="cls_028"><span class="cls_028">END(bt_bootpkg)</span></div>
<div style="position:absolute;left:59.98px;top:546.67px" class="cls_006"><span class="cls_006">Now the boot process really gets started. </span><span class="cls_008">it_main</span><span class="cls_006"> implements the test</span></div>
<div style="position:absolute;left:59.98px;top:557.67px" class="cls_006"><span class="cls_006">sequence. Once again it is possible to call one level of subroutine</span></div>
<div style="position:absolute;left:59.98px;top:568.67px" class="cls_006"><span class="cls_006">without a problem:</span></div>
<div style="position:absolute;left:72.00px;top:590.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:77.40px;top:600.00px" class="cls_028"><span class="cls_028">* entry point for integrated tests</span></div>
<div style="position:absolute;left:77.40px;top:610.00px" class="cls_028"><span class="cls_028">* a0,a1 contains epc,ra</span></div>
<div style="position:absolute;left:77.40px;top:620.00px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:72.00px;top:630.00px" class="cls_028"><span class="cls_028">NESTED(it_main,0,ra)</span></div>
<div style="position:absolute;left:108.00px;top:649.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:649.99px" class="cls_028"><span class="cls_028">v0,SR_BEV|SR_PE</span></div>
<div style="position:absolute;left:108.00px;top:659.99px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:659.99px" class="cls_028"><span class="cls_028">noreorder</span></div>
<div style="position:absolute;left:108.00px;top:669.99px" class="cls_028"><span class="cls_028">mtc0</span></div>
<div style="position:absolute;left:144.09px;top:669.99px" class="cls_028"><span class="cls_028">v0,sr</span></div>
<div style="position:absolute;left:108.00px;top:679.99px" class="cls_028"><span class="cls_028">.set</span></div>
<div style="position:absolute;left:144.09px;top:679.99px" class="cls_028"><span class="cls_028">reorder</span></div>
<div style="position:absolute;left:108.00px;top:699.99px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:699.99px" class="cls_028"><span class="cls_028">s0,a0</span></div>
<div style="position:absolute;left:108.00px;top:709.99px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:709.99px" class="cls_028"><span class="cls_028">s1,a1</span></div>
<div style="position:absolute;left:287.55px;top:755.34px" class="cls_002"><span class="cls_002">12-10</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:145964px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">WRITING POWER-ON DIAGNOSTICS</span></div>
<div style="position:absolute;left:520.62px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 12</span></div>
<div style="position:absolute;left:288.00px;top:51.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:293.40px;top:61.00px" class="cls_028"><span class="cls_028">* initialize the board and IO systems</span></div>
<div style="position:absolute;left:293.40px;top:71.00px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:288.00px;top:81.00px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:81.00px" class="cls_028"><span class="cls_028">sbd_init</span></div>
<div style="position:absolute;left:288.00px;top:91.00px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:91.00px" class="cls_028"><span class="cls_028">sbd_ioinit</span></div>
<div style="position:absolute;left:288.00px;top:120.99px" class="cls_028"><span class="cls_028">/* to see LED state */</span></div>
<div style="position:absolute;left:288.00px;top:130.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:130.99px" class="cls_028"><span class="cls_028">a0,250</span></div>
<div style="position:absolute;left:288.00px;top:140.99px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:140.99px" class="cls_028"><span class="cls_028">sbd_msdelay/* a VERY rough 250ms pause */</span></div>
<div style="position:absolute;left:288.00px;top:160.99px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:160.99px" class="cls_028"><span class="cls_028">sbd_basic/* tests before memory sizing */</span></div>
<div style="position:absolute;left:288.00px;top:170.99px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.09px;top:170.99px" class="cls_028"><span class="cls_028">s2,v0</span></div>
<div style="position:absolute;left:396.21px;top:170.99px" class="cls_028"><span class="cls_028">/* save memory size */</span></div>
<div style="position:absolute;left:288.00px;top:190.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:190.99px" class="cls_028"><span class="cls_028">a0,PA_TO_KVA1(0)</span></div>
<div style="position:absolute;left:288.00px;top:200.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:200.99px" class="cls_028"><span class="cls_028">a1,0x10000</span></div>
<div style="position:absolute;left:288.00px;top:210.98px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:210.98px" class="cls_028"><span class="cls_028">sbd_memmin/* test 1 Mbyte of memory from 0 */</span></div>
<div style="position:absolute;left:228.02px;top:230.67px" class="cls_006"><span class="cls_006">Now the software can trust the memory. After saving a few things in</span></div>
<div style="position:absolute;left:216.00px;top:241.67px" class="cls_006"><span class="cls_006">their assigned global locations, a stack is defined and the program is</span></div>
<div style="position:absolute;left:216.00px;top:252.67px" class="cls_006"><span class="cls_006">written in C:</span></div>
<div style="position:absolute;left:288.00px;top:274.00px" class="cls_028"><span class="cls_028">/* at last put them into memory */</span></div>
<div style="position:absolute;left:288.00px;top:284.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:284.00px" class="cls_028"><span class="cls_028">s0,epc_at_restart</span></div>
<div style="position:absolute;left:288.00px;top:294.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:294.00px" class="cls_028"><span class="cls_028">s1,ra_at_restart</span></div>
<div style="position:absolute;left:288.00px;top:304.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:304.00px" class="cls_028"><span class="cls_028">s2,mem_size</span></div>
<div style="position:absolute;left:288.00px;top:323.99px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:293.40px;top:333.99px" class="cls_028"><span class="cls_028">* might have usable memory so give up on the</span></div>
<div style="position:absolute;left:293.40px;top:343.99px" class="cls_028"><span class="cls_028">* assembler and use C</span></div>
<div style="position:absolute;left:293.40px;top:353.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:288.00px;top:363.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:363.99px" class="cls_028"><span class="cls_028">sp,PA_TO_KVA1(0xfffc)</span></div>
<div style="position:absolute;left:288.00px;top:373.99px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:373.99px" class="cls_028"><span class="cls_028">it_cmain</span></div>
<div style="position:absolute;left:228.02px;top:393.67px" class="cls_006"><span class="cls_006">Note that it doesn’t really return, just goes off and finds the next</span></div>
<div style="position:absolute;left:216.00px;top:404.67px" class="cls_006"><span class="cls_006">package.</span></div>
<div style="position:absolute;left:288.00px;top:426.00px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:426.00px" class="cls_028"><span class="cls_028">sbd_closedown</span></div>
<div style="position:absolute;left:288.00px;top:446.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:293.40px;top:456.00px" class="cls_028"><span class="cls_028">* tests have completed so execute next package</span></div>
<div style="position:absolute;left:293.40px;top:466.00px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:288.00px;top:475.99px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:324.09px;top:475.99px" class="cls_028"><span class="cls_028">a0,v0</span></div>
<div style="position:absolute;left:288.00px;top:485.99px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.02px;top:485.99px" class="cls_028"><span class="cls_028">bt_bootpkg</span></div>
<div style="position:absolute;left:252.00px;top:495.99px" class="cls_028"><span class="cls_028">END(it_main)</span></div>
<div style="position:absolute;left:228.02px;top:515.67px" class="cls_006"><span class="cls_006">This   next   section   describes   how   some   of   the   more   significant</span></div>
<div style="position:absolute;left:216.00px;top:526.67px" class="cls_006"><span class="cls_006">subroutines are implemented.</span></div>
<div style="position:absolute;left:228.02px;top:540.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> sbd_init</span><span class="cls_006">: The SL-3000 hardware suffers from intelligent peripheral</span></div>
<div style="position:absolute;left:239.97px;top:551.67px" class="cls_006"><span class="cls_006">controllers which require to be programmed in a precise sequence;</span></div>
<div style="position:absolute;left:239.97px;top:562.67px" class="cls_006"><span class="cls_006">until this is done many ‘‘normal’’ functions just don’t work.</span></div>
<div style="position:absolute;left:228.02px;top:573.67px" class="cls_006"><span class="cls_006">The code has to do a dummy write to ROM space first (the programmable</span></div>
<div style="position:absolute;left:216.00px;top:584.67px" class="cls_006"><span class="cls_006">decoder, from reset, will map every cycle onto ROM space):</span></div>
<div style="position:absolute;left:252.00px;top:606.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:257.40px;top:616.00px" class="cls_028"><span class="cls_028">* basic initialization</span></div>
<div style="position:absolute;left:257.40px;top:626.00px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.00px;top:636.00px" class="cls_028"><span class="cls_028">LEAF(sbd_init)</span></div>
<div style="position:absolute;left:288.00px;top:646.00px" class="cls_028"><span class="cls_028">/* kick VAC068 out of force eprom mode */</span></div>
<div style="position:absolute;left:288.00px;top:655.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:655.99px" class="cls_028"><span class="cls_028">zero,PA_TO_KVA1(LOCAL_PROM)</span></div>
<div style="position:absolute;left:228.02px;top:675.67px" class="cls_006"><span class="cls_006">Now the program uses a table of register addresses and values to be</span></div>
<div style="position:absolute;left:216.00px;top:686.67px" class="cls_006"><span class="cls_006">written to them. The table itself can be defined in a C module, making it</span></div>
<div style="position:absolute;left:216.00px;top:697.67px" class="cls_006"><span class="cls_006">readable and allowing the use of the same header files as for more complex</span></div>
<div style="position:absolute;left:216.00px;top:708.67px" class="cls_006"><span class="cls_006">device drivers:</span></div>
<div style="position:absolute;left:301.30px;top:755.34px" class="cls_002"><span class="cls_002">12-11</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:146766px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 12</span></div>
<div style="position:absolute;left:401.86px;top:28.00px" class="cls_002"><span class="cls_002">WRITING POWER-ON DIAGNOSTICS</span></div>
<div style="position:absolute;left:108.00px;top:61.00px" class="cls_028"><span class="cls_028">/* initialize VAC registers */</span></div>
<div style="position:absolute;left:108.00px;top:71.00px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:144.05px;top:71.00px" class="cls_028"><span class="cls_028">a0,vicvacresettab</span></div>
<div style="position:absolute;left:72.00px;top:81.00px" class="cls_028"><span class="cls_028">vicvacdefloop:</span></div>
<div style="position:absolute;left:108.00px;top:91.00px" class="cls_028"><span class="cls_028">/* v0 gets pointer to VIC/VAC register */</span></div>
<div style="position:absolute;left:108.00px;top:101.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:101.00px" class="cls_028"><span class="cls_028">v0,0(a0)</span></div>
<div style="position:absolute;left:108.00px;top:120.99px" class="cls_028"><span class="cls_028">beqz</span></div>
<div style="position:absolute;left:144.09px;top:120.99px" class="cls_028"><span class="cls_028">v0,vicvacdefend</span></div>
<div style="position:absolute;left:108.00px;top:140.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:140.99px" class="cls_028"><span class="cls_028">v1,4(a0)</span></div>
<div style="position:absolute;left:108.00px;top:150.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:150.99px" class="cls_028"><span class="cls_028">v1,0(v0)</span></div>
<div style="position:absolute;left:108.00px;top:170.99px" class="cls_028"><span class="cls_028">add</span></div>
<div style="position:absolute;left:144.07px;top:170.99px" class="cls_028"><span class="cls_028">a0,8</span></div>
<div style="position:absolute;left:108.00px;top:180.99px" class="cls_028"><span class="cls_028">b</span></div>
<div style="position:absolute;left:144.02px;top:180.99px" class="cls_028"><span class="cls_028">vicvacdefloop</span></div>
<div style="position:absolute;left:72.00px;top:190.99px" class="cls_028"><span class="cls_028">vicvacdefend:</span></div>
<div style="position:absolute;left:48.02px;top:210.67px" class="cls_006"><span class="cls_006">Now the board appears to work, so the code kind of starts again. The</span></div>
<div style="position:absolute;left:36.00px;top:221.67px" class="cls_006"><span class="cls_006">‘‘BCRR’’  address  is  a  hardware  register  whose  outputs  hold  most</span></div>
<div style="position:absolute;left:36.00px;top:232.67px" class="cls_006"><span class="cls_006">subsystems in reset:</span></div>
<div style="position:absolute;left:108.00px;top:254.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:113.40px;top:264.00px" class="cls_028"><span class="cls_028">* hold all devices in reset and disable LED</span></div>
<div style="position:absolute;left:113.40px;top:274.00px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:108.00px;top:284.00px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:284.00px" class="cls_028"><span class="cls_028">v0,BCRR_LBLK</span></div>
<div style="position:absolute;left:108.00px;top:294.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:294.00px" class="cls_028"><span class="cls_028">v0,PA_TO_KVA1(BCRR)</span></div>
<div style="position:absolute;left:108.00px;top:313.99px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:113.40px;top:323.99px" class="cls_028"><span class="cls_028">* VIC will bus error any accesses made while SYSRST</span></div>
<div style="position:absolute;left:113.40px;top:333.99px" class="cls_028"><span class="cls_028">* is active so wait until SYSRST goes away</span></div>
<div style="position:absolute;left:113.40px;top:343.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:108.00px;top:353.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:353.99px" class="cls_028"><span class="cls_028">v0,PA_TO_KVA1(BCRR)</span></div>
<div style="position:absolute;left:72.00px;top:363.99px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:108.05px;top:363.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.09px;top:363.99px" class="cls_028"><span class="cls_028">v1,0(v0)</span></div>
<div style="position:absolute;left:108.00px;top:373.99px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.07px;top:373.99px" class="cls_028"><span class="cls_028">v1,BCRR_SYSRST</span></div>
<div style="position:absolute;left:108.00px;top:383.99px" class="cls_028"><span class="cls_028">beqz</span></div>
<div style="position:absolute;left:144.09px;top:383.99px" class="cls_028"><span class="cls_028">v1,1b</span></div>
<div style="position:absolute;left:48.02px;top:403.67px" class="cls_006"><span class="cls_006">This breaks the earlier rules (this is a loop which can continue for ever)</span></div>
<div style="position:absolute;left:36.00px;top:414.67px" class="cls_006"><span class="cls_006">but with all local bus cycles being terminated with a bus error the system</span></div>
<div style="position:absolute;left:36.00px;top:425.67px" class="cls_006"><span class="cls_006">should not hang in an infinite loop.</span></div>
<div style="position:absolute;left:48.02px;top:436.67px" class="cls_006"><span class="cls_006">The VMEbus power-on test convention is that each board should assert</span></div>
<div style="position:absolute;left:36.00px;top:447.67px" class="cls_006"><span class="cls_006">the SYSFAIL* signal until it has passed its power-on tests. So for the</span></div>
<div style="position:absolute;left:36.00px;top:458.67px" class="cls_006"><span class="cls_006">moment, assert it:</span></div>
<div style="position:absolute;left:108.00px;top:490.00px" class="cls_028"><span class="cls_028">/* make sure that SYSFAIL is asserted with a ’reset’</span></div>
<div style="position:absolute;left:113.40px;top:500.00px" class="cls_028"><span class="cls_028">* code</span></div>
<div style="position:absolute;left:113.40px;top:510.00px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:108.00px;top:520.00px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:520.00px" class="cls_028"><span class="cls_028">v0,VIC_SYSFAIL|VIC_STATLRESET</span></div>
<div style="position:absolute;left:108.00px;top:529.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:529.99px" class="cls_028"><span class="cls_028">v0,VIC_VSTATUS</span></div>
<div style="position:absolute;left:108.00px;top:549.99px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:549.99px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:72.00px;top:559.99px" class="cls_028"><span class="cls_028">END(sbd_init)</span></div>
<div style="position:absolute;left:48.02px;top:582.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Doing without a stack</span><span class="cls_006">: more complex test software would like to be</span></div>
<div style="position:absolute;left:59.97px;top:593.67px" class="cls_006"><span class="cls_006">able to call subroutines. But without a memory-based stack, it is</span></div>
<div style="position:absolute;left:59.97px;top:604.67px" class="cls_006"><span class="cls_006">impossible to properly track the return address. Therefor, the early</span></div>
<div style="position:absolute;left:59.97px;top:615.67px" class="cls_006"><span class="cls_006">tests borrow three of the 32 registers and define a pseudo-stack and</span></div>
<div style="position:absolute;left:59.97px;top:626.67px" class="cls_006"><span class="cls_006">a couple of macros to use at the beginning and end of subroutines.</span></div>
<div style="position:absolute;left:59.97px;top:640.67px" class="cls_006"><span class="cls_006">These are for use in assembly code, but are implemented with the C</span></div>
<div style="position:absolute;left:59.97px;top:651.67px" class="cls_006"><span class="cls_006">preprocessor:</span></div>
<div style="position:absolute;left:72.00px;top:673.00px" class="cls_028"><span class="cls_028">#define _t6$14</span></div>
<div style="position:absolute;left:72.00px;top:683.00px" class="cls_028"><span class="cls_028">#define _t7$15</span></div>
<div style="position:absolute;left:72.00px;top:693.00px" class="cls_028"><span class="cls_028">#define _gp$28</span></div>
<div style="position:absolute;left:72.00px;top:722.99px" class="cls_028"><span class="cls_028">#define PUSHRA  move_gp,_t6; \</span></div>
<div style="position:absolute;left:287.55px;top:755.34px" class="cls_002"><span class="cls_002">12-12</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:147568px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">WRITING POWER-ON DIAGNOSTICS</span></div>
<div style="position:absolute;left:520.62px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 12</span></div>
<div style="position:absolute;left:324.00px;top:51.00px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:360.09px;top:51.00px" class="cls_028"><span class="cls_028">_t6,_t7; \</span></div>
<div style="position:absolute;left:324.00px;top:61.00px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:360.09px;top:61.00px" class="cls_028"><span class="cls_028">_t7,ra</span></div>
<div style="position:absolute;left:252.00px;top:91.00px" class="cls_028"><span class="cls_028">#define POPRA  movera,_t7; \</span></div>
<div style="position:absolute;left:324.02px;top:101.00px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:360.11px;top:101.00px" class="cls_028"><span class="cls_028">_t7,_t6; \</span></div>
<div style="position:absolute;left:324.05px;top:110.99px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:360.14px;top:110.99px" class="cls_028"><span class="cls_028">_t6,_gp;</span></div>
<div style="position:absolute;left:414.15px;top:110.99px" class="cls_028"><span class="cls_028">\</span></div>
<div style="position:absolute;left:324.02px;top:120.99px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:360.11px;top:120.99px" class="cls_028"><span class="cls_028">_gp,zero</span></div>
<div style="position:absolute;left:228.02px;top:140.67px" class="cls_006"><span class="cls_006">‘‘POPRA’’  puts  zero  into  the  stack  bottom;  if  the  program  should</span></div>
<div style="position:absolute;left:216.00px;top:151.67px" class="cls_006"><span class="cls_006">underrun the stack the result will be an attempt to return to address zero,</span></div>
<div style="position:absolute;left:216.00px;top:162.67px" class="cls_006"><span class="cls_006">which would be trapped by the memory-management hardware, if fitted.</span></div>
<div style="position:absolute;left:228.02px;top:173.67px" class="cls_006"><span class="cls_006">The MIPSCO assembler defines the conventional register names using</span></div>
<div style="position:absolute;left:216.00px;top:184.67px" class="cls_006"><span class="cls_006">the C preprocessor; so to make sure these registers aren’t used, they are</span></div>
<div style="position:absolute;left:216.00px;top:195.67px" class="cls_006"><span class="cls_006">“undefined”:</span></div>
<div style="position:absolute;left:252.00px;top:217.00px" class="cls_028"><span class="cls_028">/* of course this means the programmer can’t use these... */</span></div>
<div style="position:absolute;left:252.00px;top:227.00px" class="cls_028"><span class="cls_028">#undef gp</span></div>
<div style="position:absolute;left:252.00px;top:237.00px" class="cls_028"><span class="cls_028">#undef t6</span></div>
<div style="position:absolute;left:252.00px;top:247.00px" class="cls_028"><span class="cls_028">#undef t7</span></div>
<div style="position:absolute;left:228.02px;top:269.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:269.67px" class="cls_008"><span class="cls_008">First test of first device</span><span class="cls_006">: on the SL-3000 board the VAC068 device</span></div>
<div style="position:absolute;left:239.97px;top:280.67px" class="cls_006"><span class="cls_006">(which connects the address lines of the VMEbus) integrates onboard</span></div>
<div style="position:absolute;left:239.97px;top:291.67px" class="cls_006"><span class="cls_006">device decode and control functions. Although it is initialized, unless</span></div>
<div style="position:absolute;left:239.97px;top:302.67px" class="cls_006"><span class="cls_006">it works nothing else will; so it must be a good place to start:</span></div>
<div style="position:absolute;left:252.00px;top:324.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:257.40px;top:334.00px" class="cls_028"><span class="cls_028">* The VAC has already been initialized</span></div>
<div style="position:absolute;left:257.40px;top:344.00px" class="cls_028"><span class="cls_028">* Here just try writing/reading a VAC register</span></div>
<div style="position:absolute;left:257.40px;top:354.00px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.00px;top:364.00px" class="cls_028"><span class="cls_028">SLEAF(tst_vacreg)</span></div>
<div style="position:absolute;left:288.00px;top:383.99px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:293.42px;top:393.99px" class="cls_028"><span class="cls_028">* checkerboard test on VACPIODATO register</span></div>
<div style="position:absolute;left:293.20px;top:403.99px" class="cls_028"><span class="cls_028">* luckily this does not affect anything on the board</span></div>
<div style="position:absolute;left:293.40px;top:413.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:288.00px;top:423.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:423.99px" class="cls_028"><span class="cls_028">t0,0xaaaa0000</span></div>
<div style="position:absolute;left:288.00px;top:433.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:433.99px" class="cls_028"><span class="cls_028">t0,VACPIODATAO/* store data in register */</span></div>
<div style="position:absolute;left:288.00px;top:443.99px" class="cls_028"><span class="cls_028">not</span></div>
<div style="position:absolute;left:324.07px;top:443.99px" class="cls_028"><span class="cls_028">t0</span></div>
<div style="position:absolute;left:288.00px;top:453.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:453.99px" class="cls_028"><span class="cls_028">t0,VACID/* complement to VACID (read-only) */</span></div>
<div style="position:absolute;left:288.00px;top:463.99px" class="cls_028"><span class="cls_028">not</span></div>
<div style="position:absolute;left:324.07px;top:463.99px" class="cls_028"><span class="cls_028">t0</span></div>
<div style="position:absolute;left:288.00px;top:473.98px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:473.98px" class="cls_028"><span class="cls_028">t1,VACPIODATAO/* reread register */</span></div>
<div style="position:absolute;left:252.00px;top:483.98px" class="cls_028"><span class="cls_028">#ifdef ALLFAIL</span></div>
<div style="position:absolute;left:288.00px;top:493.98px" class="cls_028"><span class="cls_028">xor</span></div>
<div style="position:absolute;left:324.07px;top:493.98px" class="cls_028"><span class="cls_028">t1,0x80000000</span></div>
<div style="position:absolute;left:252.00px;top:503.98px" class="cls_028"><span class="cls_028">#endif</span></div>
<div style="position:absolute;left:288.00px;top:513.98px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:324.07px;top:513.98px" class="cls_028"><span class="cls_028">t1,0xffff0000</span></div>
<div style="position:absolute;left:288.00px;top:523.98px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:324.07px;top:523.98px" class="cls_028"><span class="cls_028">t1,t0,9f/* was it ok? */</span></div>
<div style="position:absolute;left:228.02px;top:543.67px" class="cls_006"><span class="cls_006">Earlier, this chapter discussed the difficulty in testing the test software;</span></div>
<div style="position:absolute;left:216.00px;top:554.67px" class="cls_006"><span class="cls_006">the ‘‘#ifdef ALLFAIL’’ can be used to build in automatic failure, so at least</span></div>
<div style="position:absolute;left:216.00px;top:565.67px" class="cls_006"><span class="cls_006">the error reporting routines are tested.</span></div>
<div style="position:absolute;left:288.00px;top:587.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:293.42px;top:597.00px" class="cls_028"><span class="cls_028">* now try the other bits</span></div>
<div style="position:absolute;left:293.40px;top:607.00px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:288.00px;top:617.00px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:617.00px" class="cls_028"><span class="cls_028">t0,0x55550000</span></div>
<div style="position:absolute;left:288.00px;top:627.00px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:627.00px" class="cls_028"><span class="cls_028">t0,VACPIODATAO/* store data in register */</span></div>
<div style="position:absolute;left:288.00px;top:636.99px" class="cls_028"><span class="cls_028">not</span></div>
<div style="position:absolute;left:324.07px;top:636.99px" class="cls_028"><span class="cls_028">t0</span></div>
<div style="position:absolute;left:288.00px;top:646.99px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:324.05px;top:646.99px" class="cls_028"><span class="cls_028">t0,VACID/* complement to VACID (read-only) */</span></div>
<div style="position:absolute;left:288.00px;top:656.99px" class="cls_028"><span class="cls_028">not</span></div>
<div style="position:absolute;left:324.07px;top:656.99px" class="cls_028"><span class="cls_028">t0</span></div>
<div style="position:absolute;left:288.00px;top:666.99px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:324.05px;top:666.99px" class="cls_028"><span class="cls_028">t1,VACPIODATAO/* reread register */</span></div>
<div style="position:absolute;left:288.00px;top:676.99px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:324.07px;top:676.99px" class="cls_028"><span class="cls_028">t1,0xffff0000</span></div>
<div style="position:absolute;left:288.00px;top:686.99px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:324.07px;top:686.99px" class="cls_028"><span class="cls_028">t1,t0,9f/* was it ok? */</span></div>
<div style="position:absolute;left:288.00px;top:716.99px" class="cls_028"><span class="cls_028">/* read the VAC ID register and check the contents */</span></div>
<div style="position:absolute;left:301.30px;top:755.34px" class="cls_002"><span class="cls_002">12-13</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:148370px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 12</span></div>
<div style="position:absolute;left:401.86px;top:28.00px" class="cls_002"><span class="cls_002">WRITING POWER-ON DIAGNOSTICS</span></div>
<div style="position:absolute;left:108.00px;top:51.00px" class="cls_028"><span class="cls_028">lw</span></div>
<div style="position:absolute;left:144.05px;top:51.00px" class="cls_028"><span class="cls_028">t0,VACID</span></div>
<div style="position:absolute;left:108.00px;top:61.00px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.07px;top:61.00px" class="cls_028"><span class="cls_028">t1,t0,VAC_IDENTMASK</span></div>
<div style="position:absolute;left:108.00px;top:71.00px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:144.07px;top:71.00px" class="cls_028"><span class="cls_028">t1,VAC_IDENT,9f</span></div>
<div style="position:absolute;left:108.00px;top:91.00px" class="cls_028"><span class="cls_028">/* return the revision ID */</span></div>
<div style="position:absolute;left:108.00px;top:101.00px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.07px;top:101.00px" class="cls_028"><span class="cls_028">t0,VAC_REVMASK</span></div>
<div style="position:absolute;left:108.00px;top:110.99px" class="cls_028"><span class="cls_028">srl</span></div>
<div style="position:absolute;left:144.07px;top:110.99px" class="cls_028"><span class="cls_028">t0,16</span></div>
<div style="position:absolute;left:108.00px;top:120.99px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:120.99px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:72.00px;top:140.99px" class="cls_028"><span class="cls_028">9:</span></div>
<div style="position:absolute;left:108.05px;top:140.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.09px;top:140.99px" class="cls_028"><span class="cls_028">a0,IT_VACREG</span></div>
<div style="position:absolute;left:108.00px;top:150.99px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:150.99px" class="cls_028"><span class="cls_028">_it_signal</span></div>
<div style="position:absolute;left:72.00px;top:160.99px" class="cls_028"><span class="cls_028">SEND(tst_vacreg)</span></div>
<div style="position:absolute;left:48.02px;top:180.67px" class="cls_006"><span class="cls_006">The   routine</span></div>
<div style="position:absolute;left:122.87px;top:180.67px" class="cls_008"><span class="cls_008">_it_signal</span><span class="cls_006">()   attempts,   by   all   means   available,   to</span></div>
<div style="position:absolute;left:36.00px;top:191.67px" class="cls_006"><span class="cls_006">communicate the result of a test:</span></div>
<div style="position:absolute;left:48.02px;top:205.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Reporting errors without printf</span><span class="cls_006">:</span></div>
<div style="position:absolute;left:72.00px;top:227.00px" class="cls_028"><span class="cls_028">/* assembler doesn’t support character literals */</span></div>
<div style="position:absolute;left:72.00px;top:237.00px" class="cls_028"><span class="cls_028">#define NL0x0a</span></div>
<div style="position:absolute;left:72.00px;top:257.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:77.40px;top:267.00px" class="cls_028"><span class="cls_028">* low level error report</span></div>
<div style="position:absolute;left:77.40px;top:276.99px" class="cls_028"><span class="cls_028">* trashes: a2;a0,v0,a1,v1</span></div>
<div style="position:absolute;left:77.40px;top:286.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:72.00px;top:296.99px" class="cls_028"><span class="cls_028">LEAF(_it_signal)</span></div>
<div style="position:absolute;left:108.00px;top:306.99px" class="cls_028"><span class="cls_028">PUSHRA</span></div>
<div style="position:absolute;left:48.02px;top:326.67px" class="cls_006"><span class="cls_006">Here is a use of the register-stack macro, allowing the error routines to</span></div>
<div style="position:absolute;left:36.00px;top:337.67px" class="cls_006"><span class="cls_006">nest to a depth of four:</span></div>
<div style="position:absolute;left:108.00px;top:359.00px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:144.07px;top:359.00px" class="cls_028"><span class="cls_028">_sbd_signal</span></div>
<div style="position:absolute;left:108.00px;top:379.00px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:144.07px;top:379.00px" class="cls_028"><span class="cls_028">sbd_displaycode</span></div>
<div style="position:absolute;left:108.00px;top:399.00px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:399.00px" class="cls_028"><span class="cls_028">a2,a0</span></div>
<div style="position:absolute;left:180.21px;top:399.00px" class="cls_028"><span class="cls_028">/* don’t change sbd_printmsg :-) */</span></div>
<div style="position:absolute;left:108.00px;top:418.99px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:144.05px;top:418.99px" class="cls_028"><span class="cls_028">a0,errormsg</span></div>
<div style="position:absolute;left:108.00px;top:428.99px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:144.07px;top:428.99px" class="cls_028"><span class="cls_028">sbd_printmsg</span></div>
<div style="position:absolute;left:108.00px;top:448.99px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:448.99px" class="cls_028"><span class="cls_028">a0,a2</span></div>
<div style="position:absolute;left:108.00px;top:458.99px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:144.07px;top:458.99px" class="cls_028"><span class="cls_028">sbd_printcode</span></div>
<div style="position:absolute;left:108.00px;top:478.99px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:478.99px" class="cls_028"><span class="cls_028">a0,NL</span></div>
<div style="position:absolute;left:108.00px;top:488.99px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:144.07px;top:488.99px" class="cls_028"><span class="cls_028">sbd_printc</span></div>
<div style="position:absolute;left:108.00px;top:508.98px" class="cls_028"><span class="cls_028">POPRA</span></div>
<div style="position:absolute;left:108.00px;top:518.98px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:518.98px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:72.00px;top:528.98px" class="cls_028"><span class="cls_028">END(_it_signal)</span></div>
<div style="position:absolute;left:59.98px;top:551.67px" class="cls_006"><span class="cls_006">The constituent routines are:</span></div>
<div style="position:absolute;left:48.03px;top:565.67px" class="cls_006"><span class="cls_006">i.</span></div>
<div style="position:absolute;left:84.03px;top:565.67px" class="cls_008"><span class="cls_008">_sbd_signal</span><span class="cls_006"> controls one of the system’s way of telling the world</span></div>
<div style="position:absolute;left:84.03px;top:576.67px" class="cls_006"><span class="cls_006">its troubles - in this case, by placing an error code in an 8-bit</span></div>
<div style="position:absolute;left:84.03px;top:587.67px" class="cls_006"><span class="cls_006">register dual-ported to the VMEbus (implemented in the VIC</span></div>
<div style="position:absolute;left:84.03px;top:598.67px" class="cls_006"><span class="cls_006">controller), and driving the wire-OR'ed VMEbus SYSFAIL line.</span></div>
<div style="position:absolute;left:48.03px;top:612.67px" class="cls_006"><span class="cls_006">ii.</span></div>
<div style="position:absolute;left:84.03px;top:612.67px" class="cls_008"><span class="cls_008">sbd_displaycode</span><span class="cls_006"> uses the LED display to show the same 8-bit</span></div>
<div style="position:absolute;left:84.03px;top:623.67px" class="cls_006"><span class="cls_006">error value; it does this by blanking the display momentarily,</span></div>
<div style="position:absolute;left:84.03px;top:634.67px" class="cls_006"><span class="cls_006">then showing the byte value as two nibbles (most-significant</span></div>
<div style="position:absolute;left:84.03px;top:645.67px" class="cls_006"><span class="cls_006">first).</span></div>
<div style="position:absolute;left:48.03px;top:659.67px" class="cls_006"><span class="cls_006">iii.</span></div>
<div style="position:absolute;left:84.03px;top:659.67px" class="cls_008"><span class="cls_008">sbd_printmsg</span><span class="cls_006">, </span><span class="cls_008">sbd_printcode</span><span class="cls_006"> between them report the error to</span></div>
<div style="position:absolute;left:84.03px;top:670.67px" class="cls_006"><span class="cls_006">the console. Used only for desperate conditions, it entirely</span></div>
<div style="position:absolute;left:84.03px;top:681.67px" class="cls_006"><span class="cls_006">ignores the user’s expressed wishes about the serial ports - on</span></div>
<div style="position:absolute;left:84.03px;top:692.67px" class="cls_006"><span class="cls_006">the grounds that for a fatal error silence is always wrong. The</span></div>
<div style="position:absolute;left:84.03px;top:703.67px" class="cls_006"><span class="cls_006">‘‘printcode’’ routine explains the error code with a message from</span></div>
<div style="position:absolute;left:84.03px;top:714.67px" class="cls_006"><span class="cls_006">the table </span><span class="cls_008">codemessages</span><span class="cls_006"> (tstmessages.c).</span></div>
<div style="position:absolute;left:287.55px;top:755.34px" class="cls_002"><span class="cls_002">12-14</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:149172px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">WRITING POWER-ON DIAGNOSTICS</span></div>
<div style="position:absolute;left:520.62px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 12</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Endianness-proof code and testing endianness</span><span class="cls_006">: the SL-3000 board</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">can be set up (with option jumpers) to run either in big-endian or</span></div>
<div style="position:absolute;left:239.97px;top:72.67px" class="cls_006"><span class="cls_006">little-endian mode. Usually, software has to be built for the correct</span></div>
<div style="position:absolute;left:239.97px;top:83.67px" class="cls_006"><span class="cls_006">endianness, but Algorithmics wanted to ensure that the power-on test</span></div>
<div style="position:absolute;left:239.97px;top:94.67px" class="cls_006"><span class="cls_006">would at least tell the user if the jumpers were set wrongly for the</span></div>
<div style="position:absolute;left:239.97px;top:105.67px" class="cls_006"><span class="cls_006">installed ROM.</span></div>
<div style="position:absolute;left:239.97px;top:119.67px" class="cls_006"><span class="cls_006">However, MIPS instructions are all 32-bit words, and are all designed</span></div>
<div style="position:absolute;left:239.97px;top:130.67px" class="cls_006"><span class="cls_006">as bit codes. Provided the system correctly wires up the bit numbers</span></div>
<div style="position:absolute;left:239.97px;top:141.67px" class="cls_006"><span class="cls_006">within each 32-bit word (which is the most ‘‘natural’’ way to wire up</span></div>
<div style="position:absolute;left:239.97px;top:152.67px" class="cls_006"><span class="cls_006">a 32-bit MIPS processor), the instruction encoding does not change</span></div>
<div style="position:absolute;left:239.97px;top:163.67px" class="cls_006"><span class="cls_006">between big- and little-endian. What does change is the effect of</span></div>
<div style="position:absolute;left:239.97px;top:174.67px" class="cls_006"><span class="cls_006">partial-word load and store instructions; but so long as the software</span></div>
<div style="position:absolute;left:239.97px;top:185.67px" class="cls_006"><span class="cls_006">doesn’t use partial-word operations the code will run in either mode.</span></div>
<div style="position:absolute;left:239.97px;top:199.67px" class="cls_006"><span class="cls_006">A CPU can easily sense its own endianness by comparing the result</span></div>
<div style="position:absolute;left:239.97px;top:210.67px" class="cls_006"><span class="cls_006">of a byte load with the word-value contents of the location:</span></div>
<div style="position:absolute;left:288.00px;top:232.00px" class="cls_028"><span class="cls_028">.rdata</span></div>
<div style="position:absolute;left:252.00px;top:242.00px" class="cls_028"><span class="cls_028">littleflag:</span></div>
<div style="position:absolute;left:288.00px;top:252.00px" class="cls_028"><span class="cls_028">.word</span></div>
<div style="position:absolute;left:324.11px;top:252.00px" class="cls_028"><span class="cls_028">1</span></div>
<div style="position:absolute;left:288.00px;top:262.00px" class="cls_028"><span class="cls_028">.text</span></div>
<div style="position:absolute;left:324.00px;top:272.00px" class="cls_028"><span class="cls_028">.align 2</span></div>
<div style="position:absolute;left:252.00px;top:281.99px" class="cls_028"><span class="cls_028">ycnegreme:.ascii"remEcneg 00 :y"</span></div>
<div style="position:absolute;left:228.02px;top:301.67px" class="cls_006"><span class="cls_006">It is quite difficult to spell in the wrong endianness...</span></div>
<div style="position:absolute;left:252.00px;top:323.00px" class="cls_028"><span class="cls_028">LEAF(tst_endian)</span></div>
<div style="position:absolute;left:288.00px;top:333.00px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:324.05px;top:333.00px" class="cls_028"><span class="cls_028">v0,littleflag</span></div>
<div style="position:absolute;left:288.00px;top:343.00px" class="cls_028"><span class="cls_028">lbu</span></div>
<div style="position:absolute;left:324.07px;top:343.00px" class="cls_028"><span class="cls_028">v0,0(v0)</span></div>
<div style="position:absolute;left:252.00px;top:363.00px" class="cls_028"><span class="cls_028">#if BYTE_ORDER==LITTLE_ENDIAN</span></div>
<div style="position:absolute;left:288.00px;top:372.99px" class="cls_028"><span class="cls_028">beq</span></div>
<div style="position:absolute;left:324.07px;top:372.99px" class="cls_028"><span class="cls_028">v0,zero,9f</span></div>
<div style="position:absolute;left:252.00px;top:382.99px" class="cls_028"><span class="cls_028">#endif</span></div>
<div style="position:absolute;left:252.00px;top:392.99px" class="cls_028"><span class="cls_028">#if BYTE_ORDER==BIG_ENDIAN</span></div>
<div style="position:absolute;left:288.00px;top:402.99px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:324.07px;top:402.99px" class="cls_028"><span class="cls_028">v0,zero,9f</span></div>
<div style="position:absolute;left:252.00px;top:412.99px" class="cls_028"><span class="cls_028">#endif</span></div>
<div style="position:absolute;left:288.00px;top:432.99px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:324.02px;top:432.99px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:252.00px;top:452.99px" class="cls_028"><span class="cls_028">9:</span></div>
<div style="position:absolute;left:288.00px;top:462.99px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:324.05px;top:462.99px" class="cls_028"><span class="cls_028">a0,ycnegreme/* "Emergency" backwards */</span></div>
<div style="position:absolute;left:288.00px;top:472.98px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:472.98px" class="cls_028"><span class="cls_028">sbd_printmsg</span></div>
<div style="position:absolute;left:288.00px;top:492.98px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:492.98px" class="cls_028"><span class="cls_028">a0,IT_ENDIAN</span></div>
<div style="position:absolute;left:288.00px;top:502.98px" class="cls_028"><span class="cls_028">/* message in code table is backwards too */</span></div>
<div style="position:absolute;left:288.00px;top:512.98px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:512.98px" class="cls_028"><span class="cls_028">sbd_printcode</span></div>
<div style="position:absolute;left:288.00px;top:532.98px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.05px;top:532.98px" class="cls_028"><span class="cls_028">a0,NL</span></div>
<div style="position:absolute;left:288.00px;top:542.98px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:542.98px" class="cls_028"><span class="cls_028">sbd_printc</span></div>
<div style="position:absolute;left:252.00px;top:562.98px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:288.05px;top:562.98px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:324.09px;top:562.98px" class="cls_028"><span class="cls_028">a0,IT_ENDIAN</span></div>
<div style="position:absolute;left:288.00px;top:572.97px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:324.07px;top:572.97px" class="cls_028"><span class="cls_028">sbd_displaycode</span></div>
<div style="position:absolute;left:288.00px;top:582.97px" class="cls_028"><span class="cls_028">b</span></div>
<div style="position:absolute;left:324.02px;top:582.97px" class="cls_028"><span class="cls_028">1b</span></div>
<div style="position:absolute;left:252.00px;top:592.97px" class="cls_028"><span class="cls_028">SEND(tst_endian)</span></div>
<div style="position:absolute;left:301.30px;top:755.34px" class="cls_002"><span class="cls_002">12-15</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:149974px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">INSTRUCTION TIMING AND</span></div>
<div style="position:absolute;left:483.41px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 13</span></div>
<div style="position:absolute;left:222.89px;top:56.33px" class="cls_005"><span class="cls_005">OPTIMIZATION</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:228.02px;top:113.67px" class="cls_006"><span class="cls_006">The great majority of MIPS instructions require their operands by the</span></div>
<div style="position:absolute;left:216.00px;top:124.67px" class="cls_006"><span class="cls_006">end of the ‘‘RD’’ (second) pipeline stage, and produce their result at the end</span></div>
<div style="position:absolute;left:216.00px;top:135.67px" class="cls_006"><span class="cls_006">of the ‘‘ALU’’ (third) stage. If all instructions could always stick to these</span></div>
<div style="position:absolute;left:216.00px;top:146.67px" class="cls_006"><span class="cls_006">rules, any instruction sequence could be correctly run at maximum speed.</span></div>
<div style="position:absolute;left:216.00px;top:157.67px" class="cls_006"><span class="cls_006">The great power of the MIPS architecture is that the vast majority of</span></div>
<div style="position:absolute;left:216.00px;top:168.67px" class="cls_006"><span class="cls_006">instructions can stick to this rule.</span></div>
<div style="position:absolute;left:228.02px;top:179.67px" class="cls_006"><span class="cls_006">Where  this  can’t  be  done  for  some  reason,  an  instruction  taking</span></div>
<div style="position:absolute;left:216.00px;top:190.67px" class="cls_006"><span class="cls_006">operands  from  the  immediately  preceding  instruction  may  not  run</span></div>
<div style="position:absolute;left:216.00px;top:201.67px" class="cls_006"><span class="cls_006">correctly. A lot of the time, this will produce unpredictable behavior - a</span></div>
<div style="position:absolute;left:216.00px;top:212.67px" class="cls_008"><span class="cls_008">pipeline hazard</span><span class="cls_006">, and it is up to the programmer, compiler and assembler</span></div>
<div style="position:absolute;left:216.00px;top:223.67px" class="cls_006"><span class="cls_006">(together) to keep those instruction pairs apart. This can sometimes be</span></div>
<div style="position:absolute;left:216.00px;top:234.67px" class="cls_006"><span class="cls_006">done by moving code around, but otherwise the programmer can insert a</span></div>
<div style="position:absolute;left:216.00px;top:245.67px" class="cls_006"><span class="cls_006">nop.</span></div>
<div style="position:absolute;left:228.03px;top:256.67px" class="cls_006"><span class="cls_006">In other cases, the sequence will work but will result in execution</span></div>
<div style="position:absolute;left:216.01px;top:267.67px" class="cls_006"><span class="cls_006">pausing while the desired result is produced - an </span><span class="cls_008">interlock</span><span class="cls_006">. Compilers,</span></div>
<div style="position:absolute;left:216.00px;top:278.67px" class="cls_006"><span class="cls_006">assemblers and programmers would like to move code around to avoid</span></div>
<div style="position:absolute;left:216.00px;top:289.67px" class="cls_006"><span class="cls_006">interlocks too, to maximize performance.</span></div>
<div style="position:absolute;left:228.02px;top:300.67px" class="cls_006"><span class="cls_006">Table 13.1, “Instructions with scheduling implications” lists all R30xx</span></div>
<div style="position:absolute;left:216.00px;top:311.67px" class="cls_006"><span class="cls_006">family (MIPS-1) instructions which either require their operands to be</span></div>
<div style="position:absolute;left:216.00px;top:322.67px" class="cls_006"><span class="cls_006">delivered earlier than usual, or which deliver their results late.</span></div>
<div style="position:absolute;left:228.02px;top:333.67px" class="cls_006"><span class="cls_006">If one instruction delivers a result used by a subsequent instruction,</span></div>
<div style="position:absolute;left:216.00px;top:344.67px" class="cls_006"><span class="cls_006">and either instruction is listed in Table 13.1, “Instructions with scheduling</span></div>
<div style="position:absolute;left:216.00px;top:355.67px" class="cls_006"><span class="cls_006">implications”, the sum of the late-result count of the first instruction and</span></div>
<div style="position:absolute;left:216.00px;top:366.67px" class="cls_006"><span class="cls_006">the early-operand count of the second gives the number of nop or other</span></div>
<div style="position:absolute;left:216.00px;top:377.67px" class="cls_006"><span class="cls_006">intervening (non-dependent) instructions required to prevent a hazard or</span></div>
<div style="position:absolute;left:216.00px;top:388.67px" class="cls_006"><span class="cls_006">interlock.</span></div>
<div style="position:absolute;left:228.02px;top:399.67px" class="cls_006"><span class="cls_006">A tick in the ‘‘hazard’’ column means that failure to observe these</span></div>
<div style="position:absolute;left:216.00px;top:410.67px" class="cls_006"><span class="cls_006">conditions will break a program - and the assembler, unless inhibited, will</span></div>
<div style="position:absolute;left:216.00px;top:421.67px" class="cls_006"><span class="cls_006">probably insert nop instructions to avoid the problem. No tick means the</span></div>
<div style="position:absolute;left:216.00px;top:432.67px" class="cls_006"><span class="cls_006">problem is interlocked.</span></div>
<div style="position:absolute;left:216.00px;top:455.00px" class="cls_015"><span class="cls_015">Notes and examples</span></div>
<div style="position:absolute;left:228.02px;top:471.67px" class="cls_006"><span class="cls_006">• Any branch takes effect late, so the instruction following the branch</span></div>
<div style="position:absolute;left:239.97px;top:482.67px" class="cls_006"><span class="cls_006">is always executed. It’s often possible to move the last instruction</span></div>
<div style="position:absolute;left:239.97px;top:493.67px" class="cls_006"><span class="cls_006">which logically precedes the branch around; clever compilers may be</span></div>
<div style="position:absolute;left:239.97px;top:504.67px" class="cls_006"><span class="cls_006">able to figure out that the instruction normally at the branch target</span></div>
<div style="position:absolute;left:239.97px;top:515.67px" class="cls_006"><span class="cls_006">can successfully be put in the delay slot, speeding up loops; failing all</span></div>
<div style="position:absolute;left:239.97px;top:526.67px" class="cls_006"><span class="cls_006">else, the slot can be filled with a nop.</span></div>
<div style="position:absolute;left:228.02px;top:540.67px" class="cls_006"><span class="cls_006">• A load from memory into any register produces its result late, so a</span></div>
<div style="position:absolute;left:239.97px;top:551.67px" class="cls_006"><span class="cls_006">‘‘delay slot’’ is needed before the result is used:</span></div>
<div style="position:absolute;left:252.00px;top:573.00px" class="cls_028"><span class="cls_028">lwc1</span></div>
<div style="position:absolute;left:288.09px;top:573.00px" class="cls_028"><span class="cls_028">$f0, 42(t0)</span></div>
<div style="position:absolute;left:252.00px;top:583.00px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:252.00px;top:593.00px" class="cls_028"><span class="cls_028">add.s</span></div>
<div style="position:absolute;left:288.11px;top:593.00px" class="cls_028"><span class="cls_028">$f4, $f2, $f0</span></div>
<div style="position:absolute;left:228.02px;top:615.67px" class="cls_006"><span class="cls_006">• A branch on FP condition needs the C bit early, so a gap is needed</span></div>
<div style="position:absolute;left:239.97px;top:626.67px" class="cls_006"><span class="cls_006">between a ‘‘set’’ instruction and the branch:</span></div>
<div style="position:absolute;left:252.00px;top:648.00px" class="cls_028"><span class="cls_028">c.eq.s $f0, $f2</span></div>
<div style="position:absolute;left:252.00px;top:658.00px" class="cls_028"><span class="cls_028">nop</span></div>
<div style="position:absolute;left:252.00px;top:668.00px" class="cls_028"><span class="cls_028">bc1t</span></div>
<div style="position:absolute;left:288.09px;top:668.00px" class="cls_028"><span class="cls_028">thesame</span></div>
<div style="position:absolute;left:297.04px;top:754.68px" class="cls_002"><span class="cls_002">13-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:150776px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 13</span></div>
<div style="position:absolute;left:367.75px;top:28.00px" class="cls_002"><span class="cls_002">INSTRUCTION TIMING AND OPTIMIZATION</span></div>
<div style="position:absolute;left:40.00px;top:55.00px" class="cls_020"><span class="cls_020">Instruction</span></div>
<div style="position:absolute;left:139.22px;top:55.00px" class="cls_020"><span class="cls_020">Early</span></div>
<div style="position:absolute;left:211.00px;top:55.00px" class="cls_020"><span class="cls_020">Late</span></div>
<div style="position:absolute;left:248.84px;top:55.00px" class="cls_020"><span class="cls_020">Hazard?</span></div>
<div style="position:absolute;left:296.82px;top:55.00px" class="cls_020"><span class="cls_020">Notes</span></div>
<div style="position:absolute;left:139.00px;top:65.00px" class="cls_020"><span class="cls_020">Operand</span></div>
<div style="position:absolute;left:211.00px;top:65.00px" class="cls_020"><span class="cls_020">Result</span></div>
<div style="position:absolute;left:40.00px;top:82.00px" class="cls_020"><span class="cls_020">Branch instructions</span></div>
<div style="position:absolute;left:211.00px;top:82.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:248.85px;top:82.00px" class="cls_021"><span class="cls_021">✓</span></div>
<div style="position:absolute;left:296.67px;top:82.00px" class="cls_020"><span class="cls_020">where result is new</span></div>
<div style="position:absolute;left:296.66px;top:92.00px" class="cls_020"><span class="cls_020">‘‘PC’’ value, i.e.</span></div>
<div style="position:absolute;left:296.66px;top:102.00px" class="cls_020"><span class="cls_020">delayed branch</span></div>
<div style="position:absolute;left:40.00px;top:119.00px" class="cls_020"><span class="cls_020">Load instructions</span></div>
<div style="position:absolute;left:141.64px;top:119.00px" class="cls_020"><span class="cls_020">lw, lh, lhu, lb,</span></div>
<div style="position:absolute;left:211.00px;top:119.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:248.87px;top:119.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:296.72px;top:119.00px" class="cls_020"><span class="cls_020">load delay</span></div>
<div style="position:absolute;left:139.00px;top:129.00px" class="cls_020"><span class="cls_020">lbu, lwc1</span></div>
<div style="position:absolute;left:40.00px;top:146.00px" class="cls_020"><span class="cls_020">lwl, lwr</span></div>
<div style="position:absolute;left:139.15px;top:146.00px" class="cls_020"><span class="cls_020">0/-1</span></div>
<div style="position:absolute;left:211.25px;top:146.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:248.84px;top:146.00px" class="cls_021"><span class="cls_021">✓</span></div>
<div style="position:absolute;left:296.66px;top:146.00px" class="cls_027"><span class="cls_027">late</span><span class="cls_020"> read of value to</span></div>
<div style="position:absolute;left:296.66px;top:156.00px" class="cls_020"><span class="cls_020">merge, so no delay</span></div>
<div style="position:absolute;left:296.66px;top:166.00px" class="cls_020"><span class="cls_020">needed between lwl/</span></div>
<div style="position:absolute;left:296.66px;top:176.00px" class="cls_020"><span class="cls_020">lwr pair</span></div>
<div style="position:absolute;left:40.00px;top:193.00px" class="cls_020"><span class="cls_020">mult, multu</span></div>
<div style="position:absolute;left:211.24px;top:193.00px" class="cls_020"><span class="cls_020">11</span></div>
<div style="position:absolute;left:296.95px;top:193.00px" class="cls_020"><span class="cls_020">result interlocked</span></div>
<div style="position:absolute;left:40.00px;top:213.00px" class="cls_020"><span class="cls_020">div, divu</span></div>
<div style="position:absolute;left:211.17px;top:213.00px" class="cls_020"><span class="cls_020">35</span></div>
<div style="position:absolute;left:296.89px;top:213.00px" class="cls_020"><span class="cls_020">result interlocked</span></div>
<div style="position:absolute;left:40.00px;top:233.00px" class="cls_020"><span class="cls_020">Integer/control</span></div>
<div style="position:absolute;left:211.00px;top:233.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:248.87px;top:233.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:40.00px;top:243.00px" class="cls_020"><span class="cls_020">register moves:</span></div>
<div style="position:absolute;left:40.00px;top:252.99px" class="cls_020"><span class="cls_020">mfc0, mtc0</span></div>
<div style="position:absolute;left:40.00px;top:270.00px" class="cls_020"><span class="cls_020">FP conditional</span></div>
<div style="position:absolute;left:139.00px;top:270.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:211.04px;top:270.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:248.91px;top:270.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:40.00px;top:279.99px" class="cls_020"><span class="cls_020">branches: bc1t, bc1f</span></div>
<div style="position:absolute;left:40.00px;top:297.00px" class="cls_020"><span class="cls_020">Integer/FP moves</span></div>
<div style="position:absolute;left:211.01px;top:297.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:248.88px;top:297.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:40.00px;top:307.00px" class="cls_020"><span class="cls_020">mfc1, mtc1, ctc1,</span></div>
<div style="position:absolute;left:40.00px;top:317.00px" class="cls_020"><span class="cls_020">cfc1</span></div>
<div style="position:absolute;left:40.00px;top:334.00px" class="cls_020"><span class="cls_020">FP addition unit ops</span></div>
<div style="position:absolute;left:211.01px;top:334.00px" class="cls_020"><span class="cls_020">+1</span></div>
<div style="position:absolute;left:40.00px;top:344.00px" class="cls_020"><span class="cls_020">add.s, add.d, sub.s,</span></div>
<div style="position:absolute;left:40.00px;top:354.00px" class="cls_020"><span class="cls_020">sub.d</span></div>
<div style="position:absolute;left:40.00px;top:371.00px" class="cls_020"><span class="cls_020">mul.s</span></div>
<div style="position:absolute;left:211.12px;top:371.00px" class="cls_020"><span class="cls_020">+3</span></div>
<div style="position:absolute;left:296.83px;top:371.00px" class="cls_020"><span class="cls_020">interlocked</span></div>
<div style="position:absolute;left:40.00px;top:391.00px" class="cls_020"><span class="cls_020">mul.d</span></div>
<div style="position:absolute;left:211.12px;top:391.00px" class="cls_020"><span class="cls_020">+4</span></div>
<div style="position:absolute;left:296.83px;top:391.00px" class="cls_020"><span class="cls_020">interlocked</span></div>
<div style="position:absolute;left:40.00px;top:410.99px" class="cls_020"><span class="cls_020">div.s</span></div>
<div style="position:absolute;left:211.10px;top:410.99px" class="cls_020"><span class="cls_020">+11</span></div>
<div style="position:absolute;left:296.84px;top:410.99px" class="cls_020"><span class="cls_020">interlocked</span></div>
<div style="position:absolute;left:40.00px;top:430.99px" class="cls_020"><span class="cls_020">div.d</span></div>
<div style="position:absolute;left:211.11px;top:430.99px" class="cls_020"><span class="cls_020">+18</span></div>
<div style="position:absolute;left:296.85px;top:430.99px" class="cls_020"><span class="cls_020">interlocked</span></div>
<div style="position:absolute;left:40.00px;top:450.99px" class="cls_020"><span class="cls_020">cvt.w.s, cvt.w.d,</span></div>
<div style="position:absolute;left:211.00px;top:450.99px" class="cls_020"><span class="cls_020">+1</span></div>
<div style="position:absolute;left:296.72px;top:450.99px" class="cls_020"><span class="cls_020">interlocked</span></div>
<div style="position:absolute;left:40.00px;top:460.99px" class="cls_020"><span class="cls_020">cvt.s.d</span></div>
<div style="position:absolute;left:40.00px;top:477.99px" class="cls_020"><span class="cls_020">cvt.s.w, cvt.d.w</span></div>
<div style="position:absolute;left:211.31px;top:477.99px" class="cls_020"><span class="cls_020">+2</span></div>
<div style="position:absolute;left:297.02px;top:477.99px" class="cls_020"><span class="cls_020">interlocked</span></div>
<div style="position:absolute;left:89.20px;top:500.00px" class="cls_020"><span class="cls_020">Table 13.1.  Instructions with scheduling implications</span></div>
<div style="position:absolute;left:48.02px;top:514.67px" class="cls_006"><span class="cls_006">• The sequence below requires </span><span class="cls_008">two</span><span class="cls_006"> nops (though this sequence may be</span></div>
<div style="position:absolute;left:59.98px;top:525.67px" class="cls_006"><span class="cls_006">highly unlikely)</span></div>
<div style="position:absolute;left:72.00px;top:547.00px" class="cls_039"><span class="cls_039">ctc1</span></div>
<div style="position:absolute;left:108.07px;top:547.00px" class="cls_039"><span class="cls_039">t0, $31</span></div>
<div style="position:absolute;left:72.00px;top:557.00px" class="cls_039"><span class="cls_039">nop</span></div>
<div style="position:absolute;left:72.00px;top:567.00px" class="cls_039"><span class="cls_039">nop</span></div>
<div style="position:absolute;left:72.00px;top:577.00px" class="cls_039"><span class="cls_039">bc1t</span></div>
<div style="position:absolute;left:108.07px;top:577.00px" class="cls_039"><span class="cls_039">somewhere</span></div>
<div style="position:absolute;left:36.00px;top:598.00px" class="cls_015"><span class="cls_015">ADDITIONAL HAZARDS</span></div>
<div style="position:absolute;left:36.00px;top:623.00px" class="cls_015"><span class="cls_015">Early modification of HI and LO</span></div>
<div style="position:absolute;left:48.02px;top:636.67px" class="cls_006"><span class="cls_006">An  interrupt  or  trap  will  abort  most  instructions,  and  the  result</span></div>
<div style="position:absolute;left:36.00px;top:647.67px" class="cls_006"><span class="cls_006">writeback will be inhibited. But this isn’t done in the integer multiply unit;</span></div>
<div style="position:absolute;left:36.00px;top:658.67px" class="cls_006"><span class="cls_006">changes to the multiply unit registers cannot be prevented once multiply</span></div>
<div style="position:absolute;left:36.00px;top:669.67px" class="cls_006"><span class="cls_006">and divide instructions start.</span></div>
<div style="position:absolute;left:48.02px;top:680.67px" class="cls_006"><span class="cls_006">An exception might occur just in time to prevent an mfhi or mflo from</span></div>
<div style="position:absolute;left:36.01px;top:691.67px" class="cls_006"><span class="cls_006">completing its writeback, but still allow a subsequent multiply or divide</span></div>
<div style="position:absolute;left:36.01px;top:702.67px" class="cls_006"><span class="cls_006">instruction to start. By the time the exception completes (or equivalently,</span></div>
<div style="position:absolute;left:289.78px;top:755.33px" class="cls_002"><span class="cls_002">13-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:151578px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">INSTRUCTION TIMING AND OPTIMIZATION</span></div>
<div style="position:absolute;left:520.77px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 13</span></div>
<div style="position:absolute;left:216.00px;top:50.67px" class="cls_006"><span class="cls_006">by the time the exception routine saves the </span><span class="cls_008">lo</span><span class="cls_006"> or </span><span class="cls_008">hi</span><span class="cls_006"> register values) the</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">multiply/divide could have overwritten the data and exception recovery</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_006"><span class="cls_006">won’t happen properly.</span></div>
<div style="position:absolute;left:228.02px;top:83.67px" class="cls_006"><span class="cls_006">To avoid this ensure that at least two instruction times separate an mfhi</span></div>
<div style="position:absolute;left:216.00px;top:94.67px" class="cls_006"><span class="cls_006">or mflo instruction from a following multiply or divide instruction.</span></div>
<div style="position:absolute;left:216.00px;top:117.00px" class="cls_015"><span class="cls_015">Bitfields in CPU control registers</span></div>
<div style="position:absolute;left:228.02px;top:130.67px" class="cls_006"><span class="cls_006">Some of the CPU control registers (‘‘coprocessor 0’’) contain bitfield</span></div>
<div style="position:absolute;left:216.00px;top:141.67px" class="cls_006"><span class="cls_006">values  or  flags  which  have  side  effects  on  the  operation  of  other</span></div>
<div style="position:absolute;left:216.00px;top:152.67px" class="cls_006"><span class="cls_006">instructions.   Unless   specifically   documented   below,   software   must</span></div>
<div style="position:absolute;left:216.00px;top:163.67px" class="cls_006"><span class="cls_006">assume that any such side effects will be unpredictable on the three</span></div>
<div style="position:absolute;left:216.00px;top:174.67px" class="cls_006"><span class="cls_006">instruction periods following the execution of an mtc0.</span></div>
<div style="position:absolute;left:228.03px;top:185.67px" class="cls_006"><span class="cls_006">The following are specifically noted:</span></div>
<div style="position:absolute;left:228.03px;top:199.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Enabling/disabling a group of co-processor instructions</span><span class="cls_006">: use of CP</span></div>
<div style="position:absolute;left:239.98px;top:210.67px" class="cls_006"><span class="cls_006">instructions in the following two instructions is unpredictable - in</span></div>
<div style="position:absolute;left:239.98px;top:221.67px" class="cls_006"><span class="cls_006">particular the CPU may, or may not, trap.</span></div>
<div style="position:absolute;left:228.03px;top:235.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Enabling/disabling interrupts</span><span class="cls_006">: the enable won’t allow an interrupt to</span></div>
<div style="position:absolute;left:239.97px;top:246.67px" class="cls_006"><span class="cls_006">affect (i.e. get in before, abort the writeback phase of) the following two</span></div>
<div style="position:absolute;left:239.97px;top:257.67px" class="cls_006"><span class="cls_006">instructions; it can happen before the third.</span></div>
<div style="position:absolute;left:239.97px;top:271.67px" class="cls_006"><span class="cls_006">Similarly, when disabling interrupts the following two instructions</span></div>
<div style="position:absolute;left:239.97px;top:282.67px" class="cls_006"><span class="cls_006">may nonetheless be interrupted.</span></div>
<div style="position:absolute;left:228.02px;top:296.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> TLB changes and instruction fetches</span><span class="cls_006">: there is a 2 instruction delay</span></div>
<div style="position:absolute;left:239.97px;top:307.67px" class="cls_006"><span class="cls_006">between a change to the TLB and it taking any effect on instruction</span></div>
<div style="position:absolute;left:239.97px;top:318.67px" class="cls_006"><span class="cls_006">translation.  Additionally,  there  is  a  single-entry  cache  used  for</span></div>
<div style="position:absolute;left:239.97px;top:329.67px" class="cls_006"><span class="cls_006">instruction translations (called the </span><span class="cls_008">micro-TLB</span><span class="cls_006">) which is implicitly</span></div>
<div style="position:absolute;left:239.98px;top:340.67px" class="cls_006"><span class="cls_006">flushed by loading </span><span class="cls_008">EntryHi,</span><span class="cls_006"> which can also delay the effect.</span></div>
<div style="position:absolute;left:239.97px;top:354.67px" class="cls_006"><span class="cls_006">The OS should only perform TLB updates in code running in an</span></div>
<div style="position:absolute;left:239.97px;top:365.67px" class="cls_006"><span class="cls_006">unmapped space...</span></div>
<div style="position:absolute;left:216.00px;top:388.00px" class="cls_015"><span class="cls_015">Non-obvious Hazards</span></div>
<div style="position:absolute;left:228.02px;top:401.67px" class="cls_006"><span class="cls_006">There  are  other  device</span></div>
<div style="position:absolute;left:358.46px;top:401.67px" class="cls_006"><span class="cls_006">“hazards”  which  can’t  be  determined  by</span></div>
<div style="position:absolute;left:216.00px;top:412.67px" class="cls_006"><span class="cls_006">examining the processor pipeline. In general, these are due to the amount</span></div>
<div style="position:absolute;left:216.00px;top:423.67px" class="cls_006"><span class="cls_006">of time required for changes to CP0 registers to “propagate” to the cache,</span></div>
<div style="position:absolute;left:216.00px;top:434.67px" class="cls_006"><span class="cls_006">bus interface, or exception controller of the device.</span></div>
<div style="position:absolute;left:228.02px;top:445.67px" class="cls_006"><span class="cls_006">The CPU hardware user’s manual specifies a number of clock cycles,</span></div>
<div style="position:absolute;left:216.00px;top:456.67px" class="cls_006"><span class="cls_006">and whether software can operate cached, for modifications to R3041 and</span></div>
<div style="position:absolute;left:216.00px;top:467.67px" class="cls_006"><span class="cls_006">R3081 specific CP0 registers. The programmer is referred to those manuals</span></div>
<div style="position:absolute;left:216.00px;top:478.67px" class="cls_006"><span class="cls_006">for additional information.</span></div>
<div style="position:absolute;left:228.02px;top:489.67px" class="cls_006"><span class="cls_006">One other common “hazard” bears particular note: modifying the IEc</span></div>
<div style="position:absolute;left:216.00px;top:500.67px" class="cls_006"><span class="cls_006">and IM bits of the status register in a single CP0 instruction is not</span></div>
<div style="position:absolute;left:216.00px;top:511.67px" class="cls_006"><span class="cls_006">recommended. The effects of these bit fields may or may not be seen in</span></div>
<div style="position:absolute;left:216.00px;top:522.67px" class="cls_006"><span class="cls_006">different clock cycles; thus, changing both with a single mtc0 or ctc0</span></div>
<div style="position:absolute;left:216.00px;top:533.67px" class="cls_006"><span class="cls_006">instruction may result in side effects such as spurious interrupts (if for</span></div>
<div style="position:absolute;left:216.00px;top:544.67px" class="cls_006"><span class="cls_006">example the new value unmasked a previously masked interrupt but was</span></div>
<div style="position:absolute;left:216.00px;top:555.67px" class="cls_006"><span class="cls_006">also attempting to clear the global IEc bit).</span></div>
<div style="position:absolute;left:303.54px;top:755.33px" class="cls_002"><span class="cls_002">13-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:152380px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">SOFTWARE TOOLS FOR BOARD</span></div>
<div style="position:absolute;left:483.41px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 14</span></div>
<div style="position:absolute;left:222.89px;top:56.33px" class="cls_005"><span class="cls_005">BRING-UP</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:228.02px;top:124.67px" class="cls_006"><span class="cls_006">This appendix describes the software tools typically used by IDT when</span></div>
<div style="position:absolute;left:216.00px;top:135.67px" class="cls_006"><span class="cls_006">debugging a board for the first time.</span></div>
<div style="position:absolute;left:228.02px;top:146.67px" class="cls_006"><span class="cls_006">Additional detail on the design and debug of R30xx systems is available</span></div>
<div style="position:absolute;left:216.00px;top:157.67px" class="cls_006"><span class="cls_006">from IDT in the forms of applications notes, evaluation boards, and design</span></div>
<div style="position:absolute;left:216.00px;top:168.67px" class="cls_006"><span class="cls_006">guides.</span></div>
<div style="position:absolute;left:216.00px;top:191.00px" class="cls_015"><span class="cls_015">TOOLS USED IN DEBUG</span></div>
<div style="position:absolute;left:228.02px;top:204.67px" class="cls_006"><span class="cls_006">In a typical system, IDT engineers use the following tools for initial board</span></div>
<div style="position:absolute;left:216.00px;top:215.67px" class="cls_006"><span class="cls_006">debug:</span></div>
<div style="position:absolute;left:228.02px;top:229.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:229.67px" class="cls_008"><span class="cls_008">Logic analyzer</span><span class="cls_006">: This tool is indispensable for determining why a</span></div>
<div style="position:absolute;left:239.97px;top:240.67px" class="cls_006"><span class="cls_006">particular memory sub-system is malfunctioning. Although other</span></div>
<div style="position:absolute;left:239.97px;top:251.67px" class="cls_006"><span class="cls_006">diagnostic tools are used to determine which subsystems are mis-</span></div>
<div style="position:absolute;left:239.97px;top:262.67px" class="cls_006"><span class="cls_006">behaving,  ultimately  a  logic  analyzer  is  used  to  trace  the  mis-</span></div>
<div style="position:absolute;left:239.97px;top:273.67px" class="cls_006"><span class="cls_006">behavior, so a work-around or fix can be applied.</span></div>
<div style="position:absolute;left:239.97px;top:287.67px" class="cls_006"><span class="cls_006">The use of the logic analyzer may be complemented by the use of a</span></div>
<div style="position:absolute;left:239.97px;top:298.67px" class="cls_006"><span class="cls_006">device specific “pod”. These pods are designed to be inserted into the</span></div>
<div style="position:absolute;left:239.97px;top:309.67px" class="cls_006"><span class="cls_006">CPU socket, and recognize the device bus protocols. These pods</span></div>
<div style="position:absolute;left:239.97px;top:320.67px" class="cls_006"><span class="cls_006">typically can dis-assemble incoming instructions as well, facilitating</span></div>
<div style="position:absolute;left:239.97px;top:331.67px" class="cls_006"><span class="cls_006">debug of programs as well as hardware.</span></div>
<div style="position:absolute;left:228.02px;top:345.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:345.67px" class="cls_008"><span class="cls_008">ROM  emulator</span><span class="cls_006">:  IDT  frequently  applies  ROM  emulator  tools  to</span></div>
<div style="position:absolute;left:239.97px;top:356.67px" class="cls_006"><span class="cls_006">minimize the hassle of burning new sets of EPROMs as higher levels</span></div>
<div style="position:absolute;left:239.97px;top:367.67px" class="cls_006"><span class="cls_006">of code is developed. A word of caution: some ROM emulators may</span></div>
<div style="position:absolute;left:239.97px;top:378.67px" class="cls_006"><span class="cls_006">take actions (desired or not) when the ROM space is written to; the</span></div>
<div style="position:absolute;left:239.97px;top:389.67px" class="cls_006"><span class="cls_006">hardware  designer  should  review  the  requirements  of  the  ROM</span></div>
<div style="position:absolute;left:239.97px;top:400.67px" class="cls_006"><span class="cls_006">emulator to insure system compatibility.</span></div>
<div style="position:absolute;left:228.02px;top:414.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:414.67px" class="cls_008"><span class="cls_008">In-circuit  Emulator</span><span class="cls_006">:  In  some  cases,  IDT  will  apply  an  in-circuit</span></div>
<div style="position:absolute;left:239.98px;top:425.67px" class="cls_006"><span class="cls_006">emulator to a debug task.</span></div>
<div style="position:absolute;left:239.98px;top:439.67px" class="cls_006"><span class="cls_006">Many developers rely heavily on the use of in-circuit emulation for</span></div>
<div style="position:absolute;left:239.98px;top:450.67px" class="cls_006"><span class="cls_006">system  debug;  others  rely  exclusively  on  software-based  debug</span></div>
<div style="position:absolute;left:239.98px;top:461.67px" class="cls_006"><span class="cls_006">techniques coupled with generic measurement equipment. In-circuit</span></div>
<div style="position:absolute;left:239.98px;top:472.67px" class="cls_006"><span class="cls_006">emulation can certainly be a useful tool, although it may prove to be</span></div>
<div style="position:absolute;left:239.98px;top:483.67px" class="cls_006"><span class="cls_006">outside the project development budget.</span></div>
<div style="position:absolute;left:228.03px;top:497.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:497.67px" class="cls_008"><span class="cls_008">IDT Micromonitor</span><span class="cls_006">: The IDT micromonitor is a small program designed</span></div>
<div style="position:absolute;left:239.98px;top:508.67px" class="cls_006"><span class="cls_006">to help discover and debug problems in the system RAM.</span></div>
<div style="position:absolute;left:239.98px;top:522.67px" class="cls_006"><span class="cls_006">Since the micromonitor is designed to help debug system RAM, it can</span></div>
<div style="position:absolute;left:239.98px;top:533.67px" class="cls_006"><span class="cls_006">not  assume  that  RAM  resources  are  available  to  it.  Thus,  the</span></div>
<div style="position:absolute;left:239.98px;top:544.67px" class="cls_006"><span class="cls_006">micromonitor is written in assembly and does not require a stack or</span></div>
<div style="position:absolute;left:239.98px;top:555.67px" class="cls_006"><span class="cls_006">variable storage; it uses the on-chip register file for temporary data</span></div>
<div style="position:absolute;left:239.98px;top:566.67px" class="cls_006"><span class="cls_006">storage.</span></div>
<div style="position:absolute;left:239.98px;top:580.67px" class="cls_006"><span class="cls_006">For the Micromonitor to operate, the ROM sub-system must work,</span></div>
<div style="position:absolute;left:239.98px;top:591.67px" class="cls_006"><span class="cls_006">and the system console must work.</span></div>
<div style="position:absolute;left:239.98px;top:605.67px" class="cls_006"><span class="cls_006">The Micromonitor contains a number of diagnostics for system RAM,</span></div>
<div style="position:absolute;left:239.98px;top:616.67px" class="cls_006"><span class="cls_006">designed  to  insure  that  address  and  data  lines  are  correctly</span></div>
<div style="position:absolute;left:239.98px;top:627.67px" class="cls_006"><span class="cls_006">connected; that DRAM refresh works properly; that cached and</span></div>
<div style="position:absolute;left:239.98px;top:638.67px" class="cls_006"><span class="cls_006">uncached accesses function properly; etc. Successful use of the</span></div>
<div style="position:absolute;left:239.98px;top:649.67px" class="cls_006"><span class="cls_006">micromonitor gives the debugger confidence in the board memory</span></div>
<div style="position:absolute;left:239.98px;top:660.67px" class="cls_006"><span class="cls_006">system.</span></div>
<div style="position:absolute;left:228.02px;top:674.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:674.67px" class="cls_008"><span class="cls_008">IDT/sim (system integration manager)</span><span class="cls_006">: This is a PROM monitor/</span></div>
<div style="position:absolute;left:239.97px;top:685.67px" class="cls_006"><span class="cls_006">debugger program, designed to run in a target system. IDT/sim gives</span></div>
<div style="position:absolute;left:239.97px;top:696.67px" class="cls_006"><span class="cls_006">the engineer the ability to set breakpoints, peek and poke memory,</span></div>
<div style="position:absolute;left:239.97px;top:707.67px" class="cls_006"><span class="cls_006">install new commands, examine machine state, single step, etc.</span></div>
<div style="position:absolute;left:297.04px;top:754.68px" class="cls_002"><span class="cls_002">14-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:153182px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 14</span></div>
<div style="position:absolute;left:374.46px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE TOOLS FOR BOARD BRING-UP</span></div>
<div style="position:absolute;left:59.98px;top:50.67px" class="cls_006"><span class="cls_006">In addition, IDT/sim contains the communications interface to a</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">number of host-resident remote target high-level language debuggers,</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">including GDB and MIPS DBX. With IDT/sim executing on the target</span></div>
<div style="position:absolute;left:59.98px;top:83.67px" class="cls_006"><span class="cls_006">board, the programmer can perform high-level language debugging on</span></div>
<div style="position:absolute;left:59.98px;top:94.67px" class="cls_006"><span class="cls_006">the target from the development host.</span></div>
<div style="position:absolute;left:36.00px;top:117.00px" class="cls_015"><span class="cls_015">INITIAL DEBUGGING</span></div>
<div style="position:absolute;left:48.02px;top:130.67px" class="cls_006"><span class="cls_006">When debugging is first begun, the engineer will not even be confident</span></div>
<div style="position:absolute;left:36.00px;top:141.67px" class="cls_006"><span class="cls_006">of the proper behavior of the ROM and RAM memory subsystems.</span></div>
<div style="position:absolute;left:48.02px;top:152.67px" class="cls_006"><span class="cls_006">A number of techniques can be used during this initial debug. Some</span></div>
<div style="position:absolute;left:36.00px;top:163.67px" class="cls_006"><span class="cls_006">engineers prefer to use an in-circuit emulator with overlay memory to</span></div>
<div style="position:absolute;left:36.00px;top:174.67px" class="cls_006"><span class="cls_006">cause the CPU to make repetitive accesses to the memory while the</span></div>
<div style="position:absolute;left:36.00px;top:185.67px" class="cls_006"><span class="cls_006">engineer  probes  it  with  a  logic-analyzer  and/or  oscilloscope.  Other</span></div>
<div style="position:absolute;left:36.00px;top:196.67px" class="cls_006"><span class="cls_006">engineers will just “try the boot prom” and use a logic-analyzer to see the</span></div>
<div style="position:absolute;left:36.00px;top:207.67px" class="cls_006"><span class="cls_006">first few cycles after reset (typically to the boot prom). Again, a logic-</span></div>
<div style="position:absolute;left:36.00px;top:218.67px" class="cls_006"><span class="cls_006">analyzer pod may prove helpful in showing what instruction finally arrives</span></div>
<div style="position:absolute;left:36.00px;top:229.67px" class="cls_006"><span class="cls_006">back at the CPU data pins.</span></div>
<div style="position:absolute;left:48.02px;top:240.67px" class="cls_006"><span class="cls_006">Debugging  the  ROM  and  UART  subsystem  are  preliminary  steps</span></div>
<div style="position:absolute;left:36.00px;top:251.67px" class="cls_006"><span class="cls_006">required for the micromonitor, SIM, and remote target debug. There is no</span></div>
<div style="position:absolute;left:36.00px;top:262.67px" class="cls_006"><span class="cls_006">particular “mystery” to doing this with the R30xx family; just good old-</span></div>
<div style="position:absolute;left:36.00px;top:273.67px" class="cls_006"><span class="cls_006">fashioned debugging.</span></div>
<div style="position:absolute;left:36.00px;top:296.00px" class="cls_015"><span class="cls_015">PORTING MICROMONITOR</span></div>
<div style="position:absolute;left:48.02px;top:309.67px" class="cls_006"><span class="cls_006">Porting the micromonitor typically requires only two steps:</span></div>
<div style="position:absolute;left:48.02px;top:323.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> determining  the  UART  address</span><span class="cls_006">:  this  will  be  system  specific.  In</span></div>
<div style="position:absolute;left:59.98px;top:334.67px" class="cls_006"><span class="cls_006">micromonitor, there is an assembler directive inside the source file</span></div>
<div style="position:absolute;left:59.98px;top:345.67px" class="cls_006"><span class="cls_006">used to define the UART_BASE address. The programmer needs to</span></div>
<div style="position:absolute;left:59.98px;top:356.67px" class="cls_006"><span class="cls_006">modify this line to reflect the system address map.</span></div>
<div style="position:absolute;left:48.03px;top:370.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> provide the UART driver</span><span class="cls_006">: if the system uses an 8530 or compatible, or</span></div>
<div style="position:absolute;left:59.98px;top:381.67px" class="cls_006"><span class="cls_006">a 2681/68681 or compatible, then the programmer can use one of the</span></div>
<div style="position:absolute;left:59.98px;top:392.67px" class="cls_006"><span class="cls_006">drivers provided with the micromonitor. Otherwise, the programmer</span></div>
<div style="position:absolute;left:59.98px;top:403.67px" class="cls_006"><span class="cls_006">needs to provide a rudimentary UART driver for the system UART.</span></div>
<div style="position:absolute;left:59.98px;top:417.67px" class="cls_006"><span class="cls_006">There is an advantage to patterning new drivers after UART drivers</span></div>
<div style="position:absolute;left:59.98px;top:428.67px" class="cls_006"><span class="cls_006">provided with the micromonitor. In general, a full device driver is</span></div>
<div style="position:absolute;left:59.98px;top:439.67px" class="cls_006"><span class="cls_006">probably not required--fixed baud rates, a single receive or transmit</span></div>
<div style="position:absolute;left:59.98px;top:450.67px" class="cls_006"><span class="cls_006">character from a CPU register, and programming in assembly are all</span></div>
<div style="position:absolute;left:59.98px;top:461.67px" class="cls_006"><span class="cls_006">appropriate to the goals of the micromonitor.</span></div>
<div style="position:absolute;left:59.98px;top:475.67px" class="cls_006"><span class="cls_006">If selecting one of the existing UART drivers, the programmer should</span></div>
<div style="position:absolute;left:59.98px;top:486.67px" class="cls_006"><span class="cls_006">set the appropriate assembly file line to indicate the selected driver.</span></div>
<div style="position:absolute;left:36.00px;top:509.00px" class="cls_015"><span class="cls_015">RUNNING MICROMONITOR</span></div>
<div style="position:absolute;left:48.02px;top:522.67px" class="cls_006"><span class="cls_006">The micromonitor documentation describes the proper running of the</span></div>
<div style="position:absolute;left:36.00px;top:533.67px" class="cls_006"><span class="cls_006">micromonitor program. In general, the micromonitor should be used until</span></div>
<div style="position:absolute;left:36.00px;top:544.67px" class="cls_006"><span class="cls_006">all of the diagnostic tests of system RAM can be completed successfully</span></div>
<div style="position:absolute;left:36.00px;top:555.67px" class="cls_006"><span class="cls_006">and repeatedly, running both cached and uncached.</span></div>
<div style="position:absolute;left:48.02px;top:566.67px" class="cls_006"><span class="cls_006">At this time, the engineer is confident that the ROM and RAM systems</span></div>
<div style="position:absolute;left:36.00px;top:577.67px" class="cls_006"><span class="cls_006">operate correctly, and can be accessed cacheably (in four word bursts) and</span></div>
<div style="position:absolute;left:36.00px;top:588.67px" class="cls_006"><span class="cls_006">non-cacheably. In addition, partial word accesses to the system RAM are</span></div>
<div style="position:absolute;left:36.00px;top:599.67px" class="cls_006"><span class="cls_006">now verified.</span></div>
<div style="position:absolute;left:48.02px;top:610.67px" class="cls_006"><span class="cls_006">The engineer is now free to move on to porting SIM, and debugging the</span></div>
<div style="position:absolute;left:36.00px;top:621.67px" class="cls_006"><span class="cls_006">remainder of the IO subsystems.</span></div>
<div style="position:absolute;left:36.00px;top:644.00px" class="cls_015"><span class="cls_015">INITIAL IDT/SIM ACTIVITY</span></div>
<div style="position:absolute;left:48.02px;top:657.67px" class="cls_006"><span class="cls_006">The first goal for running IDT/sim is to merely get to the basic IDT/sim</span></div>
<div style="position:absolute;left:36.00px;top:668.67px" class="cls_006"><span class="cls_006">prompt. This should not rely on subsystems other than those already</span></div>
<div style="position:absolute;left:36.00px;top:679.67px" class="cls_006"><span class="cls_006">confirmed using micromonitor: the ROM, RAM, and UART. Thus, the only</span></div>
<div style="position:absolute;left:36.00px;top:690.67px" class="cls_006"><span class="cls_006">problems  that  should  be  expected  are  programming,  not  system,</span></div>
<div style="position:absolute;left:36.00px;top:701.67px" class="cls_006"><span class="cls_006">problems.</span></div>
<div style="position:absolute;left:48.02px;top:712.67px" class="cls_006"><span class="cls_006">However, there is one common problem that can slow progress:</span></div>
<div style="position:absolute;left:289.78px;top:755.33px" class="cls_002"><span class="cls_002">14-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:153984px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE TOOLS FOR BOARD BRING-UP</span></div>
<div style="position:absolute;left:520.73px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 14</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Improper memory sizing algorithm.</span><span class="cls_006"> IDT/sim usually performs a RAM</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">area sizing operation, to determine the amount of system RAM. It then</span></div>
<div style="position:absolute;left:239.97px;top:72.67px" class="cls_006"><span class="cls_006">places the stack pointer at the top of system RAM. If the memory</span></div>
<div style="position:absolute;left:239.97px;top:83.67px" class="cls_006"><span class="cls_006">sizing algorithm does not work properly, the stack could be placed in</span></div>
<div style="position:absolute;left:239.97px;top:94.67px" class="cls_006"><span class="cls_006">non-existent memory, or SIM could be fooled into thinking there is</span></div>
<div style="position:absolute;left:239.97px;top:105.67px" class="cls_006"><span class="cls_006">0kB of memory. In either case, SIM would not boot or execute</span></div>
<div style="position:absolute;left:239.97px;top:116.67px" class="cls_006"><span class="cls_006">properly.</span></div>
<div style="position:absolute;left:239.97px;top:130.67px" class="cls_006"><span class="cls_006">To avoid this problem many engineers “hard-wire” a memory size into</span></div>
<div style="position:absolute;left:239.97px;top:141.67px" class="cls_006"><span class="cls_006">SIM for initial boot and system test. For example, an evaluation board</span></div>
<div style="position:absolute;left:239.97px;top:152.67px" class="cls_006"><span class="cls_006">might be populated with 1MB of DRAM, and SIM hardwired for 1MB</span></div>
<div style="position:absolute;left:239.97px;top:163.67px" class="cls_006"><span class="cls_006">of RAM. The memory sizing algorithm could then be debugged later.</span></div>
<div style="position:absolute;left:228.02px;top:188.67px" class="cls_006"><span class="cls_006">Once IDT/sim is at the system prompt, the engineer can complete the</span></div>
<div style="position:absolute;left:216.00px;top:199.67px" class="cls_006"><span class="cls_006">process of system debug. At this point, the ROM, RAM, and console UART</span></div>
<div style="position:absolute;left:216.00px;top:210.67px" class="cls_006"><span class="cls_006">subsystems are executing properly.</span></div>
<div style="position:absolute;left:228.02px;top:221.67px" class="cls_006"><span class="cls_006">The engineer may choose to use “Peek” and “Poke” operations into the</span></div>
<div style="position:absolute;left:216.00px;top:232.67px" class="cls_006"><span class="cls_006">memory space to test accesses to peripherals, or instead may begin porting</span></div>
<div style="position:absolute;left:216.00px;top:243.67px" class="cls_006"><span class="cls_006">drivers   and   diagnostics.   IDT/sim   will   provide   a   rich   execution</span></div>
<div style="position:absolute;left:216.00px;top:254.67px" class="cls_006"><span class="cls_006">environment,  including  breakpoints,  single  step,  cache  and  memory</span></div>
<div style="position:absolute;left:216.00px;top:265.67px" class="cls_006"><span class="cls_006">housekeeping, in-line assembly, download, etc.</span></div>
<div style="position:absolute;left:228.02px;top:276.67px" class="cls_006"><span class="cls_006">The  system  engineer  can  also  choose  to  apply  other  traditional</span></div>
<div style="position:absolute;left:216.00px;top:287.67px" class="cls_006"><span class="cls_006">microprocessor development tools, including ROM emulators, in-circuit</span></div>
<div style="position:absolute;left:216.00px;top:298.67px" class="cls_006"><span class="cls_006">emulators, and also use remote target debugging, during the actual system</span></div>
<div style="position:absolute;left:216.00px;top:309.67px" class="cls_006"><span class="cls_006">software port.</span></div>
<div style="position:absolute;left:216.00px;top:332.00px" class="cls_015"><span class="cls_015">A FINAL NOTE ON IDT/KIT</span></div>
<div style="position:absolute;left:228.02px;top:345.67px" class="cls_006"><span class="cls_006">In addition to the functions found in IDT/sim, IDT offers the Kernel</span></div>
<div style="position:absolute;left:216.00px;top:356.67px" class="cls_006"><span class="cls_006">Integration Toolkit. IDT/kit contains many bits of “housekeeping” code for</span></div>
<div style="position:absolute;left:216.00px;top:367.67px" class="cls_006"><span class="cls_006">the  system  environment  builder,  including  functions  such  as  cache</span></div>
<div style="position:absolute;left:216.00px;top:378.67px" class="cls_006"><span class="cls_006">flushing/management software and exception decode and dispatch. IDT/</span></div>
<div style="position:absolute;left:216.00px;top:389.67px" class="cls_006"><span class="cls_006">kit contains the “processor specific” bits and pieces of an operating system,</span></div>
<div style="position:absolute;left:216.00px;top:400.67px" class="cls_006"><span class="cls_006">allowing the OS programmer to be freed from many of the details of the</span></div>
<div style="position:absolute;left:216.00px;top:411.67px" class="cls_006"><span class="cls_006">CPU architecture and implementation.</span></div>
<div style="position:absolute;left:303.54px;top:755.33px" class="cls_002"><span class="cls_002">14-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:154786px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">SOFTWARE DESIGN</span></div>
<div style="position:absolute;left:459.00px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 15</span></div>
<div style="position:absolute;left:222.89px;top:56.33px" class="cls_005"><span class="cls_005">EXAMPLES</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:216.00px;top:113.00px" class="cls_015"><span class="cls_015">APPLICATION SOFTWARE</span></div>
<div style="position:absolute;left:228.02px;top:126.67px" class="cls_006"><span class="cls_006">This example will use the most common first C program: ‘‘Hello World’’.</span></div>
<div style="position:absolute;left:216.00px;top:137.67px" class="cls_006"><span class="cls_006">It will be run in RAM, by downloading it to an R30xx evaluation board</span></div>
<div style="position:absolute;left:216.00px;top:148.67px" class="cls_006"><span class="cls_006">using the IDT/sim PROM monitor. It is illustrative of a range of simple</span></div>
<div style="position:absolute;left:216.00px;top:159.67px" class="cls_006"><span class="cls_006">application   programs   and   benchmarks   which   will   probably   work,</span></div>
<div style="position:absolute;left:216.00px;top:170.67px" class="cls_006"><span class="cls_006">regardless of hardware or operating system, and require no more than a</span></div>
<div style="position:absolute;left:216.00px;top:181.67px" class="cls_006"><span class="cls_006">ANSI C library.</span></div>
<div style="position:absolute;left:252.00px;top:203.00px" class="cls_028"><span class="cls_028">#include &lt;stdio.h></span></div>
<div style="position:absolute;left:252.00px;top:223.00px" class="cls_028"><span class="cls_028">main (int argc, char **argv)</span></div>
<div style="position:absolute;left:252.00px;top:233.00px" class="cls_028"><span class="cls_028">{</span></div>
<div style="position:absolute;left:257.40px;top:243.00px" class="cls_028"><span class="cls_028">printf ("hello world!\n");</span></div>
<div style="position:absolute;left:257.40px;top:253.00px" class="cls_028"><span class="cls_028">return (0);</span></div>
<div style="position:absolute;left:252.00px;top:263.00px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:216.00px;top:294.00px" class="cls_015"><span class="cls_015">Memory map</span></div>
<div style="position:absolute;left:228.02px;top:307.67px" class="cls_006"><span class="cls_006">A simple stand-alone program will usually have all of memory to itself,</span></div>
<div style="position:absolute;left:216.00px;top:318.67px" class="cls_006"><span class="cls_006">except for a small amount at the bottom (and possibly the top) which is</span></div>
<div style="position:absolute;left:216.00px;top:329.67px" class="cls_006"><span class="cls_006">reserved for use by the PROM monitor.</span></div>
<div style="position:absolute;left:228.02px;top:340.67px" class="cls_006"><span class="cls_006">In such an environment, the programmer will not have to worry about</span></div>
<div style="position:absolute;left:216.00px;top:351.67px" class="cls_006"><span class="cls_006">virtual memory: the program can be linked to run in the cacheable kseg0</span></div>
<div style="position:absolute;left:216.00px;top:362.67px" class="cls_006"><span class="cls_006">address region or, to see the program with a logic analyzer, in the</span></div>
<div style="position:absolute;left:216.00px;top:373.67px" class="cls_006"><span class="cls_006">uncacheable kseg1 region. These regions map one-to-one with physical</span></div>
<div style="position:absolute;left:216.00px;top:384.67px" class="cls_006"><span class="cls_006">memory.</span></div>
<div style="position:absolute;left:228.02px;top:395.67px" class="cls_006"><span class="cls_006">A typical base address for the program code would be 0x80020000 (i.e.</span></div>
<div style="position:absolute;left:216.00px;top:406.67px" class="cls_006"><span class="cls_006">at offset 0x20000 in the KSEG0 region). This leaves 128 Kbytes free for the</span></div>
<div style="position:absolute;left:216.00px;top:417.67px" class="cls_006"><span class="cls_006">PROM monitor’s own data and stack, which is enough for IDT/sim. Above</span></div>
<div style="position:absolute;left:216.00px;top:428.67px" class="cls_006"><span class="cls_006">this will come the program’s initialized data, then BSS (uninitialized data),</span></div>
<div style="position:absolute;left:216.00px;top:439.67px" class="cls_006"><span class="cls_006">followed by its ‘‘heap’’ (free memory for use by </span><span class="cls_029">malloc</span><span class="cls_006"> </span><span class="cls_008">et al</span><span class="cls_006"> ). The PROM</span></div>
<div style="position:absolute;left:216.00px;top:450.67px" class="cls_006"><span class="cls_006">monitor will usually put the stack pointer near the top of memory, and the</span></div>
<div style="position:absolute;left:216.00px;top:461.67px" class="cls_006"><span class="cls_006">stack and heap will grow towards each other.</span></div>
<div style="position:absolute;left:216.00px;top:484.00px" class="cls_015"><span class="cls_015">Starting up</span></div>
<div style="position:absolute;left:228.02px;top:497.67px" class="cls_006"><span class="cls_006">Having downloaded the program to the evaluation board and told the</span></div>
<div style="position:absolute;left:216.00px;top:508.67px" class="cls_006"><span class="cls_006">PROM monitor to start the program, it will set the stack pointer to the top</span></div>
<div style="position:absolute;left:216.00px;top:519.67px" class="cls_006"><span class="cls_006">of memory and jump to the program’s </span><span class="cls_008">entrypoint</span><span class="cls_006">, often defined by a label</span></div>
<div style="position:absolute;left:216.01px;top:530.67px" class="cls_006"><span class="cls_006">with a standard name (e.g. </span><span class="cls_029">_start</span><span class="cls_006">), or simply by jumping to the first</span></div>
<div style="position:absolute;left:216.00px;top:541.67px" class="cls_006"><span class="cls_006">address in the program.</span></div>
<div style="position:absolute;left:228.02px;top:552.67px" class="cls_006"><span class="cls_006">The code following the entrypoint has to ensure that the run-time</span></div>
<div style="position:absolute;left:216.00px;top:563.67px" class="cls_006"><span class="cls_006">environment required for a C program and library is set up. For a</span></div>
<div style="position:absolute;left:216.00px;top:574.67px" class="cls_006"><span class="cls_006">downloaded program this is usually a simple matter of zeroing the BSS</span></div>
<div style="position:absolute;left:216.00px;top:585.67px" class="cls_006"><span class="cls_006">segment, and initializing the </span><span class="cls_008">$gp</span><span class="cls_006"> register and stack. It should then call the</span></div>
<div style="position:absolute;left:216.00px;top:596.67px" class="cls_006"><span class="cls_006">program’s </span><span class="cls_029"> main</span><span class="cls_006"> function, after ensuring that its </span><span class="cls_008">argc</span><span class="cls_006">, </span><span class="cls_008">argv</span><span class="cls_006"> and </span><span class="cls_008">envp</span></div>
<div style="position:absolute;left:216.00px;top:607.67px" class="cls_006"><span class="cls_006">arguments are initialized. If </span><span class="cls_029">main</span><span class="cls_006"> returns, then its return value is passed</span></div>
<div style="position:absolute;left:216.00px;top:618.67px" class="cls_006"><span class="cls_006">to the </span><span class="cls_029">exit</span><span class="cls_006"> function, which will close open files and in turn call </span><span class="cls_029">_exit</span><span class="cls_006">. The</span></div>
<div style="position:absolute;left:216.00px;top:629.67px" class="cls_029"><span class="cls_029">_exit</span><span class="cls_006"> function should transfer control back to the PROM monitor (the</span></div>
<div style="position:absolute;left:216.00px;top:640.67px" class="cls_006"><span class="cls_006">exact manner this is done is system or tool dependent)†.</span></div>
<div style="position:absolute;left:228.02px;top:651.67px" class="cls_006"><span class="cls_006">The following code fragment shows how a start-up module might be</span></div>
<div style="position:absolute;left:216.00px;top:662.67px" class="cls_006"><span class="cls_006">implemented; it is commonly provided as part of the development system.</span></div>
<div style="position:absolute;left:234.00px;top:710.67px" class="cls_006"><span class="cls_006">† The above functionality is provided by the “idt_csu.S” program</span></div>
<div style="position:absolute;left:234.00px;top:722.67px" class="cls_006"><span class="cls_006">provided with IDT/c.</span></div>
<div style="position:absolute;left:297.04px;top:754.68px" class="cls_002"><span class="cls_002">15-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:155588px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 15</span></div>
<div style="position:absolute;left:421.27px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE DESIGN EXAMPLES</span></div>
<div style="position:absolute;left:108.00px;top:61.00px" class="cls_028"><span class="cls_028">.comm  environ,4</span></div>
<div style="position:absolute;left:108.00px;top:81.00px" class="cls_028"><span class="cls_028">.data</span></div>
<div style="position:absolute;left:72.00px;top:91.00px" class="cls_028"><span class="cls_028">#defineARGC</span></div>
<div style="position:absolute;left:144.25px;top:91.00px" class="cls_028"><span class="cls_028">1</span></div>
<div style="position:absolute;left:72.00px;top:101.00px" class="cls_028"><span class="cls_028">argv0: .asciiz"prog"</span></div>
<div style="position:absolute;left:72.00px;top:111.00px" class="cls_028"><span class="cls_028">argvec:.word  argv0, 0</span></div>
<div style="position:absolute;left:72.00px;top:120.99px" class="cls_028"><span class="cls_028">envvec:.word</span></div>
<div style="position:absolute;left:144.28px;top:120.99px" class="cls_028"><span class="cls_028">0</span></div>
<div style="position:absolute;left:108.00px;top:150.99px" class="cls_028"><span class="cls_028">.text</span></div>
<div style="position:absolute;left:72.00px;top:160.99px" class="cls_028"><span class="cls_028">LEAF(_start)</span></div>
<div style="position:absolute;left:108.00px;top:170.99px" class="cls_028"><span class="cls_028">/* initialize $gp */</span></div>
<div style="position:absolute;left:108.00px;top:180.99px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:144.05px;top:180.99px" class="cls_028"><span class="cls_028">gp,_gp</span></div>
<div style="position:absolute;left:108.00px;top:200.99px" class="cls_028"><span class="cls_028">/* clear the BSS */</span></div>
<div style="position:absolute;left:108.00px;top:210.99px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:144.05px;top:210.99px" class="cls_028"><span class="cls_028">t0,_fbss</span></div>
<div style="position:absolute;left:108.00px;top:220.99px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:144.05px;top:220.99px" class="cls_028"><span class="cls_028">t1,end</span></div>
<div style="position:absolute;left:72.00px;top:230.98px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:108.05px;top:230.98px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.09px;top:230.98px" class="cls_028"><span class="cls_028">zero,0(t0)</span></div>
<div style="position:absolute;left:108.00px;top:240.98px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:144.09px;top:240.98px" class="cls_028"><span class="cls_028">t0,4</span></div>
<div style="position:absolute;left:108.00px;top:250.98px" class="cls_028"><span class="cls_028">bltu</span></div>
<div style="position:absolute;left:144.09px;top:250.98px" class="cls_028"><span class="cls_028">t0,t1,1b</span></div>
<div style="position:absolute;left:108.00px;top:270.98px" class="cls_028"><span class="cls_028">/* make sure stack is in same KSEG as .data */</span></div>
<div style="position:absolute;left:108.00px;top:280.98px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.06px;top:280.98px" class="cls_028"><span class="cls_028">t0,sp,0x1fffffff</span></div>
<div style="position:absolute;left:252.44px;top:280.98px" class="cls_028"><span class="cls_028"># get stack physical</span></div>
<div style="position:absolute;left:252.00px;top:290.98px" class="cls_028"><span class="cls_028"># address</span></div>
<div style="position:absolute;left:108.00px;top:300.98px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.06px;top:300.98px" class="cls_028"><span class="cls_028">t1,~0x1fffffff</span></div>
<div style="position:absolute;left:252.39px;top:300.98px" class="cls_028"><span class="cls_028"># get KSEG of "end"</span></div>
<div style="position:absolute;left:108.00px;top:310.98px" class="cls_028"><span class="cls_028">or</span></div>
<div style="position:absolute;left:144.05px;top:310.98px" class="cls_028"><span class="cls_028">sp,t0,t1</span></div>
<div style="position:absolute;left:252.23px;top:310.98px" class="cls_028"><span class="cls_028"># put sp in same KSEG</span></div>
<div style="position:absolute;left:108.00px;top:330.97px" class="cls_028"><span class="cls_028">/* align to 8 byte boundary and allocate an argsave</span></div>
<div style="position:absolute;left:144.00px;top:340.97px" class="cls_028"><span class="cls_028">area */</span></div>
<div style="position:absolute;left:108.00px;top:350.97px" class="cls_028"><span class="cls_028">and</span></div>
<div style="position:absolute;left:144.06px;top:350.97px" class="cls_028"><span class="cls_028">sp,~7</span></div>
<div style="position:absolute;left:108.00px;top:360.97px" class="cls_028"><span class="cls_028">subu</span></div>
<div style="position:absolute;left:144.09px;top:360.97px" class="cls_028"><span class="cls_028">sp,16</span></div>
<div style="position:absolute;left:108.00px;top:380.97px" class="cls_028"><span class="cls_028">/* initialize argc, argv, and environ (IDT/sim zeroes</span></div>
<div style="position:absolute;left:144.00px;top:390.97px" class="cls_028"><span class="cls_028">a0-a2) */</span></div>
<div style="position:absolute;left:108.00px;top:400.97px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:400.97px" class="cls_028"><span class="cls_028">a0,ARGC</span></div>
<div style="position:absolute;left:252.20px;top:400.97px" class="cls_028"><span class="cls_028"># dummy argc</span></div>
<div style="position:absolute;left:108.00px;top:410.97px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:144.05px;top:410.97px" class="cls_028"><span class="cls_028">a1,argvec</span></div>
<div style="position:absolute;left:252.25px;top:410.97px" class="cls_028"><span class="cls_028"># dummy argv</span></div>
<div style="position:absolute;left:108.00px;top:420.96px" class="cls_028"><span class="cls_028">la</span></div>
<div style="position:absolute;left:144.05px;top:420.96px" class="cls_028"><span class="cls_028">a2,envvec</span></div>
<div style="position:absolute;left:252.25px;top:420.96px" class="cls_028"><span class="cls_028"># dummy envp</span></div>
<div style="position:absolute;left:108.00px;top:430.96px" class="cls_028"><span class="cls_028">sw</span></div>
<div style="position:absolute;left:144.05px;top:430.96px" class="cls_028"><span class="cls_028">a2,environ</span></div>
<div style="position:absolute;left:108.00px;top:450.96px" class="cls_028"><span class="cls_028">/* exit (main (argc, argv, environ)) */</span></div>
<div style="position:absolute;left:108.00px;top:460.96px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:144.06px;top:460.96px" class="cls_028"><span class="cls_028">main</span></div>
<div style="position:absolute;left:108.00px;top:470.96px" class="cls_028"><span class="cls_028">move</span></div>
<div style="position:absolute;left:144.09px;top:470.96px" class="cls_028"><span class="cls_028">a0,v0</span></div>
<div style="position:absolute;left:108.00px;top:480.96px" class="cls_028"><span class="cls_028">jal</span></div>
<div style="position:absolute;left:144.06px;top:480.96px" class="cls_028"><span class="cls_028">exit</span></div>
<div style="position:absolute;left:108.00px;top:500.96px" class="cls_028"><span class="cls_028">/* in case exit returns */</span></div>
<div style="position:absolute;left:72.00px;top:510.96px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:108.05px;top:510.96px" class="cls_028"><span class="cls_028">break</span></div>
<div style="position:absolute;left:144.16px;top:510.96px" class="cls_028"><span class="cls_028">1</span></div>
<div style="position:absolute;left:108.00px;top:520.96px" class="cls_028"><span class="cls_028">b</span></div>
<div style="position:absolute;left:144.02px;top:520.96px" class="cls_028"><span class="cls_028">1b</span></div>
<div style="position:absolute;left:72.00px;top:530.95px" class="cls_028"><span class="cls_028">END(_start)</span></div>
<div style="position:absolute;left:72.00px;top:560.95px" class="cls_028"><span class="cls_028">LEAF(_exit)</span></div>
<div style="position:absolute;left:108.00px;top:570.95px" class="cls_028"><span class="cls_028">li</span></div>
<div style="position:absolute;left:144.05px;top:570.95px" class="cls_028"><span class="cls_028">ra,0xbfc00000+(17*8)# IDT/sim prom return</span></div>
<div style="position:absolute;left:252.00px;top:580.95px" class="cls_028"><span class="cls_028"># vector</span></div>
<div style="position:absolute;left:108.00px;top:590.95px" class="cls_028"><span class="cls_028">j</span></div>
<div style="position:absolute;left:144.02px;top:590.95px" class="cls_028"><span class="cls_028">ra</span></div>
<div style="position:absolute;left:72.00px;top:600.95px" class="cls_028"><span class="cls_028">END(_exit)</span></div>
<div style="position:absolute;left:36.00px;top:632.00px" class="cls_015"><span class="cls_015">C Library functions</span></div>
<div style="position:absolute;left:48.02px;top:645.67px" class="cls_006"><span class="cls_006">Many C application programs will expect to have access to a C library</span></div>
<div style="position:absolute;left:36.00px;top:656.67px" class="cls_006"><span class="cls_006">which conforms to the ANSI definition, as described in [reference K&R].</span></div>
<div style="position:absolute;left:36.00px;top:667.67px" class="cls_006"><span class="cls_006">Most development systems will supply a library that conforms to at least</span></div>
<div style="position:absolute;left:36.00px;top:678.67px" class="cls_006"><span class="cls_006">some parts of this standard. The rest of this section follows Appendix B of</span></div>
<div style="position:absolute;left:36.00px;top:689.67px" class="cls_006"><span class="cls_006">[reference K&R] to warn the programmer about those areas where some</span></div>
<div style="position:absolute;left:36.00px;top:700.67px" class="cls_006"><span class="cls_006">cross-development system libraries may deviate from the standard - refer</span></div>
<div style="position:absolute;left:36.00px;top:711.67px" class="cls_006"><span class="cls_006">to the toolchain documentation for specific information.</span></div>
<div style="position:absolute;left:289.79px;top:755.33px" class="cls_002"><span class="cls_002">15-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:156390px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE DESIGN EXAMPLES</span></div>
<div style="position:absolute;left:520.54px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 15</span></div>
<div style="position:absolute;left:216.00px;top:50.67px" class="cls_006"><span class="cls_006">Input and output</span></div>
<div style="position:absolute;left:228.02px;top:61.67px" class="cls_006"><span class="cls_006">The &lt;</span><span class="cls_029">stdio.h</span><span class="cls_006">> header file is almost certain to be present, but the</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_006"><span class="cls_006">library will often provide only a small subset of the expected standard i/o</span></div>
<div style="position:absolute;left:216.00px;top:83.67px" class="cls_006"><span class="cls_006">facilities. In particular it will usually provide access to only a single console</span></div>
<div style="position:absolute;left:216.00px;top:94.67px" class="cls_006"><span class="cls_006">device via </span><span class="cls_008">stdin</span><span class="cls_006"> and </span><span class="cls_008">stdout</span><span class="cls_006">, with no file i/o. Some systems may provide</span></div>
<div style="position:absolute;left:216.00px;top:105.67px" class="cls_006"><span class="cls_006">remote file access facilities, but this is often via a distinct set of non-</span></div>
<div style="position:absolute;left:216.00px;top:116.67px" class="cls_006"><span class="cls_006">standard function calls†.</span></div>
<div style="position:absolute;left:228.02px;top:130.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> File operations</span><span class="cls_006">: are unlikely to be present, and if they are will usually</span></div>
<div style="position:absolute;left:239.97px;top:141.67px" class="cls_006"><span class="cls_006">support only the system console device.</span></div>
<div style="position:absolute;left:228.02px;top:155.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Formatted output</span><span class="cls_006"> : the </span><span class="cls_029">printf</span><span class="cls_006"> functions will usually be present, but</span></div>
<div style="position:absolute;left:239.97px;top:166.67px" class="cls_006"><span class="cls_006">may omit some of the newer ANSI formatting options, and may not</span></div>
<div style="position:absolute;left:239.97px;top:177.67px" class="cls_006"><span class="cls_006">support floating-point formats.</span></div>
<div style="position:absolute;left:228.02px;top:191.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Formatted input</span><span class="cls_006"> : the </span><span class="cls_029">scanf</span><span class="cls_006"> functions are often absent.</span></div>
<div style="position:absolute;left:228.03px;top:205.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Character input and output</span><span class="cls_006">: usually provided, but often only to the</span></div>
<div style="position:absolute;left:239.98px;top:216.67px" class="cls_006"><span class="cls_006">system console.</span></div>
<div style="position:absolute;left:228.03px;top:230.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Direct input and output</span><span class="cls_006">: sometimes provided, but often only to the</span></div>
<div style="position:absolute;left:239.97px;top:241.67px" class="cls_006"><span class="cls_006">system console. or serial I/O ports.</span></div>
<div style="position:absolute;left:228.02px;top:255.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> File positioning</span><span class="cls_006">: probably absent.</span></div>
<div style="position:absolute;left:228.02px;top:269.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Error handling</span><span class="cls_006">: probably absent.</span></div>
<div style="position:absolute;left:216.00px;top:290.67px" class="cls_006"><span class="cls_006">Character class tests</span></div>
<div style="position:absolute;left:228.02px;top:301.67px" class="cls_006"><span class="cls_006">The &lt;</span><span class="cls_029">ctype.h</span><span class="cls_006">> header file and its associated functions and/or macros</span></div>
<div style="position:absolute;left:216.00px;top:312.67px" class="cls_006"><span class="cls_006">are usually provided. The </span><span class="cls_029">isxdigit</span><span class="cls_006"> function is sometimes absent or has</span></div>
<div style="position:absolute;left:216.00px;top:323.67px" class="cls_006"><span class="cls_006">a different name.</span></div>
<div style="position:absolute;left:216.00px;top:344.67px" class="cls_006"><span class="cls_006">String functions</span></div>
<div style="position:absolute;left:228.02px;top:355.67px" class="cls_006"><span class="cls_006">The older string functions are usually present, although often not very</span></div>
<div style="position:absolute;left:216.00px;top:366.67px" class="cls_006"><span class="cls_006">optimized. Some of the newer string functions such as </span><span class="cls_029">strspn</span><span class="cls_006">, </span><span class="cls_029">strcspn</span><span class="cls_006">,</span></div>
<div style="position:absolute;left:216.00px;top:377.67px" class="cls_029"><span class="cls_029">strpbrk</span><span class="cls_006">, </span><span class="cls_029">strstr</span><span class="cls_006">, </span><span class="cls_029">strerror</span><span class="cls_006"> and </span><span class="cls_029">strtok</span><span class="cls_006"> may be absent.</span></div>
<div style="position:absolute;left:228.02px;top:388.67px" class="cls_006"><span class="cls_006">The </span><span class="cls_029">mem...</span><span class="cls_006"> functions are sometimes absent, and in their place the older</span></div>
<div style="position:absolute;left:216.00px;top:399.67px" class="cls_029"><span class="cls_029">bcopy</span><span class="cls_006">, </span><span class="cls_029">bcmp</span><span class="cls_006"> and </span><span class="cls_029">bzero</span><span class="cls_006"> functions may be provided.</span></div>
<div style="position:absolute;left:216.00px;top:420.67px" class="cls_006"><span class="cls_006">Mathematical functions</span></div>
<div style="position:absolute;left:228.02px;top:431.67px" class="cls_006"><span class="cls_006">The mathematical functions, if provided at all, will often be in a separate</span></div>
<div style="position:absolute;left:216.00px;top:442.67px" class="cls_006"><span class="cls_006">maths library. If this library is supplied, it will probably implement all of</span></div>
<div style="position:absolute;left:216.00px;top:453.67px" class="cls_006"><span class="cls_006">the required functions. Note that it may be impossible, or tricky, to run</span></div>
<div style="position:absolute;left:216.00px;top:464.67px" class="cls_006"><span class="cls_006">floating-point code on CPUs which do not have an on-chip FPA. Even if it</span></div>
<div style="position:absolute;left:216.00px;top:475.67px" class="cls_006"><span class="cls_006">does have one, the system may still need a trap handler for serious</span></div>
<div style="position:absolute;left:216.00px;top:486.67px" class="cls_006"><span class="cls_006">floating-point  use).  Some  compilers  can  be  instructed  to  implement</span></div>
<div style="position:absolute;left:216.00px;top:497.67px" class="cls_006"><span class="cls_006">floating-point operations by making calls to an emulation library.</span></div>
<div style="position:absolute;left:216.00px;top:518.67px" class="cls_006"><span class="cls_006">Utility functions</span></div>
<div style="position:absolute;left:228.02px;top:529.67px" class="cls_006"><span class="cls_006">The </span><span class="cls_029">strto...</span><span class="cls_006"> functions are sometimes absent, but the older</span><span class="cls_029">atoi</span><span class="cls_006"> and</span></div>
<div style="position:absolute;left:216.00px;top:540.67px" class="cls_029"><span class="cls_029">atol</span><span class="cls_006"> will usually be available. The floating point conversions may be</span></div>
<div style="position:absolute;left:216.00px;top:551.67px" class="cls_006"><span class="cls_006">absent.</span></div>
<div style="position:absolute;left:228.02px;top:562.67px" class="cls_006"><span class="cls_006">The following functions are often absent: </span><span class="cls_029">rand</span><span class="cls_006">, </span><span class="cls_029">srand</span><span class="cls_006">, </span><span class="cls_029">atexit</span><span class="cls_006">, </span><span class="cls_029">system</span><span class="cls_006">,</span></div>
<div style="position:absolute;left:216.00px;top:573.67px" class="cls_029"><span class="cls_029">getenv</span><span class="cls_006">, </span><span class="cls_029">bsearch</span><span class="cls_006">, </span><span class="cls_029">qsort</span><span class="cls_006">, </span><span class="cls_029">labs</span><span class="cls_006">, </span><span class="cls_029">div</span><span class="cls_006"> and </span><span class="cls_029">ldiv</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:228.02px;top:584.67px" class="cls_006"><span class="cls_006">The </span><span class="cls_029">malloc</span><span class="cls_006"> family will probably exist in some form, although </span><span class="cls_029"> realloc</span></div>
<div style="position:absolute;left:216.00px;top:595.67px" class="cls_006"><span class="cls_006">is sometimes absent. At the lowest level they will probably call the </span><span class="cls_029">sbrk</span></div>
<div style="position:absolute;left:216.00px;top:606.67px" class="cls_006"><span class="cls_006">function to acquire memory from the system, which the programmer may</span></div>
<div style="position:absolute;left:216.00px;top:617.67px" class="cls_006"><span class="cls_006">be required to implement. A simple </span><span class="cls_029">sbrk</span><span class="cls_006"> will just return consecutive</span></div>
<div style="position:absolute;left:216.00px;top:628.67px" class="cls_006"><span class="cls_006">chunks of memory starting from </span><span class="cls_029">&end</span><span class="cls_006"> (i.e. just after the program’s declared</span></div>
<div style="position:absolute;left:216.00px;top:639.67px" class="cls_006"><span class="cls_006">data), until it reaches somewhere near the bottom of the stack, as follows:</span></div>
<div style="position:absolute;left:234.00px;top:686.67px" class="cls_006"><span class="cls_006">† The IDT/c toolchain does provide many of these and other</span></div>
<div style="position:absolute;left:234.00px;top:698.67px" class="cls_006"><span class="cls_006">referenced functions. The programmer should consult the</span></div>
<div style="position:absolute;left:234.00px;top:710.67px" class="cls_006"><span class="cls_006">reference manuals for a particular toolchain to determine which</span></div>
<div style="position:absolute;left:234.00px;top:722.67px" class="cls_006"><span class="cls_006">functions are supported.</span></div>
<div style="position:absolute;left:303.54px;top:755.33px" class="cls_002"><span class="cls_002">15-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:157192px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 15</span></div>
<div style="position:absolute;left:421.27px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE DESIGN EXAMPLES</span></div>
<div style="position:absolute;left:72.00px;top:61.00px" class="cls_028"><span class="cls_028">extern char end[];</span></div>
<div style="position:absolute;left:72.00px;top:71.00px" class="cls_028"><span class="cls_028">extern interrno;</span></div>
<div style="position:absolute;left:72.00px;top:81.00px" class="cls_028"><span class="cls_028">static void *curbrk = end;</span></div>
<div style="position:absolute;left:72.00px;top:91.00px" class="cls_028"><span class="cls_028">static void *maxbrk = 0;</span></div>
<div style="position:absolute;left:72.00px;top:111.00px" class="cls_028"><span class="cls_028">#define MAXSTACK (64 * 1024)</span></div>
<div style="position:absolute;left:72.00px;top:130.99px" class="cls_028"><span class="cls_028">void *</span></div>
<div style="position:absolute;left:72.00px;top:140.99px" class="cls_028"><span class="cls_028">sbrk (int n)</span></div>
<div style="position:absolute;left:72.00px;top:150.99px" class="cls_028"><span class="cls_028">{</span></div>
<div style="position:absolute;left:77.40px;top:160.99px" class="cls_028"><span class="cls_028">void *p;</span></div>
<div style="position:absolute;left:77.40px;top:180.99px" class="cls_028"><span class="cls_028">/* calculate limit for curbrk on first call */</span></div>
<div style="position:absolute;left:77.40px;top:190.99px" class="cls_028"><span class="cls_028">if (!maxbrk)</span></div>
<div style="position:absolute;left:77.40px;top:200.99px" class="cls_028"><span class="cls_028">maxbrk = (void *)&n - MAXSTACK; /* &n is approx value of</span></div>
<div style="position:absolute;left:257.40px;top:210.99px" class="cls_028"><span class="cls_028">$sp */</span></div>
<div style="position:absolute;left:77.40px;top:230.98px" class="cls_028"><span class="cls_028">/* check that there is room for this request */</span></div>
<div style="position:absolute;left:77.40px;top:240.98px" class="cls_028"><span class="cls_028">if (curbrk + n > maxbrk) {</span></div>
<div style="position:absolute;left:108.00px;top:250.98px" class="cls_028"><span class="cls_028">/* no room */</span></div>
<div style="position:absolute;left:77.40px;top:260.98px" class="cls_028"><span class="cls_028">errno = ENOMEM;</span></div>
<div style="position:absolute;left:77.40px;top:270.98px" class="cls_028"><span class="cls_028">return (void *)-1;</span></div>
<div style="position:absolute;left:77.40px;top:280.98px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:77.40px;top:300.98px" class="cls_028"><span class="cls_028">/* zero the requested region */</span></div>
<div style="position:absolute;left:77.40px;top:310.98px" class="cls_028"><span class="cls_028">memset (curbrk, 0, n);</span></div>
<div style="position:absolute;left:77.40px;top:330.97px" class="cls_028"><span class="cls_028">/* advance curbrk past region and return pointer to it */</span></div>
<div style="position:absolute;left:77.40px;top:340.97px" class="cls_028"><span class="cls_028">p = curbrk;</span></div>
<div style="position:absolute;left:77.40px;top:350.97px" class="cls_028"><span class="cls_028">curbrk += n;</span></div>
<div style="position:absolute;left:77.40px;top:360.97px" class="cls_028"><span class="cls_028">return p;</span></div>
<div style="position:absolute;left:72.00px;top:370.97px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:36.00px;top:400.67px" class="cls_006"><span class="cls_006">Diagnostics</span></div>
<div style="position:absolute;left:48.02px;top:411.67px" class="cls_006"><span class="cls_006">The </span><span class="cls_029">assert</span><span class="cls_006"> macro is often absent.</span></div>
<div style="position:absolute;left:36.00px;top:432.67px" class="cls_006"><span class="cls_006">Variable argument lists</span></div>
<div style="position:absolute;left:48.02px;top:443.67px" class="cls_006"><span class="cls_006">Variable arguments are usually supported, but sometimes only via the</span></div>
<div style="position:absolute;left:36.00px;top:454.67px" class="cls_006"><span class="cls_006">old </span><span class="cls_008">vararg</span><span class="cls_006"> mechanism rather than the newer ANSI </span><span class="cls_008">stdarg</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:36.00px;top:475.67px" class="cls_006"><span class="cls_006">Non-local jumps</span></div>
<div style="position:absolute;left:48.02px;top:486.67px" class="cls_006"><span class="cls_006">The </span><span class="cls_029">setjmp</span><span class="cls_006"> and </span><span class="cls_029">longjmp</span><span class="cls_006"> functions are usually supplied.</span></div>
<div style="position:absolute;left:36.00px;top:507.67px" class="cls_006"><span class="cls_006">Signals</span></div>
<div style="position:absolute;left:48.02px;top:518.67px" class="cls_006"><span class="cls_006">It is unlikely that the signal functions will be supported, although</span></div>
<div style="position:absolute;left:36.00px;top:529.67px" class="cls_006"><span class="cls_006">sometimes a limited form is provided in order to support SIGINT only.</span></div>
<div style="position:absolute;left:36.00px;top:550.67px" class="cls_006"><span class="cls_006">Date and time</span></div>
<div style="position:absolute;left:48.02px;top:561.67px" class="cls_006"><span class="cls_006">It is likely that none of these functions will be available. Timing</span></div>
<div style="position:absolute;left:36.00px;top:572.67px" class="cls_006"><span class="cls_006">benchmarks will often require a stop-watch, or some software mechanism</span></div>
<div style="position:absolute;left:36.00px;top:583.67px" class="cls_006"><span class="cls_006">which is very specific to the PROM monitor and/or development system†.</span></div>
<div style="position:absolute;left:36.00px;top:606.00px" class="cls_015"><span class="cls_015">Running the program</span></div>
<div style="position:absolute;left:48.02px;top:619.67px" class="cls_006"><span class="cls_006">Having typed in the ‘‘hello world’’ program, the programmer must then</span></div>
<div style="position:absolute;left:36.00px;top:630.67px" class="cls_006"><span class="cls_006">compile it, link it, and convert it into a form suitable for downloading to an</span></div>
<div style="position:absolute;left:36.00px;top:641.67px" class="cls_006"><span class="cls_006">evaluation  board.  This  process  is  very  dependent  on  the  particular</span></div>
<div style="position:absolute;left:54.00px;top:686.67px" class="cls_006"><span class="cls_006">† IDT typically provides timer utilities as part of a utility disk</span></div>
<div style="position:absolute;left:54.00px;top:698.67px" class="cls_006"><span class="cls_006">provided with an evaluation board, and also with the IDT/c</span></div>
<div style="position:absolute;left:54.00px;top:710.67px" class="cls_006"><span class="cls_006">toolchain. These utilities are often board specific, since they rely</span></div>
<div style="position:absolute;left:54.00px;top:722.67px" class="cls_006"><span class="cls_006">on an underlying hardware timer mechanism.</span></div>
<div style="position:absolute;left:289.79px;top:755.33px" class="cls_002"><span class="cls_002">15-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:157994px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE DESIGN EXAMPLES</span></div>
<div style="position:absolute;left:520.54px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 15</span></div>
<div style="position:absolute;left:216.00px;top:50.67px" class="cls_006"><span class="cls_006">development  system,  which  should  provide  some  sort  of  automated</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">mechanism: many UNIX-hosted toolchains provide a set of </span><span class="cls_008">makefiles</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_006"><span class="cls_006">which control the whole process, via the well-known </span><span class="cls_008">make</span><span class="cls_006"> utility.</span></div>
<div style="position:absolute;left:228.02px;top:83.67px" class="cls_006"><span class="cls_006">When the compilation has completed successfully, a down-loadable file</span></div>
<div style="position:absolute;left:216.00px;top:94.67px" class="cls_006"><span class="cls_006">is   created</span></div>
<div style="position:absolute;left:280.12px;top:94.67px" class="cls_006"><span class="cls_006">(typically   using   S-records   or   other   standard   format).</span></div>
<div style="position:absolute;left:216.00px;top:105.67px" class="cls_006"><span class="cls_006">Downloading this file will require the use of a terminal emulator (in IDT/</span></div>
<div style="position:absolute;left:216.00px;top:116.67px" class="cls_006"><span class="cls_006">sim, use the “load” command on the board, and the “cp” command on the</span></div>
<div style="position:absolute;left:216.00px;top:127.67px" class="cls_006"><span class="cls_006">host), or some other special utility, to transmit the file down an RS232 line</span></div>
<div style="position:absolute;left:216.00px;top:138.67px" class="cls_006"><span class="cls_006">to the board. More advanced evaluation boards may provide an Ethernet</span></div>
<div style="position:absolute;left:216.00px;top:149.67px" class="cls_006"><span class="cls_006">or parallel interface in order to download large programs at high speed.</span></div>
<div style="position:absolute;left:216.00px;top:160.67px" class="cls_006"><span class="cls_006">Finally, it is then only necessary to instruct the PROM monitor to execute</span></div>
<div style="position:absolute;left:216.00px;top:171.67px" class="cls_006"><span class="cls_006">the program.</span></div>
<div style="position:absolute;left:228.02px;top:182.67px" class="cls_006"><span class="cls_006">So a complete edit, compile, download and run cycle on a SUN platform</span></div>
<div style="position:absolute;left:216.00px;top:193.67px" class="cls_006"><span class="cls_006">using IDT/c might look like this:</span></div>
<div style="position:absolute;left:228.02px;top:215.67px" class="cls_008"><span class="cls_008">On development system:</span></div>
<div style="position:absolute;left:219.05px;top:227.66px" class="cls_020"><span class="cls_020">C> cd /idt/samples</span></div>
<div style="position:absolute;left:360.00px;top:226.67px" class="cls_048"><span class="cls_048">change to source code directory</span></div>
<div style="position:absolute;left:219.40px;top:237.67px" class="cls_020"><span class="cls_020">C> vi hello.c</span></div>
<div style="position:absolute;left:360.00px;top:237.67px" class="cls_048"><span class="cls_048">enter/edit the source file</span></div>
<div style="position:absolute;left:219.40px;top:248.67px" class="cls_020"><span class="cls_020">C> cp MakeBE Makefile</span></div>
<div style="position:absolute;left:360.00px;top:250.67px" class="cls_048"><span class="cls_048">create the makefile from the template</span></div>
<div style="position:absolute;left:219.06px;top:259.67px" class="cls_020"><span class="cls_020">C> vi Makefile</span></div>
<div style="position:absolute;left:360.00px;top:261.67px" class="cls_048"><span class="cls_048">change ”stanford” in template to “hello”</span></div>
<div style="position:absolute;left:219.06px;top:270.67px" class="cls_020"><span class="cls_020">C> make</span></div>
<div style="position:absolute;left:360.00px;top:270.67px" class="cls_048"><span class="cls_048">compile and link for IDT 79RS385 board</span><span class="cls_008"> ;</span></div>
<div style="position:absolute;left:360.00px;top:281.67px" class="cls_008"><span class="cls_008">t</span><span class="cls_048">his creates a “hellof.srec” file</span></div>
<div style="position:absolute;left:216.00px;top:303.67px" class="cls_008"><span class="cls_008">On eval board’s console:</span></div>
<div style="position:absolute;left:219.40px;top:314.67px" class="cls_020"><span class="cls_020">IDT>> l -a tty1</span></div>
<div style="position:absolute;left:360.00px;top:314.67px" class="cls_048"><span class="cls_048">srec download via RS232 port #</span><span class="cls_008">1</span></div>
<div style="position:absolute;left:216.00px;top:336.67px" class="cls_008"><span class="cls_008">On development system:</span></div>
<div style="position:absolute;left:219.40px;top:348.67px" class="cls_020"><span class="cls_020">C> cat hellof.srec > /dev/ttyb download via ttyb port</span></div>
<div style="position:absolute;left:216.00px;top:369.67px" class="cls_008"><span class="cls_008">On eval board’s console:</span></div>
<div style="position:absolute;left:219.40px;top:381.67px" class="cls_020"><span class="cls_020">IDT>> go</span></div>
<div style="position:absolute;left:360.00px;top:380.67px" class="cls_048"><span class="cls_048">start the program</span></div>
<div style="position:absolute;left:216.00px;top:414.00px" class="cls_015"><span class="cls_015">Debugging the program</span></div>
<div style="position:absolute;left:228.02px;top:427.67px" class="cls_006"><span class="cls_006">Hopefully not too much can go wrong with ‘‘hello world’’, but larger</span></div>
<div style="position:absolute;left:216.00px;top:438.67px" class="cls_006"><span class="cls_006">application programs may require some debugging before they work.</span></div>
<div style="position:absolute;left:228.02px;top:449.67px" class="cls_006"><span class="cls_006">Most PROM monitors, including IDT/sim, incorporate a command-line</span></div>
<div style="position:absolute;left:216.00px;top:460.67px" class="cls_006"><span class="cls_006">driven,  machine-level  debugger.  This  will  allow  the  programmer  to</span></div>
<div style="position:absolute;left:216.00px;top:471.67px" class="cls_006"><span class="cls_006">disassemble the code, examine registers and memory, set breakpoints and</span></div>
<div style="position:absolute;left:216.00px;top:482.67px" class="cls_006"><span class="cls_006">single-step through code one machine-instruction at a time.</span></div>
<div style="position:absolute;left:228.02px;top:493.67px" class="cls_006"><span class="cls_006">Source-level debuggers allow the programmer to work in terms of the</span></div>
<div style="position:absolute;left:216.00px;top:504.67px" class="cls_006"><span class="cls_006">original  source  code  and  data  structures  instead  of  MIPS  machine</span></div>
<div style="position:absolute;left:216.00px;top:515.67px" class="cls_006"><span class="cls_006">instructions. These debuggers run on the host development system - so</span></div>
<div style="position:absolute;left:216.00px;top:526.67px" class="cls_006"><span class="cls_006">that they can get at the source files and compiler-generated debugging</span></div>
<div style="position:absolute;left:216.00px;top:537.67px" class="cls_006"><span class="cls_006">information. They operate the program on the evaluation board by ‘‘remote</span></div>
<div style="position:absolute;left:216.00px;top:548.67px" class="cls_006"><span class="cls_006">control’’, via a serial line or network connection. Many PROM monitors will</span></div>
<div style="position:absolute;left:216.00px;top:559.67px" class="cls_006"><span class="cls_006">incorporate a special protocol to support this feature, although some may</span></div>
<div style="position:absolute;left:216.00px;top:570.67px" class="cls_006"><span class="cls_006">require that the code for it be downloaded along with the program.</span></div>
<div style="position:absolute;left:228.02px;top:581.67px" class="cls_006"><span class="cls_006">Source-level debuggers may themselves be command-line driven (e.g.</span></div>
<div style="position:absolute;left:216.00px;top:592.67px" class="cls_006"><span class="cls_006">MIPS </span><span class="cls_008">dbx</span><span class="cls_006"> and IDT’s/GNU’s </span><span class="cls_008">gdb</span><span class="cls_006">), or may offer a multi-window, GUI</span></div>
<div style="position:absolute;left:215.99px;top:603.67px" class="cls_006"><span class="cls_006">interface. In all cases they are very complex programs, with many different</span></div>
<div style="position:absolute;left:215.99px;top:614.67px" class="cls_006"><span class="cls_006">commands and options. The development system’s documentation should</span></div>
<div style="position:absolute;left:215.99px;top:625.67px" class="cls_006"><span class="cls_006">provide more details of how to use them with a target board.</span></div>
<div style="position:absolute;left:216.00px;top:648.00px" class="cls_015"><span class="cls_015">EMBEDDED SYSTEM SOFTWARE</span></div>
<div style="position:absolute;left:228.02px;top:661.67px" class="cls_006"><span class="cls_006">Many aspects of ‘‘embedded software’’ are the same as ‘‘application</span></div>
<div style="position:absolute;left:216.00px;top:672.67px" class="cls_006"><span class="cls_006">software’’, and its early development may be carried out in exactly the</span></div>
<div style="position:absolute;left:216.00px;top:683.67px" class="cls_006"><span class="cls_006">same way, on an evaluation board. But ultimately it is likely to be running</span></div>
<div style="position:absolute;left:216.00px;top:694.67px" class="cls_006"><span class="cls_006">in EPROM, on custom hardware, and require lower-level access to the</span></div>
<div style="position:absolute;left:216.00px;top:705.67px" class="cls_006"><span class="cls_006">processor in order to initialize it, test it, and handle machine traps and</span></div>
<div style="position:absolute;left:216.00px;top:716.67px" class="cls_006"><span class="cls_006">interrupts.</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">15-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:158796px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 15</span></div>
<div style="position:absolute;left:421.27px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE DESIGN EXAMPLES</span></div>
<div style="position:absolute;left:36.00px;top:50.00px" class="cls_015"><span class="cls_015">Memory map</span></div>
<div style="position:absolute;left:48.02px;top:63.67px" class="cls_006"><span class="cls_006">Compared to a program which is downloaded into RAM, embedded</span></div>
<div style="position:absolute;left:36.00px;top:74.67px" class="cls_006"><span class="cls_006">software will (at least initially) have its code and read-only data in EPROM.</span></div>
<div style="position:absolute;left:36.00px;top:85.67px" class="cls_006"><span class="cls_006">The EPROM, and thus the code, should be located at physical address</span></div>
<div style="position:absolute;left:36.00px;top:96.67px" class="cls_029"><span class="cls_029">0x1fc00000</span><span class="cls_006">,  which  corresponds  to  the  processor’s  reset  vector  of</span></div>
<div style="position:absolute;left:36.00px;top:107.67px" class="cls_029"><span class="cls_029">0xbfc00000</span><span class="cls_006">. The data area should probably be located near the bottom of</span></div>
<div style="position:absolute;left:36.00px;top:118.67px" class="cls_006"><span class="cls_006">RAM (DRAM or SRAM), but just above the area used for the processor’s</span></div>
<div style="position:absolute;left:36.00px;top:129.67px" class="cls_006"><span class="cls_006">(non-boot)  exception  vectors:</span></div>
<div style="position:absolute;left:194.00px;top:129.67px" class="cls_029"><span class="cls_029">0x400</span><span class="cls_006">  should  be  safe  for  all  existing</span></div>
<div style="position:absolute;left:36.00px;top:140.67px" class="cls_006"><span class="cls_006">RISController processors. Device registers should be decoded at high</span></div>
<div style="position:absolute;left:36.00px;top:151.67px" class="cls_006"><span class="cls_006">physical addresses, but below 512 Mb. If the hardware engineer suggests</span></div>
<div style="position:absolute;left:36.00px;top:162.67px" class="cls_006"><span class="cls_006">putting RAM at anywhere other than zero, or device registers anywhere</span></div>
<div style="position:absolute;left:36.00px;top:173.67px" class="cls_006"><span class="cls_006">outside of the bottom 512 Mb, then complain loudly: it will make software</span></div>
<div style="position:absolute;left:36.00px;top:184.67px" class="cls_006"><span class="cls_006">much more complicated, and performance may suffer.</span></div>
<div style="position:absolute;left:36.00px;top:207.00px" class="cls_015"><span class="cls_015">Starting up</span></div>
<div style="position:absolute;left:48.02px;top:220.67px" class="cls_006"><span class="cls_006">After a hardware reset, code will be running in KSEG1 (i.e. uncached),</span></div>
<div style="position:absolute;left:36.00px;top:231.67px" class="cls_006"><span class="cls_006">with the caches, TLB (if present), internal registers, and RAM in an</span></div>
<div style="position:absolute;left:36.00px;top:242.67px" class="cls_006"><span class="cls_006">undefined state. Its first job is to initialize these resources. A detailed</span></div>
<div style="position:absolute;left:36.00px;top:253.67px" class="cls_006"><span class="cls_006">discussion and example of this can be found in  earlier chapters of this</span></div>
<div style="position:absolute;left:36.00px;top:264.67px" class="cls_006"><span class="cls_006">manual.</span></div>
<div style="position:absolute;left:48.02px;top:275.67px" class="cls_006"><span class="cls_006">For higher performance, code will need to be located in the cacheable</span></div>
<div style="position:absolute;left:36.00px;top:286.67px" class="cls_006"><span class="cls_006">KSEG0 region (i.e. at </span><span class="cls_029">0x9fc00000</span><span class="cls_006">), rather than the uncached KSEG1</span></div>
<div style="position:absolute;left:36.00px;top:297.67px" class="cls_006"><span class="cls_006">(</span><span class="cls_029">0xbfc00000</span><span class="cls_006">). This has implications for start-up code. Before the caches</span></div>
<div style="position:absolute;left:36.00px;top:308.67px" class="cls_006"><span class="cls_006">are initialized, branches and absolute jumps (i.e. j and jal) are safe,</span></div>
<div style="position:absolute;left:36.00px;top:319.67px" class="cls_006"><span class="cls_006">because they do not alter the top four bits of the program counter, but any</span></div>
<div style="position:absolute;left:36.00px;top:330.67px" class="cls_006"><span class="cls_006">reference to data, or an attempt take the address of a function for use with</span></div>
<div style="position:absolute;left:36.00px;top:341.67px" class="cls_006"><span class="cls_006">jr or jalr will generate a KSEG0 address before it is valid to do so. The</span></div>
<div style="position:absolute;left:36.00px;top:352.67px" class="cls_006"><span class="cls_006">programmer  must  take  care  that  any  such  references  are  explicitly</span></div>
<div style="position:absolute;left:36.00px;top:363.67px" class="cls_006"><span class="cls_006">mapped to KSEG1, by logically or-ing in the KSEG1 base address (i.e.</span></div>
<div style="position:absolute;left:36.00px;top:374.67px" class="cls_029"><span class="cls_029">0xa0000000).</span><span class="cls_006"> Once the caches are initialized, switch to running cached</span></div>
<div style="position:absolute;left:36.00px;top:385.67px" class="cls_006"><span class="cls_006">by use of an explicit </span><span class="cls_041">jr</span><span class="cls_006"> instruction, as follows:</span></div>
<div style="position:absolute;left:77.40px;top:407.00px" class="cls_028"><span class="cls_028">/* switch to running cached, if so linked */</span></div>
<div style="position:absolute;left:77.40px;top:417.00px" class="cls_028"><span class="cls_028">la t0,1f</span></div>
<div style="position:absolute;left:77.40px;top:427.00px" class="cls_028"><span class="cls_028">jr t0</span></div>
<div style="position:absolute;left:72.00px;top:437.00px" class="cls_028"><span class="cls_028">1:</span></div>
<div style="position:absolute;left:48.02px;top:456.67px" class="cls_006"><span class="cls_006">Even running cached from EPROM will not give optimal performance,</span></div>
<div style="position:absolute;left:36.00px;top:467.67px" class="cls_006"><span class="cls_006">since cache refill cycles from EPROM will be slower than from RAM. A</span></div>
<div style="position:absolute;left:36.00px;top:478.67px" class="cls_006"><span class="cls_006">higher performance option is to link the code to run in RAM, and arrange</span></div>
<div style="position:absolute;left:36.00px;top:489.67px" class="cls_006"><span class="cls_006">for the start-up code to copy itself and the rest of the software from ROM</span></div>
<div style="position:absolute;left:36.00px;top:500.67px" class="cls_006"><span class="cls_006">to RAM. This is also useful when debugging the ROM, since it is not</span></div>
<div style="position:absolute;left:36.00px;top:511.67px" class="cls_006"><span class="cls_006">possible to set breakpoints or single-step code which is in ROM. Note,</span></div>
<div style="position:absolute;left:36.00px;top:522.67px" class="cls_006"><span class="cls_006">however, that this requires even more careful programming of the start-up</span></div>
<div style="position:absolute;left:36.00px;top:533.67px" class="cls_006"><span class="cls_006">code. Even jumps cannot be used until the code has been moved: only pc-</span></div>
<div style="position:absolute;left:36.00px;top:544.67px" class="cls_006"><span class="cls_006">relative branches are safe, and the bal instruction should be used in place</span></div>
<div style="position:absolute;left:36.00px;top:555.67px" class="cls_006"><span class="cls_006">of jal (though beware its limited +-128Kb range). Any attempt to access</span></div>
<div style="position:absolute;left:36.01px;top:566.67px" class="cls_006"><span class="cls_006">data or take the address of a function must be relocated by explicitly</span></div>
<div style="position:absolute;left:36.01px;top:577.67px" class="cls_006"><span class="cls_006">adding in the offset between the code in RAM and its temporary location in</span></div>
<div style="position:absolute;left:36.01px;top:588.67px" class="cls_006"><span class="cls_006">EPROM. It is sensible to calculate this offset just once, and keep it in a</span></div>
<div style="position:absolute;left:36.01px;top:599.67px" class="cls_006"><span class="cls_006">reserved register, such as</span><span class="cls_008"> $k1</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:48.03px;top:610.67px" class="cls_006"><span class="cls_006">Another complication is initialized data. Initialized data can be declared</span></div>
<div style="position:absolute;left:36.01px;top:621.67px" class="cls_006"><span class="cls_006">in assembler or C, e.g.</span></div>
<div style="position:absolute;left:108.00px;top:643.00px" class="cls_028"><span class="cls_028">.data</span></div>
<div style="position:absolute;left:72.00px;top:653.00px" class="cls_028"><span class="cls_028">base:</span></div>
<div style="position:absolute;left:108.11px;top:653.00px" class="cls_028"><span class="cls_028">.word</span></div>
<div style="position:absolute;left:144.22px;top:653.00px" class="cls_028"><span class="cls_028">10</span></div>
<div style="position:absolute;left:48.02px;top:672.67px" class="cls_006"><span class="cls_006">or</span></div>
<div style="position:absolute;left:72.00px;top:695.00px" class="cls_028"><span class="cls_028">int base = 10;</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">15-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:159598px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE DESIGN EXAMPLES</span></div>
<div style="position:absolute;left:520.54px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 15</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">The initialized data is writable, and so must be in RAM. But how does it</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">get there?</span></div>
<div style="position:absolute;left:232.19px;top:72.67px" class="cls_006"><span class="cls_006">Some cross-development toolchains are not very helpful, and require</span></div>
<div style="position:absolute;left:216.00px;top:83.67px" class="cls_006"><span class="cls_006">that all data must be either uninitialized, or if initialized then read-only.</span></div>
<div style="position:absolute;left:216.00px;top:94.67px" class="cls_006"><span class="cls_006">Other  toolchains  provide  various  different  mechanisms  by  which  to</span></div>
<div style="position:absolute;left:216.00px;top:105.67px" class="cls_006"><span class="cls_006">initialize this data. SDE-MIPS, for example, takes the straight-forward</span></div>
<div style="position:absolute;left:216.00px;top:116.67px" class="cls_006"><span class="cls_006">step, when generating a ROM image, of placing a copy of the initialized</span></div>
<div style="position:absolute;left:216.00px;top:127.67px" class="cls_006"><span class="cls_006">data segment (i.e. </span><span class="cls_008">.data</span><span class="cls_006">) at the next 16-byte boundary after the code. It is</span></div>
<div style="position:absolute;left:216.00px;top:138.67px" class="cls_006"><span class="cls_006">then easy to copy this from ROM to its final in RAM.</span></div>
<div style="position:absolute;left:228.02px;top:149.67px" class="cls_006"><span class="cls_006">The  following  code  fragment  illustrates  a  flexible  mechanism  for</span></div>
<div style="position:absolute;left:216.00px;top:160.67px" class="cls_006"><span class="cls_006">handling these different possibilities for moving code and data to RAM.</span></div>
<div style="position:absolute;left:252.00px;top:182.00px" class="cls_028"><span class="cls_028">_reset_vec:</span></div>
<div style="position:absolute;left:257.40px;top:192.00px" class="cls_028"><span class="cls_028">b _reset</span></div>
<div style="position:absolute;left:252.00px;top:222.00px" class="cls_028"><span class="cls_028">_reset:</span></div>
<div style="position:absolute;left:257.40px;top:231.99px" class="cls_028"><span class="cls_028">move k1,zero</span></div>
<div style="position:absolute;left:360.33px;top:231.99px" class="cls_028"><span class="cls_028"># assume no relocation</span></div>
<div style="position:absolute;left:257.40px;top:241.99px" class="cls_028"><span class="cls_028">bal 1f</span></div>
<div style="position:absolute;left:360.19px;top:241.99px" class="cls_028"><span class="cls_028"># ra := current pc</span></div>
<div style="position:absolute;left:252.00px;top:251.99px" class="cls_028"><span class="cls_028">1: la t0,1b</span></div>
<div style="position:absolute;left:360.28px;top:251.99px" class="cls_028"><span class="cls_028"># t8 := linked pc</span></div>
<div style="position:absolute;left:257.40px;top:261.99px" class="cls_028"><span class="cls_028">beq t0,ra,2f</span></div>
<div style="position:absolute;left:360.33px;top:261.99px" class="cls_028"><span class="cls_028"># when they match, then no reloc is</span></div>
<div style="position:absolute;left:360.00px;top:271.99px" class="cls_028"><span class="cls_028"># correct</span></div>
<div style="position:absolute;left:257.40px;top:291.99px" class="cls_028"><span class="cls_028">/* executing at other than the linked address */</span></div>
<div style="position:absolute;left:257.40px;top:301.99px" class="cls_028"><span class="cls_028">li k1,0xbfc00000</span></div>
<div style="position:absolute;left:360.42px;top:301.99px" class="cls_028"><span class="cls_028"># k1 := actual EPROM base</span></div>
<div style="position:absolute;left:257.40px;top:311.99px" class="cls_028"><span class="cls_028">la t0,_reset_vec</span></div>
<div style="position:absolute;left:360.42px;top:311.99px" class="cls_028"><span class="cls_028"># t8 := linked EPROM base (may be RAM)</span></div>
<div style="position:absolute;left:257.40px;top:321.99px" class="cls_028"><span class="cls_028">subu k1,t0</span></div>
<div style="position:absolute;left:360.28px;top:321.99px" class="cls_028"><span class="cls_028"># k1 := reloc factor (actual - linked)</span></div>
<div style="position:absolute;left:252.00px;top:331.98px" class="cls_028"><span class="cls_028">2:</span></div>
<div style="position:absolute;left:257.40px;top:351.98px" class="cls_028"><span class="cls_028">/* initialize CPU, RAM, caches, tlb & stack</span></div>
<div style="position:absolute;left:288.00px;top:361.98px" class="cls_028"><span class="cls_028">(hardware specific) */</span></div>
<div style="position:absolute;left:257.40px;top:391.98px" class="cls_028"><span class="cls_028">/* skip code move if it is linked for ROM */</span></div>
<div style="position:absolute;left:257.40px;top:401.98px" class="cls_028"><span class="cls_028">and t0,k1,~0x20000000 # ignore simple KSEG1->KSEG0 reloc</span></div>
<div style="position:absolute;left:257.40px;top:411.98px" class="cls_028"><span class="cls_028">beqz t0,3f</span></div>
<div style="position:absolute;left:257.40px;top:431.98px" class="cls_028"><span class="cls_028">/* copy code to linked address in RAM */</span></div>
<div style="position:absolute;left:257.40px;top:441.97px" class="cls_028"><span class="cls_028">la a0,_ftext</span></div>
<div style="position:absolute;left:360.33px;top:441.97px" class="cls_028"><span class="cls_028"># a0 := destination (RAM) address</span></div>
<div style="position:absolute;left:257.40px;top:451.97px" class="cls_028"><span class="cls_028">addu a1,a0,k1</span></div>
<div style="position:absolute;left:360.35px;top:451.97px" class="cls_028"><span class="cls_028"># a1 := source (ROM) address</span></div>
<div style="position:absolute;left:257.40px;top:461.97px" class="cls_028"><span class="cls_028">la a2,etext</span></div>
<div style="position:absolute;left:360.30px;top:461.97px" class="cls_028"><span class="cls_028"># a2 := code size (etext - _ftext)</span></div>
<div style="position:absolute;left:257.40px;top:471.97px" class="cls_028"><span class="cls_028">subu a2,a0</span></div>
<div style="position:absolute;left:257.40px;top:481.97px" class="cls_028"><span class="cls_028">bal memcpy</span></div>
<div style="position:absolute;left:252.00px;top:501.97px" class="cls_028"><span class="cls_028">3:</span></div>
<div style="position:absolute;left:257.40px;top:511.97px" class="cls_028"><span class="cls_028">/* copy initialized data to RAM (SDE-MIPS specific) */</span></div>
<div style="position:absolute;left:257.40px;top:521.97px" class="cls_028"><span class="cls_028">la a0,_fdata</span></div>
<div style="position:absolute;left:360.33px;top:521.97px" class="cls_028"><span class="cls_028"># a0 := destination (RAM) address</span></div>
<div style="position:absolute;left:257.40px;top:531.97px" class="cls_028"><span class="cls_028">la a1,etext</span></div>
<div style="position:absolute;left:360.28px;top:531.97px" class="cls_028"><span class="cls_028"># a1 := source address (after ROM code)</span></div>
<div style="position:absolute;left:257.40px;top:541.96px" class="cls_028"><span class="cls_028">addu a1,k1</span></div>
<div style="position:absolute;left:257.40px;top:551.96px" class="cls_028"><span class="cls_028">addu a1,15</span></div>
<div style="position:absolute;left:360.28px;top:551.96px" class="cls_028"><span class="cls_028"># round address up to 16-byte boundary</span></div>
<div style="position:absolute;left:257.40px;top:561.96px" class="cls_028"><span class="cls_028">and a1,~15</span></div>
<div style="position:absolute;left:257.40px;top:571.96px" class="cls_028"><span class="cls_028">la a2,edata</span></div>
<div style="position:absolute;left:360.30px;top:571.96px" class="cls_028"><span class="cls_028"># a2 := data size (edata - _fdata)</span></div>
<div style="position:absolute;left:257.40px;top:581.96px" class="cls_028"><span class="cls_028">subu a2,a0</span></div>
<div style="position:absolute;left:257.40px;top:591.96px" class="cls_028"><span class="cls_028">bal memcpy</span></div>
<div style="position:absolute;left:252.00px;top:611.96px" class="cls_028"><span class="cls_028">/* jump to C start-up at linked address */</span></div>
<div style="position:absolute;left:257.40px;top:621.96px" class="cls_028"><span class="cls_028">la t0,_start</span></div>
<div style="position:absolute;left:257.40px;top:631.96px" class="cls_028"><span class="cls_028">j t0</span></div>
<div style="position:absolute;left:216.00px;top:663.00px" class="cls_015"><span class="cls_015">Embedded system library functions</span></div>
<div style="position:absolute;left:228.02px;top:676.67px" class="cls_006"><span class="cls_006">Embedded system software written in C or C++ will still need access to</span></div>
<div style="position:absolute;left:216.00px;top:687.67px" class="cls_006"><span class="cls_006">the MIPS Coprocessor 0 registers and instructions in order to control</span></div>
<div style="position:absolute;left:216.00px;top:698.67px" class="cls_006"><span class="cls_006">interrupts, catch exceptions, handle the caches and TLB, and so on. Some</span></div>
<div style="position:absolute;left:216.00px;top:709.67px" class="cls_006"><span class="cls_006">cross-compiler vendors will supply a toolkit of low-level library routines to</span></div>
<div style="position:absolute;left:216.00px;top:720.67px" class="cls_006"><span class="cls_006">do this, and sometimes it will include full source code. At a minimum such</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">15-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:160400px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 15</span></div>
<div style="position:absolute;left:421.27px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE DESIGN EXAMPLES</span></div>
<div style="position:absolute;left:36.00px;top:50.67px" class="cls_006"><span class="cls_006">a kit should include assembler functions which read and write each CPU</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_006"><span class="cls_006">control register, initialize and update the TLB (if present), and initialize and</span></div>
<div style="position:absolute;left:36.00px;top:72.67px" class="cls_006"><span class="cls_006">invalidate all or part of the caches. Unfortunately there are no standard</span></div>
<div style="position:absolute;left:36.00px;top:83.67px" class="cls_006"><span class="cls_006">interfaces for these functions, and the programmer will have to read the</span></div>
<div style="position:absolute;left:36.00px;top:94.67px" class="cls_006"><span class="cls_006">cross-development system’s documentation. The examples in this manual</span></div>
<div style="position:absolute;left:36.00px;top:105.67px" class="cls_006"><span class="cls_006">could serve as a baseline reference for programmers which choose to</span></div>
<div style="position:absolute;left:36.00px;top:116.67px" class="cls_006"><span class="cls_006">generate these functions themselves.†</span></div>
<div style="position:absolute;left:36.00px;top:137.67px" class="cls_006"><span class="cls_006">Trap and interrupt handling</span></div>
<div style="position:absolute;left:48.02px;top:148.67px" class="cls_006"><span class="cls_006">Beyond routines to manipulate the CPU control registers and caches,</span></div>
<div style="position:absolute;left:36.00px;top:159.67px" class="cls_006"><span class="cls_006">the system software may need a mechanism by which to catch machine</span></div>
<div style="position:absolute;left:36.00px;top:170.67px" class="cls_006"><span class="cls_006">exceptions</span></div>
<div style="position:absolute;left:95.19px;top:170.67px" class="cls_006"><span class="cls_006">(the  generic  name  for  traps  and  interrupts),  and  cause</span></div>
<div style="position:absolute;left:36.00px;top:181.67px" class="cls_006"><span class="cls_006">appropriate C handler functions to be called.  Vendor-supplied embedded</span></div>
<div style="position:absolute;left:36.00px;top:192.67px" class="cls_006"><span class="cls_006">system toolkits probably contain some code to help with this, although this</span></div>
<div style="position:absolute;left:36.00px;top:203.67px" class="cls_006"><span class="cls_006">is often at the very low level, and require more work to interface to C-level</span></div>
<div style="position:absolute;left:36.00px;top:214.67px" class="cls_006"><span class="cls_006">functions.   SDE-MIPS   includes   some   relatively   high-level   exception</span></div>
<div style="position:absolute;left:36.00px;top:225.67px" class="cls_006"><span class="cls_006">handling code that allows the programmer to route different exceptions to</span></div>
<div style="position:absolute;left:36.00px;top:236.67px" class="cls_006"><span class="cls_006">different C functions, and pass them a pointer to a structure which</span></div>
<div style="position:absolute;left:36.00px;top:247.67px" class="cls_006"><span class="cls_006">contains the complete CPU context at the time of the exception.</span></div>
<div style="position:absolute;left:48.02px;top:258.67px" class="cls_006"><span class="cls_006">Choices about stacks</span></div>
<div style="position:absolute;left:48.02px;top:269.67px" class="cls_006"><span class="cls_006">An exception handler has several choices regarding its use of stacks:</span></div>
<div style="position:absolute;left:59.97px;top:283.67px" class="cls_006"><span class="cls_006">1)</span></div>
<div style="position:absolute;left:84.02px;top:283.67px" class="cls_006"><span class="cls_006">Remain on the current stack, shared with the main, or current</span></div>
<div style="position:absolute;left:84.02px;top:294.67px" class="cls_006"><span class="cls_006">application. This is usually adequate for simple, single-threaded</span></div>
<div style="position:absolute;left:84.02px;top:305.67px" class="cls_006"><span class="cls_006">applications.</span></div>
<div style="position:absolute;left:59.97px;top:319.67px" class="cls_006"><span class="cls_006">2)</span></div>
<div style="position:absolute;left:84.02px;top:319.67px" class="cls_006"><span class="cls_006">Have an exception stack, which it switches to upon receiving an</span></div>
<div style="position:absolute;left:84.02px;top:330.67px" class="cls_006"><span class="cls_006">exception  when  not  already  at  exception  level.  This  avoids</span></div>
<div style="position:absolute;left:84.02px;top:341.67px" class="cls_006"><span class="cls_006">overrunning an application’s stack, if it is small, and avoids</span></div>
<div style="position:absolute;left:84.02px;top:352.67px" class="cls_006"><span class="cls_006">problems if the exception was caused by a bad value stack</span></div>
<div style="position:absolute;left:84.02px;top:363.67px" class="cls_006"><span class="cls_006">pointer value.</span></div>
<div style="position:absolute;left:59.97px;top:377.67px" class="cls_006"><span class="cls_006">3)</span></div>
<div style="position:absolute;left:84.02px;top:377.67px" class="cls_006"><span class="cls_006">Have  several  exception  stacks,  one  per</span></div>
<div style="position:absolute;left:302.50px;top:377.67px" class="cls_006"><span class="cls_006">‘‘process’’.  This  is</span></div>
<div style="position:absolute;left:84.02px;top:388.67px" class="cls_006"><span class="cls_006">essential in multi-processing applications.</span></div>
<div style="position:absolute;left:36.00px;top:409.67px" class="cls_006"><span class="cls_006">Simple interrupt routines</span></div>
<div style="position:absolute;left:48.02px;top:420.67px" class="cls_006"><span class="cls_006">If any of the CPU’s six interrupt pins or two software interrupt bits are</span></div>
<div style="position:absolute;left:36.00px;top:431.67px" class="cls_006"><span class="cls_006">active, and not masked by the CPU’s </span><span class="cls_008">Status</span><span class="cls_006"> register, the CPU takes an</span></div>
<div style="position:absolute;left:36.00px;top:442.67px" class="cls_006"><span class="cls_006">immediate Interrupt exception. Once the generic exception handler has</span></div>
<div style="position:absolute;left:36.00px;top:453.67px" class="cls_006"><span class="cls_006">routed the exception to the specific Interrupt exception function, it is the</span></div>
<div style="position:absolute;left:36.00px;top:464.67px" class="cls_006"><span class="cls_006">this function’s responsibility to sort the interrupts into priority order and</span></div>
<div style="position:absolute;left:36.00px;top:475.67px" class="cls_006"><span class="cls_006">dispatch to the correct device’s interrupt handler. The simplest technique</span></div>
<div style="position:absolute;left:36.00px;top:486.67px" class="cls_006"><span class="cls_006">is to make interrupt priorities correspond directly to interrupt pin number,</span></div>
<div style="position:absolute;left:36.00px;top:497.67px" class="cls_006"><span class="cls_006">allowing a simple bit-scan of the </span><span class="cls_008">Cause</span><span class="cls_006"> register.</span></div>
<div style="position:absolute;left:48.02px;top:508.67px" class="cls_006"><span class="cls_006">A very simple, fixed-priority interrupt handler might look something like</span></div>
<div style="position:absolute;left:36.00px;top:519.67px" class="cls_006"><span class="cls_006">this:</span></div>
<div style="position:absolute;left:72.00px;top:541.00px" class="cls_028"><span class="cls_028">extern void softclock(), softnet();</span></div>
<div style="position:absolute;left:72.00px;top:551.00px" class="cls_028"><span class="cls_028">extern void diskintr();</span></div>
<div style="position:absolute;left:72.00px;top:561.00px" class="cls_028"><span class="cls_028">extern void netintr();</span></div>
<div style="position:absolute;left:72.00px;top:571.00px" class="cls_028"><span class="cls_028">extern void ttyintr();</span></div>
<div style="position:absolute;left:72.00px;top:580.99px" class="cls_028"><span class="cls_028">extern void fpuintr();</span></div>
<div style="position:absolute;left:72.00px;top:590.99px" class="cls_028"><span class="cls_028">extern void clkintr();</span></div>
<div style="position:absolute;left:72.00px;top:600.99px" class="cls_028"><span class="cls_028">extern void dbgintr();</span></div>
<div style="position:absolute;left:72.00px;top:620.99px" class="cls_028"><span class="cls_028">/* interrupt handler table */</span></div>
<div style="position:absolute;left:72.00px;top:630.99px" class="cls_028"><span class="cls_028">void (*intrhand())[8] = {</span></div>
<div style="position:absolute;left:77.40px;top:640.99px" class="cls_028"><span class="cls_028">softclock,</span></div>
<div style="position:absolute;left:216.25px;top:640.99px" class="cls_028"><span class="cls_028">/* [0] SInt0: clock */</span></div>
<div style="position:absolute;left:77.40px;top:650.99px" class="cls_028"><span class="cls_028">softnet,</span></div>
<div style="position:absolute;left:216.23px;top:650.99px" class="cls_028"><span class="cls_028">/* [1] SInt1: network */</span></div>
<div style="position:absolute;left:77.40px;top:660.99px" class="cls_028"><span class="cls_028">diskintr,</span></div>
<div style="position:absolute;left:216.23px;top:660.99px" class="cls_028"><span class="cls_028">/* [2] Intr0: disk controller */</span></div>
<div style="position:absolute;left:77.40px;top:670.99px" class="cls_028"><span class="cls_028">netintr,</span></div>
<div style="position:absolute;left:216.23px;top:670.99px" class="cls_028"><span class="cls_028">/* [3] Intr1: network interface */</span></div>
<div style="position:absolute;left:54.00px;top:698.67px" class="cls_006"><span class="cls_006">† Alternately, the programmer could obtain IDT/sim and/or IDT/</span></div>
<div style="position:absolute;left:54.00px;top:710.67px" class="cls_006"><span class="cls_006">kit from IDT, or a similar product from other 3rd party tools</span></div>
<div style="position:absolute;left:54.00px;top:722.67px" class="cls_006"><span class="cls_006">vendors.</span></div>
<div style="position:absolute;left:289.79px;top:755.34px" class="cls_002"><span class="cls_002">15-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:161202px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE DESIGN EXAMPLES</span></div>
<div style="position:absolute;left:520.54px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 15</span></div>
<div style="position:absolute;left:257.40px;top:51.00px" class="cls_028"><span class="cls_028">ttyintr,</span></div>
<div style="position:absolute;left:396.23px;top:51.00px" class="cls_028"><span class="cls_028">/* [4] Intr2: uart */</span></div>
<div style="position:absolute;left:257.40px;top:61.00px" class="cls_028"><span class="cls_028">fpuintr,</span></div>
<div style="position:absolute;left:396.23px;top:61.00px" class="cls_028"><span class="cls_028">/* [5] Intr3: fpu interrupt */</span></div>
<div style="position:absolute;left:257.40px;top:71.00px" class="cls_028"><span class="cls_028">clkintr,</span></div>
<div style="position:absolute;left:396.23px;top:71.00px" class="cls_028"><span class="cls_028">/* [6] Intr4: timer interrupt */</span></div>
<div style="position:absolute;left:257.40px;top:81.00px" class="cls_028"><span class="cls_028">dbgintr</span></div>
<div style="position:absolute;left:396.21px;top:81.00px" class="cls_028"><span class="cls_028">/* [7] Intr5: bus errors, debug</span></div>
<div style="position:absolute;left:252.00px;top:91.00px" class="cls_028"><span class="cls_028">button, etc. */</span></div>
<div style="position:absolute;left:252.00px;top:101.00px" class="cls_028"><span class="cls_028">};</span></div>
<div style="position:absolute;left:252.00px;top:171.00px" class="cls_028"><span class="cls_028">/*</span></div>
<div style="position:absolute;left:257.40px;top:181.00px" class="cls_028"><span class="cls_028">* Interrupt exception handler.</span></div>
<div style="position:absolute;left:257.40px;top:190.99px" class="cls_028"><span class="cls_028">* 1) The xcp argument points to a structure which maps to</span></div>
<div style="position:absolute;left:257.40px;top:200.99px" class="cls_028"><span class="cls_028">*</span></div>
<div style="position:absolute;left:284.41px;top:200.99px" class="cls_028"><span class="cls_028">the stack frame in which the CPU context (i.e. all</span></div>
<div style="position:absolute;left:257.40px;top:210.99px" class="cls_028"><span class="cls_028">*</span></div>
<div style="position:absolute;left:284.41px;top:210.99px" class="cls_028"><span class="cls_028">registers) are saved.</span></div>
<div style="position:absolute;left:257.40px;top:220.99px" class="cls_028"><span class="cls_028">* 2) On entry all interrupts are masked (disabled).</span></div>
<div style="position:absolute;left:257.40px;top:230.99px" class="cls_028"><span class="cls_028">* 3) It calls the mips_setsr() function to modify the CPU</span></div>
<div style="position:absolute;left:257.40px;top:240.99px" class="cls_028"><span class="cls_028">*</span></div>
<div style="position:absolute;left:284.41px;top:240.99px" class="cls_028"><span class="cls_028">Status register.</span></div>
<div style="position:absolute;left:257.40px;top:250.99px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:252.00px;top:270.99px" class="cls_028"><span class="cls_028">interrupt (struct xcption *xcp)</span></div>
<div style="position:absolute;left:252.00px;top:280.99px" class="cls_028"><span class="cls_028">{</span></div>
<div style="position:absolute;left:288.00px;top:290.98px" class="cls_028"><span class="cls_028">unsigned int pend, intrno;</span></div>
<div style="position:absolute;left:288.02px;top:310.98px" class="cls_028"><span class="cls_028">/* find all pending, unmasked interrupts */</span></div>
<div style="position:absolute;left:288.02px;top:320.98px" class="cls_028"><span class="cls_028">pend = xcp->cause & xcp->status & SR_IMASK;</span></div>
<div style="position:absolute;left:288.02px;top:340.98px" class="cls_028"><span class="cls_028">/* dispatch each pending interrupt, starting with</span></div>
<div style="position:absolute;left:293.40px;top:350.98px" class="cls_028"><span class="cls_028">* highest */</span></div>
<div style="position:absolute;left:288.02px;top:360.98px" class="cls_028"><span class="cls_028">for (intrno = 7; (pend & SR_IMASK) != 0;</span></div>
<div style="position:absolute;left:453.70px;top:370.98px" class="cls_028"><span class="cls_028">pend &lt;&lt;= 1, intrno--) {</span></div>
<div style="position:absolute;left:324.02px;top:380.98px" class="cls_028"><span class="cls_028">if (pend & SR_IBIT7) {</span></div>
<div style="position:absolute;left:360.02px;top:390.98px" class="cls_028"><span class="cls_028">/* enable only interrupts of higher priority</span></div>
<div style="position:absolute;left:365.38px;top:400.97px" class="cls_028"><span class="cls_028">* than this one. */</span></div>
<div style="position:absolute;left:360.00px;top:410.97px" class="cls_028"><span class="cls_028">unsigned int imask = SR_IMASK &lt;&lt;(intrno + 1)</span></div>
<div style="position:absolute;left:360.00px;top:420.97px" class="cls_028"><span class="cls_028">mips_setsr (imask | SR_IEC);</span></div>
<div style="position:absolute;left:360.00px;top:440.97px" class="cls_028"><span class="cls_028">/* call interrupt handler */</span></div>
<div style="position:absolute;left:360.00px;top:450.97px" class="cls_028"><span class="cls_028">*intrhand[intrno]) (xcp);</span></div>
<div style="position:absolute;left:324.02px;top:460.97px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:288.00px;top:470.97px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:288.00px;top:490.96px" class="cls_028"><span class="cls_028">/* disable all interrupts */</span></div>
<div style="position:absolute;left:293.38px;top:500.96px" class="cls_028"><span class="cls_028">mips_setsr (0);</span></div>
<div style="position:absolute;left:251.98px;top:510.96px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:216.00px;top:540.67px" class="cls_006"><span class="cls_006">Floating-point traps and interrupts</span></div>
<div style="position:absolute;left:228.02px;top:551.67px" class="cls_006"><span class="cls_006">The previous section shows how to recognize a floating point interrupt.</span></div>
<div style="position:absolute;left:216.00px;top:562.67px" class="cls_006"><span class="cls_006">Following the interrupt the </span><span class="cls_008">EPC</span><span class="cls_006"> will either point at the FP instruction or (if</span></div>
<div style="position:absolute;left:216.00px;top:573.67px" class="cls_006"><span class="cls_006">the FP instruction is in a branch delay slot) at the immediately preceding</span></div>
<div style="position:absolute;left:216.00px;top:584.67px" class="cls_006"><span class="cls_006">branch.</span></div>
<div style="position:absolute;left:228.02px;top:595.67px" class="cls_006"><span class="cls_006">To find out what happened, look first at the CPU </span><span class="cls_008">Cause</span><span class="cls_006"> register. If it</span></div>
<div style="position:absolute;left:215.99px;top:606.67px" class="cls_006"><span class="cls_006">shows a ‘‘co-processor unusable’’ condition, then the FPA instruction set</span></div>
<div style="position:absolute;left:215.99px;top:617.67px" class="cls_006"><span class="cls_006">is not enabled. If it shows an interrupt at the FPA’s level, the handler can</span></div>
<div style="position:absolute;left:215.99px;top:628.67px" class="cls_006"><span class="cls_006">get further details of exactly what has gone wrong by consulting the</span></div>
<div style="position:absolute;left:215.99px;top:639.67px" class="cls_006"><span class="cls_006">floating point status register. However, there are only three cases of</span></div>
<div style="position:absolute;left:215.99px;top:650.67px" class="cls_006"><span class="cls_006">interest:</span></div>
<div style="position:absolute;left:228.01px;top:664.67px" class="cls_006"><span class="cls_006">• The FPA is disabled (CU1 == 0 in the CPU status register). If the CPU</span></div>
<div style="position:absolute;left:239.96px;top:675.67px" class="cls_006"><span class="cls_006">does not have an FPA, the software might want to emulate the</span></div>
<div style="position:absolute;left:239.96px;top:686.67px" class="cls_006"><span class="cls_006">instruction. If the FPA is available, the system might have been doing</span></div>
<div style="position:absolute;left:239.96px;top:697.67px" class="cls_006"><span class="cls_006">an “enable-on-demand”†. If so enable it and return to retry the</span></div>
<div style="position:absolute;left:239.96px;top:708.67px" class="cls_006"><span class="cls_006">instruction.</span></div>
<div style="position:absolute;left:303.54px;top:755.34px" class="cls_002"><span class="cls_002">15-9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:162004px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 15</span></div>
<div style="position:absolute;left:421.27px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE DESIGN EXAMPLES</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">• The chip includes an FPA, and it’s enabled, and the </span><span class="cls_008">FCR31</span><span class="cls_006"> UnImp bit</span></div>
<div style="position:absolute;left:59.97px;top:61.67px" class="cls_006"><span class="cls_006">is  set.  The  FPA  has  interrupted  because  it  can’t  perform  this</span></div>
<div style="position:absolute;left:59.97px;top:72.67px" class="cls_006"><span class="cls_006">particular operation, with these particular operands. The normal</span></div>
<div style="position:absolute;left:59.97px;top:83.67px" class="cls_006"><span class="cls_006">approach is to emulate the instruction - though in this case software</span></div>
<div style="position:absolute;left:59.97px;top:94.67px" class="cls_006"><span class="cls_006">will want to put the result back in the real FP registers.</span></div>
<div style="position:absolute;left:59.97px;top:108.67px" class="cls_006"><span class="cls_006">In theory there are a rather restricted range of operations and</span></div>
<div style="position:absolute;left:59.97px;top:119.67px" class="cls_006"><span class="cls_006">operands which cause this condition: underflows, operations which</span></div>
<div style="position:absolute;left:59.97px;top:130.67px" class="cls_006"><span class="cls_006">should produce the ‘‘illegal’’ NaN value, denormalised operands, NaN</span></div>
<div style="position:absolute;left:59.97px;top:141.67px" class="cls_006"><span class="cls_006">operands, and infinite operands.</span></div>
<div style="position:absolute;left:59.97px;top:155.67px" class="cls_006"><span class="cls_006">The system could put in special case code to handle just these</span></div>
<div style="position:absolute;left:59.97px;top:166.67px" class="cls_006"><span class="cls_006">conditions. But it is very hard to get assurances about exactly when</span></div>
<div style="position:absolute;left:59.97px;top:177.67px" class="cls_006"><span class="cls_006">the FPA may refuse an operation.</span></div>
<div style="position:absolute;left:48.02px;top:191.67px" class="cls_006"><span class="cls_006">• The system has an enabled FPA, and the FP status register UnImp bit</span></div>
<div style="position:absolute;left:59.97px;top:202.67px" class="cls_006"><span class="cls_006">is clear. It looks as if the FPA operation has produced an IEEE-</span></div>
<div style="position:absolute;left:59.97px;top:213.67px" class="cls_006"><span class="cls_006">exception. Software may need to report this to the application, in</span></div>
<div style="position:absolute;left:59.97px;top:224.67px" class="cls_006"><span class="cls_006">some OS-dependent manner.</span></div>
<div style="position:absolute;left:35.99px;top:245.67px" class="cls_006"><span class="cls_006">Emulating floating point instructions</span></div>
<div style="position:absolute;left:48.01px;top:259.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Locate the instruction</span><span class="cls_006">: it will either be at EPC (when the CPU status</span></div>
<div style="position:absolute;left:59.96px;top:270.67px" class="cls_006"><span class="cls_006">register, </span><span class="cls_008">SR</span><span class="cls_006"> bit BD, is clear); or when BD is set, indicating that the</span></div>
<div style="position:absolute;left:59.96px;top:281.67px" class="cls_006"><span class="cls_006">exception happened in a branch delay slot, the FP instruction will be</span></div>
<div style="position:absolute;left:59.96px;top:292.67px" class="cls_006"><span class="cls_006">at EPC+4.</span></div>
<div style="position:absolute;left:48.01px;top:306.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Decode the instruction</span><span class="cls_006">: The encoding of FP arithmetic instructions is</span></div>
<div style="position:absolute;left:59.96px;top:317.67px" class="cls_006"><span class="cls_006">very regular.</span></div>
<div style="position:absolute;left:48.01px;top:331.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Fetch the operands</span><span class="cls_006">: the instruction encoding tells which FP registers</span></div>
<div style="position:absolute;left:59.96px;top:342.67px" class="cls_006"><span class="cls_006">hold the operand(s).</span></div>
<div style="position:absolute;left:48.01px;top:356.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Call the emulator</span><span class="cls_006">: to perform the actual operation.</span></div>
<div style="position:absolute;left:48.01px;top:370.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Check for exceptions</span><span class="cls_006">: if there are any enabled IEEE exceptions. If the</span></div>
<div style="position:absolute;left:59.96px;top:381.67px" class="cls_006"><span class="cls_006">system architect knows that IEEE exceptions can’t usefully happen</span></div>
<div style="position:absolute;left:59.96px;top:392.67px" class="cls_006"><span class="cls_006">(perhaps because there is no mechanism in place for applications to</span></div>
<div style="position:absolute;left:59.96px;top:403.67px" class="cls_006"><span class="cls_006">catch them), skip this stage.</span></div>
<div style="position:absolute;left:48.01px;top:417.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Patch the result</span><span class="cls_006">: back into the appropriate FP destination register.</span></div>
<div style="position:absolute;left:48.01px;top:431.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Hop over the emulated instruction</span><span class="cls_006">: if BD was clear, just restart at</span></div>
<div style="position:absolute;left:59.96px;top:442.67px" class="cls_006"><span class="cls_006">EPC+4.</span></div>
<div style="position:absolute;left:59.96px;top:456.67px" class="cls_006"><span class="cls_006">But if BD was set the program is going to have to decode and emulate</span></div>
<div style="position:absolute;left:59.96px;top:467.67px" class="cls_006"><span class="cls_006">the branch instruction (at EPC) too, and restart at the branch target</span></div>
<div style="position:absolute;left:59.96px;top:478.67px" class="cls_006"><span class="cls_006">location.</span></div>
<div style="position:absolute;left:36.00px;top:501.00px" class="cls_015"><span class="cls_015">Debugging</span></div>
<div style="position:absolute;left:48.02px;top:514.67px" class="cls_006"><span class="cls_006">Once the developer leaves behind the relative safety of a PROM monitor</span></div>
<div style="position:absolute;left:36.00px;top:525.67px" class="cls_006"><span class="cls_006">and its debug support to develop the system PROM, finding out why the</span></div>
<div style="position:absolute;left:36.00px;top:536.67px" class="cls_006"><span class="cls_006">code is not working correctly may become much more tedious.</span></div>
<div style="position:absolute;left:48.02px;top:547.67px" class="cls_006"><span class="cls_006">At the worst, the programmer will have to use judicious calls to </span><span class="cls_029">printf</span><span class="cls_006">,</span></div>
<div style="position:absolute;left:36.00px;top:558.67px" class="cls_006"><span class="cls_006">link the program in KSEG1 (i.e. uncached) and monitor CPU addresses</span></div>
<div style="position:absolute;left:36.00px;top:569.67px" class="cls_006"><span class="cls_006">with a logic analyzer. Armed with a list of function addresses (e.g. the</span></div>
<div style="position:absolute;left:36.00px;top:580.67px" class="cls_006"><span class="cls_006">output of the </span><span class="cls_008">nm</span><span class="cls_006"> utility), and possibly a detailed disassembler listing for</span></div>
<div style="position:absolute;left:36.01px;top:591.67px" class="cls_006"><span class="cls_006">the suspect function, it is often possible to deduce the bug. It is seldom</span></div>
<div style="position:absolute;left:36.01px;top:602.67px" class="cls_006"><span class="cls_006">necessary to capture data values, although a few bits or a byte can be</span></div>
<div style="position:absolute;left:36.01px;top:613.67px" class="cls_006"><span class="cls_006">useful if the analyzer has enough probes.</span></div>
<div style="position:absolute;left:48.03px;top:624.67px" class="cls_006"><span class="cls_006">Some vendors offer R30xx disassemblers and special pods for an</span></div>
<div style="position:absolute;left:36.01px;top:635.67px" class="cls_006"><span class="cls_006">analyzer to trace both instruction and data accesses.</span></div>
<div style="position:absolute;left:48.03px;top:646.67px" class="cls_006"><span class="cls_006">Another  technique  is  to  include  support  for  remote  source-level</span></div>
<div style="position:absolute;left:36.01px;top:657.67px" class="cls_006"><span class="cls_006">debugging in the new PROM. The use of a ROM emulator device may prove</span></div>
<div style="position:absolute;left:36.01px;top:668.67px" class="cls_006"><span class="cls_006">helpful. This would allow the debugger to place “breakpoints” into the ROM</span></div>
<div style="position:absolute;left:36.01px;top:679.67px" class="cls_006"><span class="cls_006">code.</span></div>
<div style="position:absolute;left:54.00px;top:710.67px" class="cls_006"><span class="cls_006">† Some systems do this to avoid saving FP registers at context</span></div>
<div style="position:absolute;left:54.00px;top:722.67px" class="cls_006"><span class="cls_006">switch if the application is not using the FPA.</span></div>
<div style="position:absolute;left:287.55px;top:755.34px" class="cls_002"><span class="cls_002">15-10</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:162806px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE DESIGN EXAMPLES</span></div>
<div style="position:absolute;left:520.54px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 15</span></div>
<div style="position:absolute;left:216.00px;top:50.00px" class="cls_015"><span class="cls_015">UNIX-LIKE SYSTEM S/W</span></div>
<div style="position:absolute;left:228.02px;top:63.67px" class="cls_006"><span class="cls_006">It is obviously impossible, in a few pages, to give a comprehensive</span></div>
<div style="position:absolute;left:216.00px;top:74.67px" class="cls_006"><span class="cls_006">description of a big operating system. This section will provide some</span></div>
<div style="position:absolute;left:216.00px;top:85.67px" class="cls_006"><span class="cls_006">background on what a portable big system does, and how it does it on</span></div>
<div style="position:absolute;left:216.00px;top:96.67px" class="cls_006"><span class="cls_006">MIPS - so if the system needs to implement some fragment of this</span></div>
<div style="position:absolute;left:216.00px;top:107.67px" class="cls_006"><span class="cls_006">functionality the programmer won’t be starting entirely from scratch. In</span></div>
<div style="position:absolute;left:216.00px;top:118.67px" class="cls_006"><span class="cls_006">specific  examples  shown,  the  description  below  relates  to  the  freely</span></div>
<div style="position:absolute;left:216.00px;top:129.67px" class="cls_006"><span class="cls_006">redistributable ‘‘NetBSD’’ system, part of the Berkeley family.</span></div>
<div style="position:absolute;left:228.02px;top:140.67px" class="cls_006"><span class="cls_006">The description is arranged as follows:</span></div>
<div style="position:absolute;left:228.02px;top:154.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Terminology</span><span class="cls_006">: key words, often used with very particular meanings in</span></div>
<div style="position:absolute;left:239.97px;top:165.67px" class="cls_006"><span class="cls_006">Unix-like systems:</span></div>
<div style="position:absolute;left:228.02px;top:179.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Components of a process</span><span class="cls_006">:</span></div>
<div style="position:absolute;left:228.02px;top:193.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Protection</span><span class="cls_006">: how the kernel protects itself and other processes from</span></div>
<div style="position:absolute;left:239.97px;top:204.67px" class="cls_006"><span class="cls_006">misbehaving software;</span></div>
<div style="position:absolute;left:228.02px;top:218.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Kernel services</span><span class="cls_006">:</span></div>
<div style="position:absolute;left:228.02px;top:232.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Virtual memory</span><span class="cls_006">: how the MIPS architecture is used to build VM.</span></div>
<div style="position:absolute;left:228.02px;top:246.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Interrupts</span><span class="cls_006">: how the CPU’s features relate to the needs of the OS.</span></div>
<div style="position:absolute;left:216.00px;top:269.00px" class="cls_015"><span class="cls_015">Terminology</span></div>
<div style="position:absolute;left:228.02px;top:285.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:285.67px" class="cls_008"><span class="cls_008">Task</span><span class="cls_006">: a thread of control, identified by a program counter and a stack.</span></div>
<div style="position:absolute;left:239.97px;top:296.67px" class="cls_006"><span class="cls_006">In other contexts this may be called a ‘‘process’’ or ‘‘thread’’.</span></div>
<div style="position:absolute;left:228.02px;top:310.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:310.67px" class="cls_008"><span class="cls_008">Address space</span><span class="cls_006">: the program memory context seen by an application.</span></div>
<div style="position:absolute;left:239.97px;top:321.67px" class="cls_006"><span class="cls_006">For MIPS this is a single, simple 32-bit space, divided into two. The</span></div>
<div style="position:absolute;left:239.97px;top:332.67px" class="cls_006"><span class="cls_006">lower 2Gbytes is accessible in user mode, but the upper 2Gbytes is</span></div>
<div style="position:absolute;left:239.97px;top:343.67px" class="cls_006"><span class="cls_006">not usable except in kernel mode. Note that the address mapping</span></div>
<div style="position:absolute;left:239.97px;top:354.67px" class="cls_006"><span class="cls_006">doesn’t change with CPU mode. There are no segments, no separate</span></div>
<div style="position:absolute;left:239.97px;top:365.67px" class="cls_006"><span class="cls_006">I- and D-space.</span></div>
<div style="position:absolute;left:239.97px;top:379.67px" class="cls_006"><span class="cls_006">This MIPS model fits very well onto the BSD family of Unix-like</span></div>
<div style="position:absolute;left:239.97px;top:390.67px" class="cls_006"><span class="cls_006">systems, and was probably conceived with BSD’s requirements in</span></div>
<div style="position:absolute;left:239.97px;top:401.67px" class="cls_006"><span class="cls_006">mind.</span></div>
<div style="position:absolute;left:228.02px;top:415.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:415.67px" class="cls_008"><span class="cls_008">Program</span><span class="cls_006">: a bunch of code and data initialization, held on disc and</span></div>
<div style="position:absolute;left:239.97px;top:426.67px" class="cls_006"><span class="cls_006">loaded when required.</span></div>
<div style="position:absolute;left:239.97px;top:440.67px" class="cls_006"><span class="cls_006">A ‘‘process’’ combines all these three: it is a task in an address space</span></div>
<div style="position:absolute;left:239.97px;top:451.67px" class="cls_006"><span class="cls_006">running a program.</span></div>
<div style="position:absolute;left:228.02px;top:465.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:465.67px" class="cls_008"><span class="cls_008">File</span><span class="cls_006">: a named sequence of bytes coming from ‘‘outside’’. At its simplest</span></div>
<div style="position:absolute;left:239.97px;top:476.67px" class="cls_006"><span class="cls_006">it is just data which can be written out to disc and subsequently read</span></div>
<div style="position:absolute;left:239.97px;top:487.67px" class="cls_006"><span class="cls_006">back.</span></div>
<div style="position:absolute;left:228.02px;top:501.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:501.67px" class="cls_008"><span class="cls_008">Device</span><span class="cls_006">:   abstract,   fairly   unified   interface   to   diverse   real-world</span></div>
<div style="position:absolute;left:239.97px;top:512.67px" class="cls_006"><span class="cls_006">peripherals. Devices are named like files, and offer the same basic</span></div>
<div style="position:absolute;left:239.97px;top:523.67px" class="cls_006"><span class="cls_006">byte-stream model. Beneath this interface the kernel buffers data,</span></div>
<div style="position:absolute;left:239.97px;top:534.67px" class="cls_006"><span class="cls_006">handles interrupts and hardware details, and also provides an escape</span></div>
<div style="position:absolute;left:239.97px;top:545.67px" class="cls_006"><span class="cls_006">mechanism to keep device-specific functions tidy.</span></div>
<div style="position:absolute;left:239.97px;top:559.67px" class="cls_006"><span class="cls_006">‘‘Device drivers’’ are the lowest layer of kernel software which deals</span></div>
<div style="position:absolute;left:239.97px;top:570.67px" class="cls_006"><span class="cls_006">with  hardware,  and  are  supposed  to  isolate  dependencies  on</span></div>
<div style="position:absolute;left:239.97px;top:581.67px" class="cls_006"><span class="cls_006">particular controllers/peripherals.</span></div>
<div style="position:absolute;left:239.97px;top:595.67px" class="cls_006"><span class="cls_006">Network interfaces are handled differently, and networking code is</span></div>
<div style="position:absolute;left:239.97px;top:606.67px" class="cls_006"><span class="cls_006">way beyond the scope of this chapter.</span></div>
<div style="position:absolute;left:228.02px;top:620.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:620.67px" class="cls_008"><span class="cls_008">Page  fault</span><span class="cls_006">:  the  OS  maintains  a  mapping  of  program</span></div>
<div style="position:absolute;left:538.04px;top:620.67px" class="cls_006"><span class="cls_006">(virtual)</span></div>
<div style="position:absolute;left:239.97px;top:631.67px" class="cls_006"><span class="cls_006">addresses to physical addresses. But it doesn’t have to keep all the</span></div>
<div style="position:absolute;left:239.97px;top:642.67px" class="cls_006"><span class="cls_006">process pages in memory. Access to a page for which no translation</span></div>
<div style="position:absolute;left:239.97px;top:653.67px" class="cls_006"><span class="cls_006">is defined causes a trap (a </span><span class="cls_008">page fault</span><span class="cls_006"> which invokes a piece of software</span></div>
<div style="position:absolute;left:239.97px;top:664.67px" class="cls_006"><span class="cls_006">which checks that the address is legitimate, and if so brings the page</span></div>
<div style="position:absolute;left:239.97px;top:675.67px" class="cls_006"><span class="cls_006">into memory. When a page is touched for the first time, it will either</span></div>
<div style="position:absolute;left:239.97px;top:686.67px" class="cls_006"><span class="cls_006">be loaded from disc (if it is program text or initialized data) or supplied</span></div>
<div style="position:absolute;left:239.97px;top:697.67px" class="cls_006"><span class="cls_006">set to zero (if it is uninitialized data or stack).</span></div>
<div style="position:absolute;left:301.30px;top:755.34px" class="cls_002"><span class="cls_002">15-11</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:163608px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 15</span></div>
<div style="position:absolute;left:421.27px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE DESIGN EXAMPLES</span></div>
<div style="position:absolute;left:36.00px;top:50.00px" class="cls_015"><span class="cls_015">Components of a process</span></div>
<div style="position:absolute;left:48.02px;top:63.67px" class="cls_006"><span class="cls_006">The above description refers to a BSD ‘‘process’’ as a task, address space</span></div>
<div style="position:absolute;left:36.00px;top:74.67px" class="cls_006"><span class="cls_006">and program all at the same time. This is a restriction, but it does keep</span></div>
<div style="position:absolute;left:36.00px;top:85.67px" class="cls_006"><span class="cls_006">things simpler.</span></div>
<div style="position:absolute;left:48.02px;top:96.67px" class="cls_006"><span class="cls_006">“Processes” are laid out in memory as shown in Figure 11.1, “Memory</span></div>
<div style="position:absolute;left:36.00px;top:107.67px" class="cls_006"><span class="cls_006">layout of a BSD process”.</span></div>
<div style="position:absolute;left:114.92px;top:133.23px" class="cls_049"><span class="cls_049">0xFFFF FFFF</span></div>
<div style="position:absolute;left:278.18px;top:155.59px" class="cls_050"><span class="cls_050">kseg2</span></div>
<div style="position:absolute;left:176.64px;top:177.04px" class="cls_051"><span class="cls_051">per-process data</span></div>
<div style="position:absolute;left:117.00px;top:183.26px" class="cls_049"><span class="cls_049">0xC000 0000</span></div>
<div style="position:absolute;left:156.10px;top:198.48px" class="cls_051"><span class="cls_051">IO registers (h/w dependent)</span></div>
<div style="position:absolute;left:278.18px;top:208.88px" class="cls_050"><span class="cls_050">kseg1</span></div>
<div style="position:absolute;left:117.42px;top:233.29px" class="cls_049"><span class="cls_049">0xA000 0000</span></div>
<div style="position:absolute;left:189.74px;top:255.66px" class="cls_051"><span class="cls_051">kernel data</span></div>
<div style="position:absolute;left:278.18px;top:258.91px" class="cls_050"><span class="cls_050">kseg0</span></div>
<div style="position:absolute;left:188.55px;top:273.53px" class="cls_051"><span class="cls_051">kernel code</span></div>
<div style="position:absolute;left:118.25px;top:283.32px" class="cls_049"><span class="cls_049">0x8000 0000</span></div>
<div style="position:absolute;left:173.97px;top:294.98px" class="cls_051"><span class="cls_051">stack (grows down)</span></div>
<div style="position:absolute;left:179.92px;top:373.61px" class="cls_051"><span class="cls_051">heap (grows up)</span></div>
<div style="position:absolute;left:278.18px;top:373.66px" class="cls_050"><span class="cls_050">kuseg</span></div>
<div style="position:absolute;left:184.68px;top:395.05px" class="cls_051"><span class="cls_051">declared data</span></div>
<div style="position:absolute;left:184.38px;top:437.93px" class="cls_051"><span class="cls_051">program code</span></div>
<div style="position:absolute;left:118.25px;top:462.00px" class="cls_049"><span class="cls_049">0x0000 0000</span></div>
<div style="position:absolute;left:109.88px;top:479.00px" class="cls_020"><span class="cls_020">Figure H.1.   Memory layout of a BSD process</span></div>
<div style="position:absolute;left:48.02px;top:492.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Program text</span><span class="cls_006">: every process has a program in memory which it can</span></div>
<div style="position:absolute;left:59.97px;top:503.67px" class="cls_006"><span class="cls_006">run (it may be ‘‘virtual memory’’, but to the process it seems to be</span></div>
<div style="position:absolute;left:59.97px;top:514.67px" class="cls_006"><span class="cls_006">there).</span></div>
<div style="position:absolute;left:48.02px;top:528.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Stack</span><span class="cls_006">: every process has a stack, which grows downwards from the</span></div>
<div style="position:absolute;left:59.97px;top:539.67px" class="cls_006"><span class="cls_006">top of the user-accessible space. Since the MIPS architecture has no</span></div>
<div style="position:absolute;left:59.97px;top:550.67px" class="cls_006"><span class="cls_006">architecture-specified stack pointer, the OS is always willing to</span></div>
<div style="position:absolute;left:59.97px;top:561.67px" class="cls_006"><span class="cls_006">allocate pages of memory in the stack region if ever the program gets</span></div>
<div style="position:absolute;left:59.97px;top:572.67px" class="cls_006"><span class="cls_006">a page fault.</span></div>
<div style="position:absolute;left:48.02px;top:586.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Declared data</span><span class="cls_006">: the data declared in a C program is noted in the object</span></div>
<div style="position:absolute;left:59.97px;top:597.67px" class="cls_006"><span class="cls_006">file, and explicitly accessed by compiled-in code. Initialized data is</span></div>
<div style="position:absolute;left:59.97px;top:608.67px" class="cls_006"><span class="cls_006">paged from the program file as needed, uninitialized data is supplied</span></div>
<div style="position:absolute;left:59.97px;top:619.67px" class="cls_006"><span class="cls_006">as zero-filled pages.</span></div>
<div style="position:absolute;left:48.02px;top:633.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Heap</span><span class="cls_006">: this is the traditional name for data space allocated during</span></div>
<div style="position:absolute;left:59.97px;top:644.67px" class="cls_006"><span class="cls_006">program run-time. At the top of the data section the kernel maintains</span></div>
<div style="position:absolute;left:59.97px;top:655.67px" class="cls_006"><span class="cls_006">a boundary address (the </span><span class="cls_008">break</span><span class="cls_006">); on a page fault addresses above this</span></div>
<div style="position:absolute;left:59.97px;top:666.67px" class="cls_006"><span class="cls_006">are rejected as invalid. To allocate extra data the process can invoke</span></div>
<div style="position:absolute;left:59.97px;top:677.67px" class="cls_006"><span class="cls_006">the </span><span class="cls_008">sbrk</span><span class="cls_006">() system call; this is usually done implicitly when calling a</span></div>
<div style="position:absolute;left:59.96px;top:688.67px" class="cls_006"><span class="cls_006">free-space manager function such as </span><span class="cls_008">malloc</span><span class="cls_006">().</span></div>
<div style="position:absolute;left:287.55px;top:755.34px" class="cls_002"><span class="cls_002">15-12</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:164410px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE DESIGN EXAMPLES</span></div>
<div style="position:absolute;left:520.54px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 15</span></div>
<div style="position:absolute;left:228.02px;top:50.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Kernel data structures</span><span class="cls_006">: when a process in BSD makes a system call</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">the process continues execution, but in kernel mode. Some kernel</span></div>
<div style="position:absolute;left:239.97px;top:72.67px" class="cls_006"><span class="cls_006">activity</span></div>
<div style="position:absolute;left:281.25px;top:72.67px" class="cls_006"><span class="cls_006">(such as interrupts) doesn’t run on a particular process</span></div>
<div style="position:absolute;left:239.97px;top:83.67px" class="cls_006"><span class="cls_006">context, but most does.</span></div>
<div style="position:absolute;left:239.97px;top:97.67px" class="cls_006"><span class="cls_006">So important parts of the process address space are inside the kernel,</span></div>
<div style="position:absolute;left:239.97px;top:108.67px" class="cls_006"><span class="cls_006">and are not accessible while the process is running in user mode. In</span></div>
<div style="position:absolute;left:239.97px;top:119.67px" class="cls_006"><span class="cls_006">particular, the process in kernel mode gets access to the whole kernel</span></div>
<div style="position:absolute;left:239.97px;top:130.67px" class="cls_006"><span class="cls_006">code and data (mapped into kseg0) and to all IO registers (mapped in</span></div>
<div style="position:absolute;left:239.97px;top:141.67px" class="cls_006"><span class="cls_006">kseg1).</span></div>
<div style="position:absolute;left:239.97px;top:155.67px" class="cls_006"><span class="cls_006">It is a boon that, while a process is running in the kernel, all its user-</span></div>
<div style="position:absolute;left:239.97px;top:166.67px" class="cls_006"><span class="cls_006">mode data is accessible at exactly the same addresses as in user</span></div>
<div style="position:absolute;left:239.97px;top:177.67px" class="cls_006"><span class="cls_006">mode. Some architectures have to implement a special-case ‘‘copy</span></div>
<div style="position:absolute;left:239.97px;top:188.67px" class="cls_006"><span class="cls_006">user data to/from kernel space’’ instruction.</span></div>
<div style="position:absolute;left:228.02px;top:202.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> proc structure</span><span class="cls_006">: lurking in the kernel data area are the two key data</span></div>
<div style="position:absolute;left:239.97px;top:213.67px" class="cls_006"><span class="cls_006">structures which define the process. Why two? The smaller of these is</span></div>
<div style="position:absolute;left:239.97px;top:224.67px" class="cls_006"><span class="cls_006">the </span><span class="cls_029">proc</span><span class="cls_006"> structure and contains information which may be required</span></div>
<div style="position:absolute;left:239.97px;top:235.67px" class="cls_006"><span class="cls_006">even when the process is not itself executing, and;</span></div>
<div style="position:absolute;left:228.02px;top:249.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> per-process data area (</span><span class="cls_029">u</span><span class="cls_008"> area)</span><span class="cls_006">: this is the larger process structure,</span></div>
<div style="position:absolute;left:239.98px;top:260.67px" class="cls_006"><span class="cls_006">and is accessible only when the process is active. By a special trick of</span></div>
<div style="position:absolute;left:239.98px;top:271.67px" class="cls_006"><span class="cls_006">the MMU, the per-process data area is mapped to a constant virtual</span></div>
<div style="position:absolute;left:239.98px;top:282.67px" class="cls_006"><span class="cls_006">address inside the kernel, in the kseg2 region.</span></div>
<div style="position:absolute;left:228.03px;top:296.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> kernel stack</span><span class="cls_006">: attached to the per-process area, mapped into kseg2, is</span></div>
<div style="position:absolute;left:239.98px;top:307.67px" class="cls_006"><span class="cls_006">the stack used by the process when executing in the kernel. It is this</span></div>
<div style="position:absolute;left:239.98px;top:318.67px" class="cls_006"><span class="cls_006">stack which is ‘‘borrowed’’ by interrupts.</span></div>
<div style="position:absolute;left:216.00px;top:341.00px" class="cls_015"><span class="cls_015">System calls and protection</span></div>
<div style="position:absolute;left:228.02px;top:354.67px" class="cls_006"><span class="cls_006">One of the goals of BSD is protection for robustness; to ensure that a</span></div>
<div style="position:absolute;left:216.00px;top:365.67px" class="cls_006"><span class="cls_006">user-level program which goes wrong cannot disrupt the rest of the</span></div>
<div style="position:absolute;left:216.00px;top:376.67px" class="cls_006"><span class="cls_006">system. This is basically achieved by the process address space:</span></div>
<div style="position:absolute;left:228.02px;top:390.67px" class="cls_006"><span class="cls_006">• In user mode, the process can only get at its user-mode virtual</span></div>
<div style="position:absolute;left:239.97px;top:401.67px" class="cls_006"><span class="cls_006">addresses, which are only those pages allocated by the kernel.</span></div>
<div style="position:absolute;left:228.02px;top:415.67px" class="cls_006"><span class="cls_006">• To get into kernel mode, the process has to drop through a </span><span class="cls_008">system call</span></div>
<div style="position:absolute;left:239.97px;top:426.67px" class="cls_006"><span class="cls_006">trap and can then perform only the function the system call allows. It</span></div>
<div style="position:absolute;left:239.97px;top:437.67px" class="cls_006"><span class="cls_006">is the duty of the system call itself to check its arguments for sanity,</span></div>
<div style="position:absolute;left:239.97px;top:448.67px" class="cls_006"><span class="cls_006">and to make sure that it behaves properly.</span></div>
<div style="position:absolute;left:239.97px;top:462.67px" class="cls_006"><span class="cls_006">Interrupts and inadvertent traps behave much like system calls,</span></div>
<div style="position:absolute;left:239.97px;top:473.67px" class="cls_006"><span class="cls_006">albeit ones which don’t work on behalf of the user process.</span></div>
<div style="position:absolute;left:228.02px;top:484.67px" class="cls_006"><span class="cls_006">Of course, since the process has the whole kernel mapped it can at any</span></div>
<div style="position:absolute;left:216.00px;top:495.67px" class="cls_006"><span class="cls_006">time attempt a reference to kernel code or data; but in user mode this will</span></div>
<div style="position:absolute;left:216.00px;top:506.67px" class="cls_006"><span class="cls_006">be immediately trapped, and find its way to a memory reference error</span></div>
<div style="position:absolute;left:216.00px;top:517.67px" class="cls_006"><span class="cls_006">handler - which by default will kill the process.</span></div>
<div style="position:absolute;left:228.02px;top:528.67px" class="cls_006"><span class="cls_006">R30xx security features are pretty much the minimum that will support</span></div>
<div style="position:absolute;left:216.00px;top:539.67px" class="cls_006"><span class="cls_006">a BSD-style OS. Many architectures offer much more; but portable OS’,</span></div>
<div style="position:absolute;left:216.00px;top:550.67px" class="cls_006"><span class="cls_006">since they want to be portable, use only the lowest common denominator</span></div>
<div style="position:absolute;left:216.00px;top:561.67px" class="cls_006"><span class="cls_006">of security functions - and since all significant microprocessor OS’ are now</span></div>
<div style="position:absolute;left:216.00px;top:572.67px" class="cls_006"><span class="cls_006">portable, the extra functionality is wasted.</span></div>
<div style="position:absolute;left:216.00px;top:595.00px" class="cls_015"><span class="cls_015">What the kernel does</span></div>
<div style="position:absolute;left:228.02px;top:608.67px" class="cls_006"><span class="cls_006">In the BSD system the kernel is the essential common ground between</span></div>
<div style="position:absolute;left:216.00px;top:619.67px" class="cls_006"><span class="cls_006">processes, and must share out access to any resource for which processes</span></div>
<div style="position:absolute;left:216.00px;top:630.67px" class="cls_006"><span class="cls_006">compete (CPU time, memory, disc bandwidth etc.). It must also provide</span></div>
<div style="position:absolute;left:216.00px;top:641.67px" class="cls_006"><span class="cls_006">basic  mechanisms  so  that  processes  which  want  to  co-operate  can</span></div>
<div style="position:absolute;left:216.00px;top:652.67px" class="cls_006"><span class="cls_006">communicate with each other. BSD and other Unix-like systems are</span></div>
<div style="position:absolute;left:216.00px;top:663.67px" class="cls_006"><span class="cls_006">traditionally rather kernel-heavy; more modern OS’ try to provide only</span></div>
<div style="position:absolute;left:216.00px;top:674.67px" class="cls_006"><span class="cls_006">minimum functions in the kernel (which is then often called a </span><span class="cls_008">microkernel</span><span class="cls_006">),</span></div>
<div style="position:absolute;left:216.00px;top:685.67px" class="cls_006"><span class="cls_006">handing over other jobs to distinct ‘‘server’’ processes.</span></div>
<div style="position:absolute;left:228.02px;top:699.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> File system</span><span class="cls_006">: the kernel provides access to the file system, which is</span></div>
<div style="position:absolute;left:239.97px;top:710.67px" class="cls_006"><span class="cls_006">based on open/read/write/close functions. In practice this splits into</span></div>
<div style="position:absolute;left:239.97px;top:721.67px" class="cls_006"><span class="cls_006">two; resolving names and then implementing file I/O.</span></div>
<div style="position:absolute;left:301.30px;top:755.34px" class="cls_002"><span class="cls_002">15-13</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:165212px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 15</span></div>
<div style="position:absolute;left:421.27px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE DESIGN EXAMPLES</span></div>
<div style="position:absolute;left:59.98px;top:50.67px" class="cls_006"><span class="cls_006">There will usually be multiple file system implementations (but each</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">offering the same service); a file I/O system call will be redirected to</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">the correct code according to whether the file is local, on NFS, on a</span></div>
<div style="position:absolute;left:59.98px;top:83.67px" class="cls_006"><span class="cls_006">DOS floppy disc, etc.</span></div>
<div style="position:absolute;left:48.03px;top:97.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:97.67px" class="cls_008"><span class="cls_008">Scheduling</span><span class="cls_006">: BSD decides which process to run. Most of the time,</span></div>
<div style="position:absolute;left:59.98px;top:108.67px" class="cls_006"><span class="cls_006">processes will run until they need some input - and then they’ll make</span></div>
<div style="position:absolute;left:59.98px;top:119.67px" class="cls_006"><span class="cls_006">a system call to get the input and block until the input is ready.</span></div>
<div style="position:absolute;left:59.98px;top:133.67px" class="cls_006"><span class="cls_006">But sometimes a process needs to compute for longer; in this case it</span></div>
<div style="position:absolute;left:59.98px;top:144.67px" class="cls_006"><span class="cls_006">will be </span><span class="cls_008">time-sliced</span><span class="cls_006">; it will be allowed to run only for a second or so and</span></div>
<div style="position:absolute;left:59.98px;top:155.67px" class="cls_006"><span class="cls_006">then another process will be given a go.</span></div>
<div style="position:absolute;left:59.98px;top:169.67px" class="cls_006"><span class="cls_006">To prevent a compute-bound process from clogging up the CPU,</span></div>
<div style="position:absolute;left:59.98px;top:180.67px" class="cls_006"><span class="cls_006">processes are given priorities, and any process which uses up its time</span></div>
<div style="position:absolute;left:59.98px;top:191.67px" class="cls_006"><span class="cls_006">slice has its priority reduced. A priority-based scheduling decision is</span></div>
<div style="position:absolute;left:59.98px;top:202.67px" class="cls_006"><span class="cls_006">made often - potentially, after any interrupt.</span></div>
<div style="position:absolute;left:48.03px;top:216.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:216.67px" class="cls_008"><span class="cls_008">Paging</span><span class="cls_006">: the kernel shares memory by picking pages of memory which</span></div>
<div style="position:absolute;left:59.98px;top:227.67px" class="cls_006"><span class="cls_006">don’t appear to have been used for a while, and throwing them out. A</span></div>
<div style="position:absolute;left:59.98px;top:238.67px" class="cls_006"><span class="cls_006">data page which has been written by a process since it came in must</span></div>
<div style="position:absolute;left:59.98px;top:249.67px" class="cls_006"><span class="cls_006">first be saved to a disc swap file.</span></div>
<div style="position:absolute;left:59.98px;top:263.67px" class="cls_006"><span class="cls_006">The MIPS architecture gives no direct help in tracing what happens to</span></div>
<div style="position:absolute;left:59.98px;top:274.67px" class="cls_006"><span class="cls_006">pages; in many architectures the MMU hardware notes (separately)</span></div>
<div style="position:absolute;left:59.98px;top:285.67px" class="cls_006"><span class="cls_006">whenever a page is either referenced or written. In MIPS this must be</span></div>
<div style="position:absolute;left:59.98px;top:296.67px" class="cls_006"><span class="cls_006">simulated; so the kernel picks pages and marks them as (from the</span></div>
<div style="position:absolute;left:59.98px;top:307.67px" class="cls_006"><span class="cls_006">point of view of the hardware) ‘‘read only’’ or ‘‘invalid’’. Then it waits;</span></div>
<div style="position:absolute;left:59.98px;top:318.67px" class="cls_006"><span class="cls_006">if a process references or writes the page a trap will be generated, and</span></div>
<div style="position:absolute;left:59.98px;top:329.67px" class="cls_006"><span class="cls_006">the trap handler will look at the page status and set a software</span></div>
<div style="position:absolute;left:59.98px;top:340.67px" class="cls_006"><span class="cls_006">referenced/written bit.</span></div>
<div style="position:absolute;left:59.98px;top:354.67px" class="cls_006"><span class="cls_006">In this way processes which are not active slowly migrate out of</span></div>
<div style="position:absolute;left:59.98px;top:365.67px" class="cls_006"><span class="cls_006">memory.</span></div>
<div style="position:absolute;left:48.03px;top:379.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:59.98px;top:379.67px" class="cls_008"><span class="cls_008">Caching and sharing code</span><span class="cls_006">: it often happens, particularly in a multi-</span></div>
<div style="position:absolute;left:59.98px;top:390.67px" class="cls_006"><span class="cls_006">user system, that there are multiple processes all running the same</span></div>
<div style="position:absolute;left:59.98px;top:401.67px" class="cls_006"><span class="cls_006">program. NetBSD treats code pages (i.e. read-only pages marked as</span></div>
<div style="position:absolute;left:59.98px;top:412.67px" class="cls_006"><span class="cls_006">loadable from a file) as sharable; when they are kept in memory they</span></div>
<div style="position:absolute;left:59.98px;top:423.67px" class="cls_006"><span class="cls_006">are indexed by their disc location. During periods of relatively light</span></div>
<div style="position:absolute;left:59.98px;top:434.67px" class="cls_006"><span class="cls_006">load (which is most of the time in most systems) much of memory has</span></div>
<div style="position:absolute;left:59.98px;top:445.67px" class="cls_006"><span class="cls_006">nothing very useful in it; so code pages are allowed to stay there,</span></div>
<div style="position:absolute;left:59.98px;top:456.67px" class="cls_006"><span class="cls_006">forming a least-recently used cache.</span></div>
<div style="position:absolute;left:59.98px;top:470.67px" class="cls_006"><span class="cls_006">This means that a program which is repeatedly re-run to completion</span></div>
<div style="position:absolute;left:59.98px;top:481.67px" class="cls_006"><span class="cls_006">goes much faster. Although each time a process must be created and</span></div>
<div style="position:absolute;left:59.98px;top:492.67px" class="cls_006"><span class="cls_006">the whole program nominally ‘‘paged in’’, in practice all that is needed</span></div>
<div style="position:absolute;left:59.98px;top:503.67px" class="cls_006"><span class="cls_006">is to construct a set of entries referencing the already memory-</span></div>
<div style="position:absolute;left:59.98px;top:514.67px" class="cls_006"><span class="cls_006">resident code.</span></div>
<div style="position:absolute;left:36.00px;top:537.00px" class="cls_015"><span class="cls_015">Virtual memory implementation for MIPS</span></div>
<div style="position:absolute;left:48.02px;top:550.67px" class="cls_006"><span class="cls_006">The  R30xx  hardware  supports  an  arbitrary</span></div>
<div style="position:absolute;left:284.62px;top:550.67px" class="cls_006"><span class="cls_006">(though  small)  set  of</span></div>
<div style="position:absolute;left:36.00px;top:561.67px" class="cls_006"><span class="cls_006">translations in its 64-entry TLB. When an address is encountered which</span></div>
<div style="position:absolute;left:36.00px;top:572.67px" class="cls_006"><span class="cls_006">doesn’t match with one of these, the CPU takes an exception (a </span><span class="cls_008">tlbmiss</span><span class="cls_006">)</span></div>
<div style="position:absolute;left:36.00px;top:583.67px" class="cls_006"><span class="cls_006">and software must find a new translation and load it.</span></div>
<div style="position:absolute;left:48.02px;top:594.67px" class="cls_006"><span class="cls_006">‘‘tlbmiss’’  events  can  occur  very  frequently  when  running  large</span></div>
<div style="position:absolute;left:36.00px;top:605.67px" class="cls_006"><span class="cls_006">programs, and the trap handler must run quickly. Misses for user-mode</span></div>
<div style="position:absolute;left:36.00px;top:616.67px" class="cls_006"><span class="cls_006">addresses are vectored through a dedicated trap vector, to the </span><span class="cls_008">utlbmiss</span></div>
<div style="position:absolute;left:36.00px;top:627.67px" class="cls_006"><span class="cls_006">routine; since MIPS kernels can be built to run largely in the kseg0/kseg1</span></div>
<div style="position:absolute;left:36.00px;top:638.67px" class="cls_006"><span class="cls_006">areas (which don’t require the TLB) the vast majority of TLB misses are</span></div>
<div style="position:absolute;left:36.00px;top:649.67px" class="cls_006"><span class="cls_006">user ones.</span></div>
<div style="position:absolute;left:48.02px;top:660.67px" class="cls_006"><span class="cls_006">To speed the trap handler, most systems will keep memory-resident</span></div>
<div style="position:absolute;left:36.00px;top:671.67px" class="cls_006"><span class="cls_006">tables of page entries, in a format already bit-for-bit compatible with the</span></div>
<div style="position:absolute;left:36.00px;top:682.67px" class="cls_006"><span class="cls_006">hardware-determined TLB entries.</span></div>
<div style="position:absolute;left:48.02px;top:693.67px" class="cls_006"><span class="cls_006">It would be nice to do this by keeping a simple array of TLB entries,</span></div>
<div style="position:absolute;left:36.00px;top:704.67px" class="cls_006"><span class="cls_006">indexed  by  virtual  address.  However,  with  a</span></div>
<div style="position:absolute;left:281.63px;top:704.67px" class="cls_006"><span class="cls_006">2Gbyte  range  of  user</span></div>
<div style="position:absolute;left:36.00px;top:715.67px" class="cls_006"><span class="cls_006">addresses and 4Kbyte pages, the array would require 512K entries,</span></div>
<div style="position:absolute;left:287.55px;top:755.34px" class="cls_002"><span class="cls_002">15-14</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:166014px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE DESIGN EXAMPLES</span></div>
<div style="position:absolute;left:520.54px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 15</span></div>
<div style="position:absolute;left:216.00px;top:50.67px" class="cls_006"><span class="cls_006">occupying 2Mbytes of memory. Since the program address space has huge</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">‘‘holes’’ in it, most of this 2Mbytes of memory would be full of nothing -</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_006"><span class="cls_006">which is a lot of memory to dedicate,</span></div>
<div style="position:absolute;left:228.02px;top:83.67px" class="cls_006"><span class="cls_006">Two different solutions to this problem are used. MIPS Corp’s UMIPS</span></div>
<div style="position:absolute;left:216.00px;top:94.67px" class="cls_006"><span class="cls_006">and RISC/os variants use a linear page table but don’t keep it all in</span></div>
<div style="position:absolute;left:216.00px;top:105.67px" class="cls_006"><span class="cls_006">memory; NetBSD uses a memory-held secondary cache of page table</span></div>
<div style="position:absolute;left:216.00px;top:116.67px" class="cls_006"><span class="cls_006">entries supporting a machine-independent data structure:</span></div>
<div style="position:absolute;left:228.02px;top:130.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.97px;top:130.67px" class="cls_008"><span class="cls_008">Linear Page table not all in memory</span><span class="cls_006">: the linear page table is located in</span></div>
<div style="position:absolute;left:239.97px;top:141.67px" class="cls_006"><span class="cls_006">the </span><span class="cls_008">virtual</span><span class="cls_006"> space kseg2. Although the whole page table is very large,</span></div>
<div style="position:absolute;left:239.97px;top:152.67px" class="cls_006"><span class="cls_006">most of it is never referenced, never allocated a kseg2 translation, and</span></div>
<div style="position:absolute;left:239.97px;top:163.67px" class="cls_006"><span class="cls_006">therefore costs nothing. The active parts of the page table correspond</span></div>
<div style="position:absolute;left:239.97px;top:174.67px" class="cls_006"><span class="cls_006">with the stack, data and code parts of the process address space; and</span></div>
<div style="position:absolute;left:239.97px;top:185.67px" class="cls_006"><span class="cls_006">for these the kseg2 translation is likely to remain live.</span></div>
<div style="position:absolute;left:239.97px;top:199.67px" class="cls_006"><span class="cls_006">The CPU’s </span><span class="cls_008">Context</span><span class="cls_006"> register is explicitly designed to do the work of</span></div>
<div style="position:absolute;left:239.97px;top:210.67px" class="cls_006"><span class="cls_006">computing where the desired page table entry lies, saving a few more</span></div>
<div style="position:absolute;left:239.97px;top:221.67px" class="cls_006"><span class="cls_006">instructions.</span></div>
<div style="position:absolute;left:239.97px;top:235.67px" class="cls_006"><span class="cls_006">This does require that the </span><span class="cls_008">utlbmiss</span><span class="cls_006"> handler can safely suffer a regular</span></div>
<div style="position:absolute;left:239.97px;top:246.67px" class="cls_006"><span class="cls_006">trap, to cope with those occasions where the page table read falls on</span></div>
<div style="position:absolute;left:239.97px;top:257.67px" class="cls_006"><span class="cls_006">a kseg2 address which is not currently translated by the TLB. This</span></div>
<div style="position:absolute;left:239.97px;top:268.67px" class="cls_006"><span class="cls_006">nested   exception   is   not   allowed   to   happen   in   any   other</span></div>
<div style="position:absolute;left:239.97px;top:279.67px" class="cls_006"><span class="cls_006">circumstances; but its use here motivates another feature of the MIPS</span></div>
<div style="position:absolute;left:239.97px;top:290.67px" class="cls_006"><span class="cls_006">hardware, and a convention:</span></div>
<div style="position:absolute;left:239.97px;top:304.67px" class="cls_006"><span class="cls_006">a)    The status register’s internal stack of processor state (2 bits for</span></div>
<div style="position:absolute;left:264.02px;top:315.67px" class="cls_006"><span class="cls_006">kernel/user mode and interrupt on/off) is three deep; allowing</span></div>
<div style="position:absolute;left:264.02px;top:326.67px" class="cls_006"><span class="cls_006">an exception to occur in an exception handler, </span><span class="cls_008">before</span><span class="cls_006"> the status</span></div>
<div style="position:absolute;left:264.02px;top:337.67px" class="cls_006"><span class="cls_006">register gets saved.</span></div>
<div style="position:absolute;left:239.97px;top:351.67px" class="cls_006"><span class="cls_006">b)   The ‘‘nested’’ exception overwrites the </span><span class="cls_008">EPC</span><span class="cls_006"> value (return address)</span></div>
<div style="position:absolute;left:264.02px;top:362.67px" class="cls_006"><span class="cls_006">from the original address reference, so the </span><span class="cls_008">utlbmiss</span><span class="cls_006"> handler</span></div>
<div style="position:absolute;left:264.02px;top:373.67px" class="cls_006"><span class="cls_006">saves </span><span class="cls_008">EPC</span><span class="cls_006"> into the general-purpose register </span><span class="cls_008">k1</span><span class="cls_006">; the regular trap</span></div>
<div style="position:absolute;left:264.03px;top:384.67px" class="cls_006"><span class="cls_006">handler which deals with kernel TLB misses has to detect the</span></div>
<div style="position:absolute;left:264.03px;top:395.67px" class="cls_006"><span class="cls_006">double-exception and return to the right place.</span></div>
<div style="position:absolute;left:264.03px;top:409.67px" class="cls_006"><span class="cls_006">This is why there are two registers (</span><span class="cls_008">k0,k1</span><span class="cls_006">) reserved for exception</span></div>
<div style="position:absolute;left:264.03px;top:420.67px" class="cls_006"><span class="cls_006">handling: most of the time only one is needed.</span></div>
<div style="position:absolute;left:228.03px;top:434.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:434.67px" class="cls_008"><span class="cls_008">Secondary cache of page table entries</span><span class="cls_006">: NetBSD uses a different</span></div>
<div style="position:absolute;left:239.98px;top:445.67px" class="cls_006"><span class="cls_006">technique. Here the TLB miss handler consults a software cache of</span></div>
<div style="position:absolute;left:239.98px;top:456.67px" class="cls_006"><span class="cls_006">recently used page table entries. The software cache is implemented</span></div>
<div style="position:absolute;left:239.98px;top:467.67px" class="cls_006"><span class="cls_006">with a simple 2-set hashing function, with a fast path for translations</span></div>
<div style="position:absolute;left:239.98px;top:478.67px" class="cls_006"><span class="cls_006">which are in the same set as their predecessor. A modestly large cache</span></div>
<div style="position:absolute;left:239.98px;top:489.67px" class="cls_006"><span class="cls_006">gives an excellent hit rate - so those few translations which miss here</span></div>
<div style="position:absolute;left:239.98px;top:500.67px" class="cls_006"><span class="cls_006">can  be  computed  by  a  C-language  routine  using  architecture-</span></div>
<div style="position:absolute;left:239.98px;top:511.67px" class="cls_006"><span class="cls_006">independent tables.</span></div>
<div style="position:absolute;left:216.00px;top:534.00px" class="cls_015"><span class="cls_015">Interrupt handling for MIPS</span></div>
<div style="position:absolute;left:228.02px;top:547.67px" class="cls_006"><span class="cls_006">Interrupt handling in Unix-like OS’ are descended from the priority-</span></div>
<div style="position:absolute;left:216.00px;top:558.67px" class="cls_006"><span class="cls_006">based system implemented in hardware by DEC’s PDP-11 and VAX</span></div>
<div style="position:absolute;left:216.00px;top:569.67px" class="cls_006"><span class="cls_006">architectures. Priorities are numbered from 0 to 7 (though not all are</span></div>
<div style="position:absolute;left:216.00px;top:580.67px" class="cls_006"><span class="cls_006">always used) - more recently, the numeric priorities have been getting</span></div>
<div style="position:absolute;left:216.00px;top:591.67px" class="cls_006"><span class="cls_006">names.</span></div>
<div style="position:absolute;left:228.02px;top:605.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Priority model and spl</span><span class="cls_006">: kernel code is arranged so that, in general,</span></div>
<div style="position:absolute;left:239.97px;top:616.67px" class="cls_006"><span class="cls_006">each piece of code is accessible only at or above a particular priority</span></div>
<div style="position:absolute;left:239.97px;top:627.67px" class="cls_006"><span class="cls_006">level. So, for example, once a program is at level 4 the CPU will only</span></div>
<div style="position:absolute;left:239.97px;top:638.67px" class="cls_006"><span class="cls_006">accept interrupt requests prioritized at level 5 and above.</span></div>
<div style="position:absolute;left:239.97px;top:652.67px" class="cls_006"><span class="cls_006">Most of the kernel code used by system calls runs at level 0.</span></div>
<div style="position:absolute;left:239.97px;top:666.67px" class="cls_006"><span class="cls_006">Device  code  which  needs  to  lock  itself  against  asynchronously-</span></div>
<div style="position:absolute;left:239.97px;top:677.67px" class="cls_006"><span class="cls_006">occurring interrupt events can call a function such as </span><span class="cls_008">spl4</span><span class="cls_006">() (spl</span></div>
<div style="position:absolute;left:239.97px;top:688.67px" class="cls_006"><span class="cls_006">stands for ‘‘set processor level’’): there is a separate call for each level.</span></div>
<div style="position:absolute;left:239.97px;top:699.67px" class="cls_008"><span class="cls_008">spl4</span><span class="cls_006">() returns a value representing the priority level when it was</span></div>
<div style="position:absolute;left:239.97px;top:710.67px" class="cls_006"><span class="cls_006">called, so the code sequence:</span></div>
<div style="position:absolute;left:301.30px;top:755.34px" class="cls_002"><span class="cls_002">15-15</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:166816px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 15</span></div>
<div style="position:absolute;left:421.27px;top:28.00px" class="cls_002"><span class="cls_002">SOFTWARE DESIGN EXAMPLES</span></div>
<div style="position:absolute;left:108.00px;top:61.00px" class="cls_028"><span class="cls_028">p = spl4();</span></div>
<div style="position:absolute;left:108.00px;top:71.00px" class="cls_028"><span class="cls_028">/* do something which can’t be interrupted */</span></div>
<div style="position:absolute;left:108.00px;top:81.00px" class="cls_028"><span class="cls_028">splx(p);</span></div>
<div style="position:absolute;left:59.98px;top:103.67px" class="cls_006"><span class="cls_006">restores whatever is required to lower the level again.</span></div>
<div style="position:absolute;left:59.98px;top:117.67px" class="cls_006"><span class="cls_006">Note that interrupt handlers can get called at two points: either as</span></div>
<div style="position:absolute;left:59.98px;top:128.67px" class="cls_006"><span class="cls_006">soon as the interrupt signal is activated, or (if the processor is</span></div>
<div style="position:absolute;left:59.98px;top:139.67px" class="cls_006"><span class="cls_006">currently at a higher spl) the handler will be called when a call to</span></div>
<div style="position:absolute;left:59.98px;top:150.67px" class="cls_008"><span class="cls_008">splx</span><span class="cls_006">() lowers the level below the interrupt’s priority.</span></div>
<div style="position:absolute;left:36.00px;top:171.67px" class="cls_006"><span class="cls_006">How it works</span></div>
<div style="position:absolute;left:48.02px;top:182.67px" class="cls_006"><span class="cls_006">The MIPS interrupt hardware knows nothing of levels, with only an</span></div>
<div style="position:absolute;left:36.00px;top:193.67px" class="cls_006"><span class="cls_006">unprioritized mask for the interrupt inputs. But if an spl level can be</span></div>
<div style="position:absolute;left:36.00px;top:204.67px" class="cls_006"><span class="cls_006">assigned to each of the interrupt inputs, then each of the </span><span class="cls_008">spl..</span><span class="cls_006">() routines</span></div>
<div style="position:absolute;left:36.00px;top:215.67px" class="cls_006"><span class="cls_006">can be implemented by setting the interrupt mask to a value enabling only</span></div>
<div style="position:absolute;left:36.00px;top:226.67px" class="cls_006"><span class="cls_006">those interrupts allocated a higher level.</span></div>
<div style="position:absolute;left:287.55px;top:755.34px" class="cls_002"><span class="cls_002">15-16</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:167618px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">ASSEMBLY LANGUAGE</span></div>
<div style="position:absolute;left:483.41px;top:42.00px" class="cls_015"><span class="cls_015">CHAPTER 16</span></div>
<div style="position:absolute;left:222.89px;top:56.33px" class="cls_005"><span class="cls_005">PROGRAMMING TIPS</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:228.02px;top:113.67px" class="cls_006"><span class="cls_006">The MIPS-1 architecture found in the R30xx family is designed for high-</span></div>
<div style="position:absolute;left:216.00px;top:124.67px" class="cls_006"><span class="cls_006">frequency, single-cycle instruction operation. Also, as noted earlier, the</span></div>
<div style="position:absolute;left:216.00px;top:135.67px" class="cls_006"><span class="cls_006">MIPS architecture does not carry a status register, nor does it directly</span></div>
<div style="position:absolute;left:216.00px;top:146.67px" class="cls_006"><span class="cls_006">support various addressing formats. As a result, some operations that may</span></div>
<div style="position:absolute;left:216.00px;top:157.67px" class="cls_006"><span class="cls_006">have been found in older CISC architectures must by synthesized from</span></div>
<div style="position:absolute;left:216.00px;top:168.67px" class="cls_006"><span class="cls_006">multiple instructions in the MIPS architecture. The net execution time is</span></div>
<div style="position:absolute;left:216.00px;top:179.67px" class="cls_006"><span class="cls_006">typically  improved,  however,  since  these  complex  instructions  were</span></div>
<div style="position:absolute;left:216.00px;top:190.67px" class="cls_006"><span class="cls_006">inherently multi-cycle in these older CISC architectures.</span></div>
<div style="position:absolute;left:228.02px;top:201.67px" class="cls_006"><span class="cls_006">This  chapter  describes  common  programming  problems  and  their</span></div>
<div style="position:absolute;left:216.00px;top:212.67px" class="cls_006"><span class="cls_006">implementation in the MIPS architecture. Many of these operations are</span></div>
<div style="position:absolute;left:216.00px;top:223.67px" class="cls_006"><span class="cls_006">directly supported by the synthetic instructions, described earlier.</span></div>
<div style="position:absolute;left:228.02px;top:234.67px" class="cls_006"><span class="cls_006">Also note that many of these instructions require the use of $at (the</span></div>
<div style="position:absolute;left:216.00px;top:245.67px" class="cls_006"><span class="cls_006">assembler temporary register) described earlier.</span></div>
<div style="position:absolute;left:216.00px;top:268.00px" class="cls_015"><span class="cls_015">32-bit Address or Constant Values</span></div>
<div style="position:absolute;left:228.02px;top:281.67px" class="cls_006"><span class="cls_006">As noted earlier in this manual, the MIPS-1 instruction set does not</span></div>
<div style="position:absolute;left:216.00px;top:292.67px" class="cls_006"><span class="cls_006">have enough room in the bit encoding to directly support 32-bit constants</span></div>
<div style="position:absolute;left:216.00px;top:303.67px" class="cls_006"><span class="cls_006">or constant address values. Thus, programmers must use combinations of</span></div>
<div style="position:absolute;left:216.00px;top:314.67px" class="cls_006"><span class="cls_006">instructions to generate 32-bit values.</span></div>
<div style="position:absolute;left:228.02px;top:325.67px" class="cls_006"><span class="cls_006">Again,  these  are  commonly  handled  using  the  synthetic  la  or  li</span></div>
<div style="position:absolute;left:216.00px;top:336.67px" class="cls_006"><span class="cls_006">instructions.  Depending  on  the  immediate  value,  the  assembler  will</span></div>
<div style="position:absolute;left:216.00px;top:347.67px" class="cls_006"><span class="cls_006">generate one or two instructions to implement the immediate load into the</span></div>
<div style="position:absolute;left:216.00px;top:358.67px" class="cls_006"><span class="cls_006">register:</span></div>
<div style="position:absolute;left:232.37px;top:392.00px" class="cls_020"><span class="cls_020">Operand</span></div>
<div style="position:absolute;left:382.16px;top:392.00px" class="cls_020"><span class="cls_020">Instruction Sequence</span></div>
<div style="position:absolute;left:220.00px;top:411.00px" class="cls_020"><span class="cls_020">Upper 16 bits</span></div>
<div style="position:absolute;left:292.00px;top:411.00px" class="cls_027"><span class="cls_027">ori rd, value</span><span class="cls_052"><sub>15..0</sub></span></div>
<div style="position:absolute;left:220.00px;top:421.00px" class="cls_020"><span class="cls_020">all zero</span></div>
<div style="position:absolute;left:220.00px;top:438.00px" class="cls_020"><span class="cls_020">Upper 17 bits</span></div>
<div style="position:absolute;left:292.00px;top:438.00px" class="cls_027"><span class="cls_027">addi rd, $0, value</span><span class="cls_052"><sub>15..0</sub></span></div>
<div style="position:absolute;left:220.00px;top:448.00px" class="cls_020"><span class="cls_020">all one</span></div>
<div style="position:absolute;left:220.00px;top:465.00px" class="cls_020"><span class="cls_020">Lower 16 bits</span></div>
<div style="position:absolute;left:292.00px;top:465.00px" class="cls_027"><span class="cls_027">lui rd, value</span><span class="cls_052"><sub>31..16</sub></span></div>
<div style="position:absolute;left:220.00px;top:475.00px" class="cls_020"><span class="cls_020">all zero</span></div>
<div style="position:absolute;left:220.00px;top:492.00px" class="cls_020"><span class="cls_020">All other</span></div>
<div style="position:absolute;left:292.00px;top:492.00px" class="cls_027"><span class="cls_027">lui rd, value</span><span class="cls_052"><sub>15..0</sub></span></div>
<div style="position:absolute;left:220.00px;top:502.00px" class="cls_020"><span class="cls_020">values</span></div>
<div style="position:absolute;left:292.00px;top:502.00px" class="cls_027"><span class="cls_027">ori rd, value</span><span class="cls_052"><sub>31..16</sub></span></div>
<div style="position:absolute;left:310.51px;top:521.00px" class="cls_020"><span class="cls_020">Table 16.1.  32-bit immediate values</span></div>
<div style="position:absolute;left:228.02px;top:536.67px" class="cls_006"><span class="cls_006">To jump to an absolute 32-bit address, a similar construct must be</span></div>
<div style="position:absolute;left:216.00px;top:547.67px" class="cls_006"><span class="cls_006">used. The la synthetic instruction is used to load the target address into a</span></div>
<div style="position:absolute;left:216.00px;top:558.67px" class="cls_006"><span class="cls_006">register; a jr (jump register) is then used to perform the jump.</span></div>
<div style="position:absolute;left:228.03px;top:569.67px" class="cls_006"><span class="cls_006">Note that j and jal may be used in many instances. However, these</span></div>
<div style="position:absolute;left:216.00px;top:580.67px" class="cls_006"><span class="cls_006">instructions take the high-order four bits of the current “PC” as the upper</span></div>
<div style="position:absolute;left:216.00px;top:591.67px" class="cls_006"><span class="cls_006">four bits of the target address, and thus limit the program space that can</span></div>
<div style="position:absolute;left:216.00px;top:602.67px" class="cls_006"><span class="cls_006">be reached. In practice, this limit may be larger than the address space of</span></div>
<div style="position:absolute;left:216.00px;top:613.67px" class="cls_006"><span class="cls_006">most typical embedded applications.</span></div>
<div style="position:absolute;left:216.00px;top:636.00px" class="cls_015"><span class="cls_015">Use of “Set” Instructions</span></div>
<div style="position:absolute;left:228.02px;top:649.67px" class="cls_006"><span class="cls_006">The MIPS ISA provides a very powerful operation to enable the easy</span></div>
<div style="position:absolute;left:216.00px;top:660.67px" class="cls_006"><span class="cls_006">synthesis of complex test operations.</span></div>
<div style="position:absolute;left:228.02px;top:671.67px" class="cls_006"><span class="cls_006">The “set” instructions place a value of ‘1’ (true) or ‘0’ (false) into the</span></div>
<div style="position:absolute;left:216.00px;top:682.67px" class="cls_006"><span class="cls_006">specified  destination  register  to  reflect  the  outcome  of  a  specified</span></div>
<div style="position:absolute;left:216.00px;top:693.67px" class="cls_006"><span class="cls_006">comparison operation. When used with conditional branch operations,</span></div>
<div style="position:absolute;left:216.00px;top:704.67px" class="cls_006"><span class="cls_006">complex comparison sequences can be implemented, as well add-with-</span></div>
<div style="position:absolute;left:216.00px;top:715.67px" class="cls_006"><span class="cls_006">carry or subtract-with-borrow operation.</span></div>
<div style="position:absolute;left:297.04px;top:754.68px" class="cls_002"><span class="cls_002">16-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:168420px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 16</span></div>
<div style="position:absolute;left:360.78px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLY LANGUAGE PROGRAMMING TIPS</span></div>
<div style="position:absolute;left:36.00px;top:50.67px" class="cls_006"><span class="cls_006">Use of “Set” with Complex Branch Operations</span></div>
<div style="position:absolute;left:48.02px;top:61.67px" class="cls_006"><span class="cls_006">The MIPS instruction set directly implements branch comparisons for</span></div>
<div style="position:absolute;left:36.00px;top:72.67px" class="cls_006"><span class="cls_006">the following cases:</span></div>
<div style="position:absolute;left:48.02px;top:83.67px" class="cls_006"><span class="cls_006">- two registers equal</span></div>
<div style="position:absolute;left:48.02px;top:94.67px" class="cls_006"><span class="cls_006">- two registers not equal</span></div>
<div style="position:absolute;left:48.02px;top:105.67px" class="cls_006"><span class="cls_006">- register greater-than-or-equal to zero</span></div>
<div style="position:absolute;left:48.02px;top:116.67px" class="cls_006"><span class="cls_006">- register less-than-or-equal to zero</span></div>
<div style="position:absolute;left:48.02px;top:127.67px" class="cls_006"><span class="cls_006">- register greater-than zero</span></div>
<div style="position:absolute;left:48.02px;top:138.67px" class="cls_006"><span class="cls_006">- register less-than zero</span></div>
<div style="position:absolute;left:48.02px;top:160.67px" class="cls_006"><span class="cls_006">These branch comparisons directly implement a wide range of common</span></div>
<div style="position:absolute;left:36.00px;top:171.67px" class="cls_006"><span class="cls_006">test conditions directly in hardware. However, in certain situations the</span></div>
<div style="position:absolute;left:36.00px;top:182.67px" class="cls_006"><span class="cls_006">programmer may require a more complicated test between two non-zero</span></div>
<div style="position:absolute;left:36.00px;top:193.67px" class="cls_006"><span class="cls_006">registers. This is where the “set” instructions are used.</span></div>
<div style="position:absolute;left:48.02px;top:204.67px" class="cls_006"><span class="cls_006">For example, if the programmer wishes to branch conditionally if one</span></div>
<div style="position:absolute;left:36.00px;top:215.67px" class="cls_006"><span class="cls_006">register is less than another, a two instruction sequence is used:</span></div>
<div style="position:absolute;left:108.00px;top:238.67px" class="cls_028"><span class="cls_028">slt</span></div>
<div style="position:absolute;left:162.07px;top:238.67px" class="cls_028"><span class="cls_028">$at, $a, $b</span></div>
<div style="position:absolute;left:108.00px;top:249.00px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:162.07px;top:249.00px" class="cls_028"><span class="cls_028">$at, $0, target</span></div>
<div style="position:absolute;left:252.41px;top:249.00px" class="cls_028"><span class="cls_028"># branch to target if a &lt; b</span></div>
<div style="position:absolute;left:48.02px;top:269.67px" class="cls_006"><span class="cls_006">Using analogous instruction sequences, the programmer can synthesize</span></div>
<div style="position:absolute;left:36.00px;top:280.67px" class="cls_006"><span class="cls_006">virtually any comparison between two registers using the various set</span></div>
<div style="position:absolute;left:36.00px;top:291.67px" class="cls_006"><span class="cls_006">instructions.</span></div>
<div style="position:absolute;left:48.02px;top:302.67px" class="cls_006"><span class="cls_006">Similarly, comparisons with immediate values can be implemented. For</span></div>
<div style="position:absolute;left:36.00px;top:313.67px" class="cls_006"><span class="cls_006">example, to compare whether a register value is less-than-or-equal-to an</span></div>
<div style="position:absolute;left:36.00px;top:324.67px" class="cls_006"><span class="cls_006">immediate:</span></div>
<div style="position:absolute;left:108.00px;top:347.67px" class="cls_028"><span class="cls_028">slti</span></div>
<div style="position:absolute;left:162.09px;top:347.67px" class="cls_028"><span class="cls_028">$at, $a, imm+1</span></div>
<div style="position:absolute;left:108.00px;top:358.00px" class="cls_028"><span class="cls_028">bne</span></div>
<div style="position:absolute;left:162.06px;top:358.00px" class="cls_028"><span class="cls_028">$at, $0, target</span></div>
<div style="position:absolute;left:252.41px;top:358.00px" class="cls_028"><span class="cls_028"># branch to target of a &lt;= imm</span></div>
<div style="position:absolute;left:48.02px;top:378.67px" class="cls_006"><span class="cls_006">Of course, if the immediate value is large, then the programmer must</span></div>
<div style="position:absolute;left:36.00px;top:389.67px" class="cls_006"><span class="cls_006">first build it into a register as described earlier in this chapter, and then</span></div>
<div style="position:absolute;left:36.00px;top:400.67px" class="cls_006"><span class="cls_006">perform the comparison.</span></div>
<div style="position:absolute;left:48.02px;top:411.67px" class="cls_006"><span class="cls_006">Many of these common operations are already built into the synthetic</span></div>
<div style="position:absolute;left:36.00px;top:422.67px" class="cls_006"><span class="cls_006">instruction set supported by a given toolchain assembler package. The</span></div>
<div style="position:absolute;left:36.00px;top:433.67px" class="cls_006"><span class="cls_006">programmer is advised to consult the reference manual.</span></div>
<div style="position:absolute;left:36.00px;top:454.67px" class="cls_006"><span class="cls_006">Carry, borrow, overflow, and multi-precision math</span></div>
<div style="position:absolute;left:48.02px;top:465.67px" class="cls_006"><span class="cls_006">The MIPS-1 ISA does not directly support a carry bit. Instead, the effects</span></div>
<div style="position:absolute;left:36.00px;top:476.67px" class="cls_006"><span class="cls_006">of a carry bit can be synthesized when needed using the “set” constructs.</span></div>
<div style="position:absolute;left:36.00px;top:487.67px" class="cls_006"><span class="cls_006">This enables the programmer to implement tests for overflow, multi-</span></div>
<div style="position:absolute;left:36.00px;top:498.67px" class="cls_006"><span class="cls_006">precision math, and add-with-carry operations.</span></div>
<div style="position:absolute;left:48.02px;top:509.67px" class="cls_006"><span class="cls_006">For example, these constructs enable the programmer to perform tests</span></div>
<div style="position:absolute;left:36.00px;top:520.67px" class="cls_006"><span class="cls_006">to determine whether an arithmetic operation resulted in a carry (or</span></div>
<div style="position:absolute;left:36.00px;top:531.67px" class="cls_006"><span class="cls_006">borrow).</span></div>
<div style="position:absolute;left:48.02px;top:542.67px" class="cls_006"><span class="cls_006">For add sequences, there are two cases to consider:</span></div>
<div style="position:absolute;left:97.15px;top:576.00px" class="cls_020"><span class="cls_020">Case</span></div>
<div style="position:absolute;left:238.08px;top:576.00px" class="cls_020"><span class="cls_020">Instruction Sequence</span></div>
<div style="position:absolute;left:40.00px;top:595.00px" class="cls_020"><span class="cls_020">No possible carry from</span></div>
<div style="position:absolute;left:184.00px;top:595.00px" class="cls_027"><span class="cls_027">addu temp, A, B</span></div>
<div style="position:absolute;left:40.00px;top:605.00px" class="cls_020"><span class="cls_020">previous operation</span></div>
<div style="position:absolute;left:184.00px;top:605.00px" class="cls_027"><span class="cls_027">sltu carryout, temp, B # carryout from A + B</span></div>
<div style="position:absolute;left:40.00px;top:622.00px" class="cls_020"><span class="cls_020">Carry-in from previous</span></div>
<div style="position:absolute;left:184.00px;top:622.00px" class="cls_027"><span class="cls_027">not temp, A</span></div>
<div style="position:absolute;left:40.00px;top:632.00px" class="cls_020"><span class="cls_020">operation</span></div>
<div style="position:absolute;left:184.00px;top:632.00px" class="cls_027"><span class="cls_027">sltu carryout, B, temp</span></div>
<div style="position:absolute;left:184.00px;top:642.00px" class="cls_027"><span class="cls_027">xor carryout, 1 # carry-out from A+B+1</span></div>
<div style="position:absolute;left:152.47px;top:661.00px" class="cls_020"><span class="cls_020">Table 16.2.  Add-with-carry</span></div>
<div style="position:absolute;left:48.02px;top:676.67px" class="cls_006"><span class="cls_006">Subtract with borrow works analogously:</span></div>
<div style="position:absolute;left:289.78px;top:755.33px" class="cls_002"><span class="cls_002">16-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:169222px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLY LANGUAGE PROGRAMMING TIPS</span></div>
<div style="position:absolute;left:520.79px;top:28.00px" class="cls_002"><span class="cls_002">CHAPTER 16</span></div>
<div style="position:absolute;left:277.15px;top:73.00px" class="cls_020"><span class="cls_020">Case</span></div>
<div style="position:absolute;left:418.08px;top:73.00px" class="cls_020"><span class="cls_020">Instruction Sequence</span></div>
<div style="position:absolute;left:220.00px;top:92.00px" class="cls_020"><span class="cls_020">No borrow-in</span></div>
<div style="position:absolute;left:364.00px;top:92.00px" class="cls_027"><span class="cls_027">sltu borrow, B, A #borrow-out from A-B</span></div>
<div style="position:absolute;left:220.00px;top:109.00px" class="cls_020"><span class="cls_020">Borrow-in from previous</span></div>
<div style="position:absolute;left:364.00px;top:109.00px" class="cls_027"><span class="cls_027">sltu borrow, B, A</span></div>
<div style="position:absolute;left:364.00px;top:119.00px" class="cls_027"><span class="cls_027">xor borrow, 1 #borrow out from A-B-1</span></div>
<div style="position:absolute;left:295.94px;top:138.00px" class="cls_020"><span class="cls_020">Table H.3.  Subtract-with-borrow operation</span></div>
<div style="position:absolute;left:228.02px;top:164.67px" class="cls_006"><span class="cls_006">Testing for overflow also uses the set instructions, coupled with two</span></div>
<div style="position:absolute;left:216.00px;top:175.67px" class="cls_006"><span class="cls_006">basic rules:</span></div>
<div style="position:absolute;left:228.02px;top:189.67px" class="cls_006"><span class="cls_006">• An addition operation has overflowed if:</span></div>
<div style="position:absolute;left:239.97px;top:200.67px" class="cls_006"><span class="cls_006">— the sign of both operands is the same</span></div>
<div style="position:absolute;left:239.97px;top:211.67px" class="cls_006"><span class="cls_006">— the sign of the result differs from the sign of the operands</span></div>
<div style="position:absolute;left:228.02px;top:236.67px" class="cls_006"><span class="cls_006">• A subtraction has overflowed if</span></div>
<div style="position:absolute;left:239.97px;top:247.67px" class="cls_006"><span class="cls_006">— the signs of the two operands are different</span></div>
<div style="position:absolute;left:239.97px;top:258.67px" class="cls_006"><span class="cls_006">— the sign of the result is different from the sign of the minuend</span></div>
<div style="position:absolute;left:228.02px;top:280.67px" class="cls_006"><span class="cls_006">Testing for these conditions is a simple programming exercise. For</span></div>
<div style="position:absolute;left:216.00px;top:291.67px" class="cls_006"><span class="cls_006">example, testing for overflow in signed addition:</span></div>
<div style="position:absolute;left:216.00px;top:314.00px" class="cls_028"><span class="cls_028">/* branch to Label if t1+t2 overflows</span></div>
<div style="position:absolute;left:540.86px;top:314.00px" class="cls_028"><span class="cls_028">*/</span></div>
<div style="position:absolute;left:288.00px;top:324.00px" class="cls_028"><span class="cls_028">addu</span></div>
<div style="position:absolute;left:360.09px;top:324.00px" class="cls_028"><span class="cls_028">t0, t1, t2</span></div>
<div style="position:absolute;left:432.33px;top:324.00px" class="cls_028"><span class="cls_028">/* result in t0*/</span></div>
<div style="position:absolute;left:288.00px;top:334.00px" class="cls_028"><span class="cls_028">xor</span></div>
<div style="position:absolute;left:360.07px;top:334.00px" class="cls_028"><span class="cls_028">t3, t1, t2</span></div>
<div style="position:absolute;left:432.30px;top:334.00px" class="cls_028"><span class="cls_028">/* check signs of operands*/</span></div>
<div style="position:absolute;left:288.00px;top:344.00px" class="cls_028"><span class="cls_028">bltz</span></div>
<div style="position:absolute;left:360.09px;top:344.00px" class="cls_028"><span class="cls_028">t3, 1f</span></div>
<div style="position:absolute;left:432.23px;top:344.00px" class="cls_028"><span class="cls_028">/* then no overflow*/</span></div>
<div style="position:absolute;left:288.00px;top:363.99px" class="cls_028"><span class="cls_028">xor</span></div>
<div style="position:absolute;left:360.07px;top:363.99px" class="cls_028"><span class="cls_028">t3, t0, t1</span></div>
<div style="position:absolute;left:432.30px;top:363.99px" class="cls_028"><span class="cls_028">/* check sign of result */</span></div>
<div style="position:absolute;left:288.00px;top:373.99px" class="cls_028"><span class="cls_028">bltz</span></div>
<div style="position:absolute;left:360.09px;top:373.99px" class="cls_028"><span class="cls_028">t3, Label</span></div>
<div style="position:absolute;left:432.30px;top:373.99px" class="cls_028"><span class="cls_028">/* overflow...*/</span></div>
<div style="position:absolute;left:216.00px;top:393.99px" class="cls_028"><span class="cls_028">1f:</span></div>
<div style="position:absolute;left:288.07px;top:393.99px" class="cls_028"><span class="cls_028">/* no overflow */</span></div>
<div style="position:absolute;left:303.54px;top:755.33px" class="cls_002"><span class="cls_002">16-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:170024px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">MACHINE INSTRUCTIONS</span></div>
<div style="position:absolute;left:486.77px;top:42.00px" class="cls_015"><span class="cls_015">APPENDIX A</span></div>
<div style="position:absolute;left:222.89px;top:56.33px" class="cls_005"><span class="cls_005">REFERENCE</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:216.00px;top:113.00px" class="cls_015"><span class="cls_015">CPU Instruction Overview</span></div>
<div style="position:absolute;left:228.02px;top:126.67px" class="cls_006"><span class="cls_006">This appendix provides a detailed description of the operation of each</span></div>
<div style="position:absolute;left:216.00px;top:137.67px" class="cls_006"><span class="cls_006">user mode CPU Instruction for the MIPS I architecture.  The instructions</span></div>
<div style="position:absolute;left:216.00px;top:148.67px" class="cls_006"><span class="cls_006">are listed in alphabetical order.</span></div>
<div style="position:absolute;left:228.02px;top:159.67px" class="cls_006"><span class="cls_006">Exceptions that may occur due to the execution of each instruction are</span></div>
<div style="position:absolute;left:216.00px;top:170.67px" class="cls_006"><span class="cls_006">listed after the description of each instruction.  Descriptions of the</span></div>
<div style="position:absolute;left:216.00px;top:181.67px" class="cls_006"><span class="cls_006">immediate cause and manner of handling exceptions are omitted from the</span></div>
<div style="position:absolute;left:216.00px;top:192.67px" class="cls_006"><span class="cls_006">instruction descriptions in this appendix.</span></div>
<div style="position:absolute;left:216.00px;top:215.00px" class="cls_015"><span class="cls_015">Instruction Classes</span></div>
<div style="position:absolute;left:228.02px;top:228.67px" class="cls_006"><span class="cls_006">CPU instructions are divided into the following classes:</span></div>
<div style="position:absolute;left:228.02px;top:242.67px" class="cls_006"><span class="cls_006">• Load and Store instructions move data between memory and general</span></div>
<div style="position:absolute;left:239.97px;top:253.67px" class="cls_006"><span class="cls_006">registers.  They are all I-type instructions, since the only addressing</span></div>
<div style="position:absolute;left:239.97px;top:264.67px" class="cls_006"><span class="cls_006">mode supported for the general registers is </span><span class="cls_008">base register + 16-bit</span></div>
<div style="position:absolute;left:239.98px;top:275.67px" class="cls_008"><span class="cls_008">immediate offset</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:228.03px;top:289.67px" class="cls_006"><span class="cls_006">• Computational instructions perform arithmetic, logical and shift</span></div>
<div style="position:absolute;left:239.98px;top:300.67px" class="cls_006"><span class="cls_006">operations on values in registers.  They occur in both R-type (both</span></div>
<div style="position:absolute;left:239.98px;top:311.67px" class="cls_006"><span class="cls_006">operands are registers) and I-type (one operand is a 16-bit immediate)</span></div>
<div style="position:absolute;left:239.98px;top:322.67px" class="cls_006"><span class="cls_006">formats.</span></div>
<div style="position:absolute;left:228.03px;top:336.67px" class="cls_006"><span class="cls_006">• Jump and Branch instructions change the control flow of a program.</span></div>
<div style="position:absolute;left:239.97px;top:347.67px" class="cls_006"><span class="cls_006">Jumps are always made to absolute 26-bit word addresses (J-type</span></div>
<div style="position:absolute;left:239.97px;top:358.67px" class="cls_006"><span class="cls_006">format), or register addresses (R-type), for returns and dispatches.</span></div>
<div style="position:absolute;left:239.97px;top:369.67px" class="cls_006"><span class="cls_006">Branches have 16-bit offsets relative to the program counter (I-type).</span></div>
<div style="position:absolute;left:239.98px;top:380.67px" class="cls_006"><span class="cls_006">Jump and Link instructions save their return address in register </span><span class="cls_008">31</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:228.03px;top:394.67px" class="cls_006"><span class="cls_006">• Coprocessor instructions perform operations in the coprocessors.</span></div>
<div style="position:absolute;left:239.98px;top:405.67px" class="cls_006"><span class="cls_006">Coprocessors have up to two register sets separate from the CPU.</span></div>
<div style="position:absolute;left:239.98px;top:416.67px" class="cls_006"><span class="cls_006">Coprocessor  loads  and  stores,  similar  to  those  for  the  general</span></div>
<div style="position:absolute;left:239.98px;top:427.67px" class="cls_006"><span class="cls_006">registers,   are   defined   for   the   coprocessors   and   are   I-type.</span></div>
<div style="position:absolute;left:239.98px;top:438.67px" class="cls_006"><span class="cls_006">Coprocessor computational instructions have coprocessor-dependent</span></div>
<div style="position:absolute;left:239.98px;top:449.67px" class="cls_006"><span class="cls_006">formats.</span></div>
<div style="position:absolute;left:228.02px;top:463.67px" class="cls_006"><span class="cls_006">• Special instructions perform a variety of tasks, including movement</span></div>
<div style="position:absolute;left:239.97px;top:474.67px" class="cls_006"><span class="cls_006">of data between special and general registers, trap, and breakpoint.</span></div>
<div style="position:absolute;left:239.97px;top:485.67px" class="cls_006"><span class="cls_006">They are always R-type.</span></div>
<div style="position:absolute;left:298.28px;top:754.68px" class="cls_002"><span class="cls_002">A-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:170826px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.90px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:36.00px;top:50.00px" class="cls_015"><span class="cls_015">Instruction Formats</span></div>
<div style="position:absolute;left:48.02px;top:63.67px" class="cls_006"><span class="cls_006">Every CPU instruction consists of a single word (32 bits) aligned on a</span></div>
<div style="position:absolute;left:36.00px;top:74.67px" class="cls_006"><span class="cls_006">word boundary and the major instruction formats are shown in Figure</span></div>
<div style="position:absolute;left:36.00px;top:85.67px" class="cls_006"><span class="cls_006">A.1:.</span></div>
<div style="position:absolute;left:82.64px;top:109.45px" class="cls_053"><span class="cls_053">I-Type (Immediate)</span></div>
<div style="position:absolute;left:100.28px;top:124.86px" class="cls_054"><span class="cls_054">31</span></div>
<div style="position:absolute;left:136.28px;top:124.86px" class="cls_054"><span class="cls_054">26 25</span></div>
<div style="position:absolute;left:172.28px;top:124.86px" class="cls_054"><span class="cls_054">21 20</span></div>
<div style="position:absolute;left:208.13px;top:124.86px" class="cls_054"><span class="cls_054">16</span></div>
<div style="position:absolute;left:222.53px;top:124.86px" class="cls_054"><span class="cls_054">15</span></div>
<div style="position:absolute;left:335.00px;top:124.86px" class="cls_054"><span class="cls_054">0</span></div>
<div style="position:absolute;left:119.79px;top:138.25px" class="cls_053"><span class="cls_053">op</span></div>
<div style="position:absolute;left:161.33px;top:137.75px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:196.97px;top:137.75px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:233.84px;top:137.75px" class="cls_053"><span class="cls_053">immediate</span></div>
<div style="position:absolute;left:82.64px;top:164.53px" class="cls_053"><span class="cls_053">J-Type (Jump)</span></div>
<div style="position:absolute;left:100.28px;top:180.14px" class="cls_054"><span class="cls_054">31</span></div>
<div style="position:absolute;left:136.28px;top:180.14px" class="cls_054"><span class="cls_054">26</span></div>
<div style="position:absolute;left:150.68px;top:180.14px" class="cls_054"><span class="cls_054">25</span></div>
<div style="position:absolute;left:335.00px;top:180.14px" class="cls_054"><span class="cls_054">0</span></div>
<div style="position:absolute;left:121.23px;top:192.90px" class="cls_053"><span class="cls_053">op</span></div>
<div style="position:absolute;left:198.06px;top:192.90px" class="cls_053"><span class="cls_053">target</span></div>
<div style="position:absolute;left:87.39px;top:219.61px" class="cls_053"><span class="cls_053">R-Type (Register)</span></div>
<div style="position:absolute;left:100.28px;top:235.22px" class="cls_054"><span class="cls_054">31</span></div>
<div style="position:absolute;left:136.28px;top:235.22px" class="cls_054"><span class="cls_054">26 25</span></div>
<div style="position:absolute;left:172.28px;top:235.22px" class="cls_054"><span class="cls_054">21 20</span></div>
<div style="position:absolute;left:208.13px;top:235.22px" class="cls_054"><span class="cls_054">16</span></div>
<div style="position:absolute;left:222.53px;top:235.22px" class="cls_054"><span class="cls_054">15</span></div>
<div style="position:absolute;left:249.68px;top:235.22px" class="cls_054"><span class="cls_054">1110</span></div>
<div style="position:absolute;left:290.36px;top:235.80px" class="cls_054"><span class="cls_054">6 5</span></div>
<div style="position:absolute;left:335.00px;top:235.22px" class="cls_054"><span class="cls_054">0</span></div>
<div style="position:absolute;left:121.95px;top:247.58px" class="cls_053"><span class="cls_053">op</span></div>
<div style="position:absolute;left:162.05px;top:248.41px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:198.41px;top:248.41px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:236.79px;top:248.41px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:264.08px;top:247.55px" class="cls_053"><span class="cls_053">shamt</span></div>
<div style="position:absolute;left:302.45px;top:247.55px" class="cls_053"><span class="cls_053">funct</span></div>
<div style="position:absolute;left:84.00px;top:293.67px" class="cls_055"><span class="cls_055">op</span></div>
<div style="position:absolute;left:141.84px;top:293.67px" class="cls_055"><span class="cls_055">6-bit operation code</span></div>
<div style="position:absolute;left:84.00px;top:309.67px" class="cls_055"><span class="cls_055">rs</span></div>
<div style="position:absolute;left:141.84px;top:309.67px" class="cls_055"><span class="cls_055">5-bit source register specifier</span></div>
<div style="position:absolute;left:84.00px;top:325.67px" class="cls_055"><span class="cls_055">rt</span></div>
<div style="position:absolute;left:141.84px;top:325.67px" class="cls_055"><span class="cls_055">5-bit target (source/destination) or branch condition</span></div>
<div style="position:absolute;left:141.83px;top:341.67px" class="cls_055"><span class="cls_055">16-bit immediate, branch displacement or address</span></div>
<div style="position:absolute;left:84.00px;top:347.67px" class="cls_055"><span class="cls_055">immediate</span></div>
<div style="position:absolute;left:141.83px;top:353.67px" class="cls_055"><span class="cls_055">displacement</span></div>
<div style="position:absolute;left:84.00px;top:369.67px" class="cls_055"><span class="cls_055">target</span></div>
<div style="position:absolute;left:141.84px;top:369.67px" class="cls_055"><span class="cls_055">26-bit jump target address</span></div>
<div style="position:absolute;left:84.00px;top:385.67px" class="cls_055"><span class="cls_055">rd</span></div>
<div style="position:absolute;left:141.84px;top:385.67px" class="cls_055"><span class="cls_055">5-bit destination register specifier</span></div>
<div style="position:absolute;left:84.00px;top:401.67px" class="cls_055"><span class="cls_055">shamt</span></div>
<div style="position:absolute;left:141.84px;top:401.67px" class="cls_055"><span class="cls_055">5-bit shift amount</span></div>
<div style="position:absolute;left:84.00px;top:417.67px" class="cls_055"><span class="cls_055">funct</span></div>
<div style="position:absolute;left:141.84px;top:417.67px" class="cls_055"><span class="cls_055">6-bit function field</span></div>
<div style="position:absolute;left:130.45px;top:440.77px" class="cls_020"><span class="cls_020">Figure A.1: CPU Instruction Formats</span></div>
<div style="position:absolute;left:36.00px;top:462.77px" class="cls_015"><span class="cls_015">Instruction Notation Conventions</span></div>
<div style="position:absolute;left:48.02px;top:476.44px" class="cls_006"><span class="cls_006">In this appendix, all variable subfields in an instruction format (such as</span></div>
<div style="position:absolute;left:36.00px;top:487.44px" class="cls_008"><span class="cls_008">rs, rt, immediate</span><span class="cls_006">, etc.) are shown in lowercase names.</span></div>
<div style="position:absolute;left:48.02px;top:498.44px" class="cls_006"><span class="cls_006">For the sake of clarity, an alias is sometimes used for a variable subfield</span></div>
<div style="position:absolute;left:36.00px;top:509.44px" class="cls_006"><span class="cls_006">in the formats of specific instructions.  For example,</span><span class="cls_008">rs = base </span><span class="cls_006">is used in the</span></div>
<div style="position:absolute;left:36.00px;top:520.44px" class="cls_006"><span class="cls_006">format for load and store instructions.  Such an alias is always lower case,</span></div>
<div style="position:absolute;left:36.00px;top:531.44px" class="cls_006"><span class="cls_006">since it refers to a variable subfield.</span></div>
<div style="position:absolute;left:48.02px;top:542.44px" class="cls_006"><span class="cls_006">In  the  instruction  descriptions  that  follow,  the </span><span class="cls_008"> Operation </span><span class="cls_006"> section</span></div>
<div style="position:absolute;left:36.00px;top:553.44px" class="cls_006"><span class="cls_006">describes the operation performed by each instruction using a high-level</span></div>
<div style="position:absolute;left:36.00px;top:564.44px" class="cls_006"><span class="cls_006">language notation.</span></div>
<div style="position:absolute;left:48.02px;top:575.44px" class="cls_006"><span class="cls_006">Special symbols used in the notation are described below.</span></div>
<div style="position:absolute;left:291.03px;top:755.33px" class="cls_002"><span class="cls_002">A-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:171628px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:146.31px;top:68.97px" class="cls_056"><span class="cls_056">Symbol</span></div>
<div style="position:absolute;left:333.48px;top:68.97px" class="cls_056"><span class="cls_056">Meaning</span></div>
<div style="position:absolute;left:158.72px;top:85.39px" class="cls_003"><span class="cls_003">←</span></div>
<div style="position:absolute;left:207.07px;top:84.38px" class="cls_054"><span class="cls_054">Assignment.</span></div>
<div style="position:absolute;left:161.32px;top:100.79px" class="cls_054"><span class="cls_054">||</span></div>
<div style="position:absolute;left:207.07px;top:98.70px" class="cls_054"><span class="cls_054">Bit string concatenation.</span></div>
<div style="position:absolute;left:153.36px;top:111.97px" class="cls_054"><span class="cls_054">x</span><span class="cls_057"><sup>y</sup></span></div>
<div style="position:absolute;left:207.07px;top:112.41px" class="cls_054"><span class="cls_054">Replication of bit value x into a y-bit string. Note: x is always a single-bit value.</span></div>
<div style="position:absolute;left:149.54px;top:130.98px" class="cls_054"><span class="cls_054">x</span><span class="cls_057"><sub>y..z</sub></span></div>
<div style="position:absolute;left:207.00px;top:128.18px" class="cls_054"><span class="cls_054">Selection of bits y through z of bit string x. Little-endian bit notation is always</span></div>
<div style="position:absolute;left:207.00px;top:138.18px" class="cls_054"><span class="cls_054">used. If y is less than z, this expression is an empty (zero length) bit string.</span></div>
<div style="position:absolute;left:151.11px;top:154.94px" class="cls_054"><span class="cls_054">+</span></div>
<div style="position:absolute;left:163.87px;top:154.94px" class="cls_054"><span class="cls_054">-</span></div>
<div style="position:absolute;left:206.40px;top:155.51px" class="cls_054"><span class="cls_054">2’s complement or floating-point arithmetic:  addition, subtraction, multiplication.</span></div>
<div style="position:absolute;left:172.23px;top:157.67px" class="cls_054"><span class="cls_054">*</span></div>
<div style="position:absolute;left:157.91px;top:169.26px" class="cls_054"><span class="cls_054">div</span></div>
<div style="position:absolute;left:207.07px;top:169.77px" class="cls_054"><span class="cls_054">2’s complement integer division.</span></div>
<div style="position:absolute;left:154.90px;top:184.70px" class="cls_054"><span class="cls_054">mod</span></div>
<div style="position:absolute;left:207.07px;top:184.10px" class="cls_054"><span class="cls_054">2’s complement modulo.</span></div>
<div style="position:absolute;left:162.41px;top:198.51px" class="cls_054"><span class="cls_054">/</span></div>
<div style="position:absolute;left:207.07px;top:198.35px" class="cls_054"><span class="cls_054">Floating-point division.</span></div>
<div style="position:absolute;left:161.03px;top:212.07px" class="cls_054"><span class="cls_054">&lt;</span></div>
<div style="position:absolute;left:207.07px;top:212.68px" class="cls_054"><span class="cls_054">2’s complement less than comparison.</span></div>
<div style="position:absolute;left:157.16px;top:227.58px" class="cls_054"><span class="cls_054">nor</span></div>
<div style="position:absolute;left:208.01px;top:226.94px" class="cls_054"><span class="cls_054">Bit-wise logical NOR.</span></div>
<div style="position:absolute;left:157.41px;top:240.90px" class="cls_054"><span class="cls_054">xor</span></div>
<div style="position:absolute;left:207.07px;top:241.26px" class="cls_054"><span class="cls_054">Bit-wise logical XOR.</span></div>
<div style="position:absolute;left:156.15px;top:255.23px" class="cls_054"><span class="cls_054">and</span></div>
<div style="position:absolute;left:207.07px;top:255.52px" class="cls_054"><span class="cls_054">Bit-wise logical AND.</span></div>
<div style="position:absolute;left:159.66px;top:269.56px" class="cls_054"><span class="cls_054">or</span></div>
<div style="position:absolute;left:208.01px;top:269.85px" class="cls_054"><span class="cls_054">Bit-wise logical OR.</span></div>
<div style="position:absolute;left:147.90px;top:283.96px" class="cls_054"><span class="cls_054">GPRlen</span></div>
<div style="position:absolute;left:208.01px;top:284.10px" class="cls_054"><span class="cls_054">The length, in bits (32for MIPS-I), of the CPU General Purpose Registers)</span></div>
<div style="position:absolute;left:148.71px;top:300.86px" class="cls_054"><span class="cls_054">GPR[x]</span></div>
<div style="position:absolute;left:207.00px;top:298.05px" class="cls_054"><span class="cls_054">General-Register x.  The content of GPR[0] is always zero.  Attempts to alter</span></div>
<div style="position:absolute;left:207.00px;top:309.05px" class="cls_054"><span class="cls_054">the content of GPR[0] have no effect.</span></div>
<div style="position:absolute;left:147.26px;top:320.61px" class="cls_054"><span class="cls_054">FCC[cc]</span></div>
<div style="position:absolute;left:208.16px;top:322.84px" class="cls_054"><span class="cls_054">Floating-Point condition code cc.   FCC[0] has the same value as COC[1].</span></div>
<div style="position:absolute;left:134.71px;top:336.76px" class="cls_054"><span class="cls_054">CPR[z,x]</span></div>
<div style="position:absolute;left:208.01px;top:336.90px" class="cls_054"><span class="cls_054">Coprocessor unit z, general register x.</span></div>
<div style="position:absolute;left:134.71px;top:353.90px" class="cls_054"><span class="cls_054">CCR[z,x]</span></div>
<div style="position:absolute;left:208.01px;top:351.66px" class="cls_054"><span class="cls_054">Coprocessor unit z, control register x.</span></div>
<div style="position:absolute;left:134.78px;top:367.58px" class="cls_054"><span class="cls_054">COC[z]</span></div>
<div style="position:absolute;left:207.36px;top:367.58px" class="cls_054"><span class="cls_054">Coprocessor unit z condition signal.</span></div>
<div style="position:absolute;left:134.79px;top:379.38px" class="cls_054"><span class="cls_054">BigEndianMem</span></div>
<div style="position:absolute;left:207.38px;top:378.38px" class="cls_054"><span class="cls_054">Big-endian mode as configured at reset (0 </span><span class="cls_003">→</span><span class="cls_054"> Little, 1</span><span class="cls_003"> →</span><span class="cls_054"> Big). Specifies the</span></div>
<div style="position:absolute;left:206.79px;top:389.38px" class="cls_054"><span class="cls_054">endianness of the memory interface (see LoadMemory and StoreMemory),</span></div>
<div style="position:absolute;left:206.79px;top:399.38px" class="cls_054"><span class="cls_054">and the endianness of Kernel and Supervisor mode execution.</span></div>
<div style="position:absolute;left:134.79px;top:412.38px" class="cls_054"><span class="cls_054">ReverseEndian</span></div>
<div style="position:absolute;left:207.38px;top:412.38px" class="cls_054"><span class="cls_054">Signal to reverse the endianness of load and store instructions. This feature is</span></div>
<div style="position:absolute;left:206.79px;top:422.38px" class="cls_054"><span class="cls_054">available in User mode only, and is effected by setting the RE bit of the Status</span></div>
<div style="position:absolute;left:206.78px;top:431.38px" class="cls_054"><span class="cls_054">register. Thus, ReverseEndian may be computed as (SR</span><span class="cls_057"><sub>25 </sub></span><span class="cls_054">and User mode</span><span class="cls_058">).</span></div>
<div style="position:absolute;left:134.78px;top:445.38px" class="cls_054"><span class="cls_054">BigEndianCPU</span></div>
<div style="position:absolute;left:207.38px;top:444.38px" class="cls_054"><span class="cls_054">The endianness for load and store instructions (0 </span><span class="cls_003">→</span><span class="cls_054"> Little, 1 </span><span class="cls_003">→</span><span class="cls_054"> Big). In User</span></div>
<div style="position:absolute;left:206.79px;top:454.38px" class="cls_054"><span class="cls_054">mode, this endianness may be reversed by setting SR</span><span class="cls_057"><sub>25</sub></span><span class="cls_058">. </span><span class="cls_054">Thus, BigEndianCPU</span></div>
<div style="position:absolute;left:206.78px;top:465.38px" class="cls_054"><span class="cls_054">may be computed as BigEndianMem XOR ReverseEndian.</span></div>
<div style="position:absolute;left:134.78px;top:478.38px" class="cls_054"><span class="cls_054">LLbit</span></div>
<div style="position:absolute;left:207.37px;top:478.38px" class="cls_054"><span class="cls_054">Only valid for MIPS-II instructions.</span></div>
<div style="position:absolute;left:134.78px;top:504.38px" class="cls_054"><span class="cls_054">T+i:</span></div>
<div style="position:absolute;left:207.36px;top:504.38px" class="cls_054"><span class="cls_054">Indicates the time steps between operations. Each of the statements within a</span></div>
<div style="position:absolute;left:206.78px;top:514.38px" class="cls_054"><span class="cls_054">time step are defined to be executed in sequential order (as modified by con-</span></div>
<div style="position:absolute;left:206.78px;top:524.38px" class="cls_054"><span class="cls_054">ditional and loop constructs). Operations which are marked T+i: are executed</span></div>
<div style="position:absolute;left:206.78px;top:534.38px" class="cls_054"><span class="cls_054">at instruction cycle i relative to the start of execution of the instruction. Thus,</span></div>
<div style="position:absolute;left:206.79px;top:543.38px" class="cls_054"><span class="cls_054">an instruction which starts at time j executes operations marked T+i</span><span class="cls_053">:</span><span class="cls_054"> at time</span></div>
<div style="position:absolute;left:206.79px;top:554.38px" class="cls_054"><span class="cls_054">i</span></div>
<div style="position:absolute;left:211.80px;top:554.38px" class="cls_054"><span class="cls_054">+ j. The interpretation of the order of execution between two instructions or</span></div>
<div style="position:absolute;left:206.79px;top:564.38px" class="cls_054"><span class="cls_054">two operations which execute at the same time should be pessimistic; the or-</span></div>
<div style="position:absolute;left:206.79px;top:574.38px" class="cls_054"><span class="cls_054">der is not defined.</span></div>
<div style="position:absolute;left:267.47px;top:587.38px" class="cls_020"><span class="cls_020">Table A.4: CPU Instruction Operation Notations</span></div>
<div style="position:absolute;left:216.00px;top:625.00px" class="cls_059"><span class="cls_059">Instruction Notation Examples</span></div>
<div style="position:absolute;left:228.02px;top:646.67px" class="cls_006"><span class="cls_006">The  following  examples  illustrate  the  application  of  some  of  the</span></div>
<div style="position:absolute;left:216.00px;top:657.67px" class="cls_006"><span class="cls_006">instruction notation conventions:</span></div>
<div style="position:absolute;left:304.78px;top:755.33px" class="cls_002"><span class="cls_002">A-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:172430px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:96.19px;top:72.07px" class="cls_053"><span class="cls_053">Example #1:</span></div>
<div style="position:absolute;left:120.24px;top:95.33px" class="cls_053"><span class="cls_053">GPR[rt]</span></div>
<div style="position:absolute;left:163.44px;top:94.68px" class="cls_003"><span class="cls_003">←</span></div>
<div style="position:absolute;left:187.42px;top:92.72px" class="cls_053"><span class="cls_053">immediate || 0</span><span class="cls_061"><sup>16</sup></span></div>
<div style="position:absolute;left:96.19px;top:121.02px" class="cls_054"><span class="cls_054">Sixteen zero bits are concatenated with an immediate</span></div>
<div style="position:absolute;left:96.19px;top:132.54px" class="cls_054"><span class="cls_054">value (typically 16 bits), and the 32-bit string (with the lower</span></div>
<div style="position:absolute;left:96.19px;top:144.06px" class="cls_054"><span class="cls_054">16 bits set to zero) is assigned to General-Purpose Register rt.</span></div>
<div style="position:absolute;left:96.19px;top:182.45px" class="cls_053"><span class="cls_053">Example #2:</span></div>
<div style="position:absolute;left:129.82px;top:202.38px" class="cls_053"><span class="cls_053">(immediate</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16</sup></span><span class="cls_053"> || immediate</span><span class="cls_061"><sub>15...0</sub></span></div>
<div style="position:absolute;left:101.02px;top:230.46px" class="cls_054"><span class="cls_054">Bit 15 (the sign bit) of an immediate value is extended for</span></div>
<div style="position:absolute;left:101.02px;top:241.98px" class="cls_054"><span class="cls_054">16 bit positions, and the result is concatenated with bits 15</span></div>
<div style="position:absolute;left:101.02px;top:253.50px" class="cls_054"><span class="cls_054">through 0 of the immediate value to form a 32-bit sign</span></div>
<div style="position:absolute;left:101.02px;top:265.02px" class="cls_054"><span class="cls_054">extended value.</span></div>
<div style="position:absolute;left:36.00px;top:292.01px" class="cls_015"><span class="cls_015">Load and Store Instructions</span></div>
<div style="position:absolute;left:48.02px;top:305.67px" class="cls_006"><span class="cls_006">In  R30xx family  processors all loads are implemented with a delay of</span></div>
<div style="position:absolute;left:36.00px;top:316.67px" class="cls_006"><span class="cls_006">one instruction.  The instruction immediately following a load may not use</span></div>
<div style="position:absolute;left:36.00px;top:327.67px" class="cls_006"><span class="cls_006">the destination register of the load instruction; at least one instruction</span></div>
<div style="position:absolute;left:36.00px;top:338.67px" class="cls_006"><span class="cls_006">must come between load and use.  The hardware does not enforce this</span></div>
<div style="position:absolute;left:36.00px;top:349.67px" class="cls_006"><span class="cls_006">restriction nor detect a failure to follow it.  One exception to the load delay</span></div>
<div style="position:absolute;left:36.00px;top:360.67px" class="cls_006"><span class="cls_006">is that Load Word Right and Load Word Left  may specify a destination</span></div>
<div style="position:absolute;left:36.00px;top:371.67px" class="cls_006"><span class="cls_006">register that is the same register used as the destination of an immediately</span></div>
<div style="position:absolute;left:36.00px;top:382.67px" class="cls_006"><span class="cls_006">preceding  load.    This  allows  a  LWL,  LWR  pair  without  intervening</span></div>
<div style="position:absolute;left:36.00px;top:393.67px" class="cls_006"><span class="cls_006">instructions.   The   regular   I-type   load   and   store   instructions   use</span></div>
<div style="position:absolute;left:36.00px;top:404.67px" class="cls_008"><span class="cls_008">base_register</span><span class="cls_006">+</span><span class="cls_008">offset </span><span class="cls_006"> addressing.  In the load and store descriptions, the</span></div>
<div style="position:absolute;left:36.01px;top:415.67px" class="cls_006"><span class="cls_006">functions listed below are used to summarize the handling of virtual</span></div>
<div style="position:absolute;left:36.01px;top:426.67px" class="cls_006"><span class="cls_006">addresses and physical memory.s</span></div>
<div style="position:absolute;left:83.30px;top:446.67px" class="cls_060"><span class="cls_060">Function</span></div>
<div style="position:absolute;left:282.97px;top:446.67px" class="cls_060"><span class="cls_060">Meaning</span></div>
<div style="position:absolute;left:176.13px;top:462.67px" class="cls_055"><span class="cls_055">Determines the physical address given the virtual address.</span></div>
<div style="position:absolute;left:41.00px;top:474.67px" class="cls_055"><span class="cls_055">AddressTranslation</span></div>
<div style="position:absolute;left:176.13px;top:474.67px" class="cls_055"><span class="cls_055">The function fails and an exception is taken if the required</span></div>
<div style="position:absolute;left:176.13px;top:486.67px" class="cls_055"><span class="cls_055">translation is not present in the TLB (“E” parts only).</span></div>
<div style="position:absolute;left:176.13px;top:502.67px" class="cls_055"><span class="cls_055">Uses the cache and main memory to find the contents of the</span></div>
<div style="position:absolute;left:176.13px;top:514.67px" class="cls_055"><span class="cls_055">word containing the specified physical address.  The low-</span></div>
<div style="position:absolute;left:176.13px;top:526.67px" class="cls_055"><span class="cls_055">order two bits of the address and the </span><span class="cls_058">Access Type</span><span class="cls_055"> field</span></div>
<div style="position:absolute;left:41.00px;top:538.67px" class="cls_055"><span class="cls_055">LoadMemory</span></div>
<div style="position:absolute;left:176.12px;top:538.67px" class="cls_055"><span class="cls_055">indicates which of each of the four bytes within the data</span></div>
<div style="position:absolute;left:176.12px;top:550.67px" class="cls_055"><span class="cls_055">word need to be returned.  If the cache is enabled for this</span></div>
<div style="position:absolute;left:176.12px;top:562.67px" class="cls_055"><span class="cls_055">access, the entire word is returned and loaded into the</span></div>
<div style="position:absolute;left:176.12px;top:574.67px" class="cls_055"><span class="cls_055">cache.</span></div>
<div style="position:absolute;left:176.12px;top:590.67px" class="cls_055"><span class="cls_055">Uses the cache, write buffer, and main memory to store the</span></div>
<div style="position:absolute;left:176.12px;top:602.67px" class="cls_055"><span class="cls_055">word or part of word specified as data in the word</span></div>
<div style="position:absolute;left:176.12px;top:614.67px" class="cls_055"><span class="cls_055">containing the specified physical address.  The low-order</span></div>
<div style="position:absolute;left:40.99px;top:620.67px" class="cls_055"><span class="cls_055">StoreMemory</span></div>
<div style="position:absolute;left:176.12px;top:626.67px" class="cls_055"><span class="cls_055">two bits of the address and the </span><span class="cls_058">Access Type</span><span class="cls_055"> field indicates</span></div>
<div style="position:absolute;left:176.11px;top:638.67px" class="cls_055"><span class="cls_055">which of each of the four bytes within the data word should</span></div>
<div style="position:absolute;left:176.11px;top:650.67px" class="cls_055"><span class="cls_055">be stored.</span></div>
<div style="position:absolute;left:131.04px;top:667.01px" class="cls_020"><span class="cls_020">Table A.5: Load and Store Common Function</span></div>
<div style="position:absolute;left:48.03px;top:692.67px" class="cls_006"><span class="cls_006">As shown below, the </span><span class="cls_008">Access Type</span><span class="cls_006"> field indicates the size of the data item</span></div>
<div style="position:absolute;left:36.00px;top:703.67px" class="cls_006"><span class="cls_006">to be loaded or stored.  Regardless of access type or byte-numbering order</span></div>
<div style="position:absolute;left:36.00px;top:714.67px" class="cls_006"><span class="cls_006">(endianness), the address specifies the byte which has the smallest byte</span></div>
<div style="position:absolute;left:291.03px;top:755.33px" class="cls_002"><span class="cls_002">A-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:173232px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:216.00px;top:50.67px" class="cls_006"><span class="cls_006">address in the addressed field.  For a big-endian machine, this is the</span></div>
<div style="position:absolute;left:216.00px;top:61.67px" class="cls_006"><span class="cls_006">leftmost byte and contains the sign for a 2’s complement number; for a</span></div>
<div style="position:absolute;left:216.00px;top:72.67px" class="cls_006"><span class="cls_006">little-endian machine, this is the rightmost byte. Note for R30xx CPUs, the</span></div>
<div style="position:absolute;left:216.00px;top:83.67px" class="cls_006"><span class="cls_006">only sizes valid are word and smaller.s</span></div>
<div style="position:absolute;left:298.38px;top:103.67px" class="cls_060"><span class="cls_060">Access Type Mnemonic</span></div>
<div style="position:absolute;left:437.47px;top:103.67px" class="cls_060"><span class="cls_060">Value</span></div>
<div style="position:absolute;left:527.93px;top:103.67px" class="cls_060"><span class="cls_060">Meaning</span></div>
<div style="position:absolute;left:292.99px;top:119.67px" class="cls_055"><span class="cls_055">DOUBLEWORD</span></div>
<div style="position:absolute;left:448.57px;top:119.67px" class="cls_055"><span class="cls_055">7</span></div>
<div style="position:absolute;left:490.05px;top:119.67px" class="cls_055"><span class="cls_055">8 bytes (64 bits)</span></div>
<div style="position:absolute;left:292.99px;top:135.67px" class="cls_055"><span class="cls_055">SEPTIBYTE</span></div>
<div style="position:absolute;left:448.57px;top:135.67px" class="cls_055"><span class="cls_055">6</span></div>
<div style="position:absolute;left:490.05px;top:135.67px" class="cls_055"><span class="cls_055">7 bytes (56 bits)</span></div>
<div style="position:absolute;left:292.99px;top:151.67px" class="cls_055"><span class="cls_055">SEXTIBYTE</span></div>
<div style="position:absolute;left:448.57px;top:151.67px" class="cls_055"><span class="cls_055">5</span></div>
<div style="position:absolute;left:490.05px;top:151.67px" class="cls_055"><span class="cls_055">6 bytes (48 bits)</span></div>
<div style="position:absolute;left:292.99px;top:167.67px" class="cls_055"><span class="cls_055">QUINTIBYTE</span></div>
<div style="position:absolute;left:448.57px;top:167.67px" class="cls_055"><span class="cls_055">4</span></div>
<div style="position:absolute;left:490.05px;top:167.67px" class="cls_055"><span class="cls_055">5 bytes (40 bits)</span></div>
<div style="position:absolute;left:292.99px;top:183.67px" class="cls_055"><span class="cls_055">WORD</span></div>
<div style="position:absolute;left:448.56px;top:183.67px" class="cls_055"><span class="cls_055">3</span></div>
<div style="position:absolute;left:490.04px;top:183.67px" class="cls_055"><span class="cls_055">4 bytes (32 bits)</span></div>
<div style="position:absolute;left:292.99px;top:199.67px" class="cls_055"><span class="cls_055">TRIPLEBYTE</span></div>
<div style="position:absolute;left:448.57px;top:199.67px" class="cls_055"><span class="cls_055">2</span></div>
<div style="position:absolute;left:490.05px;top:199.67px" class="cls_055"><span class="cls_055">3 bytes (24 bits)</span></div>
<div style="position:absolute;left:292.99px;top:215.67px" class="cls_055"><span class="cls_055">HALFWORD</span></div>
<div style="position:absolute;left:448.57px;top:215.67px" class="cls_055"><span class="cls_055">1</span></div>
<div style="position:absolute;left:490.05px;top:215.67px" class="cls_055"><span class="cls_055">2 bytes (16 bits)</span></div>
<div style="position:absolute;left:292.99px;top:231.67px" class="cls_055"><span class="cls_055">BYTE</span></div>
<div style="position:absolute;left:448.56px;top:231.67px" class="cls_055"><span class="cls_055">0</span></div>
<div style="position:absolute;left:490.04px;top:231.67px" class="cls_055"><span class="cls_055">1 byte (8 bits)</span></div>
<div style="position:absolute;left:323.99px;top:248.00px" class="cls_020"><span class="cls_020">Table A.6: Access Type Specifications for Loads/Store</span></div>
<div style="position:absolute;left:228.02px;top:273.67px" class="cls_006"><span class="cls_006">The bytes within the addressed doubleword which are used can be</span></div>
<div style="position:absolute;left:216.00px;top:284.67px" class="cls_006"><span class="cls_006">determined directly from the access type and the three low-order bits of the</span></div>
<div style="position:absolute;left:216.00px;top:295.67px" class="cls_006"><span class="cls_006">address.</span></div>
<div style="position:absolute;left:216.00px;top:318.00px" class="cls_015"><span class="cls_015">Jump and Branch Instructions</span></div>
<div style="position:absolute;left:228.02px;top:331.67px" class="cls_006"><span class="cls_006">All jump and branch instructions have an architectural delay of exactly</span></div>
<div style="position:absolute;left:216.00px;top:342.67px" class="cls_006"><span class="cls_006">one instruction.  That is, the instruction immediately following a jump or</span></div>
<div style="position:absolute;left:216.00px;top:353.67px" class="cls_006"><span class="cls_006">branch (that is, occupying the delay slot) is always executed while the</span></div>
<div style="position:absolute;left:216.00px;top:364.67px" class="cls_006"><span class="cls_006">target instruction is being fetched from storage.  A delay slot may not itself</span></div>
<div style="position:absolute;left:216.00px;top:375.67px" class="cls_006"><span class="cls_006">be occupied by a jump or branch instruction; however, this error is not</span></div>
<div style="position:absolute;left:216.00px;top:386.67px" class="cls_006"><span class="cls_006">detected and the results of such an operation are undefined.</span></div>
<div style="position:absolute;left:228.02px;top:397.67px" class="cls_006"><span class="cls_006">If an exception or interrupt prevents the completion of a legal instruction</span></div>
<div style="position:absolute;left:216.00px;top:408.67px" class="cls_006"><span class="cls_006">during a ranch delay slot, the hardware sets the </span><span class="cls_008">EPC</span><span class="cls_006"> register to point at</span></div>
<div style="position:absolute;left:216.00px;top:419.67px" class="cls_006"><span class="cls_006">the jump or branch instruction and an indication that the exception was</span></div>
<div style="position:absolute;left:216.00px;top:430.67px" class="cls_006"><span class="cls_006">caused by the instruction in the delay slot.  To continue the instruction</span></div>
<div style="position:absolute;left:216.00px;top:441.67px" class="cls_006"><span class="cls_006">stream and re-execute the instruction that faulted, both the jump or</span></div>
<div style="position:absolute;left:216.00px;top:452.67px" class="cls_006"><span class="cls_006">branch  instruction and the instruction in the delay slot are reexecuted.</span></div>
<div style="position:absolute;left:228.02px;top:463.67px" class="cls_006"><span class="cls_006">Because   jump   and   branch   instructions   may   be   restarted   after</span></div>
<div style="position:absolute;left:216.00px;top:474.67px" class="cls_006"><span class="cls_006">exceptions or interrupts, they must be restartable.  Therefore, when a</span></div>
<div style="position:absolute;left:216.00px;top:485.67px" class="cls_006"><span class="cls_006">jump or branch instruction stores a return link value, register </span><span class="cls_008">31</span><span class="cls_006"> (the</span></div>
<div style="position:absolute;left:216.00px;top:496.67px" class="cls_006"><span class="cls_006">register in which the link is stored) may not be used as a source register.</span></div>
<div style="position:absolute;left:228.02px;top:507.67px" class="cls_006"><span class="cls_006">Since instructions must be word-aligned, a Jump Register or Jump</span></div>
<div style="position:absolute;left:216.00px;top:518.67px" class="cls_006"><span class="cls_006">and Link Register instruction must use a register containing a valid word</span></div>
<div style="position:absolute;left:216.00px;top:529.67px" class="cls_006"><span class="cls_006">address.  If the two low-order bits are not zero, an address exception will</span></div>
<div style="position:absolute;left:216.00px;top:540.67px" class="cls_006"><span class="cls_006">occur when the jump target instruction is subsequently fetched.</span></div>
<div style="position:absolute;left:216.00px;top:563.00px" class="cls_015"><span class="cls_015">Coprocessor Instructions</span></div>
<div style="position:absolute;left:228.02px;top:576.67px" class="cls_006"><span class="cls_006">Coprocessors are alternate execution units, which have register files</span></div>
<div style="position:absolute;left:216.00px;top:587.67px" class="cls_006"><span class="cls_006">separate from the CPU.  The MIPS architecture provides a uniform</span></div>
<div style="position:absolute;left:216.00px;top:598.67px" class="cls_006"><span class="cls_006">abstraction for a few coprocessor units, some of which are implemented in</span></div>
<div style="position:absolute;left:216.00px;top:609.67px" class="cls_006"><span class="cls_006">any particular processor.  The  coprocessors may have two register spaces,</span></div>
<div style="position:absolute;left:216.00px;top:620.67px" class="cls_006"><span class="cls_006">each   space   containing   up   to   thirty-two   registers.</span></div>
<div style="position:absolute;left:515.80px;top:620.67px" class="cls_006"><span class="cls_006">Coprocessor</span></div>
<div style="position:absolute;left:216.00px;top:631.67px" class="cls_006"><span class="cls_006">computational  instructions may alter registers in either space.</span></div>
<div style="position:absolute;left:228.02px;top:645.67px" class="cls_006"><span class="cls_006">• The first space, </span><span class="cls_008">coprocessor general </span><span class="cls_006">registers</span><span class="cls_008">, </span><span class="cls_006">may be directly loaded</span></div>
<div style="position:absolute;left:239.98px;top:656.67px" class="cls_006"><span class="cls_006">from memory and stored into memory, and their contents may be</span></div>
<div style="position:absolute;left:239.98px;top:667.67px" class="cls_006"><span class="cls_006">transferred between the coprocessor and processor general registers.</span></div>
<div style="position:absolute;left:228.03px;top:681.67px" class="cls_006"><span class="cls_006">• The second space, </span><span class="cls_008">coprocessor control </span><span class="cls_006">registers</span><span class="cls_008">, </span><span class="cls_006">may only have their</span></div>
<div style="position:absolute;left:239.97px;top:692.67px" class="cls_006"><span class="cls_006">contents  transferred  directly  between  the  coprocessor  and  the</span></div>
<div style="position:absolute;left:239.97px;top:703.67px" class="cls_006"><span class="cls_006">processor general registers.</span></div>
<div style="position:absolute;left:304.78px;top:755.33px" class="cls_002"><span class="cls_002">A-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:174034px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:48.02px;top:50.67px" class="cls_006"><span class="cls_006">System control for all MIPS processors is implemented as Coprocessor</span></div>
<div style="position:absolute;left:36.00px;top:60.33px" class="cls_006"><span class="cls_006">0 (CP0) </span><span class="cls_062">-</span><span class="cls_006"> the System Control Coprocessor.  It provides the processor</span></div>
<div style="position:absolute;left:36.00px;top:76.66px" class="cls_006"><span class="cls_006">control, memory management, and exception handling functions.   The</span></div>
<div style="position:absolute;left:36.00px;top:87.66px" class="cls_006"><span class="cls_006">CP0 instructions are specific to each CPU and are documented with the</span></div>
<div style="position:absolute;left:36.00px;top:98.66px" class="cls_006"><span class="cls_006">CPU-specific information.</span></div>
<div style="position:absolute;left:48.02px;top:109.66px" class="cls_006"><span class="cls_006">If a system includes a Floating Point Unit for floating-point computation,</span></div>
<div style="position:absolute;left:36.00px;top:120.66px" class="cls_006"><span class="cls_006">it is implemented as Coprocessor 1 (CP1).  The FPU instructions are</span></div>
<div style="position:absolute;left:36.00px;top:131.66px" class="cls_006"><span class="cls_006">documented in Appendix B.</span></div>
<div style="position:absolute;left:36.00px;top:154.00px" class="cls_015"><span class="cls_015">System Control Coprocessor (CP0) Instructions</span></div>
<div style="position:absolute;left:48.02px;top:167.67px" class="cls_006"><span class="cls_006">There are some special limitations imposed on operations involving CP0</span></div>
<div style="position:absolute;left:36.00px;top:178.67px" class="cls_006"><span class="cls_006">that is incorporated within the CPU.  Load and store instructions are not</span></div>
<div style="position:absolute;left:36.00px;top:189.67px" class="cls_006"><span class="cls_006">valid for CP0 registers;  the move to/from coprocessor instructions are the</span></div>
<div style="position:absolute;left:36.00px;top:200.67px" class="cls_006"><span class="cls_006">only valid mechanism for writing to and reading from the CP0 registers.</span></div>
<div style="position:absolute;left:36.00px;top:223.00px" class="cls_015"><span class="cls_015">Instruct Set Details</span></div>
<div style="position:absolute;left:48.02px;top:236.67px" class="cls_006"><span class="cls_006">The  following  pages  contain  an  alphabetical  listing  of  the  CPU</span></div>
<div style="position:absolute;left:36.00px;top:247.67px" class="cls_006"><span class="cls_006">instructions for the R30xx family.</span></div>
<div style="position:absolute;left:291.03px;top:755.33px" class="cls_002"><span class="cls_002">A-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:174836px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:275.38px;top:69.20px" class="cls_064"><span class="cls_064">Add Word</span></div>
<div style="position:absolute;left:109.42px;top:60.62px" class="cls_063"><span class="cls_063">ADD</span></div>
<div style="position:absolute;left:453.21px;top:60.36px" class="cls_063"><span class="cls_063">ADD</span></div>
<div style="position:absolute;left:116.64px;top:106.56px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:106.56px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:106.56px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:106.56px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:354.46px;top:106.57px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:413.81px;top:106.57px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:429.87px;top:106.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:489.34px;top:106.57px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:134.04px;top:125.78px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:394.67px;top:125.79px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:451.77px;top:125.79px" class="cls_053"><span class="cls_053">ADD</span></div>
<div style="position:absolute;left:213.78px;top:130.53px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:272.28px;top:130.53px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:333.52px;top:130.54px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:131.54px;top:140.19px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:378.01px;top:140.19px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:438.72px;top:140.19px" class="cls_053"><span class="cls_053">1 0 0 0 0 0</span></div>
<div style="position:absolute;left:151.85px;top:154.58px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.94px;top:154.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.20px;top:154.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:332.58px;top:154.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:392.05px;top:154.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:456.92px;top:154.59px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:177.03px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:198.37px" class="cls_055"><span class="cls_055">ADD  rd, rs, rt</span></div>
<div style="position:absolute;left:72.00px;top:219.03px" class="cls_066"><span class="cls_066">Purpose:</span></div>
<div style="position:absolute;left:108.00px;top:237.37px" class="cls_055"><span class="cls_055">Add two 32-bit values and produce a 32-bit result;  arithmetic overflow causes an exception.</span></div>
<div style="position:absolute;left:72.00px;top:258.03px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:276.37px" class="cls_055"><span class="cls_055">The word value in general register </span><span class="cls_058">rt </span><span class="cls_055">is added to the word value in general register </span><span class="cls_058">rs</span><span class="cls_055"> and the result</span></div>
<div style="position:absolute;left:108.00px;top:289.37px" class="cls_055"><span class="cls_055">word value is placed into general register </span><span class="cls_058">rd</span><span class="cls_055">.If the addition results in 32-bit 2’s complement</span></div>
<div style="position:absolute;left:108.00px;top:302.37px" class="cls_055"><span class="cls_055">arithmetic overflow (carries out of bits 30 and 31 differ) then the destination register </span><span class="cls_058">rd</span><span class="cls_055"> is not</span></div>
<div style="position:absolute;left:108.00px;top:315.37px" class="cls_055"><span class="cls_055">modified and an integer overflow exception occurs.</span></div>
<div style="position:absolute;left:72.00px;top:336.03px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:172.90px;top:359.00px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:198.10px;top:359.00px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053">GPR[rs] + GPR[rt]</span></div>
<div style="position:absolute;left:72.00px;top:422.69px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:441.02px" class="cls_055"><span class="cls_055">Integer overflow exception</span></div>
<div style="position:absolute;left:304.78px;top:755.33px" class="cls_002"><span class="cls_002">A-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:175638px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:230.40px;top:69.20px" class="cls_064"><span class="cls_064">Add Immediate Word</span></div>
<div style="position:absolute;left:108.43px;top:60.40px" class="cls_063"><span class="cls_063">ADDI</span></div>
<div style="position:absolute;left:440.57px;top:60.90px" class="cls_063"><span class="cls_063">ADDI</span></div>
<div style="position:absolute;left:116.57px;top:104.74px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:104.74px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:104.74px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:104.74px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:489.40px;top:104.74px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:143.15px;top:123.96px" class="cls_053"><span class="cls_053">ADDI</span></div>
<div style="position:absolute;left:213.71px;top:128.78px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:272.28px;top:128.78px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:377.27px;top:127.34px" class="cls_053"><span class="cls_053">immediate</span></div>
<div style="position:absolute;left:128.33px;top:138.36px" class="cls_053"><span class="cls_053">0 0 1 0 0 0</span></div>
<div style="position:absolute;left:151.85px;top:152.76px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.94px;top:152.76px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.12px;top:152.76px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:389.09px;top:152.76px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:175.03px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:196.37px" class="cls_055"><span class="cls_055">ADDI  rt, rs, immediate</span></div>
<div style="position:absolute;left:72.00px;top:217.03px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:235.37px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">immediate </span><span class="cls_055">is sign-extended and added to the contents of general register </span><span class="cls_058">rs </span><span class="cls_055">to form the</span></div>
<div style="position:absolute;left:108.01px;top:248.37px" class="cls_055"><span class="cls_055">result.  The result is placed into general register </span><span class="cls_058">rt.</span></div>
<div style="position:absolute;left:108.01px;top:267.37px" class="cls_055"><span class="cls_055">An overflow exception occurs if carries out of bits 30 and 31 differ (2’s complement overflow).  The</span></div>
<div style="position:absolute;left:108.01px;top:280.37px" class="cls_055"><span class="cls_055">destination register </span><span class="cls_058">rt</span><span class="cls_055"> is not modified when an integer overflow exception occurs.</span></div>
<div style="position:absolute;left:72.00px;top:301.03px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:136.49px;top:324.01px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:162.04px;top:322.01px" class="cls_053"><span class="cls_053">GPR [rt] </span><span class="cls_003">←</span><span class="cls_053"> GPR[rs] +(immediate</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16</sup></span><span class="cls_058"> ||</span><span class="cls_053"> immediate</span><span class="cls_061"><sub>15...0</sub></span></div>
<div style="position:absolute;left:75.00px;top:408.37px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:426.70px" class="cls_055"><span class="cls_055">Integer overflow exception</span></div>
<div style="position:absolute;left:291.03px;top:755.34px" class="cls_002"><span class="cls_002">A-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:176440px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:221.35px;top:69.20px" class="cls_064"><span class="cls_064">Add Immediate Unsigned</span></div>
<div style="position:absolute;left:108.25px;top:71.90px" class="cls_063"><span class="cls_063">ADDIU</span></div>
<div style="position:absolute;left:421.02px;top:72.19px" class="cls_063"><span class="cls_063">ADDIU</span></div>
<div style="position:absolute;left:284.40px;top:87.20px" class="cls_064"><span class="cls_064">Word</span></div>
<div style="position:absolute;left:117.58px;top:113.74px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.88px;top:113.74px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.10px;top:113.74px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.36px;top:113.74px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:490.41px;top:113.74px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:140.55px;top:132.96px" class="cls_053"><span class="cls_053">ADDIU</span></div>
<div style="position:absolute;left:214.72px;top:137.78px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:273.29px;top:137.78px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:378.28px;top:136.34px" class="cls_053"><span class="cls_053">immediate</span></div>
<div style="position:absolute;left:132.12px;top:147.36px" class="cls_053"><span class="cls_053">0 0 1 0 0 1</span></div>
<div style="position:absolute;left:152.86px;top:161.76px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.95px;top:161.76px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.13px;top:161.76px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:390.10px;top:161.76px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:185.03px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:206.37px" class="cls_055"><span class="cls_055">ADDIU  rt, rs, immediate</span></div>
<div style="position:absolute;left:72.00px;top:227.03px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:245.37px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">immediate </span><span class="cls_055">is sign-extended and added to the contents of general register </span><span class="cls_058">rs </span><span class="cls_055">to form the</span></div>
<div style="position:absolute;left:108.01px;top:258.37px" class="cls_055"><span class="cls_055">result.  The result is placed into general register </span><span class="cls_058">rt. </span><span class="cls_055">No integer overflow exception occurs under any</span></div>
<div style="position:absolute;left:108.01px;top:271.37px" class="cls_055"><span class="cls_055">circumstances.</span></div>
<div style="position:absolute;left:108.01px;top:290.37px" class="cls_055"><span class="cls_055">The only difference between this instruction and the ADDI instruction is that ADDIU never causes</span></div>
<div style="position:absolute;left:108.01px;top:303.37px" class="cls_055"><span class="cls_055">an overflow exception.</span></div>
<div style="position:absolute;left:72.00px;top:324.03px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:138.82px;top:355.34px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:164.01px;top:353.34px" class="cls_053"><span class="cls_053">temp </span><span class="cls_003">←</span><span class="cls_053"> GPR[rs] + (immediate</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>48</sup></span><span class="cls_058"> ||</span><span class="cls_053"> immediate</span><span class="cls_061"><sub>15...0</sub></span></div>
<div style="position:absolute;left:164.02px;top:371.39px" class="cls_053"><span class="cls_053">if 32-bit-overflow (temp) then</span></div>
<div style="position:absolute;left:218.02px;top:385.44px" class="cls_053"><span class="cls_053">GPR[rt] </span><span class="cls_003">←</span><span class="cls_053"> (temp</span><span class="cls_061"><sub>31</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>32</sup></span><span class="cls_053"> || temp</span><span class="cls_061"><sub>31...0</sub></span></div>
<div style="position:absolute;left:164.02px;top:403.49px" class="cls_053"><span class="cls_053">else</span></div>
<div style="position:absolute;left:218.02px;top:419.54px" class="cls_053"><span class="cls_053">GPR[rt]  </span><span class="cls_003">←</span><span class="cls_053"> temp</span></div>
<div style="position:absolute;left:72.00px;top:458.33px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:476.67px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:304.78px;top:755.34px" class="cls_002"><span class="cls_002">A-9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:177242px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:108.43px;top:61.19px" class="cls_063"><span class="cls_063">ADDU</span><span class="cls_064">     Add Unsigned Word</span></div>
<div style="position:absolute;left:433.07px;top:60.90px" class="cls_063"><span class="cls_063">ADDU</span></div>
<div style="position:absolute;left:117.65px;top:106.56px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.88px;top:106.56px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.10px;top:106.56px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.36px;top:106.56px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:355.46px;top:106.57px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:414.81px;top:106.57px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:430.87px;top:106.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:490.34px;top:106.57px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:135.05px;top:130.54px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:214.79px;top:130.54px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:273.29px;top:130.54px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:334.53px;top:130.54px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:395.67px;top:130.54px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:446.43px;top:130.54px" class="cls_053"><span class="cls_053">ADDU</span></div>
<div style="position:absolute;left:129.16px;top:140.19px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:376.75px;top:140.19px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:436.98px;top:140.19px" class="cls_053"><span class="cls_053">1 0 0 0 0 1</span></div>
<div style="position:absolute;left:152.86px;top:154.59px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.95px;top:154.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.21px;top:154.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:333.57px;top:154.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:393.04px;top:154.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:457.92px;top:154.59px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:177.03px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:198.37px" class="cls_055"><span class="cls_055">ADDU  rd, rs, rt</span></div>
<div style="position:absolute;left:72.00px;top:219.03px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:237.37px" class="cls_055"><span class="cls_055">Add two 32-bit values and produce a 32-bit result; arithmetic overflow is ignored (does not cause</span></div>
<div style="position:absolute;left:108.00px;top:250.37px" class="cls_055"><span class="cls_055">an exception).</span></div>
<div style="position:absolute;left:108.00px;top:269.37px" class="cls_055"><span class="cls_055">The word value in general register </span><span class="cls_058">rt </span><span class="cls_055">is added to the word value in general register </span><span class="cls_058">rs</span><span class="cls_055"> and the result</span></div>
<div style="position:absolute;left:108.00px;top:282.37px" class="cls_055"><span class="cls_055">word value is placed into general register </span><span class="cls_058">rd</span><span class="cls_055">.   ADDU  differs from ADD only when an arithmetic</span></div>
<div style="position:absolute;left:108.00px;top:295.37px" class="cls_055"><span class="cls_055">overflow occurs.  If the addition results in 32-bit 2’s complement overflow (carries out of bits 30 and</span></div>
<div style="position:absolute;left:108.00px;top:308.37px" class="cls_055"><span class="cls_055">31 differ), the result word value is placed into register </span><span class="cls_058">rd</span><span class="cls_055"> and no exception occurs.</span></div>
<div style="position:absolute;left:110.50px;top:346.37px" class="cls_055"><span class="cls_055">Operation:</span></div>
<div style="position:absolute;left:172.59px;top:366.17px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:197.79px;top:366.17px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053">GPR[rs] + GPR[rt]</span></div>
<div style="position:absolute;left:72.00px;top:408.33px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:426.67px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-10</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:178044px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:292.29px;top:69.38px" class="cls_064"><span class="cls_064">And</span></div>
<div style="position:absolute;left:108.32px;top:60.90px" class="cls_063"><span class="cls_063">AND</span></div>
<div style="position:absolute;left:447.74px;top:61.19px" class="cls_063"><span class="cls_063">AND</span></div>
<div style="position:absolute;left:117.65px;top:103.56px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.88px;top:103.56px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.10px;top:103.56px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.36px;top:103.56px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:355.46px;top:103.57px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:414.81px;top:103.57px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:430.87px;top:103.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:490.34px;top:103.57px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:135.05px;top:127.54px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:214.79px;top:127.54px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:273.29px;top:127.54px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:334.53px;top:127.54px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:392.65px;top:127.54px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:450.05px;top:127.54px" class="cls_053"><span class="cls_053">AND</span></div>
<div style="position:absolute;left:129.16px;top:137.19px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:374.59px;top:137.19px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:436.98px;top:137.19px" class="cls_053"><span class="cls_053">1 0 0 1 0 0</span></div>
<div style="position:absolute;left:152.86px;top:151.59px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.95px;top:151.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.21px;top:151.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:333.57px;top:151.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:393.04px;top:151.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:457.92px;top:151.59px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:174.03px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.37px" class="cls_055"><span class="cls_055">AND  rd, rs, rt</span></div>
<div style="position:absolute;left:72.00px;top:216.03px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.37px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rs </span><span class="cls_055">are combined with the contents of general register </span><span class="cls_058">rt </span><span class="cls_055">in a bit-wise</span></div>
<div style="position:absolute;left:108.01px;top:247.37px" class="cls_055"><span class="cls_055">logical AND operation.  The result is placed into general register </span><span class="cls_058">rd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:72.00px;top:268.03px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:172.51px;top:295.17px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:197.70px;top:295.17px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> GPR[rs] and GPR[rt]</span></div>
<div style="position:absolute;left:72.00px;top:360.50px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:378.83px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-11</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:178846px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:254.84px;top:69.38px" class="cls_064"><span class="cls_064">And Immediate</span></div>
<div style="position:absolute;left:439.73px;top:60.90px" class="cls_063"><span class="cls_063">ANDI</span></div>
<div style="position:absolute;left:107.60px;top:63.71px" class="cls_063"><span class="cls_063">ANDI</span></div>
<div style="position:absolute;left:117.58px;top:103.74px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.88px;top:103.74px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.10px;top:103.74px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.36px;top:103.74px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:490.41px;top:103.74px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:144.16px;top:127.79px" class="cls_053"><span class="cls_053">ANDI</span></div>
<div style="position:absolute;left:214.73px;top:127.79px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:273.30px;top:127.79px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:378.28px;top:126.35px" class="cls_053"><span class="cls_053">immediate</span></div>
<div style="position:absolute;left:132.12px;top:137.37px" class="cls_053"><span class="cls_053">0 0 1 1 0 0</span></div>
<div style="position:absolute;left:152.86px;top:151.77px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.95px;top:151.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.13px;top:151.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:390.10px;top:151.77px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:173.03px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:194.37px" class="cls_055"><span class="cls_055">ANDI  rt, rs, immediate</span></div>
<div style="position:absolute;left:72.00px;top:215.03px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:233.37px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">immediate </span><span class="cls_055">is zero-extended and combined with the contents of general register </span><span class="cls_058">rs </span><span class="cls_055">in a bit-</span></div>
<div style="position:absolute;left:108.00px;top:246.37px" class="cls_055"><span class="cls_055">wise logical AND operation.  The result is placed into general register </span><span class="cls_058">rt</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:72.00px;top:267.03px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:172.91px;top:294.83px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:198.11px;top:292.83px" class="cls_053"><span class="cls_053">GPR[rt] </span><span class="cls_003">←</span><span class="cls_053"> 0</span><span class="cls_061"><sup>16 </sup></span><span class="cls_053">|| (immediate and GPR[rs]</span><span class="cls_061"><sub>15...0</sub></span><span class="cls_053">)</span></div>
<div style="position:absolute;left:75.00px;top:334.33px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:352.67px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-12</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:179648px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:249.22px;top:69.52px" class="cls_064"><span class="cls_064">Branch On Equal</span></div>
<div style="position:absolute;left:107.68px;top:61.19px" class="cls_063"><span class="cls_063">BEQ</span></div>
<div style="position:absolute;left:457.99px;top:60.69px" class="cls_063"><span class="cls_063">BEQ</span></div>
<div style="position:absolute;left:115.67px;top:102.74px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:170.97px;top:102.74px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:234.19px;top:102.74px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:293.45px;top:102.74px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:488.50px;top:102.74px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:140.10px;top:126.79px" class="cls_053"><span class="cls_053">BEQ</span></div>
<div style="position:absolute;left:212.81px;top:126.79px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:271.38px;top:126.79px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:387.19px;top:125.35px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:127.04px;top:136.37px" class="cls_053"><span class="cls_053">0 0 0 1 0 0</span></div>
<div style="position:absolute;left:147.88px;top:150.77px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.04px;top:150.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:275.22px;top:150.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:388.19px;top:150.77px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:172.84px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:194.18px" class="cls_055"><span class="cls_055">BEQ  rs, rt, offset</span></div>
<div style="position:absolute;left:72.00px;top:214.84px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:233.18px" class="cls_055"><span class="cls_055">A branch target address is computed from the sum of the address of the instruction in the delay slot</span></div>
<div style="position:absolute;left:108.00px;top:246.17px" class="cls_055"><span class="cls_055">and the 16-bit </span><span class="cls_058">offset</span><span class="cls_055">, shifted left two bits and sign-extended.  The contents of general register </span><span class="cls_058">rs </span><span class="cls_055">and</span></div>
<div style="position:absolute;left:108.00px;top:259.17px" class="cls_055"><span class="cls_055">the contents of general register </span><span class="cls_058">rt </span><span class="cls_055">are compared.  If the two registers are equal, then the program</span></div>
<div style="position:absolute;left:108.00px;top:272.17px" class="cls_055"><span class="cls_055">branches to the target address, with a delay of one instruction.</span></div>
<div style="position:absolute;left:72.00px;top:292.84px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:136.38px;top:315.73px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:161.58px;top:313.73px" class="cls_053"><span class="cls_053">target </span><span class="cls_003">←</span><span class="cls_053"> (offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>14</sup></span><span class="cls_053"> || offset || 0</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:161.58px;top:329.56px" class="cls_053"><span class="cls_053">condition </span><span class="cls_003">←</span><span class="cls_053"> (GPR[rs] = GPR[rt])</span></div>
<div style="position:absolute;left:136.38px;top:342.56px" class="cls_053"><span class="cls_053">T+1: if condition then</span></div>
<div style="position:absolute;left:215.58px;top:353.92px" class="cls_053"><span class="cls_053">PC </span><span class="cls_003">←</span><span class="cls_053"> PC + target</span></div>
<div style="position:absolute;left:161.59px;top:365.28px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:72.00px;top:451.89px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:470.23px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-13</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:180450px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:225.08px;top:63.80px" class="cls_064"><span class="cls_064">Branch On Greater Than</span></div>
<div style="position:absolute;left:104.19px;top:60.55px" class="cls_063"><span class="cls_063">BGEZ</span></div>
<div style="position:absolute;left:441.14px;top:60.55px" class="cls_063"><span class="cls_063">BGEZ</span></div>
<div style="position:absolute;left:249.27px;top:78.78px" class="cls_064"><span class="cls_064">Or Equal To Zero</span></div>
<div style="position:absolute;left:117.58px;top:104.75px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.88px;top:104.75px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.10px;top:104.75px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.36px;top:104.75px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:490.41px;top:104.75px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:135.55px;top:128.80px" class="cls_053"><span class="cls_053">REGIMM</span></div>
<div style="position:absolute;left:214.72px;top:128.80px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:263.38px;top:128.80px" class="cls_053"><span class="cls_053">BGEZ</span></div>
<div style="position:absolute;left:389.11px;top:127.36px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:132.13px;top:138.38px" class="cls_053"><span class="cls_053">0 0 0 0 0 1</span></div>
<div style="position:absolute;left:257.56px;top:138.38px" class="cls_053"><span class="cls_053">0 0 0 0 1</span></div>
<div style="position:absolute;left:152.87px;top:152.78px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.96px;top:152.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.14px;top:152.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:390.11px;top:152.78px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:173.54px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:194.87px" class="cls_055"><span class="cls_055">BGEZ  rs, offset</span></div>
<div style="position:absolute;left:72.00px;top:215.54px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:233.87px" class="cls_055"><span class="cls_055">A branch target address is computed from the sum of the address of the instruction in the delay slot</span></div>
<div style="position:absolute;left:108.00px;top:246.87px" class="cls_055"><span class="cls_055">and the 16-bit </span><span class="cls_058">offset</span><span class="cls_055">, shifted left two bits and sign-extended.  If the contents of general register </span><span class="cls_058">rs</span></div>
<div style="position:absolute;left:107.99px;top:259.87px" class="cls_055"><span class="cls_055">have the sign bit cleared, then the program branches to the target address, with a delay of one</span></div>
<div style="position:absolute;left:107.99px;top:272.87px" class="cls_055"><span class="cls_055">instruction.</span></div>
<div style="position:absolute;left:72.00px;top:293.54px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:138.02px;top:315.45px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:163.22px;top:313.45px" class="cls_053"><span class="cls_053">target </span><span class="cls_003">←</span><span class="cls_053"> (offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>14</sup></span><span class="cls_053"> || offset || 0</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:163.22px;top:330.06px" class="cls_053"><span class="cls_053">condition </span><span class="cls_003">←</span><span class="cls_053"> (GPR[rs]</span><span class="cls_061"><sub>31</sub></span><span class="cls_053"> = 0)</span></div>
<div style="position:absolute;left:138.02px;top:344.24px" class="cls_053"><span class="cls_053">T+1: if condition then</span></div>
<div style="position:absolute;left:217.22px;top:357.63px" class="cls_053"><span class="cls_053">PC </span><span class="cls_003">← </span><span class="cls_053">PC + target</span></div>
<div style="position:absolute;left:163.23px;top:371.09px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:72.00px;top:474.78px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:493.12px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-14</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:181252px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:234.74px;top:62.55px" class="cls_067"><span class="cls_067">Branch On Greater Than</span></div>
<div style="position:absolute;left:106.26px;top:60.90px" class="cls_063"><span class="cls_063">BGEZAL</span></div>
<div style="position:absolute;left:407.61px;top:60.90px" class="cls_063"><span class="cls_063">BGEZAL</span></div>
<div style="position:absolute;left:229.58px;top:77.53px" class="cls_067"><span class="cls_067">Or Equal To Zero And Link</span></div>
<div style="position:absolute;left:118.01px;top:118.73px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:173.31px;top:118.73px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:227.31px;top:118.73px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.79px;top:118.73px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:490.84px;top:118.73px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:135.98px;top:142.78px" class="cls_053"><span class="cls_053">REGIMM</span></div>
<div style="position:absolute;left:215.16px;top:142.78px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:254.61px;top:142.78px" class="cls_053"><span class="cls_053">BGEZAL</span></div>
<div style="position:absolute;left:389.54px;top:141.34px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:132.56px;top:152.36px" class="cls_053"><span class="cls_053">0 0 0 0 0 1</span></div>
<div style="position:absolute;left:251.94px;top:152.36px" class="cls_053"><span class="cls_053">1 0 0 0 1</span></div>
<div style="position:absolute;left:153.30px;top:166.76px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:218.39px;top:166.76px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.57px;top:166.76px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:390.54px;top:166.76px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:187.75px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:209.09px" class="cls_055"><span class="cls_055">BGEZAL rs, offset</span></div>
<div style="position:absolute;left:72.00px;top:229.75px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:248.09px" class="cls_055"><span class="cls_055">A branch target address is computed from the sum of the address of the instruction in the delay slot</span></div>
<div style="position:absolute;left:108.00px;top:261.09px" class="cls_055"><span class="cls_055">and the 16-bit </span><span class="cls_058">offset, </span><span class="cls_055">shifted left two bits and sign-extended.  Unconditionally, the address of the</span></div>
<div style="position:absolute;left:107.99px;top:274.09px" class="cls_055"><span class="cls_055">instruction after the delay slot is placed in the link register, </span><span class="cls_058">r31</span><span class="cls_055">.  If the contents of general register</span></div>
<div style="position:absolute;left:107.99px;top:287.09px" class="cls_058"><span class="cls_058">rs </span><span class="cls_055">have the sign bit cleared, then the program branches to the target address, with a delay of one</span></div>
<div style="position:absolute;left:107.99px;top:300.09px" class="cls_055"><span class="cls_055">instruction.</span></div>
<div style="position:absolute;left:107.99px;top:319.09px" class="cls_055"><span class="cls_055">General register </span><span class="cls_058">rs </span><span class="cls_055">may not be general register </span><span class="cls_058">31</span><span class="cls_055">, because such an instruction is not restartable.  An</span></div>
<div style="position:absolute;left:107.99px;top:332.09px" class="cls_055"><span class="cls_055">attempt to execute this instruction is not trapped, however.</span></div>
<div style="position:absolute;left:72.00px;top:352.75px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:136.40px;top:372.37px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:161.59px;top:370.37px" class="cls_053"><span class="cls_053">target </span><span class="cls_003">←</span><span class="cls_053"> (offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>14 </sup></span><span class="cls_053">|| offset || 0</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:161.59px;top:383.89px" class="cls_053"><span class="cls_053">condition </span><span class="cls_003">←</span><span class="cls_053"> (GPR[rs]</span><span class="cls_061"><sub>31 </sub></span><span class="cls_053">= 0)</span></div>
<div style="position:absolute;left:161.59px;top:396.27px" class="cls_053"><span class="cls_053">GPR[31] </span><span class="cls_003">←</span><span class="cls_053"> PC + 8</span></div>
<div style="position:absolute;left:136.39px;top:408.87px" class="cls_053"><span class="cls_053">T+1: if condition then</span></div>
<div style="position:absolute;left:188.95px;top:421.33px" class="cls_053"><span class="cls_053">PC </span><span class="cls_003">←</span><span class="cls_053"> PC + target</span></div>
<div style="position:absolute;left:161.59px;top:430.33px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:72.00px;top:526.04px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:544.37px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-15</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:182054px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:207.59px;top:67.18px" class="cls_064"><span class="cls_064">Branch On Greater Than Zero</span></div>
<div style="position:absolute;left:105.93px;top:60.90px" class="cls_063"><span class="cls_063">BGTZ</span></div>
<div style="position:absolute;left:440.48px;top:61.18px" class="cls_063"><span class="cls_063">BGTZ</span></div>
<div style="position:absolute;left:118.40px;top:103.75px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:173.70px;top:103.75px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.92px;top:103.75px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:296.18px;top:103.75px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:491.24px;top:103.75px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:143.59px;top:127.80px" class="cls_053"><span class="cls_053">BGTZ</span></div>
<div style="position:absolute;left:215.55px;top:127.80px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:274.39px;top:127.80px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:389.93px;top:126.36px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:132.95px;top:137.38px" class="cls_053"><span class="cls_053">0 0 0 1 1 1</span></div>
<div style="position:absolute;left:257.16px;top:137.38px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:153.69px;top:151.78px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:218.79px;top:151.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.97px;top:151.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:390.94px;top:151.78px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:172.85px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:194.18px" class="cls_055"><span class="cls_055">BGTZ rs, offset</span></div>
<div style="position:absolute;left:72.00px;top:214.85px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:233.18px" class="cls_055"><span class="cls_055">A branch target address is computed from the sum of the address of the instruction in the delay slot</span></div>
<div style="position:absolute;left:108.00px;top:246.18px" class="cls_055"><span class="cls_055">and the 16-bit </span><span class="cls_058">offset</span><span class="cls_055">, shifted left two bits and sign-extended.  The contents of general register </span><span class="cls_058">rs </span><span class="cls_055">are</span></div>
<div style="position:absolute;left:107.99px;top:259.18px" class="cls_055"><span class="cls_055">compared to zero.  If the contents of general register </span><span class="cls_058">rs </span><span class="cls_055">have the sign bit cleared and are not equal</span></div>
<div style="position:absolute;left:107.99px;top:272.18px" class="cls_055"><span class="cls_055">to zero, then the program branches to the target address, with a delay of one instruction.</span></div>
<div style="position:absolute;left:72.00px;top:292.85px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:172.60px;top:319.07px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:197.80px;top:317.07px" class="cls_053"><span class="cls_053">target </span><span class="cls_003">←</span><span class="cls_053"> (offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>14</sup></span><span class="cls_053"> || offset || 0</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:197.80px;top:332.55px" class="cls_053"><span class="cls_053">condition </span><span class="cls_003">←</span><span class="cls_053"> (GPR[rs]</span><span class="cls_061"><sub>31 </sub></span><span class="cls_053">= 0) and  (GPR[rs] </span><span class="cls_003">≠</span><span class="cls_053"> 0</span><span class="cls_061"><sup>32</sup></span><span class="cls_053">)</span></div>
<div style="position:absolute;left:172.60px;top:350.39px" class="cls_053"><span class="cls_053">T+1:  if condition then</span></div>
<div style="position:absolute;left:225.16px;top:363.71px" class="cls_053"><span class="cls_053">PC </span><span class="cls_003">←</span><span class="cls_053"> PC + target</span></div>
<div style="position:absolute;left:197.81px;top:376.24px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:72.00px;top:478.88px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:497.22px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-16</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:182856px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:235.09px;top:64.30px" class="cls_064"><span class="cls_064">Branch on Less Than</span></div>
<div style="position:absolute;left:105.11px;top:61.04px" class="cls_063"><span class="cls_063">BLEZ</span></div>
<div style="position:absolute;left:436.74px;top:61.04px" class="cls_063"><span class="cls_063">BLEZ</span></div>
<div style="position:absolute;left:249.28px;top:77.80px" class="cls_064"><span class="cls_064">Or Equal To Zero</span></div>
<div style="position:absolute;left:116.57px;top:103.39px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:103.39px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:103.39px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:103.39px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:489.40px;top:103.39px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:142.59px;top:127.44px" class="cls_053"><span class="cls_053">BLEZ</span></div>
<div style="position:absolute;left:213.72px;top:127.44px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:272.56px;top:127.44px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:388.10px;top:126.00px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:131.10px;top:137.02px" class="cls_053"><span class="cls_053">0 0 0 1 1 0</span></div>
<div style="position:absolute;left:253.93px;top:137.02px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:151.86px;top:151.42px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.95px;top:151.42px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.13px;top:151.42px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:389.10px;top:151.42px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:173.57px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:194.90px" class="cls_055"><span class="cls_055">BLEZ rs, offset</span></div>
<div style="position:absolute;left:72.00px;top:215.57px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:233.90px" class="cls_055"><span class="cls_055">A branch target address is computed from the sum of the address of the instruction in the delay slot</span></div>
<div style="position:absolute;left:108.00px;top:246.90px" class="cls_055"><span class="cls_055">and the 16-bit </span><span class="cls_058">offset</span><span class="cls_055">, shifted left two bits and sign-extended.  The contents of general register </span><span class="cls_058">rs </span><span class="cls_055">are</span></div>
<div style="position:absolute;left:107.99px;top:259.90px" class="cls_055"><span class="cls_055">compared to zero.  If the contents of general register </span><span class="cls_058">rs </span><span class="cls_055">have the sign bit set, or are equal to zero,</span></div>
<div style="position:absolute;left:107.99px;top:272.90px" class="cls_055"><span class="cls_055">then the program branches to the target address, with a delay of one instruction.</span></div>
<div style="position:absolute;left:72.00px;top:293.57px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:172.05px;top:316.29px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:197.25px;top:314.29px" class="cls_053"><span class="cls_053">target </span><span class="cls_003">←</span><span class="cls_053"> (offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>14</sup></span><span class="cls_053"> || offset || 0</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:197.25px;top:328.11px" class="cls_053"><span class="cls_053">condition </span><span class="cls_003">←</span><span class="cls_053"> (GPR[rs]</span><span class="cls_061"><sub>31</sub></span><span class="cls_053"> = 1) or  (GPR[rs] = 0</span><span class="cls_061"><sup>32</sup></span><span class="cls_053">)</span></div>
<div style="position:absolute;left:172.05px;top:342.79px" class="cls_053"><span class="cls_053">T+1: if condition then</span></div>
<div style="position:absolute;left:224.61px;top:354.08px" class="cls_053"><span class="cls_053">PC </span><span class="cls_003">←</span><span class="cls_053"> PC + target</span></div>
<div style="position:absolute;left:198.91px;top:365.17px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:72.00px;top:453.32px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:471.65px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-17</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:183658px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:216.35px;top:66.70px" class="cls_064"><span class="cls_064">Branch On Less Than Zero</span></div>
<div style="position:absolute;left:106.22px;top:60.97px" class="cls_063"><span class="cls_063">BLTZ</span></div>
<div style="position:absolute;left:443.26px;top:60.46px" class="cls_063"><span class="cls_063">BLTZ</span></div>
<div style="position:absolute;left:118.84px;top:102.24px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:174.14px;top:102.24px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:237.36px;top:102.24px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:296.62px;top:102.24px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:491.67px;top:102.24px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:136.81px;top:127.15px" class="cls_053"><span class="cls_053">REGIMM</span></div>
<div style="position:absolute;left:215.98px;top:127.15px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:266.03px;top:127.15px" class="cls_053"><span class="cls_053">BLTZ</span></div>
<div style="position:absolute;left:390.37px;top:125.64px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:133.38px;top:137.88px" class="cls_053"><span class="cls_053">0 0 0 0 0 1</span></div>
<div style="position:absolute;left:257.42px;top:137.88px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:154.12px;top:152.06px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:219.21px;top:152.06px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:278.39px;top:152.06px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:391.36px;top:152.06px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:174.22px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.55px" class="cls_055"><span class="cls_055">BLTZ rs, offset</span></div>
<div style="position:absolute;left:72.00px;top:216.22px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.55px" class="cls_055"><span class="cls_055">A branch target address is computed from the sum of the address of the instruction in the delay slot</span></div>
<div style="position:absolute;left:108.00px;top:247.55px" class="cls_055"><span class="cls_055">and the 16-bit </span><span class="cls_058">offset</span><span class="cls_055">, shifted left two bits and sign-extended.  If the contents of general register </span><span class="cls_058">rs</span></div>
<div style="position:absolute;left:107.99px;top:260.55px" class="cls_055"><span class="cls_055">have the sign bit set, then the program branches to the target address, with a delay of one</span></div>
<div style="position:absolute;left:107.99px;top:273.55px" class="cls_055"><span class="cls_055">instruction.</span></div>
<div style="position:absolute;left:74.75px;top:294.22px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:138.70px;top:318.01px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:163.90px;top:316.01px" class="cls_053"><span class="cls_053">target </span><span class="cls_003">←</span><span class="cls_053"> (offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>14</sup></span><span class="cls_053"> || offset || 0</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:163.90px;top:332.62px" class="cls_053"><span class="cls_053">condition </span><span class="cls_003">←</span><span class="cls_053"> (GPR[rs]</span><span class="cls_061"><sub>31</sub></span><span class="cls_053"> = 1)</span></div>
<div style="position:absolute;left:138.70px;top:346.80px" class="cls_053"><span class="cls_053">T+1: if condition then</span></div>
<div style="position:absolute;left:217.90px;top:360.19px" class="cls_053"><span class="cls_053">PC </span><span class="cls_003">← </span><span class="cls_053">PC + target</span></div>
<div style="position:absolute;left:163.90px;top:373.65px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:72.00px;top:471.39px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:489.73px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-18</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:184460px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:252.57px;top:64.29px" class="cls_064"><span class="cls_064">Branch On Less</span></div>
<div style="position:absolute;left:105.38px;top:60.54px" class="cls_063"><span class="cls_063">BLTZAL</span></div>
<div style="position:absolute;left:408.39px;top:61.04px" class="cls_063"><span class="cls_063">BLTZAL</span></div>
<div style="position:absolute;left:240.95px;top:76.17px" class="cls_064"><span class="cls_064">Than Zero And Link</span></div>
<div style="position:absolute;left:118.66px;top:104.54px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:173.96px;top:104.54px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:237.18px;top:104.54px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:296.44px;top:104.54px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:491.49px;top:104.54px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:136.63px;top:128.59px" class="cls_053"><span class="cls_053">REGIMM</span></div>
<div style="position:absolute;left:215.80px;top:128.59px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:259.08px;top:128.59px" class="cls_053"><span class="cls_053">BLTZAL</span></div>
<div style="position:absolute;left:390.19px;top:127.15px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:133.21px;top:138.17px" class="cls_053"><span class="cls_053">0 0 0 0 0 1</span></div>
<div style="position:absolute;left:257.42px;top:138.17px" class="cls_053"><span class="cls_053">1 0 0 0 0</span></div>
<div style="position:absolute;left:153.95px;top:152.57px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:219.04px;top:152.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:278.22px;top:152.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:391.19px;top:152.57px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:173.79px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.12px" class="cls_055"><span class="cls_055">BLTZAL rs, offset</span></div>
<div style="position:absolute;left:72.00px;top:215.79px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.12px" class="cls_055"><span class="cls_055">A branch target address is computed from the sum of the address of the instruction in the delay slot</span></div>
<div style="position:absolute;left:108.00px;top:247.12px" class="cls_055"><span class="cls_055">and the 16-bit </span><span class="cls_058">offset, </span><span class="cls_055">shifted left two bits and sign-extended.  Unconditionally, the address of the</span></div>
<div style="position:absolute;left:107.99px;top:260.12px" class="cls_055"><span class="cls_055">instruction after the delay slot is placed in the link register, </span><span class="cls_058">r31</span><span class="cls_055">.  If the contents of general register</span></div>
<div style="position:absolute;left:107.99px;top:273.12px" class="cls_058"><span class="cls_058">rs </span><span class="cls_055">have the sign bit set, then the program branches to the target address, with a delay of one</span></div>
<div style="position:absolute;left:107.99px;top:286.12px" class="cls_055"><span class="cls_055">instruction.</span></div>
<div style="position:absolute;left:107.99px;top:305.12px" class="cls_055"><span class="cls_055">General register </span><span class="cls_058">rs </span><span class="cls_055">may not be general register </span><span class="cls_058">31</span><span class="cls_055">, because such an instruction is not restartable.  An</span></div>
<div style="position:absolute;left:107.99px;top:318.12px" class="cls_055"><span class="cls_055">attempt to execute this instruction with register </span><span class="cls_058">31</span><span class="cls_055"> specified as </span><span class="cls_058">rs</span><span class="cls_055"> is not trapped, however.</span></div>
<div style="position:absolute;left:72.00px;top:338.79px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:136.39px;top:361.93px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:161.59px;top:359.93px" class="cls_053"><span class="cls_053">target </span><span class="cls_003">←</span><span class="cls_053"> (offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>14 </sup></span><span class="cls_053">|| offset || 0</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:161.59px;top:373.28px" class="cls_053"><span class="cls_053">condition </span><span class="cls_003">←</span><span class="cls_053"> (GPR[rs]</span><span class="cls_061"><sub>31 </sub></span><span class="cls_053">= 1)</span></div>
<div style="position:absolute;left:161.60px;top:385.47px" class="cls_053"><span class="cls_053">GPR[31] </span><span class="cls_003">←</span><span class="cls_053"> PC + 8</span></div>
<div style="position:absolute;left:136.40px;top:397.65px" class="cls_053"><span class="cls_053">T+1: if condition then</span></div>
<div style="position:absolute;left:188.95px;top:408.95px" class="cls_053"><span class="cls_053">PC </span><span class="cls_003">←</span><span class="cls_053"> PC + target</span></div>
<div style="position:absolute;left:161.60px;top:422.77px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:72.00px;top:455.78px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:474.12px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-19</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:185262px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:235.52px;top:67.24px" class="cls_064"><span class="cls_064">Branch On Not Equal</span></div>
<div style="position:absolute;left:105.28px;top:60.90px" class="cls_063"><span class="cls_063">BNE</span></div>
<div style="position:absolute;left:449.56px;top:60.39px" class="cls_063"><span class="cls_063">BNE</span></div>
<div style="position:absolute;left:118.01px;top:103.39px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:173.31px;top:103.39px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.53px;top:103.39px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.79px;top:103.39px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:490.84px;top:103.39px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:146.25px;top:127.44px" class="cls_053"><span class="cls_053">BNE</span></div>
<div style="position:absolute;left:215.15px;top:127.44px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:273.72px;top:127.44px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:389.53px;top:126.00px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:132.55px;top:137.02px" class="cls_053"><span class="cls_053">0 0 0 1 0 1</span></div>
<div style="position:absolute;left:153.29px;top:151.42px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:218.38px;top:151.42px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.56px;top:151.42px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:390.53px;top:151.42px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:174.51px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.84px" class="cls_055"><span class="cls_055">BNE rs, rt, offset</span></div>
<div style="position:absolute;left:72.00px;top:216.51px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.84px" class="cls_055"><span class="cls_055">A branch target address is computed from the sum of the address of the instruction in the delay slot</span></div>
<div style="position:absolute;left:108.00px;top:247.84px" class="cls_055"><span class="cls_055">and the 16-bit </span><span class="cls_058">offset, </span><span class="cls_055">shifted left two bits and sign-extended.  The contents of general register </span><span class="cls_058">rs </span><span class="cls_055">and</span></div>
<div style="position:absolute;left:108.00px;top:260.84px" class="cls_055"><span class="cls_055">the contents of general register </span><span class="cls_058">rt </span><span class="cls_055">are compared.  If the two registers are not equal, then the program</span></div>
<div style="position:absolute;left:108.00px;top:273.84px" class="cls_055"><span class="cls_055">branches to the target address, with a delay of one instruction.</span></div>
<div style="position:absolute;left:72.00px;top:294.51px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:164.49px;top:321.46px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:191.85px;top:319.46px" class="cls_053"><span class="cls_053">target </span><span class="cls_003">←</span><span class="cls_053">  (offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>14</sup></span><span class="cls_053"> || offset || 0</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:214.68px;top:335.14px" class="cls_053"><span class="cls_053">condition </span><span class="cls_003">←</span><span class="cls_053">  (GPR[rs] </span><span class="cls_003">≠</span><span class="cls_053"> GPR[rt])</span></div>
<div style="position:absolute;left:164.50px;top:348.60px" class="cls_053"><span class="cls_053">T+1:  if condition then</span></div>
<div style="position:absolute;left:226.78px;top:361.34px" class="cls_053"><span class="cls_053">PC </span><span class="cls_003">←</span><span class="cls_053"> PC + target</span></div>
<div style="position:absolute;left:72.00px;top:406.33px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:424.67px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-20</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:186064px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:269.42px;top:69.33px" class="cls_064"><span class="cls_064">Breakpoint</span></div>
<div style="position:absolute;left:105.50px;top:61.83px" class="cls_063"><span class="cls_063">BREAK</span></div>
<div style="position:absolute;left:416.03px;top:61.33px" class="cls_063"><span class="cls_063">BREAK</span></div>
<div style="position:absolute;left:117.47px;top:102.24px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:209.13px;top:102.24px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:230.73px;top:102.24px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:398.27px;top:102.25px" class="cls_053"><span class="cls_053">6 5</span></div>
<div style="position:absolute;left:490.14px;top:102.25px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:151.00px;top:127.01px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:306.36px;top:126.23px" class="cls_053"><span class="cls_053">code</span></div>
<div style="position:absolute;left:428.48px;top:126.23px" class="cls_053"><span class="cls_053">BREAK</span></div>
<div style="position:absolute;left:147.56px;top:135.86px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:421.82px;top:135.86px" class="cls_053"><span class="cls_053">0 0 1 1 0 1</span></div>
<div style="position:absolute;left:152.68px;top:150.27px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:315.83px;top:150.26px" class="cls_053"><span class="cls_053">20</span></div>
<div style="position:absolute;left:457.74px;top:150.27px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:172.35px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:193.68px" class="cls_055"><span class="cls_055">BREAK</span></div>
<div style="position:absolute;left:72.00px;top:214.35px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:232.68px" class="cls_055"><span class="cls_055">A breakpoint trap occurs, immediately and unconditionally transferring control to the exception</span></div>
<div style="position:absolute;left:108.00px;top:245.68px" class="cls_055"><span class="cls_055">handler.</span></div>
<div style="position:absolute;left:108.00px;top:264.68px" class="cls_055"><span class="cls_055">The </span><span class="cls_058">code</span><span class="cls_055"> field is available for use as software parameters, but is retrieved by the exception handler</span></div>
<div style="position:absolute;left:108.00px;top:277.68px" class="cls_055"><span class="cls_055">only by loading the contents of the memory word containing the instruction.</span></div>
<div style="position:absolute;left:72.00px;top:298.35px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:136.58px;top:333.44px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:162.13px;top:333.44px" class="cls_053"><span class="cls_053">BreakpointException</span></div>
<div style="position:absolute;left:72.00px;top:375.08px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:393.41px" class="cls_055"><span class="cls_055">Breakpoint exception</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-21</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:186866px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:241.87px;top:64.58px" class="cls_064"><span class="cls_064">Move Control From</span></div>
<div style="position:absolute;left:108.07px;top:61.33px" class="cls_063"><span class="cls_063">CFCz</span></div>
<div style="position:absolute;left:442.72px;top:61.33px" class="cls_063"><span class="cls_063">CFCz</span></div>
<div style="position:absolute;left:262.83px;top:77.33px" class="cls_064"><span class="cls_064">Coprocessor</span></div>
<div style="position:absolute;left:116.93px;top:102.82px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.16px;top:102.82px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.38px;top:102.82px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.64px;top:102.82px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:354.75px;top:102.82px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:489.62px;top:102.82px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:138.73px;top:126.80px" class="cls_053"><span class="cls_053">COPz</span></div>
<div style="position:absolute;left:211.57px;top:126.80px" class="cls_053"><span class="cls_053">CF</span></div>
<div style="position:absolute;left:272.57px;top:126.80px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:333.81px;top:126.79px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:427.42px;top:125.35px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:127.06px;top:136.37px" class="cls_053"><span class="cls_053">0 1 0 0 x x*</span></div>
<div style="position:absolute;left:199.88px;top:136.37px" class="cls_053"><span class="cls_053">0 0 0 1 0</span></div>
<div style="position:absolute;left:411.07px;top:136.37px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:152.14px;top:150.78px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.23px;top:150.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.49px;top:150.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:332.86px;top:150.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:430.13px;top:150.77px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:72.00px;top:173.71px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.05px" class="cls_055"><span class="cls_055">CFCz rt, rd</span></div>
<div style="position:absolute;left:72.00px;top:215.71px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.05px" class="cls_055"><span class="cls_055">The contents of coprocessor control register </span><span class="cls_058">rd </span><span class="cls_055">of coprocessor unit </span><span class="cls_058">z</span><span class="cls_055"> are loaded into general register</span></div>
<div style="position:absolute;left:108.00px;top:247.05px" class="cls_058"><span class="cls_058">rt.</span></div>
<div style="position:absolute;left:108.00px;top:266.05px" class="cls_055"><span class="cls_055">This instruction is not valid for CP0.</span></div>
<div style="position:absolute;left:72.00px;top:286.71px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:135.59px;top:309.35px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:160.79px;top:309.35px" class="cls_053"><span class="cls_053">data </span><span class="cls_003">←</span><span class="cls_053"> CCR[z,rd]</span></div>
<div style="position:absolute;left:135.59px;top:320.94px" class="cls_053"><span class="cls_053">T+1: GPR[rt]  </span><span class="cls_003">←</span><span class="cls_053"> data</span></div>
<div style="position:absolute;left:74.50px;top:383.75px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:402.09px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:72.00px;top:422.75px" class="cls_066"><span class="cls_066">*Opcode Bit Encoding:</span></div>
<div style="position:absolute;left:175.33px;top:442.39px" class="cls_053"><span class="cls_053">Bit #31</span></div>
<div style="position:absolute;left:217.74px;top:441.17px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:241.36px;top:441.17px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:263.69px;top:441.17px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:288.68px;top:441.17px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:315.03px;top:441.17px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:337.40px;top:441.53px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:359.79px;top:440.30px" class="cls_053"><span class="cls_053">24</span></div>
<div style="position:absolute;left:384.70px;top:440.30px" class="cls_053"><span class="cls_053">23</span></div>
<div style="position:absolute;left:411.06px;top:440.30px" class="cls_053"><span class="cls_053">22  21</span></div>
<div style="position:absolute;left:480.83px;top:441.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:112.27px;top:441.45px" class="cls_069"><span class="cls_069">CFCz</span></div>
<div style="position:absolute;left:196.52px;top:455.93px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:218.20px;top:455.93px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:242.53px;top:455.93px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:264.92px;top:455.93px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:289.11px;top:455.93px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:315.46px;top:455.93px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:341.02px;top:456.00px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:362.70px;top:456.00px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:387.03px;top:456.00px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:409.35px;top:456.00px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:433.62px;top:456.00px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:158.44px;top:459.89px" class="cls_053"><span class="cls_053">CFC1</span></div>
<div style="position:absolute;left:174.46px;top:473.86px" class="cls_053"><span class="cls_053">Bit #31</span></div>
<div style="position:absolute;left:216.88px;top:472.71px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:240.50px;top:472.71px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:262.82px;top:472.71px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:287.81px;top:472.71px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:314.10px;top:472.71px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:336.53px;top:473.00px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:358.86px;top:471.77px" class="cls_053"><span class="cls_053">24</span></div>
<div style="position:absolute;left:383.85px;top:471.77px" class="cls_053"><span class="cls_053">23</span></div>
<div style="position:absolute;left:410.20px;top:471.77px" class="cls_053"><span class="cls_053">22  21</span></div>
<div style="position:absolute;left:479.97px;top:473.00px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:195.65px;top:487.47px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:217.33px;top:487.47px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:241.66px;top:487.47px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:263.99px;top:487.47px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:288.33px;top:487.47px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:314.61px;top:487.47px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:340.16px;top:487.54px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:361.84px;top:487.54px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:386.17px;top:487.54px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:408.49px;top:487.54px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:432.83px;top:487.54px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:157.50px;top:491.36px" class="cls_053"><span class="cls_053">CFC2</span></div>
<div style="position:absolute;left:174.39px;top:504.89px" class="cls_053"><span class="cls_053">Bit #31</span></div>
<div style="position:absolute;left:216.88px;top:503.67px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:240.50px;top:503.67px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:262.82px;top:503.67px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:287.81px;top:503.67px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:314.17px;top:503.67px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:336.53px;top:503.95px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:358.93px;top:502.81px" class="cls_053"><span class="cls_053">24</span></div>
<div style="position:absolute;left:383.84px;top:502.81px" class="cls_053"><span class="cls_053">23</span></div>
<div style="position:absolute;left:410.19px;top:502.81px" class="cls_053"><span class="cls_053">22  21</span></div>
<div style="position:absolute;left:479.97px;top:503.95px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:195.65px;top:518.43px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:217.40px;top:518.43px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:241.66px;top:518.43px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:263.99px;top:518.43px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:288.33px;top:518.43px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:314.61px;top:518.43px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:340.16px;top:518.43px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:361.91px;top:518.43px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:386.17px;top:518.43px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:408.56px;top:518.43px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:432.82px;top:518.43px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:157.57px;top:522.31px" class="cls_053"><span class="cls_053">CFC3</span></div>
<div style="position:absolute;left:214.15px;top:547.60px" class="cls_053"><span class="cls_053">Opcode</span></div>
<div style="position:absolute;left:331.58px;top:547.60px" class="cls_053"><span class="cls_053">Coprocessor Suboperation</span></div>
<div style="position:absolute;left:240.24px;top:558.76px" class="cls_053"><span class="cls_053">Coprocessor Unit Number</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-22</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:187668px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:227.84px;top:66.90px" class="cls_064"><span class="cls_064">Coprocessor Operation</span></div>
<div style="position:absolute;left:102.78px;top:61.04px" class="cls_063"><span class="cls_063">COPz</span></div>
<div style="position:absolute;left:439.80px;top:61.40px" class="cls_063"><span class="cls_063">COPz</span></div>
<div style="position:absolute;left:114.98px;top:105.26px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:173.74px;top:105.26px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:198.15px;top:105.26px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:217.61px;top:105.26px" class="cls_053"><span class="cls_053">24</span></div>
<div style="position:absolute;left:487.66px;top:105.26px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:140.16px;top:129.24px" class="cls_053"><span class="cls_053">COPz</span></div>
<div style="position:absolute;left:191.58px;top:129.24px" class="cls_053"><span class="cls_053">CO</span></div>
<div style="position:absolute;left:325.52px;top:129.24px" class="cls_053"><span class="cls_053">cofun</span></div>
<div style="position:absolute;left:132.17px;top:138.89px" class="cls_053"><span class="cls_053">0 1 0 0 x x*</span></div>
<div style="position:absolute;left:195.38px;top:138.89px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:150.18px;top:153.29px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:195.84px;top:153.29px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:332.58px;top:153.29px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:72.00px;top:171.91px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:193.25px" class="cls_055"><span class="cls_055">COPz cofun</span></div>
<div style="position:absolute;left:72.00px;top:207.91px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:226.25px" class="cls_055"><span class="cls_055">A coprocessor operation is performed.  The operation may specify and reference internal</span></div>
<div style="position:absolute;left:108.00px;top:239.25px" class="cls_055"><span class="cls_055">coprocessor registers, and may change the state of the coprocessor condition line, but does not</span></div>
<div style="position:absolute;left:108.00px;top:252.25px" class="cls_055"><span class="cls_055">modify state within the processor or the cache/memory system.  Details of coprocessor operations</span></div>
<div style="position:absolute;left:108.00px;top:265.25px" class="cls_055"><span class="cls_055">are contained in other appendices.</span></div>
<div style="position:absolute;left:72.00px;top:279.91px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:137.00px;top:303.27px" class="cls_053"><span class="cls_053">CoprocessorOperation (z, cofun)</span></div>
<div style="position:absolute;left:72.00px;top:326.53px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:344.86px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:108.00px;top:357.86px" class="cls_055"><span class="cls_055">Coprocessor interrupt or Floating-Point Exception (CP1 only for some processors)</span></div>
<div style="position:absolute;left:72.00px;top:372.53px" class="cls_066"><span class="cls_066">*Opcode Bit Encoding:</span></div>
<div style="position:absolute;left:112.34px;top:385.92px" class="cls_069"><span class="cls_069">COPz</span></div>
<div style="position:absolute;left:166.10px;top:394.28px" class="cls_053"><span class="cls_053">Bit #</span></div>
<div style="position:absolute;left:191.94px;top:391.26px" class="cls_053"><span class="cls_053">31 30 29 28 27  26</span></div>
<div style="position:absolute;left:285.54px;top:391.26px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:486.92px;top:393.35px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:191.40px;top:407.82px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:207.89px;top:407.82px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:222.66px;top:407.82px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:237.49px;top:407.82px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:253.91px;top:407.82px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:271.19px;top:407.82px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:286.01px;top:407.82px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:158.51px;top:411.78px" class="cls_053"><span class="cls_053">C0P0</span></div>
<div style="position:absolute;left:191.94px;top:423.73px" class="cls_053"><span class="cls_053">31 30 29 28 27  26</span></div>
<div style="position:absolute;left:285.54px;top:423.73px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:166.10px;top:426.68px" class="cls_053"><span class="cls_053">Bit #</span></div>
<div style="position:absolute;left:486.92px;top:425.82px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:191.40px;top:440.22px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:207.89px;top:440.22px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:222.66px;top:440.22px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:237.49px;top:440.22px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:253.91px;top:440.22px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:271.19px;top:440.22px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:286.01px;top:440.22px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:158.51px;top:444.18px" class="cls_053"><span class="cls_053">C0P1</span></div>
<div style="position:absolute;left:191.08px;top:456.99px" class="cls_053"><span class="cls_053">31 30 29 28 27  26</span></div>
<div style="position:absolute;left:284.75px;top:456.99px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:165.31px;top:459.94px" class="cls_053"><span class="cls_053">Bit #</span></div>
<div style="position:absolute;left:486.06px;top:459.08px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:190.61px;top:473.55px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:207.10px;top:473.55px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:221.86px;top:473.55px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:236.70px;top:473.55px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:253.04px;top:473.55px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:270.32px;top:473.55px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:285.15px;top:473.55px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:157.72px;top:477.44px" class="cls_053"><span class="cls_053">C0P2</span></div>
<div style="position:absolute;left:190.22px;top:491.48px" class="cls_053"><span class="cls_053">31 30 29 28 27  26</span></div>
<div style="position:absolute;left:283.89px;top:491.48px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:164.45px;top:494.43px" class="cls_053"><span class="cls_053">Bit #</span></div>
<div style="position:absolute;left:485.27px;top:493.50px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:189.82px;top:507.97px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:206.24px;top:507.97px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:221.00px;top:507.97px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:235.83px;top:507.97px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:252.25px;top:507.97px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:269.54px;top:507.97px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:284.28px;top:507.97px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:156.86px;top:511.86px" class="cls_053"><span class="cls_053">C0P3</span></div>
<div style="position:absolute;left:307.20px;top:532.09px" class="cls_053"><span class="cls_053">CO sub-opcode (see end of Appendix A)</span></div>
<div style="position:absolute;left:196.40px;top:537.28px" class="cls_053"><span class="cls_053">Opcode</span></div>
<div style="position:absolute;left:272.99px;top:542.39px" class="cls_053"><span class="cls_053">Coprocessor Unit Number</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-23</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:188470px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:207.63px;top:68.36px" class="cls_064"><span class="cls_064">Move Control to Coprocessor</span></div>
<div style="position:absolute;left:103.90px;top:62.19px" class="cls_063"><span class="cls_063">CTCz</span></div>
<div style="position:absolute;left:439.46px;top:61.69px" class="cls_063"><span class="cls_063">CTCz</span></div>
<div style="position:absolute;left:112.14px;top:101.66px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:167.37px;top:101.66px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:230.59px;top:101.66px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:289.85px;top:101.66px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:349.96px;top:101.67px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:484.83px;top:101.67px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:137.33px;top:125.64px" class="cls_053"><span class="cls_053">COPz</span></div>
<div style="position:absolute;left:206.79px;top:125.64px" class="cls_053"><span class="cls_053">CT</span></div>
<div style="position:absolute;left:267.79px;top:125.64px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:329.02px;top:125.64px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:422.64px;top:124.20px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:125.71px;top:135.29px" class="cls_053"><span class="cls_053">0 1 0 0 z z *</span></div>
<div style="position:absolute;left:195.09px;top:135.29px" class="cls_053"><span class="cls_053">0 0 1 1 0</span></div>
<div style="position:absolute;left:378.49px;top:135.29px" class="cls_053"><span class="cls_053">0 0 0  0 0 0 0  0 0 0 0</span></div>
<div style="position:absolute;left:147.35px;top:149.69px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:212.44px;top:149.69px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:271.70px;top:149.69px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:328.08px;top:149.69px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:425.34px;top:149.69px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:72.00px;top:172.27px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:193.61px" class="cls_055"><span class="cls_055">CTCz rt, rd</span></div>
<div style="position:absolute;left:72.00px;top:214.27px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:232.61px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rt </span><span class="cls_055">are loaded into control register </span><span class="cls_058">rd </span><span class="cls_055">of coprocessor unit </span><span class="cls_058">z.</span></div>
<div style="position:absolute;left:108.01px;top:251.61px" class="cls_055"><span class="cls_055">This instruction is not valid for CP0.</span></div>
<div style="position:absolute;left:72.00px;top:272.27px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:108.10px;top:292.75px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:141.99px;top:292.75px" class="cls_053"><span class="cls_053">data </span><span class="cls_003">←</span><span class="cls_053"> GPR[rt]</span></div>
<div style="position:absolute;left:136.91px;top:307.15px" class="cls_053"><span class="cls_053">T + 1:  CCR[z,rd]  </span><span class="cls_003">←</span><span class="cls_053"> data</span></div>
<div style="position:absolute;left:72.00px;top:337.05px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:355.39px" class="cls_055"><span class="cls_055">Coprocessor unusable</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-24</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:189272px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:264.95px;top:65.25px" class="cls_064"><span class="cls_064">Divide Word</span></div>
<div style="position:absolute;left:107.13px;top:59.38px" class="cls_063"><span class="cls_063">DIV</span></div>
<div style="position:absolute;left:460.80px;top:59.74px" class="cls_063"><span class="cls_063">DIV</span></div>
<div style="position:absolute;left:116.57px;top:105.48px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:105.48px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:105.48px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:105.48px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:416.59px;top:105.48px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:432.72px;top:105.48px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:489.40px;top:105.48px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:134.67px;top:124.27px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:365.21px;top:123.79px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:451.53px;top:124.27px" class="cls_053"><span class="cls_053">DIV</span></div>
<div style="position:absolute;left:213.71px;top:126.29px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:272.28px;top:126.29px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:131.11px;top:134.57px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:321.53px;top:134.57px" class="cls_053"><span class="cls_053">0 0</span></div>
<div style="position:absolute;left:343.77px;top:134.57px" class="cls_053"><span class="cls_053">0 0 0 0  0 0 0 0</span></div>
<div style="position:absolute;left:438.38px;top:134.57px" class="cls_053"><span class="cls_053">0 1 1 0 1 0</span></div>
<div style="position:absolute;left:151.85px;top:147.03px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.94px;top:147.03px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.12px;top:147.03px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:362.59px;top:147.02px" class="cls_053"><span class="cls_053">10</span></div>
<div style="position:absolute;left:459.87px;top:147.02px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:167.59px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:188.93px" class="cls_055"><span class="cls_055">DIV rs, rt</span></div>
<div style="position:absolute;left:72.00px;top:209.59px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:227.93px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rs </span><span class="cls_055">are divided by the contents of general register </span><span class="cls_058">rt, </span><span class="cls_055">treating both</span></div>
<div style="position:absolute;left:108.00px;top:240.93px" class="cls_055"><span class="cls_055">operands as 2’s complement values.   No overflow exception occurs under any circumstances, and</span></div>
<div style="position:absolute;left:108.00px;top:253.93px" class="cls_055"><span class="cls_055">the result of this operation is undefined when the divisor is zero.</span></div>
<div style="position:absolute;left:108.00px;top:272.93px" class="cls_055"><span class="cls_055">This instruction is typically followed by additional instructions to check for a zero divisor and for</span></div>
<div style="position:absolute;left:108.00px;top:285.93px" class="cls_055"><span class="cls_055">overflow.</span></div>
<div style="position:absolute;left:108.00px;top:304.93px" class="cls_055"><span class="cls_055">When the operation completes, the quotient word of the double result is loaded into special register</span></div>
<div style="position:absolute;left:108.00px;top:317.93px" class="cls_058"><span class="cls_058">LO</span><span class="cls_055">, and the remainder word of the double result is loaded into special register </span><span class="cls_058">HI</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:336.93px" class="cls_055"><span class="cls_055">If either of the two preceding instructions is MFHI or MFLO, the results of those instructions are</span></div>
<div style="position:absolute;left:108.00px;top:349.93px" class="cls_055"><span class="cls_055">undefined.  Correct operation requires separating reads of </span><span class="cls_058">HI</span><span class="cls_055"> or </span><span class="cls_058">LO</span><span class="cls_055"> from writes by two or more</span></div>
<div style="position:absolute;left:108.01px;top:362.93px" class="cls_055"><span class="cls_055">instructions.</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-25</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:190074px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:221.78px;top:69.88px" class="cls_064"><span class="cls_064">Divide Word (Continued)</span></div>
<div style="position:absolute;left:106.63px;top:62.26px" class="cls_063"><span class="cls_063">DIV</span></div>
<div style="position:absolute;left:460.30px;top:62.26px" class="cls_063"><span class="cls_063">DIV</span></div>
<div style="position:absolute;left:72.00px;top:122.70px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:178.44px;top:146.80px" class="cls_053"><span class="cls_053">T-2:</span></div>
<div style="position:absolute;left:236.84px;top:146.80px" class="cls_053"><span class="cls_053">LO</span></div>
<div style="position:absolute;left:287.59px;top:146.80px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:236.83px;top:159.40px" class="cls_053"><span class="cls_053">HI</span></div>
<div style="position:absolute;left:287.59px;top:159.41px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:178.44px;top:171.71px" class="cls_053"><span class="cls_053">T-1:</span></div>
<div style="position:absolute;left:236.84px;top:171.71px" class="cls_053"><span class="cls_053">LO</span></div>
<div style="position:absolute;left:287.59px;top:171.72px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:236.83px;top:184.02px" class="cls_053"><span class="cls_053">HI</span></div>
<div style="position:absolute;left:287.59px;top:184.03px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:178.44px;top:196.34px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:236.84px;top:196.34px" class="cls_053"><span class="cls_053">LO</span></div>
<div style="position:absolute;left:287.59px;top:196.34px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> GPR[rs] div GPR[rt]</span></div>
<div style="position:absolute;left:236.83px;top:209.73px" class="cls_053"><span class="cls_053">HI</span></div>
<div style="position:absolute;left:265.63px;top:209.73px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> GPR[rs] mod GPR[rt]</span></div>
<div style="position:absolute;left:74.75px;top:248.33px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:266.67px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-26</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:190876px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:231.48px;top:66.70px" class="cls_064"><span class="cls_064">Divide Unsigned Word</span></div>
<div style="position:absolute;left:105.27px;top:61.18px" class="cls_063"><span class="cls_063">DIVU</span></div>
<div style="position:absolute;left:440.83px;top:60.68px" class="cls_063"><span class="cls_063">DIVU</span></div>
<div style="position:absolute;left:117.58px;top:106.13px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.88px;top:106.13px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.10px;top:106.13px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.36px;top:106.13px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:417.60px;top:106.13px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:433.73px;top:106.13px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:490.41px;top:106.13px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:135.68px;top:125.21px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:214.72px;top:127.23px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:273.29px;top:127.23px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:366.23px;top:125.21px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:451.03px;top:125.21px" class="cls_053"><span class="cls_053">DIVU</span></div>
<div style="position:absolute;left:132.12px;top:135.65px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:325.32px;top:135.65px" class="cls_053"><span class="cls_053">0 0 0 0 0 0  0 0 0 0</span></div>
<div style="position:absolute;left:439.39px;top:135.65px" class="cls_053"><span class="cls_053">0 1 1 0 1 1</span></div>
<div style="position:absolute;left:152.86px;top:148.33px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.95px;top:148.33px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.13px;top:148.33px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:363.60px;top:148.32px" class="cls_053"><span class="cls_053">10</span></div>
<div style="position:absolute;left:460.87px;top:148.32px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:169.68px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:191.01px" class="cls_055"><span class="cls_055">DIVU rs, rt</span></div>
<div style="position:absolute;left:72.00px;top:211.68px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:230.01px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rs </span><span class="cls_055">are divided by the contents of general register </span><span class="cls_058">rt, </span><span class="cls_055">treating both</span></div>
<div style="position:absolute;left:108.00px;top:243.01px" class="cls_055"><span class="cls_055">operands as unsigned values.  No integer overflow exception occurs under any circumstances, and</span></div>
<div style="position:absolute;left:108.00px;top:256.02px" class="cls_055"><span class="cls_055">the result of this operation is undefined when the divisor is zero.</span></div>
<div style="position:absolute;left:108.00px;top:275.02px" class="cls_055"><span class="cls_055">On processors with 64-bit registers the operands must be valid sign-extended 32-bit values.  If they</span></div>
<div style="position:absolute;left:108.00px;top:288.02px" class="cls_055"><span class="cls_055">are not, the result is undefined.</span></div>
<div style="position:absolute;left:108.00px;top:307.02px" class="cls_055"><span class="cls_055">This instruction is typically followed by additional instructions to check for a zero divisor.</span></div>
<div style="position:absolute;left:108.00px;top:326.02px" class="cls_055"><span class="cls_055">When the operation completes, the quotient word of the double result is loaded into special register</span></div>
<div style="position:absolute;left:108.00px;top:339.02px" class="cls_058"><span class="cls_058">LO</span><span class="cls_055">, and the remainder word of the double result is loaded into special register </span><span class="cls_058">HI</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:358.02px" class="cls_055"><span class="cls_055">If either of the two preceding instructions is MFHI or MFLO, the results of those instructions are</span></div>
<div style="position:absolute;left:108.00px;top:371.02px" class="cls_055"><span class="cls_055">undefined.  Correct operation requires separating reads of </span><span class="cls_058">HI</span><span class="cls_055"> or </span><span class="cls_058">LO</span><span class="cls_055"> from writes by two or more</span></div>
<div style="position:absolute;left:108.01px;top:384.02px" class="cls_055"><span class="cls_055">instructions.</span></div>
<div style="position:absolute;left:72.00px;top:404.68px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:177.51px;top:423.22px" class="cls_053"><span class="cls_053">T-2:</span></div>
<div style="position:absolute;left:233.56px;top:423.22px" class="cls_053"><span class="cls_053">LO</span></div>
<div style="position:absolute;left:282.28px;top:423.22px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:233.56px;top:435.16px" class="cls_053"><span class="cls_053">HI</span></div>
<div style="position:absolute;left:282.28px;top:435.17px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:177.51px;top:446.90px" class="cls_053"><span class="cls_053">T-1:</span></div>
<div style="position:absolute;left:233.56px;top:446.90px" class="cls_053"><span class="cls_053">LO</span></div>
<div style="position:absolute;left:282.28px;top:446.91px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:233.56px;top:458.64px" class="cls_053"><span class="cls_053">HI</span></div>
<div style="position:absolute;left:282.28px;top:458.65px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:177.52px;top:470.38px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:233.57px;top:470.38px" class="cls_053"><span class="cls_053">LO</span></div>
<div style="position:absolute;left:282.29px;top:470.37px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> (0 || GPR[rs]) div (0 || GPR[rt])</span></div>
<div style="position:absolute;left:233.56px;top:483.13px" class="cls_053"><span class="cls_053">HI</span></div>
<div style="position:absolute;left:262.36px;top:483.12px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> (0 || GPR[rs]) mod (0 || GPR[rt])</span></div>
<div style="position:absolute;left:72.00px;top:521.31px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:539.65px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-27</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:191678px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:288.20px;top:67.72px" class="cls_064"><span class="cls_064">Jump</span></div>
<div style="position:absolute;left:108.37px;top:61.18px" class="cls_063"><span class="cls_063">J</span></div>
<div style="position:absolute;left:489.68px;top:60.90px" class="cls_063"><span class="cls_063">J</span></div>
<div style="position:absolute;left:116.64px;top:103.61px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:103.61px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:489.31px;top:103.61px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:152.66px;top:127.59px" class="cls_053"><span class="cls_053">J</span></div>
<div style="position:absolute;left:294.77px;top:127.59px" class="cls_053"><span class="cls_053">target</span></div>
<div style="position:absolute;left:128.16px;top:137.24px" class="cls_053"><span class="cls_053">0 0 0 0 1 0</span></div>
<div style="position:absolute;left:151.85px;top:151.64px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:316.37px;top:151.64px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:72.00px;top:172.06px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:193.39px" class="cls_055"><span class="cls_055">J target</span></div>
<div style="position:absolute;left:72.00px;top:214.06px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:232.39px" class="cls_055"><span class="cls_055">The 26-bit target address is shifted left two bits and combined with the high-order bits of the</span></div>
<div style="position:absolute;left:108.00px;top:245.39px" class="cls_055"><span class="cls_055">address of the delay slot.  The program unconditionally jumps to this calculated address with a</span></div>
<div style="position:absolute;left:108.00px;top:258.39px" class="cls_055"><span class="cls_055">delay of one instruction.</span></div>
<div style="position:absolute;left:72.00px;top:279.06px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:161.88px;top:303.73px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:189.24px;top:303.73px" class="cls_053"><span class="cls_053">temp </span><span class="cls_003">← </span><span class="cls_053">target</span></div>
<div style="position:absolute;left:161.88px;top:312.74px" class="cls_053"><span class="cls_053">T+1:  PC </span><span class="cls_003">← </span><span class="cls_053">PC</span><span class="cls_061"><sub>31...28</sub></span><span class="cls_053"> || temp || 0</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:72.00px;top:388.55px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:406.89px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-28</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:192480px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:255.45px;top:65.98px" class="cls_064"><span class="cls_064">Jump And Link</span></div>
<div style="position:absolute;left:108.29px;top:61.18px" class="cls_063"><span class="cls_063">JAL</span></div>
<div style="position:absolute;left:454.61px;top:60.90px" class="cls_063"><span class="cls_063">JAL</span></div>
<div style="position:absolute;left:116.64px;top:104.54px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:104.54px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:489.31px;top:104.54px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:146.55px;top:128.52px" class="cls_053"><span class="cls_053">JAL</span></div>
<div style="position:absolute;left:294.77px;top:128.52px" class="cls_053"><span class="cls_053">target</span></div>
<div style="position:absolute;left:128.16px;top:138.17px" class="cls_053"><span class="cls_053">0 0 0 0 1 1</span></div>
<div style="position:absolute;left:151.85px;top:152.57px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:316.37px;top:152.57px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:72.00px;top:173.07px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:194.40px" class="cls_055"><span class="cls_055">JAL target</span></div>
<div style="position:absolute;left:72.00px;top:215.07px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:233.40px" class="cls_055"><span class="cls_055">The 26-bit target address is shifted left two bits and combined with the high-order bits of the</span></div>
<div style="position:absolute;left:108.00px;top:246.40px" class="cls_055"><span class="cls_055">address of the delay slot.  The program unconditionally jumps to this calculated address with a</span></div>
<div style="position:absolute;left:108.00px;top:259.40px" class="cls_055"><span class="cls_055">delay of one instruction.  The address of the instruction after the delay slot is placed in the link</span></div>
<div style="position:absolute;left:108.00px;top:272.40px" class="cls_055"><span class="cls_055">register,</span><span class="cls_058"> r31.</span></div>
<div style="position:absolute;left:72.00px;top:293.07px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:136.40px;top:313.87px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:161.59px;top:313.87px" class="cls_053"><span class="cls_053">temp </span><span class="cls_003">←</span><span class="cls_053"> target</span></div>
<div style="position:absolute;left:161.60px;top:328.27px" class="cls_053"><span class="cls_053">GPR[31] </span><span class="cls_003">←</span><span class="cls_053"> PC + 8</span></div>
<div style="position:absolute;left:136.40px;top:339.74px" class="cls_053"><span class="cls_053">T+1: PC </span><span class="cls_003">← </span><span class="cls_053">PC </span><span class="cls_061"><sub>31...28</sub></span><span class="cls_053"> || temp || 0</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:72.00px;top:425.16px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:443.50px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-29</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:193282px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:108.29px;top:62.05px" class="cls_063"><span class="cls_063">JALR</span><span class="cls_064">    Jump And Link Register</span></div>
<div style="position:absolute;left:436.25px;top:61.69px" class="cls_063"><span class="cls_063">JALR</span></div>
<div style="position:absolute;left:117.22px;top:105.05px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.45px;top:105.05px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.67px;top:105.05px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.93px;top:105.05px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:355.03px;top:105.05px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:414.38px;top:105.05px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:430.44px;top:105.05px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:489.91px;top:105.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:134.62px;top:129.03px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:214.36px;top:129.03px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:334.10px;top:129.02px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:452.18px;top:129.02px" class="cls_053"><span class="cls_053">JALR</span></div>
<div style="position:absolute;left:128.75px;top:138.67px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:257.76px;top:138.67px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:377.70px;top:138.67px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:440.77px;top:138.67px" class="cls_053"><span class="cls_053">0 0 1 0 0 1</span></div>
<div style="position:absolute;left:152.43px;top:153.08px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.52px;top:153.08px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.78px;top:153.08px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:333.14px;top:153.07px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:392.61px;top:153.07px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:457.48px;top:153.07px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:174.00px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.34px" class="cls_055"><span class="cls_055">JALR rs</span></div>
<div style="position:absolute;left:108.00px;top:208.34px" class="cls_055"><span class="cls_055">JALR rd, rs</span></div>
<div style="position:absolute;left:72.00px;top:229.00px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:247.33px" class="cls_055"><span class="cls_055">The program unconditionally jumps to the address contained in general register </span><span class="cls_058">rs</span><span class="cls_055">, with a delay of</span></div>
<div style="position:absolute;left:108.00px;top:260.33px" class="cls_055"><span class="cls_055">one instruction.  The address of the instruction after the delay slot is placed in general register </span><span class="cls_058">rd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:273.33px" class="cls_055"><span class="cls_055">The default value of </span><span class="cls_058">rd</span><span class="cls_055">, if omitted in the assembly language instruction, is 31.</span></div>
<div style="position:absolute;left:108.00px;top:292.33px" class="cls_055"><span class="cls_055">Register specifiers </span><span class="cls_058">rs </span><span class="cls_055">and </span><span class="cls_058">rd </span><span class="cls_055">may not be equal, because such an instruction does not have the same</span></div>
<div style="position:absolute;left:108.00px;top:305.33px" class="cls_055"><span class="cls_055">effect when re-executed.  However, an attempt to execute this instruction is </span><span class="cls_058">not </span><span class="cls_055">trapped, and the</span></div>
<div style="position:absolute;left:108.00px;top:318.33px" class="cls_055"><span class="cls_055">result of executing such an instruction is undefined.</span></div>
<div style="position:absolute;left:108.00px;top:337.33px" class="cls_055"><span class="cls_055">A Jump and Link Register instruction that uses a register whose low-order 2 bits are non-zero, or</span></div>
<div style="position:absolute;left:108.00px;top:350.33px" class="cls_055"><span class="cls_055">specifies an address outside of the accessible address space, causes an Address Error Exception</span></div>
<div style="position:absolute;left:108.00px;top:363.33px" class="cls_055"><span class="cls_055">when the jump is executed.  The Exception PC points to the location of the Jump instruction causing</span></div>
<div style="position:absolute;left:108.00px;top:376.33px" class="cls_055"><span class="cls_055">the error, and the instruction in the delay slot is not executed.  If desired, system software can</span></div>
<div style="position:absolute;left:108.00px;top:389.33px" class="cls_055"><span class="cls_055">emulate the delay instruction and advance the PC to the target of the jump before delivering the</span></div>
<div style="position:absolute;left:108.00px;top:402.33px" class="cls_055"><span class="cls_055">exception to the user program.</span></div>
<div style="position:absolute;left:72.00px;top:423.00px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:161.53px;top:448.16px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:215.53px;top:448.16px" class="cls_053"><span class="cls_053">temp</span><span class="cls_003"> ← </span><span class="cls_053">GPR [rs]</span></div>
<div style="position:absolute;left:215.53px;top:459.17px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> PC + 8</span></div>
<div style="position:absolute;left:161.53px;top:470.18px" class="cls_053"><span class="cls_053">T+1:</span></div>
<div style="position:absolute;left:215.53px;top:470.18px" class="cls_053"><span class="cls_053">PC </span><span class="cls_003">←</span><span class="cls_053"> PC + target</span></div>
<div style="position:absolute;left:72.00px;top:503.62px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:521.96px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-30</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:194084px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:257.24px;top:67.56px" class="cls_064"><span class="cls_064">Jump Register</span></div>
<div style="position:absolute;left:108.36px;top:60.97px" class="cls_063"><span class="cls_063">JR</span></div>
<div style="position:absolute;left:470.38px;top:60.82px" class="cls_063"><span class="cls_063">JR</span></div>
<div style="position:absolute;left:116.64px;top:105.55px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:185.40px;top:105.55px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:207.00px;top:105.55px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:252.58px;top:105.55px" class="cls_053"><span class="cls_053">21 20</span></div>
<div style="position:absolute;left:413.63px;top:105.56px" class="cls_053"><span class="cls_053">6 5</span></div>
<div style="position:absolute;left:489.31px;top:105.56px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:135.48px;top:129.53px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:224.43px;top:129.54px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:449.42px;top:129.54px" class="cls_053"><span class="cls_053">JR</span></div>
<div style="position:absolute;left:128.73px;top:139.18px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:276.49px;top:139.18px" class="cls_053"><span class="cls_053">0 0 0  0 0 0 0  0 0 0 0  0 0 0 0</span></div>
<div style="position:absolute;left:435.42px;top:139.18px" class="cls_053"><span class="cls_053">0 0 1 0 0 0</span></div>
<div style="position:absolute;left:156.60px;top:153.58px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:227.51px;top:153.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:333.57px;top:153.58px" class="cls_053"><span class="cls_053">15</span></div>
<div style="position:absolute;left:456.91px;top:153.58px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:174.00px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.34px" class="cls_055"><span class="cls_055">JR  rs</span></div>
<div style="position:absolute;left:72.00px;top:216.00px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.34px" class="cls_055"><span class="cls_055">The program unconditionally jumps to the address contained in general register </span><span class="cls_058">rs</span><span class="cls_055">, with a delay of</span></div>
<div style="position:absolute;left:108.00px;top:247.33px" class="cls_055"><span class="cls_055">one instruction.</span></div>
<div style="position:absolute;left:108.00px;top:266.33px" class="cls_055"><span class="cls_055">Since instructions must be word-aligned, a </span><span class="cls_060">Jump Register</span><span class="cls_058"> </span><span class="cls_055">instruction must specify a target register</span></div>
<div style="position:absolute;left:108.00px;top:279.33px" class="cls_055"><span class="cls_055">(</span><span class="cls_058">rs</span><span class="cls_055">) whose two low-order bits are zero.  If these low-order bits are not zero, an address exception</span></div>
<div style="position:absolute;left:108.00px;top:292.33px" class="cls_055"><span class="cls_055">will occur when the jump target instruction is subsequently fetched.</span></div>
<div style="position:absolute;left:72.00px;top:313.00px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:161.32px;top:342.91px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:215.32px;top:342.91px" class="cls_053"><span class="cls_053">temp </span><span class="cls_003">←</span><span class="cls_053"> GPR[rs]</span></div>
<div style="position:absolute;left:163.19px;top:358.86px" class="cls_053"><span class="cls_053">T+1:</span></div>
<div style="position:absolute;left:217.19px;top:358.86px" class="cls_053"><span class="cls_053">PC</span><span class="cls_003"> ← </span><span class="cls_053"> PC + target</span></div>
<div style="position:absolute;left:72.00px;top:397.44px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:415.77px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-31</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:194886px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:272.36px;top:69.94px" class="cls_064"><span class="cls_064">Load Byte</span></div>
<div style="position:absolute;left:109.09px;top:62.55px" class="cls_063"><span class="cls_063">LB</span></div>
<div style="position:absolute;left:475.90px;top:61.26px" class="cls_063"><span class="cls_063">LB</span></div>
<div style="position:absolute;left:117.40px;top:105.26px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.70px;top:105.26px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.92px;top:105.26px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.18px;top:105.26px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:490.23px;top:105.26px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:149.81px;top:129.24px" class="cls_053"><span class="cls_053">LB</span></div>
<div style="position:absolute;left:207.87px;top:129.24px" class="cls_053"><span class="cls_053">base</span></div>
<div style="position:absolute;left:273.11px;top:129.24px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:388.93px;top:127.80px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:131.94px;top:138.82px" class="cls_053"><span class="cls_053">1 0 0 0 0 0</span></div>
<div style="position:absolute;left:152.68px;top:153.22px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.77px;top:153.22px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.95px;top:153.22px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:389.92px;top:153.22px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:173.50px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:194.83px" class="cls_055"><span class="cls_055">LB rt, offset(base)</span></div>
<div style="position:absolute;left:72.00px;top:215.50px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:233.83px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">offset </span><span class="cls_055">is sign-extended and added to the contents of general register </span><span class="cls_058">base </span><span class="cls_055">to form a virtual</span></div>
<div style="position:absolute;left:108.00px;top:246.83px" class="cls_055"><span class="cls_055">address.  The contents of the byte at the memory location specified by the effective address are sign-</span></div>
<div style="position:absolute;left:108.00px;top:259.83px" class="cls_055"><span class="cls_055">extended and loaded into general register </span><span class="cls_058">rt</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:72.00px;top:280.50px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:173.37px;top:304.70px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:202.30px;top:302.89px" class="cls_053"><span class="cls_053">vAddr </span><span class="cls_003">←</span><span class="cls_053"> ((offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16</sup></span><span class="cls_053"> || offset</span><span class="cls_061"><sub>15...0</sub></span><span class="cls_053">) + GPR[base]</span></div>
<div style="position:absolute;left:202.31px;top:318.35px" class="cls_053"><span class="cls_053">(pAddr, uncached) </span><span class="cls_003">←</span><span class="cls_053"> AddressTranslation (vAddr, DATA)</span></div>
<div style="position:absolute;left:200.91px;top:332.20px" class="cls_053"><span class="cls_053">pAddr </span><span class="cls_003">←</span><span class="cls_053">  pAddr</span><span class="cls_061"><sub>PSIZE - 1 ... 2 </sub></span><span class="cls_053">|| (pAddr</span><span class="cls_061"><sub>1...0</sub></span><span class="cls_053"> xor ReverseEndian</span><span class="cls_061"><sup>2</sup></span><span class="cls_053">)</span></div>
<div style="position:absolute;left:202.31px;top:347.15px" class="cls_053"><span class="cls_053">mem </span><span class="cls_003">←</span><span class="cls_053"> LoadMemory (uncached, BYTE, pAddr, vAddr, DATA)</span></div>
<div style="position:absolute;left:202.31px;top:358.55px" class="cls_053"><span class="cls_053">byte </span><span class="cls_003">←</span><span class="cls_053"> vAddr</span><span class="cls_061"><sub>1...0 </sub></span><span class="cls_053">xor BigEndianCPU</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:172.67px;top:376.79px" class="cls_053"><span class="cls_053">T+1:</span></div>
<div style="position:absolute;left:324.86px;top:377.59px" class="cls_053"><span class="cls_053">||mem</span><span class="cls_061"><sub>7+8*byte..8*byte</sub></span></div>
<div style="position:absolute;left:202.30px;top:375.59px" class="cls_053"><span class="cls_053">GPR[rt]</span><span class="cls_061"><sup> </sup></span><span class="cls_003">← </span><span class="cls_053">( mem</span><span class="cls_061"><sub>7+8* byte</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>24</sup></span></div>
<div style="position:absolute;left:74.50px;top:437.33px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:455.67px" class="cls_055"><span class="cls_055">TLB refill exception</span></div>
<div style="position:absolute;left:108.00px;top:468.67px" class="cls_055"><span class="cls_055">TLB invalid exception</span></div>
<div style="position:absolute;left:108.00px;top:481.67px" class="cls_055"><span class="cls_055">Bus error exception</span></div>
<div style="position:absolute;left:108.00px;top:494.67px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-32</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:195688px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:238.34px;top:70.09px" class="cls_064"><span class="cls_064">Load Byte Unsigned</span></div>
<div style="position:absolute;left:106.08px;top:61.83px" class="cls_063"><span class="cls_063">LBU</span></div>
<div style="position:absolute;left:458.08px;top:61.69px" class="cls_063"><span class="cls_063">LBU</span></div>
<div style="position:absolute;left:116.57px;top:102.53px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:102.53px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:102.53px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:102.53px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:489.40px;top:102.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:143.62px;top:126.58px" class="cls_053"><span class="cls_053">LBU</span></div>
<div style="position:absolute;left:207.04px;top:126.58px" class="cls_053"><span class="cls_053">base</span></div>
<div style="position:absolute;left:272.28px;top:126.58px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:388.10px;top:125.14px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:126.36px;top:136.16px" class="cls_053"><span class="cls_053">1 0 0 1 0 0</span></div>
<div style="position:absolute;left:151.86px;top:150.56px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.95px;top:150.56px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.13px;top:150.56px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:389.10px;top:150.56px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:173.21px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:194.54px" class="cls_055"><span class="cls_055">LBU rt, offset(base)</span></div>
<div style="position:absolute;left:72.00px;top:215.21px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:233.54px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">offset </span><span class="cls_055">is sign-extended and added to the contents of general register </span><span class="cls_058">base </span><span class="cls_055">to form a virtual</span></div>
<div style="position:absolute;left:108.00px;top:246.54px" class="cls_055"><span class="cls_055">address.  The contents of the byte at the memory location specified by the effective address are zero-</span></div>
<div style="position:absolute;left:108.00px;top:259.54px" class="cls_055"><span class="cls_055">extended and loaded into general register </span><span class="cls_058">rt</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:72.00px;top:280.21px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:176.35px;top:301.77px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:205.14px;top:299.77px" class="cls_053"><span class="cls_053">vAddr </span><span class="cls_003">←</span><span class="cls_053"> ((offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16</sup></span><span class="cls_053"> || offset</span><span class="cls_061"><sub>15...0</sub></span><span class="cls_053">) + GPR[base]</span></div>
<div style="position:absolute;left:205.15px;top:317.82px" class="cls_053"><span class="cls_053">(pAddr, uncached) </span><span class="cls_003">←</span><span class="cls_053"> AddressTranslation (vAddr, DATA)</span></div>
<div style="position:absolute;left:205.15px;top:331.86px" class="cls_053"><span class="cls_053">pAddr </span><span class="cls_003">←</span><span class="cls_053"> pAddr</span><span class="cls_061"><sub>PSIZE - 1 ... 2</sub></span><span class="cls_053"> || (pAddr</span><span class="cls_061"><sub>1...0</sub></span><span class="cls_053"> xor ReverseEndian</span><span class="cls_061"><sup>2</sup></span><span class="cls_053">)</span></div>
<div style="position:absolute;left:205.15px;top:349.91px" class="cls_053"><span class="cls_053">mem </span><span class="cls_003">←</span><span class="cls_053"> LoadMemory (uncached, BYTE, pAddr, vAddr, DATA)</span></div>
<div style="position:absolute;left:205.15px;top:363.96px" class="cls_053"><span class="cls_053">byte </span><span class="cls_003">←</span><span class="cls_053"> vAddr</span><span class="cls_061"><sub>1...0 </sub></span><span class="cls_053">xor BigEndianCPU</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:176.35px;top:380.01px" class="cls_053"><span class="cls_053">T+1:  GPR[rt]</span><span class="cls_061"><sup> </sup></span><span class="cls_003">← </span><span class="cls_053">0</span><span class="cls_061"><sup>24</sup></span><span class="cls_053"> || mem</span><span class="cls_061"><sub>7+8* byte...8* byte</sub></span></div>
<div style="position:absolute;left:72.00px;top:419.34px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:437.67px" class="cls_055"><span class="cls_055">TLB refill exception</span></div>
<div style="position:absolute;left:108.00px;top:456.67px" class="cls_055"><span class="cls_055">TLB invalid exception</span></div>
<div style="position:absolute;left:108.00px;top:475.67px" class="cls_055"><span class="cls_055">Bus error exception</span></div>
<div style="position:absolute;left:108.00px;top:494.67px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-33</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:196490px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:257.40px;top:67.71px" class="cls_064"><span class="cls_064">Load Halfword</span></div>
<div style="position:absolute;left:108.29px;top:61.26px" class="cls_063"><span class="cls_063">LH</span></div>
<div style="position:absolute;left:474.63px;top:61.76px" class="cls_063"><span class="cls_063">LH</span></div>
<div style="position:absolute;left:118.01px;top:102.10px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:173.31px;top:102.10px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.53px;top:102.10px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.79px;top:102.10px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:490.84px;top:102.10px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:150.14px;top:126.15px" class="cls_053"><span class="cls_053">LH</span></div>
<div style="position:absolute;left:208.48px;top:126.15px" class="cls_053"><span class="cls_053">base</span></div>
<div style="position:absolute;left:273.73px;top:126.15px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:389.53px;top:124.71px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:132.55px;top:135.73px" class="cls_053"><span class="cls_053">1 0 0 0 0 1</span></div>
<div style="position:absolute;left:153.29px;top:150.13px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:218.38px;top:150.13px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.56px;top:150.13px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:390.53px;top:150.13px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:173.35px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:194.69px" class="cls_055"><span class="cls_055">LH rt, offset(base)</span></div>
<div style="position:absolute;left:72.00px;top:215.35px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:233.69px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">offset </span><span class="cls_055">is sign-extended and added to the contents of general register </span><span class="cls_058">base </span><span class="cls_055">to form a virtual</span></div>
<div style="position:absolute;left:108.00px;top:246.69px" class="cls_055"><span class="cls_055">address.  The contents of the halfword at the memory location specified by the effective address are</span></div>
<div style="position:absolute;left:108.00px;top:259.69px" class="cls_055"><span class="cls_055">sign-extended and loaded into general register </span><span class="cls_058">rt</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:278.69px" class="cls_055"><span class="cls_055">If the least-significant bit of the effective address is non-zero, an address error exception occurs.</span></div>
<div style="position:absolute;left:72.00px;top:299.35px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:155.74px;top:320.77px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:180.93px;top:318.77px" class="cls_053"><span class="cls_053">vAddr </span><span class="cls_003">←</span><span class="cls_053"> ((offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16</sup></span><span class="cls_053"> || offset</span><span class="cls_061"><sub>15...0</sub></span><span class="cls_053">) + GPR[base]</span></div>
<div style="position:absolute;left:180.94px;top:333.23px" class="cls_053"><span class="cls_053">(pAddr, uncached) </span><span class="cls_003">←</span><span class="cls_053"> AddressTranslation (vAddr, DATA)</span></div>
<div style="position:absolute;left:180.93px;top:345.02px" class="cls_053"><span class="cls_053">pAddr </span><span class="cls_003">←</span><span class="cls_053">  pAddr</span><span class="cls_061"><sub>PSIZE - 1...2</sub></span><span class="cls_053"> || (pAddr</span><span class="cls_061"><sub>1...0</sub></span><span class="cls_053"> xor (ReverseEndian || 0))</span></div>
<div style="position:absolute;left:180.14px;top:358.28px" class="cls_053"><span class="cls_053">mem </span><span class="cls_003">←</span><span class="cls_053"> LoadMemory (uncached, HALFWORD, pAddr, vAddr, DATA)</span></div>
<div style="position:absolute;left:180.94px;top:371.67px" class="cls_053"><span class="cls_053">byte </span><span class="cls_003">←</span><span class="cls_053"> vAddr</span><span class="cls_061"><sub>1...0</sub></span><span class="cls_053"> xor (BigEndianCPU || 0)</span></div>
<div style="position:absolute;left:309.06px;top:383.67px" class="cls_053"><span class="cls_053">|| mem</span><span class="cls_061"><sub>15+8*byte...8* byte</sub></span></div>
<div style="position:absolute;left:155.73px;top:381.67px" class="cls_053"><span class="cls_053">T+1: GPR[rt]  </span><span class="cls_003">← </span><span class="cls_053">(mem</span><span class="cls_061"><sub>15+8*byte</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16</sup></span></div>
<div style="position:absolute;left:74.50px;top:411.33px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:429.67px" class="cls_055"><span class="cls_055">TLB refill exception</span></div>
<div style="position:absolute;left:108.00px;top:442.67px" class="cls_055"><span class="cls_055">TLB invalid exception</span></div>
<div style="position:absolute;left:108.00px;top:455.67px" class="cls_055"><span class="cls_055">Bus error exception</span></div>
<div style="position:absolute;left:108.00px;top:468.67px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-34</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:197292px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:223.56px;top:68.50px" class="cls_064"><span class="cls_064">Load Halfword Unsigned</span></div>
<div style="position:absolute;left:108.36px;top:61.69px" class="cls_063"><span class="cls_063">LHU</span></div>
<div style="position:absolute;left:457.85px;top:62.05px" class="cls_063"><span class="cls_063">LHU</span></div>
<div style="position:absolute;left:118.40px;top:102.24px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:173.70px;top:102.24px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.92px;top:102.24px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:296.18px;top:102.24px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:491.24px;top:102.24px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:146.92px;top:126.29px" class="cls_053"><span class="cls_053">LHU</span></div>
<div style="position:absolute;left:208.88px;top:126.29px" class="cls_053"><span class="cls_053">base</span></div>
<div style="position:absolute;left:274.12px;top:126.29px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:389.92px;top:124.85px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:132.94px;top:135.87px" class="cls_053"><span class="cls_053">1 0 0 1 0 1</span></div>
<div style="position:absolute;left:153.68px;top:150.27px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:218.78px;top:150.27px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.96px;top:150.27px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:390.93px;top:150.27px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:172.85px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:194.18px" class="cls_055"><span class="cls_055">LHU rt, offset(base)</span></div>
<div style="position:absolute;left:72.00px;top:214.85px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:233.18px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">offset </span><span class="cls_055">is sign-extended and added to the contents of general register </span><span class="cls_058">base </span><span class="cls_055">to form a virtual</span></div>
<div style="position:absolute;left:108.00px;top:246.18px" class="cls_055"><span class="cls_055">address.  The contents of the halfword at the memory location specified by the effective address are</span></div>
<div style="position:absolute;left:108.00px;top:259.18px" class="cls_055"><span class="cls_055">zero-extended and loaded into general register </span><span class="cls_058">rt</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:278.18px" class="cls_055"><span class="cls_055">If the least-significant bit of the effective address is non-zero, an address error exception occurs.</span></div>
<div style="position:absolute;left:72.00px;top:298.85px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:155.38px;top:321.05px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:180.57px;top:319.05px" class="cls_053"><span class="cls_053">vAddr </span><span class="cls_003">←</span><span class="cls_053"> ((offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16</sup></span><span class="cls_053"> || offset</span><span class="cls_061"><sub>15...0</sub></span><span class="cls_053">) + GPR[base]</span></div>
<div style="position:absolute;left:180.58px;top:335.31px" class="cls_053"><span class="cls_053">(pAddr, uncached) </span><span class="cls_003">←</span><span class="cls_053"> AddressTranslation (vAddr, DATA)</span></div>
<div style="position:absolute;left:180.57px;top:349.49px" class="cls_053"><span class="cls_053">pAddr </span><span class="cls_003">←</span><span class="cls_053">  pAddr</span><span class="cls_061"><sub>PSIZE - 1...2</sub></span><span class="cls_053"> || (pAddr</span><span class="cls_061"><sub>1...0</sub></span><span class="cls_053"> xor (ReverseEndian || 0))</span></div>
<div style="position:absolute;left:180.58px;top:361.73px" class="cls_053"><span class="cls_053">mem </span><span class="cls_003">←</span><span class="cls_053"> LoadMemory (uncached, HALFWORD, pAddr, vAddr, DATA)</span></div>
<div style="position:absolute;left:180.58px;top:375.05px" class="cls_053"><span class="cls_053">byte </span><span class="cls_003">←</span><span class="cls_053"> vAddr</span><span class="cls_061"><sub>1...0 </sub></span><span class="cls_053">xor (BigEndianCPU || 0)</span></div>
<div style="position:absolute;left:251.30px;top:387.05px" class="cls_053"><span class="cls_053">||  mem</span><span class="cls_061"><sub>15+8*byte...8*byte</sub></span></div>
<div style="position:absolute;left:155.37px;top:385.05px" class="cls_053"><span class="cls_053">T+1: GPR[rt]  </span><span class="cls_003">← </span><span class="cls_053">0</span><span class="cls_061"><sup>16</sup></span></div>
<div style="position:absolute;left:72.00px;top:429.94px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:448.27px" class="cls_055"><span class="cls_055">TLB refill exception</span></div>
<div style="position:absolute;left:288.04px;top:448.27px" class="cls_055"><span class="cls_055">TLB invalid exception</span></div>
<div style="position:absolute;left:108.00px;top:461.27px" class="cls_055"><span class="cls_055">Bus Error exception</span></div>
<div style="position:absolute;left:288.03px;top:461.27px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-35</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:198094px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:230.56px;top:67.28px" class="cls_064"><span class="cls_064">Load Upper Immediate</span></div>
<div style="position:absolute;left:108.09px;top:61.18px" class="cls_063"><span class="cls_063">LUI</span></div>
<div style="position:absolute;left:466.94px;top:60.90px" class="cls_063"><span class="cls_063">LUI</span></div>
<div style="position:absolute;left:116.57px;top:102.74px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:102.74px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:102.74px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:102.74px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:489.40px;top:102.74px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:147.35px;top:122.14px" class="cls_053"><span class="cls_053">LUI</span></div>
<div style="position:absolute;left:215.84px;top:123.81px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:272.28px;top:126.79px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:377.27px;top:125.35px" class="cls_053"><span class="cls_053">immediate</span></div>
<div style="position:absolute;left:129.72px;top:136.37px" class="cls_053"><span class="cls_053">0 0 1 1 1 1</span></div>
<div style="position:absolute;left:198.89px;top:137.78px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:151.85px;top:150.77px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.94px;top:150.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.12px;top:150.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:389.09px;top:150.77px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:174.00px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.34px" class="cls_055"><span class="cls_055">LUI rt, immediate</span></div>
<div style="position:absolute;left:72.00px;top:216.00px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.34px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">immediate</span><span class="cls_055"> is shifted left 16 bits and concatenated with 16 bits of low-order zeros.  The</span></div>
<div style="position:absolute;left:108.00px;top:247.33px" class="cls_055"><span class="cls_055">32-bit result is then placed into general register </span><span class="cls_058">rt</span><span class="cls_055">.  If </span><span class="cls_058">rt </span><span class="cls_055">is a 64-bit register, then the result is sign</span></div>
<div style="position:absolute;left:108.01px;top:260.33px" class="cls_055"><span class="cls_055">extended.</span></div>
<div style="position:absolute;left:72.00px;top:281.00px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:126.00px;top:306.36px" class="cls_053"><span class="cls_053">GPR[rt] </span><span class="cls_003">←</span><span class="cls_053"> immediate || 0</span><span class="cls_061"><sup>16</sup></span></div>
<div style="position:absolute;left:72.00px;top:342.07px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:360.41px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-36</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:198896px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:269.42px;top:63.97px" class="cls_064"><span class="cls_064">Load Word</span></div>
<div style="position:absolute;left:108.04px;top:59.67px" class="cls_063"><span class="cls_063">LW</span></div>
<div style="position:absolute;left:467.60px;top:60.03px" class="cls_063"><span class="cls_063">LW</span></div>
<div style="position:absolute;left:116.75px;top:102.02px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.91px;top:102.02px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:234.99px;top:102.02px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.11px;top:102.02px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:488.80px;top:102.02px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:147.71px;top:126.07px" class="cls_053"><span class="cls_053">LW</span></div>
<div style="position:absolute;left:207.01px;top:126.07px" class="cls_053"><span class="cls_053">base</span></div>
<div style="position:absolute;left:272.11px;top:126.07px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:387.64px;top:124.63px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:131.30px;top:135.65px" class="cls_053"><span class="cls_053">1 0 0 0 1 1</span></div>
<div style="position:absolute;left:151.90px;top:150.05px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.84px;top:150.05px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:275.95px;top:150.05px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:388.70px;top:150.05px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:171.24px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:192.57px" class="cls_055"><span class="cls_055">LW rt, offset(base)</span></div>
<div style="position:absolute;left:72.00px;top:213.24px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:231.57px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">offset </span><span class="cls_055">is sign-extended and added to the contents of general register </span><span class="cls_058">base </span><span class="cls_055">to form a virtual</span></div>
<div style="position:absolute;left:108.00px;top:244.57px" class="cls_055"><span class="cls_055">address.  The contents of the word at the memory location specified by the effective address are</span></div>
<div style="position:absolute;left:108.00px;top:257.58px" class="cls_055"><span class="cls_055">loaded into general register </span><span class="cls_058">rt</span><span class="cls_055">.  In 64-bit mode, the loaded word is sign-extended.</span></div>
<div style="position:absolute;left:108.01px;top:276.58px" class="cls_055"><span class="cls_055">If either of the two least-significant bits of the effective address is non-zero, an address error</span></div>
<div style="position:absolute;left:108.01px;top:289.58px" class="cls_055"><span class="cls_055">exception occurs.</span></div>
<div style="position:absolute;left:72.00px;top:310.24px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:172.62px;top:333.89px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:197.82px;top:331.89px" class="cls_053"><span class="cls_053">vAddr</span><span class="cls_003"> ←</span><span class="cls_053"> ((offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16</sup></span><span class="cls_053"> || offset</span><span class="cls_061"><sub>15...0</sub></span><span class="cls_053">) + GPR[base]</span></div>
<div style="position:absolute;left:197.81px;top:348.29px" class="cls_053"><span class="cls_053">(pAddr, uncached)</span><span class="cls_003"> ←</span><span class="cls_053"> AddressTranslation (vAddr, DATA)</span></div>
<div style="position:absolute;left:197.81px;top:361.75px" class="cls_053"><span class="cls_053">mem</span><span class="cls_003"> ← </span><span class="cls_053">LoadMemory (uncached, WORD, pAddr, vAddr, DATA)</span></div>
<div style="position:absolute;left:172.61px;top:375.21px" class="cls_053"><span class="cls_053">T+1: GPR[rt] </span><span class="cls_003">←</span><span class="cls_053"> mem</span></div>
<div style="position:absolute;left:74.50px;top:409.03px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:427.36px" class="cls_055"><span class="cls_055">TLB refill exception</span></div>
<div style="position:absolute;left:108.00px;top:440.36px" class="cls_055"><span class="cls_055">TLB invalid exception</span></div>
<div style="position:absolute;left:108.00px;top:453.36px" class="cls_055"><span class="cls_055">Bus error exception</span></div>
<div style="position:absolute;left:108.00px;top:466.36px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-37</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:199698px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:105.07px;top:61.18px" class="cls_063"><span class="cls_063">LWCz</span><span class="cls_064">   Load Word To Coprocessor</span></div>
<div style="position:absolute;left:437.23px;top:60.90px" class="cls_063"><span class="cls_063">LWCz</span></div>
<div style="position:absolute;left:116.57px;top:103.75px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:103.75px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:103.75px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:103.75px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:489.40px;top:103.75px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:141.48px;top:127.80px" class="cls_053"><span class="cls_053">LWCz</span></div>
<div style="position:absolute;left:207.04px;top:127.80px" class="cls_053"><span class="cls_053">base</span></div>
<div style="position:absolute;left:272.28px;top:127.80px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:388.09px;top:126.36px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:129.72px;top:137.38px" class="cls_053"><span class="cls_053">1 1 0 0 x x*</span></div>
<div style="position:absolute;left:151.85px;top:151.78px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.94px;top:151.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.12px;top:151.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:389.09px;top:151.78px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:175.01px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:196.34px" class="cls_055"><span class="cls_055">LWCz rt, offset(base)</span></div>
<div style="position:absolute;left:72.00px;top:217.01px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:235.34px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">offset </span><span class="cls_055">is sign-extended and added to the contents of general register </span><span class="cls_058">base </span><span class="cls_055">to form a virtual</span></div>
<div style="position:absolute;left:108.00px;top:248.34px" class="cls_055"><span class="cls_055">address.  The processor reads a word from the addressed memory location, and makes the data</span></div>
<div style="position:absolute;left:108.00px;top:261.34px" class="cls_055"><span class="cls_055">available to coprocessor unit </span><span class="cls_058">z</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:280.34px" class="cls_055"><span class="cls_055">The manner in which each coprocessor uses the data is defined by the individual coprocessor</span></div>
<div style="position:absolute;left:108.00px;top:293.34px" class="cls_055"><span class="cls_055">specifications.</span></div>
<div style="position:absolute;left:108.00px;top:312.34px" class="cls_055"><span class="cls_055">If either of the two least-significant bits of the effective address is non-zero, an address error</span></div>
<div style="position:absolute;left:108.00px;top:325.34px" class="cls_055"><span class="cls_055">exception occurs.</span></div>
<div style="position:absolute;left:108.00px;top:344.34px" class="cls_055"><span class="cls_055">This instruction is not valid for use with CP0.</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-38</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:200500px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:273.08px;top:60.80px" class="cls_064"><span class="cls_064">rd To Coprocessor</span></div>
<div style="position:absolute;left:105.88px;top:60.61px" class="cls_063"><span class="cls_063">LWCz</span><span class="cls_064"><sup>Load Wo</sup></span></div>
<div style="position:absolute;left:267.55px;top:74.48px" class="cls_064"><span class="cls_064">(continued)</span></div>
<div style="position:absolute;left:434.70px;top:60.32px" class="cls_063"><span class="cls_063">LWCz</span></div>
<div style="position:absolute;left:72.00px;top:113.77px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:141.59px;top:135.98px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:166.78px;top:133.98px" class="cls_053"><span class="cls_053">vAddr </span><span class="cls_003">←</span><span class="cls_053"> ((offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16</sup></span><span class="cls_053"> || offset</span><span class="cls_061"><sub>15...0</sub></span><span class="cls_053">) + GPR[base]</span></div>
<div style="position:absolute;left:166.79px;top:146.99px" class="cls_053"><span class="cls_053">(pAddr, uncached) </span><span class="cls_003">←</span><span class="cls_053"> AddressTranslation (vAddr, DATA)</span></div>
<div style="position:absolute;left:167.60px;top:157.13px" class="cls_053"><span class="cls_053">byte </span><span class="cls_003">← </span><span class="cls_053">vAddr</span><span class="cls_061"><sub>1...0</sub></span></div>
<div style="position:absolute;left:165.94px;top:168.83px" class="cls_053"><span class="cls_053">mem </span><span class="cls_003">←</span><span class="cls_053"> LoadMemory (uncached, DOUBLEWORD, pAddr, vAddr, DATA)</span></div>
<div style="position:absolute;left:143.18px;top:179.73px" class="cls_053"><span class="cls_053">T+1: COPzLW (rt, mem)</span></div>
<div style="position:absolute;left:72.00px;top:224.87px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:243.21px" class="cls_055"><span class="cls_055">TLB refill exception</span></div>
<div style="position:absolute;left:108.00px;top:256.21px" class="cls_055"><span class="cls_055">TLB invalid exception</span></div>
<div style="position:absolute;left:108.00px;top:269.21px" class="cls_055"><span class="cls_055">Bus error exception</span></div>
<div style="position:absolute;left:108.00px;top:282.21px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:108.00px;top:295.21px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:72.00px;top:315.87px" class="cls_066"><span class="cls_066">Opcode Bit Encoding:</span></div>
<div style="position:absolute;left:174.40px;top:343.80px" class="cls_053"><span class="cls_053">Bit #31</span></div>
<div style="position:absolute;left:218.39px;top:342.43px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:243.24px;top:342.43px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:266.71px;top:342.43px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:292.92px;top:342.43px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:320.51px;top:342.43px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:493.64px;top:342.79px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:112.67px;top:337.60px" class="cls_069"><span class="cls_069">LWCz</span></div>
<div style="position:absolute;left:196.30px;top:358.63px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:219.06px;top:358.63px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:244.54px;top:358.63px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:268.01px;top:358.63px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:293.50px;top:358.63px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:321.09px;top:358.63px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:155.83px;top:362.95px" class="cls_053"><span class="cls_053">LWC1</span></div>
<div style="position:absolute;left:172.60px;top:381.10px" class="cls_053"><span class="cls_053">Bit #31</span></div>
<div style="position:absolute;left:216.58px;top:379.80px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:241.43px;top:379.80px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:264.83px;top:379.80px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:291.04px;top:379.80px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:318.63px;top:379.80px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:491.84px;top:380.15px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:194.50px;top:395.99px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:217.26px;top:395.99px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:242.74px;top:395.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:266.21px;top:395.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:291.70px;top:395.99px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:319.36px;top:395.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:153.96px;top:400.32px" class="cls_053"><span class="cls_053">LWC2</span></div>
<div style="position:absolute;left:171.74px;top:422.42px" class="cls_053"><span class="cls_053">Bit #31</span></div>
<div style="position:absolute;left:215.80px;top:421.05px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:240.57px;top:421.05px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:264.05px;top:421.05px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:290.26px;top:421.05px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:317.84px;top:421.05px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:490.98px;top:421.41px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:193.64px;top:437.32px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:216.47px;top:437.32px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:241.95px;top:437.32px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:265.42px;top:437.32px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:290.91px;top:437.32px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:318.49px;top:437.32px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:153.17px;top:441.57px" class="cls_053"><span class="cls_053">LWC3</span></div>
<div style="position:absolute;left:213.77px;top:468.57px" class="cls_053"><span class="cls_053">Opcode</span></div>
<div style="position:absolute;left:296.47px;top:466.43px" class="cls_053"><span class="cls_053">Coprocessor Unit Number</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-39</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:201302px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:254.52px;top:68.36px" class="cls_064"><span class="cls_064">Load Word Left</span></div>
<div style="position:absolute;left:106.74px;top:61.04px" class="cls_063"><span class="cls_063">LWL</span></div>
<div style="position:absolute;left:453.13px;top:60.90px" class="cls_063"><span class="cls_063">LWL</span></div>
<div style="position:absolute;left:119.23px;top:101.88px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:174.53px;top:101.88px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:237.75px;top:101.88px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:297.01px;top:101.88px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:492.07px;top:101.88px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:142.36px;top:125.86px" class="cls_053"><span class="cls_053">LWL</span></div>
<div style="position:absolute;left:209.70px;top:125.86px" class="cls_053"><span class="cls_053">base</span></div>
<div style="position:absolute;left:274.95px;top:125.86px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:390.75px;top:124.42px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:129.02px;top:135.51px" class="cls_053"><span class="cls_053">1 0 0 0 1 0</span></div>
<div style="position:absolute;left:154.51px;top:149.91px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:219.60px;top:149.91px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:278.80px;top:149.91px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:391.77px;top:149.91px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:171.70px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:193.03px" class="cls_055"><span class="cls_055">LWL rt, offset(base)</span></div>
<div style="position:absolute;left:72.00px;top:213.70px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:232.03px" class="cls_055"><span class="cls_055">This instruction can be used in combination with the LWR instruction to load a register with four</span></div>
<div style="position:absolute;left:108.00px;top:245.03px" class="cls_055"><span class="cls_055">consecutive bytes from memory, when the bytes cross a word boundary.  LWL loads the left</span></div>
<div style="position:absolute;left:108.00px;top:258.03px" class="cls_055"><span class="cls_055">portion of the register with the appropriate part of the high-order word; LWR loads the right</span></div>
<div style="position:absolute;left:108.00px;top:271.03px" class="cls_055"><span class="cls_055">portion of the register with the appropriate part of the low-order word.</span></div>
<div style="position:absolute;left:108.00px;top:290.03px" class="cls_055"><span class="cls_055">The LWL instruction adds its sign-extended 16-bit </span><span class="cls_058">offset </span><span class="cls_055">to the contents of general register </span><span class="cls_058">base </span><span class="cls_055">to</span></div>
<div style="position:absolute;left:108.00px;top:303.03px" class="cls_055"><span class="cls_055">form a virtual address which can specify an arbitrary byte.  It reads bytes only from the word in</span></div>
<div style="position:absolute;left:108.00px;top:316.03px" class="cls_055"><span class="cls_055">memory which contains the specified starting byte.  From one to four bytes will be loaded,</span></div>
<div style="position:absolute;left:108.00px;top:329.03px" class="cls_055"><span class="cls_055">depending on the starting byte specified.</span></div>
<div style="position:absolute;left:108.00px;top:348.03px" class="cls_055"><span class="cls_055">Conceptually, it starts at the specified byte in memory and loads that byte into the high-order (left-</span></div>
<div style="position:absolute;left:108.00px;top:361.03px" class="cls_055"><span class="cls_055">most) byte of the register; then it loads bytes from memory into the register until it reaches the low-</span></div>
<div style="position:absolute;left:108.00px;top:374.03px" class="cls_055"><span class="cls_055">order byte of the word in memory.  The least-significant (right-most) byte(s) of the register will not</span></div>
<div style="position:absolute;left:108.00px;top:387.03px" class="cls_055"><span class="cls_055">be changed.</span></div>
<div style="position:absolute;left:206.43px;top:406.92px" class="cls_053"><span class="cls_053">memory</span></div>
<div style="position:absolute;left:201.60px;top:416.14px" class="cls_053"><span class="cls_053">(big-endian)</span></div>
<div style="position:absolute;left:384.84px;top:420.82px" class="cls_053"><span class="cls_053">register</span></div>
<div style="position:absolute;left:124.78px;top:431.26px" class="cls_053"><span class="cls_053">address 4</span></div>
<div style="position:absolute;left:190.30px;top:431.26px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:218.38px;top:431.26px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:246.46px;top:431.26px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:274.47px;top:431.26px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:315.58px;top:439.32px" class="cls_053"><span class="cls_053">before</span></div>
<div style="position:absolute;left:366.12px;top:438.17px" class="cls_053"><span class="cls_053">A</span></div>
<div style="position:absolute;left:394.20px;top:438.17px" class="cls_053"><span class="cls_053">B</span></div>
<div style="position:absolute;left:422.28px;top:438.17px" class="cls_053"><span class="cls_053">C</span></div>
<div style="position:absolute;left:450.36px;top:438.17px" class="cls_053"><span class="cls_053">D</span></div>
<div style="position:absolute;left:473.98px;top:439.32px" class="cls_053"><span class="cls_053">$24</span></div>
<div style="position:absolute;left:124.78px;top:445.16px" class="cls_053"><span class="cls_053">address 0</span></div>
<div style="position:absolute;left:190.30px;top:445.16px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:218.38px;top:445.16px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:246.46px;top:445.16px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:274.47px;top:445.16px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:250.68px;top:468.32px" class="cls_067"><span class="cls_067">LWL $24,1($0)</span></div>
<div style="position:absolute;left:321.55px;top:497.57px" class="cls_053"><span class="cls_053">after</span></div>
<div style="position:absolute;left:366.12px;top:497.43px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:394.20px;top:497.43px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:422.28px;top:497.43px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:450.36px;top:497.43px" class="cls_053"><span class="cls_053">D</span></div>
<div style="position:absolute;left:473.98px;top:498.58px" class="cls_053"><span class="cls_053">$24</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-40</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:202104px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:254.97px;top:65.62px" class="cls_064"><span class="cls_064">Load Word Left</span></div>
<div style="position:absolute;left:103.86px;top:64.28px" class="cls_063"><span class="cls_063">LWL</span></div>
<div style="position:absolute;left:454.41px;top:63.13px" class="cls_063"><span class="cls_063">LWL</span></div>
<div style="position:absolute;left:267.45px;top:80.96px" class="cls_064"><span class="cls_064">(continued)</span></div>
<div style="position:absolute;left:108.00px;top:121.03px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rt </span><span class="cls_055">are internally bypassed within the processor so that no NOP is</span></div>
<div style="position:absolute;left:108.00px;top:134.03px" class="cls_055"><span class="cls_055">needed between an immediately preceding load instruction which specifies register </span><span class="cls_058">rt </span><span class="cls_055">and a</span></div>
<div style="position:absolute;left:108.00px;top:147.03px" class="cls_055"><span class="cls_055">following LWL (or LWR) instruction which also specifies register </span><span class="cls_058">rt</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.01px;top:166.03px" class="cls_055"><span class="cls_055">No address exceptions due to alignment are possible.</span></div>
<div style="position:absolute;left:72.00px;top:186.70px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:157.97px;top:214.30px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:183.17px;top:212.30px" class="cls_053"><span class="cls_053">vAddr </span><span class="cls_003">← </span><span class="cls_053">((offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16 </sup></span><span class="cls_053">|| offset</span><span class="cls_061"><sub>15...0</sub></span><span class="cls_053">) + GPR[base]</span></div>
<div style="position:absolute;left:183.17px;top:228.70px" class="cls_053"><span class="cls_053">(pAddr, uncached) </span><span class="cls_003">←</span><span class="cls_053"> AddressTranslation (vAddr, DATA)</span></div>
<div style="position:absolute;left:184.04px;top:240.17px" class="cls_053"><span class="cls_053">pAddr </span><span class="cls_003">← </span><span class="cls_053">pAddr</span><span class="cls_061"><sub>PSIZE-1...2</sub></span><span class="cls_053"> || (pAddr</span><span class="cls_061"><sub>1...0</sub></span><span class="cls_053"> xor ReverseEndian</span><span class="cls_061"><sup>2</sup></span><span class="cls_053">)</span></div>
<div style="position:absolute;left:185.26px;top:257.96px" class="cls_053"><span class="cls_053">if BigEndianMem = 0 then</span></div>
<div style="position:absolute;left:236.37px;top:267.24px" class="cls_053"><span class="cls_053">pAddr </span><span class="cls_003">←</span><span class="cls_053">  pAddr</span><span class="cls_061"><sub>PSIZE-31...2 </sub></span><span class="cls_053">|| 0</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:185.47px;top:279.43px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:186.12px;top:288.82px" class="cls_053"><span class="cls_053">byte </span><span class="cls_003">←</span><span class="cls_053"> vAddr</span><span class="cls_061"><sub>1...0</sub></span><span class="cls_053"> xor BigEndianCPU</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:183.82px;top:302.86px" class="cls_053"><span class="cls_053">mem </span><span class="cls_003">←</span><span class="cls_053"> LoadMemory (uncached, byte, pAddr, vAddr, DATA)</span></div>
<div style="position:absolute;left:183.81px;top:316.12px" class="cls_053"><span class="cls_053">GPR[rt] </span><span class="cls_003">←</span><span class="cls_053"> mem</span><span class="cls_061"><sub>7+8*byte...0</sub></span><span class="cls_053"> || GPR[rt]</span><span class="cls_061"><sub>23-8*byte...0</sub></span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-41</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:202906px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:254.78px;top:69.38px" class="cls_064"><span class="cls_064">Load Word Left</span></div>
<div style="position:absolute;left:103.90px;top:69.75px" class="cls_063"><span class="cls_063">LWL</span></div>
<div style="position:absolute;left:453.55px;top:69.60px" class="cls_063"><span class="cls_063">LWL</span></div>
<div style="position:absolute;left:267.26px;top:84.71px" class="cls_064"><span class="cls_064">(continued)</span></div>
<div style="position:absolute;left:108.00px;top:140.07px" class="cls_055"><span class="cls_055">Given a doubleword in a register and a doubleword in memory, the operation of LWL is as follows:</span></div>
<div style="position:absolute;left:164.70px;top:167.68px" class="cls_064"><span class="cls_064">LWL</span></div>
<div style="position:absolute;left:165.93px;top:191.63px" class="cls_053"><span class="cls_053">Register</span></div>
<div style="position:absolute;left:223.50px;top:192.57px" class="cls_053"><span class="cls_053">A</span></div>
<div style="position:absolute;left:249.57px;top:192.57px" class="cls_053"><span class="cls_053">B</span></div>
<div style="position:absolute;left:278.45px;top:192.57px" class="cls_053"><span class="cls_053">C</span></div>
<div style="position:absolute;left:305.24px;top:192.57px" class="cls_053"><span class="cls_053">D</span></div>
<div style="position:absolute;left:334.02px;top:192.21px" class="cls_053"><span class="cls_053">E</span></div>
<div style="position:absolute;left:360.37px;top:192.21px" class="cls_053"><span class="cls_053">F</span></div>
<div style="position:absolute;left:388.69px;top:192.21px" class="cls_053"><span class="cls_053">G</span></div>
<div style="position:absolute;left:415.76px;top:192.21px" class="cls_053"><span class="cls_053">H</span></div>
<div style="position:absolute;left:165.93px;top:221.43px" class="cls_053"><span class="cls_053">Memory</span></div>
<div style="position:absolute;left:225.45px;top:222.37px" class="cls_053"><span class="cls_053">I</span></div>
<div style="position:absolute;left:250.41px;top:222.37px" class="cls_053"><span class="cls_053">J</span></div>
<div style="position:absolute;left:278.73px;top:222.37px" class="cls_053"><span class="cls_053">K</span></div>
<div style="position:absolute;left:306.07px;top:222.37px" class="cls_053"><span class="cls_053">L</span></div>
<div style="position:absolute;left:333.19px;top:222.01px" class="cls_053"><span class="cls_053">M</span></div>
<div style="position:absolute;left:359.81px;top:222.01px" class="cls_053"><span class="cls_053">N</span></div>
<div style="position:absolute;left:388.69px;top:222.01px" class="cls_053"><span class="cls_053">O</span></div>
<div style="position:absolute;left:416.03px;top:222.01px" class="cls_053"><span class="cls_053">P</span></div>
<div style="position:absolute;left:196.13px;top:262.33px" class="cls_056"><span class="cls_056">BigEndianCPU = 0</span></div>
<div style="position:absolute;left:382.68px;top:263.91px" class="cls_056"><span class="cls_056">BigEndianCPU = 1</span></div>
<div style="position:absolute;left:292.68px;top:278.07px" class="cls_070"><span class="cls_070">offset</span></div>
<div style="position:absolute;left:468.29px;top:278.64px" class="cls_070"><span class="cls_070">offset</span></div>
<div style="position:absolute;left:113.98px;top:282.62px" class="cls_070"><span class="cls_070">vAddr</span><span class="cls_072"><sub>2..0</sub></span></div>
<div style="position:absolute;left:179.71px;top:282.96px" class="cls_070"><span class="cls_070">destination</span></div>
<div style="position:absolute;left:256.03px;top:282.89px" class="cls_070"><span class="cls_070">type</span></div>
<div style="position:absolute;left:357.70px;top:282.39px" class="cls_070"><span class="cls_070">destination</span></div>
<div style="position:absolute;left:434.45px;top:283.03px" class="cls_070"><span class="cls_070">type</span></div>
<div style="position:absolute;left:281.88px;top:292.28px" class="cls_056"><span class="cls_056">LEM  BEM</span></div>
<div style="position:absolute;left:456.98px;top:292.42px" class="cls_056"><span class="cls_056">LEM  BEM</span></div>
<div style="position:absolute;left:126.43px;top:308.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:156.81px;top:308.53px" class="cls_053"><span class="cls_053">S S S S P F G H</span></div>
<div style="position:absolute;left:261.72px;top:308.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:290.45px;top:308.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:311.12px;top:308.53px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:333.67px;top:308.53px" class="cls_053"><span class="cls_053">S S S S I  J K L</span></div>
<div style="position:absolute;left:439.01px;top:308.53px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:465.00px;top:308.53px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:488.04px;top:308.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:126.43px;top:322.53px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:156.81px;top:322.53px" class="cls_053"><span class="cls_053">S S S S O P G H</span></div>
<div style="position:absolute;left:261.73px;top:322.53px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:290.46px;top:322.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:311.13px;top:322.53px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:333.68px;top:322.53px" class="cls_053"><span class="cls_053">S S S S J K L H</span></div>
<div style="position:absolute;left:439.01px;top:322.53px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:465.00px;top:322.53px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:488.04px;top:322.53px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:126.43px;top:336.53px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:156.81px;top:336.53px" class="cls_053"><span class="cls_053">S S S S N O P H</span></div>
<div style="position:absolute;left:261.72px;top:336.53px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:290.46px;top:336.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:311.12px;top:336.53px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:333.66px;top:336.53px" class="cls_053"><span class="cls_053">S S S S K L G H</span></div>
<div style="position:absolute;left:438.98px;top:336.53px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:464.97px;top:336.53px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:488.01px;top:336.53px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:126.43px;top:350.53px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:156.81px;top:350.53px" class="cls_053"><span class="cls_053">S S S S M N O P</span></div>
<div style="position:absolute;left:261.73px;top:350.53px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:290.46px;top:350.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:311.14px;top:350.53px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:333.68px;top:350.53px" class="cls_053"><span class="cls_053">S S S S L F G H</span></div>
<div style="position:absolute;left:439.02px;top:350.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:465.01px;top:350.53px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:488.05px;top:350.53px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:126.43px;top:364.53px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:156.81px;top:364.53px" class="cls_053"><span class="cls_053">S S S S L F G H</span></div>
<div style="position:absolute;left:261.72px;top:364.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:290.45px;top:364.53px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:311.12px;top:364.53px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:333.66px;top:364.53px" class="cls_053"><span class="cls_053">S S S S MN O P</span></div>
<div style="position:absolute;left:438.99px;top:364.53px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:464.98px;top:364.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:488.02px;top:364.53px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:126.43px;top:378.53px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:156.81px;top:378.53px" class="cls_053"><span class="cls_053">S S S S K L G H</span></div>
<div style="position:absolute;left:261.72px;top:378.53px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:290.46px;top:378.53px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:311.12px;top:378.53px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:333.66px;top:378.53px" class="cls_053"><span class="cls_053">S S S S N OP H</span></div>
<div style="position:absolute;left:438.99px;top:378.53px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:464.98px;top:378.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:488.02px;top:378.53px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:126.43px;top:392.53px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:156.81px;top:392.53px" class="cls_053"><span class="cls_053">S S S S J K L H</span></div>
<div style="position:absolute;left:261.73px;top:392.53px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:290.46px;top:392.53px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:311.12px;top:392.53px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:333.66px;top:392.53px" class="cls_053"><span class="cls_053">S S S S O P G H</span></div>
<div style="position:absolute;left:439.00px;top:392.53px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:464.99px;top:392.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:488.03px;top:392.53px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:126.43px;top:406.53px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:156.81px;top:406.53px" class="cls_053"><span class="cls_053">S S S S I  J</span></div>
<div style="position:absolute;left:228.53px;top:406.53px" class="cls_053"><span class="cls_053">K L</span></div>
<div style="position:absolute;left:261.73px;top:406.53px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:290.46px;top:406.53px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:311.13px;top:406.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:333.67px;top:406.53px" class="cls_053"><span class="cls_053">S S S S P F G H</span></div>
<div style="position:absolute;left:438.99px;top:406.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:464.98px;top:406.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:488.02px;top:406.53px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:108.00px;top:434.91px" class="cls_058"><span class="cls_058">LEM</span></div>
<div style="position:absolute;left:234.00px;top:434.91px" class="cls_055"><span class="cls_055">Little-endian memory (BigEndianMem = 0)</span></div>
<div style="position:absolute;left:108.00px;top:447.91px" class="cls_058"><span class="cls_058">BEM</span></div>
<div style="position:absolute;left:234.00px;top:447.91px" class="cls_055"><span class="cls_055">BigEndianMem = 1</span></div>
<div style="position:absolute;left:108.00px;top:460.91px" class="cls_058"><span class="cls_058">Type</span></div>
<div style="position:absolute;left:234.00px;top:460.91px" class="cls_055"><span class="cls_055">AccessType sent to memory</span></div>
<div style="position:absolute;left:108.00px;top:473.91px" class="cls_058"><span class="cls_058">Offset</span></div>
<div style="position:absolute;left:234.00px;top:473.91px" class="cls_055"><span class="cls_055">pAddr</span><span class="cls_071"><sub>2...0</sub></span><span class="cls_055"> sent to memory</span></div>
<div style="position:absolute;left:108.00px;top:486.91px" class="cls_058"><span class="cls_058">S</span></div>
<div style="position:absolute;left:234.00px;top:486.91px" class="cls_055"><span class="cls_055">sign-extend of destination</span><span class="cls_071"><sub>31</sub></span></div>
<div style="position:absolute;left:72.00px;top:507.58px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:525.91px" class="cls_055"><span class="cls_055">TLB refill exception</span></div>
<div style="position:absolute;left:108.00px;top:538.91px" class="cls_055"><span class="cls_055">TLB invalid exception</span></div>
<div style="position:absolute;left:108.00px;top:551.91px" class="cls_055"><span class="cls_055">Bus error exception</span></div>
<div style="position:absolute;left:108.00px;top:564.91px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-42</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:203708px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:249.47px;top:70.02px" class="cls_064"><span class="cls_064">Load Word Right</span></div>
<div style="position:absolute;left:104.74px;top:61.98px" class="cls_063"><span class="cls_063">LWR</span></div>
<div style="position:absolute;left:450.10px;top:61.47px" class="cls_063"><span class="cls_063">LWR</span></div>
<div style="position:absolute;left:116.57px;top:109.87px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:109.87px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:109.87px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:109.87px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:489.40px;top:109.87px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:143.98px;top:130.97px" class="cls_053"><span class="cls_053">LWR</span></div>
<div style="position:absolute;left:207.03px;top:132.84px" class="cls_053"><span class="cls_053">base</span></div>
<div style="position:absolute;left:272.27px;top:132.84px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:388.09px;top:131.47px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:131.11px;top:141.98px" class="cls_053"><span class="cls_053">1 0 0 1 1 0</span></div>
<div style="position:absolute;left:151.85px;top:155.73px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.94px;top:155.73px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.12px;top:155.73px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:389.09px;top:155.73px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:174.07px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.41px" class="cls_055"><span class="cls_055">LWR rt, offset(base)</span></div>
<div style="position:absolute;left:72.00px;top:216.07px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.41px" class="cls_055"><span class="cls_055">This instruction can be used in combination with the LWL instruction to load a register with four</span></div>
<div style="position:absolute;left:108.00px;top:247.41px" class="cls_055"><span class="cls_055">consecutive bytes from memory, when the bytes cross a word boundary.  LWR loads the right</span></div>
<div style="position:absolute;left:108.00px;top:260.41px" class="cls_055"><span class="cls_055">portion of the destination register </span><span class="cls_058">rt</span><span class="cls_055"> with the appropriate part of the low-order word; LWL loads</span></div>
<div style="position:absolute;left:108.00px;top:273.41px" class="cls_055"><span class="cls_055">the left portion of the register with the appropriate part of the high-order word.</span></div>
<div style="position:absolute;left:108.00px;top:292.41px" class="cls_055"><span class="cls_055">The LWR instruction adds its sign-extended 16-bit </span><span class="cls_058">offset </span><span class="cls_055">to the contents of general register </span><span class="cls_058">base </span><span class="cls_055">to</span></div>
<div style="position:absolute;left:108.00px;top:305.41px" class="cls_055"><span class="cls_055">form a virtual address which can specify an arbitrary byte.  It loads bytes only from the word in</span></div>
<div style="position:absolute;left:108.00px;top:318.41px" class="cls_055"><span class="cls_055">memory which contains the specified starting byte.  From one to four bytes will be merged into the</span></div>
<div style="position:absolute;left:108.00px;top:331.41px" class="cls_055"><span class="cls_055">destination register </span><span class="cls_058">rt</span><span class="cls_055">, depending on the starting byte specified.</span></div>
<div style="position:absolute;left:108.01px;top:350.41px" class="cls_055"><span class="cls_055">Conceptually, it starts at the specified byte in memory and loads that byte into the low-order (right-</span></div>
<div style="position:absolute;left:108.01px;top:363.41px" class="cls_055"><span class="cls_055">most) byte of the register; then it loads bytes from memory into the register until it reaches the high-</span></div>
<div style="position:absolute;left:108.01px;top:376.41px" class="cls_055"><span class="cls_055">order byte of the word in memory.  The most significant (left-most) byte(s) of the register will not</span></div>
<div style="position:absolute;left:108.01px;top:389.41px" class="cls_055"><span class="cls_055">be changed</span></div>
<div style="position:absolute;left:108.01px;top:408.41px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rt </span><span class="cls_055">are internally bypassed within the processor so that no NOP is</span></div>
<div style="position:absolute;left:108.01px;top:421.41px" class="cls_055"><span class="cls_055">needed between an immediately preceding load instruction which specifies register </span><span class="cls_058">rt </span><span class="cls_055">and a</span></div>
<div style="position:absolute;left:108.01px;top:434.41px" class="cls_055"><span class="cls_055">following LWR (or LWL) instruction which also specifies register </span><span class="cls_058">rt</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:199.30px;top:469.27px" class="cls_053"><span class="cls_053">memory</span></div>
<div style="position:absolute;left:194.48px;top:478.49px" class="cls_053"><span class="cls_053">(big-endian)</span></div>
<div style="position:absolute;left:383.76px;top:483.17px" class="cls_053"><span class="cls_053">register</span></div>
<div style="position:absolute;left:117.65px;top:493.60px" class="cls_053"><span class="cls_053">address 4</span></div>
<div style="position:absolute;left:183.17px;top:493.60px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:211.25px;top:493.60px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:239.33px;top:493.60px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:267.34px;top:493.60px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:314.50px;top:501.67px" class="cls_053"><span class="cls_053">before</span></div>
<div style="position:absolute;left:365.04px;top:500.52px" class="cls_053"><span class="cls_053">A</span></div>
<div style="position:absolute;left:393.12px;top:500.52px" class="cls_053"><span class="cls_053">B</span></div>
<div style="position:absolute;left:421.20px;top:500.52px" class="cls_053"><span class="cls_053">C</span></div>
<div style="position:absolute;left:449.28px;top:500.52px" class="cls_053"><span class="cls_053">D</span></div>
<div style="position:absolute;left:472.90px;top:501.67px" class="cls_053"><span class="cls_053">$24</span></div>
<div style="position:absolute;left:117.65px;top:507.50px" class="cls_053"><span class="cls_053">address 0</span></div>
<div style="position:absolute;left:183.17px;top:507.50px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:211.25px;top:507.50px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:239.33px;top:507.50px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:267.34px;top:507.50px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:242.13px;top:531.63px" class="cls_067"><span class="cls_067">LWR $24,4($0)</span></div>
<div style="position:absolute;left:314.49px;top:561.93px" class="cls_053"><span class="cls_053">after</span></div>
<div style="position:absolute;left:365.04px;top:562.29px" class="cls_053"><span class="cls_053">A</span></div>
<div style="position:absolute;left:393.12px;top:562.29px" class="cls_053"><span class="cls_053">B</span></div>
<div style="position:absolute;left:421.20px;top:562.29px" class="cls_053"><span class="cls_053">C</span></div>
<div style="position:absolute;left:449.28px;top:562.29px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:108.02px;top:592.72px" class="cls_055"><span class="cls_055">No address exceptions due to alignment are possible.</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-43</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:204510px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:249.32px;top:63.54px" class="cls_064"><span class="cls_064">Load Word Right</span></div>
<div style="position:absolute;left:105.43px;top:61.54px" class="cls_063"><span class="cls_063">LWR</span></div>
<div style="position:absolute;left:450.79px;top:61.04px" class="cls_063"><span class="cls_063">LWR</span></div>
<div style="position:absolute;left:267.61px;top:77.65px" class="cls_064"><span class="cls_064">(continued)</span></div>
<div style="position:absolute;left:72.00px;top:113.77px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:108.00px;top:146.10px" class="cls_053"><span class="cls_053">T:  vAddr </span><span class="cls_003">← </span><span class="cls_053">((offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16 </sup></span><span class="cls_053">|| offset</span><span class="cls_061"><sub>15..0</sub></span><span class="cls_053">) + GPR[base]</span></div>
<div style="position:absolute;left:126.00px;top:161.12px" class="cls_053"><span class="cls_053">(pAddr, uncached) </span><span class="cls_003">←</span><span class="cls_053"> AddressTranslation (vAddr, DATA)</span></div>
<div style="position:absolute;left:126.00px;top:172.15px" class="cls_053"><span class="cls_053">pAddr </span><span class="cls_003">← </span><span class="cls_053">pAddr</span><span class="cls_061"><sub>PSIZE-1..2</sub></span><span class="cls_053"> || (pAddr</span><span class="cls_061"><sub>1..0</sub></span><span class="cls_053"> xor ReverseEndian</span><span class="cls_061"><sup>2</sup></span><span class="cls_053">)</span></div>
<div style="position:absolute;left:126.00px;top:187.17px" class="cls_053"><span class="cls_053">if BigEndianMem = 0 then</span></div>
<div style="position:absolute;left:144.00px;top:198.20px" class="cls_053"><span class="cls_053">pAddr </span><span class="cls_003">←</span><span class="cls_053">  pAddr</span><span class="cls_061"><sub>PSIZE-31..2 </sub></span><span class="cls_053">|| 0</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:126.00px;top:213.22px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:126.00px;top:224.25px" class="cls_053"><span class="cls_053">byte </span><span class="cls_003">←</span><span class="cls_053"> vAddr</span><span class="cls_061"><sub>1..0</sub></span><span class="cls_053"> xor BigEndianCPU</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:126.00px;top:239.27px" class="cls_053"><span class="cls_053">mem </span><span class="cls_003">←</span><span class="cls_053"> LoadMemory (uncached, byte, pAddr, vAddr, DATA)</span></div>
<div style="position:absolute;left:126.00px;top:252.29px" class="cls_053"><span class="cls_053">GPR[rt] </span><span class="cls_003">←</span><span class="cls_053"> mem</span><span class="cls_061"><sub>31..32-8*byte</sub></span><span class="cls_053"> || GPR[rt]</span><span class="cls_061"><sub>31-8*byte..0</sub></span></div>
<div style="position:absolute;left:108.00px;top:284.34px" class="cls_055"><span class="cls_055">Given a word in a register and a word in memory, the operation of LWR is as follows:</span></div>
<div style="position:absolute;left:168.07px;top:317.07px" class="cls_064"><span class="cls_064">LWR</span></div>
<div style="position:absolute;left:170.93px;top:340.93px" class="cls_053"><span class="cls_053">Register</span></div>
<div style="position:absolute;left:228.51px;top:341.88px" class="cls_053"><span class="cls_053">A</span></div>
<div style="position:absolute;left:254.57px;top:341.88px" class="cls_053"><span class="cls_053">B</span></div>
<div style="position:absolute;left:283.45px;top:341.88px" class="cls_053"><span class="cls_053">C</span></div>
<div style="position:absolute;left:310.24px;top:341.88px" class="cls_053"><span class="cls_053">D</span></div>
<div style="position:absolute;left:338.95px;top:341.59px" class="cls_053"><span class="cls_053">E</span></div>
<div style="position:absolute;left:365.30px;top:341.59px" class="cls_053"><span class="cls_053">F</span></div>
<div style="position:absolute;left:393.62px;top:341.59px" class="cls_053"><span class="cls_053">G</span></div>
<div style="position:absolute;left:420.69px;top:341.59px" class="cls_053"><span class="cls_053">H</span></div>
<div style="position:absolute;left:170.93px;top:370.74px" class="cls_053"><span class="cls_053">Memory</span></div>
<div style="position:absolute;left:230.45px;top:371.68px" class="cls_053"><span class="cls_053">I</span></div>
<div style="position:absolute;left:255.41px;top:371.68px" class="cls_053"><span class="cls_053">J</span></div>
<div style="position:absolute;left:283.73px;top:371.68px" class="cls_053"><span class="cls_053">K</span></div>
<div style="position:absolute;left:311.07px;top:371.68px" class="cls_053"><span class="cls_053">L</span></div>
<div style="position:absolute;left:338.12px;top:371.39px" class="cls_053"><span class="cls_053">M</span></div>
<div style="position:absolute;left:364.74px;top:371.39px" class="cls_053"><span class="cls_053">N</span></div>
<div style="position:absolute;left:393.62px;top:371.39px" class="cls_053"><span class="cls_053">O</span></div>
<div style="position:absolute;left:420.96px;top:371.39px" class="cls_053"><span class="cls_053">P</span></div>
<div style="position:absolute;left:194.47px;top:410.84px" class="cls_056"><span class="cls_056">BigEndianCPU = 0</span></div>
<div style="position:absolute;left:381.10px;top:412.36px" class="cls_056"><span class="cls_056">BigEndianCPU = 1</span></div>
<div style="position:absolute;left:291.10px;top:426.58px" class="cls_070"><span class="cls_070">offset</span></div>
<div style="position:absolute;left:466.63px;top:427.16px" class="cls_070"><span class="cls_070">offset</span></div>
<div style="position:absolute;left:112.32px;top:431.07px" class="cls_070"><span class="cls_070">vAddr</span><span class="cls_072"><sub>2..0</sub></span></div>
<div style="position:absolute;left:178.06px;top:431.48px" class="cls_070"><span class="cls_070">destination</span></div>
<div style="position:absolute;left:254.38px;top:431.41px" class="cls_070"><span class="cls_070">type</span></div>
<div style="position:absolute;left:356.04px;top:430.90px" class="cls_070"><span class="cls_070">destination</span></div>
<div style="position:absolute;left:432.79px;top:431.55px" class="cls_070"><span class="cls_070">type</span></div>
<div style="position:absolute;left:280.22px;top:440.80px" class="cls_056"><span class="cls_056">LEM  BEM</span></div>
<div style="position:absolute;left:455.33px;top:440.94px" class="cls_056"><span class="cls_056">LEM  BEM</span></div>
<div style="position:absolute;left:124.78px;top:457.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:155.16px;top:457.05px" class="cls_053"><span class="cls_053">S S S S M N O P</span></div>
<div style="position:absolute;left:260.08px;top:457.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:288.81px;top:457.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:309.48px;top:457.05px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:332.02px;top:457.05px" class="cls_053"><span class="cls_053">X X X X E F G I</span></div>
<div style="position:absolute;left:437.35px;top:457.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:463.34px;top:457.05px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:486.38px;top:457.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:124.78px;top:471.05px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:155.16px;top:471.05px" class="cls_053"><span class="cls_053">X X X X E MN O</span></div>
<div style="position:absolute;left:260.08px;top:471.05px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:288.81px;top:471.05px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:309.48px;top:471.05px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:332.02px;top:471.05px" class="cls_053"><span class="cls_053">X X X X E F I  J</span></div>
<div style="position:absolute;left:437.34px;top:471.05px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:463.33px;top:471.05px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:486.37px;top:471.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:124.78px;top:485.05px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:155.16px;top:485.05px" class="cls_053"><span class="cls_053">X X X X E F MN</span></div>
<div style="position:absolute;left:260.07px;top:485.05px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:288.80px;top:485.05px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:309.47px;top:485.05px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:332.01px;top:485.05px" class="cls_053"><span class="cls_053">X X X X E I  J K</span></div>
<div style="position:absolute;left:437.33px;top:485.05px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:463.32px;top:485.05px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:486.36px;top:485.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:124.78px;top:499.05px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:155.16px;top:499.05px" class="cls_053"><span class="cls_053">X X X X E F G M</span></div>
<div style="position:absolute;left:260.06px;top:499.05px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:288.80px;top:499.05px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:309.46px;top:499.05px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:332.00px;top:499.05px" class="cls_053"><span class="cls_053">S S S S I  J K L</span></div>
<div style="position:absolute;left:437.34px;top:499.05px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:463.33px;top:499.05px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:486.37px;top:499.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:124.78px;top:513.05px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:155.16px;top:513.05px" class="cls_053"><span class="cls_053">S S S S I  J</span></div>
<div style="position:absolute;left:226.88px;top:513.05px" class="cls_053"><span class="cls_053">K L</span></div>
<div style="position:absolute;left:260.08px;top:513.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:288.81px;top:513.05px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:309.47px;top:513.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:332.01px;top:513.05px" class="cls_053"><span class="cls_053">X X X X E F G M</span></div>
<div style="position:absolute;left:437.34px;top:513.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:463.33px;top:513.05px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:486.37px;top:513.05px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:124.78px;top:527.05px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:155.16px;top:527.05px" class="cls_053"><span class="cls_053">X X X X E I</span></div>
<div style="position:absolute;left:226.87px;top:527.05px" class="cls_053"><span class="cls_053">J K</span></div>
<div style="position:absolute;left:260.07px;top:527.05px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:288.80px;top:527.05px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:309.46px;top:527.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:332.00px;top:527.05px" class="cls_053"><span class="cls_053">X X X X E F M N</span></div>
<div style="position:absolute;left:437.33px;top:527.05px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:463.32px;top:527.05px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:486.36px;top:527.05px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:124.78px;top:541.05px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:155.16px;top:541.05px" class="cls_053"><span class="cls_053">X X X X E F I  J</span></div>
<div style="position:absolute;left:260.06px;top:541.05px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:288.80px;top:541.05px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:309.47px;top:541.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:332.01px;top:541.05px" class="cls_053"><span class="cls_053">X X X X E MN O</span></div>
<div style="position:absolute;left:437.34px;top:541.05px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:463.33px;top:541.05px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:486.37px;top:541.05px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:124.78px;top:555.05px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:155.16px;top:555.05px" class="cls_053"><span class="cls_053">X X X X E F G I</span></div>
<div style="position:absolute;left:260.06px;top:555.05px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:288.79px;top:555.05px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:309.46px;top:555.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:332.00px;top:555.05px" class="cls_053"><span class="cls_053">S S S S MN O P</span></div>
<div style="position:absolute;left:437.33px;top:555.05px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:463.32px;top:555.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:486.36px;top:555.05px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:108.00px;top:580.91px" class="cls_058"><span class="cls_058">LEM</span></div>
<div style="position:absolute;left:234.00px;top:580.91px" class="cls_055"><span class="cls_055">Little-endian memory (BigEndianMem = 0)</span></div>
<div style="position:absolute;left:108.00px;top:593.91px" class="cls_058"><span class="cls_058">BEM</span></div>
<div style="position:absolute;left:234.00px;top:593.91px" class="cls_055"><span class="cls_055">BigEndianMem = 1</span></div>
<div style="position:absolute;left:108.00px;top:606.91px" class="cls_058"><span class="cls_058">Type</span></div>
<div style="position:absolute;left:234.00px;top:606.91px" class="cls_055"><span class="cls_055">AccessType sent to memory</span></div>
<div style="position:absolute;left:108.00px;top:619.91px" class="cls_058"><span class="cls_058">Offset</span></div>
<div style="position:absolute;left:234.00px;top:619.91px" class="cls_055"><span class="cls_055">pAddr</span><span class="cls_071"><sub>2...0</sub></span><span class="cls_055"> sent to memory</span></div>
<div style="position:absolute;left:108.00px;top:632.91px" class="cls_058"><span class="cls_058">S</span></div>
<div style="position:absolute;left:234.00px;top:632.91px" class="cls_055"><span class="cls_055">sign-extend of destination</span><span class="cls_071"><sub>31</sub></span></div>
<div style="position:absolute;left:234.00px;top:645.91px" class="cls_055"><span class="cls_055">unchanged or sign-extend of destination</span><span class="cls_071"><sub>31</sub></span></div>
<div style="position:absolute;left:108.00px;top:650.41px" class="cls_073"><span class="cls_073">X</span></div>
<div style="position:absolute;left:72.00px;top:666.58px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:684.91px" class="cls_055"><span class="cls_055">TLB refill exception</span></div>
<div style="position:absolute;left:108.00px;top:697.91px" class="cls_055"><span class="cls_055">TLB invalid exception</span></div>
<div style="position:absolute;left:108.00px;top:710.91px" class="cls_055"><span class="cls_055">Bus error exception</span></div>
<div style="position:absolute;left:108.00px;top:723.91px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-44</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:205312px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:223.67px;top:66.85px" class="cls_064"><span class="cls_064">Move From Coprocessor</span></div>
<div style="position:absolute;left:109.32px;top:61.69px" class="cls_063"><span class="cls_063">MFCz</span></div>
<div style="position:absolute;left:439.68px;top:60.39px" class="cls_063"><span class="cls_063">MFCz</span></div>
<div style="position:absolute;left:117.86px;top:103.32px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.51px;top:103.32px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.08px;top:103.32px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:293.69px;top:103.32px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:353.23px;top:103.33px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:486.65px;top:103.33px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:142.61px;top:127.30px" class="cls_053"><span class="cls_053">COPz</span></div>
<div style="position:absolute;left:210.86px;top:127.30px" class="cls_053"><span class="cls_053">MF</span></div>
<div style="position:absolute;left:271.91px;top:127.30px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:332.45px;top:127.30px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:425.11px;top:125.86px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:133.10px;top:136.95px" class="cls_053"><span class="cls_053">0 1 0 0 x x*</span></div>
<div style="position:absolute;left:199.69px;top:136.95px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:378.26px;top:136.95px" class="cls_053"><span class="cls_053">0 0 0</span></div>
<div style="position:absolute;left:408.84px;top:136.95px" class="cls_053"><span class="cls_053">0 0 0 0  0 0 0 0</span></div>
<div style="position:absolute;left:152.70px;top:151.35px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.15px;top:151.35px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:275.76px;top:151.35px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:331.55px;top:151.35px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:427.82px;top:151.34px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:72.00px;top:173.86px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.19px" class="cls_055"><span class="cls_055">MFCz rt, rd</span></div>
<div style="position:absolute;left:72.00px;top:215.86px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.19px" class="cls_055"><span class="cls_055">The contents of coprocessor register </span><span class="cls_058">rd </span><span class="cls_055">of coprocessor</span><span class="cls_058"> z</span><span class="cls_055"> are loaded into general register </span><span class="cls_058">rt.</span></div>
<div style="position:absolute;left:72.00px;top:254.86px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:161.99px;top:281.07px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:189.34px;top:279.07px" class="cls_053"><span class="cls_053">data </span><span class="cls_074">←</span><span class="cls_053"> CPR[z,rd]</span></div>
<div style="position:absolute;left:161.98px;top:295.12px" class="cls_053"><span class="cls_053">T+1:  GPR[rt] </span><span class="cls_074">←</span><span class="cls_053"> data</span></div>
<div style="position:absolute;left:74.50px;top:338.33px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:356.67px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:108.00px;top:369.67px" class="cls_055"><span class="cls_055">Reserved instruction exception (coprocessor 3)</span></div>
<div style="position:absolute;left:72.00px;top:390.33px" class="cls_066"><span class="cls_066">Opcode Bit Encoding:</span></div>
<div style="position:absolute;left:177.92px;top:413.58px" class="cls_053"><span class="cls_053">Bit #31</span></div>
<div style="position:absolute;left:221.04px;top:412.21px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:245.31px;top:412.21px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:268.22px;top:412.21px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:293.78px;top:412.21px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:320.71px;top:412.21px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:343.66px;top:412.57px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:366.62px;top:411.27px" class="cls_053"><span class="cls_053">24</span></div>
<div style="position:absolute;left:392.11px;top:411.27px" class="cls_053"><span class="cls_053">23</span></div>
<div style="position:absolute;left:419.05px;top:411.27px" class="cls_053"><span class="cls_053">22</span></div>
<div style="position:absolute;left:437.18px;top:411.63px" class="cls_053"><span class="cls_053">21</span></div>
<div style="position:absolute;left:489.75px;top:412.57px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:115.10px;top:409.32px" class="cls_069"><span class="cls_069">MFCz</span></div>
<div style="position:absolute;left:199.47px;top:428.48px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:221.65px;top:428.48px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:246.56px;top:428.48px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:269.46px;top:428.48px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:294.37px;top:428.48px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:321.30px;top:428.48px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:347.50px;top:428.48px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:369.68px;top:428.48px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:394.59px;top:428.48px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:417.49px;top:428.48px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:442.40px;top:428.48px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:159.85px;top:432.73px" class="cls_053"><span class="cls_053">MFC0</span></div>
<div style="position:absolute;left:199.80px;top:445.76px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:221.40px;top:445.76px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:245.67px;top:445.76px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:268.51px;top:445.76px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:294.14px;top:445.76px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:321.07px;top:445.76px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:366.91px;top:444.82px" class="cls_053"><span class="cls_053">24</span></div>
<div style="position:absolute;left:392.54px;top:444.82px" class="cls_053"><span class="cls_053">23</span></div>
<div style="position:absolute;left:419.47px;top:444.82px" class="cls_053"><span class="cls_053">22  21</span></div>
<div style="position:absolute;left:178.21px;top:447.13px" class="cls_053"><span class="cls_053">Bit #</span></div>
<div style="position:absolute;left:344.02px;top:446.19px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:490.11px;top:446.19px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:199.76px;top:462.03px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:221.94px;top:462.03px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:246.85px;top:462.03px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:269.82px;top:462.03px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:294.66px;top:462.03px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:321.59px;top:462.03px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:347.79px;top:462.03px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:369.97px;top:462.03px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:394.88px;top:462.03px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:417.78px;top:462.03px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:442.69px;top:462.03px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:160.21px;top:466.35px" class="cls_053"><span class="cls_053">MFC1</span></div>
<div style="position:absolute;left:198.86px;top:479.82px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:220.39px;top:479.82px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:244.67px;top:479.82px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:267.57px;top:479.82px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:293.13px;top:479.82px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:320.07px;top:479.82px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:365.90px;top:478.88px" class="cls_053"><span class="cls_053">24</span></div>
<div style="position:absolute;left:391.54px;top:478.88px" class="cls_053"><span class="cls_053">23</span></div>
<div style="position:absolute;left:418.47px;top:478.88px" class="cls_053"><span class="cls_053">22  21</span></div>
<div style="position:absolute;left:177.27px;top:481.19px" class="cls_053"><span class="cls_053">Bit #</span></div>
<div style="position:absolute;left:343.08px;top:480.18px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:489.10px;top:480.18px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:198.82px;top:496.09px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:221.00px;top:496.09px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:245.91px;top:496.09px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:268.81px;top:496.09px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:293.72px;top:496.09px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:320.66px;top:496.09px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:346.85px;top:496.09px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:369.03px;top:496.09px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:393.94px;top:496.09px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:416.85px;top:496.09px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:441.76px;top:496.09px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:159.19px;top:500.34px" class="cls_053"><span class="cls_053">MFC2</span></div>
<div style="position:absolute;left:198.93px;top:512.72px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:220.46px;top:512.72px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:244.74px;top:512.72px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:267.64px;top:512.72px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:293.20px;top:512.72px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:320.14px;top:512.72px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:365.97px;top:511.78px" class="cls_053"><span class="cls_053">24</span></div>
<div style="position:absolute;left:391.61px;top:511.78px" class="cls_053"><span class="cls_053">23</span></div>
<div style="position:absolute;left:418.54px;top:511.78px" class="cls_053"><span class="cls_053">22  21</span></div>
<div style="position:absolute;left:177.26px;top:514.09px" class="cls_053"><span class="cls_053">Bit #</span></div>
<div style="position:absolute;left:343.14px;top:513.15px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:489.16px;top:513.15px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:198.82px;top:528.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:221.07px;top:528.99px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:245.98px;top:528.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:268.88px;top:528.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:293.79px;top:528.99px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:320.73px;top:528.99px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:346.85px;top:528.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:369.10px;top:528.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:394.01px;top:528.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:416.92px;top:528.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:441.83px;top:528.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:159.25px;top:533.31px" class="cls_053"><span class="cls_053">MFC3</span></div>
<div style="position:absolute;left:217.97px;top:557.53px" class="cls_053"><span class="cls_053">Opcode</span></div>
<div style="position:absolute;left:338.23px;top:556.83px" class="cls_053"><span class="cls_053">Coprocessor Suboperation</span></div>
<div style="position:absolute;left:256.64px;top:575.50px" class="cls_053"><span class="cls_053">Coprocessor Unit Number</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-45</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:206114px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:259.73px;top:65.15px" class="cls_064"><span class="cls_064">Move From HI</span></div>
<div style="position:absolute;left:109.30px;top:61.18px" class="cls_063"><span class="cls_063">MFHI</span></div>
<div style="position:absolute;left:440.57px;top:60.90px" class="cls_063"><span class="cls_063">MFHI</span></div>
<div style="position:absolute;left:117.58px;top:101.74px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.88px;top:101.74px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:270.16px;top:101.74px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:341.93px;top:101.74px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:417.60px;top:101.74px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:433.73px;top:101.74px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:490.41px;top:101.74px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:135.68px;top:125.78px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:233.87px;top:125.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:310.49px;top:125.79px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:390.05px;top:124.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:450.75px;top:125.78px" class="cls_053"><span class="cls_053">MFHI</span></div>
<div style="position:absolute;left:132.12px;top:135.36px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:192.53px;top:135.36px" class="cls_053"><span class="cls_053">0 0  0 0 0 0  0 0 0 0</span></div>
<div style="position:absolute;left:370.17px;top:135.36px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:439.40px;top:135.36px" class="cls_053"><span class="cls_053">0 1 0 0 0 0</span></div>
<div style="position:absolute;left:152.86px;top:149.77px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:228.46px;top:149.77px" class="cls_053"><span class="cls_053">10</span></div>
<div style="position:absolute;left:309.53px;top:149.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:385.20px;top:149.76px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:460.87px;top:149.76px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:170.98px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:192.31px" class="cls_055"><span class="cls_055">MFHI  rd</span></div>
<div style="position:absolute;left:72.00px;top:212.98px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:231.31px" class="cls_055"><span class="cls_055">The contents of special register </span><span class="cls_058">HI</span><span class="cls_055"> are loaded into general register </span><span class="cls_058">rd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:250.31px" class="cls_055"><span class="cls_055">To ensure proper operation in the event of interruptions, the two instructions which follow a MFHI</span></div>
<div style="position:absolute;left:108.00px;top:263.31px" class="cls_055"><span class="cls_055">instruction may not be any of the instructions which modify the </span><span class="cls_058">HI</span><span class="cls_055"> register: MULT, MULTU, DIV,</span></div>
<div style="position:absolute;left:108.01px;top:276.31px" class="cls_055"><span class="cls_055">DIVU, MTHI.</span></div>
<div style="position:absolute;left:72.00px;top:296.98px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:162.32px;top:323.01px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:216.31px;top:323.01px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> HI</span></div>
<div style="position:absolute;left:72.00px;top:363.34px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:381.68px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-46</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:206916px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:258.17px;top:66.85px" class="cls_064"><span class="cls_064">Move From Lo</span></div>
<div style="position:absolute;left:107.65px;top:60.90px" class="cls_063"><span class="cls_063">MFLO</span></div>
<div style="position:absolute;left:430.50px;top:61.18px" class="cls_063"><span class="cls_063">MFLO</span></div>
<div style="position:absolute;left:117.58px;top:103.75px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.88px;top:103.75px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:270.16px;top:103.75px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:341.93px;top:103.75px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:417.60px;top:103.75px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:433.73px;top:103.75px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:490.41px;top:103.75px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:135.68px;top:127.79px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:233.87px;top:127.79px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:310.49px;top:127.80px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:384.58px;top:127.80px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:449.08px;top:127.79px" class="cls_053"><span class="cls_053">MFLO</span></div>
<div style="position:absolute;left:132.12px;top:137.37px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:191.52px;top:137.37px" class="cls_053"><span class="cls_053">0 0  0 0 0 0  0 0 0 0</span></div>
<div style="position:absolute;left:370.16px;top:137.37px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:439.39px;top:137.37px" class="cls_053"><span class="cls_053">0 1 0 0 1 0</span></div>
<div style="position:absolute;left:152.86px;top:151.78px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:228.46px;top:151.78px" class="cls_053"><span class="cls_053">10</span></div>
<div style="position:absolute;left:309.53px;top:151.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:385.20px;top:151.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:460.87px;top:151.77px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:108.00px;top:198.34px" class="cls_055"><span class="cls_055">MFLO  rd</span></div>
<div style="position:absolute;left:72.00px;top:219.00px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:237.34px" class="cls_055"><span class="cls_055">The contents of special register </span><span class="cls_058">LO</span><span class="cls_055"> are loaded into general register </span><span class="cls_058">rd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:256.33px" class="cls_055"><span class="cls_055">To ensure proper operation in the event of interruptions, the two instructions which follow a MFLO</span></div>
<div style="position:absolute;left:108.00px;top:269.33px" class="cls_055"><span class="cls_055">instruction may not be any of the instructions which modify the </span><span class="cls_058">LO</span><span class="cls_055"> register: MULT, MULTU, DIV,</span></div>
<div style="position:absolute;left:108.00px;top:282.33px" class="cls_055"><span class="cls_055">DIVU, MTLO.</span></div>
<div style="position:absolute;left:72.00px;top:303.00px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:137.17px;top:331.67px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:162.37px;top:331.67px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> LO</span></div>
<div style="position:absolute;left:72.00px;top:371.39px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:389.72px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-47</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:207718px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:232.50px;top:68.77px" class="cls_064"><span class="cls_064">Move To Coprocessor</span></div>
<div style="position:absolute;left:108.16px;top:61.09px" class="cls_063"><span class="cls_063">MTCz</span></div>
<div style="position:absolute;left:434.32px;top:60.66px" class="cls_063"><span class="cls_063">MTCz</span></div>
<div style="position:absolute;left:120.17px;top:89.18px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:175.40px;top:89.18px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:238.62px;top:89.18px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:297.88px;top:89.18px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:357.99px;top:89.18px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:492.86px;top:89.18px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:145.36px;top:113.15px" class="cls_053"><span class="cls_053">COPz</span></div>
<div style="position:absolute;left:214.26px;top:113.15px" class="cls_053"><span class="cls_053">MT</span></div>
<div style="position:absolute;left:275.81px;top:113.15px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:337.05px;top:113.15px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:430.66px;top:111.71px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:135.13px;top:122.80px" class="cls_053"><span class="cls_053">0 1 0 0 x x*</span></div>
<div style="position:absolute;left:203.12px;top:122.80px" class="cls_053"><span class="cls_053">0 0 1 0 0</span></div>
<div style="position:absolute;left:380.30px;top:122.80px" class="cls_053"><span class="cls_053">0 0 0</span></div>
<div style="position:absolute;left:410.88px;top:122.80px" class="cls_053"><span class="cls_053">0 0 0 0  0 0 0 0</span></div>
<div style="position:absolute;left:155.38px;top:137.21px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:220.47px;top:137.21px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:279.73px;top:137.21px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:336.10px;top:137.20px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:433.37px;top:137.20px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:72.00px;top:152.92px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:174.25px" class="cls_055"><span class="cls_055">MTCz  rt, rd</span></div>
<div style="position:absolute;left:72.00px;top:188.92px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:207.25px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rt </span><span class="cls_055">are loaded into coprocessor register </span><span class="cls_058">rd </span><span class="cls_055">of coprocessor </span><span class="cls_058">z</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:72.00px;top:221.92px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:108.08px;top:237.46px" class="cls_053"><span class="cls_053">32</span></div>
<div style="position:absolute;left:136.88px;top:237.46px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:162.08px;top:237.46px" class="cls_053"><span class="cls_053">data </span><span class="cls_003">←</span><span class="cls_053"> GPR[rt]</span></div>
<div style="position:absolute;left:136.88px;top:248.47px" class="cls_053"><span class="cls_053">T+1: CPR[z,rd] </span><span class="cls_003">←</span><span class="cls_053"> data</span></div>
<div style="position:absolute;left:72.00px;top:283.08px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:301.41px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:72.00px;top:329.08px" class="cls_066"><span class="cls_066">*Opcode Bit Encoding:</span></div>
<div style="position:absolute;left:173.59px;top:346.54px" class="cls_053"><span class="cls_053">Bit #31</span></div>
<div style="position:absolute;left:216.29px;top:345.17px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:240.20px;top:345.17px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:262.88px;top:345.17px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:288.08px;top:345.17px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:314.66px;top:345.17px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:337.38px;top:345.53px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:360.00px;top:344.23px" class="cls_053"><span class="cls_053">24</span></div>
<div style="position:absolute;left:385.21px;top:344.23px" class="cls_053"><span class="cls_053">23</span></div>
<div style="position:absolute;left:411.78px;top:344.23px" class="cls_053"><span class="cls_053">22  21</span></div>
<div style="position:absolute;left:481.54px;top:345.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:115.82px;top:345.30px" class="cls_069"><span class="cls_069">MTCz</span></div>
<div style="position:absolute;left:194.93px;top:361.44px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:216.89px;top:361.44px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:241.44px;top:361.44px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:264.06px;top:361.44px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:288.61px;top:361.44px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:315.25px;top:361.44px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:341.09px;top:361.44px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:362.98px;top:361.44px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:387.60px;top:361.44px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:410.15px;top:361.44px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:434.77px;top:361.44px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:157.79px;top:365.69px" class="cls_053"><span class="cls_053">C0P0</span></div>
<div style="position:absolute;left:193.60px;top:378.72px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:214.92px;top:378.72px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:238.90px;top:378.72px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:261.44px;top:378.72px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:286.71px;top:378.72px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:313.29px;top:378.72px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:358.56px;top:377.78px" class="cls_053"><span class="cls_053">24</span></div>
<div style="position:absolute;left:383.84px;top:377.78px" class="cls_053"><span class="cls_053">23</span></div>
<div style="position:absolute;left:410.41px;top:377.78px" class="cls_053"><span class="cls_053">22  21</span></div>
<div style="position:absolute;left:172.15px;top:380.09px" class="cls_053"><span class="cls_053">Bit #</span></div>
<div style="position:absolute;left:336.02px;top:379.15px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:480.18px;top:379.15px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:193.49px;top:394.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:215.45px;top:394.99px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:240.00px;top:394.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:262.69px;top:394.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:287.24px;top:394.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:313.81px;top:394.99px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:339.65px;top:394.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:361.54px;top:394.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:386.16px;top:394.99px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:408.78px;top:394.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:433.33px;top:394.99px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:156.36px;top:399.31px" class="cls_053"><span class="cls_053">C0P1</span></div>
<div style="position:absolute;left:193.60px;top:411.92px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:214.85px;top:411.92px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:238.76px;top:411.92px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:261.37px;top:411.92px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:286.64px;top:411.92px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:313.22px;top:411.92px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:358.48px;top:410.98px" class="cls_053"><span class="cls_053">24</span></div>
<div style="position:absolute;left:383.75px;top:410.98px" class="cls_053"><span class="cls_053">23</span></div>
<div style="position:absolute;left:410.33px;top:410.98px" class="cls_053"><span class="cls_053">22  21</span></div>
<div style="position:absolute;left:172.08px;top:413.29px" class="cls_053"><span class="cls_053">Bit #</span></div>
<div style="position:absolute;left:335.87px;top:412.27px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:480.10px;top:412.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:193.49px;top:428.18px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:215.38px;top:428.18px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:240.00px;top:428.18px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:262.55px;top:428.18px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:287.17px;top:428.18px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:313.74px;top:428.18px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:339.58px;top:428.18px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:361.54px;top:428.18px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:386.09px;top:428.18px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:408.70px;top:428.18px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:433.33px;top:428.18px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:156.28px;top:432.43px" class="cls_053"><span class="cls_053">C0P2</span></div>
<div style="position:absolute;left:193.67px;top:445.68px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:214.92px;top:445.68px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:238.83px;top:445.68px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:261.44px;top:445.68px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:286.71px;top:445.68px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:313.29px;top:445.68px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:358.55px;top:444.74px" class="cls_053"><span class="cls_053">24</span></div>
<div style="position:absolute;left:383.83px;top:444.74px" class="cls_053"><span class="cls_053">23</span></div>
<div style="position:absolute;left:410.40px;top:444.74px" class="cls_053"><span class="cls_053">22  21</span></div>
<div style="position:absolute;left:172.15px;top:447.05px" class="cls_053"><span class="cls_053">Bit #</span></div>
<div style="position:absolute;left:335.94px;top:446.11px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:480.17px;top:446.11px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:193.49px;top:461.95px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:215.45px;top:461.95px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:240.07px;top:461.95px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:262.62px;top:461.95px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:287.24px;top:461.95px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:313.81px;top:461.95px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:339.65px;top:461.95px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:361.61px;top:461.95px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:386.16px;top:461.95px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:408.78px;top:461.95px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:433.41px;top:461.95px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:156.35px;top:466.27px" class="cls_053"><span class="cls_053">C0P3</span></div>
<div style="position:absolute;left:202.36px;top:488.96px" class="cls_053"><span class="cls_053">Opcode  Coprocessor Unit Number    Coprocessor Suboperation</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-48</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:208520px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:268.67px;top:66.70px" class="cls_064"><span class="cls_064">Move To HI</span></div>
<div style="position:absolute;left:109.30px;top:61.04px" class="cls_063"><span class="cls_063">MTHI</span></div>
<div style="position:absolute;left:440.57px;top:60.68px" class="cls_063"><span class="cls_063">MTHI</span></div>
<div style="position:absolute;left:117.65px;top:102.53px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:209.31px;top:102.53px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:230.91px;top:102.53px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:282.38px;top:102.53px" class="cls_053"><span class="cls_053">21 20</span></div>
<div style="position:absolute;left:414.64px;top:102.54px" class="cls_053"><span class="cls_053">6 5</span></div>
<div style="position:absolute;left:490.31px;top:102.54px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:137.28px;top:126.51px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:256.82px;top:126.50px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:356.43px;top:126.52px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:446.68px;top:126.52px" class="cls_053"><span class="cls_053">MTHI</span></div>
<div style="position:absolute;left:133.55px;top:136.15px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:293.74px;top:136.15px" class="cls_053"><span class="cls_053">0 0 0  0 0 0 0 0 0 0 0 0 0 0 0</span></div>
<div style="position:absolute;left:436.44px;top:136.15px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:152.85px;top:150.56px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:258.40px;top:150.56px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:354.38px;top:150.56px" class="cls_053"><span class="cls_053">15</span></div>
<div style="position:absolute;left:457.92px;top:150.56px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:174.00px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.34px" class="cls_055"><span class="cls_055">MTHI   rs</span></div>
<div style="position:absolute;left:72.00px;top:216.00px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.34px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rs </span><span class="cls_055">are loaded into special register </span><span class="cls_058">HI</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:253.33px" class="cls_055"><span class="cls_055">Instructions that write to the </span><span class="cls_058">HI</span><span class="cls_055">  and </span><span class="cls_058">LO</span><span class="cls_055"> registers are not interlocked and serialized; a result written</span></div>
<div style="position:absolute;left:108.01px;top:266.33px" class="cls_055"><span class="cls_055">to the </span><span class="cls_058">HI</span><span class="cls_055">/</span><span class="cls_058">LO</span><span class="cls_055"> pair must be read before another result is written.  If a MTHI operation is executed</span></div>
<div style="position:absolute;left:108.01px;top:279.33px" class="cls_055"><span class="cls_055">following a MULT, MULTU, DIV, or DIVU instruction, but before any MFLO, MFHI, MTLO, or</span></div>
<div style="position:absolute;left:108.01px;top:292.33px" class="cls_055"><span class="cls_055">MTHI instructions, the contents of the companion special register </span><span class="cls_058">LO</span><span class="cls_055"> are undefined.</span></div>
<div style="position:absolute;left:72.00px;top:313.00px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:198.83px;top:340.27px" class="cls_053"><span class="cls_053">T-2:  HI </span><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:198.84px;top:359.35px" class="cls_053"><span class="cls_053">T-1:  HI </span><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:198.85px;top:376.56px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:226.21px;top:376.56px" class="cls_053"><span class="cls_053">HI</span><span class="cls_003"> ←</span><span class="cls_053"> GPR[rs]</span></div>
<div style="position:absolute;left:72.00px;top:414.37px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:432.69px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:209322px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:265.95px;top:66.85px" class="cls_064"><span class="cls_064">Move To LO</span></div>
<div style="position:absolute;left:107.65px;top:60.90px" class="cls_063"><span class="cls_063">MTLO</span></div>
<div style="position:absolute;left:429.63px;top:61.18px" class="cls_063"><span class="cls_063">MTLO</span></div>
<div style="position:absolute;left:117.65px;top:105.55px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:209.31px;top:105.55px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:230.91px;top:105.55px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:258.41px;top:105.55px" class="cls_053"><span class="cls_053">21 20</span></div>
<div style="position:absolute;left:414.65px;top:105.56px" class="cls_053"><span class="cls_053">6 5</span></div>
<div style="position:absolute;left:490.32px;top:105.56px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:150.32px;top:129.53px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:242.64px;top:129.53px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:342.04px;top:129.54px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:441.72px;top:129.54px" class="cls_053"><span class="cls_053">MTLO</span></div>
<div style="position:absolute;left:143.56px;top:139.18px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:283.68px;top:139.18px" class="cls_053"><span class="cls_053">0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></div>
<div style="position:absolute;left:436.44px;top:139.18px" class="cls_053"><span class="cls_053">0 1 0 0 1 1</span></div>
<div style="position:absolute;left:152.86px;top:153.58px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:244.01px;top:153.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:339.99px;top:153.58px" class="cls_053"><span class="cls_053">15</span></div>
<div style="position:absolute;left:457.93px;top:153.58px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:174.00px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.34px" class="cls_055"><span class="cls_055">MTLO  rs</span></div>
<div style="position:absolute;left:72.00px;top:216.00px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.34px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rs</span><span class="cls_055"> are loaded into special register </span><span class="cls_058">LO.</span></div>
<div style="position:absolute;left:108.00px;top:253.33px" class="cls_055"><span class="cls_055">Instructions that write to the </span><span class="cls_058">HI</span><span class="cls_055">  and </span><span class="cls_058">LO</span><span class="cls_055"> registers are not interlocked and serialized; a result written</span></div>
<div style="position:absolute;left:108.01px;top:266.33px" class="cls_055"><span class="cls_055">to the </span><span class="cls_058">HI</span><span class="cls_055">/</span><span class="cls_058">LO</span><span class="cls_055"> pair must be read before another result is written.  If a MTLO operation is executed</span></div>
<div style="position:absolute;left:108.01px;top:279.33px" class="cls_055"><span class="cls_055">following a MULT, MULTU, DIV, or DIVU instruction, but before any MFLO, MFHI, MTLO, or</span></div>
<div style="position:absolute;left:108.01px;top:292.33px" class="cls_055"><span class="cls_055">MTHI instructions, the contents of the companion special register </span><span class="cls_058">HI</span><span class="cls_055"> are undefined.</span></div>
<div style="position:absolute;left:72.00px;top:313.00px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:180.72px;top:333.77px" class="cls_053"><span class="cls_053">T-2:  LO </span><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:180.73px;top:352.78px" class="cls_053"><span class="cls_053">T-1:  LO </span><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:180.74px;top:370.06px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:208.10px;top:370.06px" class="cls_053"><span class="cls_053">LO</span><span class="cls_003"> ←</span><span class="cls_053"> GPR[rs]</span></div>
<div style="position:absolute;left:72.00px;top:407.73px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:426.07px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-50</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:210124px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:259.41px;top:68.54px" class="cls_064"><span class="cls_064">Multiply Word</span></div>
<div style="position:absolute;left:107.27px;top:62.05px" class="cls_063"><span class="cls_063">MULT</span></div>
<div style="position:absolute;left:437.79px;top:61.69px" class="cls_063"><span class="cls_063">MULT</span></div>
<div style="position:absolute;left:118.08px;top:102.46px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:173.38px;top:102.46px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.60px;top:102.46px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.86px;top:102.46px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:418.10px;top:102.46px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:434.24px;top:102.46px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:490.91px;top:102.46px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:136.18px;top:122.26px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:215.22px;top:124.06px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:273.79px;top:124.06px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:366.73px;top:122.26px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:447.78px;top:122.26px" class="cls_053"><span class="cls_053">MULT</span></div>
<div style="position:absolute;left:127.86px;top:132.63px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:324.42px;top:132.63px" class="cls_053"><span class="cls_053">0 0  0 0 0 0  0 0 0 0</span></div>
<div style="position:absolute;left:435.05px;top:132.63px" class="cls_053"><span class="cls_053">0 1 1 0 0 0</span></div>
<div style="position:absolute;left:153.36px;top:145.52px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:218.45px;top:145.52px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.63px;top:145.52px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:364.10px;top:145.52px" class="cls_053"><span class="cls_053">10</span></div>
<div style="position:absolute;left:461.38px;top:145.52px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:166.08px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:187.41px" class="cls_055"><span class="cls_055">MULT rs, rt</span></div>
<div style="position:absolute;left:72.00px;top:208.08px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:226.41px" class="cls_055"><span class="cls_055">The contents of general registers </span><span class="cls_058">rs </span><span class="cls_055">and </span><span class="cls_058">rt </span><span class="cls_055">are multiplied, treating both operands as 32-bit 2’s</span></div>
<div style="position:absolute;left:108.01px;top:239.41px" class="cls_055"><span class="cls_055">complement values.  No integer overflow exception occurs under any circumstances.</span></div>
<div style="position:absolute;left:108.01px;top:258.42px" class="cls_055"><span class="cls_055">When the operation completes, the low-order word of the double result is loaded into special</span></div>
<div style="position:absolute;left:108.01px;top:271.42px" class="cls_055"><span class="cls_055">register </span><span class="cls_058">LO</span><span class="cls_055">, and the high-order word of the double result is loaded into special register </span><span class="cls_058">HI</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.02px;top:290.42px" class="cls_055"><span class="cls_055">If either of the two preceding instructions is MFHI or MFLO, the results of these instructions are</span></div>
<div style="position:absolute;left:108.02px;top:303.42px" class="cls_055"><span class="cls_055">undefined.  Correct operation requires separating reads of </span><span class="cls_058">HI</span><span class="cls_055"> or </span><span class="cls_058">LO</span><span class="cls_055"> from writes by a minimum of</span></div>
<div style="position:absolute;left:108.03px;top:316.42px" class="cls_055"><span class="cls_055">two other instructions.</span></div>
<div style="position:absolute;left:72.00px;top:337.08px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:155.45px;top:355.83px" class="cls_053"><span class="cls_053">T-2: LO</span></div>
<div style="position:absolute;left:234.65px;top:355.83px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:180.65px;top:366.84px" class="cls_053"><span class="cls_053">HI</span></div>
<div style="position:absolute;left:234.65px;top:366.84px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:155.45px;top:377.85px" class="cls_053"><span class="cls_053">T-1: LO</span></div>
<div style="position:absolute;left:234.65px;top:377.85px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:180.65px;top:388.86px" class="cls_053"><span class="cls_053">HI</span></div>
<div style="position:absolute;left:234.65px;top:388.86px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:155.45px;top:399.87px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:180.64px;top:399.87px" class="cls_053"><span class="cls_053">t</span></div>
<div style="position:absolute;left:234.65px;top:399.87px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> GPR[rs] * GPR[rt]</span></div>
<div style="position:absolute;left:180.65px;top:410.88px" class="cls_053"><span class="cls_053">LO</span></div>
<div style="position:absolute;left:234.65px;top:410.88px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> t</span><span class="cls_061"><sub>31...0</sub></span></div>
<div style="position:absolute;left:180.65px;top:421.88px" class="cls_053"><span class="cls_053">H I</span></div>
<div style="position:absolute;left:234.65px;top:421.88px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> t</span><span class="cls_061"><sub>63...32</sub></span></div>
<div style="position:absolute;left:72.00px;top:460.80px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:479.13px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-51</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:210926px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:226.34px;top:67.71px" class="cls_064"><span class="cls_064">Multiply Unsigned Word</span></div>
<div style="position:absolute;left:107.42px;top:61.54px" class="cls_063"><span class="cls_063">MULTU</span></div>
<div style="position:absolute;left:421.95px;top:61.90px" class="cls_063"><span class="cls_063">MULTU</span></div>
<div style="position:absolute;left:118.01px;top:106.06px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:173.31px;top:106.06px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.53px;top:106.06px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.79px;top:106.06px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:418.03px;top:106.06px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:434.16px;top:106.06px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:490.84px;top:106.06px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:136.11px;top:128.31px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:215.15px;top:130.32px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:273.72px;top:130.32px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:366.66px;top:128.31px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:444.10px;top:128.31px" class="cls_053"><span class="cls_053">MULTU</span></div>
<div style="position:absolute;left:132.55px;top:140.05px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:329.11px;top:140.05px" class="cls_053"><span class="cls_053">0 0  0 0 0 0  0 0 0 0</span></div>
<div style="position:absolute;left:434.99px;top:140.05px" class="cls_053"><span class="cls_053">0 1 1 0 0 1</span></div>
<div style="position:absolute;left:153.29px;top:154.66px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:218.38px;top:154.66px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.56px;top:154.66px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:364.03px;top:154.66px" class="cls_053"><span class="cls_053">10</span></div>
<div style="position:absolute;left:461.31px;top:154.66px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:175.59px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:196.92px" class="cls_055"><span class="cls_055">MULTU rs, rt</span></div>
<div style="position:absolute;left:72.00px;top:217.59px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:235.92px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rs </span><span class="cls_055">and the contents of general register </span><span class="cls_058">rt </span><span class="cls_055">are multiplied, treating</span></div>
<div style="position:absolute;left:108.01px;top:248.92px" class="cls_055"><span class="cls_055">both operands as unsigned values.  No overflow exception occurs under any circumstances.</span></div>
<div style="position:absolute;left:108.01px;top:267.92px" class="cls_055"><span class="cls_055">When the operation completes, the low-order word of the double result is loaded into special</span></div>
<div style="position:absolute;left:108.01px;top:280.92px" class="cls_055"><span class="cls_055">register </span><span class="cls_058">LO</span><span class="cls_055">, and the high-order word of the double result is loaded into special register </span><span class="cls_058">HI</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.02px;top:299.92px" class="cls_055"><span class="cls_055">If either of the two preceding instructions is MFHI or MFLO, the results of these instructions are</span></div>
<div style="position:absolute;left:108.02px;top:312.92px" class="cls_055"><span class="cls_055">undefined.  Correct operation requires separating reads of </span><span class="cls_058">HI</span><span class="cls_055"> or </span><span class="cls_058">LO</span><span class="cls_055"> from writes by a minimum of</span></div>
<div style="position:absolute;left:108.03px;top:325.92px" class="cls_055"><span class="cls_055">two instructions.</span></div>
<div style="position:absolute;left:72.00px;top:346.58px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:136.76px;top:371.37px" class="cls_053"><span class="cls_053">T-2: LO</span></div>
<div style="position:absolute;left:215.96px;top:371.37px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:161.96px;top:382.38px" class="cls_053"><span class="cls_053">HI</span></div>
<div style="position:absolute;left:215.96px;top:382.38px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:136.76px;top:393.39px" class="cls_053"><span class="cls_053">T-1: LO</span></div>
<div style="position:absolute;left:215.96px;top:393.39px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:161.96px;top:404.40px" class="cls_053"><span class="cls_053">HI</span></div>
<div style="position:absolute;left:215.96px;top:404.40px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> undefined</span></div>
<div style="position:absolute;left:136.76px;top:415.41px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:161.96px;top:415.41px" class="cls_053"><span class="cls_053">t</span></div>
<div style="position:absolute;left:215.96px;top:415.41px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> (0 || GPR[rs]) * (0 || GPR[rt])</span></div>
<div style="position:absolute;left:161.96px;top:426.42px" class="cls_053"><span class="cls_053">LO</span></div>
<div style="position:absolute;left:215.96px;top:426.42px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> t</span><span class="cls_061"><sub>31...0</sub></span></div>
<div style="position:absolute;left:161.96px;top:437.42px" class="cls_053"><span class="cls_053">HI</span></div>
<div style="position:absolute;left:215.96px;top:437.42px" class="cls_003"><span class="cls_003">←</span><span class="cls_053"> t</span><span class="cls_061"><sub>63...32</sub></span></div>
<div style="position:absolute;left:72.00px;top:474.89px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:493.23px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-52</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:211728px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:293.95px;top:66.85px" class="cls_064"><span class="cls_064">Nor</span></div>
<div style="position:absolute;left:107.60px;top:61.18px" class="cls_063"><span class="cls_063">NOR</span></div>
<div style="position:absolute;left:455.57px;top:60.90px" class="cls_063"><span class="cls_063">NOR</span></div>
<div style="position:absolute;left:117.65px;top:105.55px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.88px;top:105.55px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.10px;top:105.55px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.36px;top:105.55px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:355.46px;top:105.56px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:414.81px;top:105.56px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:430.87px;top:105.56px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:490.34px;top:105.56px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:135.05px;top:129.53px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:214.79px;top:129.53px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:273.29px;top:129.53px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:334.53px;top:129.53px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:395.67px;top:129.53px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:448.91px;top:129.53px" class="cls_053"><span class="cls_053">NOR</span></div>
<div style="position:absolute;left:129.16px;top:139.18px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:378.14px;top:139.18px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:436.41px;top:139.18px" class="cls_053"><span class="cls_053">1 0 0 1 1 1</span></div>
<div style="position:absolute;left:152.86px;top:153.58px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.95px;top:153.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.21px;top:153.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:333.57px;top:153.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:393.04px;top:153.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:457.92px;top:153.58px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:177.02px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:198.36px" class="cls_055"><span class="cls_055">NOR rd, rs, rt</span></div>
<div style="position:absolute;left:72.00px;top:219.02px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:237.36px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rs </span><span class="cls_055">are combined with the contents of general register </span><span class="cls_058">rt </span><span class="cls_055">in a bit-wise</span></div>
<div style="position:absolute;left:108.01px;top:250.36px" class="cls_055"><span class="cls_055">logical NOR operation.  The result is placed into general register </span><span class="cls_058">rd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:72.00px;top:271.02px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:136.56px;top:299.70px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:161.76px;top:299.70px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">← </span><span class="cls_053">GPR[rs] nor GPR[rt]</span></div>
<div style="position:absolute;left:72.00px;top:335.01px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:353.35px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-53</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:212530px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:279.83px;top:66.85px" class="cls_064"><span class="cls_064">Or</span></div>
<div style="position:absolute;left:87.67px;top:60.90px" class="cls_063"><span class="cls_063">OR</span></div>
<div style="position:absolute;left:453.78px;top:61.18px" class="cls_063"><span class="cls_063">OR</span></div>
<div style="position:absolute;left:99.65px;top:104.54px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:154.88px;top:104.54px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:218.10px;top:104.54px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:277.36px;top:104.54px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:337.46px;top:104.55px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:396.81px;top:104.55px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:412.87px;top:104.55px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:472.34px;top:104.55px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:117.05px;top:128.52px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:196.79px;top:128.52px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:255.29px;top:128.52px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:316.53px;top:128.52px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:377.67px;top:128.52px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:437.83px;top:128.52px" class="cls_053"><span class="cls_053">OR</span></div>
<div style="position:absolute;left:111.16px;top:138.17px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:360.14px;top:138.17px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:418.41px;top:138.17px" class="cls_053"><span class="cls_053">1 0 0 1 0 1</span></div>
<div style="position:absolute;left:134.86px;top:152.57px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:199.95px;top:152.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:259.21px;top:152.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:315.57px;top:152.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:375.04px;top:152.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:439.92px;top:152.57px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:176.02px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:197.35px" class="cls_055"><span class="cls_055">OR rd, rs, rt</span></div>
<div style="position:absolute;left:72.00px;top:218.02px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:236.35px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rs </span><span class="cls_055">are combined with the contents of general register </span><span class="cls_058">rt </span><span class="cls_055">in</span></div>
<div style="position:absolute;left:108.00px;top:249.35px" class="cls_055"><span class="cls_055">a bit-wise logical OR operation.  The result is placed into general register </span><span class="cls_058">rd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:72.00px;top:270.02px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:161.79px;top:297.86px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:215.78px;top:297.86px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> GPR[rs] or GPR[rt]</span></div>
<div style="position:absolute;left:72.00px;top:331.92px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:350.25px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-54</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:213332px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:261.49px;top:66.27px" class="cls_064"><span class="cls_064">Or Immediate</span></div>
<div style="position:absolute;left:106.19px;top:61.11px" class="cls_063"><span class="cls_063">ORI</span></div>
<div style="position:absolute;left:466.51px;top:60.61px" class="cls_063"><span class="cls_063">ORI</span></div>
<div style="position:absolute;left:116.57px;top:102.74px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:102.74px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:102.74px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:102.74px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:489.40px;top:102.74px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:146.20px;top:126.79px" class="cls_053"><span class="cls_053">ORI</span></div>
<div style="position:absolute;left:213.71px;top:126.79px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:272.28px;top:126.79px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:377.27px;top:125.35px" class="cls_053"><span class="cls_053">immediate</span></div>
<div style="position:absolute;left:131.11px;top:136.37px" class="cls_053"><span class="cls_053">0 0 1 1 0 1</span></div>
<div style="position:absolute;left:151.85px;top:150.77px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.94px;top:150.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.12px;top:150.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:389.09px;top:150.77px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:174.00px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.34px" class="cls_055"><span class="cls_055">ORI rt, rs, immediate</span></div>
<div style="position:absolute;left:72.00px;top:216.00px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.34px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">immediate </span><span class="cls_055">is zero-extended and combined with the contents of general register </span><span class="cls_058">rs </span><span class="cls_055">in a bit-</span></div>
<div style="position:absolute;left:108.00px;top:247.33px" class="cls_055"><span class="cls_055">wise logical OR operation.  The result is placed into general register </span><span class="cls_058">rt</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:72.00px;top:268.00px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:136.68px;top:293.95px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:161.88px;top:293.95px" class="cls_053"><span class="cls_053">GPR[rt] </span><span class="cls_003">←</span><span class="cls_053"> GPR[rs]</span><span class="cls_061"><sub>31...16</sub></span><span class="cls_053"> || (immediate or GPR[rs]</span><span class="cls_061"><sub>15...0</sub></span><span class="cls_053">)</span></div>
<div style="position:absolute;left:72.00px;top:345.61px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:363.93px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-55</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:214134px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:271.00px;top:67.71px" class="cls_064"><span class="cls_064">Store Byte</span></div>
<div style="position:absolute;left:105.57px;top:61.76px" class="cls_063"><span class="cls_063">SB</span></div>
<div style="position:absolute;left:472.57px;top:61.26px" class="cls_063"><span class="cls_063">SB</span></div>
<div style="position:absolute;left:116.57px;top:105.62px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:105.62px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:105.62px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:105.62px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:489.40px;top:105.62px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:148.42px;top:129.67px" class="cls_053"><span class="cls_053">SB</span></div>
<div style="position:absolute;left:207.04px;top:129.67px" class="cls_053"><span class="cls_053">base</span></div>
<div style="position:absolute;left:272.28px;top:129.67px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:388.09px;top:128.23px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:131.11px;top:139.25px" class="cls_053"><span class="cls_053">1 0 1 0 0 0</span></div>
<div style="position:absolute;left:151.85px;top:153.65px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.94px;top:153.65px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.12px;top:153.65px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:389.09px;top:153.65px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:175.37px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:196.70px" class="cls_055"><span class="cls_055">SB rt, offset(base)</span></div>
<div style="position:absolute;left:72.00px;top:217.37px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:235.70px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">offset </span><span class="cls_055">is sign-extended and added to the contents of general register </span><span class="cls_058">base </span><span class="cls_055">to form a virtual</span></div>
<div style="position:absolute;left:108.00px;top:248.70px" class="cls_055"><span class="cls_055">address.  The least-significant byte of register </span><span class="cls_058">rt </span><span class="cls_055">is stored at the effective address.</span></div>
<div style="position:absolute;left:72.00px;top:269.37px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:136.97px;top:292.61px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:162.17px;top:290.61px" class="cls_053"><span class="cls_053">vAddr</span><span class="cls_003"> ← </span><span class="cls_053">((offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16 </sup></span><span class="cls_053"> || offset</span><span class="cls_061"><sub>15...0</sub></span><span class="cls_053">)</span></div>
<div style="position:absolute;left:321.78px;top:292.61px" class="cls_053"><span class="cls_053">+ GPR[base]</span></div>
<div style="position:absolute;left:162.17px;top:306.69px" class="cls_053"><span class="cls_053">(pAddr, uncached) </span><span class="cls_003">←</span><span class="cls_053"> AddressTranslation (vAddr, DATA)</span></div>
<div style="position:absolute;left:162.17px;top:318.45px" class="cls_053"><span class="cls_053">pAddr </span><span class="cls_003">←</span><span class="cls_053"> pAddr</span><span class="cls_061"><sub>PSIZE-1...2</sub></span><span class="cls_053"> || (pAddr</span><span class="cls_061"><sub>1...0</sub></span><span class="cls_053"> xor ReverseEndian</span><span class="cls_061"><sup>2</sup></span><span class="cls_053">)</span></div>
<div style="position:absolute;left:162.17px;top:334.70px" class="cls_053"><span class="cls_053">byte</span><span class="cls_003"> ← </span><span class="cls_053">vAddr</span><span class="cls_061"><sub>1...0 </sub></span><span class="cls_053"> xor  BigEndianCPU</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:162.17px;top:348.45px" class="cls_053"><span class="cls_053">data </span><span class="cls_003">←</span><span class="cls_053"> GPR[rt]</span><span class="cls_061"><sub>31-8*byte...0</sub></span><span class="cls_053"> || 0</span><span class="cls_061"><sup>8*byte</sup></span></div>
<div style="position:absolute;left:162.17px;top:362.86px" class="cls_053"><span class="cls_053">StoreMemory (uncached, BYTE, data, pAddr, vAddr, DATA)</span></div>
<div style="position:absolute;left:72.00px;top:398.77px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:417.11px" class="cls_055"><span class="cls_055">TLB refill exception</span></div>
<div style="position:absolute;left:108.00px;top:430.11px" class="cls_055"><span class="cls_055">TLB invalid exception</span></div>
<div style="position:absolute;left:108.00px;top:443.11px" class="cls_055"><span class="cls_055">TLB modification exception</span></div>
<div style="position:absolute;left:108.00px;top:456.11px" class="cls_055"><span class="cls_055">Bus error exception</span></div>
<div style="position:absolute;left:108.00px;top:469.11px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-56</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:214936px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:256.23px;top:68.58px" class="cls_064"><span class="cls_064">Store Halfword</span></div>
<div style="position:absolute;left:106.79px;top:62.05px" class="cls_063"><span class="cls_063">SH</span></div>
<div style="position:absolute;left:473.10px;top:61.69px" class="cls_063"><span class="cls_063">SH</span></div>
<div style="position:absolute;left:118.01px;top:104.98px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:173.31px;top:104.98px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.53px;top:104.98px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.79px;top:104.98px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:490.84px;top:104.98px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:149.59px;top:129.03px" class="cls_053"><span class="cls_053">SH</span></div>
<div style="position:absolute;left:208.48px;top:129.03px" class="cls_053"><span class="cls_053">base</span></div>
<div style="position:absolute;left:273.72px;top:129.03px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:389.54px;top:127.59px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:132.56px;top:138.61px" class="cls_053"><span class="cls_053">1 0 1 0 0 1</span></div>
<div style="position:absolute;left:153.30px;top:153.01px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:218.39px;top:153.01px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.57px;top:153.01px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:390.54px;top:153.01px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:173.57px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:194.90px" class="cls_055"><span class="cls_055">SH rt, offset(base)</span></div>
<div style="position:absolute;left:72.00px;top:209.57px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:227.90px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">offset </span><span class="cls_055">is sign-extended and added to the contents of general register </span><span class="cls_058">base </span><span class="cls_055">to form an</span></div>
<div style="position:absolute;left:108.00px;top:240.90px" class="cls_055"><span class="cls_055">unsigned effective address.  The least-significant halfword of register </span><span class="cls_058">rt </span><span class="cls_055">is stored at the effective</span></div>
<div style="position:absolute;left:108.00px;top:253.90px" class="cls_055"><span class="cls_055">address.  If the least-significant bit of the effective address is non-zero, an address error exception</span></div>
<div style="position:absolute;left:108.00px;top:266.90px" class="cls_055"><span class="cls_055">occurs.</span></div>
<div style="position:absolute;left:72.00px;top:287.57px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:137.89px;top:309.48px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:163.09px;top:307.48px" class="cls_053"><span class="cls_053">vAddr</span><span class="cls_003"> ← </span><span class="cls_053">((offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16</sup></span><span class="cls_053">  || offset</span><span class="cls_061"><sub>15...0</sub></span><span class="cls_053">) + GPR[base]</span></div>
<div style="position:absolute;left:163.09px;top:322.94px" class="cls_053"><span class="cls_053">(pAddr, uncached) </span><span class="cls_003">←</span><span class="cls_053"> AddressTranslation (vAddr, DATA)</span></div>
<div style="position:absolute;left:163.09px;top:338.10px" class="cls_053"><span class="cls_053">pAddr </span><span class="cls_003">←</span><span class="cls_053"> pAddr</span><span class="cls_061"><sub>PSIZE-1...2</sub></span><span class="cls_053"> || (pAddr</span><span class="cls_061"><sub>1...0</sub></span><span class="cls_053"> xor (ReverseEndian || 0))</span></div>
<div style="position:absolute;left:163.09px;top:352.46px" class="cls_053"><span class="cls_053">byte</span><span class="cls_003"> ← </span><span class="cls_053">vAddr</span><span class="cls_061"><sub>1...0</sub></span></div>
<div style="position:absolute;left:245.25px;top:352.46px" class="cls_053"><span class="cls_053">xor (BigEndianCPU || 0)</span></div>
<div style="position:absolute;left:163.10px;top:364.79px" class="cls_053"><span class="cls_053">data </span><span class="cls_003">←</span><span class="cls_053"> GPR[rt]</span><span class="cls_061"><sub>31-8*byte...0</sub></span><span class="cls_053"> || 0</span><span class="cls_061"><sup>8*byte</sup></span></div>
<div style="position:absolute;left:163.09px;top:381.98px" class="cls_053"><span class="cls_053">StoreMemory (uncached, HALFWORD, data, pAddr, vAddr, DATA)</span></div>
<div style="position:absolute;left:72.00px;top:488.48px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:506.81px" class="cls_055"><span class="cls_055">TLB refill exception</span></div>
<div style="position:absolute;left:108.00px;top:519.81px" class="cls_055"><span class="cls_055">TLB invalid exception</span></div>
<div style="position:absolute;left:108.00px;top:532.81px" class="cls_055"><span class="cls_055">TLB modification exception</span></div>
<div style="position:absolute;left:108.00px;top:545.81px" class="cls_055"><span class="cls_055">Bus error exception</span></div>
<div style="position:absolute;left:108.00px;top:558.81px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-57</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:215738px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:229.41px;top:69.15px" class="cls_064"><span class="cls_064">Shift Word Left Logical</span></div>
<div style="position:absolute;left:105.64px;top:60.68px" class="cls_063"><span class="cls_063">SLL</span></div>
<div style="position:absolute;left:460.95px;top:61.18px" class="cls_063"><span class="cls_063">SLL</span></div>
<div style="position:absolute;left:116.64px;top:103.54px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:103.54px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:103.54px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:103.54px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:354.45px;top:103.54px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:413.80px;top:103.54px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:429.86px;top:103.54px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:489.33px;top:103.54px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:134.04px;top:127.52px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:213.94px;top:125.02px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:272.27px;top:127.52px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:333.52px;top:127.51px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:392.17px;top:127.51px" class="cls_053"><span class="cls_053">sa</span></div>
<div style="position:absolute;left:453.43px;top:127.51px" class="cls_053"><span class="cls_053">SLL</span></div>
<div style="position:absolute;left:128.15px;top:137.16px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:197.27px;top:136.63px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:435.40px;top:137.16px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:151.84px;top:151.57px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.93px;top:151.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.19px;top:151.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:332.57px;top:151.56px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:392.04px;top:151.56px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:456.91px;top:151.56px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:174.00px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.34px" class="cls_055"><span class="cls_055">SLL rd, rt, sa</span></div>
<div style="position:absolute;left:72.00px;top:216.00px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.34px" class="cls_055"><span class="cls_055">The contents of the low-order word of general register </span><span class="cls_058">rt </span><span class="cls_055">are shifted left by </span><span class="cls_058">sa </span><span class="cls_055">bits, inserting zeros</span></div>
<div style="position:absolute;left:108.00px;top:247.33px" class="cls_055"><span class="cls_055">into the low-order bits.  The word result is placed in register </span><span class="cls_058">rd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:266.33px" class="cls_055"><span class="cls_055">If </span><span class="cls_058">rd</span><span class="cls_055"> is a 64-bit register, the result word is sign-extended when it is placed in the register.  The result</span></div>
<div style="position:absolute;left:108.00px;top:279.33px" class="cls_055"><span class="cls_055">word is sign extended even if the shift amount is zero; this instructions with a zero shift amount</span></div>
<div style="position:absolute;left:108.00px;top:292.33px" class="cls_055"><span class="cls_055">can be used to truncate a 64-bit value and sign extend the lower word.  Unlike nearly all other word</span></div>
<div style="position:absolute;left:108.00px;top:305.33px" class="cls_055"><span class="cls_055">operations the input operand does not have to be a properly sign-extended word value to produce</span></div>
<div style="position:absolute;left:108.00px;top:318.33px" class="cls_055"><span class="cls_055">a valid result.</span></div>
<div style="position:absolute;left:72.00px;top:339.00px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:137.17px;top:368.33px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:162.37px;top:366.33px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> GPR[rt]</span><span class="cls_061"><sub>31- sa...0</sub></span><span class="cls_053"> || 0</span><span class="cls_061"><sup>sa</sup></span></div>
<div style="position:absolute;left:72.00px;top:445.83px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:464.17px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-58</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:216540px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:105.22px;top:61.18px" class="cls_063"><span class="cls_063">SLLV</span><span class="cls_064">   Shift Word Left Logical Variable</span></div>
<div style="position:absolute;left:439.91px;top:60.90px" class="cls_063"><span class="cls_063">SLLV</span></div>
<div style="position:absolute;left:117.65px;top:104.54px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.88px;top:104.54px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.10px;top:104.54px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.36px;top:104.54px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:355.46px;top:104.55px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:414.81px;top:104.55px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:430.87px;top:104.55px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:490.34px;top:104.55px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:135.05px;top:128.52px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:213.56px;top:128.16px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:273.29px;top:128.52px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:334.53px;top:128.52px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:395.67px;top:128.52px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:451.10px;top:128.52px" class="cls_053"><span class="cls_053">SLLV</span></div>
<div style="position:absolute;left:129.16px;top:138.17px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:376.77px;top:138.17px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:441.22px;top:138.17px" class="cls_053"><span class="cls_053">0 0 0 1 0 0</span></div>
<div style="position:absolute;left:152.86px;top:152.57px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:214.95px;top:152.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.20px;top:152.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:333.57px;top:152.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:393.04px;top:152.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:457.92px;top:152.57px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:175.01px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:196.34px" class="cls_055"><span class="cls_055">SLLV rd, rt, rs</span></div>
<div style="position:absolute;left:72.00px;top:217.01px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:235.34px" class="cls_055"><span class="cls_055">The contents of the low-order word of general register </span><span class="cls_058">rt </span><span class="cls_055">are shifted left the number of bits specified</span></div>
<div style="position:absolute;left:108.01px;top:248.34px" class="cls_055"><span class="cls_055">by the low-order five bits contained in general register </span><span class="cls_058">rs</span><span class="cls_055">, inserting zeros into the low-order bits.</span></div>
<div style="position:absolute;left:108.01px;top:261.34px" class="cls_055"><span class="cls_055">The word-value result is placed in register </span><span class="cls_058">rd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:72.00px;top:301.01px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:136.72px;top:321.13px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:161.92px;top:321.13px" class="cls_053"><span class="cls_053">s </span><span class="cls_003">←</span><span class="cls_053"> GP[rs]</span><span class="cls_061"><sub>4...0</sub></span></div>
<div style="position:absolute;left:161.92px;top:335.13px" class="cls_053"><span class="cls_053">GPR[rd]</span><span class="cls_003">←</span><span class="cls_053"> GPR[rt]</span><span class="cls_061"><sub>(31-s)...0</sub></span><span class="cls_053"> || 0</span><span class="cls_061"><sup>s</sup></span></div>
<div style="position:absolute;left:72.00px;top:417.85px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:436.18px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-59</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:217342px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:246.89px;top:68.36px" class="cls_064"><span class="cls_064">Set On Less Than</span></div>
<div style="position:absolute;left:105.64px;top:60.82px" class="cls_063"><span class="cls_063">SLT</span></div>
<div style="position:absolute;left:457.61px;top:60.97px" class="cls_063"><span class="cls_063">SLT</span></div>
<div style="position:absolute;left:117.65px;top:103.75px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.88px;top:103.75px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.10px;top:103.75px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.36px;top:103.75px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:355.46px;top:103.76px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:414.81px;top:103.76px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:430.87px;top:103.76px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:490.34px;top:103.76px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:135.05px;top:127.80px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:214.79px;top:127.80px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:273.29px;top:127.80px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:334.53px;top:127.80px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:395.67px;top:127.80px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:455.68px;top:127.80px" class="cls_053"><span class="cls_053">SLT</span></div>
<div style="position:absolute;left:129.16px;top:137.38px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:376.77px;top:137.38px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:441.22px;top:137.38px" class="cls_053"><span class="cls_053">1 0 1 0 1 0</span></div>
<div style="position:absolute;left:152.86px;top:151.78px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.95px;top:151.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.21px;top:151.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:333.57px;top:151.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:393.04px;top:151.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:457.92px;top:151.78px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:173.21px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:194.54px" class="cls_055"><span class="cls_055">SLT rd, rs, rt</span></div>
<div style="position:absolute;left:72.00px;top:215.21px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:233.54px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rt </span><span class="cls_055">are subtracted from the contents of general register </span><span class="cls_058">rs</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.01px;top:246.54px" class="cls_055"><span class="cls_055">Considering both quantities as signed integers, if the contents of general register </span><span class="cls_058">rs </span><span class="cls_055">are less than the</span></div>
<div style="position:absolute;left:108.01px;top:259.54px" class="cls_055"><span class="cls_055">contents of general register </span><span class="cls_058">rt</span><span class="cls_055">, the result is set to one; otherwise the result is set to zero.</span></div>
<div style="position:absolute;left:108.02px;top:278.54px" class="cls_055"><span class="cls_055">The result is placed into general register </span><span class="cls_058">rd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.02px;top:297.54px" class="cls_055"><span class="cls_055">No integer overflow exception occurs under any circumstances.  The comparison is valid even if</span></div>
<div style="position:absolute;left:108.02px;top:310.54px" class="cls_055"><span class="cls_055">the subtraction used during the comparison overflows.</span></div>
<div style="position:absolute;left:72.00px;top:331.21px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:136.83px;top:356.05px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:162.02px;top:356.05px" class="cls_053"><span class="cls_053">if GPR[rs] &lt; GPR[rt] then</span></div>
<div style="position:absolute;left:216.03px;top:365.06px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> 0</span><span class="cls_061"><sup>31</sup></span><span class="cls_053"> || 1</span></div>
<div style="position:absolute;left:162.02px;top:378.07px" class="cls_053"><span class="cls_053">else</span></div>
<div style="position:absolute;left:216.02px;top:387.07px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> 0</span><span class="cls_061"><sup>32</sup></span></div>
<div style="position:absolute;left:162.03px;top:400.08px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:72.00px;top:490.95px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:509.28px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-60</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:218144px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:105.69px;top:62.05px" class="cls_063"><span class="cls_063">SLTI</span><span class="cls_064">    Set On Less Than Immediate</span></div>
<div style="position:absolute;left:450.39px;top:61.69px" class="cls_063"><span class="cls_063">SLTI</span></div>
<div style="position:absolute;left:118.01px;top:103.61px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:173.31px;top:103.61px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.53px;top:103.61px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.79px;top:103.61px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:490.84px;top:103.61px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:145.97px;top:127.66px" class="cls_053"><span class="cls_053">SLTI</span></div>
<div style="position:absolute;left:215.15px;top:127.66px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:273.72px;top:127.66px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:378.71px;top:126.22px" class="cls_053"><span class="cls_053">immediate</span></div>
<div style="position:absolute;left:132.55px;top:137.24px" class="cls_053"><span class="cls_053">0 0 1 0 1 0</span></div>
<div style="position:absolute;left:153.29px;top:151.64px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:218.38px;top:151.64px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.56px;top:151.64px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:390.53px;top:151.64px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:174.72px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:196.05px" class="cls_055"><span class="cls_055">SLTI rt, rs, immediate</span></div>
<div style="position:absolute;left:72.00px;top:216.72px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:235.05px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">immediate </span><span class="cls_055">is sign-extended and subtracted from the contents of general register </span><span class="cls_058">rs.</span></div>
<div style="position:absolute;left:108.01px;top:248.05px" class="cls_055"><span class="cls_055">Considering both quantities as signed integers, if </span><span class="cls_058">rs </span><span class="cls_055">is less than the sign-extended immediate, the</span></div>
<div style="position:absolute;left:108.01px;top:261.05px" class="cls_055"><span class="cls_055">result is set to one; otherwise the result is set to zero.</span></div>
<div style="position:absolute;left:108.01px;top:280.05px" class="cls_055"><span class="cls_055">The result is placed into general register </span><span class="cls_058">rt.</span></div>
<div style="position:absolute;left:108.01px;top:299.05px" class="cls_055"><span class="cls_055">No integer overflow exception occurs under any circumstances.  The comparison is valid even if</span></div>
<div style="position:absolute;left:108.01px;top:312.05px" class="cls_055"><span class="cls_055">the subtraction used during the comparison overflows.</span></div>
<div style="position:absolute;left:72.00px;top:332.72px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:136.66px;top:352.16px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:161.86px;top:350.16px" class="cls_053"><span class="cls_053">if GPR[rs] &lt; (immediate</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16 </sup></span><span class="cls_053">|| immediate</span><span class="cls_061"><sub>15...0</sub></span><span class="cls_053"> then</span></div>
<div style="position:absolute;left:179.86px;top:366.16px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> 0</span><span class="cls_061"><sup>31</sup></span><span class="cls_053"> || 1</span></div>
<div style="position:absolute;left:161.86px;top:384.16px" class="cls_053"><span class="cls_053">else</span></div>
<div style="position:absolute;left:179.86px;top:398.16px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> 0</span><span class="cls_061"><sup>32</sup></span></div>
<div style="position:absolute;left:161.86px;top:416.16px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:72.00px;top:524.28px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:542.61px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-61</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:218946px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:246.88px;top:61.88px" class="cls_064"><span class="cls_064">Set On Less Than</span></div>
<div style="position:absolute;left:105.85px;top:61.76px" class="cls_063"><span class="cls_063">SLTIU</span></div>
<div style="position:absolute;left:428.65px;top:60.39px" class="cls_063"><span class="cls_063">SLTIU</span></div>
<div style="position:absolute;left:237.56px;top:77.07px" class="cls_064"><span class="cls_064">Immediate Unsigned</span></div>
<div style="position:absolute;left:117.00px;top:104.40px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.30px;top:104.40px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.52px;top:104.40px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.78px;top:104.40px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:489.83px;top:104.40px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:141.35px;top:128.45px" class="cls_053"><span class="cls_053">SLTIU</span></div>
<div style="position:absolute;left:214.14px;top:128.45px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:272.71px;top:128.45px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:377.69px;top:127.01px" class="cls_053"><span class="cls_053">immediate</span></div>
<div style="position:absolute;left:131.53px;top:138.03px" class="cls_053"><span class="cls_053">0 0 1 0 1 1</span></div>
<div style="position:absolute;left:152.27px;top:152.43px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.36px;top:152.43px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.54px;top:152.43px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:389.51px;top:152.43px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:174.15px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.48px" class="cls_055"><span class="cls_055">SLTIU rt, rs, immediate</span></div>
<div style="position:absolute;left:72.00px;top:216.15px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.48px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">immediate </span><span class="cls_055">is sign-extended and subtracted from the contents of general register </span><span class="cls_058">rs.</span></div>
<div style="position:absolute;left:108.01px;top:247.48px" class="cls_055"><span class="cls_055">Considering both quantities as unsigned integers, if </span><span class="cls_058">rs</span><span class="cls_055"> is less than the sign-extended immediate, the</span></div>
<div style="position:absolute;left:108.01px;top:260.48px" class="cls_055"><span class="cls_055">result is set to one; otherwise the result is set to zero.</span></div>
<div style="position:absolute;left:108.01px;top:279.48px" class="cls_055"><span class="cls_055">The result is placed into general register </span><span class="cls_058">rt</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.01px;top:298.48px" class="cls_055"><span class="cls_055">No integer overflow exception occurs under any circumstances.  The comparison is valid even if</span></div>
<div style="position:absolute;left:108.01px;top:311.48px" class="cls_055"><span class="cls_055">the subtraction used during the comparison overflows.</span></div>
<div style="position:absolute;left:72.00px;top:332.14px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:137.09px;top:355.19px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:162.29px;top:353.19px" class="cls_053"><span class="cls_053">if (0 || GPR[rs]) &lt; (immediate</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16 </sup></span><span class="cls_053">|| immediate</span><span class="cls_061"><sub>15...0</sub></span><span class="cls_053"> then</span></div>
<div style="position:absolute;left:180.29px;top:369.19px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> 0</span><span class="cls_061"><sup>31</sup></span><span class="cls_053"> || 1</span></div>
<div style="position:absolute;left:162.29px;top:387.19px" class="cls_053"><span class="cls_053">else</span></div>
<div style="position:absolute;left:180.29px;top:401.19px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> 0</span><span class="cls_061"><sup>32</sup></span></div>
<div style="position:absolute;left:162.29px;top:419.19px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:162.29px;top:440.23px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:72.00px;top:527.53px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:545.86px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-62</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:219748px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:105.15px;top:60.54px" class="cls_063"><span class="cls_063">SLTU</span><span class="cls_064">    Set On Less Than Unsigned</span></div>
<div style="position:absolute;left:440.69px;top:60.25px" class="cls_063"><span class="cls_063">SLTU</span></div>
<div style="position:absolute;left:118.30px;top:103.39px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:173.53px;top:103.39px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.75px;top:103.39px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:296.01px;top:103.39px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:356.11px;top:103.40px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:415.46px;top:103.40px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:431.52px;top:103.40px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:490.99px;top:103.40px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:135.70px;top:127.37px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:215.44px;top:127.37px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:273.94px;top:127.37px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:335.18px;top:127.37px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:396.32px;top:127.37px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:451.19px;top:127.37px" class="cls_053"><span class="cls_053">SLTU</span></div>
<div style="position:absolute;left:129.81px;top:137.02px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:378.79px;top:137.02px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:437.06px;top:137.02px" class="cls_053"><span class="cls_053">1 0 1 0 1 1</span></div>
<div style="position:absolute;left:153.51px;top:151.42px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:218.60px;top:151.42px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.86px;top:151.42px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:334.22px;top:151.42px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:393.69px;top:151.42px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:458.56px;top:151.42px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:172.85px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:194.18px" class="cls_055"><span class="cls_055">SLTU rd, rs, rt</span></div>
<div style="position:absolute;left:72.00px;top:214.85px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:233.18px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rt </span><span class="cls_055">are subtracted from the contents of general register </span><span class="cls_058">rs.</span></div>
<div style="position:absolute;left:108.01px;top:246.18px" class="cls_055"><span class="cls_055">Considering both quantities as unsigned integers, if the contents of general register </span><span class="cls_058">rs </span><span class="cls_055">are less than</span></div>
<div style="position:absolute;left:108.01px;top:259.18px" class="cls_055"><span class="cls_055">the contents of general register </span><span class="cls_058">rt</span><span class="cls_055">, the result is set to one; otherwise the result is set to zero.</span></div>
<div style="position:absolute;left:108.01px;top:278.18px" class="cls_055"><span class="cls_055">The result is placed into general register </span><span class="cls_058">rd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.01px;top:297.18px" class="cls_055"><span class="cls_055">No integer overflow exception occurs under any circumstances.  The comparison is valid even if</span></div>
<div style="position:absolute;left:108.01px;top:310.18px" class="cls_055"><span class="cls_055">the subtraction used during the comparison overflows.</span></div>
<div style="position:absolute;left:72.00px;top:330.85px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:137.04px;top:354.40px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:162.24px;top:354.40px" class="cls_053"><span class="cls_053">if (0 || GPR[rs]) &lt; 0 || GPR[rt] then</span></div>
<div style="position:absolute;left:216.24px;top:365.40px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> 0</span><span class="cls_061"><sup>31</sup></span><span class="cls_053"> || 1</span></div>
<div style="position:absolute;left:162.24px;top:380.40px" class="cls_053"><span class="cls_053">else</span></div>
<div style="position:absolute;left:216.24px;top:391.40px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> 0</span><span class="cls_061"><sup>32</sup></span></div>
<div style="position:absolute;left:162.24px;top:406.40px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:72.00px;top:505.75px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:524.09px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-63</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:220550px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:214.25px;top:69.38px" class="cls_064"><span class="cls_064">Shift Word Right Arithmetic</span></div>
<div style="position:absolute;left:108.94px;top:60.90px" class="cls_063"><span class="cls_063">SRA</span></div>
<div style="position:absolute;left:449.28px;top:60.40px" class="cls_063"><span class="cls_063">SRA</span></div>
<div style="position:absolute;left:117.65px;top:104.58px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.88px;top:104.58px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.10px;top:104.58px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.36px;top:104.58px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:355.46px;top:104.58px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:414.81px;top:104.58px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:430.87px;top:104.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:490.34px;top:104.58px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:135.05px;top:128.56px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:216.18px;top:128.56px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:273.29px;top:128.56px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:334.53px;top:128.55px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:393.17px;top:128.55px" class="cls_053"><span class="cls_053">sa</span></div>
<div style="position:absolute;left:453.05px;top:128.55px" class="cls_053"><span class="cls_053">SRA</span></div>
<div style="position:absolute;left:129.16px;top:138.20px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:200.59px;top:138.20px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:436.41px;top:138.20px" class="cls_053"><span class="cls_053">0 0 0 0 1 1</span></div>
<div style="position:absolute;left:152.86px;top:152.61px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.95px;top:152.61px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.21px;top:152.61px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:333.57px;top:152.60px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:393.04px;top:152.60px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:457.92px;top:152.60px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:174.03px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.37px" class="cls_055"><span class="cls_055">SRA rd, rt, sa</span></div>
<div style="position:absolute;left:72.00px;top:216.03px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.37px" class="cls_055"><span class="cls_055">The contents of the low-order word of general register </span><span class="cls_058">rt </span><span class="cls_055">are shifted right by </span><span class="cls_058">sa </span><span class="cls_055">bits, sign-extending</span></div>
<div style="position:absolute;left:107.99px;top:247.37px" class="cls_055"><span class="cls_055">the high-order bits.</span></div>
<div style="position:absolute;left:107.99px;top:266.37px" class="cls_055"><span class="cls_055">The result is placed in register </span><span class="cls_058">rd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:72.00px;top:287.03px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:136.73px;top:312.70px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:161.93px;top:310.70px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> (GPR[rt]</span><span class="cls_061"><sub>31</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>sa</sup></span><span class="cls_053"> || GPR[rt] </span><span class="cls_061"><sub>31...sa</sub></span></div>
<div style="position:absolute;left:74.50px;top:397.57px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:415.90px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-64</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:221352px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:250.80px;top:64.16px" class="cls_064"><span class="cls_064">Shift Word Right</span></div>
<div style="position:absolute;left:107.69px;top:61.19px" class="cls_063"><span class="cls_063">SRAV</span></div>
<div style="position:absolute;left:431.55px;top:60.90px" class="cls_063"><span class="cls_063">SRAV</span></div>
<div style="position:absolute;left:242.22px;top:77.33px" class="cls_064"><span class="cls_064">Arithmetic Variable</span></div>
<div style="position:absolute;left:116.64px;top:105.57px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:105.57px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:105.57px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:105.57px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:354.45px;top:105.57px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:413.80px;top:105.57px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:429.86px;top:105.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:489.33px;top:105.57px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:134.04px;top:129.55px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:213.78px;top:129.55px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:272.28px;top:129.55px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:333.52px;top:129.54px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:394.67px;top:129.54px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:448.71px;top:129.54px" class="cls_053"><span class="cls_053">SRAV</span></div>
<div style="position:absolute;left:128.15px;top:139.19px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:377.14px;top:139.19px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:435.41px;top:139.19px" class="cls_053"><span class="cls_053">0 0 0 1 1 1</span></div>
<div style="position:absolute;left:151.85px;top:153.60px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.94px;top:153.60px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.20px;top:153.60px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:332.57px;top:153.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:392.04px;top:153.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:456.91px;top:153.59px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:176.03px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:197.37px" class="cls_055"><span class="cls_055">SRAV  rd, rt, rs</span></div>
<div style="position:absolute;left:72.00px;top:218.03px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:236.37px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rt </span><span class="cls_055">are shifted right by the number of bits specified by the low-order</span></div>
<div style="position:absolute;left:108.00px;top:249.37px" class="cls_055"><span class="cls_055">five bits of general register </span><span class="cls_058">rs</span><span class="cls_055">, sign-extending the high-order bits.</span></div>
<div style="position:absolute;left:108.01px;top:268.37px" class="cls_055"><span class="cls_055">The result is placed in register </span><span class="cls_058">rd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:72.00px;top:289.03px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:136.76px;top:308.30px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:161.96px;top:308.30px" class="cls_053"><span class="cls_053">s </span><span class="cls_003">←</span><span class="cls_053"> GPR[rs]</span><span class="cls_061"><sub>4...0</sub></span></div>
<div style="position:absolute;left:161.96px;top:322.30px" class="cls_053"><span class="cls_053">GPR[rd]</span><span class="cls_061"><sub> </sub></span><span class="cls_003">←</span><span class="cls_053"> (GPR[rt]</span><span class="cls_061"><sub>31</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>s</sup></span><span class="cls_053"> || GPR[rt]</span><span class="cls_061"><sub>31...s</sub></span></div>
<div style="position:absolute;left:72.00px;top:406.68px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:425.01px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-65</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:222154px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:224.36px;top:67.38px" class="cls_064"><span class="cls_064">Shift Word Right Logical</span></div>
<div style="position:absolute;left:108.14px;top:60.90px" class="cls_063"><span class="cls_063">SRL</span></div>
<div style="position:absolute;left:450.94px;top:61.19px" class="cls_063"><span class="cls_063">SRL</span></div>
<div style="position:absolute;left:116.64px;top:103.56px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:103.56px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:103.56px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:103.56px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:354.45px;top:103.57px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:413.80px;top:103.57px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:429.86px;top:103.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:489.33px;top:103.57px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:134.04px;top:127.54px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:215.22px;top:126.43px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:272.28px;top:127.54px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:333.52px;top:127.54px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:392.17px;top:127.54px" class="cls_053"><span class="cls_053">sa</span></div>
<div style="position:absolute;left:452.60px;top:127.54px" class="cls_053"><span class="cls_053">SRL</span></div>
<div style="position:absolute;left:128.15px;top:137.19px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:197.68px;top:136.08px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:435.40px;top:137.19px" class="cls_053"><span class="cls_053">0 0 0 0 1 0</span></div>
<div style="position:absolute;left:151.85px;top:151.59px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.94px;top:151.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.20px;top:151.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:332.57px;top:151.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:392.04px;top:151.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:456.91px;top:151.59px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:175.03px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:196.37px" class="cls_055"><span class="cls_055">SRL rd, rt, sa</span></div>
<div style="position:absolute;left:72.00px;top:217.03px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:235.37px" class="cls_055"><span class="cls_055">The low-order word of general register </span><span class="cls_058">rt </span><span class="cls_055">is shifted right by </span><span class="cls_058">sa </span><span class="cls_055">bits, inserting zeros into the high-</span></div>
<div style="position:absolute;left:108.00px;top:248.37px" class="cls_055"><span class="cls_055">order bits.</span></div>
<div style="position:absolute;left:108.00px;top:267.37px" class="cls_055"><span class="cls_055">The result is placed in register </span><span class="cls_058">rd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:286.37px" class="cls_055"><span class="cls_055">Operation:</span></div>
<div style="position:absolute;left:137.15px;top:310.20px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:162.34px;top:308.20px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> 0 </span><span class="cls_061"><sup>sa</sup></span><span class="cls_053"> || GPR[rt]</span><span class="cls_061"><sub>31...sa</sub></span></div>
<div style="position:absolute;left:72.00px;top:396.23px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:414.57px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-66</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:222956px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:108.14px;top:61.19px" class="cls_063"><span class="cls_063">SRLV</span><span class="cls_064">  Shift Word Right Logical Variable</span></div>
<div style="position:absolute;left:434.44px;top:60.90px" class="cls_063"><span class="cls_063">SRLV</span></div>
<div style="position:absolute;left:116.64px;top:105.56px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:105.56px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:105.56px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:105.56px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:354.45px;top:105.57px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:413.80px;top:105.57px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:429.86px;top:105.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:489.33px;top:105.57px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:134.04px;top:129.54px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:213.78px;top:129.54px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:272.28px;top:129.54px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:333.52px;top:129.54px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:394.67px;top:129.54px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:449.26px;top:129.54px" class="cls_053"><span class="cls_053">SRLV</span></div>
<div style="position:absolute;left:128.15px;top:139.19px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:377.14px;top:139.19px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:435.41px;top:139.19px" class="cls_053"><span class="cls_053">0 0 0 1 1 0</span></div>
<div style="position:absolute;left:151.85px;top:153.59px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.94px;top:153.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.20px;top:153.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:332.57px;top:153.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:392.04px;top:153.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:456.91px;top:153.59px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:176.03px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:197.37px" class="cls_055"><span class="cls_055">SRLV rd, rt, rs</span></div>
<div style="position:absolute;left:72.00px;top:218.03px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:236.37px" class="cls_055"><span class="cls_055">The low-order word of general register </span><span class="cls_058">rt </span><span class="cls_055">are shifted right by the number of bits specified by the</span></div>
<div style="position:absolute;left:108.00px;top:249.37px" class="cls_055"><span class="cls_055">low-order five bits of general register </span><span class="cls_058">rs, </span><span class="cls_055">inserting zeros into the high-order bits.</span></div>
<div style="position:absolute;left:108.00px;top:268.37px" class="cls_055"><span class="cls_055">The result is placed in register </span><span class="cls_058">rd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:72.00px;top:289.03px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:137.55px;top:306.78px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:162.75px;top:306.78px" class="cls_053"><span class="cls_053">s </span><span class="cls_003">←</span><span class="cls_053"> GPR[rs]</span><span class="cls_061"><sub>4...0</sub></span></div>
<div style="position:absolute;left:162.75px;top:320.78px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053">  0</span><span class="cls_061"><sup>s  </sup></span><span class="cls_053">|| GPR[rt]</span><span class="cls_061"><sub>31...s</sub></span></div>
<div style="position:absolute;left:72.00px;top:404.86px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:423.20px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-67</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:223758px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:257.62px;top:69.38px" class="cls_064"><span class="cls_064">Subtract Word</span></div>
<div style="position:absolute;left:105.62px;top:60.90px" class="cls_063"><span class="cls_063">SUB</span></div>
<div style="position:absolute;left:451.11px;top:60.40px" class="cls_063"><span class="cls_063">SUB</span></div>
<div style="position:absolute;left:116.64px;top:103.56px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:103.56px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:103.56px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:103.56px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:354.45px;top:103.57px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:413.80px;top:103.57px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:429.86px;top:103.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:489.33px;top:103.57px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:134.04px;top:127.54px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:213.78px;top:127.54px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:272.28px;top:127.54px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:333.52px;top:127.54px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:394.67px;top:127.54px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:452.04px;top:127.54px" class="cls_053"><span class="cls_053">SUB</span></div>
<div style="position:absolute;left:128.15px;top:137.19px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:377.14px;top:137.19px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:435.41px;top:137.19px" class="cls_053"><span class="cls_053">1 0 0 0 1 0</span></div>
<div style="position:absolute;left:151.85px;top:151.59px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.94px;top:151.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.20px;top:151.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:332.57px;top:151.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:392.04px;top:151.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:456.91px;top:151.59px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:175.03px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:196.37px" class="cls_055"><span class="cls_055">SUB rd, rs, rt</span></div>
<div style="position:absolute;left:72.00px;top:217.03px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:235.37px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rt </span><span class="cls_055">are subtracted from the contents of general register </span><span class="cls_058">rs </span><span class="cls_055">to form a</span></div>
<div style="position:absolute;left:108.01px;top:248.37px" class="cls_055"><span class="cls_055">result.  The result is placed into general register </span><span class="cls_058">rd.</span></div>
<div style="position:absolute;left:108.01px;top:267.37px" class="cls_055"><span class="cls_055">The only difference between this instruction and the SUBU instruction is that SUBU never traps on</span></div>
<div style="position:absolute;left:108.01px;top:280.37px" class="cls_055"><span class="cls_055">overflow.</span></div>
<div style="position:absolute;left:108.01px;top:299.37px" class="cls_055"><span class="cls_055">An integer overflow exception takes place if the carries out of bits 30 and 31 differ (2’s complement</span></div>
<div style="position:absolute;left:108.01px;top:312.37px" class="cls_055"><span class="cls_055">overflow).  The destination register </span><span class="cls_058">rd</span><span class="cls_055"> is not modified when an integer overflow exception occurs.</span></div>
<div style="position:absolute;left:72.00px;top:333.03px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:137.12px;top:354.84px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:162.31px;top:354.84px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> GPR[rs] - GPR[rt]</span></div>
<div style="position:absolute;left:72.00px;top:423.88px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:442.21px" class="cls_055"><span class="cls_055">Integer overflow exception</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-68</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:224560px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:103.82px;top:71.19px" class="cls_063"><span class="cls_063">SUBU</span><span class="cls_064">    Subtract Unsigned Word</span></div>
<div style="position:absolute;left:437.65px;top:70.83px" class="cls_063"><span class="cls_063">SUBU</span></div>
<div style="position:absolute;left:116.64px;top:135.58px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:135.58px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:135.58px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:135.58px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:354.45px;top:135.58px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:413.80px;top:135.58px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:429.86px;top:135.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:489.33px;top:135.58px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:134.04px;top:159.56px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:213.78px;top:159.56px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:272.28px;top:159.56px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:333.52px;top:159.55px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:394.67px;top:159.55px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:448.43px;top:159.55px" class="cls_053"><span class="cls_053">SUBU</span></div>
<div style="position:absolute;left:132.98px;top:169.20px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:377.14px;top:169.20px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:440.23px;top:169.20px" class="cls_053"><span class="cls_053">1 0 0 0 1 1</span></div>
<div style="position:absolute;left:151.85px;top:183.61px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.94px;top:183.61px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.20px;top:183.61px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:332.57px;top:183.60px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:392.04px;top:183.60px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:456.91px;top:183.60px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:203.03px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:224.37px" class="cls_055"><span class="cls_055">SUBU rd, rs, rt</span></div>
<div style="position:absolute;left:72.00px;top:245.03px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:263.37px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rt </span><span class="cls_055">are subtracted from the contents of general register </span><span class="cls_058">rs </span><span class="cls_055">to form a</span></div>
<div style="position:absolute;left:108.01px;top:276.37px" class="cls_055"><span class="cls_055">result.</span></div>
<div style="position:absolute;left:108.01px;top:295.37px" class="cls_055"><span class="cls_055">The result is placed into general register </span><span class="cls_058">rd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.01px;top:314.37px" class="cls_055"><span class="cls_055">The only difference between this instruction and the SUB instruction is that SUBU never traps on</span></div>
<div style="position:absolute;left:108.01px;top:327.37px" class="cls_055"><span class="cls_055">overflow.  No integer overflow exception occurs under any circumstances.</span></div>
<div style="position:absolute;left:72.00px;top:348.03px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:137.12px;top:368.01px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:162.31px;top:368.01px" class="cls_053"><span class="cls_053">GPR[rd] </span><span class="cls_003">←</span><span class="cls_053"> GPR[rs] - GPR[rt]</span></div>
<div style="position:absolute;left:72.00px;top:436.22px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:454.55px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-69</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:225362px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:267.89px;top:67.58px" class="cls_064"><span class="cls_064">Store Word</span></div>
<div style="position:absolute;left:106.08px;top:60.69px" class="cls_063"><span class="cls_063">SW</span></div>
<div style="position:absolute;left:465.57px;top:61.05px" class="cls_063"><span class="cls_063">SW</span></div>
<div style="position:absolute;left:117.00px;top:104.59px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.30px;top:104.59px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.52px;top:104.59px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.78px;top:104.59px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:489.83px;top:104.59px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:147.47px;top:128.64px" class="cls_053"><span class="cls_053">SW</span></div>
<div style="position:absolute;left:207.47px;top:128.64px" class="cls_053"><span class="cls_053">base</span></div>
<div style="position:absolute;left:272.71px;top:128.64px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:388.53px;top:127.20px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:131.55px;top:138.22px" class="cls_053"><span class="cls_053">1 0 1 0 1 1</span></div>
<div style="position:absolute;left:152.29px;top:152.62px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.38px;top:152.62px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.56px;top:152.62px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:389.53px;top:152.62px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:175.35px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:196.69px" class="cls_055"><span class="cls_055">SW rt, offset(base)</span></div>
<div style="position:absolute;left:72.00px;top:217.35px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:235.69px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">offset </span><span class="cls_055">is sign-extended and added to the contents of general register </span><span class="cls_058">base </span><span class="cls_055">to form a virtual</span></div>
<div style="position:absolute;left:108.00px;top:248.69px" class="cls_055"><span class="cls_055">address.  The contents of general register </span><span class="cls_058">rt </span><span class="cls_055">are stored at the memory location specified by the</span></div>
<div style="position:absolute;left:108.00px;top:261.69px" class="cls_055"><span class="cls_055">effective address.</span></div>
<div style="position:absolute;left:108.00px;top:280.69px" class="cls_055"><span class="cls_055">If either of the two least-significant bits of the effective address are non-zero, an address error</span></div>
<div style="position:absolute;left:108.00px;top:293.69px" class="cls_055"><span class="cls_055">exception occurs.</span></div>
<div style="position:absolute;left:72.00px;top:314.35px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:162.14px;top:336.76px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:189.50px;top:334.76px" class="cls_053"><span class="cls_053">vAddr </span><span class="cls_003">←</span><span class="cls_053">  ((offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16</sup></span><span class="cls_053"> || offset</span><span class="cls_061"><sub>15...0</sub></span><span class="cls_053">) +</span></div>
<div style="position:absolute;left:162.14px;top:352.10px" class="cls_053"><span class="cls_053">(pAddr, uncached)</span><span class="cls_003"> ←</span><span class="cls_053"> AddressTranslation (vAddr, DATA)</span></div>
<div style="position:absolute;left:180.14px;top:366.21px" class="cls_053"><span class="cls_053">data </span><span class="cls_003">← </span><span class="cls_053">GPR[rt]</span></div>
<div style="position:absolute;left:180.14px;top:379.21px" class="cls_053"><span class="cls_053">StoreMemory (uncached, WORD, data, pAddr, vAddr, DATA)</span></div>
<div style="position:absolute;left:72.00px;top:484.25px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:502.58px" class="cls_055"><span class="cls_055">TLB refill exception</span></div>
<div style="position:absolute;left:108.00px;top:515.58px" class="cls_055"><span class="cls_055">TLB invalid exception</span></div>
<div style="position:absolute;left:108.00px;top:528.58px" class="cls_055"><span class="cls_055">TLB modification exception</span></div>
<div style="position:absolute;left:108.00px;top:541.58px" class="cls_055"><span class="cls_055">Bus error exception</span></div>
<div style="position:absolute;left:108.00px;top:554.58px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-70</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:226164px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:105.02px;top:61.26px" class="cls_063"><span class="cls_063">SWCz</span><span class="cls_064">  Store Word From Coprocessor</span></div>
<div style="position:absolute;left:435.56px;top:61.76px" class="cls_063"><span class="cls_063">SWCz</span></div>
<div style="position:absolute;left:116.50px;top:102.96px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.73px;top:102.96px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:234.95px;top:102.96px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.21px;top:102.96px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:489.33px;top:102.96px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:140.86px;top:123.41px" class="cls_053"><span class="cls_053">SWCz</span></div>
<div style="position:absolute;left:206.97px;top:125.21px" class="cls_053"><span class="cls_053">base</span></div>
<div style="position:absolute;left:272.21px;top:125.21px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:387.96px;top:123.91px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:129.65px;top:134.06px" class="cls_053"><span class="cls_053">1 1 1 0 x x*</span></div>
<div style="position:absolute;left:151.71px;top:147.38px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.80px;top:147.38px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.06px;top:147.38px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:388.96px;top:147.38px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:167.61px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:188.95px" class="cls_055"><span class="cls_055">SWCz rt, offset(base)</span></div>
<div style="position:absolute;left:72.00px;top:203.61px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:221.95px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">offset </span><span class="cls_055">is sign-extended and added to the contents of general register </span><span class="cls_058">base </span><span class="cls_055">to form a virtual</span></div>
<div style="position:absolute;left:108.00px;top:234.95px" class="cls_055"><span class="cls_055">address.  Coprocessor unit </span><span class="cls_058">z</span><span class="cls_055"> sources a word, which the processor writes to the addressed memory</span></div>
<div style="position:absolute;left:108.00px;top:247.95px" class="cls_055"><span class="cls_055">location.</span></div>
<div style="position:absolute;left:108.00px;top:266.95px" class="cls_055"><span class="cls_055">The data to be stored is defined by individual coprocessor specifications.</span></div>
<div style="position:absolute;left:108.00px;top:285.95px" class="cls_055"><span class="cls_055">This instruction is not valid for use with CP0.</span></div>
<div style="position:absolute;left:108.00px;top:304.95px" class="cls_055"><span class="cls_055">If either of the two least-significant bits of the effective address is non-zero, an address error</span></div>
<div style="position:absolute;left:108.00px;top:317.95px" class="cls_055"><span class="cls_055">exception occurs.</span></div>
<div style="position:absolute;left:108.00px;top:336.95px" class="cls_055"><span class="cls_055">Execution of the instruction referencing coprocessor 3 causes a reserved instruction exception, not</span></div>
<div style="position:absolute;left:108.00px;top:349.95px" class="cls_055"><span class="cls_055">a coprocessor unusable exception.</span></div>
<div style="position:absolute;left:72.00px;top:364.61px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:144.18px;top:382.58px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:180.18px;top:380.58px" class="cls_053"><span class="cls_053">vAddr </span><span class="cls_003">← </span><span class="cls_053">((offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16 ||</sup></span><span class="cls_053"> offset</span><span class="cls_061"><sub>15...0</sub></span><span class="cls_053">) + GPR[base]</span></div>
<div style="position:absolute;left:180.19px;top:395.58px" class="cls_053"><span class="cls_053">(pAddr, uncached)</span><span class="cls_061"><sub> </sub></span><span class="cls_003">←</span><span class="cls_053"> AddressTranslation (vAddr, DATA)</span></div>
<div style="position:absolute;left:180.18px;top:408.58px" class="cls_053"><span class="cls_053">byte  </span><span class="cls_003">←  </span><span class="cls_053">vAddr</span><span class="cls_061"><sub>1...0</sub></span></div>
<div style="position:absolute;left:180.18px;top:421.58px" class="cls_053"><span class="cls_053">data </span><span class="cls_003">← </span><span class="cls_053">COPzSW (byte, rt)</span></div>
<div style="position:absolute;left:180.18px;top:434.58px" class="cls_053"><span class="cls_053">StoreMemory (uncached, WORD, data, pAddr, vAddr, DATA)</span></div>
<div style="position:absolute;left:72.00px;top:464.33px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:478.67px" class="cls_055"><span class="cls_055">TLB refill exception</span></div>
<div style="position:absolute;left:108.00px;top:488.67px" class="cls_055"><span class="cls_055">TLB invalid exception</span></div>
<div style="position:absolute;left:108.00px;top:498.67px" class="cls_055"><span class="cls_055">TLB modification exception</span></div>
<div style="position:absolute;left:108.00px;top:508.67px" class="cls_055"><span class="cls_055">Bus error exception</span></div>
<div style="position:absolute;left:108.00px;top:518.67px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:108.00px;top:528.67px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:72.00px;top:548.67px" class="cls_060"><span class="cls_060">Opcode Bit Encoding:</span></div>
<div style="position:absolute;left:173.89px;top:575.98px" class="cls_053"><span class="cls_053">Bit #31</span></div>
<div style="position:absolute;left:217.08px;top:574.68px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:241.27px;top:574.68px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:264.18px;top:574.68px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:289.81px;top:574.68px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:316.74px;top:574.68px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:485.79px;top:575.04px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:113.96px;top:569.99px" class="cls_069"><span class="cls_069">SWCz</span></div>
<div style="position:absolute;left:195.44px;top:590.88px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:217.62px;top:590.88px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:242.53px;top:590.88px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:265.50px;top:590.88px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:290.34px;top:590.88px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:317.27px;top:590.88px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:154.22px;top:595.20px" class="cls_053"><span class="cls_053">SWC1</span></div>
<div style="position:absolute;left:173.09px;top:613.35px" class="cls_053"><span class="cls_053">Bit #31</span></div>
<div style="position:absolute;left:216.22px;top:611.98px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:240.49px;top:611.98px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:263.39px;top:611.98px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:288.96px;top:611.98px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:315.89px;top:611.98px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:484.92px;top:612.41px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:194.64px;top:628.25px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:216.82px;top:628.25px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:241.74px;top:628.25px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:264.64px;top:628.25px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:289.55px;top:628.25px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:316.48px;top:628.25px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:153.35px;top:632.57px" class="cls_053"><span class="cls_053">SWC2</span></div>
<div style="position:absolute;left:173.09px;top:654.60px" class="cls_053"><span class="cls_053">Bit #31</span></div>
<div style="position:absolute;left:216.22px;top:653.30px" class="cls_053"><span class="cls_053">30</span></div>
<div style="position:absolute;left:240.49px;top:653.30px" class="cls_053"><span class="cls_053">29</span></div>
<div style="position:absolute;left:263.39px;top:653.30px" class="cls_053"><span class="cls_053">28</span></div>
<div style="position:absolute;left:288.96px;top:653.30px" class="cls_053"><span class="cls_053">27</span></div>
<div style="position:absolute;left:315.89px;top:653.30px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:484.92px;top:653.66px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:194.64px;top:669.50px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:216.82px;top:669.50px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:241.74px;top:669.50px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:264.64px;top:669.50px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:289.55px;top:669.50px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:316.48px;top:669.50px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:153.35px;top:673.82px" class="cls_053"><span class="cls_053">SWC3</span></div>
<div style="position:absolute;left:211.57px;top:702.69px" class="cls_053"><span class="cls_053">SW opcode    Coprocessor Unit Number</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-71</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:226966px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:253.51px;top:65.70px" class="cls_064"><span class="cls_064">Store Word Left</span></div>
<div style="position:absolute;left:105.24px;top:60.83px" class="cls_063"><span class="cls_063">SWL</span></div>
<div style="position:absolute;left:450.75px;top:60.47px" class="cls_063"><span class="cls_063">SWL</span></div>
<div style="position:absolute;left:116.57px;top:95.34px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:95.34px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:95.34px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:95.34px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:489.40px;top:95.34px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:144.26px;top:119.39px" class="cls_053"><span class="cls_053">SWL</span></div>
<div style="position:absolute;left:207.04px;top:119.39px" class="cls_053"><span class="cls_053">base</span></div>
<div style="position:absolute;left:272.28px;top:119.39px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:388.10px;top:117.95px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:131.12px;top:128.97px" class="cls_053"><span class="cls_053">1 0 1 0 1 0</span></div>
<div style="position:absolute;left:151.86px;top:143.37px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.95px;top:143.37px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.13px;top:143.37px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:389.10px;top:143.37px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:163.33px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:184.67px" class="cls_055"><span class="cls_055">SWL rt, offset(base)</span></div>
<div style="position:absolute;left:72.00px;top:199.33px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:217.67px" class="cls_055"><span class="cls_055">This instruction can be used with the SWR instruction to store the contents of a register into four</span></div>
<div style="position:absolute;left:108.00px;top:230.67px" class="cls_055"><span class="cls_055">consecutive bytes of memory, when the bytes cross a word boundary.  SWL stores the left portion</span></div>
<div style="position:absolute;left:108.00px;top:243.67px" class="cls_055"><span class="cls_055">of the register into the appropriate part of the high-order word of memory; SWR stores the right</span></div>
<div style="position:absolute;left:108.00px;top:256.67px" class="cls_055"><span class="cls_055">portion of the register into the appropriate part of the low-order word.</span></div>
<div style="position:absolute;left:108.00px;top:275.67px" class="cls_055"><span class="cls_055">The SWL instruction adds its sign-extended 16-bit </span><span class="cls_058">offset </span><span class="cls_055">to the contents of general register </span><span class="cls_058">base </span><span class="cls_055">to</span></div>
<div style="position:absolute;left:108.00px;top:288.67px" class="cls_055"><span class="cls_055">form a virtual address which may specify an arbitrary byte.  It alters only the word in memory</span></div>
<div style="position:absolute;left:108.00px;top:301.67px" class="cls_055"><span class="cls_055">which contains that byte. From one to four bytes will be stored, depending on the starting byte</span></div>
<div style="position:absolute;left:108.00px;top:314.67px" class="cls_055"><span class="cls_055">specified.</span></div>
<div style="position:absolute;left:108.00px;top:333.67px" class="cls_055"><span class="cls_055">Conceptually, it starts at the most-significant byte of the register and copies it to the specified byte</span></div>
<div style="position:absolute;left:108.00px;top:346.67px" class="cls_055"><span class="cls_055">in memory; then it copies bytes from register to memory until it reaches the low-order byte of the</span></div>
<div style="position:absolute;left:108.00px;top:359.67px" class="cls_055"><span class="cls_055">word in memory.</span></div>
<div style="position:absolute;left:108.00px;top:378.67px" class="cls_055"><span class="cls_055">No address exceptions due to alignment are possible.</span></div>
<div style="position:absolute;left:200.73px;top:407.40px" class="cls_053"><span class="cls_053">memory</span></div>
<div style="position:absolute;left:191.74px;top:416.98px" class="cls_053"><span class="cls_053">(big-endian)</span></div>
<div style="position:absolute;left:384.84px;top:421.80px" class="cls_053"><span class="cls_053">register</span></div>
<div style="position:absolute;left:119.74px;top:432.60px" class="cls_053"><span class="cls_053">address 4</span></div>
<div style="position:absolute;left:185.26px;top:432.60px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:213.34px;top:432.60px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:241.42px;top:432.60px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:269.43px;top:432.60px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:289.03px;top:440.95px" class="cls_053"><span class="cls_053">before</span></div>
<div style="position:absolute;left:366.12px;top:439.80px" class="cls_053"><span class="cls_053">A</span></div>
<div style="position:absolute;left:394.20px;top:439.80px" class="cls_053"><span class="cls_053">B</span></div>
<div style="position:absolute;left:422.28px;top:439.80px" class="cls_053"><span class="cls_053">C</span></div>
<div style="position:absolute;left:450.36px;top:439.80px" class="cls_053"><span class="cls_053">D</span></div>
<div style="position:absolute;left:473.97px;top:440.95px" class="cls_053"><span class="cls_053">$24</span></div>
<div style="position:absolute;left:119.74px;top:447.00px" class="cls_053"><span class="cls_053">address 0</span></div>
<div style="position:absolute;left:185.26px;top:447.00px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:213.34px;top:447.00px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:241.42px;top:447.00px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:269.43px;top:447.00px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:313.19px;top:473.09px" class="cls_075"><span class="cls_075">SWL $24,1($0)</span></div>
<div style="position:absolute;left:120.57px;top:486.62px" class="cls_053"><span class="cls_053">address 4</span></div>
<div style="position:absolute;left:186.09px;top:486.62px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:214.17px;top:486.62px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:242.25px;top:486.62px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:270.26px;top:486.62px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:290.69px;top:494.03px" class="cls_053"><span class="cls_053">after</span></div>
<div style="position:absolute;left:120.57px;top:501.02px" class="cls_053"><span class="cls_053">address 0</span></div>
<div style="position:absolute;left:186.09px;top:500.44px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:213.23px;top:500.44px" class="cls_053"><span class="cls_053">A</span></div>
<div style="position:absolute;left:241.31px;top:500.44px" class="cls_053"><span class="cls_053">B</span></div>
<div style="position:absolute;left:269.39px;top:500.44px" class="cls_053"><span class="cls_053">C</span></div>
<div style="position:absolute;left:72.00px;top:544.32px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:180.01px;top:570.16px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:216.00px;top:568.16px" class="cls_053"><span class="cls_053">vAddr </span><span class="cls_003">←</span><span class="cls_053"> ((offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16 </sup></span><span class="cls_053">|| offset</span><span class="cls_061"><sup> 15...0</sup></span><span class="cls_053">) + GPR[base]</span></div>
<div style="position:absolute;left:216.01px;top:583.16px" class="cls_053"><span class="cls_053">(pAddr, uncached)</span><span class="cls_003"> ←</span><span class="cls_053"> AddressTranslation (vAddr, DATA)</span></div>
<div style="position:absolute;left:216.01px;top:594.16px" class="cls_053"><span class="cls_053">pAddr </span><span class="cls_003">← </span><span class="cls_053"> pAddr</span><span class="cls_061"><sub>PSIZE -1...2</sub></span><span class="cls_053"> || (pAddr</span><span class="cls_061"><sub>1...0 </sub></span><span class="cls_053"> xor  ReverseEndian</span><span class="cls_061"><sup>2</sup></span><span class="cls_053">)</span></div>
<div style="position:absolute;left:216.01px;top:609.16px" class="cls_053"><span class="cls_053">If BigEndianMem = 0 then</span></div>
<div style="position:absolute;left:234.01px;top:620.16px" class="cls_053"><span class="cls_053">pAddr  </span><span class="cls_003">←</span><span class="cls_053"> pAddr</span><span class="cls_061"><sub>PSIZE - 1...2</sub></span><span class="cls_053"> || 0</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:216.01px;top:635.16px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:216.01px;top:646.16px" class="cls_053"><span class="cls_053">byte </span><span class="cls_003">←</span><span class="cls_053"> vAddr</span><span class="cls_061"><sub>1...0  </sub></span><span class="cls_053"> xor  BigEndianCPU</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:216.01px;top:659.16px" class="cls_053"><span class="cls_053">data </span><span class="cls_003">←</span><span class="cls_053"> 0</span><span class="cls_061"><sup>24-8*byte</sup></span><span class="cls_053"> || GPR[rt]</span><span class="cls_061"><sub>31...24-8*byte</sub></span></div>
<div style="position:absolute;left:216.01px;top:674.16px" class="cls_053"><span class="cls_053">Storememory (uncached, byte, data, pAddr, vAddr, DATA)</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-72</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:227768px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:253.48px;top:61.98px" class="cls_064"><span class="cls_064">Store Word Left</span></div>
<div style="position:absolute;left:106.04px;top:61.10px" class="cls_063"><span class="cls_063">SWL</span></div>
<div style="position:absolute;left:449.88px;top:60.82px" class="cls_063"><span class="cls_063">SWL</span></div>
<div style="position:absolute;left:267.59px;top:77.67px" class="cls_064"><span class="cls_064">(Continued)</span></div>
<div style="position:absolute;left:108.00px;top:112.10px" class="cls_055"><span class="cls_055">Given a doubleword in a register and a doubleword in memory, the operation of SWL is as follows:</span></div>
<div style="position:absolute;left:172.37px;top:149.29px" class="cls_064"><span class="cls_064">SWL</span></div>
<div style="position:absolute;left:174.39px;top:173.23px" class="cls_053"><span class="cls_053">Register</span></div>
<div style="position:absolute;left:231.96px;top:174.17px" class="cls_053"><span class="cls_053">A</span></div>
<div style="position:absolute;left:258.03px;top:174.17px" class="cls_053"><span class="cls_053">B</span></div>
<div style="position:absolute;left:286.91px;top:174.17px" class="cls_053"><span class="cls_053">C</span></div>
<div style="position:absolute;left:313.70px;top:174.17px" class="cls_053"><span class="cls_053">D</span></div>
<div style="position:absolute;left:342.48px;top:173.81px" class="cls_053"><span class="cls_053">E</span></div>
<div style="position:absolute;left:368.83px;top:173.81px" class="cls_053"><span class="cls_053">F</span></div>
<div style="position:absolute;left:397.15px;top:173.81px" class="cls_053"><span class="cls_053">G</span></div>
<div style="position:absolute;left:424.21px;top:173.81px" class="cls_053"><span class="cls_053">H</span></div>
<div style="position:absolute;left:174.39px;top:203.04px" class="cls_053"><span class="cls_053">Memory</span></div>
<div style="position:absolute;left:233.91px;top:203.98px" class="cls_053"><span class="cls_053">I</span></div>
<div style="position:absolute;left:258.87px;top:203.98px" class="cls_053"><span class="cls_053">J</span></div>
<div style="position:absolute;left:287.19px;top:203.98px" class="cls_053"><span class="cls_053">K</span></div>
<div style="position:absolute;left:314.53px;top:203.98px" class="cls_053"><span class="cls_053">L</span></div>
<div style="position:absolute;left:341.65px;top:203.62px" class="cls_053"><span class="cls_053">M</span></div>
<div style="position:absolute;left:368.27px;top:203.62px" class="cls_053"><span class="cls_053">N</span></div>
<div style="position:absolute;left:397.15px;top:203.62px" class="cls_053"><span class="cls_053">O</span></div>
<div style="position:absolute;left:424.49px;top:203.62px" class="cls_053"><span class="cls_053">P</span></div>
<div style="position:absolute;left:196.49px;top:246.16px" class="cls_056"><span class="cls_056">BigEndianCPU = 0</span></div>
<div style="position:absolute;left:381.92px;top:246.16px" class="cls_056"><span class="cls_056">BigEndianCPU = 1</span></div>
<div style="position:absolute;left:292.72px;top:259.53px" class="cls_070"><span class="cls_070">offset</span></div>
<div style="position:absolute;left:468.32px;top:259.82px" class="cls_070"><span class="cls_070">offset</span></div>
<div style="position:absolute;left:112.86px;top:267.97px" class="cls_070"><span class="cls_070">vAddr</span><span class="cls_072"><sub>2..0</sub></span></div>
<div style="position:absolute;left:180.70px;top:268.73px" class="cls_070"><span class="cls_070">destination</span></div>
<div style="position:absolute;left:255.21px;top:269.45px" class="cls_070"><span class="cls_070">type</span></div>
<div style="position:absolute;left:358.71px;top:269.59px" class="cls_070"><span class="cls_070">destination</span></div>
<div style="position:absolute;left:432.58px;top:269.52px" class="cls_070"><span class="cls_070">type</span></div>
<div style="position:absolute;left:281.12px;top:273.74px" class="cls_056"><span class="cls_056">LEM  BEM</span></div>
<div style="position:absolute;left:457.02px;top:273.02px" class="cls_056"><span class="cls_056">LEM  BEM</span></div>
<div style="position:absolute;left:125.66px;top:290.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:156.10px;top:290.78px" class="cls_053"><span class="cls_053">I</span></div>
<div style="position:absolute;left:169.38px;top:290.78px" class="cls_053"><span class="cls_053">J K L M N O E</span></div>
<div style="position:absolute;left:260.96px;top:290.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:289.67px;top:290.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:310.39px;top:290.78px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:332.91px;top:290.78px" class="cls_053"><span class="cls_053">E F G H MN O P</span></div>
<div style="position:absolute;left:438.25px;top:290.78px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:464.25px;top:290.78px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:487.25px;top:290.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:125.66px;top:304.78px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:156.10px;top:304.78px" class="cls_053"><span class="cls_053">I</span></div>
<div style="position:absolute;left:169.38px;top:304.78px" class="cls_053"><span class="cls_053">J K L M N E F</span></div>
<div style="position:absolute;left:260.97px;top:304.78px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:289.68px;top:304.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:310.39px;top:304.78px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:332.91px;top:304.78px" class="cls_053"><span class="cls_053">I  E F G MN O P</span></div>
<div style="position:absolute;left:438.24px;top:304.78px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:464.25px;top:304.78px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:487.25px;top:304.78px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:125.66px;top:318.78px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:156.10px;top:318.78px" class="cls_053"><span class="cls_053">I</span></div>
<div style="position:absolute;left:169.38px;top:318.78px" class="cls_053"><span class="cls_053">J K L M E F G</span></div>
<div style="position:absolute;left:260.96px;top:318.78px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:289.67px;top:318.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:310.39px;top:318.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:332.92px;top:318.78px" class="cls_053"><span class="cls_053">I  J E F MN O P</span></div>
<div style="position:absolute;left:438.25px;top:318.78px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:464.25px;top:318.78px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:487.26px;top:318.78px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:125.66px;top:332.78px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:156.10px;top:332.78px" class="cls_053"><span class="cls_053">I</span></div>
<div style="position:absolute;left:169.38px;top:332.78px" class="cls_053"><span class="cls_053">J K L E F G H</span></div>
<div style="position:absolute;left:260.96px;top:332.78px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:289.68px;top:332.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:310.40px;top:332.78px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:332.92px;top:332.78px" class="cls_053"><span class="cls_053">I  J K E MN O P</span></div>
<div style="position:absolute;left:438.26px;top:332.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:464.26px;top:332.78px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:487.26px;top:332.78px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:125.66px;top:346.78px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:156.10px;top:346.78px" class="cls_053"><span class="cls_053">I</span></div>
<div style="position:absolute;left:169.38px;top:346.78px" class="cls_053"><span class="cls_053">J K E M N O P</span></div>
<div style="position:absolute;left:260.95px;top:346.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:289.68px;top:346.78px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:310.39px;top:346.78px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:332.91px;top:346.78px" class="cls_053"><span class="cls_053">I  J K L E F G H</span></div>
<div style="position:absolute;left:438.24px;top:346.78px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:464.24px;top:346.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:487.24px;top:346.78px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:125.66px;top:360.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:156.10px;top:360.78px" class="cls_053"><span class="cls_053">I</span></div>
<div style="position:absolute;left:169.38px;top:360.78px" class="cls_053"><span class="cls_053">J E F M N O P</span></div>
<div style="position:absolute;left:260.95px;top:360.78px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:289.66px;top:360.78px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:310.39px;top:360.78px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:332.91px;top:360.78px" class="cls_053"><span class="cls_053">I  J K L ME F G</span></div>
<div style="position:absolute;left:438.24px;top:360.78px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:464.24px;top:360.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:487.25px;top:360.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:125.66px;top:374.78px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:156.10px;top:374.78px" class="cls_053"><span class="cls_053">I</span></div>
<div style="position:absolute;left:169.38px;top:374.78px" class="cls_053"><span class="cls_053">E F GM N O P</span></div>
<div style="position:absolute;left:260.95px;top:374.78px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:289.66px;top:374.78px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:310.37px;top:374.78px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:332.91px;top:374.78px" class="cls_053"><span class="cls_053">I  J K L MN E F</span></div>
<div style="position:absolute;left:438.24px;top:374.78px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:464.25px;top:374.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:487.25px;top:374.78px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:125.66px;top:388.78px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:156.10px;top:388.78px" class="cls_053"><span class="cls_053">E F G H M N O P</span></div>
<div style="position:absolute;left:260.95px;top:388.78px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:289.67px;top:388.78px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:310.38px;top:388.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:332.91px;top:388.78px" class="cls_053"><span class="cls_053">I  J K L MN O E</span></div>
<div style="position:absolute;left:438.25px;top:388.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:464.25px;top:388.78px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:487.25px;top:388.78px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:108.00px;top:412.27px" class="cls_058"><span class="cls_058">LEM</span></div>
<div style="position:absolute;left:234.00px;top:412.27px" class="cls_055"><span class="cls_055">Little-endian memory (BigEndianMem = 0)</span></div>
<div style="position:absolute;left:108.00px;top:425.27px" class="cls_058"><span class="cls_058">BEM</span></div>
<div style="position:absolute;left:234.00px;top:425.27px" class="cls_055"><span class="cls_055">BigEndianMem = 1</span></div>
<div style="position:absolute;left:108.00px;top:438.27px" class="cls_058"><span class="cls_058">Type</span></div>
<div style="position:absolute;left:234.00px;top:438.27px" class="cls_055"><span class="cls_055">AccessType sent to memory</span></div>
<div style="position:absolute;left:108.00px;top:451.27px" class="cls_058"><span class="cls_058">Offset</span></div>
<div style="position:absolute;left:234.00px;top:451.27px" class="cls_055"><span class="cls_055">pAddr</span><span class="cls_071"><sub>2...0</sub></span><span class="cls_055"> sent to memory</span></div>
<div style="position:absolute;left:72.00px;top:471.94px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:490.27px" class="cls_055"><span class="cls_055">TLB refill exception</span></div>
<div style="position:absolute;left:108.00px;top:503.27px" class="cls_055"><span class="cls_055">TLB invalid exception</span></div>
<div style="position:absolute;left:108.00px;top:516.27px" class="cls_055"><span class="cls_055">TLB modification exception</span></div>
<div style="position:absolute;left:108.00px;top:529.27px" class="cls_055"><span class="cls_055">Bus error exception</span></div>
<div style="position:absolute;left:108.00px;top:542.27px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-73</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:228570px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:248.46px;top:66.34px" class="cls_064"><span class="cls_064">Store Word Right</span></div>
<div style="position:absolute;left:106.08px;top:61.47px" class="cls_063"><span class="cls_063">SWR</span></div>
<div style="position:absolute;left:448.25px;top:61.11px" class="cls_063"><span class="cls_063">SWR</span></div>
<div style="position:absolute;left:117.50px;top:98.35px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.73px;top:98.35px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.95px;top:98.35px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.21px;top:98.35px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:490.34px;top:98.35px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:144.36px;top:122.40px" class="cls_053"><span class="cls_053">SWR</span></div>
<div style="position:absolute;left:207.97px;top:122.40px" class="cls_053"><span class="cls_053">base</span></div>
<div style="position:absolute;left:273.22px;top:122.40px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:388.96px;top:120.96px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:131.10px;top:131.98px" class="cls_053"><span class="cls_053">1 0 1 1 1 0</span></div>
<div style="position:absolute;left:152.71px;top:146.38px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.81px;top:146.38px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.07px;top:146.38px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:389.97px;top:146.38px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:168.02px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:189.36px" class="cls_055"><span class="cls_055">SWR rt, offset(base)</span></div>
<div style="position:absolute;left:72.00px;top:204.02px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:222.36px" class="cls_055"><span class="cls_055">This instruction can be used with the SWL instruction to store the contents of a register into four</span></div>
<div style="position:absolute;left:108.00px;top:235.36px" class="cls_055"><span class="cls_055">consecutive bytes of memory, when the bytes cross a boundary between two words.  SWR stores</span></div>
<div style="position:absolute;left:108.00px;top:248.36px" class="cls_055"><span class="cls_055">the right portion of the register into the appropriate part of the low-order word; SWL stores the left</span></div>
<div style="position:absolute;left:108.00px;top:261.36px" class="cls_055"><span class="cls_055">portion of the register into the appropriate part of the low-order word of memory.</span></div>
<div style="position:absolute;left:108.00px;top:280.36px" class="cls_055"><span class="cls_055">The SWR instruction adds its sign-extended 16-bit </span><span class="cls_058">offset </span><span class="cls_055">to the contents of general register </span><span class="cls_058">base </span><span class="cls_055">to</span></div>
<div style="position:absolute;left:108.00px;top:293.36px" class="cls_055"><span class="cls_055">form a virtual address which may specify an arbitrary byte.  It alters only the word in memory</span></div>
<div style="position:absolute;left:108.00px;top:306.36px" class="cls_055"><span class="cls_055">which contains that byte. From one to four bytes will be stored, depending on the starting byte</span></div>
<div style="position:absolute;left:108.00px;top:319.36px" class="cls_055"><span class="cls_055">specified.</span></div>
<div style="position:absolute;left:108.00px;top:338.36px" class="cls_055"><span class="cls_055">Conceptually, it starts at the least-significant (rightmost) byte of the register and copies it to the</span></div>
<div style="position:absolute;left:108.00px;top:351.36px" class="cls_055"><span class="cls_055">specified byte in memory; then copies bytes from register to memory until it reaches the high-order</span></div>
<div style="position:absolute;left:108.00px;top:364.36px" class="cls_055"><span class="cls_055">byte of the word in memory.</span></div>
<div style="position:absolute;left:108.00px;top:383.36px" class="cls_055"><span class="cls_055">No address exceptions due to alignment are possible.</span></div>
<div style="position:absolute;left:202.39px;top:405.12px" class="cls_053"><span class="cls_053">memory</span></div>
<div style="position:absolute;left:197.57px;top:414.70px" class="cls_053"><span class="cls_053">(big-endian)</span></div>
<div style="position:absolute;left:386.86px;top:419.52px" class="cls_053"><span class="cls_053">register</span></div>
<div style="position:absolute;left:120.74px;top:430.32px" class="cls_053"><span class="cls_053">address 4</span></div>
<div style="position:absolute;left:186.26px;top:430.32px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:214.35px;top:430.32px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:242.43px;top:430.32px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:270.44px;top:430.32px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:298.37px;top:438.68px" class="cls_053"><span class="cls_053">before</span></div>
<div style="position:absolute;left:368.14px;top:437.52px" class="cls_053"><span class="cls_053">A</span></div>
<div style="position:absolute;left:396.22px;top:437.52px" class="cls_053"><span class="cls_053">B</span></div>
<div style="position:absolute;left:424.30px;top:437.52px" class="cls_053"><span class="cls_053">C</span></div>
<div style="position:absolute;left:452.38px;top:437.52px" class="cls_053"><span class="cls_053">D</span></div>
<div style="position:absolute;left:475.98px;top:438.68px" class="cls_053"><span class="cls_053">$24</span></div>
<div style="position:absolute;left:120.74px;top:444.72px" class="cls_053"><span class="cls_053">address 0</span></div>
<div style="position:absolute;left:186.26px;top:444.72px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:214.35px;top:444.72px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:242.43px;top:444.72px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:270.44px;top:444.72px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:338.06px;top:473.83px" class="cls_075"><span class="cls_075">SWR $24,1($0)</span></div>
<div style="position:absolute;left:120.74px;top:492.68px" class="cls_053"><span class="cls_053">address 4</span></div>
<div style="position:absolute;left:186.26px;top:492.68px" class="cls_053"><span class="cls_053">D</span></div>
<div style="position:absolute;left:214.35px;top:492.68px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:242.43px;top:492.68px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:270.44px;top:492.68px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:298.37px;top:501.10px" class="cls_053"><span class="cls_053">after</span></div>
<div style="position:absolute;left:120.74px;top:507.08px" class="cls_053"><span class="cls_053">address 0</span></div>
<div style="position:absolute;left:186.26px;top:506.50px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:213.40px;top:506.50px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:241.49px;top:506.50px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:269.57px;top:506.50px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:72.00px;top:550.04px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:162.85px;top:571.67px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:198.84px;top:569.67px" class="cls_053"><span class="cls_053">vAddr </span><span class="cls_003">←</span><span class="cls_053"> ((offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>16 </sup></span><span class="cls_053">|| offset</span><span class="cls_061"><sup> 15...0</sup></span><span class="cls_053">) + GPR[base]</span></div>
<div style="position:absolute;left:198.85px;top:584.67px" class="cls_053"><span class="cls_053">(pAddr, uncached)</span><span class="cls_003"> ←</span><span class="cls_053"> AddressTranslation (vAddr, DATA)</span></div>
<div style="position:absolute;left:198.85px;top:595.67px" class="cls_053"><span class="cls_053">pAddr </span><span class="cls_003">← </span><span class="cls_053"> pAddr</span><span class="cls_061"><sub>PSIZE - 1...2</sub></span><span class="cls_053"> || (pAddr</span><span class="cls_061"><sub>1...0 </sub></span><span class="cls_053"> xor  ReverseEndian</span><span class="cls_061"><sup>2</sup></span><span class="cls_053">)</span></div>
<div style="position:absolute;left:198.85px;top:610.67px" class="cls_053"><span class="cls_053">BigEndianMem = 0 then</span></div>
<div style="position:absolute;left:216.85px;top:621.67px" class="cls_053"><span class="cls_053">pAddr  </span><span class="cls_003">←</span><span class="cls_053"> pAddr</span><span class="cls_061"><sub>PSIZE - 31...2</sub></span><span class="cls_053"> || 0</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:198.85px;top:636.67px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:198.85px;top:647.67px" class="cls_053"><span class="cls_053">byte </span><span class="cls_003">←</span><span class="cls_053"> vAddr</span><span class="cls_061"><sub>1...0  </sub></span><span class="cls_053"> xor  BigEndianCPU</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:198.85px;top:660.67px" class="cls_053"><span class="cls_053">data </span><span class="cls_003">←</span><span class="cls_053"> GPR[rt]</span><span class="cls_061"><sub>31-8*byte</sub></span><span class="cls_053"> || 0</span><span class="cls_061"><sup>8*byte</sup></span></div>
<div style="position:absolute;left:198.85px;top:675.67px" class="cls_053"><span class="cls_053">Storememory (uncached, WORD-byte, data, pAddr, vAddr, DATA)</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-74</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:229372px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:247.85px;top:60.82px" class="cls_064"><span class="cls_064">Store Word Right</span></div>
<div style="position:absolute;left:103.80px;top:60.62px" class="cls_063"><span class="cls_063">SWR</span></div>
<div style="position:absolute;left:448.48px;top:60.33px" class="cls_063"><span class="cls_063">SWR</span></div>
<div style="position:absolute;left:266.47px;top:77.17px" class="cls_064"><span class="cls_064">(Continued)</span></div>
<div style="position:absolute;left:108.00px;top:116.57px" class="cls_055"><span class="cls_055">Given a doubleword in a register and a doubleword in memory, the operation of SWR is as follows:</span></div>
<div style="position:absolute;left:169.80px;top:153.40px" class="cls_064"><span class="cls_064">SWR</span></div>
<div style="position:absolute;left:173.38px;top:177.34px" class="cls_053"><span class="cls_053">Register</span></div>
<div style="position:absolute;left:230.95px;top:178.28px" class="cls_053"><span class="cls_053">A</span></div>
<div style="position:absolute;left:257.02px;top:178.28px" class="cls_053"><span class="cls_053">B</span></div>
<div style="position:absolute;left:285.90px;top:178.28px" class="cls_053"><span class="cls_053">C</span></div>
<div style="position:absolute;left:312.69px;top:178.28px" class="cls_053"><span class="cls_053">D</span></div>
<div style="position:absolute;left:341.47px;top:177.92px" class="cls_053"><span class="cls_053">E</span></div>
<div style="position:absolute;left:367.82px;top:177.92px" class="cls_053"><span class="cls_053">F</span></div>
<div style="position:absolute;left:396.14px;top:177.92px" class="cls_053"><span class="cls_053">G</span></div>
<div style="position:absolute;left:423.20px;top:177.92px" class="cls_053"><span class="cls_053">H</span></div>
<div style="position:absolute;left:173.38px;top:207.14px" class="cls_053"><span class="cls_053">Memory</span></div>
<div style="position:absolute;left:232.90px;top:208.08px" class="cls_053"><span class="cls_053">I</span></div>
<div style="position:absolute;left:257.86px;top:208.08px" class="cls_053"><span class="cls_053">J</span></div>
<div style="position:absolute;left:286.18px;top:208.08px" class="cls_053"><span class="cls_053">K</span></div>
<div style="position:absolute;left:313.52px;top:208.08px" class="cls_053"><span class="cls_053">L</span></div>
<div style="position:absolute;left:340.64px;top:207.72px" class="cls_053"><span class="cls_053">M</span></div>
<div style="position:absolute;left:367.26px;top:207.72px" class="cls_053"><span class="cls_053">N</span></div>
<div style="position:absolute;left:396.14px;top:207.72px" class="cls_053"><span class="cls_053">O</span></div>
<div style="position:absolute;left:423.48px;top:207.72px" class="cls_053"><span class="cls_053">P</span></div>
<div style="position:absolute;left:200.41px;top:250.52px" class="cls_056"><span class="cls_056">BigEndianCPU = 0</span></div>
<div style="position:absolute;left:386.10px;top:249.58px" class="cls_056"><span class="cls_056">BigEndianCPU = 1</span></div>
<div style="position:absolute;left:296.96px;top:262.94px" class="cls_070"><span class="cls_070">offset</span></div>
<div style="position:absolute;left:472.57px;top:261.86px" class="cls_070"><span class="cls_070">offset</span></div>
<div style="position:absolute;left:117.92px;top:271.16px" class="cls_070"><span class="cls_070">vAddr</span><span class="cls_072"><sub>2..0</sub></span></div>
<div style="position:absolute;left:185.76px;top:271.92px" class="cls_070"><span class="cls_070">destination</span></div>
<div style="position:absolute;left:261.27px;top:272.64px" class="cls_070"><span class="cls_070">type</span></div>
<div style="position:absolute;left:363.78px;top:272.78px" class="cls_070"><span class="cls_070">destination</span></div>
<div style="position:absolute;left:438.63px;top:272.71px" class="cls_070"><span class="cls_070">type</span></div>
<div style="position:absolute;left:286.09px;top:277.16px" class="cls_056"><span class="cls_056">LEM  BEM</span></div>
<div style="position:absolute;left:461.27px;top:276.51px" class="cls_056"><span class="cls_056">LEM  BEM</span></div>
<div style="position:absolute;left:129.84px;top:294.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:160.27px;top:294.27px" class="cls_053"><span class="cls_053">I</span></div>
<div style="position:absolute;left:173.56px;top:294.27px" class="cls_053"><span class="cls_053">J K L E F G H</span></div>
<div style="position:absolute;left:265.13px;top:294.27px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:293.85px;top:294.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:314.56px;top:294.27px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:337.09px;top:294.27px" class="cls_053"><span class="cls_053">H J K L MN O P</span></div>
<div style="position:absolute;left:442.44px;top:294.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:468.44px;top:294.27px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:491.44px;top:294.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:129.84px;top:308.27px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:160.27px;top:308.27px" class="cls_053"><span class="cls_053">I</span></div>
<div style="position:absolute;left:173.56px;top:308.27px" class="cls_053"><span class="cls_053">J K L F G H P</span></div>
<div style="position:absolute;left:265.13px;top:308.27px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:293.85px;top:308.27px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:314.57px;top:308.27px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:337.09px;top:308.27px" class="cls_053"><span class="cls_053">G H K L MN O P</span></div>
<div style="position:absolute;left:442.44px;top:308.27px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:468.44px;top:308.27px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:491.44px;top:308.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:129.84px;top:322.27px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:160.27px;top:322.27px" class="cls_053"><span class="cls_053">I</span></div>
<div style="position:absolute;left:173.56px;top:322.27px" class="cls_053"><span class="cls_053">J K L G H O P</span></div>
<div style="position:absolute;left:265.13px;top:322.27px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:293.85px;top:322.27px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:314.56px;top:322.27px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:337.09px;top:322.27px" class="cls_053"><span class="cls_053">F G H L MN O P</span></div>
<div style="position:absolute;left:442.43px;top:322.27px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:468.44px;top:322.27px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:491.44px;top:322.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:129.84px;top:336.27px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:160.27px;top:336.27px" class="cls_053"><span class="cls_053">I</span></div>
<div style="position:absolute;left:173.56px;top:336.27px" class="cls_053"><span class="cls_053">J K L H N O P</span></div>
<div style="position:absolute;left:265.13px;top:336.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:293.85px;top:336.27px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:314.57px;top:336.27px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:337.09px;top:336.27px" class="cls_053"><span class="cls_053">E F G H MN O P</span></div>
<div style="position:absolute;left:442.43px;top:336.27px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:468.43px;top:336.27px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:491.43px;top:336.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:129.84px;top:350.27px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:160.27px;top:350.27px" class="cls_053"><span class="cls_053">E F G H M N O P</span></div>
<div style="position:absolute;left:265.13px;top:350.27px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:293.84px;top:350.27px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:314.56px;top:350.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:337.08px;top:350.27px" class="cls_053"><span class="cls_053">I  J K L H N O P</span></div>
<div style="position:absolute;left:442.42px;top:350.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:468.42px;top:350.27px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:491.42px;top:350.27px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:129.84px;top:364.27px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:160.27px;top:364.27px" class="cls_053"><span class="cls_053">F G H L M N O P</span></div>
<div style="position:absolute;left:265.13px;top:364.27px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:293.84px;top:364.27px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:314.56px;top:364.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:337.09px;top:364.27px" class="cls_053"><span class="cls_053">I  J K L G H O P</span></div>
<div style="position:absolute;left:442.41px;top:364.27px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:468.42px;top:364.27px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:491.42px;top:364.27px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:129.84px;top:378.27px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:160.27px;top:378.27px" class="cls_053"><span class="cls_053">G H K L M N O P</span></div>
<div style="position:absolute;left:265.13px;top:378.27px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:293.85px;top:378.27px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:314.57px;top:378.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:337.10px;top:378.27px" class="cls_053"><span class="cls_053">I  J K L F GH P</span></div>
<div style="position:absolute;left:442.43px;top:378.27px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:468.43px;top:378.27px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:491.43px;top:378.27px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:129.84px;top:392.27px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:160.27px;top:392.27px" class="cls_053"><span class="cls_053">H J K L M N O P</span></div>
<div style="position:absolute;left:265.13px;top:392.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:293.86px;top:392.27px" class="cls_053"><span class="cls_053">7</span></div>
<div style="position:absolute;left:314.58px;top:392.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:337.10px;top:392.27px" class="cls_053"><span class="cls_053">I  J K L E F G H</span></div>
<div style="position:absolute;left:442.43px;top:392.27px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:468.43px;top:392.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:491.43px;top:392.27px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:108.00px;top:418.07px" class="cls_058"><span class="cls_058">LEM</span></div>
<div style="position:absolute;left:234.00px;top:418.07px" class="cls_055"><span class="cls_055">Little-endian memory (BigEndianMem = 0)</span></div>
<div style="position:absolute;left:108.00px;top:431.07px" class="cls_058"><span class="cls_058">BEM</span></div>
<div style="position:absolute;left:234.00px;top:431.07px" class="cls_055"><span class="cls_055">BigEndianMem = 1</span></div>
<div style="position:absolute;left:108.00px;top:444.07px" class="cls_058"><span class="cls_058">Type</span></div>
<div style="position:absolute;left:234.00px;top:444.07px" class="cls_055"><span class="cls_055">AccessType sent to memory</span></div>
<div style="position:absolute;left:108.00px;top:457.07px" class="cls_058"><span class="cls_058">Offset</span></div>
<div style="position:absolute;left:234.00px;top:457.06px" class="cls_055"><span class="cls_055">pAddr</span><span class="cls_071"><sub>2...0</sub></span><span class="cls_055"> sent to memory</span></div>
<div style="position:absolute;left:72.00px;top:477.73px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:496.06px" class="cls_055"><span class="cls_055">TLB refill exception</span></div>
<div style="position:absolute;left:108.00px;top:509.06px" class="cls_055"><span class="cls_055">TLB invalid exception</span></div>
<div style="position:absolute;left:108.00px;top:522.06px" class="cls_055"><span class="cls_055">TLB modification exception</span></div>
<div style="position:absolute;left:108.00px;top:535.06px" class="cls_055"><span class="cls_055">Bus error exception</span></div>
<div style="position:absolute;left:108.00px;top:548.06px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-75</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:230174px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:266.29px;top:65.65px" class="cls_064"><span class="cls_064">System Call</span></div>
<div style="position:absolute;left:106.22px;top:59.46px" class="cls_063"><span class="cls_063">SYSCALL</span></div>
<div style="position:absolute;left:390.90px;top:59.96px" class="cls_063"><span class="cls_063">SYSCALL</span></div>
<div style="position:absolute;left:117.40px;top:101.78px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:176.59px;top:101.78px" class="cls_053"><span class="cls_053">26 25</span></div>
<div style="position:absolute;left:414.54px;top:101.79px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:430.60px;top:101.79px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:490.08px;top:101.79px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:134.80px;top:125.76px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:297.11px;top:127.46px" class="cls_053"><span class="cls_053">Code</span></div>
<div style="position:absolute;left:440.56px;top:125.76px" class="cls_053"><span class="cls_053">SYSCALL</span></div>
<div style="position:absolute;left:128.91px;top:135.41px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:440.42px;top:135.41px" class="cls_053"><span class="cls_053">0 0 1 1 00</span></div>
<div style="position:absolute;left:152.61px;top:149.81px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:307.12px;top:149.81px" class="cls_053"><span class="cls_053">20</span></div>
<div style="position:absolute;left:457.67px;top:149.81px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:172.11px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:193.44px" class="cls_055"><span class="cls_055">SYSCALL</span></div>
<div style="position:absolute;left:72.00px;top:214.10px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:232.44px" class="cls_055"><span class="cls_055">A system call exception occurs, immediately and unconditionally transferring control to the</span></div>
<div style="position:absolute;left:108.00px;top:245.44px" class="cls_055"><span class="cls_055">exception handler.</span></div>
<div style="position:absolute;left:108.00px;top:264.44px" class="cls_055"><span class="cls_055">The code field is available for use as software parameters, but is retrieved by the exception handler</span></div>
<div style="position:absolute;left:108.00px;top:277.44px" class="cls_055"><span class="cls_055">only by loading the contents of the memory word containing the instruction.</span></div>
<div style="position:absolute;left:72.00px;top:298.11px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:136.97px;top:328.59px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:162.16px;top:328.59px" class="cls_053"><span class="cls_053">SystemCallException</span></div>
<div style="position:absolute;left:72.00px;top:366.49px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:384.82px" class="cls_055"><span class="cls_055">System Call exception</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-76</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:230976px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:263.60px;top:66.86px" class="cls_064"><span class="cls_064">Exclusive Or</span></div>
<div style="position:absolute;left:106.99px;top:60.90px" class="cls_063"><span class="cls_063">XOR</span></div>
<div style="position:absolute;left:458.16px;top:61.19px" class="cls_063"><span class="cls_063">XOR</span></div>
<div style="position:absolute;left:116.64px;top:104.56px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:104.56px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.09px;top:104.56px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.35px;top:104.56px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:354.45px;top:104.57px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:413.80px;top:104.57px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:429.86px;top:104.57px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:489.33px;top:104.57px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:134.04px;top:128.54px" class="cls_053"><span class="cls_053">SPECIAL</span></div>
<div style="position:absolute;left:213.78px;top:128.54px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:272.28px;top:128.54px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:333.52px;top:128.54px" class="cls_053"><span class="cls_053">rd</span></div>
<div style="position:absolute;left:394.67px;top:128.54px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:453.00px;top:128.54px" class="cls_053"><span class="cls_053">XOR</span></div>
<div style="position:absolute;left:128.15px;top:138.19px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:375.77px;top:138.19px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:440.22px;top:138.19px" class="cls_053"><span class="cls_053">1 0 0 1 1 0</span></div>
<div style="position:absolute;left:151.85px;top:152.59px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.94px;top:152.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.20px;top:152.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:332.57px;top:152.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:392.04px;top:152.59px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:456.91px;top:152.59px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:176.03px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:197.37px" class="cls_055"><span class="cls_055">XOR rd, rs, rt</span></div>
<div style="position:absolute;left:72.00px;top:218.03px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:236.37px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rs </span><span class="cls_055">are combined with the contents of general register </span><span class="cls_058">rt </span><span class="cls_055">in a bit-wise</span></div>
<div style="position:absolute;left:108.01px;top:249.37px" class="cls_055"><span class="cls_055">logical exclusive OR operation.</span></div>
<div style="position:absolute;left:108.01px;top:268.37px" class="cls_055"><span class="cls_055">The result is placed into general register </span><span class="cls_058">rd.</span></div>
<div style="position:absolute;left:72.00px;top:289.03px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:108.94px;top:323.24px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:137.74px;top:323.24px" class="cls_053"><span class="cls_053">GPR[rd]</span><span class="cls_003"> ← </span><span class="cls_053">GPR[rs] xor GPR[rt]</span></div>
<div style="position:absolute;left:72.00px;top:361.03px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:379.37px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-77</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:231778px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:108.43px;top:61.19px" class="cls_063"><span class="cls_063">XORI</span><span class="cls_064">     Exclusive OR Immediate</span></div>
<div style="position:absolute;left:450.57px;top:60.90px" class="cls_063"><span class="cls_063">XORI</span></div>
<div style="position:absolute;left:117.58px;top:103.74px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.88px;top:103.74px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.10px;top:103.74px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.36px;top:103.74px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:490.41px;top:103.74px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:143.88px;top:127.79px" class="cls_053"><span class="cls_053">XORI</span></div>
<div style="position:absolute;left:214.72px;top:127.79px" class="cls_053"><span class="cls_053">rs</span></div>
<div style="position:absolute;left:273.29px;top:127.79px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:378.28px;top:126.35px" class="cls_053"><span class="cls_053">immediate</span></div>
<div style="position:absolute;left:132.12px;top:137.37px" class="cls_053"><span class="cls_053">0 0 1 1 1 0</span></div>
<div style="position:absolute;left:152.86px;top:151.77px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.95px;top:151.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.13px;top:151.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:390.10px;top:151.77px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:175.03px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:196.37px" class="cls_055"><span class="cls_055">XORI rt, rs, immediate</span></div>
<div style="position:absolute;left:72.00px;top:217.03px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:235.37px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">immediate </span><span class="cls_055">is zero-extended and combined with the contents of general register </span><span class="cls_058">rs </span><span class="cls_055">in a bit-</span></div>
<div style="position:absolute;left:108.00px;top:248.37px" class="cls_055"><span class="cls_055">wise logical exclusive OR operation.</span></div>
<div style="position:absolute;left:108.00px;top:267.37px" class="cls_055"><span class="cls_055">The result is placed into general register </span><span class="cls_058">rt.</span></div>
<div style="position:absolute;left:72.00px;top:288.03px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:173.15px;top:320.83px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:198.35px;top:318.83px" class="cls_053"><span class="cls_053">GPR[rt]  </span><span class="cls_003">←</span><span class="cls_053"> GPR[rs] xor (0</span><span class="cls_061"><sup>16</sup></span><span class="cls_053"> || immediate)</span></div>
<div style="position:absolute;left:74.75px;top:377.19px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:395.52px" class="cls_055"><span class="cls_055">None</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-78</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:232580px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:72.00px;top:50.00px" class="cls_015"><span class="cls_015">Instruction Summary</span></div>
<div style="position:absolute;left:138.78px;top:75.00px" class="cls_027"><span class="cls_027">Instr Fields</span></div>
<div style="position:absolute;left:82.02px;top:96.00px" class="cls_027"><span class="cls_027">op</span></div>
<div style="position:absolute;left:233.95px;top:96.00px" class="cls_027"><span class="cls_027">func</span></div>
<div style="position:absolute;left:268.84px;top:95.00px" class="cls_027"><span class="cls_027">Asm</span></div>
<div style="position:absolute;left:337.70px;top:95.00px" class="cls_027"><span class="cls_027">Description</span></div>
<div style="position:absolute;left:77.18px;top:117.67px" class="cls_076"><span class="cls_076">31-26</span></div>
<div style="position:absolute;left:108.56px;top:117.67px" class="cls_076"><span class="cls_076">25-21</span></div>
<div style="position:absolute;left:139.93px;top:117.67px" class="cls_076"><span class="cls_076">20-16</span></div>
<div style="position:absolute;left:171.31px;top:117.67px" class="cls_076"><span class="cls_076">15-11</span></div>
<div style="position:absolute;left:205.05px;top:117.67px" class="cls_076"><span class="cls_076">10-6</span></div>
<div style="position:absolute;left:238.79px;top:117.67px" class="cls_076"><span class="cls_076">5-0</span></div>
<div style="position:absolute;left:76.00px;top:134.00px" class="cls_020"><span class="cls_020">‘‘Register’’ format instructions</span></div>
<div style="position:absolute;left:84.89px;top:151.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:151.00px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:151.00px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:177.09px;top:151.00px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:208.32px;top:151.00px" class="cls_020"><span class="cls_020">sa</span></div>
<div style="position:absolute;left:241.85px;top:151.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:264.33px;top:151.00px" class="cls_020"><span class="cls_020">sll</span></div>
<div style="position:absolute;left:301.87px;top:151.00px" class="cls_020"><span class="cls_020">Shift left (to smaller bits) by</span></div>
<div style="position:absolute;left:301.53px;top:161.00px" class="cls_020"><span class="cls_020">a constant. </span><span class="cls_027">sll</span><span class="cls_020"> is ‘‘logical’’,</span></div>
<div style="position:absolute;left:301.52px;top:171.00px" class="cls_020"><span class="cls_020">brings in zeroes from the</span></div>
<div style="position:absolute;left:301.52px;top:181.00px" class="cls_020"><span class="cls_020">top. </span><span class="cls_027">srl</span><span class="cls_020"> is ‘‘arithmetic’’,</span></div>
<div style="position:absolute;left:84.89px;top:189.49px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:189.49px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:189.49px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:177.09px;top:189.49px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:208.32px;top:189.49px" class="cls_020"><span class="cls_020">sa</span></div>
<div style="position:absolute;left:241.85px;top:189.49px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:264.33px;top:189.49px" class="cls_020"><span class="cls_020">srl</span></div>
<div style="position:absolute;left:301.53px;top:191.00px" class="cls_020"><span class="cls_020">duplicating bit 31, so</span></div>
<div style="position:absolute;left:301.53px;top:201.00px" class="cls_020"><span class="cls_020">implementing a correct</span></div>
<div style="position:absolute;left:301.53px;top:210.99px" class="cls_020"><span class="cls_020">signed division by 2^n</span></div>
<div style="position:absolute;left:301.53px;top:228.00px" class="cls_020"><span class="cls_020">Shift right (to higher bits) by</span></div>
<div style="position:absolute;left:84.89px;top:237.99px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:237.99px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:237.99px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:177.09px;top:237.99px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:208.32px;top:237.99px" class="cls_020"><span class="cls_020">sa</span></div>
<div style="position:absolute;left:241.85px;top:237.99px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:264.33px;top:237.99px" class="cls_020"><span class="cls_020">sra</span></div>
<div style="position:absolute;left:301.53px;top:237.99px" class="cls_020"><span class="cls_020">a constant, bringing in</span></div>
<div style="position:absolute;left:301.53px;top:247.99px" class="cls_020"><span class="cls_020">zeroes to the low bits</span></div>
<div style="position:absolute;left:84.89px;top:264.99px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:264.99px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:264.99px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:177.09px;top:264.99px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:210.47px;top:264.99px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:241.83px;top:264.99px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:264.32px;top:264.99px" class="cls_020"><span class="cls_020">sllv</span></div>
<div style="position:absolute;left:301.53px;top:266.99px" class="cls_020"><span class="cls_020">shift (left logical, left</span></div>
<div style="position:absolute;left:301.53px;top:276.99px" class="cls_020"><span class="cls_020">arithmetic, and right) by the</span></div>
<div style="position:absolute;left:84.89px;top:281.99px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:281.99px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:281.99px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:177.09px;top:281.99px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:210.47px;top:281.99px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:241.83px;top:281.99px" class="cls_020"><span class="cls_020">6</span></div>
<div style="position:absolute;left:264.32px;top:281.99px" class="cls_020"><span class="cls_020">srlv</span></div>
<div style="position:absolute;left:301.53px;top:286.99px" class="cls_020"><span class="cls_020">amount stored in another</span></div>
<div style="position:absolute;left:84.89px;top:298.99px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:298.99px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:298.99px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:177.09px;top:298.99px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:210.47px;top:298.99px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:241.83px;top:298.99px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:264.32px;top:298.99px" class="cls_020"><span class="cls_020">srav</span></div>
<div style="position:absolute;left:301.53px;top:296.99px" class="cls_020"><span class="cls_020">register</span></div>
<div style="position:absolute;left:301.53px;top:315.98px" class="cls_020"><span class="cls_020">Jump to address in register</span></div>
<div style="position:absolute;left:84.89px;top:320.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:114.75px;top:320.98px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:179.01px;top:320.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:241.73px;top:320.98px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:264.21px;top:320.98px" class="cls_020"><span class="cls_020">jr</span></div>
<div style="position:absolute;left:301.53px;top:325.98px" class="cls_020"><span class="cls_020">(no offset)</span></div>
<div style="position:absolute;left:301.53px;top:342.98px" class="cls_020"><span class="cls_020">Call function at address</span></div>
<div style="position:absolute;left:301.53px;top:352.98px" class="cls_020"><span class="cls_020">from register. Can store the</span></div>
<div style="position:absolute;left:301.53px;top:362.98px" class="cls_020"><span class="cls_020">return address in any</span></div>
<div style="position:absolute;left:84.89px;top:367.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:114.75px;top:367.98px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:147.66px;top:367.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:177.03px;top:367.98px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:210.41px;top:367.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:241.78px;top:367.98px" class="cls_020"><span class="cls_020">9</span></div>
<div style="position:absolute;left:264.26px;top:367.98px" class="cls_020"><span class="cls_020">jalr</span></div>
<div style="position:absolute;left:301.53px;top:372.98px" class="cls_020"><span class="cls_020">register, even though</span></div>
<div style="position:absolute;left:301.53px;top:382.98px" class="cls_020"><span class="cls_020">anything but </span><span class="cls_027">ra</span><span class="cls_020"> is nor</span></div>
<div style="position:absolute;left:301.53px;top:392.98px" class="cls_020"><span class="cls_020">normally useful.</span></div>
<div style="position:absolute;left:301.52px;top:409.98px" class="cls_020"><span class="cls_020">Cause ‘‘syscall’’ trap,</span></div>
<div style="position:absolute;left:301.52px;top:419.98px" class="cls_020"><span class="cls_020">conventionally used for</span></div>
<div style="position:absolute;left:84.89px;top:424.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:163.55px;top:424.98px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:238.84px;top:424.98px" class="cls_020"><span class="cls_020">12</span></div>
<div style="position:absolute;left:264.13px;top:424.98px" class="cls_020"><span class="cls_020">syscall</span></div>
<div style="position:absolute;left:301.52px;top:429.97px" class="cls_020"><span class="cls_020">system call from user-mode</span></div>
<div style="position:absolute;left:301.52px;top:439.97px" class="cls_020"><span class="cls_020">to operating system</span></div>
<div style="position:absolute;left:301.51px;top:456.97px" class="cls_020"><span class="cls_020">Cause ‘‘Bp’’ trap,</span></div>
<div style="position:absolute;left:84.88px;top:466.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:163.54px;top:466.97px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:238.83px;top:466.97px" class="cls_020"><span class="cls_020">13</span></div>
<div style="position:absolute;left:264.12px;top:466.97px" class="cls_020"><span class="cls_020">break</span></div>
<div style="position:absolute;left:301.51px;top:466.97px" class="cls_020"><span class="cls_020">conventionally used for</span></div>
<div style="position:absolute;left:301.51px;top:476.97px" class="cls_020"><span class="cls_020">debugger breakpoint.</span></div>
<div style="position:absolute;left:84.87px;top:493.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:131.93px;top:493.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:176.97px;top:493.97px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:210.35px;top:493.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:238.94px;top:493.97px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:264.23px;top:493.97px" class="cls_020"><span class="cls_020">mfhi</span></div>
<div style="position:absolute;left:301.51px;top:494.48px" class="cls_020"><span class="cls_020">Access to multiply/divide</span></div>
<div style="position:absolute;left:301.51px;top:504.48px" class="cls_020"><span class="cls_020">unit registers ‘‘lo’’ and ‘‘hi’’.</span></div>
<div style="position:absolute;left:84.87px;top:510.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:114.73px;top:510.97px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:178.99px;top:510.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:238.93px;top:510.97px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:264.22px;top:510.97px" class="cls_020"><span class="cls_020">mthi</span></div>
<div style="position:absolute;left:301.51px;top:514.47px" class="cls_027"><span class="cls_027">mflo/mfhi</span><span class="cls_020"> move data from</span></div>
<div style="position:absolute;left:301.51px;top:524.47px" class="cls_020"><span class="cls_020">‘‘lo’’/‘‘hi’’ into an integer</span></div>
<div style="position:absolute;left:84.87px;top:527.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:131.93px;top:527.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:176.97px;top:527.97px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:210.35px;top:527.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:238.94px;top:527.97px" class="cls_020"><span class="cls_020">18</span></div>
<div style="position:absolute;left:264.23px;top:527.97px" class="cls_020"><span class="cls_020">mflo</span></div>
<div style="position:absolute;left:301.51px;top:534.47px" class="cls_020"><span class="cls_020">register; </span><span class="cls_027">mtlo/mthi</span><span class="cls_020"> go the</span></div>
<div style="position:absolute;left:84.87px;top:544.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:114.73px;top:544.98px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:178.99px;top:544.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:238.93px;top:544.98px" class="cls_020"><span class="cls_020">19</span></div>
<div style="position:absolute;left:264.22px;top:544.98px" class="cls_020"><span class="cls_020">mtlo</span></div>
<div style="position:absolute;left:301.51px;top:544.47px" class="cls_020"><span class="cls_020">other way.</span></div>
<div style="position:absolute;left:84.87px;top:561.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.95px;top:561.98px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.36px;top:561.98px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:194.75px;top:561.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.00px;top:561.98px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:264.29px;top:561.98px" class="cls_020"><span class="cls_020">mult</span></div>
<div style="position:absolute;left:301.86px;top:561.98px" class="cls_020"><span class="cls_020">Multiply two integer</span></div>
<div style="position:absolute;left:301.51px;top:571.98px" class="cls_020"><span class="cls_020">registers, put result into</span></div>
<div style="position:absolute;left:301.51px;top:581.97px" class="cls_020"><span class="cls_020">‘‘hi’’/‘‘lo’’ when done. </span><span class="cls_027">mult</span></div>
<div style="position:absolute;left:84.88px;top:590.47px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:590.47px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:590.47px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:194.76px;top:590.47px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.01px;top:590.47px" class="cls_020"><span class="cls_020">25</span></div>
<div style="position:absolute;left:264.30px;top:590.47px" class="cls_020"><span class="cls_020">multu</span></div>
<div style="position:absolute;left:301.51px;top:591.97px" class="cls_020"><span class="cls_020">sign-extends the result, but</span></div>
<div style="position:absolute;left:301.51px;top:601.97px" class="cls_027"><span class="cls_027">multu</span><span class="cls_020"> does not.</span></div>
<div style="position:absolute;left:84.88px;top:618.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:618.97px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:618.97px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:194.76px;top:618.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.01px;top:618.97px" class="cls_020"><span class="cls_020">26</span></div>
<div style="position:absolute;left:264.30px;top:618.97px" class="cls_020"><span class="cls_020">div</span></div>
<div style="position:absolute;left:301.85px;top:618.97px" class="cls_020"><span class="cls_020">(signed and unsigned</span></div>
<div style="position:absolute;left:301.52px;top:628.97px" class="cls_020"><span class="cls_020">versions of) divide two</span></div>
<div style="position:absolute;left:301.52px;top:638.97px" class="cls_020"><span class="cls_020">integer registers and put the</span></div>
<div style="position:absolute;left:301.52px;top:648.97px" class="cls_020"><span class="cls_020">result (quotient) and</span></div>
<div style="position:absolute;left:84.88px;top:652.47px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:652.47px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:652.47px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:194.76px;top:652.47px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.01px;top:652.47px" class="cls_020"><span class="cls_020">27</span></div>
<div style="position:absolute;left:264.30px;top:652.47px" class="cls_020"><span class="cls_020">divu</span></div>
<div style="position:absolute;left:301.52px;top:658.97px" class="cls_020"><span class="cls_020">remainder in ‘‘lo’’ and ‘‘hi’’</span></div>
<div style="position:absolute;left:301.52px;top:668.97px" class="cls_020"><span class="cls_020">respectively.</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-79</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:233382px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:138.78px;top:56.98px" class="cls_027"><span class="cls_027">Instr Fields</span></div>
<div style="position:absolute;left:82.03px;top:77.97px" class="cls_027"><span class="cls_027">op</span></div>
<div style="position:absolute;left:233.96px;top:77.97px" class="cls_027"><span class="cls_027">func</span></div>
<div style="position:absolute;left:268.84px;top:76.98px" class="cls_027"><span class="cls_027">Asm</span></div>
<div style="position:absolute;left:337.70px;top:76.98px" class="cls_027"><span class="cls_027">Description</span></div>
<div style="position:absolute;left:77.18px;top:99.67px" class="cls_076"><span class="cls_076">31-26</span></div>
<div style="position:absolute;left:108.56px;top:99.67px" class="cls_076"><span class="cls_076">25-21</span></div>
<div style="position:absolute;left:139.93px;top:99.67px" class="cls_076"><span class="cls_076">20-16</span></div>
<div style="position:absolute;left:171.31px;top:99.67px" class="cls_076"><span class="cls_076">15-11</span></div>
<div style="position:absolute;left:205.05px;top:99.67px" class="cls_076"><span class="cls_076">10-6</span></div>
<div style="position:absolute;left:238.79px;top:99.67px" class="cls_076"><span class="cls_076">5-0</span></div>
<div style="position:absolute;left:84.89px;top:116.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:116.00px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:116.00px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:177.09px;top:116.00px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:210.47px;top:116.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.05px;top:116.00px" class="cls_020"><span class="cls_020">32</span></div>
<div style="position:absolute;left:264.34px;top:116.00px" class="cls_020"><span class="cls_020">add</span></div>
<div style="position:absolute;left:301.90px;top:116.00px" class="cls_020"><span class="cls_020">3-operand add. The only</span></div>
<div style="position:absolute;left:301.53px;top:126.00px" class="cls_020"><span class="cls_020">difference between them is</span></div>
<div style="position:absolute;left:301.53px;top:136.00px" class="cls_020"><span class="cls_020">that </span><span class="cls_027">add</span><span class="cls_020"> causes a trap if a</span></div>
<div style="position:absolute;left:84.89px;top:144.49px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:144.49px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:144.49px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:177.09px;top:144.49px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:210.47px;top:144.49px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.05px;top:144.49px" class="cls_020"><span class="cls_020">33</span></div>
<div style="position:absolute;left:264.34px;top:144.49px" class="cls_020"><span class="cls_020">addu</span></div>
<div style="position:absolute;left:301.52px;top:146.00px" class="cls_020"><span class="cls_020">result overflows into bit 31,</span></div>
<div style="position:absolute;left:301.52px;top:156.00px" class="cls_020"><span class="cls_020">but </span><span class="cls_027">addu</span><span class="cls_020"> never traps.</span></div>
<div style="position:absolute;left:84.89px;top:173.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:173.00px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:173.00px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:177.09px;top:173.00px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:210.47px;top:173.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.05px;top:173.00px" class="cls_020"><span class="cls_020">34</span></div>
<div style="position:absolute;left:264.34px;top:173.00px" class="cls_020"><span class="cls_020">sub</span></div>
<div style="position:absolute;left:301.90px;top:173.00px" class="cls_020"><span class="cls_020">3-operand subtract. </span><span class="cls_027">sub</span></div>
<div style="position:absolute;left:301.53px;top:183.00px" class="cls_020"><span class="cls_020">can trap on overflow, </span><span class="cls_027">subu</span></div>
<div style="position:absolute;left:84.89px;top:191.49px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:191.49px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:191.49px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:177.09px;top:191.49px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:210.47px;top:191.49px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.05px;top:191.49px" class="cls_020"><span class="cls_020">35</span></div>
<div style="position:absolute;left:264.34px;top:191.49px" class="cls_020"><span class="cls_020">subu</span></div>
<div style="position:absolute;left:301.53px;top:192.99px" class="cls_020"><span class="cls_020">won’t.</span></div>
<div style="position:absolute;left:84.89px;top:210.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:210.00px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:210.00px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:177.09px;top:210.00px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:210.47px;top:210.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.05px;top:210.00px" class="cls_020"><span class="cls_020">36</span></div>
<div style="position:absolute;left:264.34px;top:210.00px" class="cls_020"><span class="cls_020">and</span></div>
<div style="position:absolute;left:84.89px;top:227.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:227.00px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:227.00px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:177.09px;top:227.00px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:210.47px;top:227.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.05px;top:227.00px" class="cls_020"><span class="cls_020">37</span></div>
<div style="position:absolute;left:264.34px;top:227.00px" class="cls_020"><span class="cls_020">or</span></div>
<div style="position:absolute;left:301.53px;top:230.50px" class="cls_020"><span class="cls_020">3-operand bitwise logical</span></div>
<div style="position:absolute;left:301.53px;top:240.50px" class="cls_020"><span class="cls_020">operations</span></div>
<div style="position:absolute;left:84.89px;top:244.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:244.00px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:244.00px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:177.09px;top:244.00px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:210.47px;top:244.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.05px;top:244.00px" class="cls_020"><span class="cls_020">38</span></div>
<div style="position:absolute;left:264.34px;top:244.00px" class="cls_020"><span class="cls_020">xor</span></div>
<div style="position:absolute;left:84.89px;top:261.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:261.00px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:261.00px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:177.09px;top:261.00px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:210.47px;top:261.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.05px;top:261.00px" class="cls_020"><span class="cls_020">39</span></div>
<div style="position:absolute;left:264.34px;top:261.00px" class="cls_020"><span class="cls_020">nor</span></div>
<div style="position:absolute;left:84.89px;top:278.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:278.00px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:278.00px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:177.09px;top:278.00px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:210.47px;top:278.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.05px;top:278.00px" class="cls_020"><span class="cls_020">42</span></div>
<div style="position:absolute;left:264.34px;top:278.00px" class="cls_020"><span class="cls_020">slt</span></div>
<div style="position:absolute;left:301.88px;top:278.00px" class="cls_020"><span class="cls_020">Set destination to 1 if rs1</span></div>
<div style="position:absolute;left:301.53px;top:288.00px" class="cls_020"><span class="cls_020">&lt;rs2, set destination to zero</span></div>
<div style="position:absolute;left:301.53px;top:298.00px" class="cls_020"><span class="cls_020">otherwise. </span><span class="cls_027">slt</span><span class="cls_020"> uses signed</span></div>
<div style="position:absolute;left:84.89px;top:306.49px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:111.96px;top:306.49px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:306.49px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:177.09px;top:306.49px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:210.47px;top:306.49px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.05px;top:306.49px" class="cls_020"><span class="cls_020">43</span></div>
<div style="position:absolute;left:264.34px;top:306.49px" class="cls_020"><span class="cls_020">sltu</span></div>
<div style="position:absolute;left:301.53px;top:308.00px" class="cls_020"><span class="cls_020">comparision, and </span><span class="cls_027">sltu</span></div>
<div style="position:absolute;left:301.53px;top:318.00px" class="cls_027"><span class="cls_027">unsigned.</span></div>
<div style="position:absolute;left:76.00px;top:335.00px" class="cls_020"><span class="cls_020">‘‘PC-relative’’ test and branch</span></div>
<div style="position:absolute;left:84.89px;top:352.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:114.75px;top:352.00px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:147.66px;top:352.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:201.29px;top:352.00px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.27px;top:352.00px" class="cls_020"><span class="cls_020">bltz</span></div>
<div style="position:absolute;left:301.83px;top:352.00px" class="cls_020"><span class="cls_020">branch if rs1 &lt;0 (top bit set)</span></div>
<div style="position:absolute;left:84.89px;top:369.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:114.75px;top:369.00px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:147.66px;top:369.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:201.29px;top:369.00px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.27px;top:369.00px" class="cls_020"><span class="cls_020">bgez</span></div>
<div style="position:absolute;left:301.85px;top:369.00px" class="cls_020"><span class="cls_020">branch if rs1 >= 0</span></div>
<div style="position:absolute;left:84.89px;top:386.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:114.75px;top:386.00px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:144.88px;top:386.00px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:201.31px;top:386.00px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.29px;top:386.00px" class="cls_020"><span class="cls_020">bltzal</span></div>
<div style="position:absolute;left:301.88px;top:386.00px" class="cls_020"><span class="cls_020">if rs1 &lt;0 or rs1 >= 0</span></div>
<div style="position:absolute;left:301.53px;top:396.00px" class="cls_020"><span class="cls_020">respectively, branch to</span></div>
<div style="position:absolute;left:301.53px;top:406.00px" class="cls_020"><span class="cls_020">function. Set </span><span class="cls_027">ra</span><span class="cls_020"> to the</span></div>
<div style="position:absolute;left:301.53px;top:416.00px" class="cls_020"><span class="cls_020">notional ‘‘return’’ address,</span></div>
<div style="position:absolute;left:84.89px;top:419.50px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:114.75px;top:419.50px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:144.88px;top:419.50px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:201.31px;top:419.50px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.29px;top:419.50px" class="cls_020"><span class="cls_020">bgezal</span></div>
<div style="position:absolute;left:301.53px;top:426.00px" class="cls_020"><span class="cls_020">even if the branch is not</span></div>
<div style="position:absolute;left:301.53px;top:435.99px" class="cls_020"><span class="cls_020">taken.</span></div>
<div style="position:absolute;left:76.00px;top:453.00px" class="cls_020"><span class="cls_020">Long ‘‘in-region’’ jump and call</span></div>
<div style="position:absolute;left:301.53px;top:470.00px" class="cls_020"><span class="cls_020">unconditional jump (26-bit</span></div>
<div style="position:absolute;left:301.53px;top:480.00px" class="cls_020"><span class="cls_020">word address). Note that the</span></div>
<div style="position:absolute;left:301.53px;top:489.99px" class="cls_020"><span class="cls_020">top 4 bits of the program</span></div>
<div style="position:absolute;left:301.53px;top:499.99px" class="cls_020"><span class="cls_020">address of the target</span></div>
<div style="position:absolute;left:301.53px;top:509.99px" class="cls_020"><span class="cls_020">location comes from the</span></div>
<div style="position:absolute;left:84.89px;top:515.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:152.37px;top:515.00px" class="cls_020"><span class="cls_020">word address</span></div>
<div style="position:absolute;left:264.33px;top:515.00px" class="cls_020"><span class="cls_020">j</span></div>
<div style="position:absolute;left:301.53px;top:519.99px" class="cls_020"><span class="cls_020">instruction’s own location.</span></div>
<div style="position:absolute;left:301.53px;top:529.99px" class="cls_020"><span class="cls_020">You have to use a </span><span class="cls_027">jr</span><span class="cls_020"> (jump</span></div>
<div style="position:absolute;left:301.53px;top:539.99px" class="cls_020"><span class="cls_020">register) instruction to</span></div>
<div style="position:absolute;left:301.53px;top:549.99px" class="cls_020"><span class="cls_020">reach outside of your</span></div>
<div style="position:absolute;left:301.53px;top:559.99px" class="cls_020"><span class="cls_020">256Mbyte region.</span></div>
<div style="position:absolute;left:301.53px;top:576.98px" class="cls_020"><span class="cls_020">function call (26-bit word</span></div>
<div style="position:absolute;left:84.89px;top:581.98px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:152.37px;top:581.98px" class="cls_020"><span class="cls_020">word address</span></div>
<div style="position:absolute;left:264.33px;top:581.98px" class="cls_020"><span class="cls_020">jal</span></div>
<div style="position:absolute;left:301.53px;top:586.98px" class="cls_020"><span class="cls_020">address)</span></div>
<div style="position:absolute;left:76.00px;top:603.98px" class="cls_020"><span class="cls_020">Compare and branch instructions</span></div>
<div style="position:absolute;left:84.89px;top:620.98px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:111.96px;top:620.98px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:620.98px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:201.34px;top:620.98px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.33px;top:620.98px" class="cls_020"><span class="cls_020">beq</span></div>
<div style="position:absolute;left:301.88px;top:620.98px" class="cls_020"><span class="cls_020">branch if rs1 == rs2</span></div>
<div style="position:absolute;left:84.89px;top:637.98px" class="cls_020"><span class="cls_020">5</span></div>
<div style="position:absolute;left:111.96px;top:637.98px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.37px;top:637.98px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:201.34px;top:637.98px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.33px;top:637.98px" class="cls_020"><span class="cls_020">bne</span></div>
<div style="position:absolute;left:301.88px;top:637.98px" class="cls_020"><span class="cls_020">branch if rs1 != rs2</span></div>
<div style="position:absolute;left:84.89px;top:654.98px" class="cls_020"><span class="cls_020">6</span></div>
<div style="position:absolute;left:111.96px;top:654.98px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:147.68px;top:654.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:201.31px;top:654.98px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.29px;top:654.98px" class="cls_020"><span class="cls_020">blez</span></div>
<div style="position:absolute;left:301.86px;top:654.98px" class="cls_020"><span class="cls_020">branch if rs1 &lt;= 0 or rs1 > 0</span></div>
<div style="position:absolute;left:301.53px;top:664.98px" class="cls_020"><span class="cls_020">respectively. Encoded as if</span></div>
<div style="position:absolute;left:301.53px;top:674.98px" class="cls_020"><span class="cls_020">they had two source</span></div>
<div style="position:absolute;left:84.89px;top:683.48px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:111.96px;top:683.48px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:147.68px;top:683.48px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:201.31px;top:683.48px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.29px;top:683.48px" class="cls_020"><span class="cls_020">bgtz</span></div>
<div style="position:absolute;left:301.53px;top:684.98px" class="cls_020"><span class="cls_020">operands with rs2 selecting</span></div>
<div style="position:absolute;left:301.53px;top:694.98px" class="cls_027"><span class="cls_027">zero.</span></div>
<div style="position:absolute;left:76.00px;top:711.98px" class="cls_020"><span class="cls_020">‘‘Immediate’’ arithmetic and logical instructions</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-80</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:234184px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:520.67px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:138.77px;top:56.97px" class="cls_027"><span class="cls_027">Instr Fields</span></div>
<div style="position:absolute;left:82.02px;top:77.97px" class="cls_027"><span class="cls_027">op</span></div>
<div style="position:absolute;left:233.95px;top:77.97px" class="cls_027"><span class="cls_027">func</span></div>
<div style="position:absolute;left:268.83px;top:76.97px" class="cls_027"><span class="cls_027">Asm</span></div>
<div style="position:absolute;left:337.69px;top:76.97px" class="cls_027"><span class="cls_027">Description</span></div>
<div style="position:absolute;left:77.18px;top:99.67px" class="cls_076"><span class="cls_076">31-26</span></div>
<div style="position:absolute;left:108.56px;top:99.67px" class="cls_076"><span class="cls_076">25-21</span></div>
<div style="position:absolute;left:139.93px;top:99.67px" class="cls_076"><span class="cls_076">20-16</span></div>
<div style="position:absolute;left:171.31px;top:99.67px" class="cls_076"><span class="cls_076">15-11</span></div>
<div style="position:absolute;left:205.05px;top:99.67px" class="cls_076"><span class="cls_076">10-6</span></div>
<div style="position:absolute;left:238.79px;top:99.67px" class="cls_076"><span class="cls_076">5-0</span></div>
<div style="position:absolute;left:84.89px;top:116.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:114.75px;top:116.00px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:145.66px;top:116.00px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:178.49px;top:116.00px" class="cls_020"><span class="cls_020">signed constant</span></div>
<div style="position:absolute;left:264.48px;top:116.00px" class="cls_020"><span class="cls_020">addi</span></div>
<div style="position:absolute;left:302.05px;top:116.00px" class="cls_020"><span class="cls_020">Arithmetic operations with</span></div>
<div style="position:absolute;left:301.53px;top:126.00px" class="cls_020"><span class="cls_020">one source register, a 16-bit</span></div>
<div style="position:absolute;left:84.89px;top:132.99px" class="cls_020"><span class="cls_020">9</span></div>
<div style="position:absolute;left:114.75px;top:132.99px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:145.66px;top:132.99px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:178.49px;top:132.99px" class="cls_020"><span class="cls_020">signed constant</span></div>
<div style="position:absolute;left:264.48px;top:132.99px" class="cls_020"><span class="cls_020">addiu</span></div>
<div style="position:absolute;left:301.53px;top:136.00px" class="cls_020"><span class="cls_020">signed constant, and a</span></div>
<div style="position:absolute;left:301.53px;top:146.00px" class="cls_020"><span class="cls_020">separate destination. As for</span></div>
<div style="position:absolute;left:82.11px;top:149.99px" class="cls_020"><span class="cls_020">10</span></div>
<div style="position:absolute;left:114.76px;top:149.99px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:145.68px;top:149.99px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:178.51px;top:149.99px" class="cls_020"><span class="cls_020">signed constant</span></div>
<div style="position:absolute;left:264.50px;top:149.99px" class="cls_020"><span class="cls_020">subi</span></div>
<div style="position:absolute;left:301.53px;top:156.00px" class="cls_020"><span class="cls_020">3-operand arithmetic, the</span></div>
<div style="position:absolute;left:301.53px;top:165.99px" class="cls_020"><span class="cls_020">unsigned forms </span><span class="cls_027">addiu</span><span class="cls_020"> and</span></div>
<div style="position:absolute;left:301.53px;top:175.99px" class="cls_027"><span class="cls_027">subiu</span><span class="cls_020"> have identical results</span></div>
<div style="position:absolute;left:301.53px;top:185.99px" class="cls_020"><span class="cls_020">but never cause an overflow</span></div>
<div style="position:absolute;left:82.11px;top:196.50px" class="cls_020"><span class="cls_020">11</span></div>
<div style="position:absolute;left:114.76px;top:196.50px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:145.68px;top:196.50px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:178.51px;top:196.50px" class="cls_020"><span class="cls_020">signed constant</span></div>
<div style="position:absolute;left:264.50px;top:196.50px" class="cls_020"><span class="cls_020">subiu</span></div>
<div style="position:absolute;left:301.53px;top:195.99px" class="cls_020"><span class="cls_020">trap.</span></div>
<div style="position:absolute;left:301.53px;top:205.99px" class="cls_020"><span class="cls_020">Note that ‘‘load immediate</span></div>
<div style="position:absolute;left:301.53px;top:215.99px" class="cls_020"><span class="cls_020">signed’’ can be synthesised</span></div>
<div style="position:absolute;left:301.53px;top:225.99px" class="cls_020"><span class="cls_020">as an </span><span class="cls_027">addi</span><span class="cls_020"> with register </span><span class="cls_027">zero.</span></div>
<div style="position:absolute;left:82.11px;top:243.00px" class="cls_020"><span class="cls_020">12</span></div>
<div style="position:absolute;left:114.76px;top:243.00px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:145.68px;top:243.00px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:172.51px;top:243.00px" class="cls_020"><span class="cls_020">unsigned constant</span></div>
<div style="position:absolute;left:264.55px;top:243.00px" class="cls_020"><span class="cls_020">andi</span></div>
<div style="position:absolute;left:302.13px;top:243.00px" class="cls_020"><span class="cls_020">Logical operation with 16-bit</span></div>
<div style="position:absolute;left:301.52px;top:253.00px" class="cls_020"><span class="cls_020">constant, zero-extended for</span></div>
<div style="position:absolute;left:82.10px;top:259.99px" class="cls_020"><span class="cls_020">13</span></div>
<div style="position:absolute;left:114.75px;top:259.99px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:145.67px;top:259.99px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:172.50px;top:259.99px" class="cls_020"><span class="cls_020">unsigned constant</span></div>
<div style="position:absolute;left:264.54px;top:259.99px" class="cls_020"><span class="cls_020">ori</span></div>
<div style="position:absolute;left:301.52px;top:263.00px" class="cls_020"><span class="cls_020">these instructions. ‘‘load</span></div>
<div style="position:absolute;left:301.52px;top:273.00px" class="cls_020"><span class="cls_020">immediate unsigned’’ is</span></div>
<div style="position:absolute;left:82.10px;top:284.99px" class="cls_020"><span class="cls_020">14</span></div>
<div style="position:absolute;left:114.75px;top:284.99px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:145.67px;top:284.99px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:172.50px;top:284.99px" class="cls_020"><span class="cls_020">unsigned constant</span></div>
<div style="position:absolute;left:264.54px;top:284.99px" class="cls_020"><span class="cls_020">xori</span></div>
<div style="position:absolute;left:301.52px;top:282.99px" class="cls_020"><span class="cls_020">synthesised with an </span><span class="cls_027">ori</span><span class="cls_020"> with</span></div>
<div style="position:absolute;left:301.52px;top:292.99px" class="cls_020"><span class="cls_020">register </span><span class="cls_027">zero.</span></div>
<div style="position:absolute;left:301.51px;top:309.98px" class="cls_020"><span class="cls_020">Load UPPER immediate (</span><span class="cls_027">not</span></div>
<div style="position:absolute;left:301.51px;top:319.98px" class="cls_020"><span class="cls_020">unsigned). The 16-bit</span></div>
<div style="position:absolute;left:301.51px;top:329.98px" class="cls_020"><span class="cls_020">constant is loaded into the</span></div>
<div style="position:absolute;left:301.51px;top:339.97px" class="cls_020"><span class="cls_020">high-order 16-bits of the</span></div>
<div style="position:absolute;left:301.51px;top:349.97px" class="cls_020"><span class="cls_020">register, and the low-order</span></div>
<div style="position:absolute;left:192.86px;top:354.99px" class="cls_020"><span class="cls_020">unsigned</span></div>
<div style="position:absolute;left:82.10px;top:359.99px" class="cls_020"><span class="cls_020">15</span></div>
<div style="position:absolute;left:116.53px;top:359.99px" class="cls_021"><span class="cls_021">×</span></div>
<div style="position:absolute;left:145.57px;top:359.99px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:264.04px;top:359.98px" class="cls_020"><span class="cls_020">lui</span></div>
<div style="position:absolute;left:301.51px;top:359.97px" class="cls_020"><span class="cls_020">bits cleared to zero.</span></div>
<div style="position:absolute;left:193.94px;top:364.98px" class="cls_020"><span class="cls_020">constant</span></div>
<div style="position:absolute;left:301.51px;top:369.97px" class="cls_020"><span class="cls_020">A ‘‘load immediate’’ with a</span></div>
<div style="position:absolute;left:301.51px;top:379.97px" class="cls_020"><span class="cls_020">value which won’t fit into 16</span></div>
<div style="position:absolute;left:301.51px;top:389.97px" class="cls_020"><span class="cls_020">bits is synthesised by a </span><span class="cls_027">lui</span></div>
<div style="position:absolute;left:301.51px;top:399.97px" class="cls_020"><span class="cls_020">followed by an </span><span class="cls_027">ori</span><span class="cls_020">, which fills</span></div>
<div style="position:absolute;left:301.51px;top:409.97px" class="cls_020"><span class="cls_020">in the low 16 bits.</span></div>
<div style="position:absolute;left:75.98px;top:426.97px" class="cls_020"><span class="cls_020">CPU control instructions (‘‘Co-processor zero’’)</span></div>
<div style="position:absolute;left:82.09px;top:443.97px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:116.28px;top:443.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:145.65px;top:443.97px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:177.17px;top:443.97px" class="cls_020"><span class="cls_020">cs</span></div>
<div style="position:absolute;left:226.10px;top:443.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:264.26px;top:443.97px" class="cls_020"><span class="cls_020">mfc0</span></div>
<div style="position:absolute;left:82.09px;top:460.97px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:116.28px;top:460.97px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:146.13px;top:460.97px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:176.71px;top:460.97px" class="cls_020"><span class="cls_020">cd</span></div>
<div style="position:absolute;left:226.09px;top:460.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:264.25px;top:460.97px" class="cls_020"><span class="cls_020">mtc0</span></div>
<div style="position:absolute;left:82.09px;top:477.97px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:116.28px;top:477.97px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:147.65px;top:477.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:201.28px;top:477.97px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.26px;top:477.97px" class="cls_020"><span class="cls_020">bc0f</span></div>
<div style="position:absolute;left:301.50px;top:490.47px" class="cls_020"><span class="cls_020">These instructions are</span></div>
<div style="position:absolute;left:82.09px;top:494.97px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:116.28px;top:494.97px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:147.65px;top:494.97px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:201.28px;top:494.97px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.26px;top:494.97px" class="cls_020"><span class="cls_020">bc0t</span></div>
<div style="position:absolute;left:301.50px;top:500.47px" class="cls_020"><span class="cls_020">described in the chapter</span></div>
<div style="position:absolute;left:82.09px;top:511.97px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:113.49px;top:511.97px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:179.01px;top:511.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:241.74px;top:511.97px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:264.22px;top:511.97px" class="cls_020"><span class="cls_020">tlbr</span></div>
<div style="position:absolute;left:301.50px;top:510.47px" class="cls_020"><span class="cls_020">‘‘System Software</span></div>
<div style="position:absolute;left:301.50px;top:520.47px" class="cls_020"><span class="cls_020">Considerations’’</span></div>
<div style="position:absolute;left:82.09px;top:528.97px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:113.49px;top:528.97px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:179.01px;top:528.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:241.74px;top:528.97px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:264.22px;top:528.97px" class="cls_020"><span class="cls_020">tlbwi</span></div>
<div style="position:absolute;left:82.09px;top:545.97px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:113.49px;top:545.97px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:179.01px;top:545.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:241.74px;top:545.97px" class="cls_020"><span class="cls_020">6</span></div>
<div style="position:absolute;left:264.22px;top:545.97px" class="cls_020"><span class="cls_020">tlbwr</span></div>
<div style="position:absolute;left:82.09px;top:562.98px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:113.49px;top:562.98px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:179.01px;top:562.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:241.74px;top:562.98px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:264.22px;top:562.98px" class="cls_020"><span class="cls_020">tlbp</span></div>
<div style="position:absolute;left:82.09px;top:579.98px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:113.49px;top:579.98px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:179.01px;top:579.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:238.95px;top:579.98px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:264.24px;top:579.98px" class="cls_020"><span class="cls_020">rfe</span></div>
<div style="position:absolute;left:75.98px;top:596.98px" class="cls_020"><span class="cls_020">Floating point instructions (except load/store)</span></div>
<div style="position:absolute;left:107.33px;top:613.98px" class="cls_020"><span class="cls_020">Functions of these are detailed in the chapter ‘‘FLOATING POINT CO-</span></div>
<div style="position:absolute;left:82.10px;top:623.98px" class="cls_020"><span class="cls_020">25</span></div>
<div style="position:absolute;left:107.33px;top:623.98px" class="cls_020"><span class="cls_020">PROCESSOR’’ above. Their encodings are detailed in the appendix ‘‘FP</span></div>
<div style="position:absolute;left:107.33px;top:633.98px" class="cls_020"><span class="cls_020">Instruction encoding’’, below.</span></div>
<div style="position:absolute;left:75.99px;top:650.98px" class="cls_020"><span class="cls_020">Load and store instructions</span></div>
<div style="position:absolute;left:82.11px;top:667.98px" class="cls_020"><span class="cls_020">32</span></div>
<div style="position:absolute;left:114.76px;top:667.98px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:145.68px;top:667.98px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:201.32px;top:667.98px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.31px;top:667.98px" class="cls_020"><span class="cls_020">lb</span></div>
<div style="position:absolute;left:301.84px;top:667.98px" class="cls_020"><span class="cls_020">Load byte and sign-extend</span></div>
<div style="position:absolute;left:301.52px;top:684.97px" class="cls_020"><span class="cls_020">Load halfword and sign-</span></div>
<div style="position:absolute;left:82.11px;top:689.97px" class="cls_020"><span class="cls_020">33</span></div>
<div style="position:absolute;left:114.76px;top:689.97px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:145.68px;top:689.97px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:201.32px;top:689.97px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.31px;top:689.97px" class="cls_020"><span class="cls_020">lh</span></div>
<div style="position:absolute;left:301.52px;top:694.97px" class="cls_020"><span class="cls_020">extend</span></div>
<div style="position:absolute;left:302.54px;top:755.34px" class="cls_002"><span class="cls_002">A-81</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:234986px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX A</span></div>
<div style="position:absolute;left:388.91px;top:28.00px" class="cls_002"><span class="cls_002">MACHINE INSTRUCTIONS REFERENCE</span></div>
<div style="position:absolute;left:138.78px;top:56.99px" class="cls_027"><span class="cls_027">Instr Fields</span></div>
<div style="position:absolute;left:82.02px;top:77.99px" class="cls_027"><span class="cls_027">op</span></div>
<div style="position:absolute;left:233.95px;top:77.99px" class="cls_027"><span class="cls_027">func</span></div>
<div style="position:absolute;left:268.84px;top:76.99px" class="cls_027"><span class="cls_027">Asm</span></div>
<div style="position:absolute;left:337.70px;top:76.99px" class="cls_027"><span class="cls_027">Description</span></div>
<div style="position:absolute;left:77.18px;top:99.67px" class="cls_076"><span class="cls_076">31-26</span></div>
<div style="position:absolute;left:108.56px;top:99.67px" class="cls_076"><span class="cls_076">25-21</span></div>
<div style="position:absolute;left:139.93px;top:99.67px" class="cls_076"><span class="cls_076">20-16</span></div>
<div style="position:absolute;left:171.31px;top:99.67px" class="cls_076"><span class="cls_076">15-11</span></div>
<div style="position:absolute;left:205.05px;top:99.67px" class="cls_076"><span class="cls_076">10-6</span></div>
<div style="position:absolute;left:238.79px;top:99.67px" class="cls_076"><span class="cls_076">5-0</span></div>
<div style="position:absolute;left:301.52px;top:116.00px" class="cls_020"><span class="cls_020">‘‘Load word left’’, see section</span></div>
<div style="position:absolute;left:82.11px;top:126.00px" class="cls_020"><span class="cls_020">34</span></div>
<div style="position:absolute;left:114.77px;top:126.00px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:145.68px;top:126.00px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:201.32px;top:126.00px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.30px;top:126.00px" class="cls_020"><span class="cls_020">lwl</span></div>
<div style="position:absolute;left:301.52px;top:126.00px" class="cls_020"><span class="cls_020">on ‘‘Unaligned loads and</span></div>
<div style="position:absolute;left:301.52px;top:136.00px" class="cls_020"><span class="cls_020">stores’’</span></div>
<div style="position:absolute;left:82.11px;top:153.00px" class="cls_020"><span class="cls_020">35</span></div>
<div style="position:absolute;left:114.77px;top:153.00px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:145.66px;top:153.00px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:201.30px;top:153.00px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.28px;top:153.00px" class="cls_020"><span class="cls_020">lw</span></div>
<div style="position:absolute;left:301.81px;top:153.00px" class="cls_020"><span class="cls_020">load word</span></div>
<div style="position:absolute;left:82.11px;top:170.00px" class="cls_020"><span class="cls_020">36</span></div>
<div style="position:absolute;left:114.77px;top:170.00px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:145.68px;top:170.00px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:201.33px;top:170.00px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.31px;top:170.00px" class="cls_020"><span class="cls_020">lbu</span></div>
<div style="position:absolute;left:301.86px;top:170.00px" class="cls_020"><span class="cls_020">Load byte and zero-extend</span></div>
<div style="position:absolute;left:301.52px;top:186.99px" class="cls_020"><span class="cls_020">Load halfword and zero-</span></div>
<div style="position:absolute;left:82.11px;top:192.00px" class="cls_020"><span class="cls_020">37</span></div>
<div style="position:absolute;left:114.77px;top:192.00px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:145.68px;top:192.00px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:201.33px;top:192.00px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.31px;top:192.00px" class="cls_020"><span class="cls_020">lhu</span></div>
<div style="position:absolute;left:301.52px;top:196.99px" class="cls_020"><span class="cls_020">extend</span></div>
<div style="position:absolute;left:301.52px;top:213.99px" class="cls_020"><span class="cls_020">‘‘Load word right’’, see</span></div>
<div style="position:absolute;left:82.11px;top:223.99px" class="cls_020"><span class="cls_020">38</span></div>
<div style="position:absolute;left:114.77px;top:223.99px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:145.68px;top:223.99px" class="cls_020"><span class="cls_020">rd</span></div>
<div style="position:absolute;left:201.33px;top:223.99px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.31px;top:223.99px" class="cls_020"><span class="cls_020">lwr</span></div>
<div style="position:absolute;left:301.52px;top:223.99px" class="cls_020"><span class="cls_020">section on ‘‘Unaligned loads</span></div>
<div style="position:absolute;left:301.52px;top:233.99px" class="cls_020"><span class="cls_020">and stores’’</span></div>
<div style="position:absolute;left:82.11px;top:250.99px" class="cls_020"><span class="cls_020">40</span></div>
<div style="position:absolute;left:111.99px;top:250.99px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.40px;top:250.99px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:201.37px;top:250.99px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.36px;top:250.99px" class="cls_020"><span class="cls_020">sb</span></div>
<div style="position:absolute;left:301.89px;top:250.99px" class="cls_020"><span class="cls_020">store byte</span></div>
<div style="position:absolute;left:82.11px;top:267.99px" class="cls_020"><span class="cls_020">41</span></div>
<div style="position:absolute;left:111.99px;top:267.99px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.40px;top:267.99px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:201.37px;top:267.99px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.36px;top:267.99px" class="cls_020"><span class="cls_020">sh</span></div>
<div style="position:absolute;left:301.89px;top:267.99px" class="cls_020"><span class="cls_020">store halfword</span></div>
<div style="position:absolute;left:301.52px;top:284.99px" class="cls_020"><span class="cls_020">‘‘Store word left’’, see section</span></div>
<div style="position:absolute;left:82.11px;top:294.99px" class="cls_020"><span class="cls_020">42</span></div>
<div style="position:absolute;left:111.99px;top:294.99px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.40px;top:294.99px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:201.37px;top:294.99px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.36px;top:294.99px" class="cls_020"><span class="cls_020">swl</span></div>
<div style="position:absolute;left:301.52px;top:294.99px" class="cls_020"><span class="cls_020">on ‘‘Unaligned loads and</span></div>
<div style="position:absolute;left:301.52px;top:304.99px" class="cls_020"><span class="cls_020">stores’’</span></div>
<div style="position:absolute;left:82.11px;top:321.99px" class="cls_020"><span class="cls_020">43</span></div>
<div style="position:absolute;left:111.99px;top:321.99px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.40px;top:321.99px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:201.37px;top:321.99px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.36px;top:321.99px" class="cls_020"><span class="cls_020">sw</span></div>
<div style="position:absolute;left:301.89px;top:321.99px" class="cls_020"><span class="cls_020">store word</span></div>
<div style="position:absolute;left:301.52px;top:338.99px" class="cls_020"><span class="cls_020">‘‘Store word right’’, see</span></div>
<div style="position:absolute;left:82.11px;top:348.99px" class="cls_020"><span class="cls_020">46</span></div>
<div style="position:absolute;left:111.99px;top:348.99px" class="cls_020"><span class="cls_020">rs1</span></div>
<div style="position:absolute;left:143.40px;top:348.99px" class="cls_020"><span class="cls_020">rs2</span></div>
<div style="position:absolute;left:201.37px;top:348.99px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.36px;top:348.99px" class="cls_020"><span class="cls_020">swr</span></div>
<div style="position:absolute;left:301.52px;top:348.99px" class="cls_020"><span class="cls_020">section on ‘‘Unaligned loads</span></div>
<div style="position:absolute;left:301.52px;top:358.99px" class="cls_020"><span class="cls_020">and stores’’</span></div>
<div style="position:absolute;left:301.52px;top:375.98px" class="cls_020"><span class="cls_020">Store word from FP register</span></div>
<div style="position:absolute;left:82.11px;top:380.99px" class="cls_020"><span class="cls_020">49</span></div>
<div style="position:absolute;left:114.77px;top:380.99px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:146.70px;top:380.99px" class="cls_020"><span class="cls_020">fs</span></div>
<div style="position:absolute;left:201.32px;top:380.99px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.30px;top:380.99px" class="cls_020"><span class="cls_020">swc1</span></div>
<div style="position:absolute;left:301.52px;top:385.98px" class="cls_020"><span class="cls_020">fs</span></div>
<div style="position:absolute;left:82.11px;top:402.98px" class="cls_020"><span class="cls_020">57</span></div>
<div style="position:absolute;left:114.77px;top:402.98px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:146.25px;top:402.98px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:201.32px;top:402.98px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.30px;top:402.98px" class="cls_020"><span class="cls_020">lwc1</span></div>
<div style="position:absolute;left:301.88px;top:402.98px" class="cls_020"><span class="cls_020">Load word into FP register fd</span></div>
<div style="position:absolute;left:288.79px;top:755.34px" class="cls_002"><span class="cls_002">A-82</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:235788px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">FPA INSTRUCTION</span></div>
<div style="position:absolute;left:486.77px;top:42.00px" class="cls_015"><span class="cls_015">APPENDIX B</span></div>
<div style="position:absolute;left:222.89px;top:56.33px" class="cls_005"><span class="cls_005">REFERENCE</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:216.00px;top:113.00px" class="cls_015"><span class="cls_015">FPU Instruction Set Details</span></div>
<div style="position:absolute;left:228.02px;top:126.67px" class="cls_006"><span class="cls_006">This section documents the instructions for the floating-point unit (FPU)</span></div>
<div style="position:absolute;left:216.00px;top:137.67px" class="cls_006"><span class="cls_006">in MIPS processors. It contains some descriptive material at the beginning,</span></div>
<div style="position:absolute;left:216.00px;top:148.67px" class="cls_006"><span class="cls_006">a detailed description for each instruction in alphabetic order, and an</span></div>
<div style="position:absolute;left:216.00px;top:159.67px" class="cls_006"><span class="cls_006">instruction opcode encoding table at the end of the section.</span></div>
<div style="position:absolute;left:228.02px;top:170.67px" class="cls_006"><span class="cls_006">The descriptive material describes the FPU instruction categories, the</span></div>
<div style="position:absolute;left:216.00px;top:181.67px" class="cls_006"><span class="cls_006">instruction encoding formats, the valid operands for FPU computational</span></div>
<div style="position:absolute;left:216.00px;top:192.67px" class="cls_006"><span class="cls_006">instructions, compare and condition values, FPU use of the coprocessor</span></div>
<div style="position:absolute;left:216.00px;top:203.67px" class="cls_006"><span class="cls_006">registers, and a description of the notation used for the detailed instruction</span></div>
<div style="position:absolute;left:216.00px;top:214.67px" class="cls_006"><span class="cls_006">description.</span></div>
<div style="position:absolute;left:230.45px;top:225.67px" class="cls_006"><span class="cls_006">This section does not describe the operation of floating-point arithmetic,</span></div>
<div style="position:absolute;left:216.00px;top:236.67px" class="cls_006"><span class="cls_006">the exception conditions within FP arithmetic, the exception mechanism of</span></div>
<div style="position:absolute;left:216.00px;top:247.67px" class="cls_006"><span class="cls_006">the FPU, or the handling of these FP exceptions.</span></div>
<div style="position:absolute;left:216.00px;top:268.67px" class="cls_006"><span class="cls_006">FPU Instructions</span></div>
<div style="position:absolute;left:228.02px;top:279.67px" class="cls_006"><span class="cls_006">The floating-point unit (FPU) is implemented as Coprocessor unit 1</span></div>
<div style="position:absolute;left:216.00px;top:290.67px" class="cls_006"><span class="cls_006">(CP1) within the MIPS architecture.  A floating-point instruction needs</span></div>
<div style="position:absolute;left:216.00px;top:301.67px" class="cls_006"><span class="cls_006">access to coprocessor 1 to execute; if CP1 is not enabled, an FP instruction</span></div>
<div style="position:absolute;left:216.00px;top:312.67px" class="cls_006"><span class="cls_006">will cause a Coprocessor Unusable exception.  The FPU has a load/store</span></div>
<div style="position:absolute;left:216.00px;top:323.67px" class="cls_006"><span class="cls_006">architecture.  All computations are done on data held in registers, and data</span></div>
<div style="position:absolute;left:216.00px;top:334.67px" class="cls_006"><span class="cls_006">is transferred between registers and the rest of the system with dedicated</span></div>
<div style="position:absolute;left:216.00px;top:345.67px" class="cls_006"><span class="cls_006">load, store, and move instructions.</span></div>
<div style="position:absolute;left:228.02px;top:356.67px" class="cls_006"><span class="cls_006">The FPU instructions fall into the following categories:</span></div>
<div style="position:absolute;left:228.02px;top:370.67px" class="cls_006"><span class="cls_006">• Data Transfer</span></div>
<div style="position:absolute;left:228.02px;top:384.67px" class="cls_006"><span class="cls_006">• Conversion</span></div>
<div style="position:absolute;left:228.02px;top:398.67px" class="cls_006"><span class="cls_006">• Arithmetic</span></div>
<div style="position:absolute;left:228.02px;top:412.67px" class="cls_006"><span class="cls_006">• Register-to-Register Data Movement</span></div>
<div style="position:absolute;left:228.02px;top:426.67px" class="cls_006"><span class="cls_006">• Branch</span></div>
<div style="position:absolute;left:216.00px;top:447.67px" class="cls_006"><span class="cls_006">Floating-Point Data Transfer</span></div>
<div style="position:absolute;left:228.02px;top:458.67px" class="cls_006"><span class="cls_006">All movement of data between the floating-point coprocessor general</span></div>
<div style="position:absolute;left:216.00px;top:469.67px" class="cls_006"><span class="cls_006">registers and the rest of the system is accomplished by:</span></div>
<div style="position:absolute;left:228.02px;top:483.67px" class="cls_006"><span class="cls_006">• Load memory to CP1 general register</span></div>
<div style="position:absolute;left:228.02px;top:497.67px" class="cls_006"><span class="cls_006">• Store CP1 general register to memory</span></div>
<div style="position:absolute;left:228.02px;top:511.67px" class="cls_006"><span class="cls_006">• Move CPU register to CP1 general register</span></div>
<div style="position:absolute;left:228.02px;top:525.67px" class="cls_006"><span class="cls_006">• Move CP1 general register to CPU register</span></div>
<div style="position:absolute;left:228.02px;top:536.67px" class="cls_006"><span class="cls_006">These operations are unformatted; no format conversions are performed</span></div>
<div style="position:absolute;left:216.00px;top:547.67px" class="cls_006"><span class="cls_006">and, therefore, no floating-point exceptions can occur.</span></div>
<div style="position:absolute;left:228.02px;top:558.67px" class="cls_006"><span class="cls_006">The coprocessor also contains floating-point control registers.  The only</span></div>
<div style="position:absolute;left:216.00px;top:569.67px" class="cls_006"><span class="cls_006">data movement operations supported for them are:</span></div>
<div style="position:absolute;left:228.02px;top:583.67px" class="cls_006"><span class="cls_006">• Copy CPU register to FPU control register</span></div>
<div style="position:absolute;left:228.02px;top:597.67px" class="cls_006"><span class="cls_006">• Copy FPU control register to CPU register</span></div>
<div style="position:absolute;left:216.00px;top:618.67px" class="cls_006"><span class="cls_006">Floating-Point Conversions</span></div>
<div style="position:absolute;left:228.02px;top:629.67px" class="cls_006"><span class="cls_006">The floating-point unit has instructions to convert among the operand</span></div>
<div style="position:absolute;left:216.00px;top:640.67px" class="cls_006"><span class="cls_006">types as well as operations which combine conversion with rounding using</span></div>
<div style="position:absolute;left:216.00px;top:651.67px" class="cls_006"><span class="cls_006">a particular rounding mode.  The conversion operations are:</span></div>
<div style="position:absolute;left:228.02px;top:665.67px" class="cls_006"><span class="cls_006">• fixed-point to floating-point</span></div>
<div style="position:absolute;left:228.02px;top:679.67px" class="cls_006"><span class="cls_006">• floating to fixed</span></div>
<div style="position:absolute;left:228.02px;top:693.67px" class="cls_006"><span class="cls_006">• floating to floating (of another size)</span></div>
<div style="position:absolute;left:298.53px;top:754.68px" class="cls_002"><span class="cls_002">B-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:236590px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:420.78px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:36.00px;top:50.67px" class="cls_006"><span class="cls_006">Floating-Point Arithmetic</span></div>
<div style="position:absolute;left:48.02px;top:61.67px" class="cls_006"><span class="cls_006">The floating-point arithmetic instructions are:</span></div>
<div style="position:absolute;left:48.02px;top:75.67px" class="cls_006"><span class="cls_006">• add</span></div>
<div style="position:absolute;left:48.02px;top:89.67px" class="cls_006"><span class="cls_006">• subtract</span></div>
<div style="position:absolute;left:48.02px;top:103.67px" class="cls_006"><span class="cls_006">• multiply</span></div>
<div style="position:absolute;left:48.02px;top:117.67px" class="cls_006"><span class="cls_006">• divide</span></div>
<div style="position:absolute;left:48.02px;top:131.67px" class="cls_006"><span class="cls_006">• absolute value</span></div>
<div style="position:absolute;left:48.02px;top:145.67px" class="cls_006"><span class="cls_006">• negate</span></div>
<div style="position:absolute;left:48.02px;top:159.67px" class="cls_006"><span class="cls_006">• compare</span></div>
<div style="position:absolute;left:48.02px;top:170.67px" class="cls_006"><span class="cls_006">All   operations   satisfy   the   requirements   of   IEEE   Standard</span></div>
<div style="position:absolute;left:377.46px;top:170.67px" class="cls_006"><span class="cls_006">754</span></div>
<div style="position:absolute;left:36.00px;top:181.67px" class="cls_006"><span class="cls_006">requirements for accuracy; a result which is identical to an infinite-</span></div>
<div style="position:absolute;left:36.00px;top:192.67px" class="cls_006"><span class="cls_006">precision  result  rounded  to  the  specified  format,  using  the  current</span></div>
<div style="position:absolute;left:36.00px;top:203.67px" class="cls_006"><span class="cls_006">rounding mode.</span></div>
<div style="position:absolute;left:36.00px;top:224.67px" class="cls_006"><span class="cls_006">Floating-Point Register-to-Register Move</span></div>
<div style="position:absolute;left:48.02px;top:235.67px" class="cls_006"><span class="cls_006">There  are  FPU  instructions  to  move  formatted  operands  among</span></div>
<div style="position:absolute;left:36.00px;top:246.67px" class="cls_006"><span class="cls_006">registers:</span></div>
<div style="position:absolute;left:48.02px;top:260.67px" class="cls_006"><span class="cls_006">• FP move</span></div>
<div style="position:absolute;left:48.02px;top:274.67px" class="cls_006"><span class="cls_006">• FP register move-conditional on FP condition code</span></div>
<div style="position:absolute;left:48.02px;top:288.67px" class="cls_006"><span class="cls_006">• FP register move-conditional on CPU register value</span></div>
<div style="position:absolute;left:48.02px;top:302.67px" class="cls_006"><span class="cls_006">• CPU register move-conditional on FP condition code</span></div>
<div style="position:absolute;left:36.00px;top:323.67px" class="cls_006"><span class="cls_006">Floating-Point Branch</span></div>
<div style="position:absolute;left:48.02px;top:334.67px" class="cls_006"><span class="cls_006">The FP compare instruction produces a condition code.  The FPU has</span></div>
<div style="position:absolute;left:36.00px;top:345.67px" class="cls_006"><span class="cls_006">instructions to conditionally branch on the FP condition.</span></div>
<div style="position:absolute;left:36.00px;top:368.00px" class="cls_015"><span class="cls_015">FP Computational Instructions and Valid Operands</span></div>
<div style="position:absolute;left:48.02px;top:381.67px" class="cls_006"><span class="cls_006">The   Floating-point   unit   computational   instructions   operate   on</span></div>
<div style="position:absolute;left:36.00px;top:392.67px" class="cls_006"><span class="cls_006">structured data and the operands can have one of several operand </span><span class="cls_008">formats</span><span class="cls_006">.</span></div>
<div style="position:absolute;left:36.00px;top:403.67px" class="cls_006"><span class="cls_006">The format of the operands, and perhaps the result, for an instruction is</span></div>
<div style="position:absolute;left:36.00px;top:414.67px" class="cls_006"><span class="cls_006">specified by either the 5-bit </span><span class="cls_008">fmt</span><span class="cls_006"> field or 3-bit </span><span class="cls_008">fmt3</span><span class="cls_006"> field in the instruction</span></div>
<div style="position:absolute;left:36.00px;top:425.67px" class="cls_006"><span class="cls_006">encoding; decoding for these fields is shown in Table B.7.</span></div>
<div style="position:absolute;left:49.72px;top:445.67px" class="cls_077"><span class="cls_077">fmt</span></div>
<div style="position:absolute;left:90.22px;top:445.67px" class="cls_077"><span class="cls_077">fmt3</span></div>
<div style="position:absolute;left:128.39px;top:445.67px" class="cls_060"><span class="cls_060">Mnemonic</span></div>
<div style="position:absolute;left:208.65px;top:445.67px" class="cls_060"><span class="cls_060">Size</span></div>
<div style="position:absolute;left:300.81px;top:445.67px" class="cls_060"><span class="cls_060">Format</span></div>
<div style="position:absolute;left:50.83px;top:463.67px" class="cls_055"><span class="cls_055">0-15</span></div>
<div style="position:absolute;left:101.32px;top:463.67px" class="cls_055"><span class="cls_055">-</span></div>
<div style="position:absolute;left:233.66px;top:463.67px" class="cls_055"><span class="cls_055">Reserved</span></div>
<div style="position:absolute;left:54.99px;top:481.67px" class="cls_055"><span class="cls_055">16</span></div>
<div style="position:absolute;left:100.48px;top:481.67px" class="cls_055"><span class="cls_055">0</span></div>
<div style="position:absolute;left:150.47px;top:481.67px" class="cls_055"><span class="cls_055">S</span></div>
<div style="position:absolute;left:193.22px;top:481.67px" class="cls_055"><span class="cls_055">single</span></div>
<div style="position:absolute;left:261.50px;top:481.67px" class="cls_055"><span class="cls_055">Binary floating-point</span></div>
<div style="position:absolute;left:54.99px;top:499.67px" class="cls_055"><span class="cls_055">17</span></div>
<div style="position:absolute;left:100.48px;top:499.67px" class="cls_055"><span class="cls_055">1</span></div>
<div style="position:absolute;left:149.22px;top:499.67px" class="cls_055"><span class="cls_055">D</span></div>
<div style="position:absolute;left:193.21px;top:499.67px" class="cls_055"><span class="cls_055">double</span></div>
<div style="position:absolute;left:261.48px;top:499.67px" class="cls_055"><span class="cls_055">Binary floating-point</span></div>
<div style="position:absolute;left:132.81px;top:517.67px" class="cls_055"><span class="cls_055">Reserved</span></div>
<div style="position:absolute;left:261.47px;top:517.67px" class="cls_055"><span class="cls_055">Reserved for Extended</span></div>
<div style="position:absolute;left:54.99px;top:523.67px" class="cls_055"><span class="cls_055">18</span></div>
<div style="position:absolute;left:100.48px;top:523.67px" class="cls_055"><span class="cls_055">2</span></div>
<div style="position:absolute;left:193.21px;top:523.67px" class="cls_055"><span class="cls_055">extended</span></div>
<div style="position:absolute;left:142.42px;top:529.67px" class="cls_055"><span class="cls_055">for E</span></div>
<div style="position:absolute;left:261.47px;top:529.67px" class="cls_055"><span class="cls_055">binary floating-point</span></div>
<div style="position:absolute;left:133.84px;top:547.67px" class="cls_055"><span class="cls_055">Reserved</span></div>
<div style="position:absolute;left:261.47px;top:547.67px" class="cls_055"><span class="cls_055">Reserved for Quad binary</span></div>
<div style="position:absolute;left:54.98px;top:553.67px" class="cls_055"><span class="cls_055">19</span></div>
<div style="position:absolute;left:100.47px;top:553.67px" class="cls_055"><span class="cls_055">3</span></div>
<div style="position:absolute;left:193.21px;top:553.67px" class="cls_055"><span class="cls_055">quad</span></div>
<div style="position:absolute;left:142.79px;top:559.67px" class="cls_055"><span class="cls_055">for Q</span></div>
<div style="position:absolute;left:261.47px;top:559.67px" class="cls_055"><span class="cls_055">floating-point.</span></div>
<div style="position:absolute;left:54.98px;top:577.67px" class="cls_055"><span class="cls_055">20</span></div>
<div style="position:absolute;left:100.47px;top:577.67px" class="cls_055"><span class="cls_055">4</span></div>
<div style="position:absolute;left:148.09px;top:577.67px" class="cls_055"><span class="cls_055">W</span></div>
<div style="position:absolute;left:193.21px;top:577.67px" class="cls_055"><span class="cls_055">single</span></div>
<div style="position:absolute;left:261.49px;top:577.67px" class="cls_055"><span class="cls_055">32-bit binary fixed-point</span></div>
<div style="position:absolute;left:132.59px;top:595.67px" class="cls_055"><span class="cls_055">Reserved</span></div>
<div style="position:absolute;left:54.98px;top:601.67px" class="cls_055"><span class="cls_055">21</span></div>
<div style="position:absolute;left:100.47px;top:601.67px" class="cls_055"><span class="cls_055">5</span></div>
<div style="position:absolute;left:193.20px;top:601.67px" class="cls_055"><span class="cls_055">longword</span></div>
<div style="position:absolute;left:261.48px;top:601.67px" class="cls_055"><span class="cls_055">64-bit binary fixed-point</span></div>
<div style="position:absolute;left:142.41px;top:607.67px" class="cls_055"><span class="cls_055">for L</span></div>
<div style="position:absolute;left:47.47px;top:625.67px" class="cls_055"><span class="cls_055">22-31</span></div>
<div style="position:absolute;left:96.30px;top:625.67px" class="cls_055"><span class="cls_055">6-7</span></div>
<div style="position:absolute;left:231.14px;top:625.67px" class="cls_055"><span class="cls_055">Reserved</span></div>
<div style="position:absolute;left:129.00px;top:646.00px" class="cls_020"><span class="cls_020">Table B.7.  Format Field Decoding</span></div>
<div style="position:absolute;left:51.22px;top:661.67px" class="cls_006"><span class="cls_006">A particular operation is valid only for operands of certain formats.</span></div>
<div style="position:absolute;left:291.27px;top:755.33px" class="cls_002"><span class="cls_002">B-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:237392px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:521.04px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:216.00px;top:50.00px" class="cls_015"><span class="cls_015">FP Compare and Condition values</span></div>
<div style="position:absolute;left:228.02px;top:63.67px" class="cls_006"><span class="cls_006">The coprocessor branch on condition true/false instructions can be</span></div>
<div style="position:absolute;left:216.00px;top:74.67px" class="cls_006"><span class="cls_006">used to logically negate any predicate.  Thus, the 32 possible conditions</span></div>
<div style="position:absolute;left:216.00px;top:85.67px" class="cls_006"><span class="cls_006">require only 16 distinct comparisons, as shown below.</span></div>
<div style="position:absolute;left:224.26px;top:105.67px" class="cls_060"><span class="cls_060">Condition</span></div>
<div style="position:absolute;left:365.44px;top:105.67px" class="cls_060"><span class="cls_060">Compare Relations</span></div>
<div style="position:absolute;left:522.95px;top:105.67px" class="cls_060"><span class="cls_060">Invalid</span></div>
<div style="position:absolute;left:516.26px;top:117.67px" class="cls_060"><span class="cls_060">Operation</span></div>
<div style="position:absolute;left:187.42px;top:123.67px" class="cls_060"><span class="cls_060">Branch Mnemonic</span></div>
<div style="position:absolute;left:322.69px;top:126.67px" class="cls_060"><span class="cls_060">Greater</span></div>
<div style="position:absolute;left:376.08px;top:126.67px" class="cls_060"><span class="cls_060">Less</span></div>
<div style="position:absolute;left:453.40px;top:126.67px" class="cls_060"><span class="cls_060">Unordere</span></div>
<div style="position:absolute;left:511.95px;top:129.67px" class="cls_060"><span class="cls_060">Exception If</span></div>
<div style="position:absolute;left:285.13px;top:132.67px" class="cls_060"><span class="cls_060">Code</span></div>
<div style="position:absolute;left:413.91px;top:132.67px" class="cls_060"><span class="cls_060">Equal</span></div>
<div style="position:absolute;left:327.96px;top:138.67px" class="cls_060"><span class="cls_060">Than</span></div>
<div style="position:absolute;left:374.13px;top:138.67px" class="cls_060"><span class="cls_060">Than</span></div>
<div style="position:absolute;left:472.01px;top:138.67px" class="cls_060"><span class="cls_060">d</span></div>
<div style="position:absolute;left:193.90px;top:141.67px" class="cls_060"><span class="cls_060">True</span></div>
<div style="position:absolute;left:242.57px;top:141.67px" class="cls_060"><span class="cls_060">False</span></div>
<div style="position:absolute;left:514.86px;top:141.67px" class="cls_060"><span class="cls_060">Unordered</span></div>
<div style="position:absolute;left:188.98px;top:159.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:238.48px;top:159.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:297.06px;top:159.67px" class="cls_055"><span class="cls_055">0</span></div>
<div style="position:absolute;left:337.11px;top:159.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:383.28px;top:159.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:424.45px;top:159.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:472.28px;top:159.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:532.68px;top:159.67px" class="cls_055"><span class="cls_055">No</span></div>
<div style="position:absolute;left:188.98px;top:177.67px" class="cls_055"><span class="cls_055">UN</span></div>
<div style="position:absolute;left:238.48px;top:177.67px" class="cls_055"><span class="cls_055">OR</span></div>
<div style="position:absolute;left:297.06px;top:177.67px" class="cls_055"><span class="cls_055">1</span></div>
<div style="position:absolute;left:337.11px;top:177.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:383.28px;top:177.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:424.45px;top:177.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:472.00px;top:177.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:532.68px;top:177.67px" class="cls_055"><span class="cls_055">No</span></div>
<div style="position:absolute;left:188.98px;top:195.67px" class="cls_055"><span class="cls_055">EQ</span></div>
<div style="position:absolute;left:238.48px;top:195.67px" class="cls_055"><span class="cls_055">NEQ</span></div>
<div style="position:absolute;left:297.07px;top:195.67px" class="cls_055"><span class="cls_055">2</span></div>
<div style="position:absolute;left:337.12px;top:195.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:383.29px;top:195.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:424.17px;top:195.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:472.29px;top:195.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:532.69px;top:195.67px" class="cls_055"><span class="cls_055">No</span></div>
<div style="position:absolute;left:188.98px;top:213.67px" class="cls_055"><span class="cls_055">UEQ</span></div>
<div style="position:absolute;left:238.48px;top:213.67px" class="cls_055"><span class="cls_055">OGL</span></div>
<div style="position:absolute;left:297.07px;top:213.67px" class="cls_055"><span class="cls_055">3</span></div>
<div style="position:absolute;left:337.12px;top:213.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:383.29px;top:213.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:424.17px;top:213.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:472.01px;top:213.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:532.69px;top:213.67px" class="cls_055"><span class="cls_055">No</span></div>
<div style="position:absolute;left:188.98px;top:231.67px" class="cls_055"><span class="cls_055">OLT</span></div>
<div style="position:absolute;left:238.48px;top:231.67px" class="cls_055"><span class="cls_055">UGE</span></div>
<div style="position:absolute;left:297.07px;top:231.67px" class="cls_055"><span class="cls_055">4</span></div>
<div style="position:absolute;left:337.12px;top:231.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:383.00px;top:231.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:424.45px;top:231.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:472.28px;top:231.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:532.68px;top:231.67px" class="cls_055"><span class="cls_055">No</span></div>
<div style="position:absolute;left:188.98px;top:249.67px" class="cls_055"><span class="cls_055">ULT</span></div>
<div style="position:absolute;left:238.49px;top:249.67px" class="cls_055"><span class="cls_055">OGE</span></div>
<div style="position:absolute;left:297.08px;top:249.67px" class="cls_055"><span class="cls_055">5</span></div>
<div style="position:absolute;left:337.13px;top:249.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:383.01px;top:249.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:424.46px;top:249.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:472.01px;top:249.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:532.69px;top:249.67px" class="cls_055"><span class="cls_055">No</span></div>
<div style="position:absolute;left:188.98px;top:267.67px" class="cls_055"><span class="cls_055">OLE</span></div>
<div style="position:absolute;left:238.48px;top:267.67px" class="cls_055"><span class="cls_055">UGT</span></div>
<div style="position:absolute;left:297.07px;top:267.67px" class="cls_055"><span class="cls_055">6</span></div>
<div style="position:absolute;left:337.12px;top:267.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:383.00px;top:267.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:424.17px;top:267.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:472.29px;top:267.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:532.69px;top:267.67px" class="cls_055"><span class="cls_055">No</span></div>
<div style="position:absolute;left:188.98px;top:285.67px" class="cls_055"><span class="cls_055">ULE</span></div>
<div style="position:absolute;left:238.49px;top:285.67px" class="cls_055"><span class="cls_055">OGT</span></div>
<div style="position:absolute;left:297.08px;top:285.67px" class="cls_055"><span class="cls_055">7</span></div>
<div style="position:absolute;left:337.13px;top:285.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:383.01px;top:285.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:424.18px;top:285.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:472.01px;top:285.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:532.69px;top:285.67px" class="cls_055"><span class="cls_055">No</span></div>
<div style="position:absolute;left:188.98px;top:303.67px" class="cls_055"><span class="cls_055">SF</span></div>
<div style="position:absolute;left:238.48px;top:303.67px" class="cls_055"><span class="cls_055">ST</span></div>
<div style="position:absolute;left:297.07px;top:303.67px" class="cls_055"><span class="cls_055">8</span></div>
<div style="position:absolute;left:337.12px;top:303.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:383.29px;top:303.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:424.46px;top:303.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:472.29px;top:303.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:531.72px;top:303.67px" class="cls_055"><span class="cls_055">Yes</span></div>
<div style="position:absolute;left:188.98px;top:321.67px" class="cls_055"><span class="cls_055">NGLE</span></div>
<div style="position:absolute;left:238.49px;top:321.67px" class="cls_055"><span class="cls_055">GLE</span></div>
<div style="position:absolute;left:297.08px;top:321.67px" class="cls_055"><span class="cls_055">9</span></div>
<div style="position:absolute;left:337.13px;top:321.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:383.30px;top:321.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:424.47px;top:321.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:472.02px;top:321.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:531.74px;top:321.67px" class="cls_055"><span class="cls_055">Yes</span></div>
<div style="position:absolute;left:188.98px;top:339.67px" class="cls_055"><span class="cls_055">SEQ</span></div>
<div style="position:absolute;left:238.48px;top:339.67px" class="cls_055"><span class="cls_055">SNE</span></div>
<div style="position:absolute;left:292.07px;top:339.67px" class="cls_055"><span class="cls_055">10</span></div>
<div style="position:absolute;left:337.12px;top:339.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:383.29px;top:339.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:424.17px;top:339.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:472.29px;top:339.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:531.72px;top:339.67px" class="cls_055"><span class="cls_055">Yes</span></div>
<div style="position:absolute;left:188.98px;top:357.67px" class="cls_055"><span class="cls_055">NGL</span></div>
<div style="position:absolute;left:238.48px;top:357.67px" class="cls_055"><span class="cls_055">GL</span></div>
<div style="position:absolute;left:292.06px;top:357.67px" class="cls_055"><span class="cls_055">11</span></div>
<div style="position:absolute;left:337.11px;top:357.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:383.28px;top:357.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:424.16px;top:357.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:471.99px;top:357.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:531.71px;top:357.67px" class="cls_055"><span class="cls_055">Yes</span></div>
<div style="position:absolute;left:188.98px;top:375.67px" class="cls_055"><span class="cls_055">LT</span></div>
<div style="position:absolute;left:238.48px;top:375.67px" class="cls_055"><span class="cls_055">NLT</span></div>
<div style="position:absolute;left:292.07px;top:375.67px" class="cls_055"><span class="cls_055">12</span></div>
<div style="position:absolute;left:337.12px;top:375.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:383.00px;top:375.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:424.45px;top:375.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:472.28px;top:375.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:531.71px;top:375.67px" class="cls_055"><span class="cls_055">Yes</span></div>
<div style="position:absolute;left:188.98px;top:393.67px" class="cls_055"><span class="cls_055">NGE</span></div>
<div style="position:absolute;left:238.48px;top:393.67px" class="cls_055"><span class="cls_055">GE</span></div>
<div style="position:absolute;left:292.06px;top:393.67px" class="cls_055"><span class="cls_055">13</span></div>
<div style="position:absolute;left:337.11px;top:393.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:382.99px;top:393.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:424.44px;top:393.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:471.99px;top:393.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:531.71px;top:393.67px" class="cls_055"><span class="cls_055">Yes</span></div>
<div style="position:absolute;left:188.98px;top:411.67px" class="cls_055"><span class="cls_055">LE</span></div>
<div style="position:absolute;left:238.48px;top:411.67px" class="cls_055"><span class="cls_055">NLE</span></div>
<div style="position:absolute;left:292.07px;top:411.67px" class="cls_055"><span class="cls_055">14</span></div>
<div style="position:absolute;left:337.12px;top:411.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:383.00px;top:411.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:424.17px;top:411.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:472.29px;top:411.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:531.72px;top:411.67px" class="cls_055"><span class="cls_055">Yes</span></div>
<div style="position:absolute;left:188.98px;top:429.67px" class="cls_055"><span class="cls_055">NGT</span></div>
<div style="position:absolute;left:238.48px;top:429.67px" class="cls_055"><span class="cls_055">GT</span></div>
<div style="position:absolute;left:292.07px;top:429.67px" class="cls_055"><span class="cls_055">15</span></div>
<div style="position:absolute;left:337.12px;top:429.67px" class="cls_055"><span class="cls_055">F</span></div>
<div style="position:absolute;left:383.00px;top:429.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:424.17px;top:429.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:472.01px;top:429.67px" class="cls_055"><span class="cls_055">T</span></div>
<div style="position:absolute;left:531.73px;top:429.67px" class="cls_055"><span class="cls_055">Yes</span></div>
<div style="position:absolute;left:222.44px;top:450.00px" class="cls_020"><span class="cls_020">Table B.8.  Logical Negation of Predicates by Condition True/False</span></div>
<div style="position:absolute;left:216.00px;top:471.00px" class="cls_015"><span class="cls_015">FPU Register Specifiers</span></div>
<div style="position:absolute;left:228.02px;top:484.67px" class="cls_006"><span class="cls_006">The data transfer instructions and the computational instructions view</span></div>
<div style="position:absolute;left:216.00px;top:495.67px" class="cls_006"><span class="cls_006">the Coprocessor 1 general registers and the data in them in different ways.</span></div>
<div style="position:absolute;left:216.00px;top:506.67px" class="cls_006"><span class="cls_006">This section describes the general registers in the coprocessor, how data</span></div>
<div style="position:absolute;left:216.00px;top:517.67px" class="cls_006"><span class="cls_006">transfer instructions transfer operand data, how the FPU uses registers to</span></div>
<div style="position:absolute;left:216.00px;top:528.67px" class="cls_006"><span class="cls_006">hold  the  different  types  and  sizes  of  operands,  and  how  the  FPU</span></div>
<div style="position:absolute;left:216.00px;top:539.67px" class="cls_006"><span class="cls_006">computational instructions specify operands.</span></div>
<div style="position:absolute;left:228.02px;top:550.67px" class="cls_006"><span class="cls_006">The  CP1   register  is  the  fundamental  addressable  unit  in  the</span></div>
<div style="position:absolute;left:216.00px;top:561.67px" class="cls_006"><span class="cls_006">coprocessor.  All instructions that refer to the CP1 registers use the 32 CP1</span></div>
<div style="position:absolute;left:216.00px;top:572.67px" class="cls_006"><span class="cls_006">general register numbers as register specifiers in the instruction encoding.</span></div>
<div style="position:absolute;left:216.00px;top:583.67px" class="cls_006"><span class="cls_006">Some register numbers are not valid specifiers for some instructions; this</span></div>
<div style="position:absolute;left:216.00px;top:594.67px" class="cls_006"><span class="cls_006">is discussed below.</span></div>
<div style="position:absolute;left:228.02px;top:605.67px" class="cls_006"><span class="cls_006">The data transfer operations consist of memory load/store and move to/</span></div>
<div style="position:absolute;left:216.00px;top:616.67px" class="cls_006"><span class="cls_006">from CPU register instructions.  These instructions, with one exception</span></div>
<div style="position:absolute;left:216.00px;top:627.67px" class="cls_006"><span class="cls_006">noted below, transfer unformatted data to/from a single CP1 register.</span></div>
<div style="position:absolute;left:216.00px;top:638.67px" class="cls_006"><span class="cls_006">Most  of  the  transfer  instructions  are  the  generic  load/store/move</span></div>
<div style="position:absolute;left:216.00px;top:649.67px" class="cls_006"><span class="cls_006">instructions used with all coprocessors and they do not have any special</span></div>
<div style="position:absolute;left:216.00px;top:660.67px" class="cls_006"><span class="cls_006">operation for CP1.</span></div>
<div style="position:absolute;left:228.02px;top:671.67px" class="cls_006"><span class="cls_006">The FPU operates on operands of different lengths.  Some operands</span></div>
<div style="position:absolute;left:216.00px;top:682.67px" class="cls_006"><span class="cls_006">exceed   the   CP1   general   register   size,   so   the   FPU   computational</span></div>
<div style="position:absolute;left:216.00px;top:693.67px" class="cls_006"><span class="cls_006">instructions use the CP1 general registers in a structured way.  If the FPU</span></div>
<div style="position:absolute;left:216.00px;top:704.67px" class="cls_006"><span class="cls_006">operand exceeds the CP1 register size, a set of adjacent CP1 general</span></div>
<div style="position:absolute;left:216.00px;top:715.67px" class="cls_006"><span class="cls_006">registers are used to hold the data for the operand.  All multi-register</span></div>
<div style="position:absolute;left:305.03px;top:755.33px" class="cls_002"><span class="cls_002">B-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:238194px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:420.78px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:36.00px;top:50.67px" class="cls_006"><span class="cls_006">operands must be in “aligned” sets of registers;  an operand that requires</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_006"><span class="cls_006">two registers must be in an even register and the next-higher odd register.</span></div>
<div style="position:absolute;left:36.00px;top:72.67px" class="cls_006"><span class="cls_006">When the FPU operand is in a set of CP1 registers, the lowest-numbered</span></div>
<div style="position:absolute;left:36.00px;top:83.67px" class="cls_006"><span class="cls_006">register in the set is used as the FPU operand specifier or FPU register</span></div>
<div style="position:absolute;left:36.00px;top:94.67px" class="cls_006"><span class="cls_006">specifier in the instruction encoding.</span></div>
<div style="position:absolute;left:48.03px;top:105.67px" class="cls_006"><span class="cls_006">The sets of registers are structured in a big-endian order for both big</span></div>
<div style="position:absolute;left:36.01px;top:116.67px" class="cls_006"><span class="cls_006">and little endian processors.  The least-significant portion of the operand</span></div>
<div style="position:absolute;left:36.01px;top:127.67px" class="cls_006"><span class="cls_006">is put into the lowest-numbered CP1 register in the set, and the most-</span></div>
<div style="position:absolute;left:36.01px;top:138.67px" class="cls_006"><span class="cls_006">significant is put into the highest-numbered register.</span></div>
<div style="position:absolute;left:36.00px;top:161.00px" class="cls_015"><span class="cls_015">32-bit CP1 registers</span></div>
<div style="position:absolute;left:48.02px;top:174.67px" class="cls_006"><span class="cls_006">All 32-bit processors have 32-bit CP1 registers.  The 64-bit processors</span></div>
<div style="position:absolute;left:36.00px;top:185.67px" class="cls_006"><span class="cls_006">have a 32-bit-CP1-register emulation mode in which CP1 appears to</span></div>
<div style="position:absolute;left:36.00px;top:196.67px" class="cls_006"><span class="cls_006">possess 32-bit registers.  The primary FP data type is double floating-point,</span></div>
<div style="position:absolute;left:36.00px;top:207.67px" class="cls_006"><span class="cls_006">which requires 64 bits of register space.  For simplicity in implementation,</span></div>
<div style="position:absolute;left:36.00px;top:218.67px" class="cls_006"><span class="cls_006">the minimum FPU operand size is a doubleword in the CP1 register file.</span></div>
<div style="position:absolute;left:36.00px;top:229.67px" class="cls_006"><span class="cls_006">Operands of type word size (W and S), are placed into the low word of the</span></div>
<div style="position:absolute;left:36.00px;top:240.67px" class="cls_006"><span class="cls_006">doubleword.</span></div>
<div style="position:absolute;left:48.02px;top:251.67px" class="cls_006"><span class="cls_006">The MIPS I version of the architecture has only word load/store/move</span></div>
<div style="position:absolute;left:36.00px;top:262.67px" class="cls_006"><span class="cls_006">instructions.  To transfer anything but a W or S operand takes multiple</span></div>
<div style="position:absolute;left:36.00px;top:273.67px" class="cls_006"><span class="cls_006">instructions that each reference one of the 32-bit CP1 general registers.</span></div>
<div style="position:absolute;left:36.00px;top:284.67px" class="cls_006"><span class="cls_006">The load/store/move instructions use all the CP1 register numbers as</span></div>
<div style="position:absolute;left:36.00px;top:295.67px" class="cls_006"><span class="cls_006">specifiers because they do not refer to formatted FP operands.</span></div>
<div style="position:absolute;left:158.52px;top:328.23px" class="cls_054"><span class="cls_054">32-bit CP1 register use and significance by operand</span></div>
<div style="position:absolute;left:253.29px;top:339.23px" class="cls_054"><span class="cls_054">type</span></div>
<div style="position:absolute;left:195.70px;top:356.23px" class="cls_054"><span class="cls_054">W,S</span></div>
<div style="position:absolute;left:311.15px;top:356.23px" class="cls_054"><span class="cls_054">L, D</span></div>
<div style="position:absolute;left:158.13px;top:373.23px" class="cls_054"><span class="cls_054">unused /</span></div>
<div style="position:absolute;left:79.59px;top:378.73px" class="cls_054"><span class="cls_054">Valid specifiers</span></div>
<div style="position:absolute;left:224.24px;top:378.73px" class="cls_054"><span class="cls_054">data</span></div>
<div style="position:absolute;left:280.85px;top:378.73px" class="cls_054"><span class="cls_054">most</span></div>
<div style="position:absolute;left:338.70px;top:378.73px" class="cls_054"><span class="cls_054">least</span></div>
<div style="position:absolute;left:155.63px;top:384.23px" class="cls_054"><span class="cls_054">undefined</span></div>
<div style="position:absolute;left:107.34px;top:401.23px" class="cls_054"><span class="cls_054">0</span></div>
<div style="position:absolute;left:172.89px;top:401.23px" class="cls_054"><span class="cls_054">1</span></div>
<div style="position:absolute;left:230.49px;top:401.23px" class="cls_054"><span class="cls_054">0</span></div>
<div style="position:absolute;left:288.09px;top:401.23px" class="cls_054"><span class="cls_054">1</span></div>
<div style="position:absolute;left:345.70px;top:401.23px" class="cls_054"><span class="cls_054">0</span></div>
<div style="position:absolute;left:107.33px;top:418.23px" class="cls_054"><span class="cls_054">2</span></div>
<div style="position:absolute;left:172.89px;top:418.23px" class="cls_054"><span class="cls_054">3</span></div>
<div style="position:absolute;left:230.49px;top:418.23px" class="cls_054"><span class="cls_054">2</span></div>
<div style="position:absolute;left:288.09px;top:418.23px" class="cls_054"><span class="cls_054">3</span></div>
<div style="position:absolute;left:345.70px;top:418.23px" class="cls_054"><span class="cls_054">2</span></div>
<div style="position:absolute;left:107.33px;top:451.23px" class="cls_054"><span class="cls_054">4</span></div>
<div style="position:absolute;left:172.89px;top:451.23px" class="cls_054"><span class="cls_054">5</span></div>
<div style="position:absolute;left:230.49px;top:451.23px" class="cls_054"><span class="cls_054">4</span></div>
<div style="position:absolute;left:288.09px;top:451.23px" class="cls_054"><span class="cls_054">5</span></div>
<div style="position:absolute;left:345.70px;top:451.23px" class="cls_054"><span class="cls_054">4</span></div>
<div style="position:absolute;left:38.66px;top:475.00px" class="cls_020"><span class="cls_020">Table B.9.  Valid FP Operand Specifiers with 32-bit Coprocessor 1 Registers.</span></div>
<div style="position:absolute;left:291.27px;top:755.33px" class="cls_002"><span class="cls_002">B-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:238996px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:521.04px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:324.00px;top:50.67px" class="cls_006"><span class="cls_006">FPU Register Access for 32-bit CP1 Registers</span></div>
<div style="position:absolute;left:307.55px;top:67.97px" class="cls_053"><span class="cls_053">value &lt;-- ValueFPR(fpr, fmt)/* undefined for odd fpr */</span></div>
<div style="position:absolute;left:325.55px;top:81.07px" class="cls_053"><span class="cls_053">case fmt of</span></div>
<div style="position:absolute;left:343.55px;top:94.17px" class="cls_053"><span class="cls_053">S, W:</span></div>
<div style="position:absolute;left:361.55px;top:107.27px" class="cls_053"><span class="cls_053">value &lt;-- FGR[fpr+0]</span></div>
<div style="position:absolute;left:343.55px;top:120.37px" class="cls_053"><span class="cls_053">D:</span></div>
<div style="position:absolute;left:361.55px;top:133.47px" class="cls_053"><span class="cls_053">/* undefined for fpr not even */</span></div>
<div style="position:absolute;left:361.55px;top:146.57px" class="cls_053"><span class="cls_053">value &lt;-- FGR[fpr+1] || FGR[fpr+0]</span></div>
<div style="position:absolute;left:325.55px;top:159.67px" class="cls_053"><span class="cls_053">end</span></div>
<div style="position:absolute;left:307.55px;top:185.86px" class="cls_053"><span class="cls_053">StoreFPR(fpr, fmt, value):/* undefined for odd fpr */</span></div>
<div style="position:absolute;left:325.55px;top:198.96px" class="cls_053"><span class="cls_053">case fmt of</span></div>
<div style="position:absolute;left:343.55px;top:212.05px" class="cls_053"><span class="cls_053">S, W:</span></div>
<div style="position:absolute;left:361.55px;top:225.15px" class="cls_053"><span class="cls_053">FGR[fpr+1] &lt;-- undefined</span></div>
<div style="position:absolute;left:361.55px;top:238.25px" class="cls_053"><span class="cls_053">FGR[fpr+0] &lt;-- value</span></div>
<div style="position:absolute;left:343.55px;top:251.35px" class="cls_053"><span class="cls_053">D:</span></div>
<div style="position:absolute;left:361.55px;top:264.45px" class="cls_053"><span class="cls_053">FGR[fpr+1] &lt;-- value</span><span class="cls_061"><sub>63...32</sub></span></div>
<div style="position:absolute;left:361.55px;top:277.50px" class="cls_053"><span class="cls_053">FGR[fpr+0] &lt;-- value</span><span class="cls_061"><sub>31...0</sub></span></div>
<div style="position:absolute;left:325.55px;top:290.60px" class="cls_053"><span class="cls_053">end</span></div>
<div style="position:absolute;left:289.55px;top:316.79px" class="cls_006"><span class="cls_006">NOTE:  The notation “FGR[fpr]” is either the physical</span></div>
<div style="position:absolute;left:289.55px;top:327.79px" class="cls_006"><span class="cls_006">32-bit register or the logical 32-bit register for a 64-bit</span></div>
<div style="position:absolute;left:289.55px;top:338.79px" class="cls_006"><span class="cls_006">processor in 32-bit register emulation mode.  It does not</span></div>
<div style="position:absolute;left:289.55px;top:349.79px" class="cls_006"><span class="cls_006">imply a specific mechanism for the 32-bit register</span></div>
<div style="position:absolute;left:216.00px;top:370.41px" class="cls_006"><span class="cls_006">Instruction Notation Conventions</span></div>
<div style="position:absolute;left:228.02px;top:381.41px" class="cls_006"><span class="cls_006">For the FPU instruction detail documentation, all variable subfields in</span></div>
<div style="position:absolute;left:216.00px;top:392.41px" class="cls_006"><span class="cls_006">an instruction format (such as </span><span class="cls_008">fs, ft, immediate</span><span class="cls_006">, and so on) are shown in</span></div>
<div style="position:absolute;left:216.00px;top:403.41px" class="cls_006"><span class="cls_006">lower-case.  The instruction name (such as ADD, SUB, and so on) is shown</span></div>
<div style="position:absolute;left:216.00px;top:414.41px" class="cls_006"><span class="cls_006">in upper-case.</span></div>
<div style="position:absolute;left:228.02px;top:425.41px" class="cls_006"><span class="cls_006">For the sake of clarity, an alias may be used for a variable subfield in the</span></div>
<div style="position:absolute;left:216.00px;top:436.41px" class="cls_006"><span class="cls_006">formats of specific instructions.  For example, </span><span class="cls_008">rs = base </span><span class="cls_006">is used in the</span></div>
<div style="position:absolute;left:216.00px;top:447.41px" class="cls_006"><span class="cls_006">format for load and store instructions.  Such an alias is always lower case,</span></div>
<div style="position:absolute;left:216.00px;top:458.41px" class="cls_006"><span class="cls_006">since it refers to a variable subfield.</span></div>
<div style="position:absolute;left:228.02px;top:469.41px" class="cls_006"><span class="cls_006">In some instructions, the instruction subfields </span><span class="cls_008">op </span><span class="cls_006">and </span><span class="cls_008">function </span><span class="cls_006">can have</span></div>
<div style="position:absolute;left:216.00px;top:480.41px" class="cls_006"><span class="cls_006">constant 6-bit values.  When reference is made to these instructions,</span></div>
<div style="position:absolute;left:216.00px;top:491.41px" class="cls_006"><span class="cls_006">upper-case mnemonics are used.  For instance, in the floating-point ADD</span></div>
<div style="position:absolute;left:216.00px;top:502.41px" class="cls_006"><span class="cls_006">instruction we use </span><span class="cls_008">op </span><span class="cls_006">= COP1 and </span><span class="cls_008">function </span><span class="cls_006">= ADD.  In other cases, a single</span></div>
<div style="position:absolute;left:216.00px;top:513.41px" class="cls_006"><span class="cls_006">field has both fixed and variable subfields, so the name contains both</span></div>
<div style="position:absolute;left:216.00px;top:524.41px" class="cls_006"><span class="cls_006">upper and lower case characters.  Bit encodings for mnemonics are shown</span></div>
<div style="position:absolute;left:216.00px;top:535.41px" class="cls_006"><span class="cls_006">at the end of this section, and are also included with each individual</span></div>
<div style="position:absolute;left:216.00px;top:546.41px" class="cls_006"><span class="cls_006">instruction.</span></div>
<div style="position:absolute;left:228.02px;top:557.41px" class="cls_006"><span class="cls_006">The instruction description includes an </span><span class="cls_008">Operation</span><span class="cls_006"> section that describes</span></div>
<div style="position:absolute;left:216.00px;top:568.41px" class="cls_006"><span class="cls_006">the   operation   of   the   instruction   in   a   pseudocode   resembling   a</span></div>
<div style="position:absolute;left:216.00px;top:579.41px" class="cls_006"><span class="cls_006">programming language.</span></div>
<div style="position:absolute;left:228.02px;top:590.41px" class="cls_006"><span class="cls_006">In  the  instruction  description  examples  that  follow,  the </span><span class="cls_008">Operation</span></div>
<div style="position:absolute;left:216.00px;top:601.41px" class="cls_006"><span class="cls_006">section describes the operation performed by each instruction using a</span></div>
<div style="position:absolute;left:216.00px;top:612.41px" class="cls_006"><span class="cls_006">high-level language notation.</span></div>
<div style="position:absolute;left:305.03px;top:755.33px" class="cls_002"><span class="cls_002">B-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:239798px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:420.79px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:36.00px;top:50.00px" class="cls_015"><span class="cls_015">Load and Store Memory</span></div>
<div style="position:absolute;left:48.02px;top:63.67px" class="cls_006"><span class="cls_006">In the load and store operation descriptions, the functions listed below</span></div>
<div style="position:absolute;left:36.00px;top:74.67px" class="cls_006"><span class="cls_006">are used to summarize the handling of virtual addresses and physical</span></div>
<div style="position:absolute;left:36.00px;top:85.67px" class="cls_006"><span class="cls_006">memory.</span></div>
<div style="position:absolute;left:83.29px;top:105.67px" class="cls_060"><span class="cls_060">Function</span></div>
<div style="position:absolute;left:282.96px;top:105.67px" class="cls_060"><span class="cls_060">Meaning</span></div>
<div style="position:absolute;left:180.12px;top:123.67px" class="cls_055"><span class="cls_055">Determines the physical address given the virtual</span></div>
<div style="position:absolute;left:180.12px;top:135.67px" class="cls_055"><span class="cls_055">address.  The function fails and an exception is taken if</span></div>
<div style="position:absolute;left:44.99px;top:141.67px" class="cls_055"><span class="cls_055">AddressTranslation</span></div>
<div style="position:absolute;left:180.12px;top:147.67px" class="cls_055"><span class="cls_055">the required translation is not present in the TLB (“E”</span></div>
<div style="position:absolute;left:180.12px;top:159.67px" class="cls_055"><span class="cls_055">versions only).</span></div>
<div style="position:absolute;left:180.12px;top:177.67px" class="cls_055"><span class="cls_055">Uses the cache and main memory to find the contents of</span></div>
<div style="position:absolute;left:180.12px;top:189.67px" class="cls_055"><span class="cls_055">the word containing the specified physical address.  The</span></div>
<div style="position:absolute;left:180.12px;top:201.67px" class="cls_055"><span class="cls_055">low-order two bits of the address and the </span><span class="cls_058">Access Type</span><span class="cls_055"> field</span></div>
<div style="position:absolute;left:44.99px;top:213.67px" class="cls_055"><span class="cls_055">LoadMemory</span></div>
<div style="position:absolute;left:180.12px;top:213.67px" class="cls_055"><span class="cls_055">indicates which of each of the four bytes within the data</span></div>
<div style="position:absolute;left:180.12px;top:225.67px" class="cls_055"><span class="cls_055">word need to be returned.  If the cache is enabled for this</span></div>
<div style="position:absolute;left:180.12px;top:237.67px" class="cls_055"><span class="cls_055">access, the entire word is returned and loaded into the</span></div>
<div style="position:absolute;left:180.12px;top:249.67px" class="cls_055"><span class="cls_055">cache.</span></div>
<div style="position:absolute;left:180.12px;top:267.67px" class="cls_055"><span class="cls_055">Uses the cache, write buffer, and main memory to store</span></div>
<div style="position:absolute;left:180.12px;top:279.67px" class="cls_055"><span class="cls_055">the word or part of word specified as data in the word</span></div>
<div style="position:absolute;left:180.12px;top:291.67px" class="cls_055"><span class="cls_055">containing the specified physical address.  The low-order</span></div>
<div style="position:absolute;left:44.99px;top:297.67px" class="cls_055"><span class="cls_055">StoreMemory</span></div>
<div style="position:absolute;left:180.12px;top:303.67px" class="cls_055"><span class="cls_055">two bits of the address and the </span><span class="cls_058">Access Type</span><span class="cls_055"> field indicates</span></div>
<div style="position:absolute;left:180.13px;top:315.67px" class="cls_055"><span class="cls_055">which of each of the four bytes within the data word</span></div>
<div style="position:absolute;left:180.13px;top:327.67px" class="cls_055"><span class="cls_055">should be stored.</span></div>
<div style="position:absolute;left:124.23px;top:348.00px" class="cls_020"><span class="cls_020">Table B.10.  Load and Store Common Functions</span></div>
<div style="position:absolute;left:48.02px;top:363.67px" class="cls_006"><span class="cls_006">All coprocessor loads and stores reference aligned-word data items.</span></div>
<div style="position:absolute;left:36.00px;top:374.67px" class="cls_006"><span class="cls_006">Thus, for word loads and stores, the access type field is always WORD, and</span></div>
<div style="position:absolute;left:36.00px;top:385.67px" class="cls_006"><span class="cls_006">the low-order two bits of the address must always be zero.</span></div>
<div style="position:absolute;left:48.02px;top:407.67px" class="cls_006"><span class="cls_006">Regardless of byte-numbering order (endianness), the address specifies</span></div>
<div style="position:absolute;left:36.00px;top:418.67px" class="cls_006"><span class="cls_006">that byte which has the smallest byte-address in the addressed field.  For</span></div>
<div style="position:absolute;left:36.00px;top:429.67px" class="cls_006"><span class="cls_006">a big-endian machine, this is the leftmost byte; for a little-endian machine,</span></div>
<div style="position:absolute;left:36.00px;top:440.67px" class="cls_006"><span class="cls_006">this is the rightmost byte.</span></div>
<div style="position:absolute;left:36.00px;top:463.00px" class="cls_015"><span class="cls_015">Instruction Descriptions</span></div>
<div style="position:absolute;left:48.02px;top:476.67px" class="cls_006"><span class="cls_006">The FP instructions are described in detail in alphabetic order.  Each</span></div>
<div style="position:absolute;left:36.00px;top:487.67px" class="cls_006"><span class="cls_006">page contains the following information for the instruction:</span></div>
<div style="position:absolute;left:48.02px;top:501.67px" class="cls_006"><span class="cls_006">• Instruction mnemonic and name</span></div>
<div style="position:absolute;left:48.02px;top:515.67px" class="cls_006"><span class="cls_006">• Assembler format</span></div>
<div style="position:absolute;left:48.02px;top:529.67px" class="cls_006"><span class="cls_006">• Description of the instruction</span></div>
<div style="position:absolute;left:48.02px;top:543.67px" class="cls_006"><span class="cls_006">• Operation of the instruction described in pseudocode.</span></div>
<div style="position:absolute;left:48.02px;top:557.67px" class="cls_006"><span class="cls_006">• Exceptions that the instruction can cause</span></div>
<div style="position:absolute;left:48.02px;top:571.67px" class="cls_006"><span class="cls_006">• FP exception conditions that the instruction can cause (as Floating-</span></div>
<div style="position:absolute;left:59.97px;top:582.67px" class="cls_006"><span class="cls_006">Point Exceptions)</span></div>
<div style="position:absolute;left:291.28px;top:755.33px" class="cls_002"><span class="cls_002">B-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:240600px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:521.04px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:258.96px;top:61.93px" class="cls_064"><span class="cls_064">Floating-Point</span></div>
<div style="position:absolute;left:99.61px;top:59.83px" class="cls_063"><span class="cls_063">ABS.fmt</span></div>
<div style="position:absolute;left:409.26px;top:59.83px" class="cls_063"><span class="cls_063">ABS.fmt</span></div>
<div style="position:absolute;left:255.45px;top:79.76px" class="cls_064"><span class="cls_064">Absolute Value</span></div>
<div style="position:absolute;left:117.99px;top:104.03px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:176.32px;top:104.03px" class="cls_053"><span class="cls_053">26 25</span></div>
<div style="position:absolute;left:233.19px;top:104.03px" class="cls_053"><span class="cls_053">21</span></div>
<div style="position:absolute;left:252.07px;top:104.03px" class="cls_053"><span class="cls_053">20</span></div>
<div style="position:absolute;left:290.02px;top:104.03px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:308.96px;top:104.03px" class="cls_053"><span class="cls_053">15</span></div>
<div style="position:absolute;left:347.81px;top:104.03px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:366.76px;top:104.03px" class="cls_053"><span class="cls_053">10</span></div>
<div style="position:absolute;left:407.64px;top:104.03px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:420.60px;top:104.03px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:487.97px;top:104.03px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:138.88px;top:128.08px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:209.85px;top:128.08px" class="cls_053"><span class="cls_053">fmt</span></div>
<div style="position:absolute;left:272.84px;top:128.08px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:327.67px;top:128.08px" class="cls_053"><span class="cls_053">fs</span></div>
<div style="position:absolute;left:384.27px;top:128.08px" class="cls_053"><span class="cls_053">fd</span></div>
<div style="position:absolute;left:445.68px;top:128.08px" class="cls_053"><span class="cls_053">ABS</span></div>
<div style="position:absolute;left:128.29px;top:140.53px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:254.37px;top:140.53px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:430.79px;top:140.53px" class="cls_053"><span class="cls_053">0 0 0 1 0 1</span></div>
<div style="position:absolute;left:150.65px;top:154.94px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.89px;top:154.94px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:272.84px;top:154.94px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:330.66px;top:154.94px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:386.61px;top:154.94px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:452.92px;top:154.94px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:178.43px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:199.77px" class="cls_055"><span class="cls_055">ABS.fmt  fd, fs</span></div>
<div style="position:absolute;left:72.00px;top:220.43px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:238.77px" class="cls_058"><span class="cls_058">fd </span><span class="cls_003">←</span><span class="cls_058"> |fs|</span></div>
<div style="position:absolute;left:108.00px;top:257.77px" class="cls_055"><span class="cls_055">The contents of the FPU register specified by </span><span class="cls_058">fs </span><span class="cls_055">are interpreted in the specified format and the</span></div>
<div style="position:absolute;left:108.00px;top:270.77px" class="cls_055"><span class="cls_055">arithmetic absolute value is taken.  The result is placed in the floating-point register specified by </span><span class="cls_058">fd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:289.77px" class="cls_055"><span class="cls_055">The absolute value operation is arithmetic; a NaN operand signals invalid operation.</span></div>
<div style="position:absolute;left:108.00px;top:308.77px" class="cls_055"><span class="cls_055">This instruction is valid only for single- and double-precision floating-point formats.</span></div>
<div style="position:absolute;left:108.00px;top:327.77px" class="cls_055"><span class="cls_055">The fields </span><span class="cls_058">fs</span><span class="cls_055"> and </span><span class="cls_058">fd</span><span class="cls_055"> must specify valid operand registers for the type </span><span class="cls_058">fmt</span><span class="cls_055"> and the logical size of</span></div>
<div style="position:absolute;left:108.00px;top:340.77px" class="cls_055"><span class="cls_055">coprocessor 1 general registers.  If they are not valid specifiers, the result  is undefined.</span></div>
<div style="position:absolute;left:72.00px;top:361.43px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:108.34px;top:390.06px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:137.14px;top:390.06px" class="cls_053"><span class="cls_053">StoreFPR(fd, fmt, AbsoluteValue(ValueFPR(fs, fmt)))</span></div>
<div style="position:absolute;left:72.00px;top:426.84px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:445.17px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:108.00px;top:458.17px" class="cls_055"><span class="cls_055">Coprocessor exception trap</span></div>
<div style="position:absolute;left:72.00px;top:478.84px" class="cls_066"><span class="cls_066">Floating-Point Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:497.17px" class="cls_055"><span class="cls_055">Unimplemented operation exception</span></div>
<div style="position:absolute;left:108.00px;top:510.17px" class="cls_055"><span class="cls_055">Invalid operation exception</span></div>
<div style="position:absolute;left:305.03px;top:755.33px" class="cls_002"><span class="cls_002">B-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:241402px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:420.78px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:243.08px;top:67.59px" class="cls_064"><span class="cls_064">Floating-Point Add</span></div>
<div style="position:absolute;left:106.66px;top:60.70px" class="cls_063"><span class="cls_063">ADD.fmt</span></div>
<div style="position:absolute;left:398.99px;top:60.70px" class="cls_063"><span class="cls_063">ADD.fmt</span></div>
<div style="position:absolute;left:118.57px;top:103.02px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:176.68px;top:103.02px" class="cls_053"><span class="cls_053">26 25</span></div>
<div style="position:absolute;left:233.41px;top:103.02px" class="cls_053"><span class="cls_053">21</span></div>
<div style="position:absolute;left:252.28px;top:103.02px" class="cls_053"><span class="cls_053">20</span></div>
<div style="position:absolute;left:290.09px;top:103.02px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:309.03px;top:103.02px" class="cls_053"><span class="cls_053">15</span></div>
<div style="position:absolute;left:347.74px;top:103.02px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:366.61px;top:103.02px" class="cls_053"><span class="cls_053">10</span></div>
<div style="position:absolute;left:408.00px;top:103.02px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:420.96px;top:103.02px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:487.54px;top:103.02px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:139.31px;top:127.07px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:212.44px;top:127.07px" class="cls_053"><span class="cls_053">fmt</span></div>
<div style="position:absolute;left:272.99px;top:127.07px" class="cls_053"><span class="cls_053">ft</span></div>
<div style="position:absolute;left:327.67px;top:127.07px" class="cls_053"><span class="cls_053">fs</span></div>
<div style="position:absolute;left:384.13px;top:127.07px" class="cls_053"><span class="cls_053">fd</span></div>
<div style="position:absolute;left:444.85px;top:127.07px" class="cls_053"><span class="cls_053">ADD</span></div>
<div style="position:absolute;left:129.30px;top:139.52px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:432.51px;top:139.52px" class="cls_053"><span class="cls_053">0 0 0 0 0 0</span></div>
<div style="position:absolute;left:151.08px;top:153.93px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:219.48px;top:153.93px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:272.98px;top:153.93px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:330.65px;top:153.93px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:386.46px;top:153.93px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:452.63px;top:153.93px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:177.23px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:198.57px" class="cls_055"><span class="cls_055">ADD.fmt fd, fs, ft</span></div>
<div style="position:absolute;left:72.00px;top:219.23px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:237.57px" class="cls_058"><span class="cls_058">fd </span><span class="cls_003">←</span><span class="cls_058"> fs + ft</span></div>
<div style="position:absolute;left:108.00px;top:256.57px" class="cls_055"><span class="cls_055">The contents of the FPU registers specified by </span><span class="cls_058">fs </span><span class="cls_055">and </span><span class="cls_058">ft </span><span class="cls_055">are interpreted in the specified format and</span></div>
<div style="position:absolute;left:108.00px;top:269.57px" class="cls_055"><span class="cls_055">arithmetically added.  The result is rounded as if calculated to infinite precision and then rounded</span></div>
<div style="position:absolute;left:108.00px;top:282.57px" class="cls_055"><span class="cls_055">to the specified format (</span><span class="cls_058">fmt</span><span class="cls_055">), according to the current rounding mode.  The result is placed in the</span></div>
<div style="position:absolute;left:108.00px;top:295.57px" class="cls_055"><span class="cls_055">floating-point register (</span><span class="cls_058">FPR</span><span class="cls_055">) specified by </span><span class="cls_058">fd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.01px;top:314.57px" class="cls_055"><span class="cls_055">The fields </span><span class="cls_058">fs</span><span class="cls_055">, </span><span class="cls_058">ft</span><span class="cls_055">, and </span><span class="cls_058">fd</span><span class="cls_055"> must specify valid operand registers, given the logical size of coprocessor 1</span></div>
<div style="position:absolute;left:108.01px;top:327.57px" class="cls_055"><span class="cls_055">general registers, for the type </span><span class="cls_058">fmt</span><span class="cls_055">.  If they are not valid specifiers, the result  is undefined.</span></div>
<div style="position:absolute;left:72.00px;top:348.23px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:108.12px;top:375.97px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:136.92px;top:375.97px" class="cls_053"><span class="cls_053">StoreFPR (fd, fmt, ValueFPR(fs, fmt) + ValueFPR(ft, fmt))</span></div>
<div style="position:absolute;left:72.00px;top:406.01px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:424.33px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:108.00px;top:437.33px" class="cls_055"><span class="cls_055">Floating-Point exception</span></div>
<div style="position:absolute;left:72.00px;top:458.00px" class="cls_066"><span class="cls_066">Floating-Point Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:476.33px" class="cls_055"><span class="cls_055">Unimplemented operation exception</span></div>
<div style="position:absolute;left:108.00px;top:489.33px" class="cls_055"><span class="cls_055">Invalid operation exception</span></div>
<div style="position:absolute;left:108.00px;top:502.33px" class="cls_055"><span class="cls_055">Inexact exception</span></div>
<div style="position:absolute;left:108.00px;top:515.33px" class="cls_055"><span class="cls_055">Overflow exception</span></div>
<div style="position:absolute;left:108.00px;top:528.33px" class="cls_055"><span class="cls_055">Underflow exception</span></div>
<div style="position:absolute;left:291.27px;top:755.33px" class="cls_002"><span class="cls_002">B-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:242204px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:49.99px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:521.04px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:203.37px;top:64.94px" class="cls_064"><span class="cls_064">Branch On Floating-Point False</span></div>
<div style="position:absolute;left:104.40px;top:60.90px" class="cls_063"><span class="cls_063">BC1F</span></div>
<div style="position:absolute;left:439.71px;top:62.03px" class="cls_063"><span class="cls_063">BC1F</span></div>
<div style="position:absolute;left:116.64px;top:104.56px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.87px;top:104.56px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:233.42px;top:101.25px" class="cls_053"><span class="cls_053">21  20 18  </span><span class="cls_061"><sup>76</sup></span></div>
<div style="position:absolute;left:305.11px;top:104.56px" class="cls_053"><span class="cls_053">15</span></div>
<div style="position:absolute;left:489.31px;top:104.57px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:137.95px;top:124.52px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:209.42px;top:124.52px" class="cls_053"><span class="cls_053">BC</span></div>
<div style="position:absolute;left:280.92px;top:125.46px" class="cls_078"><span class="cls_078">nd</span></div>
<div style="position:absolute;left:293.67px;top:125.03px" class="cls_053"><span class="cls_053">tf</span></div>
<div style="position:absolute;left:257.96px;top:129.79px" class="cls_053"><span class="cls_053">cc</span></div>
<div style="position:absolute;left:379.81px;top:127.61px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:127.94px;top:138.28px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:196.92px;top:138.28px" class="cls_053"><span class="cls_053">0 1 0 0 0</span></div>
<div style="position:absolute;left:282.74px;top:138.28px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:293.67px;top:138.29px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:148.78px;top:152.59px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:214.20px;top:152.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:260.18px;top:152.64px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:282.70px;top:152.64px" class="cls_053"><span class="cls_053">1 1</span></div>
<div style="position:absolute;left:390.96px;top:152.59px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:174.02px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.35px" class="cls_055"><span class="cls_055">BC1F  offset</span></div>
<div style="position:absolute;left:342.01px;top:195.35px" class="cls_055"><span class="cls_055">(cc=0)</span></div>
<div style="position:absolute;left:72.00px;top:216.02px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.35px" class="cls_055"><span class="cls_055">A branch target address is computed from the sum of the address of the instruction in the delay</span></div>
<div style="position:absolute;left:108.00px;top:247.35px" class="cls_055"><span class="cls_055">slot, and the 16-bit </span><span class="cls_058">offset</span><span class="cls_055">, shifted left two bits and sign-extended.  If the contents of the floating point</span></div>
<div style="position:absolute;left:108.00px;top:260.35px" class="cls_055"><span class="cls_055">condition code specified by </span><span class="cls_058">cc</span><span class="cls_055"> are zero (equal to the value of the tf field),  the target address is</span></div>
<div style="position:absolute;left:108.00px;top:273.35px" class="cls_055"><span class="cls_055">branched to with a delay of one instruction.</span></div>
<div style="position:absolute;left:108.00px;top:292.35px" class="cls_055"><span class="cls_055">The condition codes are set by the floating-point compare instruction.</span></div>
<div style="position:absolute;left:108.00px;top:311.35px" class="cls_055"><span class="cls_055">MIPS I specifies a single floating-point condition that is available as the coprocessor 1 condition</span></div>
<div style="position:absolute;left:108.00px;top:324.35px" class="cls_055"><span class="cls_055">signal (Cp1Cond) and the C bit in the FP </span><span class="cls_058">Control and Status</span><span class="cls_055"> register.  This instruction always tests</span></div>
<div style="position:absolute;left:108.00px;top:337.35px" class="cls_055"><span class="cls_055">the Cp1Cond signal.  The first assembler format instruction shown, with an implied </span><span class="cls_058">cc</span><span class="cls_055"> field of zero,</span></div>
<div style="position:absolute;left:108.00px;top:350.35px" class="cls_055"><span class="cls_055">is the only form allowed for processors that implement the MIPS I instruction.</span></div>
<div style="position:absolute;left:108.00px;top:369.35px" class="cls_055"><span class="cls_055">This instruction has a scheduling restriction.  The condition information is sampled during the</span></div>
<div style="position:absolute;left:108.00px;top:382.35px" class="cls_055"><span class="cls_055">preceding instruction and there must be at least one instruction between this branch instruction</span></div>
<div style="position:absolute;left:108.00px;top:395.35px" class="cls_055"><span class="cls_055">and the compare instruction that changes the condition code.  Hardware does not enforce this</span></div>
<div style="position:absolute;left:108.00px;top:408.35px" class="cls_055"><span class="cls_055">restriction.</span></div>
<div style="position:absolute;left:72.00px;top:429.02px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:162.18px;top:462.30px" class="cls_053"><span class="cls_053">MIPS I has a single condition signal, the COprocessor Condition signal Cp-</span></div>
<div style="position:absolute;left:162.18px;top:475.30px" class="cls_053"><span class="cls_053">Cond(1).</span></div>
<div style="position:absolute;left:162.17px;top:501.30px" class="cls_053"><span class="cls_053">T-1:</span></div>
<div style="position:absolute;left:216.17px;top:501.30px" class="cls_053"><span class="cls_053">condition </span><span class="cls_003">←</span><span class="cls_053"> COC[1] = tf</span></div>
<div style="position:absolute;left:162.17px;top:514.29px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:216.17px;top:512.29px" class="cls_053"><span class="cls_053">target </span><span class="cls_003">←</span><span class="cls_053"> (offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>GPRlen-(16+2)</sup></span><span class="cls_053"> || offset || 0</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:162.18px;top:527.29px" class="cls_053"><span class="cls_053">T+1:</span></div>
<div style="position:absolute;left:216.17px;top:527.29px" class="cls_053"><span class="cls_053">if condition then</span></div>
<div style="position:absolute;left:270.18px;top:540.29px" class="cls_053"><span class="cls_053">PC </span><span class="cls_003">←</span><span class="cls_053"> PC + target</span></div>
<div style="position:absolute;left:72.00px;top:581.33px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:599.67px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:108.00px;top:612.67px" class="cls_055"><span class="cls_055">Floating-Point exception</span></div>
<div style="position:absolute;left:72.00px;top:633.33px" class="cls_066"><span class="cls_066">Floating-Point Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:651.67px" class="cls_055"><span class="cls_055">Unimplemented operation exception</span></div>
<div style="position:absolute;left:305.03px;top:755.33px" class="cls_002"><span class="cls_002">B-9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:243006px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:420.79px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:203.40px;top:64.16px" class="cls_064"><span class="cls_064">Branch On Floating Point True</span></div>
<div style="position:absolute;left:108.07px;top:60.90px" class="cls_063"><span class="cls_063">BC1T</span></div>
<div style="position:absolute;left:435.89px;top:60.90px" class="cls_063"><span class="cls_063">BC1T</span></div>
<div style="position:absolute;left:116.57px;top:104.18px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.80px;top:104.18px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:233.35px;top:100.87px" class="cls_053"><span class="cls_053">21  20 18  </span><span class="cls_061"><sup>76</sup></span></div>
<div style="position:absolute;left:305.04px;top:104.18px" class="cls_053"><span class="cls_053">15</span></div>
<div style="position:absolute;left:489.24px;top:104.19px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:137.88px;top:124.14px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:209.35px;top:124.14px" class="cls_053"><span class="cls_053">BC</span></div>
<div style="position:absolute;left:280.85px;top:125.08px" class="cls_078"><span class="cls_078">nd</span></div>
<div style="position:absolute;left:293.60px;top:124.65px" class="cls_053"><span class="cls_053">tf</span></div>
<div style="position:absolute;left:257.89px;top:129.41px" class="cls_053"><span class="cls_053">cc</span></div>
<div style="position:absolute;left:379.74px;top:127.23px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:127.87px;top:137.90px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:196.85px;top:137.90px" class="cls_053"><span class="cls_053">0 1 0 0 0</span></div>
<div style="position:absolute;left:282.66px;top:137.90px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:293.60px;top:137.91px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:148.71px;top:152.21px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:214.13px;top:152.20px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:260.11px;top:152.26px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:282.63px;top:152.26px" class="cls_053"><span class="cls_053">1 1</span></div>
<div style="position:absolute;left:390.89px;top:152.21px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:180.63px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:201.97px" class="cls_055"><span class="cls_055">BC1T  offset</span></div>
<div style="position:absolute;left:342.01px;top:201.97px" class="cls_055"><span class="cls_055">(cc=0)</span></div>
<div style="position:absolute;left:72.00px;top:222.63px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:240.97px" class="cls_055"><span class="cls_055">A branch target address is computed from the sum of the address of the instruction in the delay</span></div>
<div style="position:absolute;left:108.00px;top:253.97px" class="cls_055"><span class="cls_055">slot, and the 16-bit </span><span class="cls_058">offset</span><span class="cls_055">, shifted left two bits and sign-extended.  If the contents of the floating point</span></div>
<div style="position:absolute;left:108.00px;top:266.97px" class="cls_055"><span class="cls_055">condition code specified by </span><span class="cls_058">cc</span><span class="cls_055"> are one (equal to the value of the tf field),  the target address is</span></div>
<div style="position:absolute;left:108.00px;top:279.97px" class="cls_055"><span class="cls_055">branched to with a delay of one instruction.</span></div>
<div style="position:absolute;left:108.00px;top:298.97px" class="cls_055"><span class="cls_055">The condition codes are set by the floating-point compare instruction.</span></div>
<div style="position:absolute;left:108.00px;top:317.97px" class="cls_055"><span class="cls_055">MIPS I specifies a single floating-point condition that is available as the coprocessor 1 condition</span></div>
<div style="position:absolute;left:108.00px;top:330.97px" class="cls_055"><span class="cls_055">signal (Cp1Cond) and the C bit in the FP </span><span class="cls_058">Control and Status</span><span class="cls_055"> register.  This instruction always tests</span></div>
<div style="position:absolute;left:108.00px;top:343.97px" class="cls_055"><span class="cls_055">the Cp1Cond signal.  The first assembler format instruction shown, with an implied </span><span class="cls_058">cc</span><span class="cls_055"> field of zero,</span></div>
<div style="position:absolute;left:108.00px;top:356.97px" class="cls_055"><span class="cls_055">is the only form allowed for processors that implement the MIPS I instruction.</span></div>
<div style="position:absolute;left:108.00px;top:375.97px" class="cls_055"><span class="cls_055">This instruction has a scheduling restriction.  The condition information is sampled during the</span></div>
<div style="position:absolute;left:108.00px;top:388.97px" class="cls_055"><span class="cls_055">preceding instruction and there must be at least one instruction between this branch instruction</span></div>
<div style="position:absolute;left:108.00px;top:401.97px" class="cls_055"><span class="cls_055">and the compare instruction that changes the condition code.  Hardware does not enforce this</span></div>
<div style="position:absolute;left:108.00px;top:414.97px" class="cls_055"><span class="cls_055">restriction.</span></div>
<div style="position:absolute;left:72.00px;top:435.63px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:162.10px;top:455.97px" class="cls_053"><span class="cls_053">MIPS I has a single condition signal, the COprocessor Condition signal COC.</span></div>
<div style="position:absolute;left:162.10px;top:481.97px" class="cls_053"><span class="cls_053">T-1:</span></div>
<div style="position:absolute;left:216.10px;top:481.97px" class="cls_053"><span class="cls_053">condition </span><span class="cls_003">←</span><span class="cls_053"> COC[1] = tf</span></div>
<div style="position:absolute;left:162.10px;top:494.97px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:216.10px;top:492.97px" class="cls_053"><span class="cls_053">target </span><span class="cls_003">←</span><span class="cls_053"> (offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>GPRlen-(16+2)</sup></span><span class="cls_053"> || offset || 0</span><span class="cls_061"><sup>2</sup></span></div>
<div style="position:absolute;left:162.10px;top:507.97px" class="cls_053"><span class="cls_053">T+1:</span></div>
<div style="position:absolute;left:216.10px;top:507.97px" class="cls_053"><span class="cls_053">if condition then</span></div>
<div style="position:absolute;left:270.10px;top:520.97px" class="cls_053"><span class="cls_053">PC </span><span class="cls_003">←</span><span class="cls_053"> PC + target</span></div>
<div style="position:absolute;left:72.00px;top:554.33px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:572.67px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:108.00px;top:591.67px" class="cls_055"><span class="cls_055">Floating-Point exception</span></div>
<div style="position:absolute;left:72.00px;top:612.33px" class="cls_066"><span class="cls_066">Floating-Point Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:630.67px" class="cls_055"><span class="cls_055">Unimplemented operation exception</span></div>
<div style="position:absolute;left:289.04px;top:755.33px" class="cls_002"><span class="cls_002">B-10</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:243808px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:521.04px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:260.92px;top:64.89px" class="cls_064"><span class="cls_064">Floating-Point</span></div>
<div style="position:absolute;left:109.24px;top:59.35px" class="cls_063"><span class="cls_063">C.cond.fmt</span></div>
<div style="position:absolute;left:368.76px;top:59.35px" class="cls_063"><span class="cls_063">C.cond.fmt</span></div>
<div style="position:absolute;left:276.15px;top:80.47px" class="cls_064"><span class="cls_064">Compare</span></div>
<div style="position:absolute;left:117.65px;top:105.14px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.88px;top:105.14px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.10px;top:105.14px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.36px;top:105.14px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:354.39px;top:105.97px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:394.51px;top:105.97px" class="cls_053"><span class="cls_053">8 7</span></div>
<div style="position:absolute;left:422.26px;top:105.97px" class="cls_053"><span class="cls_053">6 5</span></div>
<div style="position:absolute;left:449.63px;top:105.97px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:461.25px;top:105.97px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:488.97px;top:106.02px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:138.96px;top:123.87px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:414.12px;top:123.92px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:437.41px;top:123.89px" class="cls_053"><span class="cls_053">FC</span></div>
<div style="position:absolute;left:211.53px;top:128.11px" class="cls_053"><span class="cls_053">fmt</span></div>
<div style="position:absolute;left:276.78px;top:128.85px" class="cls_053"><span class="cls_053">ft</span></div>
<div style="position:absolute;left:336.41px;top:128.85px" class="cls_053"><span class="cls_053">fs</span></div>
<div style="position:absolute;left:381.79px;top:128.85px" class="cls_053"><span class="cls_053">cc</span></div>
<div style="position:absolute;left:466.91px;top:128.86px" class="cls_053"><span class="cls_053">cond</span></div>
<div style="position:absolute;left:132.57px;top:138.92px" class="cls_055"><span class="cls_055">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:410.92px;top:138.97px" class="cls_055"><span class="cls_055">0 0</span></div>
<div style="position:absolute;left:437.41px;top:138.98px" class="cls_053"><span class="cls_053">1 1</span></div>
<div style="position:absolute;left:149.79px;top:153.16px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.95px;top:153.16px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.13px;top:153.16px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:337.53px;top:153.17px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:381.48px;top:153.17px" class="cls_053"><span class="cls_053">3</span></div>
<div style="position:absolute;left:415.52px;top:153.17px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:443.64px;top:153.17px" class="cls_053"><span class="cls_053">2</span></div>
<div style="position:absolute;left:475.21px;top:153.17px" class="cls_053"><span class="cls_053">4</span></div>
<div style="position:absolute;left:72.00px;top:174.10px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.43px" class="cls_055"><span class="cls_055">C.cond.fmt      fs, ft</span></div>
<div style="position:absolute;left:288.02px;top:195.43px" class="cls_055"><span class="cls_055">(cc=0)</span></div>
<div style="position:absolute;left:72.00px;top:216.10px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.43px" class="cls_055"><span class="cls_055">The contents of the floating-point registers specified by </span><span class="cls_058">fs</span><span class="cls_055"> and </span><span class="cls_058">ft</span><span class="cls_055"> are interpreted in the specified</span></div>
<div style="position:absolute;left:108.01px;top:247.43px" class="cls_055"><span class="cls_055">format and arithmetically compared.  A  result is determined based on the comparison and the</span></div>
<div style="position:absolute;left:108.01px;top:260.43px" class="cls_055"><span class="cls_055">condition, </span><span class="cls_058">cond</span><span class="cls_055">, specified in the instruction. The result is stored in the condition code specified by</span></div>
<div style="position:absolute;left:108.01px;top:273.43px" class="cls_058"><span class="cls_058">cc</span><span class="cls_055">.  If one of the values is a “Not a Number,” and the high-order bit of the condition field is set, an</span></div>
<div style="position:absolute;left:108.01px;top:286.43px" class="cls_055"><span class="cls_055">invalid operation trap is taken.</span></div>
<div style="position:absolute;left:108.01px;top:305.43px" class="cls_055"><span class="cls_055">MIPS I specifies a single floating-point condition that is available as the coprocessor 1 condition</span></div>
<div style="position:absolute;left:108.01px;top:318.43px" class="cls_055"><span class="cls_055">signal (Cp1Cond) and as the C bit in the FP </span><span class="cls_058">Control and Status</span><span class="cls_055"> register.  This instruction always sets</span></div>
<div style="position:absolute;left:108.01px;top:331.43px" class="cls_055"><span class="cls_055">the Cp1Cond signal.  The first assembler format instruction shown, with an implied </span><span class="cls_058">cc</span><span class="cls_055"> field of zero,</span></div>
<div style="position:absolute;left:108.01px;top:344.43px" class="cls_055"><span class="cls_055">is the only form allowed for processors that implement the MIPS I instruction.</span></div>
<div style="position:absolute;left:108.01px;top:363.43px" class="cls_055"><span class="cls_055">Comparisons are exact and neither overflow nor underflow.  Four mutually exclusive relations are</span></div>
<div style="position:absolute;left:108.01px;top:376.43px" class="cls_055"><span class="cls_055">possible results: “less than,” “equal,” “greater than,” and “unordered.”  The last case arises when</span></div>
<div style="position:absolute;left:108.01px;top:389.43px" class="cls_055"><span class="cls_055">one or both of the operands are NaN; every NaN compares “unordered” with everything,</span></div>
<div style="position:absolute;left:108.01px;top:402.43px" class="cls_055"><span class="cls_055">including itself.  Comparisons ignore the sign of zero, so +0 “equals” -0.</span></div>
<div style="position:absolute;left:108.01px;top:421.43px" class="cls_055"><span class="cls_055">This instruction has a timing restriction.  The contents of the destination condition code specified</span></div>
<div style="position:absolute;left:108.01px;top:434.43px" class="cls_055"><span class="cls_055">by cc, or the Cp1Cond signal is immediately available only within the floating-point unit.  A one-</span></div>
<div style="position:absolute;left:108.01px;top:447.43px" class="cls_055"><span class="cls_055">instruction delay is provided to propagate the condition code to the remainder of the processor.</span></div>
<div style="position:absolute;left:108.01px;top:460.43px" class="cls_055"><span class="cls_055">The value of the condition code is undefined during this one-instruction delay.  No hardware</span></div>
<div style="position:absolute;left:108.01px;top:473.43px" class="cls_055"><span class="cls_055">interlock is provided to detect this hazard.</span></div>
<div style="position:absolute;left:108.01px;top:492.43px" class="cls_055"><span class="cls_055">The implications for compiler code scheduling is that a compare instruction may  be immediately</span></div>
<div style="position:absolute;left:108.01px;top:505.43px" class="cls_055"><span class="cls_055">followed by a dependent floating-point conditional move instruction, but may not be immediately</span></div>
<div style="position:absolute;left:108.01px;top:518.43px" class="cls_055"><span class="cls_055">followed by a dependent branch on floating-point coprocessor condition instruction or a</span></div>
<div style="position:absolute;left:108.01px;top:531.43px" class="cls_055"><span class="cls_055">dependent integer conditional move instruction.  Note that this restriction applies only to the</span></div>
<div style="position:absolute;left:108.01px;top:544.43px" class="cls_055"><span class="cls_055">particular condition code specified by </span><span class="cls_058">cc</span><span class="cls_055">; the other condition codes are unaffected.</span></div>
<div style="position:absolute;left:108.01px;top:563.43px" class="cls_055"><span class="cls_055">The fields </span><span class="cls_058">fs</span><span class="cls_055"> and </span><span class="cls_058">f</span><span class="cls_055">t must specify valid operand registers for the type </span><span class="cls_058">fmt</span><span class="cls_055"> and the logical size of</span></div>
<div style="position:absolute;left:108.01px;top:576.43px" class="cls_055"><span class="cls_055">coprocessor 1 general registers.  If they are not valid specifiers, the result  is undefined.</span></div>
<div style="position:absolute;left:302.79px;top:755.34px" class="cls_002"><span class="cls_002">B-11</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:244610px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:420.79px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:260.92px;top:64.35px" class="cls_064"><span class="cls_064">Floating-Point</span></div>
<div style="position:absolute;left:107.24px;top:60.60px" class="cls_063"><span class="cls_063">C.cond.fmt</span></div>
<div style="position:absolute;left:370.76px;top:60.60px" class="cls_063"><span class="cls_063">C.cond.fmt</span></div>
<div style="position:absolute;left:277.62px;top:78.68px" class="cls_064"><span class="cls_064">Compare</span></div>
<div style="position:absolute;left:268.70px;top:93.00px" class="cls_064"><span class="cls_064">(Continued)</span></div>
<div style="position:absolute;left:72.00px;top:123.63px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:108.00px;top:157.97px" class="cls_053"><span class="cls_053">if NaN(Value FPR(fs, fmt)) or NaN(ValueFPR(ft, fmt)) then</span></div>
<div style="position:absolute;left:126.00px;top:170.99px" class="cls_053"><span class="cls_053">less </span><span class="cls_003">←</span><span class="cls_053"> false</span></div>
<div style="position:absolute;left:126.01px;top:184.01px" class="cls_053"><span class="cls_053">equal </span><span class="cls_003">←</span><span class="cls_053"> false</span></div>
<div style="position:absolute;left:126.01px;top:197.03px" class="cls_053"><span class="cls_053">unordered </span><span class="cls_003">←</span><span class="cls_053"> true</span></div>
<div style="position:absolute;left:126.02px;top:210.05px" class="cls_053"><span class="cls_053">if cond</span><span class="cls_061"><sub>3</sub></span><span class="cls_053"> then</span></div>
<div style="position:absolute;left:144.00px;top:223.08px" class="cls_053"><span class="cls_053">signal InvalidOperationException</span></div>
<div style="position:absolute;left:126.00px;top:236.10px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:108.00px;top:249.12px" class="cls_053"><span class="cls_053">else</span></div>
<div style="position:absolute;left:126.00px;top:262.14px" class="cls_053"><span class="cls_053">less </span><span class="cls_003">←</span><span class="cls_053"> ValueFPR(fs, fmt) &lt; ValueFPR(ft, fmt)</span></div>
<div style="position:absolute;left:126.01px;top:275.16px" class="cls_053"><span class="cls_053">equal </span><span class="cls_003">←</span><span class="cls_053"> ValueFPR(fs, fmt) = ValueFPR(ft, fmt)</span></div>
<div style="position:absolute;left:126.01px;top:288.18px" class="cls_053"><span class="cls_053">unordered </span><span class="cls_003">←</span><span class="cls_053"> false</span></div>
<div style="position:absolute;left:108.01px;top:301.20px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:108.01px;top:314.22px" class="cls_053"><span class="cls_053">condition </span><span class="cls_003">←</span><span class="cls_053"> (cond</span><span class="cls_061"><sub>2</sub></span><span class="cls_053"> and less) or (cond</span><span class="cls_061"><sub>1</sub></span><span class="cls_053"> and equal) or</span></div>
<div style="position:absolute;left:126.00px;top:327.27px" class="cls_053"><span class="cls_053">cond</span><span class="cls_061"><sub>0</sub></span><span class="cls_053"> and unordered)</span></div>
<div style="position:absolute;left:108.00px;top:340.30px" class="cls_053"><span class="cls_053">COC[1] </span><span class="cls_003">←</span><span class="cls_053"> condition</span></div>
<div style="position:absolute;left:72.00px;top:374.02px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:392.35px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:108.00px;top:405.35px" class="cls_055"><span class="cls_055">Floating-Point exception</span></div>
<div style="position:absolute;left:72.00px;top:426.02px" class="cls_066"><span class="cls_066">Floating-Point Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:444.35px" class="cls_055"><span class="cls_055">Unimplemented operation exception</span></div>
<div style="position:absolute;left:108.00px;top:457.35px" class="cls_055"><span class="cls_055">Invalid operation exception</span></div>
<div style="position:absolute;left:289.04px;top:755.34px" class="cls_002"><span class="cls_002">B-12</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:245412px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:521.04px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:244.65px;top:60.33px" class="cls_064"><span class="cls_064">Move Control Word</span></div>
<div style="position:absolute;left:105.10px;top:60.70px" class="cls_063"><span class="cls_063">CFC1</span></div>
<div style="position:absolute;left:445.43px;top:60.70px" class="cls_063"><span class="cls_063">CFC1</span></div>
<div style="position:absolute;left:224.44px;top:77.25px" class="cls_064"><span class="cls_064">from Floating-Point (CP1)</span></div>
<div style="position:absolute;left:114.41px;top:104.74px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:170.21px;top:104.74px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:234.01px;top:104.74px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:293.99px;top:104.74px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:354.67px;top:104.74px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:490.98px;top:104.74px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:139.68px;top:128.79px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:210.06px;top:128.79px" class="cls_053"><span class="cls_053">CF</span></div>
<div style="position:absolute;left:271.71px;top:128.79px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:334.15px;top:128.78px" class="cls_053"><span class="cls_053">fs</span></div>
<div style="position:absolute;left:428.14px;top:127.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:127.36px;top:138.36px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:195.19px;top:138.36px" class="cls_053"><span class="cls_053">0 0 0 1 0</span></div>
<div style="position:absolute;left:381.25px;top:138.36px" class="cls_053"><span class="cls_053">0 0 0  0 0 0 0  0 0 0 0</span></div>
<div style="position:absolute;left:149.91px;top:152.77px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:215.72px;top:152.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:275.55px;top:152.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:332.57px;top:152.76px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:430.85px;top:152.76px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:72.00px;top:176.63px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:197.97px" class="cls_055"><span class="cls_055">CFC1 rt, fs</span></div>
<div style="position:absolute;left:72.00px;top:218.63px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:236.97px" class="cls_055"><span class="cls_055">The contents of the FPU control register </span><span class="cls_058">fs </span><span class="cls_055">are loaded into general register </span><span class="cls_058">rt.</span></div>
<div style="position:absolute;left:108.00px;top:255.97px" class="cls_055"><span class="cls_055">This operation is only defined when </span><span class="cls_058">fs</span><span class="cls_055"> equals 0 or 31.</span></div>
<div style="position:absolute;left:108.01px;top:274.97px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rt</span><span class="cls_055"> are undefined for time </span><span class="cls_058">T</span><span class="cls_055"> of the instruction immediately following</span></div>
<div style="position:absolute;left:108.01px;top:287.97px" class="cls_055"><span class="cls_055">this load instruction.</span></div>
<div style="position:absolute;left:72.00px;top:308.63px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:144.27px;top:332.46px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:172.60px;top:332.46px" class="cls_053"><span class="cls_053">temp  </span><span class="cls_003">←</span><span class="cls_053">   FCR[fs]</span></div>
<div style="position:absolute;left:144.28px;top:343.46px" class="cls_053"><span class="cls_053">T+1:   GPR[rt]  </span><span class="cls_003">←</span><span class="cls_053"> (temp</span><span class="cls_061"><sub>31</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>GPRlen-32</sup></span><span class="cls_053"> || temp</span></div>
<div style="position:absolute;left:74.75px;top:380.31px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:398.64px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:302.79px;top:755.34px" class="cls_002"><span class="cls_002">B-13</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:246214px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:420.79px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:243.77px;top:60.17px" class="cls_064"><span class="cls_064">Move Control Word</span></div>
<div style="position:absolute;left:104.92px;top:60.70px" class="cls_063"><span class="cls_063">CTC1</span></div>
<div style="position:absolute;left:443.75px;top:61.04px" class="cls_063"><span class="cls_063">CTC1</span></div>
<div style="position:absolute;left:232.50px;top:77.08px" class="cls_064"><span class="cls_064">to Floating-Point (CP1)</span></div>
<div style="position:absolute;left:118.01px;top:103.91px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:173.17px;top:103.91px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.32px;top:103.91px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.51px;top:103.91px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:355.47px;top:103.92px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:490.20px;top:103.92px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:142.85px;top:127.96px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:212.51px;top:127.96px" class="cls_053"><span class="cls_053">CT</span></div>
<div style="position:absolute;left:273.51px;top:127.96px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:335.16px;top:127.96px" class="cls_053"><span class="cls_053">fs</span></div>
<div style="position:absolute;left:428.07px;top:126.52px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:132.40px;top:137.54px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:200.95px;top:137.54px" class="cls_053"><span class="cls_053">0 0 1 1 0</span></div>
<div style="position:absolute;left:389.03px;top:137.54px" class="cls_053"><span class="cls_053">0 0 0  0 0 0 0  0 0 0 0</span></div>
<div style="position:absolute;left:153.15px;top:151.94px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:218.17px;top:151.94px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.28px;top:151.94px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:333.65px;top:151.94px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:430.78px;top:151.94px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:72.00px;top:174.63px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.97px" class="cls_055"><span class="cls_055">CTC1 rt, fs</span></div>
<div style="position:absolute;left:72.00px;top:210.63px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:228.97px" class="cls_055"><span class="cls_055">The contents of general register </span><span class="cls_058">rt </span><span class="cls_055">are loaded into FPU control register </span><span class="cls_058">fs. </span><span class="cls_055"> This operation is only</span></div>
<div style="position:absolute;left:108.01px;top:241.97px" class="cls_055"><span class="cls_055">defined when </span><span class="cls_058">fs</span><span class="cls_055"> equals 0 or 31.</span></div>
<div style="position:absolute;left:108.01px;top:260.97px" class="cls_055"><span class="cls_055">Writing to </span><span class="cls_058">Control Register</span><span class="cls_055"> </span><span class="cls_058">31</span><span class="cls_055">, the floating-point </span><span class="cls_058">Control/Status</span><span class="cls_055"> register, causes an interrupt or</span></div>
<div style="position:absolute;left:108.01px;top:273.97px" class="cls_055"><span class="cls_055">exception if any cause bit and its corresponding enable bit are both set.  The register will be written</span></div>
<div style="position:absolute;left:108.01px;top:286.97px" class="cls_055"><span class="cls_055">before the exception occurs.  The contents of floating-point control register </span><span class="cls_058">fs</span><span class="cls_055"> are undefined for time</span></div>
<div style="position:absolute;left:108.02px;top:299.97px" class="cls_058"><span class="cls_058">T</span><span class="cls_055"> of the instruction immediately following this load instruction.</span></div>
<div style="position:absolute;left:72.00px;top:314.63px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:204.76px;top:334.25px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:240.75px;top:334.25px" class="cls_053"><span class="cls_053">temp </span><span class="cls_003">←</span><span class="cls_053">  GPR[rt]</span><span class="cls_061"><sub>31...0</sub></span></div>
<div style="position:absolute;left:204.76px;top:347.25px" class="cls_053"><span class="cls_053">T+1:</span></div>
<div style="position:absolute;left:240.75px;top:347.25px" class="cls_053"><span class="cls_053">FCR[fs] </span><span class="cls_003"> ←  </span><span class="cls_053">temp</span></div>
<div style="position:absolute;left:240.76px;top:360.25px" class="cls_053"><span class="cls_053">COC[1] </span><span class="cls_003">←</span><span class="cls_053"> FCR[31]</span><span class="cls_061"><sub>23</sub></span></div>
<div style="position:absolute;left:72.00px;top:391.86px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:410.19px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:108.00px;top:423.19px" class="cls_055"><span class="cls_055">Floating-Point exception</span></div>
<div style="position:absolute;left:72.00px;top:437.86px" class="cls_066"><span class="cls_066">Floating-Point Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:456.19px" class="cls_055"><span class="cls_055">Unimplemented operation exception</span></div>
<div style="position:absolute;left:108.00px;top:469.19px" class="cls_055"><span class="cls_055">Invalid operation exception</span></div>
<div style="position:absolute;left:108.00px;top:482.19px" class="cls_055"><span class="cls_055">Division by zero exception</span></div>
<div style="position:absolute;left:108.00px;top:495.19px" class="cls_055"><span class="cls_055">Inexact exception</span></div>
<div style="position:absolute;left:108.00px;top:508.19px" class="cls_055"><span class="cls_055">Overflow exception</span></div>
<div style="position:absolute;left:108.00px;top:521.19px" class="cls_055"><span class="cls_055">Underflow exception</span></div>
<div style="position:absolute;left:289.04px;top:755.34px" class="cls_002"><span class="cls_002">B-14</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:247016px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:521.04px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:264.02px;top:63.32px" class="cls_067"><span class="cls_067">Floating-Point</span></div>
<div style="position:absolute;left:105.93px;top:60.70px" class="cls_063"><span class="cls_063">CVT.D.fmt</span></div>
<div style="position:absolute;left:395.38px;top:60.70px" class="cls_063"><span class="cls_063">VT.D.fmt</span></div>
<div style="position:absolute;left:254.01px;top:60.70px" class="cls_067"><span class="cls_067">Convert to Double</span><span class="cls_063">    C</span></div>
<div style="position:absolute;left:243.69px;top:91.24px" class="cls_067"><span class="cls_067">Floating-Point Format</span></div>
<div style="position:absolute;left:118.21px;top:121.67px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:176.48px;top:121.67px" class="cls_053"><span class="cls_053">26 25</span></div>
<div style="position:absolute;left:233.42px;top:121.67px" class="cls_053"><span class="cls_053">21</span></div>
<div style="position:absolute;left:252.29px;top:121.67px" class="cls_053"><span class="cls_053">20</span></div>
<div style="position:absolute;left:290.31px;top:121.67px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:309.26px;top:121.67px" class="cls_053"><span class="cls_053">15</span></div>
<div style="position:absolute;left:348.04px;top:121.67px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:367.05px;top:121.67px" class="cls_053"><span class="cls_053">10</span></div>
<div style="position:absolute;left:409.71px;top:121.67px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:422.89px;top:121.67px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:488.33px;top:121.67px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:139.03px;top:145.65px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:208.85px;top:145.65px" class="cls_053"><span class="cls_053">fmt</span></div>
<div style="position:absolute;left:273.13px;top:145.65px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:327.97px;top:145.65px" class="cls_053"><span class="cls_053">fs</span></div>
<div style="position:absolute;left:384.56px;top:145.65px" class="cls_053"><span class="cls_053">fd</span></div>
<div style="position:absolute;left:441.05px;top:145.65px" class="cls_053"><span class="cls_053">CVT.D</span></div>
<div style="position:absolute;left:127.94px;top:158.17px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:257.34px;top:158.17px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:431.94px;top:158.17px" class="cls_053"><span class="cls_053">1 0 0 0 0 1</span></div>
<div style="position:absolute;left:150.80px;top:172.58px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:215.89px;top:172.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:273.13px;top:172.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:331.02px;top:172.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:386.89px;top:172.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:453.27px;top:172.58px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:195.15px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:216.48px" class="cls_055"><span class="cls_055">CVT.D.fmt fd, fs</span></div>
<div style="position:absolute;left:72.00px;top:231.15px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:249.48px" class="cls_055"><span class="cls_055">The contents of the floating-point register specified by </span><span class="cls_058">fs</span><span class="cls_055"> is interpreted in the specified source</span></div>
<div style="position:absolute;left:108.01px;top:262.48px" class="cls_055"><span class="cls_055">format, </span><span class="cls_058">fmt</span><span class="cls_055">, and arithmetically converted to the double floating-point format.  The result is placed</span></div>
<div style="position:absolute;left:108.00px;top:275.48px" class="cls_055"><span class="cls_055">in the floating-point register specified by </span><span class="cls_058">fd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:294.48px" class="cls_055"><span class="cls_055">This instruction is valid only for conversions from single floating-point format or 32-bit fixed-point</span></div>
<div style="position:absolute;left:108.00px;top:307.48px" class="cls_055"><span class="cls_055">format.</span></div>
<div style="position:absolute;left:108.00px;top:326.48px" class="cls_055"><span class="cls_055">If </span><span class="cls_058">fmt</span><span class="cls_055"> specifies the single floating-point or single fixed-point format then the operation is exact.</span></div>
<div style="position:absolute;left:108.00px;top:345.48px" class="cls_055"><span class="cls_055">The field </span><span class="cls_058">fs</span><span class="cls_055">, and </span><span class="cls_058">fd</span><span class="cls_055"> must specify valid operand registers given the logical size of coprocessor 1</span></div>
<div style="position:absolute;left:108.00px;top:358.48px" class="cls_055"><span class="cls_055">general registers; </span><span class="cls_058">fs</span><span class="cls_055"> for the type </span><span class="cls_058">fmt</span><span class="cls_055"> and </span><span class="cls_058">fd</span><span class="cls_055"> for double floating-point.  If they are not valid specifiers,</span></div>
<div style="position:absolute;left:108.00px;top:371.48px" class="cls_055"><span class="cls_055">the result  is undefined.</span></div>
<div style="position:absolute;left:72.00px;top:386.14px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:124.82px;top:410.06px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:153.15px;top:410.06px" class="cls_053"><span class="cls_053">StoreFPR (fd, D, ConvertFmt(ValueFPR(fs, fmt), fmt, D))</span></div>
<div style="position:absolute;left:72.00px;top:430.71px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:449.04px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:108.00px;top:462.04px" class="cls_055"><span class="cls_055">Floating-Point exception</span></div>
<div style="position:absolute;left:72.00px;top:476.70px" class="cls_066"><span class="cls_066">Floating-Point Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:495.04px" class="cls_055"><span class="cls_055">Invalid operation exception</span></div>
<div style="position:absolute;left:108.00px;top:508.04px" class="cls_055"><span class="cls_055">Unimplemented operation exception</span></div>
<div style="position:absolute;left:108.00px;top:521.04px" class="cls_055"><span class="cls_055">Inexact exception</span></div>
<div style="position:absolute;left:108.00px;top:534.04px" class="cls_055"><span class="cls_055">Overflow exception</span></div>
<div style="position:absolute;left:108.00px;top:547.04px" class="cls_055"><span class="cls_055">Underflow exception</span></div>
<div style="position:absolute;left:302.79px;top:755.34px" class="cls_002"><span class="cls_002">B-15</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:247818px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:420.79px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:257.02px;top:60.76px" class="cls_064"><span class="cls_064">Floating-Point</span></div>
<div style="position:absolute;left:109.10px;top:60.68px" class="cls_063"><span class="cls_063">CVT.S.fmt</span></div>
<div style="position:absolute;left:378.18px;top:60.70px" class="cls_063"><span class="cls_063">CVT.S.fmt</span></div>
<div style="position:absolute;left:248.06px;top:75.28px" class="cls_064"><span class="cls_064">Convert to Single</span></div>
<div style="position:absolute;left:233.30px;top:90.74px" class="cls_064"><span class="cls_064">Floating-Point Format</span></div>
<div style="position:absolute;left:118.21px;top:123.67px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:176.48px;top:123.67px" class="cls_053"><span class="cls_053">26 25</span></div>
<div style="position:absolute;left:233.42px;top:123.67px" class="cls_053"><span class="cls_053">21</span></div>
<div style="position:absolute;left:252.29px;top:123.67px" class="cls_053"><span class="cls_053">20</span></div>
<div style="position:absolute;left:290.31px;top:123.67px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:309.26px;top:123.67px" class="cls_053"><span class="cls_053">15</span></div>
<div style="position:absolute;left:348.04px;top:123.67px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:367.05px;top:123.67px" class="cls_053"><span class="cls_053">10</span></div>
<div style="position:absolute;left:407.69px;top:123.67px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:420.87px;top:123.67px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:488.33px;top:123.67px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:139.03px;top:147.65px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:208.85px;top:147.65px" class="cls_053"><span class="cls_053">fmt</span></div>
<div style="position:absolute;left:273.13px;top:147.65px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:327.97px;top:147.65px" class="cls_053"><span class="cls_053">fs</span></div>
<div style="position:absolute;left:384.56px;top:147.65px" class="cls_053"><span class="cls_053">fd</span></div>
<div style="position:absolute;left:441.33px;top:147.65px" class="cls_053"><span class="cls_053">CVT.S</span></div>
<div style="position:absolute;left:127.94px;top:160.17px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:257.34px;top:160.17px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:431.94px;top:160.17px" class="cls_053"><span class="cls_053">1 0 0 0 0 0</span></div>
<div style="position:absolute;left:150.80px;top:174.58px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:215.89px;top:174.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:273.13px;top:174.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:331.02px;top:174.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:386.89px;top:174.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:453.27px;top:174.58px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:200.63px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:221.97px" class="cls_055"><span class="cls_055">CVT.S.fmt fd, fs</span></div>
<div style="position:absolute;left:72.00px;top:236.63px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:254.97px" class="cls_055"><span class="cls_055">The contents of the floating-point register specified by </span><span class="cls_058">fs</span><span class="cls_055"> are interpreted in the specified source</span></div>
<div style="position:absolute;left:108.01px;top:267.97px" class="cls_055"><span class="cls_055">format, </span><span class="cls_058">fmt</span><span class="cls_055">, and arithmetically converted to the single binary floating-point format.  The result is</span></div>
<div style="position:absolute;left:108.00px;top:280.97px" class="cls_055"><span class="cls_055">placed in the floating-point register specified by </span><span class="cls_058">fd</span><span class="cls_055">.  Rounding occurs according to the currently</span></div>
<div style="position:absolute;left:108.00px;top:293.97px" class="cls_055"><span class="cls_055">specified rounding mode.</span></div>
<div style="position:absolute;left:108.00px;top:312.97px" class="cls_055"><span class="cls_055">This instruction is valid only for conversions from double floating-point format, or from 32-bit</span></div>
<div style="position:absolute;left:108.00px;top:325.97px" class="cls_055"><span class="cls_055">fixed-point format.</span></div>
<div style="position:absolute;left:108.00px;top:344.97px" class="cls_055"><span class="cls_055">The field </span><span class="cls_058">fs</span><span class="cls_055">, and </span><span class="cls_058">fd</span><span class="cls_055"> must specify valid operand registers given the logical size of coprocessor 1</span></div>
<div style="position:absolute;left:108.00px;top:357.97px" class="cls_055"><span class="cls_055">general registers; </span><span class="cls_058">fs</span><span class="cls_055"> for the type </span><span class="cls_058">fmt</span><span class="cls_055"> and </span><span class="cls_058">fd</span><span class="cls_055"> for single floating-point.  If they are not valid specifiers,</span></div>
<div style="position:absolute;left:107.99px;top:370.97px" class="cls_055"><span class="cls_055">the result  is undefined.</span></div>
<div style="position:absolute;left:72.00px;top:391.63px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:126.73px;top:414.49px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:155.52px;top:414.49px" class="cls_053"><span class="cls_053">StoreFPR(fd, S, ConvertFmt(ValueFPR(fs, fmt), fmt, S))</span></div>
<div style="position:absolute;left:74.75px;top:435.71px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:454.05px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:108.00px;top:467.05px" class="cls_055"><span class="cls_055">Floating-Point exception</span></div>
<div style="position:absolute;left:72.00px;top:481.71px" class="cls_066"><span class="cls_066">Floating-Point Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:500.05px" class="cls_055"><span class="cls_055">Invalid operation exception</span></div>
<div style="position:absolute;left:108.00px;top:513.05px" class="cls_055"><span class="cls_055">Unimplemented operation exception</span></div>
<div style="position:absolute;left:108.00px;top:526.05px" class="cls_055"><span class="cls_055">Inexact exception</span></div>
<div style="position:absolute;left:108.00px;top:539.05px" class="cls_055"><span class="cls_055">Overflow exception</span></div>
<div style="position:absolute;left:108.00px;top:552.05px" class="cls_055"><span class="cls_055">Underflow exception</span></div>
<div style="position:absolute;left:289.04px;top:755.34px" class="cls_002"><span class="cls_002">B-16</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:248620px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:521.04px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:106.43px;top:61.22px" class="cls_063"><span class="cls_063">CVT.W.fmt</span><span class="cls_064">FlConvert tont</span></div>
<div style="position:absolute;left:370.98px;top:61.22px" class="cls_063"><span class="cls_063">CVT.W.fmt</span></div>
<div style="position:absolute;left:240.85px;top:90.74px" class="cls_064"><span class="cls_064">Fixed-Point Format</span></div>
<div style="position:absolute;left:117.20px;top:126.05px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:175.67px;top:126.04px" class="cls_053"><span class="cls_053">26 25</span></div>
<div style="position:absolute;left:232.69px;top:126.04px" class="cls_053"><span class="cls_053">21</span></div>
<div style="position:absolute;left:251.71px;top:126.04px" class="cls_053"><span class="cls_053">20</span></div>
<div style="position:absolute;left:289.73px;top:126.04px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:308.74px;top:126.04px" class="cls_053"><span class="cls_053">15</span></div>
<div style="position:absolute;left:347.67px;top:126.04px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:366.69px;top:126.04px" class="cls_053"><span class="cls_053">10</span></div>
<div style="position:absolute;left:407.48px;top:126.05px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:420.73px;top:126.05px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:488.33px;top:126.05px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:138.16px;top:150.09px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:212.59px;top:150.09px" class="cls_053"><span class="cls_053">fmt</span></div>
<div style="position:absolute;left:272.56px;top:150.09px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:327.54px;top:150.09px" class="cls_053"><span class="cls_053">fs</span></div>
<div style="position:absolute;left:384.29px;top:150.09px" class="cls_053"><span class="cls_053">fd</span></div>
<div style="position:absolute;left:439.89px;top:150.09px" class="cls_053"><span class="cls_053">CVT.W</span></div>
<div style="position:absolute;left:127.08px;top:162.55px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:256.77px;top:162.55px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:431.80px;top:162.55px" class="cls_053"><span class="cls_053">1 0 0 1 0 0</span></div>
<div style="position:absolute;left:149.93px;top:176.95px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:219.63px;top:176.95px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:272.56px;top:176.95px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:330.59px;top:176.95px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:386.61px;top:176.95px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:453.21px;top:176.95px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:196.43px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:217.77px" class="cls_055"><span class="cls_055">CVT.W.fmt fd, fs</span></div>
<div style="position:absolute;left:72.00px;top:232.43px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:250.77px" class="cls_055"><span class="cls_055">The contents of the floating-point register specified by </span><span class="cls_058">fs</span><span class="cls_055"> are interpreted in the specified source</span></div>
<div style="position:absolute;left:108.01px;top:263.77px" class="cls_055"><span class="cls_055">format, </span><span class="cls_058">fmt</span><span class="cls_055">, and arithmetically converted to the single-word fixed-point format.  The result is</span></div>
<div style="position:absolute;left:108.00px;top:276.77px" class="cls_055"><span class="cls_055">placed in the floating-point register specified by </span><span class="cls_058">fd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:295.77px" class="cls_055"><span class="cls_055">This instruction is valid only for conversion from a single- or double-precision floating-point</span></div>
<div style="position:absolute;left:108.00px;top:308.77px" class="cls_055"><span class="cls_055">formats.</span></div>
<div style="position:absolute;left:108.00px;top:327.77px" class="cls_055"><span class="cls_055">The field </span><span class="cls_058">fs</span><span class="cls_055">, and </span><span class="cls_058">fd</span><span class="cls_055"> must specify valid operand registers given the logical size of coprocessor 1</span></div>
<div style="position:absolute;left:108.00px;top:340.77px" class="cls_055"><span class="cls_055">general registers; </span><span class="cls_058">fs</span><span class="cls_055"> for the type </span><span class="cls_058">fmt</span><span class="cls_055"> and </span><span class="cls_058">fd</span><span class="cls_055"> for single-word fixed-point.  If they are not valid</span></div>
<div style="position:absolute;left:108.00px;top:353.77px" class="cls_055"><span class="cls_055">specifiers, the result  is undefined.</span></div>
<div style="position:absolute;left:108.00px;top:372.77px" class="cls_055"><span class="cls_055">When the source operand is an Infinity or NaN, or the correctly rounded integer result is outside</span></div>
<div style="position:absolute;left:108.00px;top:383.77px" class="cls_055"><span class="cls_055">the range of the single-word fixed-point result type (-2</span><span class="cls_071"><sup>31</sup></span><span class="cls_055"> to 2</span><span class="cls_071"><sup>31</sup></span><span class="cls_055">- 1), the Invalid operation exception</span></div>
<div style="position:absolute;left:108.00px;top:398.77px" class="cls_055"><span class="cls_055">is raised. If the Invalid operation is not enabled then no exception is taken and the largest positive</span></div>
<div style="position:absolute;left:108.00px;top:409.77px" class="cls_055"><span class="cls_055">result (2</span><span class="cls_071"><sup>31</sup></span><span class="cls_058">-</span><span class="cls_055">1) is returned.</span></div>
<div style="position:absolute;left:72.00px;top:426.43px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:108.05px;top:452.29px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:136.85px;top:452.29px" class="cls_053"><span class="cls_053">StoreFPR(fd, W, ConvertFmt(ValueFPR(fs, fmt), fmt, W))</span></div>
<div style="position:absolute;left:72.00px;top:487.34px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:505.67px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:108.00px;top:518.67px" class="cls_055"><span class="cls_055">Floating-Point exception</span></div>
<div style="position:absolute;left:72.00px;top:533.34px" class="cls_066"><span class="cls_066">Floating-Point Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:551.67px" class="cls_055"><span class="cls_055">Invalid operation exception</span></div>
<div style="position:absolute;left:108.00px;top:564.67px" class="cls_055"><span class="cls_055">Unimplemented operation exception</span></div>
<div style="position:absolute;left:108.00px;top:577.67px" class="cls_055"><span class="cls_055">Inexact exception</span></div>
<div style="position:absolute;left:108.00px;top:590.67px" class="cls_055"><span class="cls_055">Overflow exception</span></div>
<div style="position:absolute;left:302.79px;top:755.34px" class="cls_002"><span class="cls_002">B-17</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:249422px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:420.79px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:236.01px;top:67.79px" class="cls_064"><span class="cls_064">Floating-Point Divide</span></div>
<div style="position:absolute;left:109.48px;top:60.90px" class="cls_063"><span class="cls_063">DIV.fmt</span></div>
<div style="position:absolute;left:415.64px;top:60.90px" class="cls_063"><span class="cls_063">DIV.fmt</span></div>
<div style="position:absolute;left:117.99px;top:104.22px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:176.32px;top:104.22px" class="cls_053"><span class="cls_053">26 25</span></div>
<div style="position:absolute;left:233.19px;top:104.22px" class="cls_053"><span class="cls_053">21</span></div>
<div style="position:absolute;left:252.07px;top:104.22px" class="cls_053"><span class="cls_053">20</span></div>
<div style="position:absolute;left:290.02px;top:104.22px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:308.96px;top:104.22px" class="cls_053"><span class="cls_053">15</span></div>
<div style="position:absolute;left:347.81px;top:104.22px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:366.76px;top:104.22px" class="cls_053"><span class="cls_053">10</span></div>
<div style="position:absolute;left:407.64px;top:104.22px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:420.60px;top:104.22px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:487.97px;top:104.22px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:138.88px;top:128.27px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:209.85px;top:128.27px" class="cls_053"><span class="cls_053">fmt</span></div>
<div style="position:absolute;left:272.84px;top:128.27px" class="cls_053"><span class="cls_053">ft</span></div>
<div style="position:absolute;left:327.68px;top:128.27px" class="cls_053"><span class="cls_053">fs</span></div>
<div style="position:absolute;left:384.28px;top:128.27px" class="cls_053"><span class="cls_053">fd</span></div>
<div style="position:absolute;left:450.52px;top:128.27px" class="cls_053"><span class="cls_053">DIV</span></div>
<div style="position:absolute;left:128.29px;top:140.72px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:435.24px;top:140.72px" class="cls_053"><span class="cls_053">0 0 0 0 1 1</span></div>
<div style="position:absolute;left:150.65px;top:155.13px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.89px;top:155.13px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:272.84px;top:155.13px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:330.66px;top:155.13px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:386.61px;top:155.13px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:452.92px;top:155.13px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:178.43px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:199.77px" class="cls_055"><span class="cls_055">DIV.fmt fd, fs, ft</span></div>
<div style="position:absolute;left:72.00px;top:214.43px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:232.77px" class="cls_058"><span class="cls_058">fd </span><span class="cls_003">←</span><span class="cls_058"> fs </span><span class="cls_053">/ </span><span class="cls_058">ft</span></div>
<div style="position:absolute;left:108.01px;top:251.77px" class="cls_055"><span class="cls_055">The contents of the floating-point registers specified by </span><span class="cls_058">fs</span><span class="cls_055"> and </span><span class="cls_058">ft</span><span class="cls_055"> are interpreted in the specified</span></div>
<div style="position:absolute;left:108.02px;top:264.77px" class="cls_058"><span class="cls_058">format</span><span class="cls_055"> and </span><span class="cls_058">fs</span><span class="cls_055"> is arithmetically divided by </span><span class="cls_058">ft</span><span class="cls_055">.  The result is rounded as if calculated to infinite</span></div>
<div style="position:absolute;left:108.03px;top:277.77px" class="cls_055"><span class="cls_055">precision and then rounded to the specified format, according to the current rounding mode.  The</span></div>
<div style="position:absolute;left:108.03px;top:290.77px" class="cls_055"><span class="cls_055">result is placed in the floating-point register specified by </span><span class="cls_058">fd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.03px;top:309.77px" class="cls_055"><span class="cls_055">This instruction is valid for only single or double precision floating-point formats.</span></div>
<div style="position:absolute;left:108.03px;top:328.77px" class="cls_055"><span class="cls_055">The fields </span><span class="cls_058">fs</span><span class="cls_055">, </span><span class="cls_058">ft</span><span class="cls_055">, and </span><span class="cls_058">fd</span><span class="cls_055"> must specify valid operand registers, given the logical size of coprocessor 1</span></div>
<div style="position:absolute;left:108.04px;top:341.77px" class="cls_055"><span class="cls_055">general registers, for the type </span><span class="cls_058">fmt</span><span class="cls_055">.  If they are not valid specifiers, the result  is undefined.</span></div>
<div style="position:absolute;left:72.00px;top:356.43px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:107.00px;top:385.82px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:142.99px;top:385.82px" class="cls_053"><span class="cls_053">StoreFPR (fd, fmt, ValueFPR(fs, fmt)/ValueFPR(ft, fmt))</span></div>
<div style="position:absolute;left:72.00px;top:412.17px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:430.50px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:108.00px;top:443.50px" class="cls_055"><span class="cls_055">Floating-Point exception</span></div>
<div style="position:absolute;left:72.00px;top:458.17px" class="cls_066"><span class="cls_066">Floating-Point Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:476.50px" class="cls_055"><span class="cls_055">Unimplemented operation exception</span></div>
<div style="position:absolute;left:342.05px;top:476.50px" class="cls_055"><span class="cls_055">Invalid operation exception</span></div>
<div style="position:absolute;left:108.00px;top:489.50px" class="cls_055"><span class="cls_055">Division-by-zero exception</span></div>
<div style="position:absolute;left:342.04px;top:489.50px" class="cls_055"><span class="cls_055">Inexact exception</span></div>
<div style="position:absolute;left:108.00px;top:502.50px" class="cls_055"><span class="cls_055">Overflow exception</span></div>
<div style="position:absolute;left:342.03px;top:502.50px" class="cls_055"><span class="cls_055">Underflow exception</span></div>
<div style="position:absolute;left:289.04px;top:755.34px" class="cls_002"><span class="cls_002">B-18</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:250224px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:521.04px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:269.45px;top:62.01px" class="cls_064"><span class="cls_064">Load Word</span></div>
<div style="position:absolute;left:105.78px;top:60.85px" class="cls_063"><span class="cls_063">LWC1</span></div>
<div style="position:absolute;left:434.78px;top:60.82px" class="cls_063"><span class="cls_063">LWC1</span></div>
<div style="position:absolute;left:230.20px;top:76.86px" class="cls_064"><span class="cls_064">to Floating-Point (CP1)</span></div>
<div style="position:absolute;left:118.01px;top:106.33px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:173.31px;top:106.33px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.60px;top:106.33px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.93px;top:106.33px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:491.27px;top:106.33px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:142.64px;top:130.38px" class="cls_053"><span class="cls_053">LWC1</span></div>
<div style="position:absolute;left:208.55px;top:130.38px" class="cls_053"><span class="cls_053">base</span></div>
<div style="position:absolute;left:274.22px;top:130.38px" class="cls_053"><span class="cls_053">ft</span></div>
<div style="position:absolute;left:389.82px;top:128.94px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:132.47px;top:139.95px" class="cls_053"><span class="cls_053">1 1 0 0 0 1</span></div>
<div style="position:absolute;left:153.22px;top:154.36px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:218.45px;top:154.36px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.71px;top:154.36px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:390.82px;top:154.36px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:175.04px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:196.37px" class="cls_055"><span class="cls_055">LWC1 ft, offset(base)</span></div>
<div style="position:absolute;left:72.00px;top:217.04px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:235.37px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">offset </span><span class="cls_055">is sign-extended and added to the contents of general register </span><span class="cls_058">base </span><span class="cls_055">to form an</span></div>
<div style="position:absolute;left:108.00px;top:248.37px" class="cls_055"><span class="cls_055">unsigned effective address.  The contents of the word at the memory location specified by the</span></div>
<div style="position:absolute;left:108.00px;top:261.37px" class="cls_055"><span class="cls_055">effective address are loaded into floating-point (coprocessor 1) general register </span><span class="cls_058">ft</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:280.37px" class="cls_055"><span class="cls_055">The effective address must be word-aligned.  If either of the two least-significant bits of the effective</span></div>
<div style="position:absolute;left:108.00px;top:293.37px" class="cls_055"><span class="cls_055">address is non-zero, an address error exception occurs.</span></div>
<div style="position:absolute;left:302.79px;top:755.34px" class="cls_002"><span class="cls_002">B-19</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:251026px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:420.79px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:195.48px;top:65.95px" class="cls_079"><span class="cls_079">Move Word from Floating-Point (CP1)</span></div>
<div style="position:absolute;left:107.78px;top:61.70px" class="cls_063"><span class="cls_063">MFC1</span></div>
<div style="position:absolute;left:443.45px;top:61.70px" class="cls_063"><span class="cls_063">MFC1</span></div>
<div style="position:absolute;left:117.00px;top:106.75px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.30px;top:106.75px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:235.59px;top:106.75px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:294.99px;top:106.75px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:355.11px;top:106.76px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:490.19px;top:106.76px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:141.90px;top:130.80px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:211.15px;top:130.80px" class="cls_053"><span class="cls_053">MF</span></div>
<div style="position:absolute;left:272.92px;top:130.80px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:334.73px;top:130.80px" class="cls_053"><span class="cls_053">fs</span></div>
<div style="position:absolute;left:427.93px;top:129.29px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:131.47px;top:140.38px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:195.56px;top:140.38px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:382.90px;top:140.38px" class="cls_053"><span class="cls_053">0 0 0  0 0 0 0  0 0 0 0</span></div>
<div style="position:absolute;left:152.20px;top:154.78px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.43px;top:154.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:276.69px;top:154.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:333.22px;top:154.78px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:430.63px;top:154.78px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:72.00px;top:175.63px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:196.97px" class="cls_055"><span class="cls_055">MFC1 rt, fs</span></div>
<div style="position:absolute;left:72.00px;top:217.63px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:235.97px" class="cls_055"><span class="cls_055">The contents of register </span><span class="cls_058">fs</span><span class="cls_055"> from the floating-point coprocessor are stored into processor register </span><span class="cls_058">rt</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.01px;top:254.97px" class="cls_055"><span class="cls_055">The contents of register </span><span class="cls_058">rt</span><span class="cls_055"> are undefined for time </span><span class="cls_058">T</span><span class="cls_055"> of the instruction immediately following this</span></div>
<div style="position:absolute;left:108.01px;top:267.97px" class="cls_055"><span class="cls_055">load instruction.</span></div>
<div style="position:absolute;left:72.00px;top:288.63px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:143.68px;top:311.53px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:179.68px;top:311.53px" class="cls_053"><span class="cls_053">data  </span><span class="cls_003">←</span><span class="cls_053">  CPR[1, fs];</span></div>
<div style="position:absolute;left:143.68px;top:324.53px" class="cls_053"><span class="cls_053">T+1:</span></div>
<div style="position:absolute;left:179.68px;top:324.53px" class="cls_053"><span class="cls_053">GPR[rt]  </span><span class="cls_003">←</span><span class="cls_053">  data</span></div>
<div style="position:absolute;left:72.00px;top:365.34px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:383.67px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:289.04px;top:755.34px" class="cls_002"><span class="cls_002">B-20</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:251828px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:521.04px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:239.13px;top:67.59px" class="cls_064"><span class="cls_064">Floating-Point Move</span></div>
<div style="position:absolute;left:107.37px;top:64.70px" class="cls_080"><span class="cls_080">MOV.fmt</span></div>
<div style="position:absolute;left:413.20px;top:64.70px" class="cls_080"><span class="cls_080">MOV.fmt</span></div>
<div style="position:absolute;left:118.43px;top:104.10px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:176.61px;top:104.09px" class="cls_053"><span class="cls_053">26 25</span></div>
<div style="position:absolute;left:233.41px;top:104.09px" class="cls_053"><span class="cls_053">21</span></div>
<div style="position:absolute;left:252.36px;top:104.09px" class="cls_053"><span class="cls_053">20</span></div>
<div style="position:absolute;left:290.23px;top:104.09px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:309.24px;top:104.09px" class="cls_053"><span class="cls_053">15</span></div>
<div style="position:absolute;left:348.03px;top:104.09px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:366.98px;top:104.09px" class="cls_053"><span class="cls_053">10</span></div>
<div style="position:absolute;left:408.51px;top:104.09px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:421.61px;top:104.09px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:488.11px;top:104.10px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:139.17px;top:128.07px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:211.65px;top:128.07px" class="cls_053"><span class="cls_053">fmt</span></div>
<div style="position:absolute;left:273.13px;top:128.07px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:327.89px;top:128.07px" class="cls_053"><span class="cls_053">fs</span></div>
<div style="position:absolute;left:384.42px;top:128.07px" class="cls_053"><span class="cls_053">fd</span></div>
<div style="position:absolute;left:444.45px;top:128.07px" class="cls_053"><span class="cls_053">MOV</span></div>
<div style="position:absolute;left:129.45px;top:140.52px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:256.77px;top:140.52px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:430.35px;top:140.52px" class="cls_053"><span class="cls_053">0 0 0 1 1 0</span></div>
<div style="position:absolute;left:151.01px;top:154.93px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:218.69px;top:154.93px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:273.13px;top:154.93px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:330.95px;top:154.93px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:386.82px;top:154.93px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:453.06px;top:154.93px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:178.63px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:199.97px" class="cls_055"><span class="cls_055">MOV.fmt fd, fs</span></div>
<div style="position:absolute;left:72.00px;top:220.63px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:238.97px" class="cls_058"><span class="cls_058">fd </span><span class="cls_003">←</span><span class="cls_058"> fs</span></div>
<div style="position:absolute;left:108.00px;top:257.97px" class="cls_055"><span class="cls_055">The contents of the FPU register specified by </span><span class="cls_058">fs </span><span class="cls_055">are interpreted in the specified </span><span class="cls_058">format</span><span class="cls_055"> and are copied</span></div>
<div style="position:absolute;left:108.00px;top:270.97px" class="cls_055"><span class="cls_055">into the FPU register specified by </span><span class="cls_058">fd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:289.97px" class="cls_055"><span class="cls_055">The move is non-arithmetic; it causes no IEEE 754 exceptions.</span></div>
<div style="position:absolute;left:108.00px;top:308.97px" class="cls_055"><span class="cls_055">This instruction is valid only for single- or double-precision floating-point formats.</span></div>
<div style="position:absolute;left:108.00px;top:327.97px" class="cls_055"><span class="cls_055">The fields </span><span class="cls_058">fs</span><span class="cls_055"> and </span><span class="cls_058">fd</span><span class="cls_055"> must specify valid operand registers for the type </span><span class="cls_058">fmt</span><span class="cls_055"> and the logical size of</span></div>
<div style="position:absolute;left:108.01px;top:340.97px" class="cls_055"><span class="cls_055">coprocessor 1 general registers.  If they are not valid specifiers, the result  is undefined.</span></div>
<div style="position:absolute;left:72.00px;top:361.63px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:108.39px;top:391.17px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:137.18px;top:391.17px" class="cls_053"><span class="cls_053">StoreFPR(fd, fmt, ValueFPR(fs, fmt))</span></div>
<div style="position:absolute;left:72.00px;top:432.03px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:450.37px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:108.00px;top:463.37px" class="cls_055"><span class="cls_055">Floating-Point exception</span></div>
<div style="position:absolute;left:72.00px;top:484.03px" class="cls_066"><span class="cls_066">Floating-Point Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:502.37px" class="cls_055"><span class="cls_055">Unimplemented operation exception</span></div>
<div style="position:absolute;left:302.79px;top:755.34px" class="cls_002"><span class="cls_002">B-21</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:252630px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:420.79px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:199.76px;top:65.47px" class="cls_079"><span class="cls_079">Move Word to Floating-Point (CP1)</span></div>
<div style="position:absolute;left:107.02px;top:61.35px" class="cls_063"><span class="cls_063">MTC1</span></div>
<div style="position:absolute;left:439.02px;top:61.35px" class="cls_063"><span class="cls_063">MTC1</span></div>
<div style="position:absolute;left:116.99px;top:103.74px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:172.65px;top:103.74px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:236.23px;top:103.74px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:295.92px;top:103.74px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:356.39px;top:103.74px" class="cls_053"><span class="cls_053">11 10</span></div>
<div style="position:absolute;left:492.20px;top:103.74px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:142.11px;top:127.79px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:211.72px;top:127.79px" class="cls_053"><span class="cls_053">MT</span></div>
<div style="position:absolute;left:273.70px;top:127.79px" class="cls_053"><span class="cls_053">rt</span></div>
<div style="position:absolute;left:335.87px;top:127.78px" class="cls_053"><span class="cls_053">fs</span></div>
<div style="position:absolute;left:429.57px;top:126.27px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:131.67px;top:137.36px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:200.75px;top:137.36px" class="cls_053"><span class="cls_053">0 0 1 0 0</span></div>
<div style="position:absolute;left:385.91px;top:137.36px" class="cls_053"><span class="cls_053">0 0 0  0 0 0 0  0 0 0 0</span></div>
<div style="position:absolute;left:152.41px;top:151.77px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.93px;top:151.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:277.56px;top:151.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:334.36px;top:151.76px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:432.28px;top:151.76px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:72.00px;top:175.63px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:196.97px" class="cls_055"><span class="cls_055">MTC1 rt, fs</span></div>
<div style="position:absolute;left:72.00px;top:217.63px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:235.97px" class="cls_055"><span class="cls_055">The contents of register </span><span class="cls_058">rt </span><span class="cls_055">are loaded into the FPU general register at location </span><span class="cls_058">fs</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.00px;top:254.97px" class="cls_055"><span class="cls_055">The contents of floating-point register </span><span class="cls_058">fs</span><span class="cls_055"> is undefined for time </span><span class="cls_058">T</span><span class="cls_055"> of the instruction immediately</span></div>
<div style="position:absolute;left:108.00px;top:267.97px" class="cls_055"><span class="cls_055">following this load instruction.</span></div>
<div style="position:absolute;left:72.00px;top:307.63px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:180.02px;top:333.12px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:216.02px;top:333.12px" class="cls_053"><span class="cls_053">data  </span><span class="cls_003">←  </span><span class="cls_053">GPR[rt]</span></div>
<div style="position:absolute;left:180.02px;top:346.12px" class="cls_053"><span class="cls_053">T+1:</span></div>
<div style="position:absolute;left:216.02px;top:346.12px" class="cls_053"><span class="cls_053">CPR[1, fs] </span><span class="cls_003">←</span><span class="cls_053"> data</span></div>
<div style="position:absolute;left:72.00px;top:419.34px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:437.67px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:289.04px;top:755.34px" class="cls_002"><span class="cls_002">B-22</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:253432px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:521.04px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:231.25px;top:69.07px" class="cls_064"><span class="cls_064">Floating-Point Multiply</span></div>
<div style="position:absolute;left:107.41px;top:66.17px" class="cls_080"><span class="cls_080">MUL.fmt</span></div>
<div style="position:absolute;left:414.74px;top:66.17px" class="cls_080"><span class="cls_080">MUL.fmt</span></div>
<div style="position:absolute;left:116.99px;top:103.75px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:175.46px;top:103.75px" class="cls_053"><span class="cls_053">26 25</span></div>
<div style="position:absolute;left:232.48px;top:103.75px" class="cls_053"><span class="cls_053">21</span></div>
<div style="position:absolute;left:251.42px;top:103.75px" class="cls_053"><span class="cls_053">20</span></div>
<div style="position:absolute;left:289.44px;top:103.75px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:308.46px;top:103.75px" class="cls_053"><span class="cls_053">15</span></div>
<div style="position:absolute;left:347.46px;top:103.75px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:366.47px;top:103.75px" class="cls_053"><span class="cls_053">10</span></div>
<div style="position:absolute;left:407.42px;top:103.75px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:420.45px;top:103.75px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:487.98px;top:103.75px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:137.95px;top:126.13px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:213.67px;top:126.13px" class="cls_053"><span class="cls_053">fmt</span></div>
<div style="position:absolute;left:272.26px;top:126.13px" class="cls_053"><span class="cls_053">ft</span></div>
<div style="position:absolute;left:327.24px;top:126.13px" class="cls_053"><span class="cls_053">fs</span></div>
<div style="position:absolute;left:383.99px;top:126.13px" class="cls_053"><span class="cls_053">fd</span></div>
<div style="position:absolute;left:445.00px;top:126.13px" class="cls_053"><span class="cls_053">MUL</span></div>
<div style="position:absolute;left:127.43px;top:137.72px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:430.71px;top:137.72px" class="cls_053"><span class="cls_053">0 0 0 0 1 0</span></div>
<div style="position:absolute;left:149.72px;top:151.12px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:220.71px;top:151.12px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:272.26px;top:151.12px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:330.22px;top:151.12px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:386.31px;top:151.12px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:452.77px;top:151.12px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:176.26px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:197.59px" class="cls_055"><span class="cls_055">MUL.fmt fd, fs, ft</span></div>
<div style="position:absolute;left:72.00px;top:212.26px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:230.59px" class="cls_058"><span class="cls_058">fd </span><span class="cls_003">←</span><span class="cls_058"> fs </span><span class="cls_003">×</span><span class="cls_058"> ft</span></div>
<div style="position:absolute;left:108.01px;top:249.59px" class="cls_055"><span class="cls_055">The contents of the floating-point registers specified by </span><span class="cls_058">fs</span><span class="cls_055"> and </span><span class="cls_058">ft</span><span class="cls_055"> are interpreted in the specified</span></div>
<div style="position:absolute;left:108.02px;top:262.59px" class="cls_058"><span class="cls_058">format</span><span class="cls_055"> and arithmetically multiplied.  The result is rounded as if calculated to infinite precision and</span></div>
<div style="position:absolute;left:108.02px;top:275.59px" class="cls_055"><span class="cls_055">then rounded to the specified </span><span class="cls_058">format</span><span class="cls_055">, according to the current rounding mode.  The result is placed</span></div>
<div style="position:absolute;left:108.02px;top:288.59px" class="cls_055"><span class="cls_055">in the floating-point register specified by </span><span class="cls_058">fd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.02px;top:307.59px" class="cls_055"><span class="cls_055">This instruction is valid only for single- or double-precision floating-point formats.</span></div>
<div style="position:absolute;left:108.02px;top:326.59px" class="cls_055"><span class="cls_055">The fields </span><span class="cls_058">fs</span><span class="cls_055">, </span><span class="cls_058">ft</span><span class="cls_055">, and </span><span class="cls_058">fd</span><span class="cls_055"> must specify valid operand registers, given the logical size of coprocessor 1</span></div>
<div style="position:absolute;left:108.03px;top:339.59px" class="cls_055"><span class="cls_055">general registers, for the type </span><span class="cls_058">fmt</span><span class="cls_055">.  If they are not valid specifiers, the result  is undefined.</span></div>
<div style="position:absolute;left:72.00px;top:354.26px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:107.73px;top:382.99px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:136.53px;top:382.99px" class="cls_053"><span class="cls_053">StoreFPR (fd, fmt, ValueFPR(fs, fmt) * ValueFPR(ft, fmt))</span></div>
<div style="position:absolute;left:72.00px;top:411.64px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:429.98px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:110.50px;top:442.98px" class="cls_055"><span class="cls_055">Floating-Point exception</span></div>
<div style="position:absolute;left:72.00px;top:457.65px" class="cls_066"><span class="cls_066">Floating-Point Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:475.98px" class="cls_055"><span class="cls_055">Unimplemented operation exception</span></div>
<div style="position:absolute;left:108.00px;top:488.98px" class="cls_055"><span class="cls_055">Invalid operation exception</span></div>
<div style="position:absolute;left:108.00px;top:501.98px" class="cls_055"><span class="cls_055">Inexact exception</span></div>
<div style="position:absolute;left:108.00px;top:514.98px" class="cls_055"><span class="cls_055">Overflow exception</span></div>
<div style="position:absolute;left:108.00px;top:527.98px" class="cls_055"><span class="cls_055">Underflow exception</span></div>
<div style="position:absolute;left:302.79px;top:755.34px" class="cls_002"><span class="cls_002">B-23</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:254234px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:420.79px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:106.56px;top:64.70px" class="cls_080"><span class="cls_080">NEG.fmt</span><span class="cls_064">    Floating-Point Negate</span></div>
<div style="position:absolute;left:416.73px;top:64.70px" class="cls_080"><span class="cls_080">NEG.fmt</span></div>
<div style="position:absolute;left:116.26px;top:103.67px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:175.03px;top:103.67px" class="cls_053"><span class="cls_053">26 25</span></div>
<div style="position:absolute;left:232.41px;top:103.67px" class="cls_053"><span class="cls_053">21</span></div>
<div style="position:absolute;left:251.42px;top:103.67px" class="cls_053"><span class="cls_053">20</span></div>
<div style="position:absolute;left:289.66px;top:103.67px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:308.81px;top:103.67px" class="cls_053"><span class="cls_053">15</span></div>
<div style="position:absolute;left:347.89px;top:103.67px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:367.04px;top:103.67px" class="cls_053"><span class="cls_053">10</span></div>
<div style="position:absolute;left:406.64px;top:103.67px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:420.11px;top:103.67px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:489.35px;top:103.67px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:137.37px;top:127.65px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:212.16px;top:127.65px" class="cls_053"><span class="cls_053">fmt</span></div>
<div style="position:absolute;left:272.42px;top:127.65px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:327.62px;top:127.65px" class="cls_053"><span class="cls_053">fs</span></div>
<div style="position:absolute;left:384.73px;top:127.65px" class="cls_053"><span class="cls_053">fd</span></div>
<div style="position:absolute;left:445.96px;top:127.65px" class="cls_053"><span class="cls_053">NEG</span></div>
<div style="position:absolute;left:126.28px;top:140.17px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:256.62px;top:140.17px" class="cls_053"><span class="cls_053">0 0 0 0 0</span></div>
<div style="position:absolute;left:432.58px;top:140.17px" class="cls_053"><span class="cls_053">0 0 0 1 1 1</span></div>
<div style="position:absolute;left:149.14px;top:154.58px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:219.20px;top:154.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:272.41px;top:154.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:330.73px;top:154.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:387.05px;top:154.58px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:454.01px;top:154.58px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:178.63px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:199.97px" class="cls_055"><span class="cls_055">NEG.fmt fd, fs</span></div>
<div style="position:absolute;left:72.00px;top:220.63px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:238.97px" class="cls_058"><span class="cls_058">fd </span><span class="cls_003">←</span><span class="cls_058">  - fs</span></div>
<div style="position:absolute;left:108.00px;top:257.97px" class="cls_055"><span class="cls_055">The contents of the FPU register specified by </span><span class="cls_058">fs </span><span class="cls_055">are interpreted in the specified </span><span class="cls_058">format</span><span class="cls_055"> and the</span></div>
<div style="position:absolute;left:108.00px;top:270.97px" class="cls_055"><span class="cls_055">arithmetic negation is taken (polarity of the sign-bit is changed).  The result is placed in the FPU</span></div>
<div style="position:absolute;left:108.00px;top:283.97px" class="cls_055"><span class="cls_055">register specified by </span><span class="cls_058">fd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.01px;top:302.97px" class="cls_055"><span class="cls_055">The negate operation is arithmetic; an NaN operand signals invalid operation.</span></div>
<div style="position:absolute;left:108.01px;top:321.97px" class="cls_055"><span class="cls_055">The fields </span><span class="cls_058">fs</span><span class="cls_055"> and </span><span class="cls_058">fd</span><span class="cls_055"> must specify valid operand registers for the type </span><span class="cls_058">fmt</span><span class="cls_055"> and the logical size of</span></div>
<div style="position:absolute;left:108.02px;top:334.97px" class="cls_055"><span class="cls_055">coprocessor 1 general registers.  If they are not valid specifiers, the result  is undefined.</span></div>
<div style="position:absolute;left:72.00px;top:355.63px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:108.91px;top:388.13px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:137.71px;top:388.13px" class="cls_053"><span class="cls_053">StoreFPR(fd, fmt, Negate(ValueFPR(fs, fmt)))</span></div>
<div style="position:absolute;left:72.00px;top:424.03px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:442.37px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:108.00px;top:455.37px" class="cls_055"><span class="cls_055">Floating-Point exception</span></div>
<div style="position:absolute;left:72.00px;top:476.03px" class="cls_066"><span class="cls_066">Floating-Point Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:494.37px" class="cls_055"><span class="cls_055">Unimplemented operation exception</span></div>
<div style="position:absolute;left:108.00px;top:507.37px" class="cls_055"><span class="cls_055">Invalid operation exception</span></div>
<div style="position:absolute;left:289.04px;top:755.34px" class="cls_002"><span class="cls_002">B-24</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:255036px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:521.04px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:228.63px;top:68.18px" class="cls_064"><span class="cls_064">Floating-Point Subtract</span></div>
<div style="position:absolute;left:103.62px;top:65.03px" class="cls_080"><span class="cls_080">SUB.fmt</span></div>
<div style="position:absolute;left:415.12px;top:65.03px" class="cls_080"><span class="cls_080">SUB.fmt</span></div>
<div style="position:absolute;left:118.86px;top:104.62px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:177.19px;top:104.62px" class="cls_053"><span class="cls_053">26 25</span></div>
<div style="position:absolute;left:234.06px;top:104.62px" class="cls_053"><span class="cls_053">21</span></div>
<div style="position:absolute;left:252.93px;top:104.62px" class="cls_053"><span class="cls_053">20</span></div>
<div style="position:absolute;left:290.88px;top:104.62px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:309.83px;top:104.62px" class="cls_053"><span class="cls_053">15</span></div>
<div style="position:absolute;left:348.68px;top:104.62px" class="cls_053"><span class="cls_053">11</span></div>
<div style="position:absolute;left:367.62px;top:104.62px" class="cls_053"><span class="cls_053">10</span></div>
<div style="position:absolute;left:409.36px;top:104.62px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:422.39px;top:104.62px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:488.84px;top:104.62px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:139.75px;top:127.00px" class="cls_053"><span class="cls_053">COP1</span></div>
<div style="position:absolute;left:210.72px;top:127.00px" class="cls_053"><span class="cls_053">fmt</span></div>
<div style="position:absolute;left:273.70px;top:127.00px" class="cls_053"><span class="cls_053">ft</span></div>
<div style="position:absolute;left:328.54px;top:127.00px" class="cls_053"><span class="cls_053">fs</span></div>
<div style="position:absolute;left:385.14px;top:127.00px" class="cls_053"><span class="cls_053">fd</span></div>
<div style="position:absolute;left:449.45px;top:127.00px" class="cls_053"><span class="cls_053">SUB</span></div>
<div style="position:absolute;left:129.16px;top:138.59px" class="cls_053"><span class="cls_053">0 1 0 0 0 1</span></div>
<div style="position:absolute;left:436.11px;top:138.59px" class="cls_053"><span class="cls_053">0 0 0 0 0 1</span></div>
<div style="position:absolute;left:151.52px;top:151.99px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:217.76px;top:151.99px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:273.70px;top:151.99px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:331.52px;top:151.99px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:387.46px;top:151.99px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:453.77px;top:151.99px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:174.71px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:196.04px" class="cls_055"><span class="cls_055">SUB.fmt fd, fs, ft</span></div>
<div style="position:absolute;left:72.00px;top:216.71px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:235.04px" class="cls_055"><span class="cls_055">The contents of the floating-point registers specified by </span><span class="cls_058">fs</span><span class="cls_055"> and </span><span class="cls_058">ft</span><span class="cls_055"> are interpreted in the specified</span></div>
<div style="position:absolute;left:108.01px;top:248.04px" class="cls_058"><span class="cls_058">format</span><span class="cls_055"> and arithmetically subtracted.  The result is rounded as if calculated to infinite precision and</span></div>
<div style="position:absolute;left:108.01px;top:261.04px" class="cls_055"><span class="cls_055">then rounded to the specified </span><span class="cls_058">format</span><span class="cls_055">, according to the current rounding mode.  The result is placed</span></div>
<div style="position:absolute;left:108.01px;top:274.04px" class="cls_055"><span class="cls_055">in the floating-point register specified by </span><span class="cls_058">fd</span><span class="cls_055">.</span></div>
<div style="position:absolute;left:108.01px;top:293.04px" class="cls_055"><span class="cls_055">This instruction is valid only for single- or double-precision floating-point formats.</span></div>
<div style="position:absolute;left:108.01px;top:312.04px" class="cls_055"><span class="cls_055">The fields </span><span class="cls_058">fs</span><span class="cls_055">, </span><span class="cls_058">ft</span><span class="cls_055">, and </span><span class="cls_058">fd</span><span class="cls_055"> must specify valid operand registers, given the logical size of coprocessor 1</span></div>
<div style="position:absolute;left:108.02px;top:325.04px" class="cls_055"><span class="cls_055">general registers, for the type </span><span class="cls_058">fmt</span><span class="cls_055">.  If they are not valid specifiers, the result  is undefined.</span></div>
<div style="position:absolute;left:72.00px;top:365.70px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:107.94px;top:391.20px" class="cls_053"><span class="cls_053">T:   StoreFPR (fd, fmt, ValueFPR(fs, fmt) -  ValueFPR(ft, fmt))</span></div>
<div style="position:absolute;left:72.00px;top:413.96px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:432.30px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:108.00px;top:445.30px" class="cls_055"><span class="cls_055">Floating-Point exception</span></div>
<div style="position:absolute;left:72.00px;top:459.96px" class="cls_066"><span class="cls_066">Floating-Point Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:478.30px" class="cls_055"><span class="cls_055">Unimplemented operation exception</span></div>
<div style="position:absolute;left:108.00px;top:491.30px" class="cls_055"><span class="cls_055">Invalid operation exception</span></div>
<div style="position:absolute;left:108.00px;top:504.29px" class="cls_055"><span class="cls_055">Inexact exception</span></div>
<div style="position:absolute;left:108.00px;top:517.29px" class="cls_055"><span class="cls_055">Overflow exception</span></div>
<div style="position:absolute;left:108.00px;top:530.29px" class="cls_055"><span class="cls_055">Underflow exception</span></div>
<div style="position:absolute;left:302.79px;top:755.34px" class="cls_002"><span class="cls_002">B-25</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:255838px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:420.79px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:268.29px;top:60.84px" class="cls_064"><span class="cls_064">Store Word</span></div>
<div style="position:absolute;left:107.47px;top:60.70px" class="cls_063"><span class="cls_063">SWC1</span></div>
<div style="position:absolute;left:437.31px;top:60.70px" class="cls_063"><span class="cls_063">SWC1</span></div>
<div style="position:absolute;left:221.25px;top:75.76px" class="cls_064"><span class="cls_064">from Floating-Point (CP1)</span></div>
<div style="position:absolute;left:116.21px;top:103.74px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:171.44px;top:103.74px" class="cls_053"><span class="cls_053">26  25</span></div>
<div style="position:absolute;left:234.66px;top:103.74px" class="cls_053"><span class="cls_053">21  20</span></div>
<div style="position:absolute;left:293.92px;top:103.74px" class="cls_053"><span class="cls_053">16  15</span></div>
<div style="position:absolute;left:488.90px;top:103.74px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:140.29px;top:127.79px" class="cls_053"><span class="cls_053">SWC1</span></div>
<div style="position:absolute;left:206.68px;top:127.79px" class="cls_053"><span class="cls_053">base</span></div>
<div style="position:absolute;left:272.13px;top:127.79px" class="cls_053"><span class="cls_053">ft</span></div>
<div style="position:absolute;left:387.59px;top:126.35px" class="cls_053"><span class="cls_053">offset</span></div>
<div style="position:absolute;left:130.96px;top:137.36px" class="cls_053"><span class="cls_053">1 1 1 0 0 1</span></div>
<div style="position:absolute;left:151.42px;top:151.77px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:216.51px;top:151.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:275.69px;top:151.77px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:388.66px;top:151.77px" class="cls_053"><span class="cls_053">16</span></div>
<div style="position:absolute;left:72.00px;top:176.63px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:197.97px" class="cls_055"><span class="cls_055">SWC1 ft, offset(base)</span></div>
<div style="position:absolute;left:72.00px;top:218.63px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:236.97px" class="cls_055"><span class="cls_055">The 16-bit </span><span class="cls_058">offset</span><span class="cls_055"> is sign-extended and added to the contents of general register </span><span class="cls_058">base</span><span class="cls_055"> to form an</span></div>
<div style="position:absolute;left:108.00px;top:249.97px" class="cls_055"><span class="cls_055">unsigned effective address.  The word from  floating-point (coprocessor 1) general register </span><span class="cls_058">ft</span><span class="cls_055"> is</span></div>
<div style="position:absolute;left:108.00px;top:262.97px" class="cls_055"><span class="cls_055">stored at the memory location specified by the effective address.</span></div>
<div style="position:absolute;left:108.00px;top:281.97px" class="cls_055"><span class="cls_055">The effective address must be word-aligned.  If either of the two least-significant bits of the effective</span></div>
<div style="position:absolute;left:108.00px;top:294.97px" class="cls_055"><span class="cls_055">address is non-zero, an address error exception occurs.</span></div>
<div style="position:absolute;left:72.00px;top:315.63px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:119.00px;top:338.07px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:155.00px;top:336.07px" class="cls_053"><span class="cls_053">vAddr </span><span class="cls_003">← </span><span class="cls_053">((offset</span><span class="cls_061"><sub>15</sub></span><span class="cls_053">)</span><span class="cls_061"><sup>GPRlen-16</sup></span><span class="cls_053"> || offset</span><span class="cls_061"><sub>15...0</sub></span><span class="cls_053">)</span><span class="cls_061"><sub> </sub></span><span class="cls_053">+ GPR[base]</span></div>
<div style="position:absolute;left:155.00px;top:351.07px" class="cls_053"><span class="cls_053">(pAddr, uncached) </span><span class="cls_003">←</span><span class="cls_053"> AddressTranslation (vAddr, DATA)</span></div>
<div style="position:absolute;left:155.00px;top:364.07px" class="cls_053"><span class="cls_053">data </span><span class="cls_003">←</span><span class="cls_053"> CPR[1, ft]</span></div>
<div style="position:absolute;left:155.00px;top:377.07px" class="cls_053"><span class="cls_053">StoreMemory (uncached, WORD, data, pAddr, vAddr, DATA)</span></div>
<div style="position:absolute;left:74.75px;top:428.33px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:446.67px" class="cls_055"><span class="cls_055">Coprocessor unusable</span></div>
<div style="position:absolute;left:108.00px;top:459.67px" class="cls_055"><span class="cls_055">TLB refill exception</span></div>
<div style="position:absolute;left:108.00px;top:472.67px" class="cls_055"><span class="cls_055">TLB invalid exception</span></div>
<div style="position:absolute;left:108.00px;top:485.67px" class="cls_055"><span class="cls_055">TLB modification exception</span></div>
<div style="position:absolute;left:108.00px;top:498.67px" class="cls_055"><span class="cls_055">Bus error exception</span></div>
<div style="position:absolute;left:108.00px;top:511.67px" class="cls_055"><span class="cls_055">Address error exception</span></div>
<div style="position:absolute;left:289.04px;top:755.34px" class="cls_002"><span class="cls_002">B-26</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:256640px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:521.04px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:72.00px;top:50.00px" class="cls_015"><span class="cls_015">FPA Instruction Set Summary</span></div>
<div style="position:absolute;left:138.78px;top:75.00px" class="cls_027"><span class="cls_027">Instr Fields</span></div>
<div style="position:absolute;left:82.02px;top:96.00px" class="cls_027"><span class="cls_027">op</span></div>
<div style="position:absolute;left:233.95px;top:96.00px" class="cls_027"><span class="cls_027">func</span></div>
<div style="position:absolute;left:268.84px;top:95.00px" class="cls_027"><span class="cls_027">Asm</span></div>
<div style="position:absolute;left:337.70px;top:95.00px" class="cls_027"><span class="cls_027">Description</span></div>
<div style="position:absolute;left:77.18px;top:117.67px" class="cls_076"><span class="cls_076">31-26</span></div>
<div style="position:absolute;left:108.56px;top:117.67px" class="cls_076"><span class="cls_076">25-21</span></div>
<div style="position:absolute;left:139.93px;top:117.67px" class="cls_076"><span class="cls_076">20-16</span></div>
<div style="position:absolute;left:171.31px;top:117.67px" class="cls_076"><span class="cls_076">15-11</span></div>
<div style="position:absolute;left:205.05px;top:117.67px" class="cls_076"><span class="cls_076">10-6</span></div>
<div style="position:absolute;left:238.79px;top:117.67px" class="cls_076"><span class="cls_076">5-0</span></div>
<div style="position:absolute;left:76.00px;top:134.00px" class="cls_020"><span class="cls_020">Single Precision Arithmetic Instructions</span></div>
<div style="position:absolute;left:301.52px;top:150.99px" class="cls_020"><span class="cls_020">3-operand single precision</span></div>
<div style="position:absolute;left:82.11px;top:156.00px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:156.00px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.90px;top:156.00px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:175.30px;top:156.00px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:209.03px;top:156.00px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:241.84px;top:156.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:264.33px;top:156.00px" class="cls_020"><span class="cls_020">add.s</span></div>
<div style="position:absolute;left:301.52px;top:160.99px" class="cls_020"><span class="cls_020">add.</span></div>
<div style="position:absolute;left:301.52px;top:177.99px" class="cls_020"><span class="cls_020">3-operand   single   precision</span></div>
<div style="position:absolute;left:82.11px;top:183.49px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:183.49px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.90px;top:183.49px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:175.30px;top:183.49px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:209.03px;top:183.49px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:241.84px;top:183.49px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:264.32px;top:183.49px" class="cls_020"><span class="cls_020">sub.s</span></div>
<div style="position:absolute;left:301.52px;top:188.99px" class="cls_020"><span class="cls_020">subtraction.</span></div>
<div style="position:absolute;left:301.52px;top:205.98px" class="cls_020"><span class="cls_020">3-operand single precision</span></div>
<div style="position:absolute;left:82.11px;top:210.99px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:210.99px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.90px;top:210.99px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:175.30px;top:210.99px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:209.03px;top:210.99px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:241.84px;top:210.99px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:264.32px;top:210.99px" class="cls_020"><span class="cls_020">mul.s</span></div>
<div style="position:absolute;left:301.52px;top:215.98px" class="cls_020"><span class="cls_020">multiply.</span></div>
<div style="position:absolute;left:301.52px;top:232.97px" class="cls_020"><span class="cls_020">3-operand single precision</span></div>
<div style="position:absolute;left:82.11px;top:237.98px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:237.98px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.90px;top:237.98px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:175.30px;top:237.98px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:209.03px;top:237.98px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:241.84px;top:237.98px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:264.32px;top:237.98px" class="cls_020"><span class="cls_020">div.s</span></div>
<div style="position:absolute;left:301.52px;top:242.97px" class="cls_020"><span class="cls_020">divide.</span></div>
<div style="position:absolute;left:301.52px;top:259.97px" class="cls_020"><span class="cls_020">Single-precision</span></div>
<div style="position:absolute;left:391.03px;top:259.97px" class="cls_020"><span class="cls_020">absolute</span></div>
<div style="position:absolute;left:82.11px;top:265.47px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:265.47px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:147.66px;top:265.47px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:178.04px;top:265.47px" class="cls_020"><span class="cls_020">fs</span></div>
<div style="position:absolute;left:208.97px;top:265.47px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:241.78px;top:265.47px" class="cls_020"><span class="cls_020">5</span></div>
<div style="position:absolute;left:264.25px;top:265.47px" class="cls_020"><span class="cls_020">abs.s</span></div>
<div style="position:absolute;left:301.52px;top:270.97px" class="cls_020"><span class="cls_020">value of fs is placed into fd.</span></div>
<div style="position:absolute;left:301.52px;top:287.97px" class="cls_020"><span class="cls_020">Single precision move of val-</span></div>
<div style="position:absolute;left:82.11px;top:293.47px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:293.47px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:147.66px;top:293.47px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:178.04px;top:293.47px" class="cls_020"><span class="cls_020">fs</span></div>
<div style="position:absolute;left:208.97px;top:293.47px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:241.78px;top:293.47px" class="cls_020"><span class="cls_020">6</span></div>
<div style="position:absolute;left:264.25px;top:293.47px" class="cls_020"><span class="cls_020">mov.s</span></div>
<div style="position:absolute;left:301.52px;top:298.97px" class="cls_020"><span class="cls_020">ue in fs into fd.</span></div>
<div style="position:absolute;left:75.99px;top:315.97px" class="cls_020"><span class="cls_020">Format Conversion</span></div>
<div style="position:absolute;left:301.51px;top:332.96px" class="cls_020"><span class="cls_020">Convert a double precision</span></div>
<div style="position:absolute;left:82.10px;top:337.97px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:337.97px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:147.65px;top:337.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:178.03px;top:337.97px" class="cls_020"><span class="cls_020">fs</span></div>
<div style="position:absolute;left:208.96px;top:337.97px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:238.99px;top:337.97px" class="cls_020"><span class="cls_020">32</span></div>
<div style="position:absolute;left:264.26px;top:337.97px" class="cls_020"><span class="cls_020">cvt.s.d</span></div>
<div style="position:absolute;left:301.51px;top:342.96px" class="cls_020"><span class="cls_020">value to single precision.</span></div>
<div style="position:absolute;left:301.51px;top:359.95px" class="cls_020"><span class="cls_020">Convert a single precision</span></div>
<div style="position:absolute;left:82.10px;top:364.96px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:364.96px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:147.65px;top:364.96px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:178.03px;top:364.96px" class="cls_020"><span class="cls_020">fs</span></div>
<div style="position:absolute;left:208.96px;top:364.96px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:238.99px;top:364.96px" class="cls_020"><span class="cls_020">33</span></div>
<div style="position:absolute;left:264.26px;top:364.96px" class="cls_020"><span class="cls_020">cvt.d.s</span></div>
<div style="position:absolute;left:301.51px;top:369.95px" class="cls_020"><span class="cls_020">value to double precision.</span></div>
<div style="position:absolute;left:264.04px;top:386.95px" class="cls_020"><span class="cls_020">cvt.s.</span></div>
<div style="position:absolute;left:301.51px;top:386.95px" class="cls_020"><span class="cls_020">Convert an integer “word”</span></div>
<div style="position:absolute;left:82.10px;top:391.95px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:391.95px" class="cls_020"><span class="cls_020">20</span></div>
<div style="position:absolute;left:147.65px;top:391.95px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:178.03px;top:391.95px" class="cls_020"><span class="cls_020">fs</span></div>
<div style="position:absolute;left:208.96px;top:391.95px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:238.99px;top:391.95px" class="cls_020"><span class="cls_020">32</span></div>
<div style="position:absolute;left:264.04px;top:396.94px" class="cls_020"><span class="cls_020">w</span></div>
<div style="position:absolute;left:301.51px;top:396.94px" class="cls_020"><span class="cls_020">value to single precision.</span></div>
<div style="position:absolute;left:264.04px;top:413.94px" class="cls_020"><span class="cls_020">cvt.d.</span></div>
<div style="position:absolute;left:301.51px;top:413.94px" class="cls_020"><span class="cls_020">Convert an integer “word”</span></div>
<div style="position:absolute;left:82.10px;top:418.94px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:418.94px" class="cls_020"><span class="cls_020">20</span></div>
<div style="position:absolute;left:147.65px;top:418.94px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:178.03px;top:418.94px" class="cls_020"><span class="cls_020">fs</span></div>
<div style="position:absolute;left:208.96px;top:418.94px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:238.99px;top:418.94px" class="cls_020"><span class="cls_020">33</span></div>
<div style="position:absolute;left:264.04px;top:423.93px" class="cls_020"><span class="cls_020">w</span></div>
<div style="position:absolute;left:301.51px;top:423.93px" class="cls_020"><span class="cls_020">value to double precision.</span></div>
<div style="position:absolute;left:264.04px;top:441.43px" class="cls_020"><span class="cls_020">cvt.w.</span></div>
<div style="position:absolute;left:301.51px;top:440.93px" class="cls_020"><span class="cls_020">Convert  a  single  precision</span></div>
<div style="position:absolute;left:82.10px;top:446.43px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:446.43px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:147.65px;top:446.43px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:178.03px;top:446.43px" class="cls_020"><span class="cls_020">fs</span></div>
<div style="position:absolute;left:208.96px;top:446.43px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:238.99px;top:446.43px" class="cls_020"><span class="cls_020">36</span></div>
<div style="position:absolute;left:264.04px;top:451.43px" class="cls_020"><span class="cls_020">s</span></div>
<div style="position:absolute;left:301.51px;top:451.92px" class="cls_020"><span class="cls_020">value to a word value.</span></div>
<div style="position:absolute;left:264.04px;top:469.42px" class="cls_020"><span class="cls_020">cvt.w.</span></div>
<div style="position:absolute;left:301.51px;top:468.92px" class="cls_020"><span class="cls_020">Convert a double precision</span></div>
<div style="position:absolute;left:82.10px;top:474.42px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:474.42px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:147.65px;top:474.42px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:178.03px;top:474.42px" class="cls_020"><span class="cls_020">fs</span></div>
<div style="position:absolute;left:208.96px;top:474.42px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:238.99px;top:474.42px" class="cls_020"><span class="cls_020">36</span></div>
<div style="position:absolute;left:264.04px;top:479.42px" class="cls_020"><span class="cls_020">d</span></div>
<div style="position:absolute;left:301.51px;top:479.92px" class="cls_020"><span class="cls_020">value to a word value</span></div>
<div style="position:absolute;left:75.98px;top:496.92px" class="cls_020"><span class="cls_020">Single Precision Comparison Operations:</span></div>
<div style="position:absolute;left:75.98px;top:506.91px" class="cls_020"><span class="cls_020">No Invalid Operation Exception taken for Unordered Operands</span></div>
<div style="position:absolute;left:82.09px;top:523.92px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:523.92px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.88px;top:523.92px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:523.92px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.44px;top:523.92px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:523.92px" class="cls_020"><span class="cls_020">48</span></div>
<div style="position:absolute;left:264.30px;top:523.92px" class="cls_020"><span class="cls_020">c.f.s</span></div>
<div style="position:absolute;left:301.86px;top:523.92px" class="cls_020"><span class="cls_020">Result will be false</span></div>
<div style="position:absolute;left:301.50px;top:540.92px" class="cls_020"><span class="cls_020">True if fp values are “unor-</span></div>
<div style="position:absolute;left:82.09px;top:546.42px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:546.42px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.88px;top:546.42px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:546.42px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.44px;top:546.42px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:546.42px" class="cls_020"><span class="cls_020">49</span></div>
<div style="position:absolute;left:264.30px;top:546.42px" class="cls_020"><span class="cls_020">c.un.s</span></div>
<div style="position:absolute;left:301.50px;top:551.91px" class="cls_020"><span class="cls_020">dered”</span></div>
<div style="position:absolute;left:301.50px;top:568.91px" class="cls_020"><span class="cls_020">True if the two values are</span></div>
<div style="position:absolute;left:82.09px;top:573.91px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:573.91px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.88px;top:573.91px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:573.91px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.44px;top:573.91px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:573.91px" class="cls_020"><span class="cls_020">50</span></div>
<div style="position:absolute;left:264.30px;top:573.91px" class="cls_020"><span class="cls_020">c.eq.s</span></div>
<div style="position:absolute;left:301.50px;top:578.91px" class="cls_020"><span class="cls_020">equal</span></div>
<div style="position:absolute;left:264.03px;top:595.90px" class="cls_020"><span class="cls_020">c.ueq.</span></div>
<div style="position:absolute;left:301.50px;top:595.90px" class="cls_020"><span class="cls_020">True if equal or unordered.</span></div>
<div style="position:absolute;left:82.09px;top:600.90px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:600.90px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.88px;top:600.90px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:600.90px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.44px;top:600.90px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:600.90px" class="cls_020"><span class="cls_020">51</span></div>
<div style="position:absolute;left:264.03px;top:605.90px" class="cls_020"><span class="cls_020">s</span></div>
<div style="position:absolute;left:264.03px;top:622.90px" class="cls_020"><span class="cls_020">c.ueq.</span></div>
<div style="position:absolute;left:301.50px;top:622.90px" class="cls_020"><span class="cls_020">True if equal or unordered.</span></div>
<div style="position:absolute;left:82.09px;top:627.90px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:627.90px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.88px;top:627.90px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:627.90px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.44px;top:627.90px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:627.90px" class="cls_020"><span class="cls_020">51</span></div>
<div style="position:absolute;left:264.03px;top:632.90px" class="cls_020"><span class="cls_020">s</span></div>
<div style="position:absolute;left:82.09px;top:649.90px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:649.90px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.88px;top:649.90px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:649.90px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.44px;top:649.90px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:649.90px" class="cls_020"><span class="cls_020">52</span></div>
<div style="position:absolute;left:264.30px;top:649.90px" class="cls_020"><span class="cls_020">c.olt.s</span></div>
<div style="position:absolute;left:301.89px;top:649.90px" class="cls_020"><span class="cls_020">True if ordered and less than</span></div>
<div style="position:absolute;left:301.50px;top:666.90px" class="cls_020"><span class="cls_020">True  if  unordered  or  less</span></div>
<div style="position:absolute;left:82.09px;top:672.40px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:672.40px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.88px;top:672.40px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:672.40px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.44px;top:672.40px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:672.40px" class="cls_020"><span class="cls_020">53</span></div>
<div style="position:absolute;left:264.30px;top:672.40px" class="cls_020"><span class="cls_020">c.ult.s</span></div>
<div style="position:absolute;left:301.50px;top:677.90px" class="cls_020"><span class="cls_020">than</span></div>
<div style="position:absolute;left:301.50px;top:694.90px" class="cls_020"><span class="cls_020">Ordered and (equal or less</span></div>
<div style="position:absolute;left:82.09px;top:700.40px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:700.40px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.88px;top:700.40px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:700.40px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.44px;top:700.40px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:700.40px" class="cls_020"><span class="cls_020">54</span></div>
<div style="position:absolute;left:264.30px;top:700.40px" class="cls_020"><span class="cls_020">c.ole.s</span></div>
<div style="position:absolute;left:301.50px;top:705.90px" class="cls_020"><span class="cls_020">than)</span></div>
<div style="position:absolute;left:302.79px;top:755.34px" class="cls_002"><span class="cls_002">B-27</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:257442px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:420.79px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:138.75px;top:56.93px" class="cls_027"><span class="cls_027">Instr Fields</span></div>
<div style="position:absolute;left:82.00px;top:77.93px" class="cls_027"><span class="cls_027">op</span></div>
<div style="position:absolute;left:233.93px;top:77.93px" class="cls_027"><span class="cls_027">func</span></div>
<div style="position:absolute;left:268.81px;top:76.93px" class="cls_027"><span class="cls_027">Asm</span></div>
<div style="position:absolute;left:337.67px;top:76.93px" class="cls_027"><span class="cls_027">Description</span></div>
<div style="position:absolute;left:77.18px;top:99.67px" class="cls_076"><span class="cls_076">31-26</span></div>
<div style="position:absolute;left:108.56px;top:99.67px" class="cls_076"><span class="cls_076">25-21</span></div>
<div style="position:absolute;left:139.93px;top:99.67px" class="cls_076"><span class="cls_076">20-16</span></div>
<div style="position:absolute;left:171.31px;top:99.67px" class="cls_076"><span class="cls_076">15-11</span></div>
<div style="position:absolute;left:205.05px;top:99.67px" class="cls_076"><span class="cls_076">10-6</span></div>
<div style="position:absolute;left:238.79px;top:99.67px" class="cls_076"><span class="cls_076">5-0</span></div>
<div style="position:absolute;left:301.52px;top:116.00px" class="cls_020"><span class="cls_020">Unordered  or  less  than  or</span></div>
<div style="position:absolute;left:82.11px;top:121.50px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.50px;top:121.50px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.90px;top:121.50px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.30px;top:121.50px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.46px;top:121.50px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.05px;top:121.50px" class="cls_020"><span class="cls_020">55</span></div>
<div style="position:absolute;left:264.32px;top:121.50px" class="cls_020"><span class="cls_020">c.ule.s</span></div>
<div style="position:absolute;left:301.52px;top:127.00px" class="cls_020"><span class="cls_020">equal.</span></div>
<div style="position:absolute;left:75.99px;top:144.00px" class="cls_020"><span class="cls_020">Single Precision Comparison Operations:</span></div>
<div style="position:absolute;left:75.99px;top:154.00px" class="cls_020"><span class="cls_020">Invalid Operation Exception Signalled for Unordered Operands</span></div>
<div style="position:absolute;left:82.11px;top:171.00px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:171.00px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.89px;top:171.00px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.29px;top:171.00px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:171.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.04px;top:171.00px" class="cls_020"><span class="cls_020">56</span></div>
<div style="position:absolute;left:264.31px;top:171.00px" class="cls_020"><span class="cls_020">c.sf.s</span></div>
<div style="position:absolute;left:301.89px;top:171.00px" class="cls_020"><span class="cls_020">Result will be false</span></div>
<div style="position:absolute;left:264.04px;top:188.50px" class="cls_020"><span class="cls_020">c.ngle.</span></div>
<div style="position:absolute;left:301.52px;top:187.99px" class="cls_020"><span class="cls_020">True if fp values are “unor-</span></div>
<div style="position:absolute;left:82.11px;top:193.50px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:193.50px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.89px;top:193.50px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.29px;top:193.50px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:193.50px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.04px;top:193.50px" class="cls_020"><span class="cls_020">57</span></div>
<div style="position:absolute;left:264.04px;top:198.49px" class="cls_020"><span class="cls_020">s</span></div>
<div style="position:absolute;left:301.52px;top:198.99px" class="cls_020"><span class="cls_020">dered”</span></div>
<div style="position:absolute;left:264.04px;top:215.98px" class="cls_020"><span class="cls_020">c.seq.</span></div>
<div style="position:absolute;left:301.52px;top:215.98px" class="cls_020"><span class="cls_020">True if the two values are</span></div>
<div style="position:absolute;left:82.11px;top:220.99px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:220.99px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.89px;top:220.99px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.29px;top:220.99px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:220.99px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.04px;top:220.99px" class="cls_020"><span class="cls_020">58</span></div>
<div style="position:absolute;left:264.04px;top:225.98px" class="cls_020"><span class="cls_020">s</span></div>
<div style="position:absolute;left:301.52px;top:225.98px" class="cls_020"><span class="cls_020">equal</span></div>
<div style="position:absolute;left:82.11px;top:242.98px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:242.98px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.89px;top:242.98px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.29px;top:242.98px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:242.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.04px;top:242.98px" class="cls_020"><span class="cls_020">59</span></div>
<div style="position:absolute;left:264.31px;top:242.98px" class="cls_020"><span class="cls_020">c.ngl.s</span></div>
<div style="position:absolute;left:301.91px;top:242.98px" class="cls_020"><span class="cls_020">True if equal or unordered.</span></div>
<div style="position:absolute;left:82.11px;top:259.98px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:259.98px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.89px;top:259.98px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.29px;top:259.98px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:259.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.04px;top:259.98px" class="cls_020"><span class="cls_020">60</span></div>
<div style="position:absolute;left:264.31px;top:259.98px" class="cls_020"><span class="cls_020">c.lt.s</span></div>
<div style="position:absolute;left:301.89px;top:259.98px" class="cls_020"><span class="cls_020">True if equal or unordered.</span></div>
<div style="position:absolute;left:264.04px;top:276.98px" class="cls_020"><span class="cls_020">c.nge.</span></div>
<div style="position:absolute;left:301.52px;top:276.98px" class="cls_020"><span class="cls_020">True if ordered and less than</span></div>
<div style="position:absolute;left:82.11px;top:281.98px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:281.98px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.89px;top:281.98px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.29px;top:281.98px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:281.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.04px;top:281.98px" class="cls_020"><span class="cls_020">61</span></div>
<div style="position:absolute;left:264.04px;top:286.97px" class="cls_020"><span class="cls_020">s</span></div>
<div style="position:absolute;left:301.52px;top:303.98px" class="cls_020"><span class="cls_020">True  if  unordered  or  less</span></div>
<div style="position:absolute;left:82.11px;top:309.47px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:309.47px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.89px;top:309.47px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.29px;top:309.47px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:309.47px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.04px;top:309.47px" class="cls_020"><span class="cls_020">62</span></div>
<div style="position:absolute;left:264.31px;top:309.47px" class="cls_020"><span class="cls_020">c.le.s</span></div>
<div style="position:absolute;left:301.52px;top:314.97px" class="cls_020"><span class="cls_020">than</span></div>
<div style="position:absolute;left:301.52px;top:331.97px" class="cls_020"><span class="cls_020">Ordered and (equal or less</span></div>
<div style="position:absolute;left:82.11px;top:337.47px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:337.47px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:143.89px;top:337.47px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.29px;top:337.47px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:337.47px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.04px;top:337.47px" class="cls_020"><span class="cls_020">63</span></div>
<div style="position:absolute;left:264.31px;top:337.47px" class="cls_020"><span class="cls_020">c.ngt.s</span></div>
<div style="position:absolute;left:301.52px;top:342.97px" class="cls_020"><span class="cls_020">than)</span></div>
<div style="position:absolute;left:75.99px;top:359.97px" class="cls_020"><span class="cls_020">Double Precision Comparison Operations:</span></div>
<div style="position:absolute;left:75.99px;top:369.97px" class="cls_020"><span class="cls_020">No Invalid Operation Exception taken for Unordered Operands</span></div>
<div style="position:absolute;left:82.10px;top:386.97px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:386.97px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.88px;top:386.97px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:386.97px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:386.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:386.97px" class="cls_020"><span class="cls_020">48</span></div>
<div style="position:absolute;left:264.30px;top:386.97px" class="cls_020"><span class="cls_020">c.f.d</span></div>
<div style="position:absolute;left:301.86px;top:386.97px" class="cls_020"><span class="cls_020">Result will be false</span></div>
<div style="position:absolute;left:301.51px;top:403.97px" class="cls_020"><span class="cls_020">True if fp values are “unor-</span></div>
<div style="position:absolute;left:82.10px;top:409.47px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:409.47px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.88px;top:409.47px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:409.47px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:409.47px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:409.47px" class="cls_020"><span class="cls_020">49</span></div>
<div style="position:absolute;left:264.30px;top:409.47px" class="cls_020"><span class="cls_020">c.un.d</span></div>
<div style="position:absolute;left:301.51px;top:414.97px" class="cls_020"><span class="cls_020">dered”</span></div>
<div style="position:absolute;left:301.51px;top:431.96px" class="cls_020"><span class="cls_020">True if the two values are</span></div>
<div style="position:absolute;left:82.10px;top:436.97px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:436.97px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.88px;top:436.97px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:436.97px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:436.97px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:436.97px" class="cls_020"><span class="cls_020">50</span></div>
<div style="position:absolute;left:264.30px;top:436.97px" class="cls_020"><span class="cls_020">c.eq.d</span></div>
<div style="position:absolute;left:301.51px;top:441.96px" class="cls_020"><span class="cls_020">equal</span></div>
<div style="position:absolute;left:264.03px;top:458.95px" class="cls_020"><span class="cls_020">c.ueq.</span></div>
<div style="position:absolute;left:301.51px;top:458.95px" class="cls_020"><span class="cls_020">True if equal or unordered.</span></div>
<div style="position:absolute;left:82.10px;top:463.96px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:463.96px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.88px;top:463.96px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:463.96px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:463.96px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:463.96px" class="cls_020"><span class="cls_020">51</span></div>
<div style="position:absolute;left:264.03px;top:468.95px" class="cls_020"><span class="cls_020">d</span></div>
<div style="position:absolute;left:264.03px;top:485.95px" class="cls_020"><span class="cls_020">c.ueq.</span></div>
<div style="position:absolute;left:301.51px;top:485.95px" class="cls_020"><span class="cls_020">True if equal or unordered.</span></div>
<div style="position:absolute;left:82.10px;top:490.96px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:490.96px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.88px;top:490.96px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:490.96px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:490.96px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:490.96px" class="cls_020"><span class="cls_020">51</span></div>
<div style="position:absolute;left:264.03px;top:495.95px" class="cls_020"><span class="cls_020">d</span></div>
<div style="position:absolute;left:82.10px;top:512.96px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:512.96px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.88px;top:512.96px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:512.96px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:512.96px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:512.96px" class="cls_020"><span class="cls_020">52</span></div>
<div style="position:absolute;left:264.30px;top:512.96px" class="cls_020"><span class="cls_020">c.olt.d</span></div>
<div style="position:absolute;left:301.89px;top:512.96px" class="cls_020"><span class="cls_020">True if ordered and less than</span></div>
<div style="position:absolute;left:301.51px;top:529.96px" class="cls_020"><span class="cls_020">True  if  unordered  or  less</span></div>
<div style="position:absolute;left:82.10px;top:535.46px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:535.46px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.88px;top:535.46px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:535.46px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:535.46px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:535.46px" class="cls_020"><span class="cls_020">53</span></div>
<div style="position:absolute;left:264.30px;top:535.46px" class="cls_020"><span class="cls_020">c.ult.d</span></div>
<div style="position:absolute;left:301.51px;top:540.95px" class="cls_020"><span class="cls_020">than</span></div>
<div style="position:absolute;left:301.51px;top:557.96px" class="cls_020"><span class="cls_020">Ordered and (equal or less</span></div>
<div style="position:absolute;left:82.10px;top:563.45px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:563.45px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.88px;top:563.45px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:563.45px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:563.45px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:563.45px" class="cls_020"><span class="cls_020">54</span></div>
<div style="position:absolute;left:264.30px;top:563.45px" class="cls_020"><span class="cls_020">c.ole.d</span></div>
<div style="position:absolute;left:301.51px;top:568.95px" class="cls_020"><span class="cls_020">than)</span></div>
<div style="position:absolute;left:301.51px;top:585.95px" class="cls_020"><span class="cls_020">Unordered  or  less  than  or</span></div>
<div style="position:absolute;left:82.10px;top:591.45px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.48px;top:591.45px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.88px;top:591.45px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.28px;top:591.45px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.45px;top:591.45px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.03px;top:591.45px" class="cls_020"><span class="cls_020">55</span></div>
<div style="position:absolute;left:264.30px;top:591.45px" class="cls_020"><span class="cls_020">c.ule.d</span></div>
<div style="position:absolute;left:301.51px;top:596.95px" class="cls_020"><span class="cls_020">equal.</span></div>
<div style="position:absolute;left:75.98px;top:613.95px" class="cls_020"><span class="cls_020">Double Precision Comparison Operations:</span></div>
<div style="position:absolute;left:75.98px;top:623.95px" class="cls_020"><span class="cls_020">Invalid Operation Exception Signalled for Unordered Operands</span></div>
<div style="position:absolute;left:82.09px;top:640.95px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.47px;top:640.95px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.87px;top:640.95px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.27px;top:640.95px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.44px;top:640.95px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.02px;top:640.95px" class="cls_020"><span class="cls_020">56</span></div>
<div style="position:absolute;left:264.29px;top:640.95px" class="cls_020"><span class="cls_020">c.sf.d</span></div>
<div style="position:absolute;left:301.88px;top:640.95px" class="cls_020"><span class="cls_020">Result will be false</span></div>
<div style="position:absolute;left:264.02px;top:658.45px" class="cls_020"><span class="cls_020">c.ngle.</span></div>
<div style="position:absolute;left:301.50px;top:657.95px" class="cls_020"><span class="cls_020">True if fp values are “unor-</span></div>
<div style="position:absolute;left:82.09px;top:663.45px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.47px;top:663.45px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.87px;top:663.45px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.27px;top:663.45px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.44px;top:663.45px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.02px;top:663.45px" class="cls_020"><span class="cls_020">57</span></div>
<div style="position:absolute;left:264.02px;top:668.45px" class="cls_020"><span class="cls_020">d</span></div>
<div style="position:absolute;left:301.50px;top:668.94px" class="cls_020"><span class="cls_020">dered”</span></div>
<div style="position:absolute;left:264.02px;top:685.93px" class="cls_020"><span class="cls_020">c.seq.</span></div>
<div style="position:absolute;left:301.50px;top:685.93px" class="cls_020"><span class="cls_020">True if the two values are</span></div>
<div style="position:absolute;left:82.09px;top:690.94px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.47px;top:690.94px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.87px;top:690.94px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.27px;top:690.94px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.44px;top:690.94px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.02px;top:690.94px" class="cls_020"><span class="cls_020">58</span></div>
<div style="position:absolute;left:264.02px;top:695.93px" class="cls_020"><span class="cls_020">d</span></div>
<div style="position:absolute;left:301.50px;top:695.93px" class="cls_020"><span class="cls_020">equal</span></div>
<div style="position:absolute;left:82.09px;top:712.93px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.47px;top:712.93px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.87px;top:712.93px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.27px;top:712.93px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.44px;top:712.93px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.02px;top:712.93px" class="cls_020"><span class="cls_020">59</span></div>
<div style="position:absolute;left:264.29px;top:712.93px" class="cls_020"><span class="cls_020">c.ngl.d</span></div>
<div style="position:absolute;left:301.89px;top:712.93px" class="cls_020"><span class="cls_020">True if equal or unordered.</span></div>
<div style="position:absolute;left:289.04px;top:755.34px" class="cls_002"><span class="cls_002">B-28</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:258244px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">FPA INSTRUCTION REFERENCE</span></div>
<div style="position:absolute;left:521.04px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX B</span></div>
<div style="position:absolute;left:138.76px;top:56.95px" class="cls_027"><span class="cls_027">Instr Fields</span></div>
<div style="position:absolute;left:82.01px;top:77.95px" class="cls_027"><span class="cls_027">op</span></div>
<div style="position:absolute;left:233.93px;top:77.95px" class="cls_027"><span class="cls_027">func</span></div>
<div style="position:absolute;left:268.82px;top:76.95px" class="cls_027"><span class="cls_027">Asm</span></div>
<div style="position:absolute;left:337.68px;top:76.95px" class="cls_027"><span class="cls_027">Description</span></div>
<div style="position:absolute;left:77.18px;top:99.67px" class="cls_076"><span class="cls_076">31-26</span></div>
<div style="position:absolute;left:108.56px;top:99.67px" class="cls_076"><span class="cls_076">25-21</span></div>
<div style="position:absolute;left:139.93px;top:99.67px" class="cls_076"><span class="cls_076">20-16</span></div>
<div style="position:absolute;left:171.31px;top:99.67px" class="cls_076"><span class="cls_076">15-11</span></div>
<div style="position:absolute;left:205.05px;top:99.67px" class="cls_076"><span class="cls_076">10-6</span></div>
<div style="position:absolute;left:238.79px;top:99.67px" class="cls_076"><span class="cls_076">5-0</span></div>
<div style="position:absolute;left:82.11px;top:116.00px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.50px;top:116.00px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.90px;top:116.00px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.30px;top:116.00px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.46px;top:116.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.05px;top:116.00px" class="cls_020"><span class="cls_020">60</span></div>
<div style="position:absolute;left:264.32px;top:116.00px" class="cls_020"><span class="cls_020">c.lt.d</span></div>
<div style="position:absolute;left:301.89px;top:116.00px" class="cls_020"><span class="cls_020">True if equal or unordered.</span></div>
<div style="position:absolute;left:264.05px;top:132.99px" class="cls_020"><span class="cls_020">c.nge.</span></div>
<div style="position:absolute;left:301.52px;top:132.99px" class="cls_020"><span class="cls_020">True if ordered and less than</span></div>
<div style="position:absolute;left:82.11px;top:138.00px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.50px;top:138.00px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.90px;top:138.00px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.30px;top:138.00px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.46px;top:138.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.05px;top:138.00px" class="cls_020"><span class="cls_020">61</span></div>
<div style="position:absolute;left:264.05px;top:142.99px" class="cls_020"><span class="cls_020">d</span></div>
<div style="position:absolute;left:301.52px;top:159.99px" class="cls_020"><span class="cls_020">True  if  unordered  or  less</span></div>
<div style="position:absolute;left:82.11px;top:165.49px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.50px;top:165.49px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.90px;top:165.49px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.30px;top:165.49px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.46px;top:165.49px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.05px;top:165.49px" class="cls_020"><span class="cls_020">62</span></div>
<div style="position:absolute;left:264.32px;top:165.49px" class="cls_020"><span class="cls_020">c.le.d</span></div>
<div style="position:absolute;left:301.52px;top:170.99px" class="cls_020"><span class="cls_020">than</span></div>
<div style="position:absolute;left:264.05px;top:188.49px" class="cls_020"><span class="cls_020">c.ngt.</span></div>
<div style="position:absolute;left:301.52px;top:187.98px" class="cls_020"><span class="cls_020">Ordered and (equal or less</span></div>
<div style="position:absolute;left:82.11px;top:193.49px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.50px;top:193.49px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.90px;top:193.49px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:175.30px;top:193.49px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:210.46px;top:193.49px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:239.05px;top:193.49px" class="cls_020"><span class="cls_020">63</span></div>
<div style="position:absolute;left:264.05px;top:198.49px" class="cls_020"><span class="cls_020">d</span></div>
<div style="position:absolute;left:301.52px;top:198.98px" class="cls_020"><span class="cls_020">than)</span></div>
<div style="position:absolute;left:75.99px;top:215.98px" class="cls_020"><span class="cls_020">Double Precision Arithmetic Instructions</span></div>
<div style="position:absolute;left:301.52px;top:232.97px" class="cls_020"><span class="cls_020">3-operand double precision</span></div>
<div style="position:absolute;left:82.11px;top:237.98px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:237.98px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.89px;top:237.98px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:175.29px;top:237.98px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:209.02px;top:237.98px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:241.84px;top:237.98px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:264.32px;top:237.98px" class="cls_020"><span class="cls_020">add.d</span></div>
<div style="position:absolute;left:301.52px;top:242.97px" class="cls_020"><span class="cls_020">add.</span></div>
<div style="position:absolute;left:301.52px;top:259.97px" class="cls_020"><span class="cls_020">3-operand double precision</span></div>
<div style="position:absolute;left:82.11px;top:265.47px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:265.47px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.89px;top:265.47px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:175.29px;top:265.47px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:209.02px;top:265.47px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:241.84px;top:265.47px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:264.31px;top:265.47px" class="cls_020"><span class="cls_020">sub.d</span></div>
<div style="position:absolute;left:301.52px;top:270.97px" class="cls_020"><span class="cls_020">subtraction.</span></div>
<div style="position:absolute;left:301.52px;top:287.96px" class="cls_020"><span class="cls_020">3-operand double precision</span></div>
<div style="position:absolute;left:82.11px;top:292.97px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:292.97px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.89px;top:292.97px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:175.29px;top:292.97px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:209.02px;top:292.97px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:241.84px;top:292.97px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:264.31px;top:292.97px" class="cls_020"><span class="cls_020">mul.d</span></div>
<div style="position:absolute;left:301.52px;top:297.96px" class="cls_020"><span class="cls_020">multiply.</span></div>
<div style="position:absolute;left:301.52px;top:314.95px" class="cls_020"><span class="cls_020">3-operand double precision</span></div>
<div style="position:absolute;left:82.11px;top:319.96px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:319.96px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:143.89px;top:319.96px" class="cls_020"><span class="cls_020">fs2</span></div>
<div style="position:absolute;left:175.29px;top:319.96px" class="cls_020"><span class="cls_020">fs1</span></div>
<div style="position:absolute;left:209.02px;top:319.96px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:241.84px;top:319.96px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:264.31px;top:319.96px" class="cls_020"><span class="cls_020">div.d</span></div>
<div style="position:absolute;left:301.52px;top:324.95px" class="cls_020"><span class="cls_020">divide.</span></div>
<div style="position:absolute;left:301.52px;top:341.95px" class="cls_020"><span class="cls_020">Double-precision    absolute</span></div>
<div style="position:absolute;left:82.11px;top:347.45px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:347.45px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:147.65px;top:347.45px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:178.04px;top:347.45px" class="cls_020"><span class="cls_020">fs</span></div>
<div style="position:absolute;left:208.96px;top:347.45px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:241.77px;top:347.45px" class="cls_020"><span class="cls_020">5</span></div>
<div style="position:absolute;left:264.25px;top:347.45px" class="cls_020"><span class="cls_020">abs.d</span></div>
<div style="position:absolute;left:301.52px;top:352.95px" class="cls_020"><span class="cls_020">value of fs is placed into fd.</span></div>
<div style="position:absolute;left:301.52px;top:369.95px" class="cls_020"><span class="cls_020">Double precision move of val-</span></div>
<div style="position:absolute;left:82.11px;top:375.45px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:113.49px;top:375.45px" class="cls_020"><span class="cls_020">17</span></div>
<div style="position:absolute;left:147.65px;top:375.45px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:178.04px;top:375.45px" class="cls_020"><span class="cls_020">fs</span></div>
<div style="position:absolute;left:208.96px;top:375.45px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:241.77px;top:375.45px" class="cls_020"><span class="cls_020">6</span></div>
<div style="position:absolute;left:264.25px;top:375.45px" class="cls_020"><span class="cls_020">mov.d</span></div>
<div style="position:absolute;left:301.52px;top:380.95px" class="cls_020"><span class="cls_020">ue in fs into fd.</span></div>
<div style="position:absolute;left:75.99px;top:397.95px" class="cls_020"><span class="cls_020">Data Movement Operations</span></div>
<div style="position:absolute;left:82.10px;top:414.95px" class="cls_020"><span class="cls_020">49</span></div>
<div style="position:absolute;left:114.74px;top:414.95px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:146.20px;top:414.95px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:201.26px;top:414.95px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.25px;top:414.95px" class="cls_020"><span class="cls_020">lwc1</span></div>
<div style="position:absolute;left:301.81px;top:414.95px" class="cls_020"><span class="cls_020">Load word to FPA</span></div>
<div style="position:absolute;left:82.10px;top:431.95px" class="cls_020"><span class="cls_020">57</span></div>
<div style="position:absolute;left:114.74px;top:431.95px" class="cls_020"><span class="cls_020">rs</span></div>
<div style="position:absolute;left:146.20px;top:431.95px" class="cls_020"><span class="cls_020">fd</span></div>
<div style="position:absolute;left:201.26px;top:431.95px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:264.25px;top:431.95px" class="cls_020"><span class="cls_020">swc1</span></div>
<div style="position:absolute;left:301.82px;top:431.95px" class="cls_020"><span class="cls_020">Store word from FPA</span></div>
<div style="position:absolute;left:302.79px;top:755.34px" class="cls_002"><span class="cls_002">B-29</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:259046px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">CP0 OPERATION REFERENCE</span></div>
<div style="position:absolute;left:486.53px;top:42.00px" class="cls_015"><span class="cls_015">APPENDIX C</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:216.00px;top:113.00px" class="cls_015"><span class="cls_015">CP0 Operation Details</span></div>
<div style="position:absolute;left:228.02px;top:126.67px" class="cls_006"><span class="cls_006">This section documents the operations for the on-chip CP0 in R30xx</span></div>
<div style="position:absolute;left:216.00px;top:137.67px" class="cls_006"><span class="cls_006">family processors. It contains a detailed description for each instruction in</span></div>
<div style="position:absolute;left:216.00px;top:148.67px" class="cls_006"><span class="cls_006">alphabetic order.</span></div>
<div style="position:absolute;left:216.00px;top:171.00px" class="cls_015"><span class="cls_015">MMU Operations</span></div>
<div style="position:absolute;left:228.02px;top:184.67px" class="cls_006"><span class="cls_006">Most of the CP0 operations are designed to manage the on-chip TLB of</span></div>
<div style="position:absolute;left:216.00px;top:195.67px" class="cls_006"><span class="cls_006">“E” versions of the family. Instructions are provided to read, write, and</span></div>
<div style="position:absolute;left:216.00px;top:206.67px" class="cls_006"><span class="cls_006">probe the TLB.</span></div>
<div style="position:absolute;left:216.00px;top:229.00px" class="cls_015"><span class="cls_015">Exception Operations</span></div>
<div style="position:absolute;left:216.00px;top:252.67px" class="cls_006"><span class="cls_006">A single instruction is provided to support exception operation: the rfe</span></div>
<div style="position:absolute;left:216.00px;top:263.67px" class="cls_006"><span class="cls_006">instruction restores the proper Interrupt Enable and Kernel/User mode</span></div>
<div style="position:absolute;left:216.00px;top:274.67px" class="cls_006"><span class="cls_006">bits of the status register on return from exception.</span></div>
<div style="position:absolute;left:216.00px;top:297.67px" class="cls_006"><span class="cls_006">Dand Register Movement Operations</span></div>
<div style="position:absolute;left:228.02px;top:308.67px" class="cls_006"><span class="cls_006">The standard mtc0, ctc0, mfc0, and cfc0 operations were described in</span></div>
<div style="position:absolute;left:216.00px;top:319.67px" class="cls_006"><span class="cls_006">Appendix A.</span></div>
<div style="position:absolute;left:216.00px;top:342.00px" class="cls_015"><span class="cls_015">Operation Descriptions</span></div>
<div style="position:absolute;left:228.02px;top:355.67px" class="cls_006"><span class="cls_006">The CP0 instructions are described in detail in alphabetic order.  Each</span></div>
<div style="position:absolute;left:216.00px;top:366.67px" class="cls_006"><span class="cls_006">page contains the following information for the instruction:</span></div>
<div style="position:absolute;left:228.02px;top:380.67px" class="cls_006"><span class="cls_006">• Instruction mnemonic and name</span></div>
<div style="position:absolute;left:228.02px;top:394.67px" class="cls_006"><span class="cls_006">• Assembler format</span></div>
<div style="position:absolute;left:228.02px;top:408.67px" class="cls_006"><span class="cls_006">• Description of the instruction</span></div>
<div style="position:absolute;left:228.02px;top:422.67px" class="cls_006"><span class="cls_006">• Operation of the instruction described in pseudocode.</span></div>
<div style="position:absolute;left:228.02px;top:436.67px" class="cls_006"><span class="cls_006">• Exceptions that the instruction can cause</span></div>
<div style="position:absolute;left:298.28px;top:754.68px" class="cls_002"><span class="cls_002">C-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:259848px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX C</span></div>
<div style="position:absolute;left:430.75px;top:28.00px" class="cls_002"><span class="cls_002">CP0 OPERATION REFERENCE</span></div>
<div style="position:absolute;left:262.45px;top:60.93px" class="cls_064"><span class="cls_064">Restore from</span></div>
<div style="position:absolute;left:99.61px;top:58.83px" class="cls_063"><span class="cls_063">RFE</span></div>
<div style="position:absolute;left:409.26px;top:58.83px" class="cls_063"><span class="cls_063">RFE</span></div>
<div style="position:absolute;left:272.55px;top:78.76px" class="cls_064"><span class="cls_064">Exception</span></div>
<div style="position:absolute;left:117.99px;top:103.03px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:176.31px;top:103.03px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:201.29px;top:103.03px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:233.19px;top:103.03px" class="cls_053"><span class="cls_053">21</span></div>
<div style="position:absolute;left:407.63px;top:103.03px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:420.59px;top:103.03px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:487.97px;top:103.03px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:138.88px;top:127.08px" class="cls_053"><span class="cls_053">COP0</span></div>
<div style="position:absolute;left:199.29px;top:127.29px" class="cls_053"><span class="cls_053">CO</span></div>
<div style="position:absolute;left:309.40px;top:128.81px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:445.69px;top:127.08px" class="cls_053"><span class="cls_053">RFE</span></div>
<div style="position:absolute;left:128.29px;top:139.53px" class="cls_053"><span class="cls_053">0 1 0 0 0 0</span></div>
<div style="position:absolute;left:203.14px;top:138.54px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:430.78px;top:139.53px" class="cls_053"><span class="cls_053">0 1 0 0 0 0</span></div>
<div style="position:absolute;left:150.65px;top:153.94px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:203.40px;top:153.94px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:308.63px;top:153.94px" class="cls_053"><span class="cls_053">19</span></div>
<div style="position:absolute;left:452.92px;top:153.94px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:177.43px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:198.77px" class="cls_055"><span class="cls_055">RFE</span></div>
<div style="position:absolute;left:72.00px;top:219.43px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:237.77px" class="cls_055"><span class="cls_055">RFE restores the “previous” interrupt enable mask bit and kernel/user mode bit (IEp and KUp) of</span></div>
<div style="position:absolute;left:108.00px;top:250.77px" class="cls_055"><span class="cls_055">the Status Register into the corresponding “current” status bits (IEc and KUc), and restores the</span></div>
<div style="position:absolute;left:108.00px;top:263.77px" class="cls_055"><span class="cls_055">“old” Status bits (IEo and KUo) into the corresponding “previous” status bits (IEp and KUp). The</span></div>
<div style="position:absolute;left:108.00px;top:276.77px" class="cls_055"><span class="cls_055">“old” status bits remain unchanged.</span></div>
<div style="position:absolute;left:108.00px;top:295.77px" class="cls_055"><span class="cls_055">The MIPS architecture does not specify the operation of memory references associated with load/</span></div>
<div style="position:absolute;left:108.00px;top:308.77px" class="cls_055"><span class="cls_055">store instructions immediately prior to an RFE instruction. Normally, the RFE instruction follows</span></div>
<div style="position:absolute;left:108.00px;top:321.77px" class="cls_055"><span class="cls_055">in the delay slot of a JR instruction to restore the PC.</span></div>
<div style="position:absolute;left:72.00px;top:342.43px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:108.34px;top:371.06px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:137.14px;top:371.06px" class="cls_053"><span class="cls_053">SR</span><span class="cls_003">←</span><span class="cls_053">SR</span><span class="cls_061"><sub>31..4</sub></span><span class="cls_053">||SR</span><span class="cls_061"><sub>5..2</sub></span></div>
<div style="position:absolute;left:72.00px;top:407.84px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:426.17px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:291.04px;top:755.33px" class="cls_002"><span class="cls_002">C-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:260650px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">CP0 OPERATION REFERENCE</span></div>
<div style="position:absolute;left:520.51px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX C</span></div>
<div style="position:absolute;left:270.28px;top:67.59px" class="cls_064"><span class="cls_064">TLB Probe</span></div>
<div style="position:absolute;left:142.76px;top:60.70px" class="cls_063"><span class="cls_063">TLBP</span></div>
<div style="position:absolute;left:435.10px;top:60.70px" class="cls_063"><span class="cls_063">TLBP</span></div>
<div style="position:absolute;left:118.03px;top:104.10px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:176.35px;top:104.09px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:201.32px;top:104.09px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:233.23px;top:104.09px" class="cls_053"><span class="cls_053">21</span></div>
<div style="position:absolute;left:407.66px;top:104.09px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:420.63px;top:104.09px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:488.01px;top:104.10px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:138.92px;top:128.14px" class="cls_053"><span class="cls_053">COP0</span></div>
<div style="position:absolute;left:199.32px;top:128.34px" class="cls_053"><span class="cls_053">CO</span></div>
<div style="position:absolute;left:309.44px;top:129.87px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:443.22px;top:128.14px" class="cls_053"><span class="cls_053">TLBP</span></div>
<div style="position:absolute;left:128.33px;top:140.59px" class="cls_053"><span class="cls_053">0 1 0 0 0 0</span></div>
<div style="position:absolute;left:203.17px;top:139.59px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:432.20px;top:140.59px" class="cls_053"><span class="cls_053">0 01 0 0 0</span></div>
<div style="position:absolute;left:150.69px;top:155.00px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:203.44px;top:155.00px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:308.66px;top:155.00px" class="cls_053"><span class="cls_053">19</span></div>
<div style="position:absolute;left:452.95px;top:155.00px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:177.23px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:198.57px" class="cls_055"><span class="cls_055">TLBP</span></div>
<div style="position:absolute;left:72.00px;top:219.23px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:237.57px" class="cls_055"><span class="cls_055">The Index register is loaded with the address of the TLB entry whose contents match the contents</span></div>
<div style="position:absolute;left:108.00px;top:250.57px" class="cls_055"><span class="cls_055">of the EntryHi register. If no TLB entry matches, the high-order bit of the Index register is set.</span></div>
<div style="position:absolute;left:108.00px;top:269.57px" class="cls_055"><span class="cls_055">The architecture does not specify the operation of memory references associated with instructions</span></div>
<div style="position:absolute;left:108.00px;top:282.57px" class="cls_055"><span class="cls_055">immediately after a TLBP instruction, nor is the operation specified if more than one TLB entry</span></div>
<div style="position:absolute;left:108.00px;top:295.57px" class="cls_055"><span class="cls_055">matches.</span></div>
<div style="position:absolute;left:108.00px;top:314.57px" class="cls_055"><span class="cls_055">This instruction is only valid for “E” versions of the R30xx family. Its result for  members without</span></div>
<div style="position:absolute;left:108.00px;top:327.57px" class="cls_055"><span class="cls_055">an on-chip TLB is undefined.</span></div>
<div style="position:absolute;left:72.00px;top:348.23px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:108.12px;top:375.97px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:136.92px;top:373.97px" class="cls_053"><span class="cls_053">Index </span><span class="cls_003">←</span><span class="cls_053">1||0</span><span class="cls_061"><sup>31</sup></span><span class="cls_053">)</span></div>
<div style="position:absolute;left:108.12px;top:392.02px" class="cls_053"><span class="cls_053">for i in 0..63</span></div>
<div style="position:absolute;left:136.92px;top:408.06px" class="cls_053"><span class="cls_053">if (TLB[i]</span><span class="cls_061"><sub>63..44</sub></span><span class="cls_053"> = EntryH</span><span class="cls_061"><sub>i31..12</sub></span><span class="cls_053">) and {TLB[i]</span><span class="cls_061"><sub>8</sub></span><span class="cls_053"> or (TLB[i]</span><span class="cls_061"><sub>43..38</sub></span><span class="cls_053"> = EntryHi</span><span class="cls_061"><sub>11..6</sub></span><span class="cls_053">)) then</span></div>
<div style="position:absolute;left:162.12px;top:424.11px" class="cls_053"><span class="cls_053">Index </span><span class="cls_003">←</span><span class="cls_053"> 018||i5..0||08</span></div>
<div style="position:absolute;left:136.91px;top:440.16px" class="cls_053"><span class="cls_053">endif</span></div>
<div style="position:absolute;left:108.11px;top:456.21px" class="cls_053"><span class="cls_053">endfor</span></div>
<div style="position:absolute;left:72.00px;top:512.00px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:530.33px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:304.78px;top:755.33px" class="cls_002"><span class="cls_002">C-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:261452px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX C</span></div>
<div style="position:absolute;left:430.75px;top:28.00px" class="cls_002"><span class="cls_002">CP0 OPERATION REFERENCE</span></div>
<div style="position:absolute;left:227.09px;top:64.94px" class="cls_064"><span class="cls_064">Read Indexed TLB Entry</span></div>
<div style="position:absolute;left:102.98px;top:60.90px" class="cls_063"><span class="cls_063">TLBR</span></div>
<div style="position:absolute;left:438.29px;top:62.03px" class="cls_063"><span class="cls_063">TLBR</span></div>
<div style="position:absolute;left:119.96px;top:98.26px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:178.28px;top:98.25px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:203.25px;top:98.25px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:235.16px;top:98.25px" class="cls_053"><span class="cls_053">21</span></div>
<div style="position:absolute;left:409.59px;top:98.25px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:422.55px;top:98.25px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:489.94px;top:98.26px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:140.85px;top:122.30px" class="cls_053"><span class="cls_053">COP0</span></div>
<div style="position:absolute;left:201.25px;top:122.50px" class="cls_053"><span class="cls_053">CO</span></div>
<div style="position:absolute;left:311.37px;top:124.03px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:444.88px;top:122.30px" class="cls_053"><span class="cls_053">TLBR</span></div>
<div style="position:absolute;left:130.26px;top:134.75px" class="cls_053"><span class="cls_053">0 1 0 0 0 0</span></div>
<div style="position:absolute;left:205.10px;top:133.75px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:432.75px;top:134.75px" class="cls_053"><span class="cls_053">0 0 0 0 0 1</span></div>
<div style="position:absolute;left:152.62px;top:149.16px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:205.37px;top:149.16px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:310.59px;top:149.16px" class="cls_053"><span class="cls_053">19</span></div>
<div style="position:absolute;left:454.88px;top:149.16px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:174.02px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:195.35px" class="cls_055"><span class="cls_055">TLBR</span></div>
<div style="position:absolute;left:72.00px;top:216.02px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:234.35px" class="cls_055"><span class="cls_055">The EntryHi and EntryLo registers are loaded with the contents of the TLB entry pointed at by the</span></div>
<div style="position:absolute;left:108.00px;top:247.35px" class="cls_055"><span class="cls_055">contents of the TLB Index register.</span></div>
<div style="position:absolute;left:108.00px;top:266.35px" class="cls_055"><span class="cls_055">This operation is only valid for “E” version members of the R30xx family. Its result for members</span></div>
<div style="position:absolute;left:108.00px;top:279.35px" class="cls_055"><span class="cls_055">without an on-chip TLB is undefined.</span></div>
<div style="position:absolute;left:72.00px;top:300.02px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:162.18px;top:333.30px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:216.17px;top:333.30px" class="cls_053"><span class="cls_053">EntryHi </span><span class="cls_003">←</span><span class="cls_053">TLB[Index</span><span class="cls_061"><sub>13..8</sub></span><span class="cls_053">]</span><span class="cls_061"><sub>63..32</sub></span></div>
<div style="position:absolute;left:216.17px;top:346.30px" class="cls_053"><span class="cls_053">EntryHi </span><span class="cls_003">←</span><span class="cls_053">TLB[Index</span><span class="cls_061"><sub>13..8</sub></span><span class="cls_053">]</span><span class="cls_061"><sub>31..0</sub></span></div>
<div style="position:absolute;left:72.00px;top:386.33px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:404.67px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:291.03px;top:755.33px" class="cls_002"><span class="cls_002">C-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:262254px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">CP0 OPERATION REFERENCE</span></div>
<div style="position:absolute;left:520.51px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX C</span></div>
<div style="position:absolute;left:235.90px;top:69.16px" class="cls_064"><span class="cls_064">Write Indexed TLB Entry</span></div>
<div style="position:absolute;left:108.57px;top:60.90px" class="cls_063"><span class="cls_063">TLBWI</span></div>
<div style="position:absolute;left:436.39px;top:60.90px" class="cls_063"><span class="cls_063">TLBWI</span></div>
<div style="position:absolute;left:117.53px;top:103.10px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:175.85px;top:103.09px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:200.82px;top:103.09px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:232.73px;top:103.09px" class="cls_053"><span class="cls_053">21</span></div>
<div style="position:absolute;left:407.16px;top:103.09px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:420.13px;top:103.09px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:487.51px;top:103.10px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:138.42px;top:127.14px" class="cls_053"><span class="cls_053">COP0</span></div>
<div style="position:absolute;left:198.82px;top:127.34px" class="cls_053"><span class="cls_053">CO</span></div>
<div style="position:absolute;left:308.94px;top:128.87px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:439.95px;top:127.14px" class="cls_053"><span class="cls_053">TLBWI</span></div>
<div style="position:absolute;left:127.83px;top:139.59px" class="cls_053"><span class="cls_053">0 1 0 0 0 0</span></div>
<div style="position:absolute;left:202.67px;top:138.59px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:430.32px;top:139.59px" class="cls_053"><span class="cls_053">0 0 0 0 1 0</span></div>
<div style="position:absolute;left:150.19px;top:154.00px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:202.94px;top:154.00px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:308.16px;top:154.00px" class="cls_053"><span class="cls_053">19</span></div>
<div style="position:absolute;left:452.45px;top:154.00px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:180.63px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:201.97px" class="cls_055"><span class="cls_055">TLBWI</span></div>
<div style="position:absolute;left:72.00px;top:222.63px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:240.97px" class="cls_055"><span class="cls_055">The TLB entry pointed at by the contents of the Index register is loaded with the contents of the</span></div>
<div style="position:absolute;left:108.00px;top:253.97px" class="cls_055"><span class="cls_055">EntryHi and EntryLo registers.</span></div>
<div style="position:absolute;left:108.00px;top:272.97px" class="cls_055"><span class="cls_055">This operation is only valid for “E” version members of the R30xx family. Its result for members</span></div>
<div style="position:absolute;left:108.00px;top:285.97px" class="cls_055"><span class="cls_055">without an on-chip TLB is undefined.</span></div>
<div style="position:absolute;left:72.00px;top:306.63px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:162.60px;top:326.97px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:216.60px;top:326.97px" class="cls_053"><span class="cls_053">TLB[Index</span><span class="cls_061"><sub>13..8</sub></span><span class="cls_053">] </span><span class="cls_003">←</span><span class="cls_053"> EntryHi||EntryLo</span></div>
<div style="position:absolute;left:72.00px;top:425.33px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:443.67px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:304.78px;top:755.33px" class="cls_002"><span class="cls_002">C-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:263056px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX C</span></div>
<div style="position:absolute;left:430.75px;top:28.00px" class="cls_002"><span class="cls_002">CP0 OPERATION REFERENCE</span></div>
<div style="position:absolute;left:235.40px;top:69.16px" class="cls_064"><span class="cls_064">Write Random TLB Entry</span></div>
<div style="position:absolute;left:108.07px;top:60.90px" class="cls_063"><span class="cls_063">TLBWR</span></div>
<div style="position:absolute;left:415.89px;top:60.90px" class="cls_063"><span class="cls_063">TLBWR</span></div>
<div style="position:absolute;left:117.03px;top:103.10px" class="cls_053"><span class="cls_053">31</span></div>
<div style="position:absolute;left:175.35px;top:103.09px" class="cls_053"><span class="cls_053">26</span></div>
<div style="position:absolute;left:200.32px;top:103.09px" class="cls_053"><span class="cls_053">25</span></div>
<div style="position:absolute;left:232.23px;top:103.09px" class="cls_053"><span class="cls_053">21</span></div>
<div style="position:absolute;left:406.66px;top:103.09px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:419.63px;top:103.09px" class="cls_053"><span class="cls_053">5</span></div>
<div style="position:absolute;left:487.01px;top:103.10px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:137.92px;top:127.14px" class="cls_053"><span class="cls_053">COP0</span></div>
<div style="position:absolute;left:198.32px;top:127.34px" class="cls_053"><span class="cls_053">CO</span></div>
<div style="position:absolute;left:308.44px;top:128.87px" class="cls_053"><span class="cls_053">0</span></div>
<div style="position:absolute;left:437.23px;top:127.14px" class="cls_053"><span class="cls_053">TLBWR</span></div>
<div style="position:absolute;left:127.33px;top:139.59px" class="cls_053"><span class="cls_053">0 1 0 0 0 0</span></div>
<div style="position:absolute;left:202.17px;top:138.59px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:429.82px;top:139.59px" class="cls_053"><span class="cls_053">0 0 0 1 1 0</span></div>
<div style="position:absolute;left:149.69px;top:154.00px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:202.44px;top:154.00px" class="cls_053"><span class="cls_053">1</span></div>
<div style="position:absolute;left:307.66px;top:154.00px" class="cls_053"><span class="cls_053">19</span></div>
<div style="position:absolute;left:451.95px;top:154.00px" class="cls_053"><span class="cls_053">6</span></div>
<div style="position:absolute;left:72.00px;top:180.63px" class="cls_065"><span class="cls_065">Format:</span></div>
<div style="position:absolute;left:108.00px;top:201.97px" class="cls_055"><span class="cls_055">TLBWR</span></div>
<div style="position:absolute;left:72.00px;top:222.63px" class="cls_066"><span class="cls_066">Description:</span></div>
<div style="position:absolute;left:108.00px;top:240.97px" class="cls_055"><span class="cls_055">The TLB entry pointed at by the contents of the Random register is loaded with the contents of the</span></div>
<div style="position:absolute;left:108.00px;top:253.97px" class="cls_055"><span class="cls_055">EntryHi and EntryLo registers.</span></div>
<div style="position:absolute;left:108.00px;top:272.97px" class="cls_055"><span class="cls_055">This operation is only valid for “E” version members of the R30xx family. Its result for members</span></div>
<div style="position:absolute;left:108.00px;top:285.97px" class="cls_055"><span class="cls_055">without an on-chip TLB is undefined.</span></div>
<div style="position:absolute;left:72.00px;top:306.63px" class="cls_066"><span class="cls_066">Operation:</span></div>
<div style="position:absolute;left:162.10px;top:326.97px" class="cls_053"><span class="cls_053">T:</span></div>
<div style="position:absolute;left:216.10px;top:326.97px" class="cls_053"><span class="cls_053">TLB[Random</span><span class="cls_061"><sub>13..8</sub></span><span class="cls_053">] </span><span class="cls_003">←</span><span class="cls_053"> EntryHi||EntryLo</span></div>
<div style="position:absolute;left:72.00px;top:425.33px" class="cls_066"><span class="cls_066">Exceptions:</span></div>
<div style="position:absolute;left:108.00px;top:443.67px" class="cls_055"><span class="cls_055">Coprocessor unusable exception</span></div>
<div style="position:absolute;left:291.04px;top:755.33px" class="cls_002"><span class="cls_002">C-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:263858px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">ASSEMBLER LANGUAGE</span></div>
<div style="position:absolute;left:486.05px;top:42.00px" class="cls_015"><span class="cls_015">APPENDIX D</span></div>
<div style="position:absolute;left:222.89px;top:56.33px" class="cls_005"><span class="cls_005">SYNTAX</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:228.02px;top:113.67px" class="cls_006"><span class="cls_006">This appendix describes the assembler syntax valid for most R30xx</span></div>
<div style="position:absolute;left:216.00px;top:124.67px" class="cls_006"><span class="cls_006">assemblers..</span></div>
<div style="position:absolute;left:228.02px;top:135.67px" class="cls_006"><span class="cls_006">The </span><span class="cls_008">compiler-dir</span><span class="cls_006"> directives in the syntax are for use by compilers only,</span></div>
<div style="position:absolute;left:216.00px;top:146.67px" class="cls_006"><span class="cls_006">and they are not described in this book.</span></div>
<div style="position:absolute;left:216.00px;top:179.67px" class="cls_008"><span class="cls_008">statement-list:</span></div>
<div style="position:absolute;left:252.00px;top:190.67px" class="cls_008"><span class="cls_008">statement</span></div>
<div style="position:absolute;left:252.00px;top:201.67px" class="cls_008"><span class="cls_008">statement statement-list</span></div>
<div style="position:absolute;left:216.00px;top:223.67px" class="cls_008"><span class="cls_008">statement:</span></div>
<div style="position:absolute;left:252.00px;top:234.67px" class="cls_008"><span class="cls_008">stat \</span><span class="cls_041">n</span></div>
<div style="position:absolute;left:252.00px;top:245.67px" class="cls_008"><span class="cls_008">stat </span><span class="cls_041">;</span></div>
<div style="position:absolute;left:216.00px;top:267.67px" class="cls_008"><span class="cls_008">stat:</span></div>
<div style="position:absolute;left:252.00px;top:278.67px" class="cls_008"><span class="cls_008">label</span></div>
<div style="position:absolute;left:252.00px;top:289.67px" class="cls_008"><span class="cls_008">label instruction</span></div>
<div style="position:absolute;left:252.00px;top:300.67px" class="cls_008"><span class="cls_008">label data</span></div>
<div style="position:absolute;left:252.00px;top:311.67px" class="cls_008"><span class="cls_008">instruction</span></div>
<div style="position:absolute;left:252.00px;top:322.67px" class="cls_008"><span class="cls_008">data</span></div>
<div style="position:absolute;left:252.00px;top:333.67px" class="cls_008"><span class="cls_008">symdef</span></div>
<div style="position:absolute;left:252.00px;top:344.67px" class="cls_008"><span class="cls_008">directive</span></div>
<div style="position:absolute;left:216.00px;top:366.67px" class="cls_008"><span class="cls_008">label:</span></div>
<div style="position:absolute;left:252.00px;top:377.67px" class="cls_008"><span class="cls_008">identifier </span><span class="cls_041">:</span></div>
<div style="position:absolute;left:252.00px;top:388.67px" class="cls_008"><span class="cls_008">decimal </span><span class="cls_041">:</span></div>
<div style="position:absolute;left:216.00px;top:410.67px" class="cls_008"><span class="cls_008">identifier:</span></div>
<div style="position:absolute;left:252.00px;top:421.67px" class="cls_029"><span class="cls_029">[A-Za-z.$_][A-Za-z0-9.$_]</span></div>
<div style="position:absolute;left:216.00px;top:443.67px" class="cls_008"><span class="cls_008">instruction:</span></div>
<div style="position:absolute;left:252.00px;top:454.67px" class="cls_008"><span class="cls_008">opcode</span></div>
<div style="position:absolute;left:252.00px;top:465.67px" class="cls_008"><span class="cls_008">opcode operand</span></div>
<div style="position:absolute;left:252.00px;top:476.67px" class="cls_008"><span class="cls_008">opcode operand </span><span class="cls_041">,</span><span class="cls_008"> operand</span></div>
<div style="position:absolute;left:252.00px;top:487.67px" class="cls_008"><span class="cls_008">opcode operand </span><span class="cls_041">,</span><span class="cls_008"> operand </span><span class="cls_041">,</span><span class="cls_008"> operand</span></div>
<div style="position:absolute;left:216.00px;top:509.67px" class="cls_008"><span class="cls_008">opcode:</span></div>
<div style="position:absolute;left:252.00px;top:520.67px" class="cls_006"><span class="cls_006">add</span></div>
<div style="position:absolute;left:252.00px;top:531.67px" class="cls_006"><span class="cls_006">sub</span></div>
<div style="position:absolute;left:252.00px;top:542.67px" class="cls_006"><span class="cls_006">etc.</span></div>
<div style="position:absolute;left:216.00px;top:564.67px" class="cls_006"><span class="cls_006">o</span><span class="cls_008">perand:</span></div>
<div style="position:absolute;left:252.00px;top:575.67px" class="cls_008"><span class="cls_008">register</span></div>
<div style="position:absolute;left:251.98px;top:586.67px" class="cls_041"><span class="cls_041">(</span><span class="cls_008"> register </span><span class="cls_041">)</span></div>
<div style="position:absolute;left:252.00px;top:597.67px" class="cls_008"><span class="cls_008">addr-immed </span><span class="cls_041">(</span><span class="cls_008"> register </span><span class="cls_041">)</span></div>
<div style="position:absolute;left:252.00px;top:608.67px" class="cls_008"><span class="cls_008">addr-immed</span></div>
<div style="position:absolute;left:252.00px;top:619.67px" class="cls_008"><span class="cls_008">float-register</span></div>
<div style="position:absolute;left:252.00px;top:630.67px" class="cls_008"><span class="cls_008">float-const</span></div>
<div style="position:absolute;left:216.00px;top:652.67px" class="cls_008"><span class="cls_008">register:</span></div>
<div style="position:absolute;left:251.97px;top:663.67px" class="cls_041"><span class="cls_041">$</span><span class="cls_008">decimal</span></div>
<div style="position:absolute;left:216.00px;top:685.67px" class="cls_008"><span class="cls_008">float-register:</span></div>
<div style="position:absolute;left:251.97px;top:696.67px" class="cls_041"><span class="cls_041">$f</span><span class="cls_008">decimal</span></div>
<div style="position:absolute;left:298.28px;top:754.68px" class="cls_002"><span class="cls_002">D-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:264660px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX D</span></div>
<div style="position:absolute;left:412.80px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE SYNTAX</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_008"><span class="cls_008">addr-immed:</span></div>
<div style="position:absolute;left:72.00px;top:72.67px" class="cls_008"><span class="cls_008">label-expr</span></div>
<div style="position:absolute;left:72.00px;top:83.67px" class="cls_008"><span class="cls_008">label-expr </span><span class="cls_041">+</span><span class="cls_008"> expr</span></div>
<div style="position:absolute;left:72.00px;top:94.67px" class="cls_008"><span class="cls_008">label-expr </span><span class="cls_041">-</span><span class="cls_008"> expr</span></div>
<div style="position:absolute;left:72.00px;top:105.67px" class="cls_008"><span class="cls_008">expr</span></div>
<div style="position:absolute;left:36.00px;top:127.67px" class="cls_008"><span class="cls_008">label-expr:</span></div>
<div style="position:absolute;left:72.00px;top:138.67px" class="cls_008"><span class="cls_008">label-ref</span></div>
<div style="position:absolute;left:72.00px;top:149.67px" class="cls_008"><span class="cls_008">label-ref </span><span class="cls_041">-</span><span class="cls_008"> label-ref</span></div>
<div style="position:absolute;left:36.00px;top:171.67px" class="cls_008"><span class="cls_008">label-ref:</span></div>
<div style="position:absolute;left:72.00px;top:182.67px" class="cls_008"><span class="cls_008">numeric-ref</span></div>
<div style="position:absolute;left:72.00px;top:193.67px" class="cls_008"><span class="cls_008">identifier</span></div>
<div style="position:absolute;left:36.00px;top:226.67px" class="cls_008"><span class="cls_008">numeric-ref:</span></div>
<div style="position:absolute;left:72.00px;top:237.67px" class="cls_008"><span class="cls_008">decimal</span><span class="cls_041">f</span></div>
<div style="position:absolute;left:72.00px;top:248.67px" class="cls_008"><span class="cls_008">decimal</span><span class="cls_041">b</span></div>
<div style="position:absolute;left:36.00px;top:270.67px" class="cls_008"><span class="cls_008">data:</span></div>
<div style="position:absolute;left:72.00px;top:281.67px" class="cls_008"><span class="cls_008">data-mode data-list</span></div>
<div style="position:absolute;left:72.00px;top:292.67px" class="cls_006"><span class="cls_006">.ascii string</span></div>
<div style="position:absolute;left:72.00px;top:303.67px" class="cls_029"><span class="cls_029">.</span><span class="cls_006">asciiz  string</span></div>
<div style="position:absolute;left:72.00px;top:314.67px" class="cls_029"><span class="cls_029">.</span><span class="cls_006">space  expr</span></div>
<div style="position:absolute;left:36.00px;top:336.67px" class="cls_008"><span class="cls_008">data-mode:</span></div>
<div style="position:absolute;left:72.00px;top:347.67px" class="cls_006"><span class="cls_006">.byte</span></div>
<div style="position:absolute;left:72.00px;top:358.67px" class="cls_006"><span class="cls_006">.half</span></div>
<div style="position:absolute;left:72.00px;top:369.67px" class="cls_006"><span class="cls_006">.hword</span></div>
<div style="position:absolute;left:72.00px;top:380.67px" class="cls_006"><span class="cls_006">.word</span></div>
<div style="position:absolute;left:72.00px;top:391.67px" class="cls_006"><span class="cls_006">.int</span></div>
<div style="position:absolute;left:72.00px;top:402.67px" class="cls_006"><span class="cls_006">.long</span></div>
<div style="position:absolute;left:72.00px;top:413.67px" class="cls_006"><span class="cls_006">.short</span></div>
<div style="position:absolute;left:72.00px;top:424.67px" class="cls_006"><span class="cls_006">.float</span></div>
<div style="position:absolute;left:72.00px;top:435.67px" class="cls_006"><span class="cls_006">.single</span></div>
<div style="position:absolute;left:72.00px;top:446.67px" class="cls_006"><span class="cls_006">.double</span></div>
<div style="position:absolute;left:72.00px;top:457.67px" class="cls_006"><span class="cls_006">.quad</span></div>
<div style="position:absolute;left:72.00px;top:468.67px" class="cls_006"><span class="cls_006">.octa</span></div>
<div style="position:absolute;left:36.00px;top:490.67px" class="cls_008"><span class="cls_008">data-list:</span></div>
<div style="position:absolute;left:72.00px;top:501.67px" class="cls_008"><span class="cls_008">data-expr</span></div>
<div style="position:absolute;left:72.00px;top:512.67px" class="cls_008"><span class="cls_008">data-list </span><span class="cls_041">,</span><span class="cls_008"> data-expr</span></div>
<div style="position:absolute;left:36.00px;top:534.67px" class="cls_008"><span class="cls_008">data-expr:</span></div>
<div style="position:absolute;left:72.00px;top:545.67px" class="cls_008"><span class="cls_008">expr</span></div>
<div style="position:absolute;left:72.00px;top:556.67px" class="cls_008"><span class="cls_008">float-const</span></div>
<div style="position:absolute;left:72.00px;top:567.67px" class="cls_008"><span class="cls_008">expr </span><span class="cls_006">:</span><span class="cls_008"> repeat</span></div>
<div style="position:absolute;left:72.00px;top:578.67px" class="cls_008"><span class="cls_008">float-const </span><span class="cls_006">:</span><span class="cls_008"> repeat</span></div>
<div style="position:absolute;left:36.00px;top:600.67px" class="cls_008"><span class="cls_008">repeat:</span></div>
<div style="position:absolute;left:72.00px;top:611.67px" class="cls_008"><span class="cls_008">expr</span></div>
<div style="position:absolute;left:36.00px;top:633.67px" class="cls_008"><span class="cls_008">symdef:</span></div>
<div style="position:absolute;left:72.00px;top:644.67px" class="cls_008"><span class="cls_008">constant-id </span><span class="cls_041">=</span><span class="cls_008"> expr</span></div>
<div style="position:absolute;left:36.00px;top:666.67px" class="cls_008"><span class="cls_008">constant-id:</span></div>
<div style="position:absolute;left:72.00px;top:677.67px" class="cls_008"><span class="cls_008">identifier</span></div>
<div style="position:absolute;left:36.00px;top:699.67px" class="cls_008"><span class="cls_008">directive:</span></div>
<div style="position:absolute;left:72.00px;top:710.67px" class="cls_008"><span class="cls_008">set-dir</span></div>
<div style="position:absolute;left:72.00px;top:721.67px" class="cls_008"><span class="cls_008">segment-dir</span></div>
<div style="position:absolute;left:291.02px;top:755.33px" class="cls_002"><span class="cls_002">D-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:265462px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE SYNTAX</span></div>
<div style="position:absolute;left:520.58px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX D</span></div>
<div style="position:absolute;left:252.00px;top:50.67px" class="cls_008"><span class="cls_008">align-dir</span></div>
<div style="position:absolute;left:252.00px;top:61.67px" class="cls_008"><span class="cls_008">symbol-dir</span></div>
<div style="position:absolute;left:252.00px;top:72.67px" class="cls_008"><span class="cls_008">block-dir</span></div>
<div style="position:absolute;left:252.00px;top:83.67px" class="cls_008"><span class="cls_008">compiler-dir</span></div>
<div style="position:absolute;left:216.00px;top:105.67px" class="cls_008"><span class="cls_008">set-dir:</span></div>
<div style="position:absolute;left:252.00px;top:116.67px" class="cls_006"><span class="cls_006">.set [no]volatile</span></div>
<div style="position:absolute;left:252.00px;top:127.67px" class="cls_006"><span class="cls_006">.set [no]reorder</span></div>
<div style="position:absolute;left:252.00px;top:138.67px" class="cls_006"><span class="cls_006">.set [no]at</span></div>
<div style="position:absolute;left:252.00px;top:149.67px" class="cls_006"><span class="cls_006">.set [no]macro</span></div>
<div style="position:absolute;left:252.00px;top:160.67px" class="cls_006"><span class="cls_006">.set [no]bopt</span></div>
<div style="position:absolute;left:252.00px;top:171.67px" class="cls_006"><span class="cls_006">.set [no]move</span></div>
<div style="position:absolute;left:216.00px;top:193.67px" class="cls_008"><span class="cls_008">segment-dir:</span></div>
<div style="position:absolute;left:252.00px;top:204.67px" class="cls_006"><span class="cls_006">.text</span></div>
<div style="position:absolute;left:252.00px;top:215.67px" class="cls_006"><span class="cls_006">.data</span></div>
<div style="position:absolute;left:252.00px;top:226.67px" class="cls_006"><span class="cls_006">.rdata</span></div>
<div style="position:absolute;left:252.00px;top:237.67px" class="cls_006"><span class="cls_006">.sdata</span></div>
<div style="position:absolute;left:216.00px;top:259.67px" class="cls_008"><span class="cls_008">align-dir:</span></div>
<div style="position:absolute;left:252.00px;top:270.67px" class="cls_006"><span class="cls_006">.align </span><span class="cls_008">expr</span></div>
<div style="position:absolute;left:216.00px;top:292.67px" class="cls_008"><span class="cls_008">symbol-dir:</span></div>
<div style="position:absolute;left:251.98px;top:303.67px" class="cls_041"><span class="cls_041">.</span><span class="cls_006">globl</span><span class="cls_008"> identifier</span></div>
<div style="position:absolute;left:251.99px;top:314.67px" class="cls_041"><span class="cls_041">.</span><span class="cls_006">extern</span><span class="cls_008"> identifier </span><span class="cls_041">,</span><span class="cls_008"> constant</span></div>
<div style="position:absolute;left:251.99px;top:325.67px" class="cls_041"><span class="cls_041">.</span><span class="cls_006">comm</span><span class="cls_008"> identifier </span><span class="cls_041">,</span><span class="cls_008"> constant</span></div>
<div style="position:absolute;left:251.99px;top:336.67px" class="cls_041"><span class="cls_041">.</span><span class="cls_006">lcomm</span><span class="cls_008"> identifier </span><span class="cls_041">,</span><span class="cls_008"> constant</span></div>
<div style="position:absolute;left:216.00px;top:358.67px" class="cls_008"><span class="cls_008">block-dir:</span></div>
<div style="position:absolute;left:252.00px;top:369.67px" class="cls_006"><span class="cls_006">.ent</span><span class="cls_008"> identifier</span></div>
<div style="position:absolute;left:252.00px;top:380.67px" class="cls_006"><span class="cls_006">.ent</span><span class="cls_008"> identifier </span><span class="cls_041">,</span><span class="cls_008"> constant</span></div>
<div style="position:absolute;left:252.00px;top:391.67px" class="cls_006"><span class="cls_006">.aent</span><span class="cls_008"> identifier </span><span class="cls_041">,</span><span class="cls_008"> constant</span></div>
<div style="position:absolute;left:252.00px;top:402.67px" class="cls_006"><span class="cls_006">.mask</span><span class="cls_008"> expr </span><span class="cls_041">,</span><span class="cls_008"> expr</span></div>
<div style="position:absolute;left:252.00px;top:413.67px" class="cls_006"><span class="cls_006">.fmask</span><span class="cls_008"> expr </span><span class="cls_041">,</span><span class="cls_008"> expr</span></div>
<div style="position:absolute;left:252.00px;top:424.67px" class="cls_006"><span class="cls_006">.frame</span><span class="cls_008"> register </span><span class="cls_041">,</span><span class="cls_008"> expr </span><span class="cls_041">,</span><span class="cls_008"> register</span></div>
<div style="position:absolute;left:252.00px;top:435.67px" class="cls_006"><span class="cls_006">.end</span><span class="cls_008"> identifier</span></div>
<div style="position:absolute;left:252.00px;top:446.67px" class="cls_006"><span class="cls_006">.end</span></div>
<div style="position:absolute;left:216.00px;top:468.67px" class="cls_008"><span class="cls_008">compiler-dir:</span></div>
<div style="position:absolute;left:252.00px;top:479.67px" class="cls_006"><span class="cls_006">.alias</span><span class="cls_008"> register </span><span class="cls_041">,</span><span class="cls_008"> register</span></div>
<div style="position:absolute;left:252.00px;top:490.67px" class="cls_006"><span class="cls_006">.bgnb</span><span class="cls_008"> expr</span></div>
<div style="position:absolute;left:252.00px;top:501.67px" class="cls_006"><span class="cls_006">.endb</span><span class="cls_008"> expr</span></div>
<div style="position:absolute;left:252.00px;top:512.67px" class="cls_006"><span class="cls_006">.file</span><span class="cls_008"> constant string</span></div>
<div style="position:absolute;left:252.00px;top:523.67px" class="cls_006"><span class="cls_006">.galive</span></div>
<div style="position:absolute;left:252.00px;top:534.67px" class="cls_006"><span class="cls_006">.gjaldef</span></div>
<div style="position:absolute;left:252.00px;top:545.67px" class="cls_006"><span class="cls_006">.gjrlive</span></div>
<div style="position:absolute;left:252.00px;top:556.67px" class="cls_006"><span class="cls_006">.lab </span><span class="cls_008">identifier</span></div>
<div style="position:absolute;left:252.00px;top:567.67px" class="cls_006"><span class="cls_006">.livereg</span><span class="cls_008"> expr </span><span class="cls_041">,</span><span class="cls_008"> expr</span></div>
<div style="position:absolute;left:252.00px;top:578.67px" class="cls_006"><span class="cls_006">.noalias</span><span class="cls_008"> register </span><span class="cls_041">,</span><span class="cls_008"> register</span></div>
<div style="position:absolute;left:252.00px;top:589.67px" class="cls_006"><span class="cls_006">.option flag</span></div>
<div style="position:absolute;left:252.00px;top:600.67px" class="cls_006"><span class="cls_006">.verstamp </span><span class="cls_008">constant constant</span></div>
<div style="position:absolute;left:252.00px;top:611.67px" class="cls_006"><span class="cls_006">.vreg </span><span class="cls_008">expr </span><span class="cls_041">,</span><span class="cls_008"> expr</span></div>
<div style="position:absolute;left:216.00px;top:633.67px" class="cls_008"><span class="cls_008">expr:</span></div>
<div style="position:absolute;left:252.00px;top:644.67px" class="cls_008"><span class="cls_008">expr binary-op expr</span></div>
<div style="position:absolute;left:252.00px;top:655.67px" class="cls_008"><span class="cls_008">term</span></div>
<div style="position:absolute;left:216.00px;top:677.67px" class="cls_008"><span class="cls_008">term:</span></div>
<div style="position:absolute;left:252.00px;top:688.67px" class="cls_008"><span class="cls_008">unary-operator term</span></div>
<div style="position:absolute;left:252.00px;top:699.67px" class="cls_008"><span class="cls_008">primary</span></div>
<div style="position:absolute;left:216.00px;top:721.67px" class="cls_008"><span class="cls_008">primary:</span></div>
<div style="position:absolute;left:304.78px;top:755.33px" class="cls_002"><span class="cls_002">D-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:266264px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX D</span></div>
<div style="position:absolute;left:412.80px;top:28.00px" class="cls_002"><span class="cls_002">ASSEMBLER LANGUAGE SYNTAX</span></div>
<div style="position:absolute;left:72.00px;top:50.67px" class="cls_008"><span class="cls_008">constant</span></div>
<div style="position:absolute;left:72.00px;top:61.67px" class="cls_041"><span class="cls_041">(</span><span class="cls_008"> expr </span><span class="cls_041">)</span></div>
<div style="position:absolute;left:36.00px;top:116.67px" class="cls_008"><span class="cls_008">binary-op: </span><span class="cls_029">one of</span></div>
<div style="position:absolute;left:72.00px;top:127.67px" class="cls_006"><span class="cls_006">*</span></div>
<div style="position:absolute;left:108.00px;top:127.67px" class="cls_006"><span class="cls_006">/</span></div>
<div style="position:absolute;left:144.00px;top:127.67px" class="cls_006"><span class="cls_006">%</span></div>
<div style="position:absolute;left:72.00px;top:138.67px" class="cls_006"><span class="cls_006">+</span></div>
<div style="position:absolute;left:108.00px;top:138.67px" class="cls_006"><span class="cls_006">-</span></div>
<div style="position:absolute;left:72.00px;top:149.67px" class="cls_006"><span class="cls_006">&lt;&lt;</span></div>
<div style="position:absolute;left:108.00px;top:149.67px" class="cls_006"><span class="cls_006">>></span></div>
<div style="position:absolute;left:72.00px;top:160.67px" class="cls_006"><span class="cls_006">&</span></div>
<div style="position:absolute;left:72.00px;top:171.67px" class="cls_006"><span class="cls_006">^</span></div>
<div style="position:absolute;left:72.00px;top:182.67px" class="cls_006"><span class="cls_006">|</span></div>
<div style="position:absolute;left:36.00px;top:204.67px" class="cls_041"><span class="cls_041">unary-operator: one of</span></div>
<div style="position:absolute;left:72.00px;top:215.67px" class="cls_006"><span class="cls_006">+</span></div>
<div style="position:absolute;left:108.00px;top:215.67px" class="cls_006"><span class="cls_006">-</span></div>
<div style="position:absolute;left:144.00px;top:215.67px" class="cls_006"><span class="cls_006">~</span></div>
<div style="position:absolute;left:180.00px;top:215.67px" class="cls_006"><span class="cls_006">!</span></div>
<div style="position:absolute;left:36.00px;top:237.67px" class="cls_008"><span class="cls_008">constant:</span></div>
<div style="position:absolute;left:72.00px;top:248.67px" class="cls_008"><span class="cls_008">decimal</span></div>
<div style="position:absolute;left:72.00px;top:259.67px" class="cls_008"><span class="cls_008">hexadecimal</span></div>
<div style="position:absolute;left:72.00px;top:270.67px" class="cls_008"><span class="cls_008">octal</span></div>
<div style="position:absolute;left:72.00px;top:281.67px" class="cls_008"><span class="cls_008">character-const</span></div>
<div style="position:absolute;left:72.00px;top:292.67px" class="cls_008"><span class="cls_008">constant-id</span></div>
<div style="position:absolute;left:36.00px;top:314.67px" class="cls_008"><span class="cls_008">decimal:</span></div>
<div style="position:absolute;left:72.00px;top:325.67px" class="cls_029"><span class="cls_029">[1-9][0-9]+</span></div>
<div style="position:absolute;left:36.00px;top:347.67px" class="cls_008"><span class="cls_008">hexadecimal:</span></div>
<div style="position:absolute;left:72.00px;top:358.67px" class="cls_006"><span class="cls_006">0x</span><span class="cls_041">[0-9a-fA-F]+</span></div>
<div style="position:absolute;left:72.00px;top:369.67px" class="cls_006"><span class="cls_006">0X</span><span class="cls_041">[0-9a-fA-F]+</span></div>
<div style="position:absolute;left:36.00px;top:391.67px" class="cls_041"><span class="cls_041">octal:</span></div>
<div style="position:absolute;left:72.00px;top:402.67px" class="cls_006"><span class="cls_006">0</span><span class="cls_041">[0-7]+</span></div>
<div style="position:absolute;left:36.00px;top:424.67px" class="cls_041"><span class="cls_041">character-const:</span></div>
<div style="position:absolute;left:72.00px;top:435.67px" class="cls_041"><span class="cls_041">’x’</span></div>
<div style="position:absolute;left:36.00px;top:457.67px" class="cls_041"><span class="cls_041">string:</span></div>
<div style="position:absolute;left:72.00px;top:468.67px" class="cls_041"><span class="cls_041">"xxxx"</span></div>
<div style="position:absolute;left:36.00px;top:490.67px" class="cls_041"><span class="cls_041">float-const: for example</span></div>
<div style="position:absolute;left:72.00px;top:501.67px" class="cls_029"><span class="cls_029">1.23</span></div>
<div style="position:absolute;left:108.01px;top:501.67px" class="cls_029"><span class="cls_029">.23</span></div>
<div style="position:absolute;left:144.01px;top:501.67px" class="cls_029"><span class="cls_029">0.23</span></div>
<div style="position:absolute;left:180.02px;top:501.67px" class="cls_029"><span class="cls_029">1.</span></div>
<div style="position:absolute;left:216.02px;top:501.67px" class="cls_029"><span class="cls_029">1.0</span></div>
<div style="position:absolute;left:252.02px;top:501.67px" class="cls_029"><span class="cls_029">1.2e101.2e-15</span></div>
<div style="position:absolute;left:291.02px;top:755.34px" class="cls_002"><span class="cls_002">D-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:267066px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">OBJECT CODE FORMATS</span></div>
<div style="position:absolute;left:486.77px;top:42.00px" class="cls_015"><span class="cls_015">APPENDIX E</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:228.02px;top:124.67px" class="cls_006"><span class="cls_006">This appendix describes two object file formats that are often used in</span></div>
<div style="position:absolute;left:216.00px;top:135.67px" class="cls_006"><span class="cls_006">MIPS development systems. Object files are created by the compiler and/</span></div>
<div style="position:absolute;left:216.00px;top:146.67px" class="cls_006"><span class="cls_006">or assembler, and the link editor. An object file is a binary representation</span></div>
<div style="position:absolute;left:216.00px;top:157.67px" class="cls_006"><span class="cls_006">of part or all of a program, and usually has two distinct forms:</span></div>
<div style="position:absolute;left:228.02px;top:171.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Relocatable object file</span><span class="cls_006">: holds the code and data resulting from the</span></div>
<div style="position:absolute;left:239.98px;top:182.67px" class="cls_006"><span class="cls_006">compilation  of  a  single  module,  suitable  for  linking  with  other</span></div>
<div style="position:absolute;left:239.98px;top:193.67px" class="cls_006"><span class="cls_006">relocatable object files to create an executable object file. A relocatable</span></div>
<div style="position:absolute;left:239.98px;top:204.67px" class="cls_006"><span class="cls_006">file includes relocation information and symbol tables which allow the</span></div>
<div style="position:absolute;left:239.98px;top:215.67px" class="cls_006"><span class="cls_006">link editor to combine the individual modules, and to patch (relocate)</span></div>
<div style="position:absolute;left:239.98px;top:226.67px" class="cls_006"><span class="cls_006">instructions or data which depend on the program’s final location in</span></div>
<div style="position:absolute;left:239.98px;top:237.67px" class="cls_006"><span class="cls_006">memory. Other parts of the file may encode information to support</span></div>
<div style="position:absolute;left:239.98px;top:248.67px" class="cls_006"><span class="cls_006">symbolic debugging.</span></div>
<div style="position:absolute;left:228.03px;top:262.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> Executable object file</span><span class="cls_006">: holds a complete program, suitable for direct</span></div>
<div style="position:absolute;left:239.98px;top:273.67px" class="cls_006"><span class="cls_006">execution by a CPU. This file will not include relocation information,</span></div>
<div style="position:absolute;left:239.98px;top:284.67px" class="cls_006"><span class="cls_006">but may add a simple header which tells the operating system or</span></div>
<div style="position:absolute;left:239.98px;top:295.67px" class="cls_006"><span class="cls_006">bootstrap loader where each part of the object file is to be located in</span></div>
<div style="position:absolute;left:239.98px;top:306.67px" class="cls_006"><span class="cls_006">memory.</span></div>
<div style="position:absolute;left:228.03px;top:317.67px" class="cls_006"><span class="cls_006">The software development system should be equipped with tools to allow</span></div>
<div style="position:absolute;left:216.01px;top:328.67px" class="cls_006"><span class="cls_006">the programmer to inspect the contents of an object file, or to convert it</span></div>
<div style="position:absolute;left:216.01px;top:339.67px" class="cls_006"><span class="cls_006">into alternative (possibly ASCII) formats which can be downloaded to a</span></div>
<div style="position:absolute;left:216.01px;top:350.67px" class="cls_006"><span class="cls_006">PROM programmer or evaluation board. Common tools are described</span></div>
<div style="position:absolute;left:216.01px;top:361.67px" class="cls_006"><span class="cls_006">below.</span></div>
<div style="position:absolute;left:216.00px;top:384.00px" class="cls_015"><span class="cls_015">SECTIONS AND SEGMENTS</span></div>
<div style="position:absolute;left:228.02px;top:397.67px" class="cls_006"><span class="cls_006">An object file consists of a number of separate </span><span class="cls_008">sections</span><span class="cls_006">: most correspond</span></div>
<div style="position:absolute;left:216.00px;top:408.67px" class="cls_006"><span class="cls_006">to the program’s instructions and data, but some additional sections hold</span></div>
<div style="position:absolute;left:216.00px;top:419.67px" class="cls_006"><span class="cls_006">information for linkers and debuggers. Each section has a name to identify</span></div>
<div style="position:absolute;left:216.00px;top:430.67px" class="cls_006"><span class="cls_006">it (e.g. ‘‘</span><span class="cls_029">.text</span><span class="cls_006">’’ and ‘‘</span><span class="cls_029"> .rdata</span><span class="cls_006">’’), and a complete list of the standard program</span></div>
<div style="position:absolute;left:216.00px;top:441.67px" class="cls_006"><span class="cls_006">sections recognized by the development toolchain should be included in its</span></div>
<div style="position:absolute;left:216.00px;top:452.67px" class="cls_006"><span class="cls_006">documentation.</span></div>
<div style="position:absolute;left:228.02px;top:463.67px" class="cls_006"><span class="cls_006">The reason for splitting the program up like this is so that the link editor</span></div>
<div style="position:absolute;left:216.00px;top:474.67px" class="cls_006"><span class="cls_006">can then merge the different parts of the program that need to be located</span></div>
<div style="position:absolute;left:216.00px;top:485.67px" class="cls_006"><span class="cls_006">together in memory (e.g. a ROMable program needs all code and read-only</span></div>
<div style="position:absolute;left:216.00px;top:496.67px" class="cls_006"><span class="cls_006">data in ROM, but writable data in RAM). When the link editor produces the</span></div>
<div style="position:absolute;left:216.00px;top:507.67px" class="cls_006"><span class="cls_006">final executable object file it concatenates all </span><span class="cls_008">sections</span><span class="cls_006"> of the same name</span></div>
<div style="position:absolute;left:216.00px;top:518.67px" class="cls_006"><span class="cls_006">together,  and  then  further  merges  those  sections  which  are  located</span></div>
<div style="position:absolute;left:216.00px;top:529.67px" class="cls_006"><span class="cls_006">together in memory into a smaller number of contiguous </span><span class="cls_008">segments</span><span class="cls_006">. An</span></div>
<div style="position:absolute;left:216.01px;top:540.67px" class="cls_006"><span class="cls_006">object file header is prepended to identify the position of each segment in</span></div>
<div style="position:absolute;left:216.01px;top:551.67px" class="cls_006"><span class="cls_006">the file, and its intended location in memory.</span></div>
<div style="position:absolute;left:216.00px;top:574.00px" class="cls_015"><span class="cls_015">ECOFF OBJECT FILE FORMAT (RISC/OS)</span></div>
<div style="position:absolute;left:228.02px;top:587.67px" class="cls_006"><span class="cls_006">The original MIPS Corp. compilers were Unix-based and until fairly</span></div>
<div style="position:absolute;left:216.00px;top:598.67px" class="cls_006"><span class="cls_006">recently used the ECOFF object code format. Development systems from</span></div>
<div style="position:absolute;left:216.00px;top:609.67px" class="cls_006"><span class="cls_006">other vendors often use or at least support inter-linking with this format,</span></div>
<div style="position:absolute;left:216.00px;top:620.67px" class="cls_006"><span class="cls_006">in the interests of compatibility. ECOFF is based on an earlier format</span></div>
<div style="position:absolute;left:216.00px;top:631.67px" class="cls_006"><span class="cls_006">called COFF, which stands for </span><span class="cls_008">Common Object File Format</span><span class="cls_006">, and first</span></div>
<div style="position:absolute;left:216.00px;top:642.67px" class="cls_006"><span class="cls_006">appeared in early versions of Unix System V. COFF was a brave (and</span></div>
<div style="position:absolute;left:216.00px;top:653.67px" class="cls_006"><span class="cls_006">largely unsuccessful) attempt to define a flexible object code format that</span></div>
<div style="position:absolute;left:216.00px;top:664.67px" class="cls_006"><span class="cls_006">would be portable to a large number of processor architectures.</span></div>
<div style="position:absolute;left:228.02px;top:675.67px" class="cls_006"><span class="cls_006">The ‘‘E’’ in ‘‘ECOFF’’ stands for </span><span class="cls_008">Extended</span><span class="cls_006">. The MIPS engineers wanted</span></div>
<div style="position:absolute;left:216.01px;top:686.67px" class="cls_006"><span class="cls_006">the flexibility of COFF to support gp-relative addressing, which would have</span></div>
<div style="position:absolute;left:216.01px;top:697.67px" class="cls_006"><span class="cls_006">been impossible with the restrictive format used on earlier Unix systems.</span></div>
<div style="position:absolute;left:216.01px;top:708.67px" class="cls_006"><span class="cls_006">However they decided to replace the COFF symbol table and debug data</span></div>
<div style="position:absolute;left:298.53px;top:754.68px" class="cls_002"><span class="cls_002">E-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:267868px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX E</span></div>
<div style="position:absolute;left:450.16px;top:28.00px" class="cls_002"><span class="cls_002">OBJECT CODE FORMATS</span></div>
<div style="position:absolute;left:36.00px;top:50.67px" class="cls_006"><span class="cls_006">with a completely different design. The ECOFF symbol table format is</span></div>
<div style="position:absolute;left:36.00px;top:61.67px" class="cls_006"><span class="cls_006">certainly much more powerful and compact than the rather primitive</span></div>
<div style="position:absolute;left:36.00px;top:72.67px" class="cls_006"><span class="cls_006">COFF format, but it is also much more difficult to generate and interpret.</span></div>
<div style="position:absolute;left:48.02px;top:83.67px" class="cls_006"><span class="cls_006">Fortunately,   embedded   system   applications   are   unlikely   to   be</span></div>
<div style="position:absolute;left:36.00px;top:94.67px" class="cls_006"><span class="cls_006">concerned  with  the  internal  structure  of  the  symbol  tables.  The</span></div>
<div style="position:absolute;left:36.00px;top:105.67px" class="cls_006"><span class="cls_006">programmer probably only needs to recognize the COFF </span><span class="cls_008">file header</span><span class="cls_006"> and</span></div>
<div style="position:absolute;left:36.00px;top:116.67px" class="cls_006"><span class="cls_006">‘‘optional’’ </span><span class="cls_008">a.out</span><span class="cls_006"> header, which are largely unchanged from the original</span></div>
<div style="position:absolute;left:36.00px;top:127.67px" class="cls_006"><span class="cls_006">COFF definitions.</span></div>
<div style="position:absolute;left:36.00px;top:150.00px" class="cls_015"><span class="cls_015">File header</span></div>
<div style="position:absolute;left:48.02px;top:163.67px" class="cls_006"><span class="cls_006">The COFF file header consists of the following 20 bytes at the start of the</span></div>
<div style="position:absolute;left:36.00px;top:174.67px" class="cls_006"><span class="cls_006">file:</span></div>
<div style="position:absolute;left:82.17px;top:195.00px" class="cls_020"><span class="cls_020">Offset</span></div>
<div style="position:absolute;left:121.58px;top:195.00px" class="cls_020"><span class="cls_020">Type</span></div>
<div style="position:absolute;left:198.88px;top:195.00px" class="cls_020"><span class="cls_020">Name</span></div>
<div style="position:absolute;left:247.43px;top:195.00px" class="cls_020"><span class="cls_020">Purpose</span></div>
<div style="position:absolute;left:82.17px;top:212.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:121.49px;top:212.00px" class="cls_020"><span class="cls_020">unsigned short</span></div>
<div style="position:absolute;left:198.98px;top:212.00px" class="cls_020"><span class="cls_020">f_magic</span></div>
<div style="position:absolute;left:247.58px;top:212.00px" class="cls_020"><span class="cls_020">Magic number (see</span></div>
<div style="position:absolute;left:247.10px;top:222.00px" class="cls_020"><span class="cls_020">below)</span></div>
<div style="position:absolute;left:82.17px;top:239.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:121.49px;top:239.00px" class="cls_020"><span class="cls_020">unsigned short</span></div>
<div style="position:absolute;left:198.98px;top:239.00px" class="cls_020"><span class="cls_020">f_nscns</span></div>
<div style="position:absolute;left:247.58px;top:239.00px" class="cls_020"><span class="cls_020">Number of sections</span></div>
<div style="position:absolute;left:82.17px;top:256.00px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:121.49px;top:256.00px" class="cls_020"><span class="cls_020">long</span></div>
<div style="position:absolute;left:198.78px;top:256.00px" class="cls_020"><span class="cls_020">f_timdat</span></div>
<div style="position:absolute;left:247.39px;top:256.00px" class="cls_020"><span class="cls_020">Time and date stamp</span></div>
<div style="position:absolute;left:247.10px;top:266.00px" class="cls_020"><span class="cls_020">(Unix style)</span></div>
<div style="position:absolute;left:82.17px;top:283.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:121.49px;top:283.00px" class="cls_020"><span class="cls_020">long</span></div>
<div style="position:absolute;left:198.78px;top:283.00px" class="cls_020"><span class="cls_020">f_symptr</span></div>
<div style="position:absolute;left:247.40px;top:283.00px" class="cls_020"><span class="cls_020">File offset of symbol</span></div>
<div style="position:absolute;left:247.10px;top:293.00px" class="cls_020"><span class="cls_020">table</span></div>
<div style="position:absolute;left:82.17px;top:310.00px" class="cls_020"><span class="cls_020">12</span></div>
<div style="position:absolute;left:121.51px;top:310.00px" class="cls_020"><span class="cls_020">long</span></div>
<div style="position:absolute;left:198.81px;top:310.00px" class="cls_020"><span class="cls_020">f_nsyms</span></div>
<div style="position:absolute;left:247.41px;top:310.00px" class="cls_020"><span class="cls_020">Number of symbols</span></div>
<div style="position:absolute;left:82.17px;top:327.00px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:121.51px;top:327.00px" class="cls_020"><span class="cls_020">unsigned short</span></div>
<div style="position:absolute;left:199.00px;top:327.00px" class="cls_020"><span class="cls_020">f_opthdr</span></div>
<div style="position:absolute;left:247.61px;top:327.00px" class="cls_020"><span class="cls_020">Size of optional header</span></div>
<div style="position:absolute;left:82.17px;top:344.00px" class="cls_020"><span class="cls_020">18</span></div>
<div style="position:absolute;left:121.51px;top:344.00px" class="cls_020"><span class="cls_020">unsigned short</span></div>
<div style="position:absolute;left:199.00px;top:344.00px" class="cls_020"><span class="cls_020">f_flags</span></div>
<div style="position:absolute;left:247.58px;top:344.00px" class="cls_020"><span class="cls_020">Various flag bits</span></div>
<div style="position:absolute;left:48.02px;top:363.67px" class="cls_006"><span class="cls_006">From this list only the following fields are really important:</span></div>
<div style="position:absolute;left:48.02px;top:377.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> f_magic</span><span class="cls_006">: must be one of the following values: Object files with the</span></div>
<div style="position:absolute;left:82.18px;top:398.00px" class="cls_020"><span class="cls_020">Name</span></div>
<div style="position:absolute;left:179.40px;top:398.00px" class="cls_020"><span class="cls_020">Value</span></div>
<div style="position:absolute;left:230.11px;top:398.00px" class="cls_020"><span class="cls_020">Meaning</span></div>
<div style="position:absolute;left:82.18px;top:415.01px" class="cls_020"><span class="cls_020">MIPSEBMAGIC</span></div>
<div style="position:absolute;left:179.57px;top:415.01px" class="cls_020"><span class="cls_020">0x0160</span></div>
<div style="position:absolute;left:230.30px;top:415.01px" class="cls_020"><span class="cls_020">Big-endian MIPS binary</span></div>
<div style="position:absolute;left:82.18px;top:432.01px" class="cls_020"><span class="cls_020">MIPSELMAGIC</span></div>
<div style="position:absolute;left:179.56px;top:432.01px" class="cls_020"><span class="cls_020">0x0162</span></div>
<div style="position:absolute;left:230.29px;top:432.01px" class="cls_020"><span class="cls_020">Little-endian MIPS binary</span></div>
<div style="position:absolute;left:82.18px;top:449.01px" class="cls_020"><span class="cls_020">SMIPSEBMAGIC</span></div>
<div style="position:absolute;left:179.59px;top:449.01px" class="cls_020"><span class="cls_020">0x6001</span></div>
<div style="position:absolute;left:230.32px;top:449.01px" class="cls_020"><span class="cls_020">Big-endian MIPS binary</span></div>
<div style="position:absolute;left:229.87px;top:459.01px" class="cls_020"><span class="cls_020">with little-endian headers</span></div>
<div style="position:absolute;left:82.18px;top:476.01px" class="cls_020"><span class="cls_020">SMIPSELMAGIC</span></div>
<div style="position:absolute;left:179.59px;top:476.01px" class="cls_020"><span class="cls_020">0x6201</span></div>
<div style="position:absolute;left:230.32px;top:476.01px" class="cls_020"><span class="cls_020">Little-endian MIPS binary</span></div>
<div style="position:absolute;left:229.87px;top:486.01px" class="cls_020"><span class="cls_020">with big-endian headers</span></div>
<div style="position:absolute;left:59.98px;top:505.67px" class="cls_041"><span class="cls_041">SMIPS...</span><span class="cls_006"> magic numbers were generated on hosts of the opposite</span></div>
<div style="position:absolute;left:59.97px;top:516.67px" class="cls_006"><span class="cls_006">endianness, and software will have to individually byte-swap each</span></div>
<div style="position:absolute;left:59.97px;top:527.67px" class="cls_006"><span class="cls_006">field required from the file and </span><span class="cls_008">a.out</span><span class="cls_006"> headers.</span></div>
<div style="position:absolute;left:48.03px;top:541.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> f_opthdr</span><span class="cls_006">: the size in the file of the </span><span class="cls_008">a.out</span><span class="cls_006"> header: this valueis used to</span></div>
<div style="position:absolute;left:59.98px;top:552.67px" class="cls_006"><span class="cls_006">work out the program’s offset in the file.</span></div>
<div style="position:absolute;left:48.03px;top:566.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> f_nscns</span><span class="cls_006">: the number of </span><span class="cls_008">section</span><span class="cls_006"> headers in the file: this is also needed</span></div>
<div style="position:absolute;left:59.98px;top:577.67px" class="cls_006"><span class="cls_006">to work out the program’s offset.</span></div>
<div style="position:absolute;left:36.00px;top:600.00px" class="cls_015"><span class="cls_015">Optional a.out header</span></div>
<div style="position:absolute;left:48.02px;top:613.67px" class="cls_006"><span class="cls_006">The </span><span class="cls_008">a.out</span><span class="cls_006"> header is a left-over from earlier Unix versions, which has</span></div>
<div style="position:absolute;left:36.00px;top:624.67px" class="cls_006"><span class="cls_006">been shoe-horned into COFF. It follows the COFF file header, and does the</span></div>
<div style="position:absolute;left:36.00px;top:635.67px" class="cls_006"><span class="cls_006">job  of  coalescing  the  COFF </span><span class="cls_008"> sections</span><span class="cls_006">  into  exactly  three  contiguous</span></div>
<div style="position:absolute;left:36.00px;top:646.67px" class="cls_008"><span class="cls_008">segments</span><span class="cls_006">: text (instructions and read-only data); data (initialized, writable</span></div>
<div style="position:absolute;left:36.00px;top:657.67px" class="cls_006"><span class="cls_006">data); and BSS (uninitialized data, set to zero).</span></div>
<div style="position:absolute;left:81.03px;top:678.00px" class="cls_020"><span class="cls_020">Offset</span></div>
<div style="position:absolute;left:125.22px;top:678.00px" class="cls_020"><span class="cls_020">Type</span></div>
<div style="position:absolute;left:163.33px;top:678.00px" class="cls_020"><span class="cls_020">Name</span></div>
<div style="position:absolute;left:235.09px;top:678.00px" class="cls_020"><span class="cls_020">Purpose</span></div>
<div style="position:absolute;left:81.03px;top:695.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:125.13px;top:695.00px" class="cls_020"><span class="cls_020">short</span></div>
<div style="position:absolute;left:163.25px;top:695.00px" class="cls_020"><span class="cls_020">magic</span></div>
<div style="position:absolute;left:235.02px;top:695.00px" class="cls_020"><span class="cls_020">Magic number</span></div>
<div style="position:absolute;left:81.03px;top:712.01px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:125.13px;top:712.01px" class="cls_020"><span class="cls_020">short</span></div>
<div style="position:absolute;left:163.25px;top:712.01px" class="cls_020"><span class="cls_020">vstamp</span></div>
<div style="position:absolute;left:235.04px;top:712.01px" class="cls_020"><span class="cls_020">Version stamp</span></div>
<div style="position:absolute;left:291.29px;top:755.33px" class="cls_002"><span class="cls_002">E-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:268670px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">OBJECT CODE FORMATS</span></div>
<div style="position:absolute;left:520.92px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX E</span></div>
<div style="position:absolute;left:261.03px;top:55.00px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:305.13px;top:55.00px" class="cls_020"><span class="cls_020">long</span></div>
<div style="position:absolute;left:343.23px;top:55.00px" class="cls_020"><span class="cls_020">tsize</span></div>
<div style="position:absolute;left:414.97px;top:55.00px" class="cls_020"><span class="cls_020">Text size</span></div>
<div style="position:absolute;left:261.03px;top:72.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:305.13px;top:72.00px" class="cls_020"><span class="cls_020">long</span></div>
<div style="position:absolute;left:343.23px;top:72.00px" class="cls_020"><span class="cls_020">dsize</span></div>
<div style="position:absolute;left:414.98px;top:72.00px" class="cls_020"><span class="cls_020">Data size</span></div>
<div style="position:absolute;left:261.03px;top:89.00px" class="cls_020"><span class="cls_020">12</span></div>
<div style="position:absolute;left:305.15px;top:89.00px" class="cls_020"><span class="cls_020">long</span></div>
<div style="position:absolute;left:343.25px;top:89.00px" class="cls_020"><span class="cls_020">bsize</span></div>
<div style="position:absolute;left:415.01px;top:89.00px" class="cls_020"><span class="cls_020">BSS size</span></div>
<div style="position:absolute;left:261.03px;top:106.00px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:305.15px;top:106.00px" class="cls_020"><span class="cls_020">long</span></div>
<div style="position:absolute;left:343.25px;top:106.00px" class="cls_020"><span class="cls_020">entry</span></div>
<div style="position:absolute;left:415.01px;top:106.00px" class="cls_020"><span class="cls_020">Entry-point address</span></div>
<div style="position:absolute;left:261.03px;top:123.00px" class="cls_020"><span class="cls_020">20</span></div>
<div style="position:absolute;left:305.15px;top:123.00px" class="cls_020"><span class="cls_020">long</span></div>
<div style="position:absolute;left:343.25px;top:123.00px" class="cls_020"><span class="cls_020">text_start</span></div>
<div style="position:absolute;left:415.09px;top:123.00px" class="cls_020"><span class="cls_020">Text base address</span></div>
<div style="position:absolute;left:261.03px;top:140.01px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:305.15px;top:140.01px" class="cls_020"><span class="cls_020">long</span></div>
<div style="position:absolute;left:343.25px;top:140.01px" class="cls_020"><span class="cls_020">data_start</span></div>
<div style="position:absolute;left:415.10px;top:140.01px" class="cls_020"><span class="cls_020">Data base address</span></div>
<div style="position:absolute;left:261.03px;top:157.01px" class="cls_020"><span class="cls_020">28</span></div>
<div style="position:absolute;left:305.15px;top:157.01px" class="cls_020"><span class="cls_020">long</span></div>
<div style="position:absolute;left:343.25px;top:157.01px" class="cls_020"><span class="cls_020">bss_start‡</span></div>
<div style="position:absolute;left:415.11px;top:157.01px" class="cls_020"><span class="cls_020">BSS base address</span></div>
<div style="position:absolute;left:261.03px;top:174.01px" class="cls_020"><span class="cls_020">32</span></div>
<div style="position:absolute;left:305.15px;top:174.01px" class="cls_020"><span class="cls_020">long</span></div>
<div style="position:absolute;left:343.25px;top:174.01px" class="cls_020"><span class="cls_020">gprmask‡</span></div>
<div style="position:absolute;left:415.10px;top:174.01px" class="cls_020"><span class="cls_020">General registers ‘‘used’’</span></div>
<div style="position:absolute;left:414.76px;top:184.01px" class="cls_020"><span class="cls_020">mask</span></div>
<div style="position:absolute;left:261.03px;top:201.01px" class="cls_020"><span class="cls_020">36</span></div>
<div style="position:absolute;left:305.15px;top:201.01px" class="cls_020"><span class="cls_020">long</span></div>
<div style="position:absolute;left:343.25px;top:201.01px" class="cls_020"><span class="cls_020">cprmask[4]‡</span></div>
<div style="position:absolute;left:415.14px;top:201.01px" class="cls_020"><span class="cls_020">Coprocessor registers</span></div>
<div style="position:absolute;left:414.76px;top:211.01px" class="cls_020"><span class="cls_020">used masks</span></div>
<div style="position:absolute;left:261.03px;top:228.01px" class="cls_020"><span class="cls_020">52</span></div>
<div style="position:absolute;left:305.15px;top:228.01px" class="cls_020"><span class="cls_020">long</span></div>
<div style="position:absolute;left:343.25px;top:228.01px" class="cls_020"><span class="cls_020">gpvalue‡</span></div>
<div style="position:absolute;left:415.08px;top:228.01px" class="cls_020"><span class="cls_020">GP value for this file</span></div>
<div style="position:absolute;left:228.02px;top:246.67px" class="cls_006"><span class="cls_006">Those fields marked ‡ are new to ECOFF, and not found in the original</span></div>
<div style="position:absolute;left:216.00px;top:257.67px" class="cls_006"><span class="cls_006">COFF definition.</span></div>
<div style="position:absolute;left:228.02px;top:268.67px" class="cls_006"><span class="cls_006">The magic number in this structure does not specify the type of CPU,</span></div>
<div style="position:absolute;left:216.00px;top:279.67px" class="cls_006"><span class="cls_006">but describes the layout of the object file, as follows: The following macro</span></div>
<div style="position:absolute;left:260.68px;top:300.01px" class="cls_020"><span class="cls_020">Name</span></div>
<div style="position:absolute;left:325.30px;top:300.01px" class="cls_020"><span class="cls_020">Value</span></div>
<div style="position:absolute;left:382.64px;top:300.01px" class="cls_020"><span class="cls_020">Meaning</span></div>
<div style="position:absolute;left:260.68px;top:317.01px" class="cls_020"><span class="cls_020">OMAGIC</span></div>
<div style="position:absolute;left:325.35px;top:317.01px" class="cls_020"><span class="cls_020">0x0107</span></div>
<div style="position:absolute;left:382.73px;top:317.01px" class="cls_020"><span class="cls_020">Text segment is writable</span></div>
<div style="position:absolute;left:260.68px;top:334.01px" class="cls_020"><span class="cls_020">NMAGIC</span></div>
<div style="position:absolute;left:325.35px;top:334.01px" class="cls_020"><span class="cls_020">0x0108</span></div>
<div style="position:absolute;left:382.73px;top:334.01px" class="cls_020"><span class="cls_020">Text segment is read-only</span></div>
<div style="position:absolute;left:260.68px;top:351.01px" class="cls_020"><span class="cls_020">ZMAGIC</span></div>
<div style="position:absolute;left:325.35px;top:351.01px" class="cls_020"><span class="cls_020">0x010b</span></div>
<div style="position:absolute;left:382.73px;top:351.01px" class="cls_020"><span class="cls_020">File is demand-pageable (not for</span></div>
<div style="position:absolute;left:382.41px;top:361.01px" class="cls_020"><span class="cls_020">embedded use)</span></div>
<div style="position:absolute;left:216.00px;top:380.67px" class="cls_006"><span class="cls_006">shows how to calculate the file offset of the text segment. In words, and</span></div>
<div style="position:absolute;left:216.00px;top:391.67px" class="cls_006"><span class="cls_006">ignoring ZMAGIC files, it is found after the COFF file header, </span><span class="cls_008">a.out</span><span class="cls_006"> header</span></div>
<div style="position:absolute;left:216.00px;top:402.67px" class="cls_006"><span class="cls_006">and COFF section headers, rounded up to the next 8 or 16 byte boundary</span></div>
<div style="position:absolute;left:216.00px;top:413.67px" class="cls_006"><span class="cls_006">(depending on the compiler version).</span></div>
<div style="position:absolute;left:252.00px;top:436.00px" class="cls_028"><span class="cls_028">#define FILHSZ sizeof(struct filehdr)</span></div>
<div style="position:absolute;left:252.00px;top:446.00px" class="cls_028"><span class="cls_028">#define SCNHSZ /*sizeof(struct scnhdr)*/ 40</span></div>
<div style="position:absolute;left:252.00px;top:466.00px" class="cls_028"><span class="cls_028">#define N_TXTOFF(f, o) \</span></div>
<div style="position:absolute;left:257.40px;top:476.00px" class="cls_028"><span class="cls_028">((a).magic == ZMAGIC ? 0 : ((a).vstamp &lt;23 ? \</span></div>
<div style="position:absolute;left:257.13px;top:486.00px" class="cls_028"><span class="cls_028">((FILHSZ + (f).opthdr + (f).f_nscns * SCNHSZ + 7) & ~7) : \</span></div>
<div style="position:absolute;left:256.36px;top:496.00px" class="cls_028"><span class="cls_028">((FILHSZ + (f).opthdr + (f).f_nscns * SCNHSZ + 15) & ~15) ) )</span></div>
<div style="position:absolute;left:216.00px;top:527.00px" class="cls_015"><span class="cls_015">Example loader</span></div>
<div style="position:absolute;left:228.02px;top:540.67px" class="cls_006"><span class="cls_006">The following code fragment draws together the above information to</span></div>
<div style="position:absolute;left:216.00px;top:551.67px" class="cls_006"><span class="cls_006">implement a very simple-minded ECOFF file loader, as might be found in</span></div>
<div style="position:absolute;left:216.00px;top:562.67px" class="cls_006"><span class="cls_006">a bootstrap PROM which can read files from disk or network. It returns the</span></div>
<div style="position:absolute;left:216.00px;top:573.67px" class="cls_006"><span class="cls_006">entry-point address of the program, or zero on failure.</span></div>
<div style="position:absolute;left:252.00px;top:595.00px" class="cls_028"><span class="cls_028">unsigned long load_ecoff (int fd)</span></div>
<div style="position:absolute;left:252.00px;top:605.00px" class="cls_028"><span class="cls_028">{</span></div>
<div style="position:absolute;left:257.40px;top:615.00px" class="cls_028"><span class="cls_028">struct filhdr fh;</span></div>
<div style="position:absolute;left:257.40px;top:624.99px" class="cls_028"><span class="cls_028">struct aouthdr ah;</span></div>
<div style="position:absolute;left:257.40px;top:644.99px" class="cls_028"><span class="cls_028">/* read file header and check */</span></div>
<div style="position:absolute;left:257.40px;top:654.99px" class="cls_028"><span class="cls_028">read (fd, &fh, sizeof (fh));</span></div>
<div style="position:absolute;left:252.00px;top:664.99px" class="cls_028"><span class="cls_028">#ifdef MIPSEB</span></div>
<div style="position:absolute;left:257.40px;top:674.99px" class="cls_028"><span class="cls_028">if (fh.f_magic != MIPSEBMAGIC)</span></div>
<div style="position:absolute;left:252.00px;top:684.99px" class="cls_028"><span class="cls_028">#else</span></div>
<div style="position:absolute;left:257.40px;top:694.99px" class="cls_028"><span class="cls_028">if (fh.f_magic != MIPSELMAGIC)</span></div>
<div style="position:absolute;left:252.00px;top:704.99px" class="cls_028"><span class="cls_028">#endif</span></div>
<div style="position:absolute;left:257.40px;top:714.99px" class="cls_028"><span class="cls_028">return 0;</span></div>
<div style="position:absolute;left:305.03px;top:755.33px" class="cls_002"><span class="cls_002">E-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:269472px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX E</span></div>
<div style="position:absolute;left:450.16px;top:28.00px" class="cls_002"><span class="cls_002">OBJECT CODE FORMATS</span></div>
<div style="position:absolute;left:77.40px;top:51.00px" class="cls_028"><span class="cls_028">/* read a.out header and check */</span></div>
<div style="position:absolute;left:77.40px;top:61.00px" class="cls_028"><span class="cls_028">read (fd, &ah, sizeof (ah));</span></div>
<div style="position:absolute;left:77.40px;top:71.00px" class="cls_028"><span class="cls_028">if (ah.magic != OMAGIC && ah.magic != NMAGIC)</span></div>
<div style="position:absolute;left:77.40px;top:81.00px" class="cls_028"><span class="cls_028">return 0;</span></div>
<div style="position:absolute;left:77.40px;top:101.00px" class="cls_028"><span class="cls_028">/* read text and data segments, and clear bss */</span></div>
<div style="position:absolute;left:77.40px;top:111.00px" class="cls_028"><span class="cls_028">lseek (fd, N_TXTOFF (fh, ah), SEEK_SET);</span></div>
<div style="position:absolute;left:77.40px;top:120.99px" class="cls_028"><span class="cls_028">read (fd, ah.text_start, ah.tsize);</span></div>
<div style="position:absolute;left:77.40px;top:130.99px" class="cls_028"><span class="cls_028">read (fd, ah.data_start, ah.dsize);</span></div>
<div style="position:absolute;left:77.40px;top:140.99px" class="cls_028"><span class="cls_028">memset (ah.bss_start, 0, ah.bsize);</span></div>
<div style="position:absolute;left:77.40px;top:160.99px" class="cls_028"><span class="cls_028">return ah.entry;</span></div>
<div style="position:absolute;left:72.00px;top:170.99px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:36.00px;top:202.00px" class="cls_015"><span class="cls_015">Further reading</span></div>
<div style="position:absolute;left:48.02px;top:215.67px" class="cls_006"><span class="cls_006">For more detailed information on the original COFF format, consult a</span></div>
<div style="position:absolute;left:36.00px;top:226.67px" class="cls_008"><span class="cls_008">Unix System V.3 Programmer’s Guide</span><span class="cls_006">. The ECOFF symbol table extensions</span></div>
<div style="position:absolute;left:36.00px;top:237.67px" class="cls_006"><span class="cls_006">are not documented, but the header files which define it (which are</span></div>
<div style="position:absolute;left:36.00px;top:248.67px" class="cls_006"><span class="cls_006">copyright of MIPS Corporation, now MTI) have now been made available for</span></div>
<div style="position:absolute;left:36.00px;top:259.67px" class="cls_006"><span class="cls_006">re-use and redistribution. You’ll find copies with the rights documented in</span></div>
<div style="position:absolute;left:36.00px;top:270.67px" class="cls_006"><span class="cls_006">recent versions of GNU binary utilities.</span></div>
<div style="position:absolute;left:36.00px;top:293.00px" class="cls_015"><span class="cls_015">ELF (MIPS ABI)</span></div>
<div style="position:absolute;left:48.02px;top:306.67px" class="cls_006"><span class="cls_006">ELF, which stands for </span><span class="cls_008">Executable and Linking Format</span><span class="cls_006">, is an attempt to</span></div>
<div style="position:absolute;left:36.00px;top:317.67px" class="cls_006"><span class="cls_006">improve on COFF and define an object file format which supports a range</span></div>
<div style="position:absolute;left:36.00px;top:328.67px" class="cls_006"><span class="cls_006">of different processors, while allowing vendor-specific extensions that do</span></div>
<div style="position:absolute;left:36.00px;top:339.67px" class="cls_006"><span class="cls_006">not break compatibility with other tools. It first appeared in Unix System</span></div>
<div style="position:absolute;left:36.00px;top:350.67px" class="cls_006"><span class="cls_006">V Release 4, and is used by recent versions of MIPS Corp compilers, and</span></div>
<div style="position:absolute;left:36.00px;top:361.67px" class="cls_006"><span class="cls_006">some other development systems.</span></div>
<div style="position:absolute;left:48.02px;top:372.67px" class="cls_006"><span class="cls_006">As in the examination of COFF, this manual will look only at the</span></div>
<div style="position:absolute;left:36.00px;top:383.67px" class="cls_006"><span class="cls_006">minimum  amount  of  the  structure  which  is  necessary  to  load  an</span></div>
<div style="position:absolute;left:36.00px;top:394.67px" class="cls_006"><span class="cls_006">executable file into memory.</span></div>
<div style="position:absolute;left:36.00px;top:417.00px" class="cls_015"><span class="cls_015">File header</span></div>
<div style="position:absolute;left:48.02px;top:430.67px" class="cls_006"><span class="cls_006">The ELF file header consists of 52 bytes at the start of the file, and</span></div>
<div style="position:absolute;left:36.00px;top:441.67px" class="cls_006"><span class="cls_006">provides the means to determine the location of all the other parts of the</span></div>
<div style="position:absolute;left:36.00px;top:452.67px" class="cls_006"><span class="cls_006">file. The following fields are relevant when loading an ELF file:</span></div>
<div style="position:absolute;left:66.85px;top:473.00px" class="cls_020"><span class="cls_020">Offset</span></div>
<div style="position:absolute;left:108.67px;top:473.00px" class="cls_020"><span class="cls_020">Type</span></div>
<div style="position:absolute;left:190.71px;top:473.00px" class="cls_020"><span class="cls_020">Name</span></div>
<div style="position:absolute;left:255.97px;top:473.00px" class="cls_020"><span class="cls_020">Purpose</span></div>
<div style="position:absolute;left:66.85px;top:490.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:108.58px;top:490.00px" class="cls_020"><span class="cls_020">unsigned char</span></div>
<div style="position:absolute;left:190.79px;top:490.00px" class="cls_020"><span class="cls_020">e_ident[16]</span></div>
<div style="position:absolute;left:256.16px;top:490.00px" class="cls_020"><span class="cls_020">File format identification</span></div>
<div style="position:absolute;left:66.85px;top:507.00px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:108.60px;top:507.00px" class="cls_020"><span class="cls_020">unsigned short</span></div>
<div style="position:absolute;left:190.82px;top:507.00px" class="cls_020"><span class="cls_020">e_type</span></div>
<div style="position:absolute;left:256.10px;top:507.00px" class="cls_020"><span class="cls_020">Type of object file</span></div>
<div style="position:absolute;left:66.85px;top:524.00px" class="cls_020"><span class="cls_020">18</span></div>
<div style="position:absolute;left:108.60px;top:524.00px" class="cls_020"><span class="cls_020">unsigned short</span></div>
<div style="position:absolute;left:190.82px;top:524.00px" class="cls_020"><span class="cls_020">e_machine</span></div>
<div style="position:absolute;left:256.18px;top:524.00px" class="cls_020"><span class="cls_020">CPU type</span></div>
<div style="position:absolute;left:66.85px;top:541.00px" class="cls_020"><span class="cls_020">20</span></div>
<div style="position:absolute;left:108.60px;top:541.00px" class="cls_020"><span class="cls_020">unsigned long</span></div>
<div style="position:absolute;left:190.80px;top:541.00px" class="cls_020"><span class="cls_020">e_version</span></div>
<div style="position:absolute;left:256.14px;top:541.00px" class="cls_020"><span class="cls_020">File format</span></div>
<div style="position:absolute;left:66.85px;top:558.01px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:108.60px;top:558.01px" class="cls_020"><span class="cls_020">unsigned long</span></div>
<div style="position:absolute;left:190.80px;top:558.01px" class="cls_020"><span class="cls_020">e_entry</span></div>
<div style="position:absolute;left:256.10px;top:558.01px" class="cls_020"><span class="cls_020">Entry point address</span></div>
<div style="position:absolute;left:66.85px;top:575.01px" class="cls_020"><span class="cls_020">28</span></div>
<div style="position:absolute;left:108.60px;top:575.01px" class="cls_020"><span class="cls_020">unsigned long</span></div>
<div style="position:absolute;left:190.80px;top:575.01px" class="cls_020"><span class="cls_020">e_phoff</span></div>
<div style="position:absolute;left:256.10px;top:575.01px" class="cls_020"><span class="cls_020">Program header file</span></div>
<div style="position:absolute;left:255.63px;top:585.01px" class="cls_020"><span class="cls_020">offset</span></div>
<div style="position:absolute;left:66.85px;top:602.01px" class="cls_020"><span class="cls_020">32</span></div>
<div style="position:absolute;left:108.60px;top:602.01px" class="cls_020"><span class="cls_020">unsigned long</span></div>
<div style="position:absolute;left:190.80px;top:602.01px" class="cls_020"><span class="cls_020">e_shoff</span></div>
<div style="position:absolute;left:256.10px;top:602.01px" class="cls_020"><span class="cls_020">Section header file offset</span></div>
<div style="position:absolute;left:66.85px;top:619.01px" class="cls_020"><span class="cls_020">36</span></div>
<div style="position:absolute;left:108.60px;top:619.01px" class="cls_020"><span class="cls_020">unsigned long</span></div>
<div style="position:absolute;left:190.80px;top:619.01px" class="cls_020"><span class="cls_020">e_flags</span></div>
<div style="position:absolute;left:256.09px;top:619.01px" class="cls_020"><span class="cls_020">CPU-specific flags</span></div>
<div style="position:absolute;left:66.85px;top:636.01px" class="cls_020"><span class="cls_020">40</span></div>
<div style="position:absolute;left:108.60px;top:636.01px" class="cls_020"><span class="cls_020">unsigned short</span></div>
<div style="position:absolute;left:190.82px;top:636.01px" class="cls_020"><span class="cls_020">e_ehsize</span></div>
<div style="position:absolute;left:256.14px;top:636.01px" class="cls_020"><span class="cls_020">File header size</span></div>
<div style="position:absolute;left:66.85px;top:653.01px" class="cls_020"><span class="cls_020">42</span></div>
<div style="position:absolute;left:108.60px;top:653.01px" class="cls_020"><span class="cls_020">unsigned short</span></div>
<div style="position:absolute;left:190.82px;top:653.01px" class="cls_020"><span class="cls_020">e_phentsize</span></div>
<div style="position:absolute;left:256.20px;top:653.01px" class="cls_020"><span class="cls_020">Program header entry</span></div>
<div style="position:absolute;left:255.63px;top:663.01px" class="cls_020"><span class="cls_020">size</span></div>
<div style="position:absolute;left:66.85px;top:680.01px" class="cls_020"><span class="cls_020">44</span></div>
<div style="position:absolute;left:108.60px;top:680.01px" class="cls_020"><span class="cls_020">unsigned short</span></div>
<div style="position:absolute;left:190.82px;top:680.01px" class="cls_020"><span class="cls_020">e_phnum</span></div>
<div style="position:absolute;left:256.15px;top:680.01px" class="cls_020"><span class="cls_020">Number of program</span></div>
<div style="position:absolute;left:255.63px;top:690.01px" class="cls_020"><span class="cls_020">header entries</span></div>
<div style="position:absolute;left:66.85px;top:707.01px" class="cls_020"><span class="cls_020">46</span></div>
<div style="position:absolute;left:108.60px;top:707.01px" class="cls_020"><span class="cls_020">unsigned short</span></div>
<div style="position:absolute;left:190.82px;top:707.01px" class="cls_020"><span class="cls_020">e_shentsize</span></div>
<div style="position:absolute;left:256.20px;top:707.01px" class="cls_020"><span class="cls_020">Section header entry size</span></div>
<div style="position:absolute;left:291.28px;top:755.33px" class="cls_002"><span class="cls_002">E-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:270274px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">OBJECT CODE FORMATS</span></div>
<div style="position:absolute;left:520.93px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX E</span></div>
<div style="position:absolute;left:246.85px;top:55.00px" class="cls_020"><span class="cls_020">48</span></div>
<div style="position:absolute;left:288.60px;top:55.00px" class="cls_020"><span class="cls_020">unsigned short</span></div>
<div style="position:absolute;left:370.82px;top:55.00px" class="cls_020"><span class="cls_020">e_shnum</span></div>
<div style="position:absolute;left:436.14px;top:55.00px" class="cls_020"><span class="cls_020">Number of section</span></div>
<div style="position:absolute;left:435.63px;top:65.00px" class="cls_020"><span class="cls_020">header entries</span></div>
<div style="position:absolute;left:246.85px;top:82.00px" class="cls_020"><span class="cls_020">50</span></div>
<div style="position:absolute;left:288.60px;top:82.00px" class="cls_020"><span class="cls_020">unsigned short</span></div>
<div style="position:absolute;left:370.82px;top:82.00px" class="cls_020"><span class="cls_020">e_shstrndx</span></div>
<div style="position:absolute;left:436.19px;top:82.00px" class="cls_020"><span class="cls_020">Section header string</span></div>
<div style="position:absolute;left:435.63px;top:92.00px" class="cls_020"><span class="cls_020">table index</span></div>
<div style="position:absolute;left:228.02px;top:110.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> e_ident</span><span class="cls_006">: contains machine-independent data to identify this as an</span></div>
<div style="position:absolute;left:239.98px;top:121.67px" class="cls_006"><span class="cls_006">ELF file, and describe its layout. The individual bytes within it are as</span></div>
<div style="position:absolute;left:239.98px;top:132.67px" class="cls_006"><span class="cls_006">follows:</span></div>
<div style="position:absolute;left:246.51px;top:153.00px" class="cls_020"><span class="cls_020">Offset</span></div>
<div style="position:absolute;left:285.92px;top:153.00px" class="cls_020"><span class="cls_020">Name</span></div>
<div style="position:absolute;left:353.00px;top:153.00px" class="cls_020"><span class="cls_020">Expected Value</span></div>
<div style="position:absolute;left:443.31px;top:153.00px" class="cls_020"><span class="cls_020">Purpose</span></div>
<div style="position:absolute;left:246.51px;top:170.00px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:285.83px;top:170.00px" class="cls_020"><span class="cls_020">EI_MAG0</span></div>
<div style="position:absolute;left:352.98px;top:170.00px" class="cls_020"><span class="cls_020">ELFMAG0=0x7f</span></div>
<div style="position:absolute;left:443.27px;top:170.00px" class="cls_020"><span class="cls_020">Magic number</span></div>
<div style="position:absolute;left:442.76px;top:180.00px" class="cls_020"><span class="cls_020">identifying an ELF file</span></div>
<div style="position:absolute;left:246.51px;top:187.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:285.83px;top:187.00px" class="cls_020"><span class="cls_020">EI_MAG1</span></div>
<div style="position:absolute;left:352.98px;top:187.00px" class="cls_020"><span class="cls_020">ELFMAG1=’E’</span></div>
<div style="position:absolute;left:246.51px;top:204.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:285.83px;top:204.00px" class="cls_020"><span class="cls_020">EI_MAG1</span></div>
<div style="position:absolute;left:352.98px;top:204.00px" class="cls_020"><span class="cls_020">ELFMAG2=’L’</span></div>
<div style="position:absolute;left:246.51px;top:221.01px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:285.83px;top:221.01px" class="cls_020"><span class="cls_020">EI_MAG3</span></div>
<div style="position:absolute;left:352.98px;top:221.01px" class="cls_020"><span class="cls_020">ELFMAG3=’F’</span></div>
<div style="position:absolute;left:246.51px;top:238.01px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:285.83px;top:238.01px" class="cls_020"><span class="cls_020">EI_CLASS</span></div>
<div style="position:absolute;left:352.98px;top:238.01px" class="cls_020"><span class="cls_020">ELFCLASS32=1</span></div>
<div style="position:absolute;left:443.28px;top:238.01px" class="cls_020"><span class="cls_020">Identifies file’s word</span></div>
<div style="position:absolute;left:442.76px;top:248.01px" class="cls_020"><span class="cls_020">size.</span></div>
<div style="position:absolute;left:246.51px;top:265.01px" class="cls_020"><span class="cls_020">5</span></div>
<div style="position:absolute;left:285.83px;top:265.01px" class="cls_020"><span class="cls_020">EI_DATA</span></div>
<div style="position:absolute;left:352.95px;top:265.01px" class="cls_020"><span class="cls_020">ELFDATA2LSB=1</span></div>
<div style="position:absolute;left:443.25px;top:265.01px" class="cls_020"><span class="cls_020">Indicates little-endian</span></div>
<div style="position:absolute;left:442.76px;top:275.01px" class="cls_020"><span class="cls_020">headers and program</span></div>
<div style="position:absolute;left:352.76px;top:312.00px" class="cls_020"><span class="cls_020">ELFDATA2MSB=2</span></div>
<div style="position:absolute;left:443.08px;top:312.00px" class="cls_020"><span class="cls_020">Indicates big-endian</span></div>
<div style="position:absolute;left:442.76px;top:322.00px" class="cls_020"><span class="cls_020">headers and program</span></div>
<div style="position:absolute;left:246.51px;top:339.00px" class="cls_020"><span class="cls_020">6</span></div>
<div style="position:absolute;left:285.83px;top:339.00px" class="cls_020"><span class="cls_020">EI_VERSION</span></div>
<div style="position:absolute;left:353.03px;top:339.00px" class="cls_020"><span class="cls_020">EV_CURRENT=1</span></div>
<div style="position:absolute;left:443.33px;top:339.00px" class="cls_020"><span class="cls_020">Gives file format</span></div>
<div style="position:absolute;left:442.76px;top:349.00px" class="cls_020"><span class="cls_020">version number</span></div>
<div style="position:absolute;left:228.03px;top:368.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:368.67px" class="cls_008"><span class="cls_008">e_machine</span><span class="cls_006">: Specifies the CPU type for which this file is intended,</span></div>
<div style="position:absolute;left:239.98px;top:379.67px" class="cls_006"><span class="cls_006">selected from the values in the table below.</span></div>
<div style="position:absolute;left:239.98px;top:393.67px" class="cls_006"><span class="cls_006">Obviously for this discussion the value should be EM_MIPS.</span></div>
<div style="position:absolute;left:248.19px;top:414.00px" class="cls_020"><span class="cls_020">Name</span></div>
<div style="position:absolute;left:351.85px;top:414.00px" class="cls_020"><span class="cls_020">Value</span></div>
<div style="position:absolute;left:413.78px;top:414.00px" class="cls_020"><span class="cls_020">Meaning</span></div>
<div style="position:absolute;left:248.19px;top:431.00px" class="cls_020"><span class="cls_020">EM_M32</span></div>
<div style="position:absolute;left:351.90px;top:431.00px" class="cls_020"><span class="cls_020">1</span></div>
<div style="position:absolute;left:413.74px;top:431.00px" class="cls_020"><span class="cls_020">AT&T WE32100</span></div>
<div style="position:absolute;left:248.19px;top:448.00px" class="cls_020"><span class="cls_020">EM_SPARC</span></div>
<div style="position:absolute;left:351.95px;top:448.00px" class="cls_020"><span class="cls_020">2</span></div>
<div style="position:absolute;left:413.79px;top:448.00px" class="cls_020"><span class="cls_020">SPARC</span></div>
<div style="position:absolute;left:248.19px;top:465.00px" class="cls_020"><span class="cls_020">EM_386</span></div>
<div style="position:absolute;left:351.89px;top:465.00px" class="cls_020"><span class="cls_020">3</span></div>
<div style="position:absolute;left:413.73px;top:465.00px" class="cls_020"><span class="cls_020">Intel 80386</span></div>
<div style="position:absolute;left:248.19px;top:482.01px" class="cls_020"><span class="cls_020">EM_68K</span></div>
<div style="position:absolute;left:351.89px;top:482.01px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:413.73px;top:482.01px" class="cls_020"><span class="cls_020">Motorola 68000</span></div>
<div style="position:absolute;left:248.19px;top:499.01px" class="cls_020"><span class="cls_020">EM_88K</span></div>
<div style="position:absolute;left:351.89px;top:499.01px" class="cls_020"><span class="cls_020">5</span></div>
<div style="position:absolute;left:413.73px;top:499.01px" class="cls_020"><span class="cls_020">Motorola 88000</span></div>
<div style="position:absolute;left:248.19px;top:516.01px" class="cls_020"><span class="cls_020">EM_860</span></div>
<div style="position:absolute;left:351.89px;top:516.01px" class="cls_020"><span class="cls_020">7</span></div>
<div style="position:absolute;left:413.73px;top:516.01px" class="cls_020"><span class="cls_020">Intel 80860</span></div>
<div style="position:absolute;left:248.19px;top:533.01px" class="cls_020"><span class="cls_020">EM_MIPS</span></div>
<div style="position:absolute;left:351.91px;top:533.01px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:413.75px;top:533.01px" class="cls_020"><span class="cls_020">MIPS R3000</span></div>
<div style="position:absolute;left:228.03px;top:552.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:552.67px" class="cls_008"><span class="cls_008">e_entry</span><span class="cls_006">: The entry point address of the program.</span></div>
<div style="position:absolute;left:228.02px;top:566.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:566.67px" class="cls_008"><span class="cls_008">e_phoff</span><span class="cls_006">: The file offset of the program header, which will be required</span></div>
<div style="position:absolute;left:239.98px;top:577.67px" class="cls_006"><span class="cls_006">to load the program.</span></div>
<div style="position:absolute;left:228.03px;top:591.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:591.67px" class="cls_008"><span class="cls_008">e_phentsize</span><span class="cls_006">: The size (in bytes) of each program header entry.</span></div>
<div style="position:absolute;left:228.02px;top:605.67px" class="cls_006"><span class="cls_006">•</span></div>
<div style="position:absolute;left:239.98px;top:605.67px" class="cls_008"><span class="cls_008">e_phnum</span><span class="cls_006">: The number of entries in the program header.</span></div>
<div style="position:absolute;left:216.00px;top:628.00px" class="cls_015"><span class="cls_015">Program Header</span></div>
<div style="position:absolute;left:228.02px;top:641.67px" class="cls_006"><span class="cls_006">Having verified the ELF file header, software will require the program</span></div>
<div style="position:absolute;left:216.00px;top:652.67px" class="cls_006"><span class="cls_006">header. This part of the file contains a variable number of entries, each of</span></div>
<div style="position:absolute;left:216.00px;top:663.67px" class="cls_006"><span class="cls_006">which specify a </span><span class="cls_008">segment</span><span class="cls_006"> to be loaded into memory. Each entry is at least</span></div>
<div style="position:absolute;left:216.00px;top:674.67px" class="cls_006"><span class="cls_006">32 bytes long and has the following layout:</span></div>
<div style="position:absolute;left:246.13px;top:695.01px" class="cls_020"><span class="cls_020">Offset</span></div>
<div style="position:absolute;left:290.45px;top:695.01px" class="cls_020"><span class="cls_020">Type</span></div>
<div style="position:absolute;left:372.36px;top:695.01px" class="cls_020"><span class="cls_020">Name</span></div>
<div style="position:absolute;left:429.61px;top:695.01px" class="cls_020"><span class="cls_020">Purpose</span></div>
<div style="position:absolute;left:246.13px;top:712.01px" class="cls_020"><span class="cls_020">0</span></div>
<div style="position:absolute;left:290.36px;top:712.01px" class="cls_020"><span class="cls_020">unsigned long</span></div>
<div style="position:absolute;left:372.45px;top:712.01px" class="cls_020"><span class="cls_020">p_type</span></div>
<div style="position:absolute;left:429.72px;top:712.01px" class="cls_020"><span class="cls_020">Type of entry</span></div>
<div style="position:absolute;left:305.04px;top:755.33px" class="cls_002"><span class="cls_002">E-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:271076px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX E</span></div>
<div style="position:absolute;left:450.17px;top:28.00px" class="cls_002"><span class="cls_002">OBJECT CODE FORMATS</span></div>
<div style="position:absolute;left:66.12px;top:55.00px" class="cls_020"><span class="cls_020">4</span></div>
<div style="position:absolute;left:110.36px;top:55.00px" class="cls_020"><span class="cls_020">unsigned long</span></div>
<div style="position:absolute;left:192.45px;top:55.00px" class="cls_020"><span class="cls_020">p_offset</span></div>
<div style="position:absolute;left:249.74px;top:55.00px" class="cls_020"><span class="cls_020">File offset of segment</span></div>
<div style="position:absolute;left:66.12px;top:72.00px" class="cls_020"><span class="cls_020">8</span></div>
<div style="position:absolute;left:110.36px;top:72.00px" class="cls_020"><span class="cls_020">unsigned long</span></div>
<div style="position:absolute;left:192.45px;top:72.00px" class="cls_020"><span class="cls_020">p_vaddr</span></div>
<div style="position:absolute;left:249.74px;top:72.00px" class="cls_020"><span class="cls_020">Virtual address of</span></div>
<div style="position:absolute;left:249.27px;top:82.00px" class="cls_020"><span class="cls_020">segment</span></div>
<div style="position:absolute;left:66.12px;top:99.00px" class="cls_020"><span class="cls_020">12</span></div>
<div style="position:absolute;left:110.39px;top:99.00px" class="cls_020"><span class="cls_020">unsigned long</span></div>
<div style="position:absolute;left:192.47px;top:99.00px" class="cls_020"><span class="cls_020">p_paddr</span></div>
<div style="position:absolute;left:249.77px;top:99.00px" class="cls_020"><span class="cls_020">Physical address of</span></div>
<div style="position:absolute;left:249.27px;top:109.00px" class="cls_020"><span class="cls_020">segment (unused)</span></div>
<div style="position:absolute;left:66.12px;top:126.00px" class="cls_020"><span class="cls_020">16</span></div>
<div style="position:absolute;left:110.39px;top:126.00px" class="cls_020"><span class="cls_020">unsigned long</span></div>
<div style="position:absolute;left:192.47px;top:126.00px" class="cls_020"><span class="cls_020">p_filesz</span></div>
<div style="position:absolute;left:249.76px;top:126.00px" class="cls_020"><span class="cls_020">Size of segment in file</span></div>
<div style="position:absolute;left:66.12px;top:143.00px" class="cls_020"><span class="cls_020">20</span></div>
<div style="position:absolute;left:110.39px;top:143.00px" class="cls_020"><span class="cls_020">unsigned long</span></div>
<div style="position:absolute;left:192.47px;top:143.00px" class="cls_020"><span class="cls_020">p_memsz</span></div>
<div style="position:absolute;left:249.79px;top:143.00px" class="cls_020"><span class="cls_020">Size of segment in memory</span></div>
<div style="position:absolute;left:66.12px;top:160.00px" class="cls_020"><span class="cls_020">24</span></div>
<div style="position:absolute;left:110.39px;top:160.00px" class="cls_020"><span class="cls_020">unsigned long</span></div>
<div style="position:absolute;left:192.47px;top:160.00px" class="cls_020"><span class="cls_020">p_flags</span></div>
<div style="position:absolute;left:249.75px;top:160.00px" class="cls_020"><span class="cls_020">Segment attribute flags</span></div>
<div style="position:absolute;left:66.12px;top:177.00px" class="cls_020"><span class="cls_020">28</span></div>
<div style="position:absolute;left:110.39px;top:177.00px" class="cls_020"><span class="cls_020">unsigned long</span></div>
<div style="position:absolute;left:192.47px;top:177.00px" class="cls_020"><span class="cls_020">p_align</span></div>
<div style="position:absolute;left:249.76px;top:177.00px" class="cls_020"><span class="cls_020">Segment alignment (power</span></div>
<div style="position:absolute;left:249.27px;top:187.00px" class="cls_020"><span class="cls_020">of 2)</span></div>
<div style="position:absolute;left:48.02px;top:205.67px" class="cls_006"><span class="cls_006">The relevant fields are as follows:</span></div>
<div style="position:absolute;left:48.02px;top:219.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> p_type</span><span class="cls_006">: Only entries marked with a type of PT_LOAD (1) should be</span></div>
<div style="position:absolute;left:59.98px;top:230.67px" class="cls_006"><span class="cls_006">loaded; others can be safely ignored.</span></div>
<div style="position:absolute;left:48.03px;top:244.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> p_offset</span><span class="cls_006">: The absolute offset in the file of the start of this segment.</span></div>
<div style="position:absolute;left:48.03px;top:258.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> p_vaddr</span><span class="cls_006">: The virtual address in memory at which the segment should</span></div>
<div style="position:absolute;left:59.98px;top:269.67px" class="cls_006"><span class="cls_006">be loaded.</span></div>
<div style="position:absolute;left:48.03px;top:283.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> p_filesz</span><span class="cls_006">: The size of the segment in the file; this may be zero.</span></div>
<div style="position:absolute;left:48.03px;top:297.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> p_memsz</span><span class="cls_006">: The size of the segment in memory. If this is greater than</span></div>
<div style="position:absolute;left:59.98px;top:308.67px" class="cls_008"><span class="cls_008">p_filesz</span><span class="cls_006">, then the extra bytes should be cleared to zero.</span></div>
<div style="position:absolute;left:48.02px;top:322.67px" class="cls_006"><span class="cls_006">•</span><span class="cls_008"> p_flags</span><span class="cls_006">: A bitmap giving read, write and execute permissions for the</span></div>
<div style="position:absolute;left:59.98px;top:333.67px" class="cls_006"><span class="cls_006">segment. This is largely irrelevant for embedded systems, but does</span></div>
<div style="position:absolute;left:59.98px;top:344.67px" class="cls_006"><span class="cls_006">allow the code segment to be identified.</span></div>
<div style="position:absolute;left:157.99px;top:365.01px" class="cls_020"><span class="cls_020">Name</span></div>
<div style="position:absolute;left:195.23px;top:365.01px" class="cls_020"><span class="cls_020">Value</span></div>
<div style="position:absolute;left:231.62px;top:365.01px" class="cls_020"><span class="cls_020">Meaning</span></div>
<div style="position:absolute;left:157.99px;top:382.01px" class="cls_020"><span class="cls_020">PF_X</span></div>
<div style="position:absolute;left:195.22px;top:382.01px" class="cls_020"><span class="cls_020">0x1</span></div>
<div style="position:absolute;left:231.57px;top:382.01px" class="cls_020"><span class="cls_020">Execute</span></div>
<div style="position:absolute;left:157.99px;top:399.01px" class="cls_020"><span class="cls_020">PF_W</span></div>
<div style="position:absolute;left:195.23px;top:399.01px" class="cls_020"><span class="cls_020">0x2</span></div>
<div style="position:absolute;left:231.58px;top:399.01px" class="cls_020"><span class="cls_020">Write</span></div>
<div style="position:absolute;left:157.99px;top:416.01px" class="cls_020"><span class="cls_020">PF_R</span></div>
<div style="position:absolute;left:195.22px;top:416.01px" class="cls_020"><span class="cls_020">0x4</span></div>
<div style="position:absolute;left:231.57px;top:416.01px" class="cls_020"><span class="cls_020">Read</span></div>
<div style="position:absolute;left:36.00px;top:441.00px" class="cls_015"><span class="cls_015">Example loader</span></div>
<div style="position:absolute;left:48.02px;top:454.67px" class="cls_006"><span class="cls_006">The following code fragment draws together the above information to</span></div>
<div style="position:absolute;left:36.00px;top:465.67px" class="cls_006"><span class="cls_006">implement a very simple-minded ELF file loader, as might be found in a</span></div>
<div style="position:absolute;left:36.00px;top:476.67px" class="cls_006"><span class="cls_006">bootstrap PROM which can read files from disk or network. It returns the</span></div>
<div style="position:absolute;left:36.00px;top:487.67px" class="cls_006"><span class="cls_006">entry-point address of the program, or zero on failure.</span></div>
<div style="position:absolute;left:72.00px;top:499.00px" class="cls_028"><span class="cls_028">unsigned long load_elf (int fd)</span></div>
<div style="position:absolute;left:72.00px;top:509.00px" class="cls_028"><span class="cls_028">{</span></div>
<div style="position:absolute;left:77.40px;top:519.00px" class="cls_028"><span class="cls_028">Elf32_Ehdr eh;</span></div>
<div style="position:absolute;left:77.40px;top:529.00px" class="cls_028"><span class="cls_028">Elf32_Phdr ph[16];</span></div>
<div style="position:absolute;left:77.40px;top:539.00px" class="cls_028"><span class="cls_028">int i;</span></div>
<div style="position:absolute;left:77.40px;top:559.00px" class="cls_028"><span class="cls_028">/* read file header and check */</span></div>
<div style="position:absolute;left:77.40px;top:569.00px" class="cls_028"><span class="cls_028">read (fd, &eh, sizeof (eh));</span></div>
<div style="position:absolute;left:77.40px;top:588.99px" class="cls_028"><span class="cls_028">/* check header validity */</span></div>
<div style="position:absolute;left:77.40px;top:598.99px" class="cls_028"><span class="cls_028">if (eh.e_ident[EI_MAG0] != ELFMAG0 ||</span></div>
<div style="position:absolute;left:77.40px;top:608.99px" class="cls_028"><span class="cls_028">eh.e_ident[EI_MAG1] != ELFMAG1 ||</span></div>
<div style="position:absolute;left:77.40px;top:618.99px" class="cls_028"><span class="cls_028">eh.e_ident[EI_MAG2] != ELFMAG2 ||</span></div>
<div style="position:absolute;left:77.40px;top:628.99px" class="cls_028"><span class="cls_028">eh.e_ident[EI_MAG3] != ELFMAG3 ||</span></div>
<div style="position:absolute;left:77.40px;top:638.99px" class="cls_028"><span class="cls_028">eh.e_ident[EI_CLASS] != ELFCLASS32 ||</span></div>
<div style="position:absolute;left:72.00px;top:648.99px" class="cls_028"><span class="cls_028">#ifdef MIPSEB</span></div>
<div style="position:absolute;left:77.40px;top:658.99px" class="cls_028"><span class="cls_028">eh.e_ident[EI_DATA] != ELFDATA2MSB ||</span></div>
<div style="position:absolute;left:72.00px;top:668.99px" class="cls_028"><span class="cls_028">#else</span></div>
<div style="position:absolute;left:77.40px;top:678.99px" class="cls_028"><span class="cls_028">eh.e_ident[EI_DATA] != ELFDATA2LSB ||</span></div>
<div style="position:absolute;left:72.00px;top:688.98px" class="cls_028"><span class="cls_028">#endif</span></div>
<div style="position:absolute;left:77.40px;top:698.98px" class="cls_028"><span class="cls_028">eh.e_ident[EI_VERSION] != EV_CURRENT ||</span></div>
<div style="position:absolute;left:77.40px;top:708.98px" class="cls_028"><span class="cls_028">eh.e_machine != EM_MIPS)</span></div>
<div style="position:absolute;left:77.40px;top:718.98px" class="cls_028"><span class="cls_028">return 0;</span></div>
<div style="position:absolute;left:291.29px;top:755.33px" class="cls_002"><span class="cls_002">E-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:271878px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">OBJECT CODE FORMATS</span></div>
<div style="position:absolute;left:520.92px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX E</span></div>
<div style="position:absolute;left:257.40px;top:61.00px" class="cls_028"><span class="cls_028">/* is there a program header of the right size */</span></div>
<div style="position:absolute;left:256.74px;top:71.00px" class="cls_028"><span class="cls_028">if (eh.e_phoff == 0 || eh.e_phnum == 0 || eh.e_phnum > 16 ||</span></div>
<div style="position:absolute;left:257.40px;top:81.00px" class="cls_028"><span class="cls_028">eh.e_phentsize != sizeof(Elf32_Phdr))</span></div>
<div style="position:absolute;left:257.40px;top:91.00px" class="cls_028"><span class="cls_028">return 0;</span></div>
<div style="position:absolute;left:257.40px;top:111.00px" class="cls_028"><span class="cls_028">/* read program header */</span></div>
<div style="position:absolute;left:257.40px;top:120.99px" class="cls_028"><span class="cls_028">lseek (fd, eh.e_phoff, SEEK_SET);</span></div>
<div style="position:absolute;left:257.40px;top:130.99px" class="cls_028"><span class="cls_028">read (fd, ph, eh.e_phnum * eh.e_phentsize);</span></div>
<div style="position:absolute;left:257.40px;top:150.99px" class="cls_028"><span class="cls_028">/* load each program segments */</span></div>
<div style="position:absolute;left:257.40px;top:160.99px" class="cls_028"><span class="cls_028">for (i = 0; i &lt;eh.e_phnum; i++) {</span></div>
<div style="position:absolute;left:257.40px;top:170.99px" class="cls_028"><span class="cls_028">if (ph[i].p_type == PT_LOAD) {</span></div>
<div style="position:absolute;left:257.40px;top:180.99px" class="cls_028"><span class="cls_028">if (ph->p_filesz) {</span></div>
<div style="position:absolute;left:257.40px;top:190.99px" class="cls_028"><span class="cls_028">lseek (fd, ph[i].p_offset, SEEK_SET);</span></div>
<div style="position:absolute;left:257.40px;top:200.99px" class="cls_028"><span class="cls_028">read (fd, ph[i].p_vaddr, ph[i].p_filesz);</span></div>
<div style="position:absolute;left:257.40px;top:210.99px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:257.40px;top:220.99px" class="cls_028"><span class="cls_028">if (ph[i].p_filesz &lt;ph[i].p_memsz)</span></div>
<div style="position:absolute;left:257.40px;top:230.98px" class="cls_028"><span class="cls_028">memset (ph[i].p_vaddr + ph[i].p_filesz, 0,</span></div>
<div style="position:absolute;left:257.40px;top:240.98px" class="cls_028"><span class="cls_028">ph[i].p_memsz - ph[i].p_filesz);</span></div>
<div style="position:absolute;left:257.40px;top:250.98px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:257.40px;top:260.98px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:257.40px;top:280.98px" class="cls_028"><span class="cls_028">return eh.eh_entry;</span></div>
<div style="position:absolute;left:252.00px;top:290.98px" class="cls_028"><span class="cls_028">}</span></div>
<div style="position:absolute;left:216.00px;top:322.00px" class="cls_015"><span class="cls_015">Further Reading</span></div>
<div style="position:absolute;left:228.02px;top:335.67px" class="cls_006"><span class="cls_006">The ELF format, including MIPS-specific extensions, is extensively</span></div>
<div style="position:absolute;left:216.00px;top:346.67px" class="cls_006"><span class="cls_006">documented in </span><span class="cls_008">Unix System V.4 MIPS Processor-Specific ABI</span><span class="cls_006"> book.</span></div>
<div style="position:absolute;left:216.00px;top:369.00px" class="cls_015"><span class="cls_015">OBJECT CODE TOOLS</span></div>
<div style="position:absolute;left:228.02px;top:382.67px" class="cls_006"><span class="cls_006">A particular software development system will be equipped with a</span></div>
<div style="position:absolute;left:216.00px;top:393.67px" class="cls_006"><span class="cls_006">number of tools for examining and manipulating object files. The following</span></div>
<div style="position:absolute;left:216.00px;top:404.67px" class="cls_006"><span class="cls_006">list assumes Unix-type names, but systems with a different ancestry will</span></div>
<div style="position:absolute;left:216.00px;top:415.67px" class="cls_006"><span class="cls_006">probably offer similar tools, even if the names are different:</span></div>
<div style="position:absolute;left:220.00px;top:436.00px" class="cls_020"><span class="cls_020">Program Name</span></div>
<div style="position:absolute;left:303.24px;top:436.00px" class="cls_020"><span class="cls_020">Function</span></div>
<div style="position:absolute;left:220.00px;top:453.00px" class="cls_020"><span class="cls_020">ar</span></div>
<div style="position:absolute;left:303.01px;top:453.00px" class="cls_020"><span class="cls_020">This tool allows you to list, add and remove object files from a</span></div>
<div style="position:absolute;left:302.95px;top:463.00px" class="cls_020"><span class="cls_020">library. The name comes from </span><span class="cls_027">archive</span><span class="cls_020">, the historical Unix</span></div>
<div style="position:absolute;left:302.95px;top:473.00px" class="cls_020"><span class="cls_020">name for the file type used to store libraries and later</span></div>
<div style="position:absolute;left:302.95px;top:483.00px" class="cls_020"><span class="cls_020">specialized for this purpose.</span></div>
<div style="position:absolute;left:220.00px;top:500.00px" class="cls_020"><span class="cls_020">convert</span></div>
<div style="position:absolute;left:302.95px;top:500.00px" class="cls_020"><span class="cls_020">Converts executable object file from binary to some other</span></div>
<div style="position:absolute;left:220.00px;top:510.00px" class="cls_020"><span class="cls_020">(objcopy)</span></div>
<div style="position:absolute;left:302.95px;top:510.00px" class="cls_020"><span class="cls_020">format which can be downloaded to a PROM programmer or</span></div>
<div style="position:absolute;left:302.95px;top:520.00px" class="cls_020"><span class="cls_020">evaluation board.</span></div>
<div style="position:absolute;left:220.00px;top:537.00px" class="cls_020"><span class="cls_020">ld</span></div>
<div style="position:absolute;left:303.01px;top:537.00px" class="cls_020"><span class="cls_020">The link/loader, used to glue object codes together and also</span></div>
<div style="position:absolute;left:302.95px;top:547.00px" class="cls_020"><span class="cls_020">to assign fixed target-system addresses to sections (in some</span></div>
<div style="position:absolute;left:302.95px;top:557.00px" class="cls_020"><span class="cls_020">systems this would involve two separate programs typically</span></div>
<div style="position:absolute;left:302.95px;top:566.99px" class="cls_020"><span class="cls_020">called </span><span class="cls_027">link</span><span class="cls_020"> and </span><span class="cls_027">locate</span><span class="cls_020">).</span></div>
<div style="position:absolute;left:220.00px;top:584.00px" class="cls_020"><span class="cls_020">nm</span></div>
<div style="position:absolute;left:303.02px;top:584.00px" class="cls_020"><span class="cls_020">Lists the names in an object file’s symbol table in alphabetic</span></div>
<div style="position:absolute;left:302.95px;top:594.00px" class="cls_020"><span class="cls_020">or numeric order.</span></div>
<div style="position:absolute;left:220.00px;top:611.00px" class="cls_020"><span class="cls_020">objdump/odump</span></div>
<div style="position:absolute;left:303.27px;top:611.00px" class="cls_020"><span class="cls_020">Displays the program data of the object file in various useful</span></div>
<div style="position:absolute;left:302.95px;top:621.00px" class="cls_020"><span class="cls_020">forms; in particular, can usually disassemble the code</span></div>
<div style="position:absolute;left:302.95px;top:631.00px" class="cls_020"><span class="cls_020">sections.</span></div>
<div style="position:absolute;left:220.00px;top:648.00px" class="cls_020"><span class="cls_020">ranlib</span></div>
<div style="position:absolute;left:303.08px;top:648.00px" class="cls_020"><span class="cls_020">if present, builds a global ‘‘table of contents’’ in a library</span></div>
<div style="position:absolute;left:302.95px;top:658.00px" class="cls_020"><span class="cls_020">which makes it much faster for </span><span class="cls_027">ld</span><span class="cls_020"> to read. On modern</span></div>
<div style="position:absolute;left:302.96px;top:668.00px" class="cls_020"><span class="cls_020">systems </span><span class="cls_027">ar</span><span class="cls_020"> usually has an option to do this job, and </span><span class="cls_027">ranlib</span></div>
<div style="position:absolute;left:302.95px;top:678.00px" class="cls_020"><span class="cls_020">may well just be an alias for that option.</span></div>
<div style="position:absolute;left:220.00px;top:695.00px" class="cls_020"><span class="cls_020">size</span></div>
<div style="position:absolute;left:303.04px;top:695.00px" class="cls_020"><span class="cls_020">Displays the size of each </span><span class="cls_027">section</span><span class="cls_020"> in the object file.</span></div>
<div style="position:absolute;left:305.03px;top:755.33px" class="cls_002"><span class="cls_002">E-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:272680px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX E</span></div>
<div style="position:absolute;left:450.17px;top:28.00px" class="cls_002"><span class="cls_002">OBJECT CODE FORMATS</span></div>
<div style="position:absolute;left:40.00px;top:55.00px" class="cls_020"><span class="cls_020">strip</span></div>
<div style="position:absolute;left:123.05px;top:55.00px" class="cls_020"><span class="cls_020">Removes everything from the object file which is not</span></div>
<div style="position:absolute;left:122.95px;top:65.00px" class="cls_020"><span class="cls_020">necessary to load the program, making it (much) smaller; gets</span></div>
<div style="position:absolute;left:122.95px;top:75.00px" class="cls_020"><span class="cls_020">rid of symbol tables and debug information. Some people do</span></div>
<div style="position:absolute;left:122.95px;top:85.00px" class="cls_020"><span class="cls_020">this to make it harder to disassemble the program.</span></div>
<div style="position:absolute;left:291.29px;top:755.33px" class="cls_002"><span class="cls_002">E-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:273482px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:148.00px;top:40.00px" class="cls_014"><span class="cls_014">®</span></div>
<div style="position:absolute;left:222.89px;top:41.33px" class="cls_005"><span class="cls_005">GLOSSARY OF COMMON "MIPS"</span></div>
<div style="position:absolute;left:487.25px;top:42.00px" class="cls_015"><span class="cls_015">APPENDIX F</span></div>
<div style="position:absolute;left:222.89px;top:56.33px" class="cls_005"><span class="cls_005">TERMS</span></div>
<div style="position:absolute;left:65.00px;top:87.39px" class="cls_016"><span class="cls_016">Integrated Device Technology, Inc.</span></div>
<div style="position:absolute;left:216.00px;top:113.67px" class="cls_008"><span class="cls_008">$fnn register</span><span class="cls_006">: one of the 32 general-purpose 32-bit floating point registers.</span></div>
<div style="position:absolute;left:239.97px;top:124.67px" class="cls_006"><span class="cls_006">Only even-numbered ones can be used for arithmetic (the odd-</span></div>
<div style="position:absolute;left:239.97px;top:135.67px" class="cls_006"><span class="cls_006">numbered  registers  hold  the  low-order  bits  of</span></div>
<div style="position:absolute;left:498.39px;top:135.67px" class="cls_006"><span class="cls_006">64-bit,  double-</span></div>
<div style="position:absolute;left:239.97px;top:146.67px" class="cls_006"><span class="cls_006">precision, numbers).</span></div>
<div style="position:absolute;left:216.00px;top:160.67px" class="cls_008"><span class="cls_008">$nn register</span><span class="cls_006">: one of the CPU’s 32 general-purpose registers.</span></div>
<div style="position:absolute;left:216.00px;top:174.67px" class="cls_008"><span class="cls_008">a0-a3 register</span><span class="cls_006">: aliases for CPU registers $4-$7, conventionally used for</span></div>
<div style="position:absolute;left:239.98px;top:185.67px" class="cls_006"><span class="cls_006">passing the first four words of the arguments to a function.</span></div>
<div style="position:absolute;left:216.00px;top:199.67px" class="cls_008"><span class="cls_008">address regions</span><span class="cls_006">: refers to the division of the MIPS program address space</span></div>
<div style="position:absolute;left:239.98px;top:210.67px" class="cls_006"><span class="cls_006">into regions called kuseg, kseg0, kseg1 and kseg2.</span></div>
<div style="position:absolute;left:216.00px;top:224.67px" class="cls_008"><span class="cls_008">alignment</span><span class="cls_006">: positioning of data in a memory with respect to size boundaries</span></div>
<div style="position:absolute;left:239.98px;top:235.67px" class="cls_006"><span class="cls_006">(keeping  words  aligned  on  modul0-4  addresses,  and  half-words</span></div>
<div style="position:absolute;left:239.98px;top:246.67px" class="cls_006"><span class="cls_006">aligned on modulo-2 addresses).</span></div>
<div style="position:absolute;left:216.00px;top:260.67px" class="cls_008"><span class="cls_008">alloca</span><span class="cls_006">: C library function returning a memory area which will be implicitly</span></div>
<div style="position:absolute;left:239.98px;top:271.67px" class="cls_006"><span class="cls_006">freed on return from the function where the call is made from.</span></div>
<div style="position:absolute;left:216.00px;top:285.67px" class="cls_008"><span class="cls_008">ALU</span><span class="cls_006">: arithmetic/logic unit - a term applied to the part of the CPU which</span></div>
<div style="position:absolute;left:239.98px;top:296.67px" class="cls_006"><span class="cls_006">does computational functions</span></div>
<div style="position:absolute;left:216.00px;top:310.67px" class="cls_008"><span class="cls_008">analyzer</span><span class="cls_006">: see logic analyzer.</span></div>
<div style="position:absolute;left:216.00px;top:324.67px" class="cls_008"><span class="cls_008">Apache  group</span></div>
<div style="position:absolute;left:295.38px;top:324.67px" class="cls_008"><span class="cls_008">(SVR4.2)</span><span class="cls_006">:  an  industry  group   of  suppliers   of   MIPS-</span></div>
<div style="position:absolute;left:239.97px;top:335.67px" class="cls_006"><span class="cls_006">architecture ‘‘Unix’’ systems who are co-operating on a standard</span></div>
<div style="position:absolute;left:239.97px;top:346.67px" class="cls_006"><span class="cls_006">version of Univel’s System V Release 4.2 operating system.</span></div>
<div style="position:absolute;left:216.00px;top:360.67px" class="cls_008"><span class="cls_008">architecture</span><span class="cls_006">: see ISA.</span></div>
<div style="position:absolute;left:216.00px;top:374.67px" class="cls_008"><span class="cls_008">argument</span><span class="cls_006">: a value passed to a function, in ‘‘C’’ terminology - often called a</span></div>
<div style="position:absolute;left:239.98px;top:385.67px" class="cls_006"><span class="cls_006">parameter in other languages. ‘‘C’’ arguments are ‘‘parameters passed</span></div>
<div style="position:absolute;left:239.98px;top:396.67px" class="cls_006"><span class="cls_006">by value’’ - if that helps.</span></div>
<div style="position:absolute;left:216.00px;top:410.67px" class="cls_008"><span class="cls_008">ASCII</span><span class="cls_006">: used very loosely for the character encoding used by the C language.</span></div>
<div style="position:absolute;left:216.00px;top:424.67px" class="cls_008"><span class="cls_008">ASID</span><span class="cls_006">: the address space ID maintained in the CPU register ‘‘EntryHi’’. Used</span></div>
<div style="position:absolute;left:239.98px;top:435.67px" class="cls_006"><span class="cls_006">to  select  a  particular  set  of  address  translations</span></div>
<div style="position:absolute;left:509.50px;top:435.67px" class="cls_006"><span class="cls_006">-  only  those</span></div>
<div style="position:absolute;left:239.98px;top:446.67px" class="cls_006"><span class="cls_006">translations whose own ASID field matches the current value will</span></div>
<div style="position:absolute;left:239.98px;top:457.67px" class="cls_006"><span class="cls_006">produce valid physical addresses.</span></div>
<div style="position:absolute;left:216.00px;top:471.67px" class="cls_008"><span class="cls_008">associative store</span><span class="cls_006">: a memory which can be looked up by presenting part of</span></div>
<div style="position:absolute;left:239.98px;top:482.67px" class="cls_006"><span class="cls_006">the stored data. It requires a separate comparator for each data field,</span></div>
<div style="position:absolute;left:239.98px;top:493.67px" class="cls_006"><span class="cls_006">so large associative stores use up prodigious amounts of logic. The</span></div>
<div style="position:absolute;left:239.98px;top:504.67px" class="cls_006"><span class="cls_006">R30xx family TLB (“E” versions) is a fully-associative 64-entry store.</span></div>
<div style="position:absolute;left:216.00px;top:518.67px" class="cls_008"><span class="cls_008">BadVaddr register</span><span class="cls_006">: CPU control register which holds the value of an</span></div>
<div style="position:absolute;left:239.97px;top:529.67px" class="cls_006"><span class="cls_006">address which just caused a trap for some reason (misaligned,</span></div>
<div style="position:absolute;left:239.97px;top:540.67px" class="cls_006"><span class="cls_006">inaccessible, TLB miss etc.).</span></div>
<div style="position:absolute;left:216.00px;top:554.67px" class="cls_008"><span class="cls_008">bcopy</span><span class="cls_006">: C library function to copy the contents of a chunk of memory.</span></div>
<div style="position:absolute;left:216.00px;top:568.67px" class="cls_008"><span class="cls_008">BEV</span><span class="cls_006">: ‘‘boot exception vectors’’: a bit in the CPU status register which</span></div>
<div style="position:absolute;left:239.98px;top:579.67px" class="cls_006"><span class="cls_006">causes traps to go through a pair of alternate vectors located in</span></div>
<div style="position:absolute;left:239.98px;top:590.67px" class="cls_006"><span class="cls_006">uncached (kseg1) memory. The locations are close to the reset-time</span></div>
<div style="position:absolute;left:239.98px;top:601.67px" class="cls_006"><span class="cls_006">start point, so that they can both conveniently be mapped to the same</span></div>
<div style="position:absolute;left:239.98px;top:612.67px" class="cls_006"><span class="cls_006">read-only memory.</span></div>
<div style="position:absolute;left:216.00px;top:626.67px" class="cls_008"><span class="cls_008">big-endian</span><span class="cls_006">: describes an architecture where the most-significant part of a</span></div>
<div style="position:absolute;left:239.97px;top:637.67px" class="cls_006"><span class="cls_006">multi-byte integer is stored at the lowest byte address.</span></div>
<div style="position:absolute;left:216.00px;top:651.67px" class="cls_008"><span class="cls_008">bitfield</span><span class="cls_006">: a part of a word which is interpreted as a collection of individual</span></div>
<div style="position:absolute;left:239.98px;top:662.67px" class="cls_006"><span class="cls_006">bits.</span></div>
<div style="position:absolute;left:216.00px;top:676.67px" class="cls_008"><span class="cls_008">branch and link</span><span class="cls_006">: a PC-relative subroutine call.</span></div>
<div style="position:absolute;left:298.78px;top:754.68px" class="cls_002"><span class="cls_002">F-1</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:274284px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX F</span></div>
<div style="position:absolute;left:382.45px;top:28.00px" class="cls_002"><span class="cls_002">GLOSSARY OF COMMON "MIPS" TERMS</span></div>
<div style="position:absolute;left:36.00px;top:50.67px" class="cls_008"><span class="cls_008">branch delay slot</span><span class="cls_006">: the position in the instruction sequence immediately</span></div>
<div style="position:absolute;left:59.97px;top:61.67px" class="cls_006"><span class="cls_006">following a jump/branch instruction. The instruction in the branch</span></div>
<div style="position:absolute;left:59.97px;top:72.67px" class="cls_006"><span class="cls_006">delay slot is always executed, before the instruction which is the</span></div>
<div style="position:absolute;left:59.97px;top:83.67px" class="cls_006"><span class="cls_006">target of the branch. It is sometimes necessary to fill the branch delay</span></div>
<div style="position:absolute;left:59.97px;top:94.67px" class="cls_006"><span class="cls_006">slot with a ‘‘nop’’ instruction.</span></div>
<div style="position:absolute;left:36.00px;top:108.67px" class="cls_008"><span class="cls_008">branch optimization</span><span class="cls_006">: the process (carried out by the compiler, assembler or</span></div>
<div style="position:absolute;left:59.98px;top:119.67px" class="cls_006"><span class="cls_006">programmer) of adjusting the sequence of instructions so as to make</span></div>
<div style="position:absolute;left:59.98px;top:130.67px" class="cls_006"><span class="cls_006">the best use of branch delay slots.</span></div>
<div style="position:absolute;left:36.00px;top:144.67px" class="cls_008"><span class="cls_008">branch</span><span class="cls_006">: in the MIPS instruction set, a PC-relative jump.</span></div>
<div style="position:absolute;left:36.00px;top:158.67px" class="cls_008"><span class="cls_008">BrCond3-0</span><span class="cls_006">: CPU inputs which are directly tested by the ‘‘coprocessor</span></div>
<div style="position:absolute;left:59.98px;top:169.67px" class="cls_006"><span class="cls_006">conditional branch’’ instructions.</span></div>
<div style="position:absolute;left:36.00px;top:183.67px" class="cls_008"><span class="cls_008">breakpoint</span><span class="cls_006">: when debugging a program, a breakpoint is an instruction</span></div>
<div style="position:absolute;left:59.97px;top:194.67px" class="cls_006"><span class="cls_006">position where the debugger will take a trap and return control to the</span></div>
<div style="position:absolute;left:59.97px;top:205.67px" class="cls_006"><span class="cls_006">user.  Implemented  by  pasting  a</span></div>
<div style="position:absolute;left:244.97px;top:205.67px" class="cls_006"><span class="cls_006">‘‘break’’  instruction  into  the</span></div>
<div style="position:absolute;left:59.97px;top:216.67px" class="cls_006"><span class="cls_006">instruction sequence under test.</span></div>
<div style="position:absolute;left:36.00px;top:230.67px" class="cls_008"><span class="cls_008">bss</span><span class="cls_006">: in a compiled C program, that chunk of memory which holds variables</span></div>
<div style="position:absolute;left:59.97px;top:241.67px" class="cls_006"><span class="cls_006">declared but not explicitly initialized. Corresponds to a ‘‘segment’’ of</span></div>
<div style="position:absolute;left:59.97px;top:252.67px" class="cls_006"><span class="cls_006">object code.</span></div>
<div style="position:absolute;left:36.00px;top:266.67px" class="cls_008"><span class="cls_008">burst read cycles</span><span class="cls_006">: R30xx family CPUs often refill their caches by fetching 4</span></div>
<div style="position:absolute;left:59.97px;top:277.67px" class="cls_006"><span class="cls_006">words at a time from memory in a burst read cycle.</span></div>
<div style="position:absolute;left:36.00px;top:291.67px" class="cls_008"><span class="cls_008">busctrl register</span><span class="cls_006">: CPU register, implemented on the R3041 CPU only, which</span></div>
<div style="position:absolute;left:59.98px;top:302.67px" class="cls_006"><span class="cls_006">allows the programmer to set up some options for how bus accesses</span></div>
<div style="position:absolute;left:59.98px;top:313.67px" class="cls_006"><span class="cls_006">are carried out.</span></div>
<div style="position:absolute;left:36.00px;top:327.67px" class="cls_008"><span class="cls_008">byte gathering, write merging</span><span class="cls_006">: when writes are stored in a </span><span class="cls_008">write buffer</span><span class="cls_006"> it</span></div>
<div style="position:absolute;left:59.97px;top:338.67px" class="cls_006"><span class="cls_006">may happen that two writes to the same word (often to different bytes</span></div>
<div style="position:absolute;left:59.97px;top:349.67px" class="cls_006"><span class="cls_006">in the same word) may happen before the address and data are sent</span></div>
<div style="position:absolute;left:59.97px;top:360.67px" class="cls_006"><span class="cls_006">to memory. R30xx family CPUs don’t do this, to avoid problems when</span></div>
<div style="position:absolute;left:59.97px;top:371.67px" class="cls_006"><span class="cls_006">writing to IO subsystems.</span></div>
<div style="position:absolute;left:36.00px;top:385.67px" class="cls_008"><span class="cls_008">byte order</span><span class="cls_006">: used to emphasize the ordering of items in memory by byte</span></div>
<div style="position:absolute;left:59.97px;top:396.67px" class="cls_006"><span class="cls_006">address.</span></div>
<div style="position:absolute;left:36.00px;top:410.67px" class="cls_008"><span class="cls_008">byteswap</span><span class="cls_006">: the action of reversing the order of the constituent bytes within</span></div>
<div style="position:absolute;left:59.98px;top:421.67px" class="cls_006"><span class="cls_006">a word. This may be required when adapting data acquired from a</span></div>
<div style="position:absolute;left:59.98px;top:432.67px" class="cls_006"><span class="cls_006">machine of non-matching ‘‘endianness’’.</span></div>
<div style="position:absolute;left:36.00px;top:446.67px" class="cls_008"><span class="cls_008">cache - direct mapped</span><span class="cls_006">: a direct mapped cache has, for any particular line</span></div>
<div style="position:absolute;left:59.98px;top:457.67px" class="cls_006"><span class="cls_006">in memory, only one slot where it can cache the contents of that line.</span></div>
<div style="position:absolute;left:59.98px;top:468.67px" class="cls_006"><span class="cls_006">Direct-mapped caches are simple, so they can run fast.</span></div>
<div style="position:absolute;left:59.98px;top:482.67px" class="cls_006"><span class="cls_006">R30xx family onchip caches are direct-mapped.</span></div>
<div style="position:absolute;left:36.00px;top:496.67px" class="cls_008"><span class="cls_008">cache - physical addressed</span><span class="cls_006">: a cache which is accessed entirely by using</span></div>
<div style="position:absolute;left:59.97px;top:507.67px" class="cls_006"><span class="cls_006">physical (translated) addresses. All R30xx family on-chip caches are</span></div>
<div style="position:absolute;left:59.97px;top:518.67px" class="cls_006"><span class="cls_006">physical.</span></div>
<div style="position:absolute;left:36.00px;top:532.67px" class="cls_008"><span class="cls_008">cache - snooping</span><span class="cls_006">: in a cache, snooping is the action of monitoring the bus</span></div>
<div style="position:absolute;left:59.98px;top:543.67px" class="cls_006"><span class="cls_006">activity of some other device (another CPU or DMA master) to look for</span></div>
<div style="position:absolute;left:59.98px;top:554.67px" class="cls_006"><span class="cls_006">references to data which are held in the cache. Originally, ‘‘snooping’’</span></div>
<div style="position:absolute;left:59.98px;top:565.67px" class="cls_006"><span class="cls_006">was used for caches which can </span><span class="cls_008">intervene</span><span class="cls_006">, offering their own version of</span></div>
<div style="position:absolute;left:59.97px;top:576.67px" class="cls_006"><span class="cls_006">the data where it is more up to date than the memory data which will</span></div>
<div style="position:absolute;left:59.97px;top:587.67px" class="cls_006"><span class="cls_006">otherwise be obtained by the other master; but the word has come to</span></div>
<div style="position:absolute;left:59.97px;top:598.67px" class="cls_006"><span class="cls_006">be used for any cache which monitors bus traffic.</span></div>
<div style="position:absolute;left:36.00px;top:612.67px" class="cls_008"><span class="cls_008">cache coherency</span><span class="cls_006">: the process of insuring that the CPU caches match,</span></div>
<div style="position:absolute;left:59.97px;top:623.67px" class="cls_006"><span class="cls_006">precisely, the contents of the memory which lie behind them.</span></div>
<div style="position:absolute;left:36.00px;top:637.67px" class="cls_008"><span class="cls_008">cache flush</span><span class="cls_006">: In the R30xx family, this term is used as a synonym for</span></div>
<div style="position:absolute;left:59.98px;top:648.67px" class="cls_006"><span class="cls_006">‘‘invalidate’’.</span></div>
<div style="position:absolute;left:36.00px;top:662.67px" class="cls_008"><span class="cls_008">cache invalidation</span><span class="cls_006">: marks a line of cache data as no longer to be used.</span></div>
<div style="position:absolute;left:59.98px;top:673.67px" class="cls_006"><span class="cls_006">There’s always some kind of ‘‘valid’’ bit in the control bits of the cache</span></div>
<div style="position:absolute;left:59.98px;top:684.67px" class="cls_006"><span class="cls_006">line for this purpose.</span></div>
<div style="position:absolute;left:291.53px;top:755.33px" class="cls_002"><span class="cls_002">F-2</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:275086px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:49.99px;top:28.00px" class="cls_002"><span class="cls_002">GLOSSARY OF COMMON "MIPS" TERMS</span></div>
<div style="position:absolute;left:521.70px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX F</span></div>
<div style="position:absolute;left:216.00px;top:50.67px" class="cls_008"><span class="cls_008">cache lines</span><span class="cls_006">: A cache line refers to the number of datum elements which</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">share a single tag field. In the R30xx family, the instruction-cache</span></div>
<div style="position:absolute;left:239.97px;top:72.67px" class="cls_006"><span class="cls_006">uses a 4-word (16-byte) line size, and the data cache uses a 1 word (4</span></div>
<div style="position:absolute;left:239.97px;top:83.67px" class="cls_006"><span class="cls_006">byte) line size.</span></div>
<div style="position:absolute;left:216.00px;top:97.67px" class="cls_008"><span class="cls_008">cache miss</span><span class="cls_006">: A reference into the cache for memory not currently contained</span></div>
<div style="position:absolute;left:239.97px;top:108.67px" class="cls_006"><span class="cls_006">in the cache.</span></div>
<div style="position:absolute;left:216.00px;top:122.67px" class="cls_008"><span class="cls_008">cache profiling</span><span class="cls_006">: measuring the cache traffic generated when a particular</span></div>
<div style="position:absolute;left:239.98px;top:133.67px" class="cls_006"><span class="cls_006">program runs, with a view to re-arranging the program in memory to</span></div>
<div style="position:absolute;left:239.98px;top:144.67px" class="cls_006"><span class="cls_006">minimize the number of cache misses, or to selecting the appropriate</span></div>
<div style="position:absolute;left:239.98px;top:155.67px" class="cls_006"><span class="cls_006">R30xx family member (or configuration of the R3071 or R3081) for a</span></div>
<div style="position:absolute;left:239.98px;top:166.67px" class="cls_006"><span class="cls_006">particular system.</span></div>
<div style="position:absolute;left:216.00px;top:180.67px" class="cls_008"><span class="cls_008">cache refill</span><span class="cls_006">: the memory read which is used to obtain a cache line of data</span></div>
<div style="position:absolute;left:239.98px;top:191.67px" class="cls_006"><span class="cls_006">after a cache miss. This is first read into the cache, and the CPU then</span></div>
<div style="position:absolute;left:239.98px;top:202.67px" class="cls_006"><span class="cls_006">restarts execution - this time ‘‘hitting’’ in the cache.</span></div>
<div style="position:absolute;left:216.00px;top:216.67px" class="cls_008"><span class="cls_008">cache simulator</span><span class="cls_006">: a software tool used for cache profiling.</span></div>
<div style="position:absolute;left:216.00px;top:230.67px" class="cls_008"><span class="cls_008">cache tag</span><span class="cls_006">: the information held with the cache line which identifies the</span></div>
<div style="position:absolute;left:239.97px;top:241.67px" class="cls_006"><span class="cls_006">main memory location of the data.</span></div>
<div style="position:absolute;left:216.00px;top:255.67px" class="cls_008"><span class="cls_008">cacheable</span><span class="cls_006">: applied to an address region or a page defined by the memory</span></div>
<div style="position:absolute;left:239.98px;top:266.67px" class="cls_006"><span class="cls_006">translation system, this means that the contents of the memory</span></div>
<div style="position:absolute;left:239.98px;top:277.67px" class="cls_006"><span class="cls_006">region may be resident in the on-chip caches.</span></div>
<div style="position:absolute;left:216.00px;top:291.67px" class="cls_008"><span class="cls_008">callee</span><span class="cls_006">: in a function call, the ‘‘callee’’ is the function which is called.</span></div>
<div style="position:absolute;left:216.00px;top:305.67px" class="cls_008"><span class="cls_008">Cause register</span><span class="cls_006">: CPU control register which, following a trap, indicates the</span></div>
<div style="position:absolute;left:239.98px;top:316.67px" class="cls_006"><span class="cls_006">kind of trap. </span><span class="cls_008">Cause</span><span class="cls_006"> also shows which external interrupt signals are</span></div>
<div style="position:absolute;left:239.98px;top:327.67px" class="cls_006"><span class="cls_006">active.</span></div>
<div style="position:absolute;left:216.00px;top:341.67px" class="cls_008"><span class="cls_008">CohReq* (R3081 only)</span><span class="cls_006">: an external signal fed into an R3081 CPU which will</span></div>
<div style="position:absolute;left:239.98px;top:352.67px" class="cls_006"><span class="cls_006">cause a D-cache entry to be automatically invalidated by a write to the</span></div>
<div style="position:absolute;left:239.98px;top:363.67px" class="cls_006"><span class="cls_006">appropriate memory location performed by an external bus master.</span></div>
<div style="position:absolute;left:239.98px;top:377.67px" class="cls_006"><span class="cls_006">Note that even where the addressed location is not present in the</span></div>
<div style="position:absolute;left:239.98px;top:388.67px" class="cls_006"><span class="cls_006">R3081 D-cache, this still causes the CPU to be stopped for a few</span></div>
<div style="position:absolute;left:239.98px;top:399.67px" class="cls_006"><span class="cls_006">cycles while the D-cache tags are invalidated.</span></div>
<div style="position:absolute;left:216.00px;top:413.67px" class="cls_008"><span class="cls_008">Compare register</span><span class="cls_006">: CPU control register provided on CPUs implementing a</span></div>
<div style="position:absolute;left:239.97px;top:424.67px" class="cls_006"><span class="cls_006">timer (just the R3041 at the time of writing).</span></div>
<div style="position:absolute;left:216.00px;top:438.67px" class="cls_008"><span class="cls_008">Config register</span><span class="cls_006">: CPU control register for configuring basic CPU behavior,</span></div>
<div style="position:absolute;left:239.97px;top:449.67px" class="cls_006"><span class="cls_006">provided only on R3041, R3071, and R3081.</span></div>
<div style="position:absolute;left:216.00px;top:463.67px" class="cls_008"><span class="cls_008">const</span><span class="cls_006">: ‘‘C’’ data declaration attribute, implying that the data is read-only.</span></div>
<div style="position:absolute;left:239.97px;top:474.67px" class="cls_006"><span class="cls_006">It will often then be packed together with the instructions.</span></div>
<div style="position:absolute;left:216.00px;top:488.67px" class="cls_008"><span class="cls_008">Context register</span><span class="cls_006">: CPU control register only seen on CPU types with a TLB</span></div>
<div style="position:absolute;left:239.98px;top:499.67px" class="cls_006"><span class="cls_006">(‘‘-E’’ variants). Provides a fast way to process page faults on systems</span></div>
<div style="position:absolute;left:239.98px;top:510.67px" class="cls_006"><span class="cls_006">using a certain arrangement of page tables.</span></div>
<div style="position:absolute;left:216.00px;top:524.67px" class="cls_008"><span class="cls_008">context switch</span><span class="cls_006">: the job of changing the software environment from one</span></div>
<div style="position:absolute;left:239.98px;top:535.67px" class="cls_006"><span class="cls_006">‘‘task’’ to another in a multitasking OS.</span></div>
<div style="position:absolute;left:216.00px;top:549.67px" class="cls_008"><span class="cls_008">coprocessor conditional branches</span><span class="cls_006">: the instructions bc0t label etc. branch</span></div>
<div style="position:absolute;left:239.97px;top:560.67px" class="cls_006"><span class="cls_006">according to the sense of ‘‘coprocessor conditions’’ which are usually</span></div>
<div style="position:absolute;left:239.97px;top:571.67px" class="cls_006"><span class="cls_006">CPU input signals; can be useful for input pin polling, fast exception</span></div>
<div style="position:absolute;left:239.97px;top:582.67px" class="cls_006"><span class="cls_006">decode, etc. If there is a floating point unit onchip, ‘‘coprocessor</span></div>
<div style="position:absolute;left:239.97px;top:593.67px" class="cls_006"><span class="cls_006">condition bit 1’’ is hard-wired to the FP condition code.</span></div>
<div style="position:absolute;left:216.00px;top:607.67px" class="cls_008"><span class="cls_008">coprocessor zero</span><span class="cls_006">: the bits of CPU function which are connected with the</span></div>
<div style="position:absolute;left:239.97px;top:618.67px" class="cls_006"><span class="cls_006">privileged  control  instructions  for  memory  mapping,  exception</span></div>
<div style="position:absolute;left:239.97px;top:629.67px" class="cls_006"><span class="cls_006">handling, and such like.</span></div>
<div style="position:absolute;left:216.00px;top:643.67px" class="cls_008"><span class="cls_008">coprocessor</span><span class="cls_006">: some part of the CPU, or some closely-coupled other thing,</span></div>
<div style="position:absolute;left:239.97px;top:654.67px" class="cls_006"><span class="cls_006">which executes some particular set of reserved instruction encodings.</span></div>
<div style="position:absolute;left:216.00px;top:668.67px" class="cls_008"><span class="cls_008">Count register</span><span class="cls_006">: running timer register (R3041).</span></div>
<div style="position:absolute;left:216.00px;top:682.67px" class="cls_008"><span class="cls_008">CPCOND</span><span class="cls_006">: see BrCond(3:0).</span></div>
<div style="position:absolute;left:216.00px;top:696.67px" class="cls_008"><span class="cls_008">D-cache</span><span class="cls_006">: data cache (R30xx CPUs always have separate instruction and</span></div>
<div style="position:absolute;left:239.97px;top:707.67px" class="cls_006"><span class="cls_006">data caches).</span></div>
<div style="position:absolute;left:305.28px;top:755.33px" class="cls_002"><span class="cls_002">F-3</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:275888px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX F</span></div>
<div style="position:absolute;left:382.46px;top:28.00px" class="cls_002"><span class="cls_002">GLOSSARY OF COMMON "MIPS" TERMS</span></div>
<div style="position:absolute;left:36.00px;top:50.67px" class="cls_008"><span class="cls_008">data  dependencies</span><span class="cls_006">:  the  relationship  between  an  instruction  which</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">produces a value in a register, and a subsequent instruction which</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">wants to use that value.</span></div>
<div style="position:absolute;left:36.00px;top:86.67px" class="cls_008"><span class="cls_008">data path swapper</span><span class="cls_006">: see byte swapper.</span></div>
<div style="position:absolute;left:36.00px;top:100.67px" class="cls_008"><span class="cls_008">data/instruction cache coherency</span><span class="cls_006">: the job of keeping the I-cache and D-</span></div>
<div style="position:absolute;left:59.97px;top:111.67px" class="cls_006"><span class="cls_006">cache  coherent.  This  can  become  an  issue  in  a  number  of</span></div>
<div style="position:absolute;left:59.97px;top:122.67px" class="cls_006"><span class="cls_006">circumstances: it is vital to invalidate I-cache locations whenever</span></div>
<div style="position:absolute;left:59.97px;top:133.67px" class="cls_006"><span class="cls_006">writing or modifying an instruction stream; D-Cache coherency may</span></div>
<div style="position:absolute;left:59.97px;top:144.67px" class="cls_006"><span class="cls_006">be an issue in systems where an external DMA master updates some</span></div>
<div style="position:absolute;left:59.97px;top:155.67px" class="cls_006"><span class="cls_006">portion of cacheable memory. See coherency.</span></div>
<div style="position:absolute;left:36.00px;top:169.67px" class="cls_008"><span class="cls_008">DECstation</span><span class="cls_006">: Digital Equipment Corporation’s trade name for DEC’s MIPS-</span></div>
<div style="position:absolute;left:59.98px;top:180.67px" class="cls_006"><span class="cls_006">architecture workstations.</span></div>
<div style="position:absolute;left:36.00px;top:194.67px" class="cls_008"><span class="cls_008">delayed branches</span><span class="cls_006">: see branch delay slot.</span></div>
<div style="position:absolute;left:36.00px;top:208.67px" class="cls_008"><span class="cls_008">delayed loads</span><span class="cls_006">: see load delay slot.</span></div>
<div style="position:absolute;left:36.00px;top:222.67px" class="cls_008"><span class="cls_008">denormalized</span><span class="cls_006">: a floating point number is ‘‘denormalized’’ when it is holding</span></div>
<div style="position:absolute;left:59.98px;top:233.67px" class="cls_006"><span class="cls_006">a value too small to be represented with the usually precision. The</span></div>
<div style="position:absolute;left:59.98px;top:244.67px" class="cls_006"><span class="cls_006">way  the  IEEE765  standard  is  defined  makes  it  quite  hard  for</span></div>
<div style="position:absolute;left:59.98px;top:255.67px" class="cls_006"><span class="cls_006">hardware to cope directly with denormalized representations, so The</span></div>
<div style="position:absolute;left:59.98px;top:266.67px" class="cls_006"><span class="cls_006">R3081 FPA always traps when presented with them or asked to</span></div>
<div style="position:absolute;left:59.98px;top:277.67px" class="cls_006"><span class="cls_006">compute them.</span></div>
<div style="position:absolute;left:36.00px;top:291.67px" class="cls_008"><span class="cls_008">direct mapped</span><span class="cls_006">: see cache (direct mapped).</span></div>
<div style="position:absolute;left:36.00px;top:305.67px" class="cls_008"><span class="cls_008">dirty</span><span class="cls_006">: in a virtual memory system, describes the state of a page of memory</span></div>
<div style="position:absolute;left:59.97px;top:316.67px" class="cls_006"><span class="cls_006">which has been written to since it was last fetched from or written</span></div>
<div style="position:absolute;left:59.97px;top:327.67px" class="cls_006"><span class="cls_006">back to secondary storage. ‘‘Dirty’’ pages must not be lost.</span></div>
<div style="position:absolute;left:36.00px;top:341.67px" class="cls_008"><span class="cls_008">dis-assembler</span><span class="cls_006">: a program which takes a binary instruction sequence in</span></div>
<div style="position:absolute;left:59.98px;top:352.67px" class="cls_006"><span class="cls_006">memory and produces a listing in assembler mnemonics.</span></div>
<div style="position:absolute;left:36.00px;top:366.67px" class="cls_008"><span class="cls_008">DMA</span><span class="cls_006">: ‘‘direct memory access’’, an external device transferring data to or</span></div>
<div style="position:absolute;left:59.98px;top:377.67px" class="cls_006"><span class="cls_006">from memory without CPU intervention.</span></div>
<div style="position:absolute;left:36.00px;top:391.67px" class="cls_008"><span class="cls_008">double</span><span class="cls_006">: ‘‘C’’ and assembler-language name for a double-precision (64-bit)</span></div>
<div style="position:absolute;left:59.98px;top:402.67px" class="cls_006"><span class="cls_006">format floating point number.</span></div>
<div style="position:absolute;left:36.00px;top:416.67px" class="cls_008"><span class="cls_008">download</span><span class="cls_006">: the act of transferring data from ‘‘host’’ to “target” (typically, the</span></div>
<div style="position:absolute;left:59.98px;top:427.67px" class="cls_006"><span class="cls_006">host is the computer which runs the compiler and/or debugger, and</span></div>
<div style="position:absolute;left:59.98px;top:438.67px" class="cls_006"><span class="cls_006">the target is the system with the R30xx CPU).</span></div>
<div style="position:absolute;left:36.00px;top:452.67px" class="cls_008"><span class="cls_008">DRAM</span><span class="cls_006">: used to refer to large memory systems (which are usually built from</span></div>
<div style="position:absolute;left:59.98px;top:463.67px" class="cls_006"><span class="cls_006">DRAM components). Sometimes used to discuss the typical attributes</span></div>
<div style="position:absolute;left:59.98px;top:474.67px" class="cls_006"><span class="cls_006">of memories built from DRAMs.</span></div>
<div style="position:absolute;left:36.00px;top:488.67px" class="cls_008"><span class="cls_008">ECOFF</span><span class="cls_006">: an object code format, particularly used by MIPS Corporation and</span></div>
<div style="position:absolute;left:59.97px;top:499.67px" class="cls_006"><span class="cls_006">Silicon Graphics, extensively evolved from Unix Systems Laboratories’</span></div>
<div style="position:absolute;left:59.97px;top:510.67px" class="cls_006"><span class="cls_006">‘‘COFF’’ format.</span></div>
<div style="position:absolute;left:36.00px;top:524.67px" class="cls_008"><span class="cls_008">ELF</span><span class="cls_006">: an object code format defined by Univel for Unix SVR4.2, and which</span></div>
<div style="position:absolute;left:59.98px;top:535.67px" class="cls_006"><span class="cls_006">is mandated by the MIPS/ABI standard.</span></div>
<div style="position:absolute;left:36.00px;top:549.67px" class="cls_008"><span class="cls_008">embedded</span><span class="cls_006">: describes a processing system, which may be part of a larger</span></div>
<div style="position:absolute;left:59.98px;top:560.67px" class="cls_006"><span class="cls_006">object, which is not (primarily) seen as a computer. Specifically,</span></div>
<div style="position:absolute;left:59.98px;top:571.67px" class="cls_006"><span class="cls_006">embedded systems usually have their “programs” determined when</span></div>
<div style="position:absolute;left:59.98px;top:582.67px" class="cls_006"><span class="cls_006">the machine is built.</span></div>
<div style="position:absolute;left:36.00px;top:596.67px" class="cls_008"><span class="cls_008">emulator</span><span class="cls_006">: see in-circuit emulator, software instruction emulator.</span></div>
<div style="position:absolute;left:36.00px;top:610.67px" class="cls_008"><span class="cls_008">endianness</span><span class="cls_006">: whether a machine is big-endian or little-endian. See the</span></div>
<div style="position:absolute;left:59.97px;top:621.67px" class="cls_006"><span class="cls_006">chapter on ‘‘Portability’’ for details.</span></div>
<div style="position:absolute;left:36.00px;top:635.67px" class="cls_008"><span class="cls_008">endif</span><span class="cls_006">: see ifdef.</span></div>
<div style="position:absolute;left:36.00px;top:649.67px" class="cls_008"><span class="cls_008">EntryHi/EntryLo register</span><span class="cls_006">: CPU control registers implemented only in CPUs</span></div>
<div style="position:absolute;left:59.98px;top:660.67px" class="cls_006"><span class="cls_006">with a TLB. Used to stage data to and from TLB entries.</span></div>
<div style="position:absolute;left:36.00px;top:674.67px" class="cls_008"><span class="cls_008">epc register</span><span class="cls_006">: ‘‘exception program counter’’: CPU control register telling</span></div>
<div style="position:absolute;left:59.97px;top:685.67px" class="cls_006"><span class="cls_006">where to restart the CPU after an exception.</span></div>
<div style="position:absolute;left:36.00px;top:699.67px" class="cls_008"><span class="cls_008">EPROM</span><span class="cls_006">: ‘‘erasable programmable read-only memory’’: the device most</span></div>
<div style="position:absolute;left:59.97px;top:710.67px" class="cls_006"><span class="cls_006">commonly used to provide read-only code for system bootstrap, and</span></div>
<div style="position:absolute;left:59.97px;top:721.67px" class="cls_006"><span class="cls_006">used in this manual to mean the location of that read-only code.</span></div>
<div style="position:absolute;left:291.54px;top:755.33px" class="cls_002"><span class="cls_002">F-4</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:276690px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">GLOSSARY OF COMMON "MIPS" TERMS</span></div>
<div style="position:absolute;left:521.71px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX F</span></div>
<div style="position:absolute;left:216.00px;top:50.67px" class="cls_008"><span class="cls_008">ExcCode</span><span class="cls_006">: the bitfield in the </span><span class="cls_008">Cause</span><span class="cls_006"> register which contains a code showing</span></div>
<div style="position:absolute;left:239.98px;top:61.67px" class="cls_006"><span class="cls_006">what type of exception just occurred.</span></div>
<div style="position:absolute;left:216.00px;top:75.67px" class="cls_008"><span class="cls_008">exception</span><span class="cls_006">: in the MIPS architecture, an exception is any interrupt or trap</span></div>
<div style="position:absolute;left:239.98px;top:86.67px" class="cls_006"><span class="cls_006">which causes control to be diverted to one of the trap entry points.</span></div>
<div style="position:absolute;left:216.00px;top:100.67px" class="cls_008"><span class="cls_008">Executable</span><span class="cls_006">: describes a file of object code which is ready to run.</span></div>
<div style="position:absolute;left:216.00px;top:114.67px" class="cls_008"><span class="cls_008">exponent</span><span class="cls_006">: part of a floating point number, described in the chapter on</span></div>
<div style="position:absolute;left:239.98px;top:125.67px" class="cls_006"><span class="cls_006">floating point.</span></div>
<div style="position:absolute;left:216.00px;top:139.67px" class="cls_008"><span class="cls_008">Extended floating point</span><span class="cls_006">: not provided by the MIPS hardware, this usually</span></div>
<div style="position:absolute;left:239.98px;top:150.67px" class="cls_006"><span class="cls_006">refers to a floating point format using 80 bits of storage.</span></div>
<div style="position:absolute;left:216.00px;top:164.67px" class="cls_008"><span class="cls_008">extern</span><span class="cls_006">: ‘‘C’’ data attribute for a variable which is defined in another module,</span></div>
<div style="position:absolute;left:216.00px;top:178.67px" class="cls_008"><span class="cls_008">FCR31 register</span><span class="cls_006">: this is the floating point control/status register, described</span></div>
<div style="position:absolute;left:239.97px;top:189.67px" class="cls_006"><span class="cls_006">in the floating point chapter.</span></div>
<div style="position:absolute;left:215.99px;top:203.67px" class="cls_008"><span class="cls_008">fixup</span><span class="cls_006">: in object code, this is the action of a linker/locator program when it</span></div>
<div style="position:absolute;left:239.96px;top:214.67px" class="cls_006"><span class="cls_006">adjusts addresses in the instruction or data segments to match the</span></div>
<div style="position:absolute;left:239.96px;top:225.67px" class="cls_006"><span class="cls_006">location at which the program will eventually execute. This term is</span></div>
<div style="position:absolute;left:239.96px;top:236.67px" class="cls_006"><span class="cls_006">also used to describe a particular CPU clock cycle in which the</span></div>
<div style="position:absolute;left:239.96px;top:247.67px" class="cls_006"><span class="cls_006">conditions which caused the processor to stall are “fixed-up” to allow</span></div>
<div style="position:absolute;left:239.96px;top:258.67px" class="cls_006"><span class="cls_006">the CPU to resume execution.</span></div>
<div style="position:absolute;left:215.98px;top:272.67px" class="cls_008"><span class="cls_008">float: </span><span class="cls_006">A name for a single precision floating point number.</span></div>
<div style="position:absolute;left:215.98px;top:286.67px" class="cls_008"><span class="cls_008">Floating point accelerator (FPA)</span><span class="cls_006">: the name for the part of the MIPS CPU</span></div>
<div style="position:absolute;left:239.96px;top:297.67px" class="cls_006"><span class="cls_006">which does floating point math. Historically, it was a separate chip.</span></div>
<div style="position:absolute;left:215.98px;top:311.67px" class="cls_008"><span class="cls_008">floating point bias</span><span class="cls_006">: an offset added to the exponent of a floating point</span></div>
<div style="position:absolute;left:239.96px;top:322.67px" class="cls_006"><span class="cls_006">number held in IEEE format, to make sure that the exponent is</span></div>
<div style="position:absolute;left:239.96px;top:333.67px" class="cls_006"><span class="cls_006">positive for all legitimate values.</span></div>
<div style="position:absolute;left:215.98px;top:347.67px" class="cls_008"><span class="cls_008">floating  point  condition  code/flag</span><span class="cls_006">:  a  single  bit  set  by  FP  compare</span></div>
<div style="position:absolute;left:239.96px;top:358.67px" class="cls_006"><span class="cls_006">instructions, which is communicated back to the main part of the</span></div>
<div style="position:absolute;left:239.96px;top:369.67px" class="cls_006"><span class="cls_006">CPU and tested by bc1t and bc1f instructions.</span></div>
<div style="position:absolute;left:215.99px;top:383.67px" class="cls_008"><span class="cls_008">floating point emulation trap</span><span class="cls_006">: a trap taken by the CPU when it cannot</span></div>
<div style="position:absolute;left:239.96px;top:394.67px" class="cls_006"><span class="cls_006">implement a floating point (coprocessor 1) operation. A software trap</span></div>
<div style="position:absolute;left:239.96px;top:405.67px" class="cls_006"><span class="cls_006">handler can be built which mimics the action of the FPU and returns</span></div>
<div style="position:absolute;left:239.96px;top:416.67px" class="cls_006"><span class="cls_006">control, so that application software need not know whether FPA</span></div>
<div style="position:absolute;left:239.96px;top:427.67px" class="cls_006"><span class="cls_006">hardware is installed or not. The software routine is likely to be 50-</span></div>
<div style="position:absolute;left:239.96px;top:438.67px" class="cls_006"><span class="cls_006">300 times slower than hardware, and 10 or more times slower than a</span></div>
<div style="position:absolute;left:239.96px;top:449.67px" class="cls_006"><span class="cls_006">“soft-float” approach.</span></div>
<div style="position:absolute;left:215.98px;top:463.67px" class="cls_008"><span class="cls_008">fp register (frame pointer)</span><span class="cls_006">: a CPU general purpose register ($30) sometimes</span></div>
<div style="position:absolute;left:239.96px;top:474.67px" class="cls_006"><span class="cls_006">used conventionally to mark the base address of a stack frame.</span></div>
<div style="position:absolute;left:215.98px;top:488.67px" class="cls_008"><span class="cls_008">fpcond</span><span class="cls_006">: another name for the FP condition bit (also known as coprocessor</span></div>
<div style="position:absolute;left:239.95px;top:499.67px" class="cls_006"><span class="cls_006">1 condition bit etc.).</span></div>
<div style="position:absolute;left:215.97px;top:513.67px" class="cls_008"><span class="cls_008">fraction</span><span class="cls_006">: part of a floating point value, described in the FPA chapter.</span></div>
<div style="position:absolute;left:215.97px;top:527.67px" class="cls_008"><span class="cls_008">Free Software Foundation</span><span class="cls_006">: the (loose) organization behind GNU software.</span></div>
<div style="position:absolute;left:215.97px;top:541.67px" class="cls_008"><span class="cls_008">fully-associative</span><span class="cls_006">: see associative store.</span></div>
<div style="position:absolute;left:215.97px;top:555.67px" class="cls_008"><span class="cls_008">function  epilogue</span><span class="cls_006">:  in  assembler  code,  the  stereotyped  sequence  of</span></div>
<div style="position:absolute;left:239.94px;top:566.67px" class="cls_006"><span class="cls_006">instructions and directives found at the end of a function, and</span></div>
<div style="position:absolute;left:239.94px;top:577.67px" class="cls_006"><span class="cls_006">concerned with returning to the caller.</span></div>
<div style="position:absolute;left:215.96px;top:591.67px" class="cls_008"><span class="cls_008">function inlining</span><span class="cls_006">: an optimization offered by advanced compilers, where a</span></div>
<div style="position:absolute;left:239.94px;top:602.67px" class="cls_006"><span class="cls_006">function call is replaced by an interpolated copy of the complete</span></div>
<div style="position:absolute;left:239.94px;top:613.67px" class="cls_006"><span class="cls_006">instruction sequence of the called function. In many architectures</span></div>
<div style="position:absolute;left:239.94px;top:624.67px" class="cls_006"><span class="cls_006">this is a big win (for very small functions) because it eliminates the</span></div>
<div style="position:absolute;left:239.94px;top:635.67px" class="cls_006"><span class="cls_006">function-call overhead. In the MIPS architecture the function-call</span></div>
<div style="position:absolute;left:239.94px;top:646.67px" class="cls_006"><span class="cls_006">overhead is negligible, but inlining is still sometimes valuable because</span></div>
<div style="position:absolute;left:239.94px;top:657.67px" class="cls_006"><span class="cls_006">it allows the optimizer to work on the function in context.</span></div>
<div style="position:absolute;left:215.96px;top:671.67px" class="cls_008"><span class="cls_008">function prologue</span><span class="cls_006">: in assembler language, a stereotyped set of instructions</span></div>
<div style="position:absolute;left:239.94px;top:682.67px" class="cls_006"><span class="cls_006">and directives which start a function, saving registers and setting up</span></div>
<div style="position:absolute;left:239.94px;top:693.67px" class="cls_006"><span class="cls_006">the stack frame.</span></div>
<div style="position:absolute;left:215.96px;top:707.67px" class="cls_008"><span class="cls_008">global pointer</span><span class="cls_006">: see gp register.</span></div>
<div style="position:absolute;left:305.28px;top:755.33px" class="cls_002"><span class="cls_002">F-5</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:277492px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX F</span></div>
<div style="position:absolute;left:382.45px;top:28.00px" class="cls_002"><span class="cls_002">GLOSSARY OF COMMON "MIPS" TERMS</span></div>
<div style="position:absolute;left:36.00px;top:50.67px" class="cls_008"><span class="cls_008">globl</span><span class="cls_006">: assembler declaration attribute, for data items or code entry points</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">which are to be visible from outside the module.</span></div>
<div style="position:absolute;left:36.00px;top:75.67px" class="cls_008"><span class="cls_008">GNU C compiler</span><span class="cls_006">: the freely-redistributable compiler developed by the Free</span></div>
<div style="position:absolute;left:59.97px;top:86.67px" class="cls_006"><span class="cls_006">Software Foundation. An excellent MIPS code generator is available.</span></div>
<div style="position:absolute;left:35.99px;top:100.67px" class="cls_008"><span class="cls_008">GOT</span><span class="cls_006">: the ‘‘global offset table’’, an essential part of the dynamic linking</span></div>
<div style="position:absolute;left:59.96px;top:111.67px" class="cls_006"><span class="cls_006">mechanism underlying MIPS/ABI applications.</span></div>
<div style="position:absolute;left:35.98px;top:125.67px" class="cls_008"><span class="cls_008">gp register</span><span class="cls_006">: CPU register $28, often used as a pointer to program data.</span></div>
<div style="position:absolute;left:59.96px;top:136.67px" class="cls_006"><span class="cls_006">Program data which can be linked within +-32K of the pointer value</span></div>
<div style="position:absolute;left:59.96px;top:147.67px" class="cls_006"><span class="cls_006">can be loaded with a single instruction. Not all toolchains, nor all</span></div>
<div style="position:absolute;left:59.96px;top:158.67px" class="cls_006"><span class="cls_006">runtime environments, support this.</span></div>
<div style="position:absolute;left:35.98px;top:172.67px" class="cls_008"><span class="cls_008">halfword</span><span class="cls_006">: a 16-bit data type.</span></div>
<div style="position:absolute;left:35.98px;top:186.67px" class="cls_008"><span class="cls_008">hazard</span><span class="cls_006">: see pipeline hazard.</span></div>
<div style="position:absolute;left:35.98px;top:200.67px" class="cls_008"><span class="cls_008">heap</span><span class="cls_006">: program data space allocated at run-time.</span></div>
<div style="position:absolute;left:35.98px;top:214.67px" class="cls_008"><span class="cls_008">I-cache</span><span class="cls_006">: the instruction cache of a MIPS CPU.</span></div>
<div style="position:absolute;left:35.98px;top:228.67px" class="cls_008"><span class="cls_008">IDT</span><span class="cls_006">: Integrated Device Technology Corporation.</span></div>
<div style="position:absolute;left:35.98px;top:242.67px" class="cls_008"><span class="cls_008">IEEE754   floating   point   standard</span><span class="cls_006">:   an   industry   standard   for   the</span></div>
<div style="position:absolute;left:59.96px;top:253.67px" class="cls_006"><span class="cls_006">representation of arithmetic values. It mandates the precise behavior</span></div>
<div style="position:absolute;left:59.96px;top:264.67px" class="cls_006"><span class="cls_006">of a group of basic functions. This provides a stable base for the</span></div>
<div style="position:absolute;left:59.96px;top:275.67px" class="cls_006"><span class="cls_006">development of portable numeric algorithms.</span></div>
<div style="position:absolute;left:35.98px;top:289.67px" class="cls_008"><span class="cls_008">ifdef</span><span class="cls_006"> : ‘‘</span><span class="cls_029">#ifdef</span><span class="cls_006">’’ and ‘‘</span><span class="cls_029"> #endif</span><span class="cls_006">’’ bracket conditionally-compiled code in the C</span></div>
<div style="position:absolute;left:59.96px;top:300.67px" class="cls_006"><span class="cls_006">language.</span></div>
<div style="position:absolute;left:35.98px;top:314.67px" class="cls_008"><span class="cls_008">immediate</span><span class="cls_006">: in the instruction set descriptions, an ‘‘immediate’’ value is a</span></div>
<div style="position:absolute;left:59.95px;top:325.67px" class="cls_006"><span class="cls_006">constant which is embedded in the code sequence. In assembler</span></div>
<div style="position:absolute;left:59.95px;top:336.67px" class="cls_006"><span class="cls_006">language, it is any constant value.</span></div>
<div style="position:absolute;left:35.97px;top:350.67px" class="cls_008"><span class="cls_008">in-circuit emulator (ICE)</span><span class="cls_006">: a device which replaces a CPU chip with a module</span></div>
<div style="position:absolute;left:59.94px;top:361.67px" class="cls_006"><span class="cls_006">which, as well as being able to exactly imitate the behavior of the CPU,</span></div>
<div style="position:absolute;left:59.94px;top:372.67px" class="cls_006"><span class="cls_006">provides  some  means  to  control  execution  and  examine  CPU</span></div>
<div style="position:absolute;left:59.94px;top:383.67px" class="cls_006"><span class="cls_006">internals. Microprocessor ICE units are inevitably based on a version</span></div>
<div style="position:absolute;left:59.94px;top:394.67px" class="cls_006"><span class="cls_006">of the microprocessor chip (often a higher speed grade).</span></div>
<div style="position:absolute;left:35.96px;top:408.67px" class="cls_008"><span class="cls_008">Index register</span><span class="cls_006">: CPU control register used to define which TLB entry’s</span></div>
<div style="position:absolute;left:59.94px;top:419.67px" class="cls_006"><span class="cls_006">contents will be read into or written from </span><span class="cls_008">EntryHi/EntryLo.</span></div>
<div style="position:absolute;left:35.96px;top:433.67px" class="cls_008"><span class="cls_008">inexact</span><span class="cls_006">: describes a floating point calculation which has lost precision.</span></div>
<div style="position:absolute;left:59.94px;top:444.67px" class="cls_006"><span class="cls_006">Note  that  this  happens  very  frequently  on  the  most  everyday</span></div>
<div style="position:absolute;left:59.94px;top:455.67px" class="cls_006"><span class="cls_006">calculations - the number 1/3 has no exact representation. IEEE754</span></div>
<div style="position:absolute;left:59.94px;top:466.67px" class="cls_006"><span class="cls_006">compliance requires that MIPS CPUs can trap on an inexact result,</span></div>
<div style="position:absolute;left:59.94px;top:477.67px" class="cls_006"><span class="cls_006">although that trap is rarely enabled.</span></div>
<div style="position:absolute;left:35.96px;top:491.67px" class="cls_008"><span class="cls_008">infinity</span><span class="cls_006">: a floating point data value standing in for any value too big (or too</span></div>
<div style="position:absolute;left:59.94px;top:502.67px" class="cls_006"><span class="cls_006">negative)  to  represent.  IEEE754  defines  how  computations  with</span></div>
<div style="position:absolute;left:59.94px;top:513.67px" class="cls_006"><span class="cls_006">positive and negative versions of ‘‘infinity’’ should behave.</span></div>
<div style="position:absolute;left:35.96px;top:527.67px" class="cls_008"><span class="cls_008">instruction scheduling</span><span class="cls_006">: the process of moving instructions around to make</span></div>
<div style="position:absolute;left:59.94px;top:538.67px" class="cls_006"><span class="cls_006">the  best  use  of</span></div>
<div style="position:absolute;left:152.38px;top:538.67px" class="cls_006"><span class="cls_006">‘‘delay  slots’’,  performed  by  the  compiler  and</span></div>
<div style="position:absolute;left:59.94px;top:549.67px" class="cls_006"><span class="cls_006">(sometimes) by the assembler.</span></div>
<div style="position:absolute;left:35.96px;top:563.67px" class="cls_008"><span class="cls_008">instruction set architecture (ISA)</span><span class="cls_006">: the functional description of the CPU,</span></div>
<div style="position:absolute;left:59.94px;top:574.67px" class="cls_006"><span class="cls_006">which defines exactly what it does with any legitimate instruction</span></div>
<div style="position:absolute;left:59.94px;top:585.67px" class="cls_006"><span class="cls_006">stream (but does not have to define how it is implemented).</span></div>
<div style="position:absolute;left:35.96px;top:599.67px" class="cls_008"><span class="cls_008">instruction synthesis by assembler</span><span class="cls_006">: the MIPS instruction set omits many</span></div>
<div style="position:absolute;left:59.93px;top:610.67px" class="cls_006"><span class="cls_006">useful and familiar operations (such as an instruction to load a</span></div>
<div style="position:absolute;left:59.93px;top:621.67px" class="cls_006"><span class="cls_006">constant outside the range +-32K). Most assemblers for the MIPS</span></div>
<div style="position:absolute;left:59.93px;top:632.67px" class="cls_006"><span class="cls_006">architecture   will   accept   instructions</span></div>
<div style="position:absolute;left:264.53px;top:632.67px" class="cls_006"><span class="cls_006">(sometimes   called </span><span class="cls_008">  macro</span></div>
<div style="position:absolute;left:59.93px;top:643.67px" class="cls_008"><span class="cls_008">instructions</span><span class="cls_006"> or </span><span class="cls_008">synthetic instructions</span><span class="cls_006">) which they implement with a</span></div>
<div style="position:absolute;left:59.93px;top:654.67px" class="cls_006"><span class="cls_006">short sequence of machine instructions.</span></div>
<div style="position:absolute;left:35.95px;top:668.67px" class="cls_008"><span class="cls_008">interlock</span><span class="cls_006">: a hardware feature where the execution of one instruction is</span></div>
<div style="position:absolute;left:59.93px;top:679.67px" class="cls_006"><span class="cls_006">delayed until something is ready.</span></div>
<div style="position:absolute;left:35.95px;top:693.67px" class="cls_008"><span class="cls_008">interrupt mask</span><span class="cls_006">: a bit-per-interrupt mask, held in the CPU </span><span class="cls_008">Status</span><span class="cls_006"> register,</span></div>
<div style="position:absolute;left:59.93px;top:704.67px" class="cls_006"><span class="cls_006">which determines which interrupt inputs are allowed to cause an</span></div>
<div style="position:absolute;left:59.93px;top:715.67px" class="cls_006"><span class="cls_006">interrupt at any given time.</span></div>
<div style="position:absolute;left:291.54px;top:755.34px" class="cls_002"><span class="cls_002">F-6</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:278294px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">GLOSSARY OF COMMON "MIPS" TERMS</span></div>
<div style="position:absolute;left:521.71px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX F</span></div>
<div style="position:absolute;left:216.00px;top:50.67px" class="cls_008"><span class="cls_008">interrupt priority</span><span class="cls_006">: in many architectures the interrupt inputs have built-in</span></div>
<div style="position:absolute;left:239.98px;top:61.67px" class="cls_006"><span class="cls_006">priority; an interrupt will not take effect during the execution of an</span></div>
<div style="position:absolute;left:239.98px;top:72.67px" class="cls_006"><span class="cls_006">interrupt handler at equal or higher priority. The MIPS hardware</span></div>
<div style="position:absolute;left:239.98px;top:83.67px" class="cls_006"><span class="cls_006">doesn’t do this directly; but the system software can impose a priority</span></div>
<div style="position:absolute;left:239.98px;top:94.67px" class="cls_006"><span class="cls_006">on the interrupt inputs.</span></div>
<div style="position:absolute;left:216.00px;top:108.67px" class="cls_008"><span class="cls_008">interrupt</span><span class="cls_006">: an external signal which can cause an exception (if not masked).</span></div>
<div style="position:absolute;left:216.00px;top:122.67px" class="cls_008"><span class="cls_008">isolate cache</span><span class="cls_006">: the basic mechanism for D-cache maintenance. Puts the</span></div>
<div style="position:absolute;left:239.97px;top:133.67px" class="cls_006"><span class="cls_006">CPU into a mode where data loads/stores occur </span><span class="cls_008">only</span><span class="cls_006"> to the cache and</span></div>
<div style="position:absolute;left:239.97px;top:144.67px" class="cls_006"><span class="cls_006">not to memory. In this mode partial-word stores cause the cache line</span></div>
<div style="position:absolute;left:239.97px;top:155.67px" class="cls_006"><span class="cls_006">to be invalidated. The Cache Management chapter details how to do</span></div>
<div style="position:absolute;left:239.97px;top:166.67px" class="cls_006"><span class="cls_006">the same to the I-cache.</span></div>
<div style="position:absolute;left:215.99px;top:180.67px" class="cls_008"><span class="cls_008">jump and link (jal) instruction</span><span class="cls_006">: MIPS instruction set name for a function</span></div>
<div style="position:absolute;left:239.96px;top:191.67px" class="cls_006"><span class="cls_006">call, which puts the return address (the ‘‘link’’) into </span><span class="cls_008">ra.</span></div>
<div style="position:absolute;left:215.99px;top:205.67px" class="cls_008"><span class="cls_008">k0 and k1 registers</span><span class="cls_006">: two general-purpose registers which are reserved, by</span></div>
<div style="position:absolute;left:239.96px;top:216.67px" class="cls_006"><span class="cls_006">convention, for the use of trap handlers. It is difficult to contrive a</span></div>
<div style="position:absolute;left:239.96px;top:227.67px" class="cls_006"><span class="cls_006">trap handler which does not use at least one register before it saves it.</span></div>
<div style="position:absolute;left:215.98px;top:241.67px" class="cls_008"><span class="cls_008">kseg0 and kseg1</span><span class="cls_006">: the ‘‘unmapped’’ address spaces (actually they are</span></div>
<div style="position:absolute;left:239.95px;top:252.67px" class="cls_006"><span class="cls_006">mapped in the sense that the resulting physical addresses are in the</span></div>
<div style="position:absolute;left:239.95px;top:263.67px" class="cls_006"><span class="cls_006">low 512Mbytes). </span><span class="cls_008">kseg0</span><span class="cls_006"> is for cached references, </span><span class="cls_008">kseg1</span><span class="cls_006"> for uncached</span></div>
<div style="position:absolute;left:239.94px;top:274.67px" class="cls_006"><span class="cls_006">references. Standalone programs, or programs using simple OS’, are</span></div>
<div style="position:absolute;left:239.94px;top:285.67px" class="cls_006"><span class="cls_006">likely to run wholly in kseg0/kseg1.</span></div>
<div style="position:absolute;left:215.96px;top:299.67px" class="cls_008"><span class="cls_008">KU</span><span class="cls_006">: the kernel/user privilege bit in the status register.</span></div>
<div style="position:absolute;left:215.96px;top:313.67px" class="cls_008"><span class="cls_008">kuseg</span><span class="cls_006">: the low half of the program address space, which is accessible by</span></div>
<div style="position:absolute;left:239.93px;top:324.67px" class="cls_006"><span class="cls_006">programs running with user privileges. The translation to a physical</span></div>
<div style="position:absolute;left:239.93px;top:335.67px" class="cls_006"><span class="cls_006">address is either through the TLB (“E” versions) or through a fixed</span></div>
<div style="position:absolute;left:239.93px;top:346.67px" class="cls_006"><span class="cls_006">translation (“base” versions).</span></div>
<div style="position:absolute;left:215.95px;top:360.67px" class="cls_008"><span class="cls_008">leaf function</span><span class="cls_006">: a function which itself contains no other function call. This</span></div>
<div style="position:absolute;left:239.92px;top:371.67px" class="cls_006"><span class="cls_006">kind of function can return directly through the </span><span class="cls_008">ra</span><span class="cls_006"> register, and</span></div>
<div style="position:absolute;left:239.92px;top:382.67px" class="cls_006"><span class="cls_006">typically uses no stack space.</span></div>
<div style="position:absolute;left:215.94px;top:396.67px" class="cls_008"><span class="cls_008">level sensitive</span><span class="cls_006">: an attribute of a signal (particularly an interrupt signal)</span></div>
<div style="position:absolute;left:239.91px;top:407.67px" class="cls_006"><span class="cls_006">that says that the receiving logic will react if the signal is provided at</span></div>
<div style="position:absolute;left:239.91px;top:418.67px" class="cls_006"><span class="cls_006">a designated logic level (as opposed to “edge sensitive”, whereby the</span></div>
<div style="position:absolute;left:239.91px;top:429.67px" class="cls_006"><span class="cls_006">receiving logic reacts to a </span><span class="cls_008">change</span><span class="cls_006"> in the signal level). MIPS interrupt</span></div>
<div style="position:absolute;left:239.90px;top:440.67px" class="cls_006"><span class="cls_006">inputs are level sensitive; they will cause an interrupt any time they</span></div>
<div style="position:absolute;left:239.90px;top:451.67px" class="cls_006"><span class="cls_006">are active and unmasked.</span></div>
<div style="position:absolute;left:215.92px;top:465.67px" class="cls_008"><span class="cls_008">linker</span><span class="cls_006">: the program which joins together object code modules, resolving</span></div>
<div style="position:absolute;left:239.90px;top:476.67px" class="cls_006"><span class="cls_006">external references.</span></div>
<div style="position:absolute;left:215.92px;top:490.67px" class="cls_008"><span class="cls_008">little-endian</span><span class="cls_006">: describes an architecture where the least-significant part of a</span></div>
<div style="position:absolute;left:239.90px;top:501.67px" class="cls_006"><span class="cls_006">multi-byte integer is stored at the lowest byte address.</span></div>
<div style="position:absolute;left:215.92px;top:515.67px" class="cls_008"><span class="cls_008">lo, hi registers</span><span class="cls_006">: dedicated output registers of the integer multiply/divide</span></div>
<div style="position:absolute;left:239.90px;top:526.67px" class="cls_006"><span class="cls_006">unit. These registers are interlocked - an attempt to copy data from</span></div>
<div style="position:absolute;left:239.90px;top:537.67px" class="cls_006"><span class="cls_006">them into a general-purpose register will be stalled until the multiply/</span></div>
<div style="position:absolute;left:239.90px;top:548.67px" class="cls_006"><span class="cls_006">divide can complete.</span></div>
<div style="position:absolute;left:215.92px;top:562.67px" class="cls_008"><span class="cls_008">load delay slot</span><span class="cls_006">: the position in the instruction sequence immediately</span></div>
<div style="position:absolute;left:239.89px;top:573.67px" class="cls_006"><span class="cls_006">following a load. An instruction in the load delay slot cannot use the</span></div>
<div style="position:absolute;left:239.89px;top:584.67px" class="cls_006"><span class="cls_006">value just loaded (the results would be unpredictable). The compiler,</span></div>
<div style="position:absolute;left:239.89px;top:595.67px" class="cls_006"><span class="cls_006">assembler or programmer may move code around to try to make best</span></div>
<div style="position:absolute;left:239.89px;top:606.67px" class="cls_006"><span class="cls_006">use of load delay slots, or use a “nop” if the code can’t be re-ordered.</span></div>
<div style="position:absolute;left:215.91px;top:620.67px" class="cls_008"><span class="cls_008">load delay</span><span class="cls_006">: see delayed loads.</span></div>
<div style="position:absolute;left:215.91px;top:634.67px" class="cls_008"><span class="cls_008">load/store architecture</span><span class="cls_006">: describes an ISA like MIPS, where memory data</span></div>
<div style="position:absolute;left:239.89px;top:645.67px" class="cls_006"><span class="cls_006">can be accessed only by explicit load and store instructions. Many</span></div>
<div style="position:absolute;left:239.89px;top:656.67px" class="cls_006"><span class="cls_006">other architectures define instructions (e.g. ‘‘push’’, or arithmetic on</span></div>
<div style="position:absolute;left:239.89px;top:667.67px" class="cls_006"><span class="cls_006">a memory variable) which implicitly access memory.</span></div>
<div style="position:absolute;left:215.91px;top:681.67px" class="cls_008"><span class="cls_008">loader</span><span class="cls_006">: the program which takes an object code module and assigns fixed</span></div>
<div style="position:absolute;left:239.89px;top:692.67px" class="cls_006"><span class="cls_006">program addresses to instructions and data, in order to make an</span></div>
<div style="position:absolute;left:239.89px;top:703.67px" class="cls_006"><span class="cls_006">executable file.</span></div>
<div style="position:absolute;left:305.28px;top:755.34px" class="cls_002"><span class="cls_002">F-7</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:279096px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX F</span></div>
<div style="position:absolute;left:382.45px;top:28.00px" class="cls_002"><span class="cls_002">GLOSSARY OF COMMON "MIPS" TERMS</span></div>
<div style="position:absolute;left:36.00px;top:50.67px" class="cls_008"><span class="cls_008">logic analyzer</span><span class="cls_006">: a piece of test equipment which simultaneously monitors</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">the logic level (i.e. as 1 or zero) of many signals. It is often used to keep</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">a list of the addresses of accesses made by a microprocessor.</span></div>
<div style="position:absolute;left:36.00px;top:86.67px" class="cls_008"><span class="cls_008">loop unrolling</span><span class="cls_006">: an optimization used by advanced compilers. Program loops</span></div>
<div style="position:absolute;left:59.97px;top:97.67px" class="cls_006"><span class="cls_006">are compiled to code which can implement several iterations of the</span></div>
<div style="position:absolute;left:59.97px;top:108.67px" class="cls_006"><span class="cls_006">loop  without  branching  out  of  line.  This  can  be  particularly</span></div>
<div style="position:absolute;left:59.97px;top:119.67px" class="cls_006"><span class="cls_006">advantageous on architectures (unlike MIPS) where a long pipeline</span></div>
<div style="position:absolute;left:59.97px;top:130.67px" class="cls_006"><span class="cls_006">and instruction prefetching makes taken branches costly. However,</span></div>
<div style="position:absolute;left:59.97px;top:141.67px" class="cls_006"><span class="cls_006">even on the MIPS architecture it can help by allowing intermingling of</span></div>
<div style="position:absolute;left:59.97px;top:152.67px" class="cls_006"><span class="cls_006">code from different loop iterations.</span></div>
<div style="position:absolute;left:35.99px;top:166.67px" class="cls_008"><span class="cls_008">macro instructions</span><span class="cls_006">: see instruction synthesis by assembler.</span></div>
<div style="position:absolute;left:35.99px;top:180.67px" class="cls_008"><span class="cls_008">mantissa</span><span class="cls_006">: a part of the representation of a floating point number.</span></div>
<div style="position:absolute;left:35.99px;top:194.67px" class="cls_008"><span class="cls_008">micro-TLB</span><span class="cls_006">: the MIPS TLB is dedicated to translating data addresses. Use of</span></div>
<div style="position:absolute;left:59.97px;top:205.67px" class="cls_006"><span class="cls_006">the TLB to translate addresses for I-fetch would lead to resource</span></div>
<div style="position:absolute;left:59.97px;top:216.67px" class="cls_006"><span class="cls_006">conflict and would slow the CPU. The micro-TLB remembers the last</span></div>
<div style="position:absolute;left:59.97px;top:227.67px" class="cls_006"><span class="cls_006">used  I-fetch  program  pages,  and  physical  pages,  and  saves  a</span></div>
<div style="position:absolute;left:59.97px;top:238.67px" class="cls_006"><span class="cls_006">reference to the real TLB until execution occurs outside the two most</span></div>
<div style="position:absolute;left:59.97px;top:249.67px" class="cls_006"><span class="cls_006">recently referenced pages. When this happens, a 1-clock stall occurs</span></div>
<div style="position:absolute;left:59.97px;top:260.67px" class="cls_006"><span class="cls_006">while the micro-TLB is refilled from the data TLB.</span></div>
<div style="position:absolute;left:35.99px;top:274.67px" class="cls_008"><span class="cls_008">MIPS System VR3, RISC/os and Irix</span><span class="cls_006">: these are all ways of referring to the</span></div>
<div style="position:absolute;left:59.97px;top:285.67px" class="cls_006"><span class="cls_006">same basic operating system, a derivative of Unix System V Release</span></div>
<div style="position:absolute;left:59.97px;top:296.67px" class="cls_006"><span class="cls_006">3. This OS supports ‘‘RISCware’’ applications.</span></div>
<div style="position:absolute;left:35.99px;top:310.67px" class="cls_008"><span class="cls_008">MIPS UMIPS 4.3BSD</span><span class="cls_006">: MIPS Corp.'s first operating system was a derivative</span></div>
<div style="position:absolute;left:59.97px;top:321.67px" class="cls_006"><span class="cls_006">of Berkeley’s BSD4.3 version of Unix.</span></div>
<div style="position:absolute;left:35.99px;top:335.67px" class="cls_008"><span class="cls_008">MIPS</span><span class="cls_006">:  used  alternately  to  refer  to  the  name  of  the  company  which</span></div>
<div style="position:absolute;left:59.96px;top:346.67px" class="cls_006"><span class="cls_006">originated this processor architecture, or the name of the architecture</span></div>
<div style="position:absolute;left:59.96px;top:357.67px" class="cls_006"><span class="cls_006">itself. It has another meaning, referring to “Millions of Instructions</span></div>
<div style="position:absolute;left:59.96px;top:368.67px" class="cls_006"><span class="cls_006">Per Second”, a performance metric.</span></div>
<div style="position:absolute;left:35.98px;top:382.67px" class="cls_008"><span class="cls_008">MIPS/ABI</span><span class="cls_006">: the latest standard for MIPS applications, supported by all Unix</span></div>
<div style="position:absolute;left:59.96px;top:393.67px" class="cls_006"><span class="cls_006">system vendors using the MIPS architecture in big-endian form.</span></div>
<div style="position:absolute;left:35.98px;top:407.67px" class="cls_008"><span class="cls_008">MIPSCO</span><span class="cls_006">: MIPS Corporation, now the MIPS Technologies Inc. subsidiary of</span></div>
<div style="position:absolute;left:59.95px;top:418.67px" class="cls_006"><span class="cls_006">Silicon Graphics Corporation.</span></div>
<div style="position:absolute;left:35.97px;top:432.67px" class="cls_008"><span class="cls_008">MIPSEB and MIPSEL</span><span class="cls_006">: these are the words used to request big-endian and</span></div>
<div style="position:absolute;left:59.94px;top:443.67px" class="cls_006"><span class="cls_006">little-endian  output</span></div>
<div style="position:absolute;left:169.04px;top:443.67px" class="cls_006"><span class="cls_006">(respectively)  from  the  MIPS  Co.  compiler</span></div>
<div style="position:absolute;left:59.94px;top:454.67px" class="cls_006"><span class="cls_006">toolchain and some others.</span></div>
<div style="position:absolute;left:35.96px;top:468.67px" class="cls_008"><span class="cls_008">misaligned</span><span class="cls_006">: see unaligned.</span></div>
<div style="position:absolute;left:35.96px;top:482.67px" class="cls_008"><span class="cls_008">MMU, Memory management unit</span><span class="cls_006">: the only memory-management hardware</span></div>
<div style="position:absolute;left:59.93px;top:493.67px" class="cls_006"><span class="cls_006">provided in the MIPS architecture is the TLB which can translate</span></div>
<div style="position:absolute;left:59.93px;top:504.67px" class="cls_006"><span class="cls_006">program  addresses  from  any  of  up  to</span></div>
<div style="position:absolute;left:273.90px;top:504.67px" class="cls_006"><span class="cls_006">64  pages  into  physical</span></div>
<div style="position:absolute;left:59.93px;top:515.67px" class="cls_006"><span class="cls_006">addresses. See TLB for details.</span></div>
<div style="position:absolute;left:35.95px;top:529.67px" class="cls_008"><span class="cls_008">NaN</span><span class="cls_006">: ‘‘not a number’’ - a special floating point value defined by IEEE754</span></div>
<div style="position:absolute;left:59.93px;top:540.67px" class="cls_006"><span class="cls_006">as the value to be returned from operations presented with illegal</span></div>
<div style="position:absolute;left:59.93px;top:551.67px" class="cls_006"><span class="cls_006">operands.</span></div>
<div style="position:absolute;left:35.95px;top:565.67px" class="cls_008"><span class="cls_008">naturally aligned</span><span class="cls_006">: a datum of length </span><span class="cls_008">n</span><span class="cls_006"> is naturally aligned if its base</span></div>
<div style="position:absolute;left:59.92px;top:576.67px" class="cls_006"><span class="cls_006">address is zero mod </span><span class="cls_008">n</span><span class="cls_006">. A word is naturally aligned if it is on a 4-byte</span></div>
<div style="position:absolute;left:59.92px;top:587.67px" class="cls_006"><span class="cls_006">boundary; a half-word if it is on a 2-byte boundary.</span></div>
<div style="position:absolute;left:35.94px;top:601.67px" class="cls_008"><span class="cls_008">noalias - noat - nobopt - nomacro - noreorder - novolatile</span><span class="cls_006">: assembler</span></div>
<div style="position:absolute;left:59.92px;top:612.67px" class="cls_006"><span class="cls_006">language controls, which turn off various aspects of the way the</span></div>
<div style="position:absolute;left:59.92px;top:623.67px" class="cls_006"><span class="cls_006">assembler works.</span></div>
<div style="position:absolute;left:35.94px;top:637.67px" class="cls_008"><span class="cls_008">non-leaf function</span><span class="cls_006">: a function which somewhere calls another function.</span></div>
<div style="position:absolute;left:59.91px;top:648.67px" class="cls_006"><span class="cls_006">Normally the compiler will translate them with a function prologue</span></div>
<div style="position:absolute;left:59.91px;top:659.67px" class="cls_006"><span class="cls_006">which saves the return address (and possibly other register values) on</span></div>
<div style="position:absolute;left:59.91px;top:670.67px" class="cls_006"><span class="cls_006">a stack, and a function epilogue which restores these values.</span></div>
<div style="position:absolute;left:35.93px;top:684.67px" class="cls_008"><span class="cls_008">nop</span><span class="cls_006">: no-operation. This is actually an alias for sllv zero,zero,zero - which</span></div>
<div style="position:absolute;left:59.91px;top:695.67px" class="cls_006"><span class="cls_006">will actually not do anything.</span></div>
<div style="position:absolute;left:291.54px;top:755.34px" class="cls_002"><span class="cls_002">F-8</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:279898px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">GLOSSARY OF COMMON "MIPS" TERMS</span></div>
<div style="position:absolute;left:521.71px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX F</span></div>
<div style="position:absolute;left:216.00px;top:50.67px" class="cls_008"><span class="cls_008">nullified</span><span class="cls_006">: applied to an instruction which, although it has been started in</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">the pipeline, will not be allowed to change the processor context. In</span></div>
<div style="position:absolute;left:239.97px;top:72.67px" class="cls_006"><span class="cls_006">general, instructions never change context until at least the MEM</span></div>
<div style="position:absolute;left:239.97px;top:83.67px" class="cls_006"><span class="cls_006">pipestage. In the R30xx family instructions are only nullified when an</span></div>
<div style="position:absolute;left:239.97px;top:94.67px" class="cls_006"><span class="cls_006">exception occurs before they have committed to the MEM stage.</span></div>
<div style="position:absolute;left:215.99px;top:108.67px" class="cls_008"><span class="cls_008">NVRAM</span><span class="cls_006">: non-volatile RAM, used rather generically to refer to any writable</span></div>
<div style="position:absolute;left:239.97px;top:119.67px" class="cls_006"><span class="cls_006">storage which is preserved while the system is powered down.</span></div>
<div style="position:absolute;left:215.99px;top:133.67px" class="cls_008"><span class="cls_008">object code</span><span class="cls_006">: a special file format containing compiled program source and</span></div>
<div style="position:absolute;left:239.97px;top:144.67px" class="cls_006"><span class="cls_006">data,  in  a  form  which  can  be  quickly  and  easily  converted  to</span></div>
<div style="position:absolute;left:239.97px;top:155.67px" class="cls_006"><span class="cls_006">executable format.</span></div>
<div style="position:absolute;left:215.99px;top:169.67px" class="cls_008"><span class="cls_008">operand</span><span class="cls_006">: a value used by an operation.</span></div>
<div style="position:absolute;left:215.99px;top:183.67px" class="cls_008"><span class="cls_008">overflow</span><span class="cls_006">: when the result of an operation is too big to be represented in the</span></div>
<div style="position:absolute;left:239.97px;top:194.67px" class="cls_006"><span class="cls_006">output format, it is said to overflow.</span></div>
<div style="position:absolute;left:215.99px;top:208.67px" class="cls_008"><span class="cls_008">padding</span><span class="cls_006">: ‘‘spaces’’ left in memory data structures and representations,</span></div>
<div style="position:absolute;left:239.97px;top:219.67px" class="cls_006"><span class="cls_006">caused by the compilers’ need to align data to the boundaries which</span></div>
<div style="position:absolute;left:239.97px;top:230.67px" class="cls_006"><span class="cls_006">the hardware prefers.</span></div>
<div style="position:absolute;left:215.99px;top:244.67px" class="cls_008"><span class="cls_008">page mode memory</span><span class="cls_006">: a way of using a DRAM memory array. In DRAMs it is</span></div>
<div style="position:absolute;left:239.97px;top:255.67px" class="cls_006"><span class="cls_006">much faster to make repeated access to a single region of memory</span></div>
<div style="position:absolute;left:239.97px;top:266.67px" class="cls_006"><span class="cls_006">where the ‘‘row’’ address presented to the DRAM component is</span></div>
<div style="position:absolute;left:239.97px;top:277.67px" class="cls_006"><span class="cls_006">common. R30xx family components give specific support to page</span></div>
<div style="position:absolute;left:239.97px;top:288.67px" class="cls_006"><span class="cls_006">mode access, particularly to speed writes.</span></div>
<div style="position:absolute;left:215.99px;top:302.67px" class="cls_008"><span class="cls_008">page table</span><span class="cls_006">: a possible implementation of the TLB miss exception is to keep</span></div>
<div style="position:absolute;left:239.97px;top:313.67px" class="cls_006"><span class="cls_006">a large number of page translations in a table indexed by the high-</span></div>
<div style="position:absolute;left:239.97px;top:324.67px" class="cls_006"><span class="cls_006">order virtual address; such a thing is called a page table.</span></div>
<div style="position:absolute;left:215.99px;top:338.67px" class="cls_008"><span class="cls_008">paged</span><span class="cls_006">: describes a memory management system (like MIPS) where fixed-</span></div>
<div style="position:absolute;left:239.96px;top:349.67px" class="cls_006"><span class="cls_006">size pages (in the R30xx “E” versions they are 4Kbytes in size) are</span></div>
<div style="position:absolute;left:239.96px;top:360.67px" class="cls_006"><span class="cls_006">mapped; high bits are translated while the low bits (11 bits for 4kB</span></div>
<div style="position:absolute;left:239.96px;top:371.67px" class="cls_006"><span class="cls_006">pages) are passed through unchanged.</span></div>
<div style="position:absolute;left:215.98px;top:385.67px" class="cls_008"><span class="cls_008">partial-word</span><span class="cls_006">:  any  transfer  which  is  not  a  whole  word.  In  the  MIPS</span></div>
<div style="position:absolute;left:239.95px;top:396.67px" class="cls_006"><span class="cls_006">architecture this can be 1-, 2- or 3 bytes.</span></div>
<div style="position:absolute;left:215.97px;top:410.67px" class="cls_008"><span class="cls_008">PC-relative</span><span class="cls_006">: an instruction is PC-relative if it generates an address which is</span></div>
<div style="position:absolute;left:239.94px;top:421.67px" class="cls_006"><span class="cls_006">an offset from the instruction’s own location.</span></div>
<div style="position:absolute;left:215.96px;top:435.67px" class="cls_008"><span class="cls_008">peephole optimization</span><span class="cls_006">: a form of optimization which recognizes particular</span></div>
<div style="position:absolute;left:239.94px;top:446.67px" class="cls_006"><span class="cls_006">patterns of instruction sequence and replaces them by shorter,</span></div>
<div style="position:absolute;left:239.94px;top:457.67px" class="cls_006"><span class="cls_006">simpler patterns. Peephole optimization is not terribly important for</span></div>
<div style="position:absolute;left:239.94px;top:468.67px" class="cls_006"><span class="cls_006">RISCs, but they are very important to CISCs - where they provide the</span></div>
<div style="position:absolute;left:239.94px;top:479.67px" class="cls_006"><span class="cls_006">only   mechanism   by   which   compilers   can   exploit   complex</span></div>
<div style="position:absolute;left:239.94px;top:490.67px" class="cls_006"><span class="cls_006">instructions.</span></div>
<div style="position:absolute;left:215.96px;top:504.67px" class="cls_008"><span class="cls_008">PFN</span><span class="cls_006">: ‘‘page frame number’’ - the high-order part of the program address</span></div>
<div style="position:absolute;left:239.94px;top:515.67px" class="cls_006"><span class="cls_006">which is submitted to the address translation mechanism of a paged</span></div>
<div style="position:absolute;left:239.94px;top:526.67px" class="cls_006"><span class="cls_006">MMU.</span></div>
<div style="position:absolute;left:215.96px;top:540.67px" class="cls_008"><span class="cls_008">pipeline re-organization</span><span class="cls_006">: see peephole optimization.</span></div>
<div style="position:absolute;left:215.96px;top:554.67px" class="cls_008"><span class="cls_008">pipeline concealment by assembler</span><span class="cls_006">: MIPS assembler language does not</span></div>
<div style="position:absolute;left:239.94px;top:565.67px" class="cls_006"><span class="cls_006">usually require the programmer to take account of the pipeline - even</span></div>
<div style="position:absolute;left:239.94px;top:576.67px" class="cls_006"><span class="cls_006">though the machine language does. The assembler moves code</span></div>
<div style="position:absolute;left:239.94px;top:587.67px" class="cls_006"><span class="cls_006">around, or inserts ‘‘nop’’s, to prevent unwanted behavior.</span></div>
<div style="position:absolute;left:215.96px;top:601.67px" class="cls_008"><span class="cls_008">pipeline hazard</span><span class="cls_006">: this is the name for a case where an instruction sequence</span></div>
<div style="position:absolute;left:239.93px;top:612.67px" class="cls_006"><span class="cls_006">won’t work due to pipeline problems.</span></div>
<div style="position:absolute;left:215.95px;top:626.67px" class="cls_008"><span class="cls_008">pipeline</span><span class="cls_006">: the critical architectural feature by which several instructions are</span></div>
<div style="position:absolute;left:239.92px;top:637.67px" class="cls_006"><span class="cls_006">executed at once.</span></div>
<div style="position:absolute;left:215.94px;top:651.67px" class="cls_008"><span class="cls_008">pipestage</span><span class="cls_006">: one of the five phases of the MIPS pipeline.</span></div>
<div style="position:absolute;left:215.94px;top:665.67px" class="cls_008"><span class="cls_008">pixie, pixstats, and prof:</span><span class="cls_006"> see profiling. </span><span class="cls_008">pixie</span><span class="cls_006"> is a special tool provide by MIPS</span></div>
<div style="position:absolute;left:239.92px;top:676.67px" class="cls_006"><span class="cls_006">Corp., which can be used to measure the instruction-by-instruction</span></div>
<div style="position:absolute;left:239.92px;top:687.67px" class="cls_006"><span class="cls_006">behavior of programs at high speed. It works by translating the</span></div>
<div style="position:absolute;left:239.92px;top:698.67px" class="cls_006"><span class="cls_006">original program binary into a version which includes ‘‘metering’’</span></div>
<div style="position:absolute;left:305.28px;top:755.34px" class="cls_002"><span class="cls_002">F-9</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:280700px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX F</span></div>
<div style="position:absolute;left:382.45px;top:28.00px" class="cls_002"><span class="cls_002">GLOSSARY OF COMMON "MIPS" TERMS</span></div>
<div style="position:absolute;left:59.98px;top:50.67px" class="cls_006"><span class="cls_006">instructions which count the number of times each </span><span class="cls_008">basic block</span><span class="cls_006"> is</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">executed (a basic block is a section of code delimited by branches</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">and/or branch targets).</span></div>
<div style="position:absolute;left:59.98px;top:86.67px" class="cls_008"><span class="cls_008">pixstats and prof</span><span class="cls_006"> take the huge indigestible array of counts produced</span></div>
<div style="position:absolute;left:59.98px;top:97.67px" class="cls_006"><span class="cls_006">by a pixie run and munches them down into useful statistics.</span></div>
<div style="position:absolute;left:36.00px;top:111.67px" class="cls_008"><span class="cls_008">PortSize register</span><span class="cls_006">: CPU control register provided on the R3041, and used to</span></div>
<div style="position:absolute;left:59.98px;top:122.67px" class="cls_006"><span class="cls_006">define the bus transfer width used for accesses in various regions.</span></div>
<div style="position:absolute;left:36.00px;top:136.67px" class="cls_008"><span class="cls_008">position-independent   code</span></div>
<div style="position:absolute;left:175.94px;top:136.67px" class="cls_008"><span class="cls_008">(PIC)</span><span class="cls_006">:   code   which   can   execute   correctly</span></div>
<div style="position:absolute;left:59.98px;top:147.67px" class="cls_006"><span class="cls_006">regardless of where it is positioned in program address space. This is</span></div>
<div style="position:absolute;left:59.98px;top:158.67px" class="cls_006"><span class="cls_006">usually produced by making sure all references are PC and/or GP-</span></div>
<div style="position:absolute;left:59.98px;top:169.67px" class="cls_006"><span class="cls_006">relative. PIC is an essential part of the MIPS/ABI standard, where</span></div>
<div style="position:absolute;left:59.98px;top:180.67px" class="cls_006"><span class="cls_006">sharable library code must be compiled position-independent.</span></div>
<div style="position:absolute;left:36.00px;top:194.67px" class="cls_008"><span class="cls_008">POSIX</span><span class="cls_006">: a still-evolving IEEE standard for the programming interface</span></div>
<div style="position:absolute;left:59.97px;top:205.67px" class="cls_006"><span class="cls_006">provided by a compliant operating system.</span></div>
<div style="position:absolute;left:35.99px;top:219.67px" class="cls_008"><span class="cls_008">PPN</span><span class="cls_006">: physical page number; the high order part of the physical address,</span></div>
<div style="position:absolute;left:59.97px;top:230.67px" class="cls_006"><span class="cls_006">which is the output of the paged MMU.</span></div>
<div style="position:absolute;left:35.99px;top:244.67px" class="cls_008"><span class="cls_008">pragma</span><span class="cls_006">: the C compiler ‘‘</span><span class="cls_029">#pragma</span><span class="cls_006">’’ directive is used to select compiler</span></div>
<div style="position:absolute;left:59.97px;top:255.67px" class="cls_006"><span class="cls_006">options from within the source code.</span></div>
<div style="position:absolute;left:35.99px;top:269.67px" class="cls_008"><span class="cls_008">precise exception</span><span class="cls_006">: the MIPS architecture offers precise exceptions. This</span></div>
<div style="position:absolute;left:59.96px;top:280.67px" class="cls_006"><span class="cls_006">means  that,  following  an  exception,  all  instructions  earlier  in</span></div>
<div style="position:absolute;left:59.96px;top:291.67px" class="cls_006"><span class="cls_006">instruction sequence than the instruction referenced by </span><span class="cls_008">EPC</span><span class="cls_006"> are</span></div>
<div style="position:absolute;left:59.96px;top:302.67px" class="cls_006"><span class="cls_006">completed, whereas all instructions later in instruction sequence</span></div>
<div style="position:absolute;left:59.96px;top:313.67px" class="cls_006"><span class="cls_006">have not changed processor state.</span></div>
<div style="position:absolute;left:35.98px;top:327.67px" class="cls_008"><span class="cls_008">precision of data type</span><span class="cls_006">: the number of bits available for its representation.</span></div>
<div style="position:absolute;left:35.98px;top:341.67px" class="cls_008"><span class="cls_008">PRId register</span><span class="cls_006">: CPU control register (read-only) which tells the type and</span></div>
<div style="position:absolute;left:59.96px;top:352.67px" class="cls_006"><span class="cls_006">revision number of the CPU.</span></div>
<div style="position:absolute;left:35.98px;top:366.67px" class="cls_008"><span class="cls_008">primary cache</span><span class="cls_006">: in a system with more than one level of cache, this is the</span></div>
<div style="position:absolute;left:59.96px;top:377.67px" class="cls_006"><span class="cls_006">cache closest to the CPU. Most R30xx family implementations will</span></div>
<div style="position:absolute;left:59.96px;top:388.67px" class="cls_006"><span class="cls_006">have only one level of cache (the on-chip cache).</span></div>
<div style="position:absolute;left:35.98px;top:402.67px" class="cls_008"><span class="cls_008">privilege level</span><span class="cls_006">: CPUs capable of running a secure OS must be able to</span></div>
<div style="position:absolute;left:59.96px;top:413.67px" class="cls_006"><span class="cls_006">operate at different privilege levels. The MIPS CPU can operate at two:</span></div>
<div style="position:absolute;left:59.96px;top:424.67px" class="cls_006"><span class="cls_006">kernel and user.</span></div>
<div style="position:absolute;left:35.98px;top:438.67px" class="cls_008"><span class="cls_008">profiling</span><span class="cls_006">: running a program with some kind of instrumentation, to derive</span></div>
<div style="position:absolute;left:59.95px;top:449.67px" class="cls_006"><span class="cls_006">information about its resource usage and running.</span></div>
<div style="position:absolute;left:35.97px;top:463.67px" class="cls_008"><span class="cls_008">program address</span><span class="cls_006">: the software engineer’s view of addresses, as generated</span></div>
<div style="position:absolute;left:59.94px;top:474.67px" class="cls_006"><span class="cls_006">by the program. Also known as ‘‘virtual address’’.</span></div>
<div style="position:absolute;left:35.96px;top:488.67px" class="cls_008"><span class="cls_008">PROM</span><span class="cls_006">: programmable read-only memory, used to mean any read-only</span></div>
<div style="position:absolute;left:59.93px;top:499.67px" class="cls_006"><span class="cls_006">program memory.</span></div>
<div style="position:absolute;left:35.95px;top:513.67px" class="cls_008"><span class="cls_008">quad-precision (128-bit) floating point</span><span class="cls_006">: not supported by R30xx hardware,</span></div>
<div style="position:absolute;left:59.92px;top:524.67px" class="cls_006"><span class="cls_006">but referred to in some documentation.</span></div>
<div style="position:absolute;left:35.94px;top:538.67px" class="cls_008"><span class="cls_008">R2000, R3000</span><span class="cls_006">: the original implementations of the MIPS ISA, packaged to</span></div>
<div style="position:absolute;left:59.91px;top:549.67px" class="cls_006"><span class="cls_006">use external static RAMs as cache.</span></div>
<div style="position:absolute;left:35.93px;top:563.67px" class="cls_008"><span class="cls_008">ra register</span><span class="cls_006">: CPU register $31, conventionally used for the return address</span></div>
<div style="position:absolute;left:59.90px;top:574.67px" class="cls_006"><span class="cls_006">from subroutines. This use is supported by the ISA in that it is used</span></div>
<div style="position:absolute;left:59.90px;top:585.67px" class="cls_006"><span class="cls_006">by jal instruction (whose 26-bit target address field leaves it no room</span></div>
<div style="position:absolute;left:59.91px;top:596.67px" class="cls_006"><span class="cls_006">to specify which register should receive the return address value).</span></div>
<div style="position:absolute;left:35.93px;top:610.67px" class="cls_008"><span class="cls_008">Random register</span><span class="cls_006">: a CPU control register present only if there is a TLB. It</span></div>
<div style="position:absolute;left:59.90px;top:621.67px" class="cls_006"><span class="cls_006">increments continually and autonomously, and is used for pseudo-</span></div>
<div style="position:absolute;left:59.90px;top:632.67px" class="cls_006"><span class="cls_006">random replacement of TLB entries.</span></div>
<div style="position:absolute;left:35.92px;top:646.67px" class="cls_008"><span class="cls_008">ranlib</span><span class="cls_006">: a program used to maintain object-code libraries</span></div>
<div style="position:absolute;left:339.19px;top:646.67px" class="cls_006"><span class="cls_006">- it makes</span></div>
<div style="position:absolute;left:59.90px;top:657.67px" class="cls_006"><span class="cls_006">indexes.</span></div>
<div style="position:absolute;left:35.92px;top:671.67px" class="cls_008"><span class="cls_008">read buffer</span><span class="cls_006">: on a burst-mode cache read, the MIPS R3000A core used in</span></div>
<div style="position:absolute;left:59.89px;top:682.67px" class="cls_006"><span class="cls_006">the R30xx family needs to be fed with data at 1-clock intervals (once</span></div>
<div style="position:absolute;left:59.89px;top:693.67px" class="cls_006"><span class="cls_006">it is told to restart). A read buffer permits the actual memory timings</span></div>
<div style="position:absolute;left:289.30px;top:755.34px" class="cls_002"><span class="cls_002">F-10</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:281502px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">GLOSSARY OF COMMON "MIPS" TERMS</span></div>
<div style="position:absolute;left:521.71px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX F</span></div>
<div style="position:absolute;left:239.98px;top:50.67px" class="cls_006"><span class="cls_006">to be a little slower; the CPU fills the read buffer at memory speed and</span></div>
<div style="position:absolute;left:239.98px;top:61.67px" class="cls_006"><span class="cls_006">empties it at CPU speed. The R30xx family implements a read buffer</span></div>
<div style="position:absolute;left:239.98px;top:72.67px" class="cls_006"><span class="cls_006">on-chip to ease system hardware design.</span></div>
<div style="position:absolute;left:216.00px;top:86.67px" class="cls_008"><span class="cls_008">read priority</span><span class="cls_006">: because of the write buffer, the CPU may simultaneously</span></div>
<div style="position:absolute;left:239.97px;top:97.67px" class="cls_006"><span class="cls_006">want to do a read and a (delayed) write. It is possible, and can boost</span></div>
<div style="position:absolute;left:239.97px;top:108.67px" class="cls_006"><span class="cls_006">performance, to do the read first - the CPU will always be waiting for</span></div>
<div style="position:absolute;left:239.97px;top:119.67px" class="cls_006"><span class="cls_006">the read data; this is called ‘‘read priority’’. But it causes coherency</span></div>
<div style="position:absolute;left:239.97px;top:130.67px" class="cls_006"><span class="cls_006">problems when the location being read is affected by a pending write;</span></div>
<div style="position:absolute;left:239.97px;top:141.67px" class="cls_006"><span class="cls_006">the R30xx uses read priority for I-Cache misses, but write priority for</span></div>
<div style="position:absolute;left:239.97px;top:152.67px" class="cls_006"><span class="cls_006">D-Cache misses and uncached fetches (I- or D-).</span></div>
<div style="position:absolute;left:215.99px;top:166.67px" class="cls_008"><span class="cls_008">reset</span><span class="cls_006">: used in this manual for the event which happens when the system</span></div>
<div style="position:absolute;left:239.96px;top:177.67px" class="cls_006"><span class="cls_006">activates the Reset* input to the CPU; this happens at power-on or</span></div>
<div style="position:absolute;left:239.96px;top:188.67px" class="cls_006"><span class="cls_006">system reinitialization.</span></div>
<div style="position:absolute;left:215.98px;top:202.67px" class="cls_008"><span class="cls_008">rounding mode</span><span class="cls_006">: defines the exact behavior of floating point operations, and</span></div>
<div style="position:absolute;left:239.95px;top:213.67px" class="cls_006"><span class="cls_006">configurable through the floating point status/control register.</span></div>
<div style="position:absolute;left:215.97px;top:227.67px" class="cls_008"><span class="cls_008">s0-s9 register</span><span class="cls_006">: a collection of CPU general purpose registers ($16-$23 and</span></div>
<div style="position:absolute;left:239.94px;top:238.67px" class="cls_006"><span class="cls_006">$30) conventionally used for variables of function scope, and which</span></div>
<div style="position:absolute;left:239.94px;top:249.67px" class="cls_006"><span class="cls_006">must be saved by any function which modifies them.</span></div>
<div style="position:absolute;left:215.96px;top:263.67px" class="cls_008"><span class="cls_008">secondary cache</span><span class="cls_006">: in a system with more than one level of cache, this is the</span></div>
<div style="position:absolute;left:239.94px;top:274.67px" class="cls_006"><span class="cls_006">cache second closest to the CPU.</span></div>
<div style="position:absolute;left:215.96px;top:288.67px" class="cls_008"><span class="cls_008">segment</span><span class="cls_006">: see kseg0/kseg1.</span></div>
<div style="position:absolute;left:215.96px;top:302.67px" class="cls_008"><span class="cls_008">software instruction emulators</span><span class="cls_006">: a program which emulates the operation of</span></div>
<div style="position:absolute;left:239.93px;top:313.67px" class="cls_006"><span class="cls_006">a CPU/memory system. It can be used to check out software too low-</span></div>
<div style="position:absolute;left:239.93px;top:324.67px" class="cls_006"><span class="cls_006">level to be compatible with a debugger.</span></div>
<div style="position:absolute;left:215.95px;top:338.67px" class="cls_008"><span class="cls_008">software interrupts</span><span class="cls_006">:  interrupts  invoked  by  setting  bits  in  the </span><span class="cls_008"> Cause</span></div>
<div style="position:absolute;left:239.92px;top:349.67px" class="cls_006"><span class="cls_006">register, and which happen when those bits are unmasked.</span></div>
<div style="position:absolute;left:215.94px;top:363.67px" class="cls_008"><span class="cls_008">source-level debugger</span><span class="cls_006">: a debugger which interprets current program state</span></div>
<div style="position:absolute;left:239.92px;top:374.67px" class="cls_006"><span class="cls_006">in terms of the source program (instruction lines, variable names,</span></div>
<div style="position:absolute;left:239.92px;top:385.67px" class="cls_006"><span class="cls_006">data structures). Source-level debuggers need access to source code;</span></div>
<div style="position:absolute;left:239.92px;top:396.67px" class="cls_006"><span class="cls_006">so when working with embedded system software the debugger must</span></div>
<div style="position:absolute;left:239.92px;top:407.67px" class="cls_006"><span class="cls_006">run on the host, and obtains information about the program state</span></div>
<div style="position:absolute;left:239.92px;top:418.67px" class="cls_006"><span class="cls_006">from a simple ‘‘debug monitor’’ running on the target.</span></div>
<div style="position:absolute;left:215.94px;top:432.67px" class="cls_008"><span class="cls_008">sp register/stack pointer</span><span class="cls_006">: CPU register $29, used by convention as a stack</span></div>
<div style="position:absolute;left:239.91px;top:443.67px" class="cls_006"><span class="cls_006">pointer.</span></div>
<div style="position:absolute;left:215.93px;top:457.67px" class="cls_008"><span class="cls_008">SR register</span><span class="cls_006">: CPU ‘‘status register’’, one of the privileged control registers.</span></div>
<div style="position:absolute;left:239.90px;top:468.67px" class="cls_006"><span class="cls_006">Contains control bits for any modes which the CPU respects.</span></div>
<div style="position:absolute;left:215.92px;top:482.67px" class="cls_008"><span class="cls_008">SRAM</span><span class="cls_006">: static RAM - writable random-access memory which does not</span></div>
<div style="position:absolute;left:239.90px;top:493.67px" class="cls_006"><span class="cls_006">require periodic refresh, and typically has faster initial access time.</span></div>
<div style="position:absolute;left:215.92px;top:507.67px" class="cls_008"><span class="cls_008">SBrCond</span><span class="cls_006">: see BRCOND.</span></div>
<div style="position:absolute;left:215.92px;top:521.67px" class="cls_008"><span class="cls_008">stack argument structure</span><span class="cls_006">: a conceptual data structure used to explain how</span></div>
<div style="position:absolute;left:239.90px;top:532.67px" class="cls_006"><span class="cls_006">arguments are passed to functions according to the MIPS convention.</span></div>
<div style="position:absolute;left:215.92px;top:546.67px" class="cls_008"><span class="cls_008">stack backtrace</span><span class="cls_006">: a debugger function, which interprets the state of the</span></div>
<div style="position:absolute;left:239.89px;top:557.67px" class="cls_006"><span class="cls_006">program stack to show the nest of function calls which has got to the</span></div>
<div style="position:absolute;left:239.89px;top:568.67px" class="cls_006"><span class="cls_006">current position. Depends wholly on strict stack usage conventions,</span></div>
<div style="position:absolute;left:239.89px;top:579.67px" class="cls_006"><span class="cls_006">which assembler programs must notate with standard directives.</span></div>
<div style="position:absolute;left:215.91px;top:593.67px" class="cls_008"><span class="cls_008">stack frame</span><span class="cls_006">: a phrase for the piece of stack used by a particular function.</span></div>
<div style="position:absolute;left:215.91px;top:607.67px" class="cls_008"><span class="cls_008">stack underrun</span><span class="cls_006">: the error where software attempts to pop more off a stack</span></div>
<div style="position:absolute;left:239.89px;top:618.67px" class="cls_006"><span class="cls_006">than was ever put on it.</span></div>
<div style="position:absolute;left:215.91px;top:632.67px" class="cls_008"><span class="cls_008">stall</span><span class="cls_006">: the condition where the pipeline is frozen (no instruction state is</span></div>
<div style="position:absolute;left:239.88px;top:643.67px" class="cls_006"><span class="cls_006">advanced) while the CPU waits for some resource to become available.</span></div>
<div style="position:absolute;left:215.90px;top:657.67px" class="cls_008"><span class="cls_008">standalone software</span><span class="cls_006">: software operating without the benefit of any kind of</span></div>
<div style="position:absolute;left:239.88px;top:668.67px" class="cls_006"><span class="cls_006">operating system or standard run-time environment.</span></div>
<div style="position:absolute;left:215.90px;top:682.67px" class="cls_008"><span class="cls_008">strcpy</span><span class="cls_006">: C library function which copies a (null-terminated) string.</span></div>
<div style="position:absolute;left:303.04px;top:755.34px" class="cls_002"><span class="cls_002">F-11</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:282304px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:36.00px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX F</span></div>
<div style="position:absolute;left:382.45px;top:28.00px" class="cls_002"><span class="cls_002">GLOSSARY OF COMMON "MIPS" TERMS</span></div>
<div style="position:absolute;left:36.00px;top:50.67px" class="cls_008"><span class="cls_008">strength  reduction</span><span class="cls_006">:  optimization  technique  where  a  time</span></div>
<div style="position:absolute;left:339.91px;top:50.67px" class="cls_006"><span class="cls_006">‘‘expensive’’</span></div>
<div style="position:absolute;left:59.98px;top:61.67px" class="cls_006"><span class="cls_006">operation is replaced, where possible, by one or a short sequence of</span></div>
<div style="position:absolute;left:59.98px;top:72.67px" class="cls_006"><span class="cls_006">‘‘cheaper’’ operations. For example, multiply by a constant may be</span></div>
<div style="position:absolute;left:59.98px;top:83.67px" class="cls_006"><span class="cls_006">more efficiently replaced by a sequence of shift and add operations.</span></div>
<div style="position:absolute;left:36.00px;top:97.67px" class="cls_008"><span class="cls_008">swap caches</span><span class="cls_006">: temporarily reverse the roles of the I- and D-cache, so that</span></div>
<div style="position:absolute;left:59.98px;top:108.67px" class="cls_006"><span class="cls_006">the  cache  maintenance  functions  can  operate  on  the  I-cache.</span></div>
<div style="position:absolute;left:59.98px;top:119.67px" class="cls_006"><span class="cls_006">Controlled by a status register bit.</span></div>
<div style="position:absolute;left:36.00px;top:133.67px" class="cls_008"><span class="cls_008">swapper</span><span class="cls_006">: see byte-swapper.</span></div>
<div style="position:absolute;left:36.00px;top:147.67px" class="cls_008"><span class="cls_008">synthesized instructions</span><span class="cls_006">: see instruction synthesis by assembler.</span></div>
<div style="position:absolute;left:36.00px;top:161.67px" class="cls_008"><span class="cls_008">syscall</span><span class="cls_006">: system call - an instruction which produces a trap. It has a spare</span></div>
<div style="position:absolute;left:59.98px;top:172.67px" class="cls_006"><span class="cls_006">field, uninterpreted by the hardware, which software can use to</span></div>
<div style="position:absolute;left:59.98px;top:183.67px" class="cls_006"><span class="cls_006">encode different system call types.</span></div>
<div style="position:absolute;left:36.00px;top:197.67px" class="cls_008"><span class="cls_008">t0-t9   register/temporaries</span><span class="cls_006">:   CPU   registers</span></div>
<div style="position:absolute;left:272.97px;top:197.67px" class="cls_006"><span class="cls_006">$8-$15   and</span></div>
<div style="position:absolute;left:351.67px;top:197.67px" class="cls_006"><span class="cls_006">$24-$25,</span></div>
<div style="position:absolute;left:59.98px;top:208.67px" class="cls_006"><span class="cls_006">conventionally used as ‘‘temporaries’’; any function can use these</span></div>
<div style="position:absolute;left:59.98px;top:219.67px" class="cls_006"><span class="cls_006">registers regardless. The values aren’t guaranteed to survive any</span></div>
<div style="position:absolute;left:59.98px;top:230.67px" class="cls_006"><span class="cls_006">function call.</span></div>
<div style="position:absolute;left:36.00px;top:244.67px" class="cls_008"><span class="cls_008">TLB (translation lookaside buffer)</span><span class="cls_006">: the 64-entry associative store which</span></div>
<div style="position:absolute;left:59.98px;top:255.67px" class="cls_006"><span class="cls_006">translates program to physical page numbers. When the TLB doesn’t</span></div>
<div style="position:absolute;left:59.98px;top:266.67px" class="cls_006"><span class="cls_006">contain the translation entry needed, the CPU takes an exception and</span></div>
<div style="position:absolute;left:59.98px;top:277.67px" class="cls_006"><span class="cls_006">it is up to system software to load an appropriate entry before</span></div>
<div style="position:absolute;left:59.98px;top:288.67px" class="cls_006"><span class="cls_006">returning to re-execute the faulting reference.</span></div>
<div style="position:absolute;left:36.00px;top:302.67px" class="cls_008"><span class="cls_008">TLB - wired entries</span><span class="cls_006">: the first 8 TLB entries are conventionally reserved for</span></div>
<div style="position:absolute;left:59.97px;top:313.67px" class="cls_006"><span class="cls_006">statically-configured entries, and are not randomly replaced.</span></div>
<div style="position:absolute;left:35.99px;top:327.67px" class="cls_008"><span class="cls_008">TLB Invalid exception</span><span class="cls_006">: the exception taken when a TLB entry matches the</span></div>
<div style="position:absolute;left:59.97px;top:338.67px" class="cls_006"><span class="cls_006">address, but is marked as not valid.</span></div>
<div style="position:absolute;left:35.99px;top:352.67px" class="cls_008"><span class="cls_008">TLB miss</span><span class="cls_006">: the exception taken when no TLB entry matches the program</span></div>
<div style="position:absolute;left:59.96px;top:363.67px" class="cls_006"><span class="cls_006">address.</span></div>
<div style="position:absolute;left:35.98px;top:377.67px" class="cls_008"><span class="cls_008">TLB Modified exception</span><span class="cls_006">: the exception taken when a TLB entry matches a</span></div>
<div style="position:absolute;left:59.96px;top:388.67px" class="cls_006"><span class="cls_006">store address, but that entry is not flagged as writable.</span></div>
<div style="position:absolute;left:35.98px;top:402.67px" class="cls_008"><span class="cls_008">TLB Probe</span><span class="cls_006">: an instruction used to submit a program address to the TLB to</span></div>
<div style="position:absolute;left:59.95px;top:413.67px" class="cls_006"><span class="cls_006">see what translations are currently in force.</span></div>
<div style="position:absolute;left:35.97px;top:427.67px" class="cls_008"><span class="cls_008">TLB refill</span><span class="cls_006">: the process of adding a new entry to the TLB following a miss.</span></div>
<div style="position:absolute;left:35.97px;top:441.67px" class="cls_008"><span class="cls_008">toolchain</span><span class="cls_006">: the complete set of tools required to produce runnable programs</span></div>
<div style="position:absolute;left:59.95px;top:452.67px" class="cls_006"><span class="cls_006">starting from source code (compiler, assembler, linker, librarian etc.).</span></div>
<div style="position:absolute;left:35.97px;top:466.67px" class="cls_008"><span class="cls_008">trap</span><span class="cls_006">: an exception caused by some internal event affecting a particular</span></div>
<div style="position:absolute;left:59.94px;top:477.67px" class="cls_006"><span class="cls_006">instruction.</span></div>
<div style="position:absolute;left:35.96px;top:491.67px" class="cls_008"><span class="cls_008">tribyte</span><span class="cls_006">: a load/store which carries 3 bytes of data. Produced only by the</span></div>
<div style="position:absolute;left:59.94px;top:502.67px" class="cls_006"><span class="cls_006">special instructions lwl/lwr.</span></div>
<div style="position:absolute;left:35.97px;top:516.67px" class="cls_008"><span class="cls_008">Ultrix</span><span class="cls_006">: DEC’s trade name for their BSD family operating system running on</span></div>
<div style="position:absolute;left:59.94px;top:527.67px" class="cls_006"><span class="cls_006">MIPS-based   DECstation   computers.   Note   that   Ultrix,   unlike</span></div>
<div style="position:absolute;left:59.94px;top:538.67px" class="cls_006"><span class="cls_006">practically all other MIPS Unix-like systems, runs in little-endian</span></div>
<div style="position:absolute;left:59.94px;top:549.67px" class="cls_006"><span class="cls_006">mode  so  is  completely  software-incompatible  with  MIPS/ABI  or</span></div>
<div style="position:absolute;left:59.94px;top:560.67px" class="cls_006"><span class="cls_006">RISCware.</span></div>
<div style="position:absolute;left:35.96px;top:574.67px" class="cls_008"><span class="cls_008">unaligned access exception</span><span class="cls_006">: trap caused by a memory reference (load/store</span></div>
<div style="position:absolute;left:59.94px;top:585.67px" class="cls_006"><span class="cls_006">word or half-word) at a misaligned address.</span></div>
<div style="position:absolute;left:35.96px;top:599.67px" class="cls_008"><span class="cls_008">unaligned data</span><span class="cls_006">: data stored in memory but not guaranteed to be on the</span></div>
<div style="position:absolute;left:59.94px;top:610.67px" class="cls_006"><span class="cls_006">‘‘proper’’ alignment boundary. Unaligned data can only be accessed</span></div>
<div style="position:absolute;left:59.94px;top:621.67px" class="cls_006"><span class="cls_006">reliably by special code sequences.</span></div>
<div style="position:absolute;left:35.96px;top:635.67px" class="cls_008"><span class="cls_008">uncacheable</span><span class="cls_006">: describes the region </span><span class="cls_008">kseg1</span><span class="cls_006"> (which may never be cached) and</span></div>
<div style="position:absolute;left:59.94px;top:646.67px" class="cls_006"><span class="cls_006">translated  address  regions  where  the  TLB  entry  is  flagged  as</span></div>
<div style="position:absolute;left:59.94px;top:657.67px" class="cls_006"><span class="cls_006">uncached.</span></div>
<div style="position:absolute;left:35.96px;top:671.67px" class="cls_008"><span class="cls_008">unimplemented instruction exception</span><span class="cls_006">: trap taken when the CPU does not</span></div>
<div style="position:absolute;left:59.94px;top:682.67px" class="cls_006"><span class="cls_006">recognize the instruction code; also used when it cannot successfully</span></div>
<div style="position:absolute;left:59.94px;top:693.67px" class="cls_006"><span class="cls_006">complete a floating point instruction and wants the software emulator</span></div>
<div style="position:absolute;left:59.94px;top:704.67px" class="cls_006"><span class="cls_006">to take over.</span></div>
<div style="position:absolute;left:289.30px;top:755.34px" class="cls_002"><span class="cls_002">F-12</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-306px;top:283106px;width:612px;height:792px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
</div>
<div style="position:absolute;left:50.00px;top:28.00px" class="cls_002"><span class="cls_002">GLOSSARY OF COMMON "MIPS" TERMS</span></div>
<div style="position:absolute;left:521.71px;top:28.00px" class="cls_002"><span class="cls_002">APPENDIX F</span></div>
<div style="position:absolute;left:216.00px;top:50.67px" class="cls_008"><span class="cls_008">union</span><span class="cls_006">: a</span></div>
<div style="position:absolute;left:264.85px;top:50.67px" class="cls_006"><span class="cls_006">‘‘C’’ declaration of an item of data which is going to have</span></div>
<div style="position:absolute;left:239.97px;top:61.67px" class="cls_006"><span class="cls_006">alternative interpretations with different data types. This is highly</span></div>
<div style="position:absolute;left:239.97px;top:72.67px" class="cls_006"><span class="cls_006">non-portable.</span></div>
<div style="position:absolute;left:215.99px;top:86.67px" class="cls_008"><span class="cls_008">Unisoft V.4 - ‘‘Uniplus+’’</span><span class="cls_006">: yet another version of Unix SVR4, this one MIPS/</span></div>
<div style="position:absolute;left:239.97px;top:97.67px" class="cls_006"><span class="cls_006">ABI compliant.</span></div>
<div style="position:absolute;left:215.99px;top:111.67px" class="cls_008"><span class="cls_008">unmapped</span><span class="cls_006">: describes the kseg0/kseg1 address spaces.</span></div>
<div style="position:absolute;left:215.99px;top:125.67px" class="cls_008"><span class="cls_008">utlbmiss</span><span class="cls_006">: a TLB miss exception caused by a user-privilege address for</span></div>
<div style="position:absolute;left:239.97px;top:136.67px" class="cls_006"><span class="cls_006">which no mapping is present in the TLB is vectored to a unique,</span></div>
<div style="position:absolute;left:239.97px;top:147.67px" class="cls_006"><span class="cls_006">second, exception entry point. This was done because this is by far</span></div>
<div style="position:absolute;left:239.97px;top:158.67px" class="cls_006"><span class="cls_006">the most common trap in a hard-working UNIX-like operating system,</span></div>
<div style="position:absolute;left:239.97px;top:169.67px" class="cls_006"><span class="cls_006">and it saves time to avoid the code which decodes which kind of trap</span></div>
<div style="position:absolute;left:239.97px;top:180.67px" class="cls_006"><span class="cls_006">has occurred.</span></div>
<div style="position:absolute;left:215.99px;top:194.67px" class="cls_008"><span class="cls_008">v0-v1 register</span><span class="cls_006">: CPU registers $2-$3, conventionally used to hold values</span></div>
<div style="position:absolute;left:239.97px;top:205.67px" class="cls_006"><span class="cls_006">being returned by functions.</span></div>
<div style="position:absolute;left:215.99px;top:219.67px" class="cls_008"><span class="cls_008">varargs</span><span class="cls_006">: a software mechanism, implemented by the compiler prompted by</span></div>
<div style="position:absolute;left:239.97px;top:230.67px" class="cls_006"><span class="cls_006">a special include file and macros, providing a portable way of defining</span></div>
<div style="position:absolute;left:239.97px;top:241.67px" class="cls_006"><span class="cls_006">and using functions with variable numbers of arguments.</span></div>
<div style="position:absolute;left:215.99px;top:255.67px" class="cls_008"><span class="cls_008">virtual address</span><span class="cls_006">: see program address.</span></div>
<div style="position:absolute;left:215.99px;top:269.67px" class="cls_008"><span class="cls_008">void</span><span class="cls_006">: a data type used to tidy up C programs, indicating that no value is</span></div>
<div style="position:absolute;left:239.96px;top:280.67px" class="cls_006"><span class="cls_006">available.</span></div>
<div style="position:absolute;left:215.98px;top:294.67px" class="cls_008"><span class="cls_008">volatile</span><span class="cls_006">: an attribute of declared data in either C or assembler. A volatile</span></div>
<div style="position:absolute;left:239.95px;top:305.67px" class="cls_006"><span class="cls_006">variable is one which may not simply behave like memory (i.e. does</span></div>
<div style="position:absolute;left:239.95px;top:316.67px" class="cls_006"><span class="cls_006">not simply return the value last stored in it). In the absence of this</span></div>
<div style="position:absolute;left:239.95px;top:327.67px" class="cls_006"><span class="cls_006">attribute, an optimizer may assume that it is unnecessary to re-read</span></div>
<div style="position:absolute;left:239.95px;top:338.67px" class="cls_006"><span class="cls_006">a value; and if the variable represents a memory-mapped IO location</span></div>
<div style="position:absolute;left:239.95px;top:349.67px" class="cls_006"><span class="cls_006">being polled, this will be a mistake. Most compiler optimizers will</span></div>
<div style="position:absolute;left:239.95px;top:360.67px" class="cls_006"><span class="cls_006">insure this does not happen to “volatile” data.</span></div>
<div style="position:absolute;left:215.97px;top:374.67px" class="cls_008"><span class="cls_008">watchpoint</span><span class="cls_006">: a debugger feature which causes the running program to be</span></div>
<div style="position:absolute;left:239.95px;top:385.67px" class="cls_006"><span class="cls_006">suspended and control passed back to the user whenever an access</span></div>
<div style="position:absolute;left:239.95px;top:396.67px" class="cls_006"><span class="cls_006">is made to the specified address.</span></div>
<div style="position:absolute;left:215.97px;top:410.67px" class="cls_008"><span class="cls_008">wbflush</span><span class="cls_006">: a standard name for the routine/macro which ensures that the</span></div>
<div style="position:absolute;left:239.95px;top:421.67px" class="cls_006"><span class="cls_006">write buffer is empty.</span></div>
<div style="position:absolute;left:215.97px;top:435.67px" class="cls_008"><span class="cls_008">wraparound</span><span class="cls_006">: some memory systems (including the MIPS cache when</span></div>
<div style="position:absolute;left:239.95px;top:446.67px" class="cls_006"><span class="cls_006">isolated) have the property that accesses beyond the memory array</span></div>
<div style="position:absolute;left:239.95px;top:457.67px" class="cls_006"><span class="cls_006">size simply wrap round and start accessing the memory again at the</span></div>
<div style="position:absolute;left:239.95px;top:468.67px" class="cls_006"><span class="cls_006">beginning.</span></div>
<div style="position:absolute;left:215.97px;top:482.67px" class="cls_008"><span class="cls_008">write buffer</span><span class="cls_006">: a FIFO store which keeps both the address and data of a CPU</span></div>
<div style="position:absolute;left:239.95px;top:493.67px" class="cls_006"><span class="cls_006">write cycle (the R30xx family contain four of each). The CPU can</span></div>
<div style="position:absolute;left:239.95px;top:504.67px" class="cls_006"><span class="cls_006">continue execution while the writes are carried out as fast as the</span></div>
<div style="position:absolute;left:239.95px;top:515.67px" class="cls_006"><span class="cls_006">memory system will manage.</span></div>
<div style="position:absolute;left:239.95px;top:529.67px" class="cls_006"><span class="cls_006">A write buffer is particularly effective when used with a write-through</span></div>
<div style="position:absolute;left:239.95px;top:540.67px" class="cls_006"><span class="cls_006">cache.</span></div>
<div style="position:absolute;left:215.97px;top:554.67px" class="cls_008"><span class="cls_008">write-through cache</span><span class="cls_006">: a D-cache where every write operation is made both</span></div>
<div style="position:absolute;left:239.94px;top:565.67px" class="cls_006"><span class="cls_006">to the cache (if the access hits a cached location) and simultaneously</span></div>
<div style="position:absolute;left:239.94px;top:576.67px" class="cls_006"><span class="cls_006">to memory. The advantage is that the cache never contains data</span></div>
<div style="position:absolute;left:239.94px;top:587.67px" class="cls_006"><span class="cls_006">which  is  not  already  in  memory,  so  cache  lines  can  be  freely</span></div>
<div style="position:absolute;left:239.94px;top:598.67px" class="cls_006"><span class="cls_006">discarded.</span></div>
<div style="position:absolute;left:215.96px;top:612.67px" class="cls_008"><span class="cls_008">zero register</span><span class="cls_006">: CPU register $0, which is very special. Regardless of what is</span></div>
<div style="position:absolute;left:239.94px;top:623.67px" class="cls_006"><span class="cls_006">written to it, it always returns the value zero.</span></div>
<div style="position:absolute;left:303.04px;top:755.34px" class="cls_002"><span class="cls_002">F-13</span></div>
</div>

</body>
</html>
